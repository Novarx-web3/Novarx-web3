vulnerability_type,code,processed_code,language,target
Out-of-Bounds,"#include <iostream>

class UnsafeClass {
    int data[10];
public:
    int get_data(int index) {
        return data[index]; // no bounds checking
    }
};","#include <iostream>

class UnsafeClass {
    int data[10];
public:
    int get_data(int index) {
        return data[index]; // no bounds checking
    }
};",cpp,1
Clear,"import java.util.Scanner;

public class SecureBufferExample {

    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        
        System.out.print(""Enter your name: "");
        String name = scanner.nextLine();
        
        // Using StringBuilder to dynamically store user input
        StringBuilder buffer = new StringBuilder();
        
        // Copying user input into the buffer with bounds checking
        for (int i = 0; i < name.length() && i < 10; i++) {
            buffer.append(name.charAt(i));
        }
        
        System.out.println(""Hello, "" + buffer.toString());
    }
}","import java.util.Scanner; public class SecureBufferExample { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter your name: ""); String name = scanner.nextLine(); // Using StringBuilder to dynamically store user input StringBuilder buffer = new StringBuilder(); // Copying user input into the buffer with bounds checking for (int i = 0; i < name.length() && i < 10; i++) { buffer.append(name.charAt(i)); } System.out.println(""Hello, "" + buffer.toString()); } }",java,0
Clear,"import subprocess
def safe_ping(host):
    import re
    if not re.match(r'^[a-zA-Z0-9.-]+$', host):
        raise ValueError(""Invalid host"")
    result = subprocess.run(['ping', '-c', '4', host], capture_output=True, text=True)
    return result.stdout","import subprocess
def safe_ping(host):
    import re
    if not re.match(r'^[a-zA-Z0-9.-]+$', host):
        raise ValueError(""Invalid host"")
    result = subprocess.run(['ping', '-c', '4', host], capture_output=True, text=True)
    return result.stdout",python,0
Path Traversal,"import java.io.File;
import java.io.FileInputStream;
import java.io.IOException;
import java.util.Scanner;

public class PathTraversalVulnerability {

    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        
        System.out.print(""Enter file name: "");
        String fileName = scanner.nextLine();
        
        File file = new File(""/path/to/files/"" + fileName); // Vulnerable code
        
        try {
            FileInputStream fis = new FileInputStream(file);
            int content;
            while ((content = fis.read()) != -1) {
                System.out.print((char) content);
            }
            fis.close();
        } catch (IOException e) {
            e.printStackTrace();
        }
        
        scanner.close();
    }
}","import java.io.File; import java.io.FileInputStream; import java.io.IOException; import java.util.Scanner; public class PathTraversalVulnerability { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter file name: ""); String fileName = scanner.nextLine(); File file = new File(""/path/to/files/"" + fileName); // Vulnerable code try { FileInputStream fis = new FileInputStream(file); int content; while ((content = fis.read()) != -1) { System.out.print((char) content); } fis.close(); } catch (IOException e) { e.printStackTrace(); } scanner.close(); } }",java,1
Clear,"#include <stdio.h>
#include <stdlib.h>

void safe_file_operation(const char *filename) {
    FILE *file = fopen(filename, ""r"");
    if (file != NULL) {
        char buffer[256];
        while (fgets(buffer, sizeof(buffer), file)) {
            printf(""%s"", buffer);
        }
        fclose(file);
    }
}","#include <stdio.h>
#include <stdlib.h>

void safe_file_operation(const char *filename) {
    FILE *file = fopen(filename, ""r"");
    if (file != NULL) {
        char buffer[256];
        while (fgets(buffer, sizeof(buffer), file)) {
            printf(""%s"", buffer);
        }
        fclose(file);
    }
}",c,0
Clear,"import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;

public class SecureSQLQuery {

    public static void main(String[] args) {
        String userInput = ""'; DROP TABLE users; --""; // Malicious input simulating SQL Injection

        try {
            Connection connection = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");

            // Use a PreparedStatement with parameterized query
            String query = ""SELECT * FROM users WHERE username = ?"";
            PreparedStatement statement = connection.prepareStatement(query);
            statement.setString(1, userInput);

            ResultSet resultSet = statement.executeQuery();

            while (resultSet.next()) {
                System.out.println(""User found: "" + resultSet.getString(""username""));
            }

        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.Connection; import java.sql.DriverManager; import java.sql.PreparedStatement; import java.sql.ResultSet; import java.sql.SQLException; public class SecureSQLQuery { public static void main(String[] args) { String userInput = ""'; DROP TABLE users; --""; // Malicious input simulating SQL Injection try { Connection connection = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); // Use a PreparedStatement with parameterized query String query = ""SELECT * FROM users WHERE username = ?""; PreparedStatement statement = connection.prepareStatement(query); statement.setString(1, userInput); ResultSet resultSet = statement.executeQuery(); while (resultSet.next()) { System.out.println(""User found: "" + resultSet.getString(""username"")); } } catch (SQLException e) { e.printStackTrace(); } } }",java,0
Clear,"const userInput = new URLSearchParams(window.location.search).get('input');
const safeOutput = document.createElement('div');
safeOutput.textContent = userInput; // Safe DOM manipulation
document.body.appendChild(safeOutput);
","const userInput = new URLSearchParams(window.location.search).get('input');
const safeOutput = document.createElement('div');
safeOutput.textContent = userInput; // Safe DOM manipulation
document.body.appendChild(safeOutput);
",javascript,0
Buffer Overflow,"#include <iostream>
#include <cstring>

void unsafe_c_string(char* input) {
    char buffer[100];
    strcpy(buffer, input); // potential buffer overflow
    std::cout << buffer << std::endl;
}","#include <iostream>
#include <cstring>

void unsafe_c_string(char* input) {
    char buffer[100];
    strcpy(buffer, input); // potential buffer overflow
    std::cout << buffer << std::endl;
}",cpp,1
Command Injection,"import subprocess
def list_directory(path):
    result = subprocess.run(f""ls {path}"", shell=True, capture_output=True, text=True)
    return result.stdout","import subprocess
def list_directory(path):
    result = subprocess.run(f""ls {path}"", shell=True, capture_output=True, text=True)
    return result.stdout",python,1
Cross-Site Scripting (XSS),"import java.io.*;
import java.util.*;

public class XssVulnerableCode {

    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);

        System.out.print(""Enter your name: "");
        String userInput = scanner.nextLine();

        // Improperly handling user input - directly outputting to HTML
        System.out.println(""<p>Welcome, "" + userInput + ""!</p>"");
    }
}","import java.io.*; import java.util.*; public class XssVulnerableCode { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter your name: ""); String userInput = scanner.nextLine(); // Improperly handling user input - directly outputting to HTML System.out.println(""<p>Welcome, "" + userInput + ""!</p>""); } }",java,1
Clear,"#include <iostream>
#include <memory>

void safe_memory_management() {
    auto ptr = std::make_unique<int>(42);
    std::cout << *ptr << std::endl;
}","#include <iostream>
#include <memory>

void safe_memory_management() {
    auto ptr = std::make_unique<int>(42);
    std::cout << *ptr << std::endl;
}",cpp,0
Clear,"from django.http import HttpResponse
from django.utils.html import escape

def safe_user_profile(request, username):
    safe_username = escape(username)
    return HttpResponse(f""Welcome, {safe_username}!"")","from django.http import HttpResponse
from django.utils.html import escape

def safe_user_profile(request, username):
    safe_username = escape(username)
    return HttpResponse(f""Welcome, {safe_username}!"")",python,0
Command Injection,"import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class CommandInjectionVulnerability {

    public static void main(String[] args) throws IOException {
        BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));

        System.out.print(""Enter the IP address to ping: "");
        String ip = reader.readLine();

        String command = ""ping "" + ip;

        Process process = Runtime.getRuntime().exec(command);

        BufferedReader inputReader = new BufferedReader(new InputStreamReader(process.getInputStream()));
        String line;
        
        while ((line = inputReader.readLine()) != null) {
            System.out.println(line);
        }
    }
}","import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class CommandInjectionVulnerability { public static void main(String[] args) throws IOException { BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter the IP address to ping: ""); String ip = reader.readLine(); String command = ""ping "" + ip; Process process = Runtime.getRuntime().exec(command); BufferedReader inputReader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = inputReader.readLine()) != null) { System.out.println(line); } } }",java,1
Buffer Overflow,"#include <iostream>
#include <cstring>

void unsafe_c_string(char* input) {
    char buffer[100];
    strcpy(buffer, input); // potential buffer overflow
    std::cout << buffer << std::endl;
}","#include <iostream>
#include <cstring>

void unsafe_c_string(char* input) {
    char buffer[100];
    strcpy(buffer, input); // potential buffer overflow
    std::cout << buffer << std::endl;
}",cpp,1
Command Injection,"import java.io.*;

public class CommandInjectionExample {
    public static void main(String[] args) {
        try {
            BufferedReader br = new BufferedReader(new InputStreamReader(System.in));
            System.out.print(""Enter a command to execute: "");
            String command = br.readLine();

            Process process = Runtime.getRuntime().exec(command);
            
            BufferedReader reader = new BufferedReader(new InputStreamReader(process.getInputStream()));
            String line;
            
            while ((line = reader.readLine()) != null) {
                System.out.println(line);
            }
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}","import java.io.*; public class CommandInjectionExample { public static void main(String[] args) { try { BufferedReader br = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a command to execute: ""); String command = br.readLine(); Process process = Runtime.getRuntime().exec(command); BufferedReader reader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = reader.readLine()) != null) { System.out.println(line); } } catch (IOException e) { e.printStackTrace(); } } }",java,1
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Clear,"import java.util.Scanner;
import org.owasp.encoder.Encode;

public class XSSFixedCode {
    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);

        System.out.print(""Enter your name: "");
        String userInput = scanner.nextLine();

        // Sanitize user input using OWASP Encoder to prevent XSS attacks
        String sanitizedInput = Encode.forHtml(userInput);

        System.out.println(""Hello, "" + sanitizedInput + ""!"");
    }
}","import java.util.Scanner; import org.owasp.encoder.Encode; public class XSSFixedCode { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter your name: ""); String userInput = scanner.nextLine(); // Sanitize user input using OWASP Encoder to prevent XSS attacks String sanitizedInput = Encode.forHtml(userInput); System.out.println(""Hello, "" + sanitizedInput + ""!""); } }",java,0
Out-of-Bounds,"#include <iostream>

class UnsafeClass {
    int data[10];
public:
    int get_data(int index) {
        return data[index]; // no bounds checking
    }
};","#include <iostream>

class UnsafeClass {
    int data[10];
public:
    int get_data(int index) {
        return data[index]; // no bounds checking
    }
};",cpp,1
Clear,"const userData = JSON.parse(userInput); // Safe JSON parsing
if (userData && typeof userData === 'object') {
    processUserData(userData);
}
","const userData = JSON.parse(userInput); // Safe JSON parsing
if (userData && typeof userData === 'object') {
    processUserData(userData);
}
",javascript,0
SQL Injection,"import mysql.connector
def search_products(category):
    db = mysql.connector.connect(host=""localhost"", user=""user"", password=""pass"", database=""shop"")
    cursor = db.cursor()
    cursor.execute(""SELECT * FROM products WHERE category = '%s'"" % category)
    return cursor.fetchall()","import mysql.connector
def search_products(category):
    db = mysql.connector.connect(host=""localhost"", user=""user"", password=""pass"", database=""shop"")
    cursor = db.cursor()
    cursor.execute(""SELECT * FROM products WHERE category = '%s'"" % category)
    return cursor.fetchall()",python,1
Clear,"from flask import Flask, request
import html
app = Flask(__name__)

@app.route('/search_safe')
def search_safe():
    query = request.args.get('q', '')
    safe_query = html.escape(query)
    return f'<h1>Search results for: {safe_query}</h1>'","from flask import Flask, request
import html
app = Flask(__name__)

@app.route('/search_safe')
def search_safe():
    query = request.args.get('q', '')
    safe_query = html.escape(query)
    return f'<h1>Search results for: {safe_query}</h1>'",python,0
SQL Injection,"<?php
$username = $_POST['username'];
$query = ""SELECT * FROM users WHERE username = '$username'"";
$result = mysql_query($query); // SQL Injection
?>","<?php
$username = $_POST['username'];
$query = ""SELECT * FROM users WHERE username = '$username'"";
$result = mysql_query($query); // SQL Injection
?>",php,1
Command Injection,"const shell = require('child_process');
shell.exec('ping ' + userInput); // Command Injection
","const shell = require('child_process');
shell.exec('ping ' + userInput); // Command Injection
",javascript,1
Clear,"#include <iostream>
#include <memory>

void safe_memory_management() {
    auto ptr = std::make_unique<int>(42);
    std::cout << *ptr << std::endl;
}","#include <iostream>
#include <memory>

void safe_memory_management() {
    auto ptr = std::make_unique<int>(42);
    std::cout << *ptr << std::endl;
}",cpp,0
Clear,"import java.util.Scanner;

public class SecureBufferExample {
    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        
        System.out.print(""Enter your name: "");
        String name = scanner.nextLine();
        
        // Validate input length to prevent buffer overflow
        if (name.length() > 10) {
            System.out.println(""Input exceeds maximum allowed length. Please enter a shorter name."");
            return;
        }
        
        char[] buffer = new char[10];
        name.getChars(0, Math.min(name.length(), buffer.length), buffer, 0);
        
        System.out.println(""Welcome, "" + new String(buffer));
    }
}","import java.util.Scanner; public class SecureBufferExample { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter your name: ""); String name = scanner.nextLine(); // Validate input length to prevent buffer overflow if (name.length() > 10) { System.out.println(""Input exceeds maximum allowed length. Please enter a shorter name.""); return; } char[] buffer = new char[10]; name.getChars(0, Math.min(name.length(), buffer.length), buffer, 0); System.out.println(""Welcome, "" + new String(buffer)); } }",java,0
Cross-Site Scripting (XSS),"import java.io.IOException;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

public class XSSVulnerableServlet extends HttpServlet {

    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        String userInput = request.getParameter(""input"");
        
        String htmlResponse = ""<html><body>User Input: "" + userInput + ""</body></html>"";
        
        response.getWriter().write(htmlResponse);
    }
}","import java.io.IOException; import javax.servlet.http.HttpServletRequest; import javax.servlet.http.HttpServletResponse; public class XSSVulnerableServlet extends HttpServlet { protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { String userInput = request.getParameter(""input""); String htmlResponse = ""<html><body>User Input: "" + userInput + ""</body></html>""; response.getWriter().write(htmlResponse); } }",java,1
Out-of-Bounds,"#include <iostream>

class UnsafeClass {
    int data[10];
public:
    int get_data(int index) {
        return data[index]; // no bounds checking
    }
};","#include <iostream>

class UnsafeClass {
    int data[10];
public:
    int get_data(int index) {
        return data[index]; // no bounds checking
    }
};",cpp,1
Clear,"const userInput = new URLSearchParams(window.location.search).get('input');
const safeOutput = document.createElement('div');
safeOutput.textContent = userInput; // Safe DOM manipulation
document.body.appendChild(safeOutput);
","const userInput = new URLSearchParams(window.location.search).get('input');
const safeOutput = document.createElement('div');
safeOutput.textContent = userInput; // Safe DOM manipulation
document.body.appendChild(safeOutput);
",javascript,0
Clear,"import os
def get_database_config():
    return {
        'host': os.environ.get('DB_HOST'),
        'user': os.environ.get('DB_USER'),
        'password': os.environ.get('DB_PASSWORD')
    }","import os
def get_database_config():
    return {
        'host': os.environ.get('DB_HOST'),
        'user': os.environ.get('DB_USER'),
        'password': os.environ.get('DB_PASSWORD')
    }",python,0
Path Traversal,"import java.io.File;
import java.io.IOException;
import java.nio.file.Files;

public class PathTraversalVulnerability {

    public static void main(String[] args) {
        String userInput = ""../../../../../etc/passwd"";
        String directoryPath = ""/var/data/"";

        try {
            File file = new File(directoryPath + userInput);
            if (file.exists()) {
                byte[] fileContent = Files.readAllBytes(file.toPath());
                System.out.println(new String(fileContent));
            } else {
                System.out.println(""File not found"");
            }
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}","import java.io.File; import java.io.IOException; import java.nio.file.Files; public class PathTraversalVulnerability { public static void main(String[] args) { String userInput = ""../../../../../etc/passwd""; String directoryPath = ""/var/data/""; try { File file = new File(directoryPath + userInput); if (file.exists()) { byte[] fileContent = Files.readAllBytes(file.toPath()); System.out.println(new String(fileContent)); } else { System.out.println(""File not found""); } } catch (IOException e) { e.printStackTrace(); } } }",java,1
SQL Injection,"app.get('/user/:id', (req, res) => {
    const query = `SELECT * FROM users WHERE id = ${req.params.id}`; // SQL Injection
    db.query(query, (err, result) => {
        res.json(result);
    });
});
","app.get('/user/:id', (req, res) => {
    const query = `SELECT * FROM users WHERE id = ${req.params.id}`; // SQL Injection
    db.query(query, (err, result) => {
        res.json(result);
    });
});
",javascript,1
Clear,"#include <iostream>
#include <sstream>

int safe_string_to_int(const std::string& str) {
    std::stringstream ss(str);
    int value;
    if (ss >> value) {
        return value;
    }
    throw std::invalid_argument(""Invalid integer"");
}","#include <iostream>
#include <sstream>

int safe_string_to_int(const std::string& str) {
    std::stringstream ss(str);
    int value;
    if (ss >> value) {
        return value;
    }
    throw std::invalid_argument(""Invalid integer"");
}",cpp,0
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Code Injection,"const userData = eval('(' + userInput + ')'); // eval injection
","const userData = eval('(' + userInput + ')'); // eval injection
",javascript,1
Memory Corruption,"#include <iostream>

void unsafe_virtual_call() {
    // Potential vtable corruption vulnerability
    class Base {
    public:
        virtual void func() { std::cout << ""Base"" << std::endl; }
    };
    
    class Derived : public Base {
    public:
        void func() override { std::cout << ""Derived"" << std::endl; }
    };
}","#include <iostream>

void unsafe_virtual_call() {
    // Potential vtable corruption vulnerability
    class Base {
    public:
        virtual void func() { std::cout << ""Base"" << std::endl; }
    };
    
    class Derived : public Base {
    public:
        void func() override { std::cout << ""Derived"" << std::endl; }
    };
}",cpp,1
Insecure Deserialization,"Certainly! Here is an example of Java code snippet demonstrating a vulnerability related to Insecure Deserialization:

```java
import java.io.*;

public class InsecureDeserializationExample {

    public static void main(String[] args) {
        String serializedData = ""rO0ABXNyAC5qYXZheC5tYWluLlN0cmluZ6NN8vY7AgAGSQAKaW52YWxpZF9uYW1lAAJbQkwACWludmFsaWRzdAASR2VuZXJhbFR5cGVzdAAQTGphdmEvdXRpbC9UeXBlO0wABG5hbWVxAH4AAUwABm91dHEAfgADTAALc2lnbmF0dXJlc3EAfgADeHBzcgA/a2Fub25fY29kZXEAfgAHRwACHQAJZGVzdGluYXRpb25xAH4ABHQAE3NjaGVtZV90aGFua3NvbnMAFGphdmEubGFuZy5OdW1iZXKGr","Certainly! Here is an example of Java code snippet demonstrating a vulnerability related to Insecure Deserialization: ```java import java.io.*; public class InsecureDeserializationExample { public static void main(String[] args) { String serializedData = ""rO0ABXNyAC5qYXZheC5tYWluLlN0cmluZ6NN8vY7AgAGSQAKaW52YWxpZF9uYW1lAAJbQkwACWludmFsaWRzdAASR2VuZXJhbFR5cGVzdAAQTGphdmEvdXRpbC9UeXBlO0wABG5hbWVxAH4AAUwABm91dHEAfgADTAALc2lnbmF0dXJlc3EAfgADeHBzcgA/a2Fub25fY29kZXEAfgAHRwACHQAJZGVzdGluYXRpb25xAH4ABHQAE3NjaGVtZV90aGFua3NvbnMAFGphdmEubGFuZy5OdW1iZXKGr",java,1
Path Traversal,"import os
def read_file(filename):
    with open('/var/www/uploads/' + filename, 'r') as f:
        return f.read()","import os
def read_file(filename):
    with open('/var/www/uploads/' + filename, 'r') as f:
        return f.read()",python,1
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Cross-Site Scripting (XSS),"import java.io.IOException;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

public class XSSVulnerableServlet extends HttpServlet {
    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws IOException {
        String userInput = request.getParameter(""input"");
        String output = ""<p>User Input: "" + userInput + ""</p>"";
        
        response.setContentType(""text/html"");
        response.getWriter().write(output);
    }
}","import java.io.IOException; import javax.servlet.http.HttpServletRequest; import javax.servlet.http.HttpServletResponse; public class XSSVulnerableServlet extends HttpServlet { protected void doGet(HttpServletRequest request, HttpServletResponse response) throws IOException { String userInput = request.getParameter(""input""); String output = ""<p>User Input: "" + userInput + ""</p>""; response.setContentType(""text/html""); response.getWriter().write(output); } }",java,1
Clear,"import psycopg2
def safe_admin_query(admin_id):
    conn = psycopg2.connect(""dbname=test user=postgres"")
    cur = conn.cursor()
    cur.execute(""SELECT * FROM admins WHERE id = %s"", (admin_id,))
    return cur.fetchone()","import psycopg2
def safe_admin_query(admin_id):
    conn = psycopg2.connect(""dbname=test user=postgres"")
    cur = conn.cursor()
    cur.execute(""SELECT * FROM admins WHERE id = %s"", (admin_id,))
    return cur.fetchone()",python,0
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
XSS,"<?php
echo $_GET['message']; // XSS
?>","<?php
echo $_GET['message']; // XSS
?>",php,1
SSRF,"import requests
def fetch_url(url):
    return requests.get(url).text","import requests
def fetch_url(url):
    return requests.get(url).text",python,1
Path Traversal,"def get_user_file(username, filepath):
    import os
    base_path = f""/home/{username}/files/""
    full_path = base_path + filepath
    with open(full_path, 'r') as f:
        return f.read()","def get_user_file(username, filepath):
    import os
    base_path = f""/home/{username}/files/""
    full_path = base_path + filepath
    with open(full_path, 'r') as f:
        return f.read()",python,1
Clear,"const userInput = new URLSearchParams(window.location.search).get('input');
const safeOutput = document.createElement('div');
safeOutput.textContent = userInput; // Safe DOM manipulation
document.body.appendChild(safeOutput);
","const userInput = new URLSearchParams(window.location.search).get('input');
const safeOutput = document.createElement('div');
safeOutput.textContent = userInput; // Safe DOM manipulation
document.body.appendChild(safeOutput);
",javascript,0
Clear,"import java.util.Scanner;

public class SecureBuffer {
    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        
        System.out.print(""Enter a string: "");
        String userInput = scanner.nextLine();
        
        // Define buffer size and ensure user input does not exceed buffer size
        int bufferSize = 10;
        char[] buffer = new char[bufferSize];
        
        // Copy user input into buffer with bounds checking
        for (int i = 0; i < userInput.length() && i < bufferSize; i++) {
            buffer[i] = userInput.charAt(i);
        }
        
        System.out.println(""Buffer overflow vulnerability fixed!"");
    }
}","import java.util.Scanner; public class SecureBuffer { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter a string: ""); String userInput = scanner.nextLine(); // Define buffer size and ensure user input does not exceed buffer size int bufferSize = 10; char[] buffer = new char[bufferSize]; // Copy user input into buffer with bounds checking for (int i = 0; i < userInput.length() && i < bufferSize; i++) { buffer[i] = userInput.charAt(i); } System.out.println(""Buffer overflow vulnerability fixed!""); } }",java,0
Command Injection,"import os
def ping_host(host):
    os.system(""ping -c 4 "" + host)","import os
def ping_host(host):
    os.system(""ping -c 4 "" + host)",python,1
Command Injection,"import os
def ping_host(host):
    os.system(""ping -c 4 "" + host)","import os
def ping_host(host):
    os.system(""ping -c 4 "" + host)",python,1
Path Traversal,"import java.io.File;
import java.io.FileInputStream;
import java.io.IOException;
import java.util.Scanner;

public class PathTraversalExample {
    public static void main(String[] args) throws IOException {
        Scanner scanner = new Scanner(System.in);
        System.out.print(""Enter file name: "");
        String fileName = scanner.next();

        File file = new File(""/path/to/directory/"" + fileName);

        if (file.exists()) {
            FileInputStream fis = new FileInputStream(file);
            int data;
            while ((data = fis.read()) != -1) {
                System.out.print((char) data);
            }
            fis.close();
        } else {
            System.out.println(""File not found."");
        }
    }
}","import java.io.File; import java.io.FileInputStream; import java.io.IOException; import java.util.Scanner; public class PathTraversalExample { public static void main(String[] args) throws IOException { Scanner scanner = new Scanner(System.in); System.out.print(""Enter file name: ""); String fileName = scanner.next(); File file = new File(""/path/to/directory/"" + fileName); if (file.exists()) { FileInputStream fis = new FileInputStream(file); int data; while ((data = fis.read()) != -1) { System.out.print((char) data); } fis.close(); } else { System.out.println(""File not found.""); } } }",java,1
Clear,"import org.owasp.encoder.Encode;

public class XSSFixedCode {
    public static void main(String[] args) {
        // Simulating user input
        String userInput = ""<script>alert('XSS Vulnerability!')</script>"";

        // Properly encode user input
        String encodedUserInput = Encode.forHtml(userInput);

        // Printing the output with encoded user input
        String output = ""Hello, "" + encodedUserInput;
        System.out.println(output);
    }
}","import org.owasp.encoder.Encode; public class XSSFixedCode { public static void main(String[] args) { // Simulating user input String userInput = ""<script>alert('XSS Vulnerability!')</script>""; // Properly encode user input String encodedUserInput = Encode.forHtml(userInput); // Printing the output with encoded user input String output = ""Hello, "" + encodedUserInput; System.out.println(output); } }",java,0
SQL Injection,"import java.sql.*;

public class SQLInjectionVulnerableApp {

    public static void main(String[] args) {
        try {
            String userInput = args[0]; // Assume user input is passed as a command line argument

            String url = ""jdbc:mysql://localhost:3306/mydatabase"";
            String username = ""root"";
            String password = ""password"";

            Connection conn = DriverManager.getConnection(url, username, password);

            Statement stmt = conn.createStatement();
            String query = ""SELECT * FROM users WHERE username='"" + userInput + ""'"";
            
            ResultSet rs = stmt.executeQuery(query);

            while (rs.next()) {
                System.out.println(""User ID: "" + rs.getInt(""id"") + "", Username: "" + rs.getString(""username""));
            }

        } catch (Exception e) {
            e.printStackTrace();
        }
    }
}","import java.sql.*; public class SQLInjectionVulnerableApp { public static void main(String[] args) { try { String userInput = args[0]; // Assume user input is passed as a command line argument String url = ""jdbc:mysql://localhost:3306/mydatabase""; String username = ""root""; String password = ""password""; Connection conn = DriverManager.getConnection(url, username, password); Statement stmt = conn.createStatement(); String query = ""SELECT * FROM users WHERE username='"" + userInput + ""'""; ResultSet rs = stmt.executeQuery(query); while (rs.next()) { System.out.println(""User ID: "" + rs.getInt(""id"") + "", Username: "" + rs.getString(""username"")); } } catch (Exception e) { e.printStackTrace(); } } }",java,1
Command Injection,"const shell = require('child_process');
shell.exec('ping ' + userInput); // Command Injection
","const shell = require('child_process');
shell.exec('ping ' + userInput); // Command Injection
",javascript,1
Insecure Deserialization,"import pickle
def load_user_data(filename):
    with open(filename, 'rb') as f:
        data = pickle.load(f)
    return data","import pickle
def load_user_data(filename):
    with open(filename, 'rb') as f:
        data = pickle.load(f)
    return data",python,1
Clear,"from django.http import HttpResponse
from django.utils.html import escape

def safe_user_profile(request, username):
    safe_username = escape(username)
    return HttpResponse(f""Welcome, {safe_username}!"")","from django.http import HttpResponse
from django.utils.html import escape

def safe_user_profile(request, username):
    safe_username = escape(username)
    return HttpResponse(f""Welcome, {safe_username}!"")",python,0
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Cross-Site Scripting (XSS),"import java.io.*;
import javax.servlet.*;
import javax.servlet.http.*;

public class VulnerableServlet extends HttpServlet {
    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        String userInput = request.getParameter(""input"");
        
        // Improperly handling user input by directly outputting it without proper encoding
        response.getWriter().println(""<html><body>User input: "" + userInput + ""</body></html>"");
    }
}","import java.io.*; import javax.servlet.*; import javax.servlet.http.*; public class VulnerableServlet extends HttpServlet { protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { String userInput = request.getParameter(""input""); // Improperly handling user input by directly outputting it without proper encoding response.getWriter().println(""<html><body>User input: "" + userInput + ""</body></html>""); } }",java,1
Clear,"import org.owasp.encoder.Encode;

public class XSSFixedCode {
    public static void main(String[] args) {
        // Simulating user input
        String userInput = ""<script>alert('XSS Vulnerability!')</script>"";

        // Properly encode user input before outputting it to the webpage
        String encodedUserInput = Encode.forHtml(userInput);
        
        System.out.println(""<div>"" + encodedUserInput + ""</div>"");
    }
}","import org.owasp.encoder.Encode; public class XSSFixedCode { public static void main(String[] args) { // Simulating user input String userInput = ""<script>alert('XSS Vulnerability!')</script>""; // Properly encode user input before outputting it to the webpage String encodedUserInput = Encode.forHtml(userInput); System.out.println(""<div>"" + encodedUserInput + ""</div>""); } }",java,0
Clear,"const shell = require('child_process');
const safeInput = userInput.replace(/[^a-zA-Z0-9.]/g, '');
shell.execFile('ping', [safeInput]); // Safe command execution
","const shell = require('child_process');
const safeInput = userInput.replace(/[^a-zA-Z0-9.]/g, '');
shell.execFile('ping', [safeInput]); // Safe command execution
",javascript,0
Command Injection,"import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class CommandInjectionExample {

    public static void main(String[] args) {
        try {
            BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));
            System.out.print(""Enter a file name: "");
            String fileName = reader.readLine();

            // This code is vulnerable to command injection
            Process process = Runtime.getRuntime().exec(""ls "" + fileName);

            BufferedReader inputReader = new BufferedReader(new InputStreamReader(process.getInputStream()));
            String line;
            while ((line = inputReader.readLine()) != null) {
                System.out.println(line);
            }

        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}","import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class CommandInjectionExample { public static void main(String[] args) { try { BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a file name: ""); String fileName = reader.readLine(); // This code is vulnerable to command injection Process process = Runtime.getRuntime().exec(""ls "" + fileName); BufferedReader inputReader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = inputReader.readLine()) != null) { System.out.println(line); } } catch (IOException e) { e.printStackTrace(); } } }",java,1
Clear,"To fix this code and prevent Command Injection vulnerability, you should not directly pass user input to the operating system command execution. Instead, you should validate and sanitize user input before using it as a command. Here is an example of how you can improve the code by using ProcessBuilder and specifying the command and arguments separately:

```java
import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class SecureCommandExecution {

    public static void main(String[] args) throws IOException {
        BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));

        System.out.print(""Enter a command to execute: "");
        String command = reader.readLine();

        // Split the command into parts
        String[] commandParts = command.split("" "");

        // Use ProcessBuilder to execute the command with specified arguments
        ProcessBuilder processBuilder = new ProcessBuilder(commandParts);
        
        try {
            Process process = processBuilder.start();
            
            BufferedReader processOutputReader = new BufferedReader(new InputStreamReader(process.getInputStream()));
            String line;
            
            System.out.println(""Output of the command:"");
            while ((line = processOutputReader.readLine()) != null) {
                System.out.println(line);
            }
            
        } catch (IOException e) {
            System.err.println(""Error","To fix this code and prevent Command Injection vulnerability, you should not directly pass user input to the operating system command execution. Instead, you should validate and sanitize user input before using it as a command. Here is an example of how you can improve the code by using ProcessBuilder and specifying the command and arguments separately: ```java import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class SecureCommandExecution { public static void main(String[] args) throws IOException { BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a command to execute: ""); String command = reader.readLine(); // Split the command into parts String[] commandParts = command.split("" ""); // Use ProcessBuilder to execute the command with specified arguments ProcessBuilder processBuilder = new ProcessBuilder(commandParts); try { Process process = processBuilder.start(); BufferedReader processOutputReader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; System.out.println(""Output of the command:""); while ((line = processOutputReader.readLine()) != null) { System.out.println(line); } } catch (IOException e) { System.err.println(""Error",java,0
Clear,"#include <stdio.h>
#include <string.h>

void safe_string_copy(char *dest, const char *src, size_t dest_size) {
    if (dest_size > 0) {
        strncpy(dest, src, dest_size - 1);
        dest[dest_size - 1] = '\0';
    }
}","#include <stdio.h>
#include <string.h>

void safe_string_copy(char *dest, const char *src, size_t dest_size) {
    if (dest_size > 0) {
        strncpy(dest, src, dest_size - 1);
        dest[dest_size - 1] = '\0';
    }
}",c,0
XSS,"<?php
echo $_GET['message']; // XSS
?>","<?php
echo $_GET['message']; // XSS
?>",php,1
Clear,"#include <iostream>
#include <memory>

void safe_memory_management() {
    auto ptr = std::make_unique<int>(42);
    std::cout << *ptr << std::endl;
}","#include <iostream>
#include <memory>

void safe_memory_management() {
    auto ptr = std::make_unique<int>(42);
    std::cout << *ptr << std::endl;
}",cpp,0
Clear,"import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class SecureCommandExecution {

    public static void main(String[] args) throws IOException {
        BufferedReader br = new BufferedReader(new InputStreamReader(System.in));

        System.out.print(""Enter a command to execute: "");
        String command = br.readLine();

        // Secure code - using ProcessBuilder to construct the command and its arguments
        ProcessBuilder processBuilder = new ProcessBuilder(command.split("" ""));
        Process process = processBuilder.start();

        BufferedReader reader = new BufferedReader(new InputStreamReader(process.getInputStream()));
        String line;

        while ((line = reader.readLine()) != null) {
            System.out.println(line);
        }
    }
}","import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class SecureCommandExecution { public static void main(String[] args) throws IOException { BufferedReader br = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a command to execute: ""); String command = br.readLine(); // Secure code - using ProcessBuilder to construct the command and its arguments ProcessBuilder processBuilder = new ProcessBuilder(command.split("" "")); Process process = processBuilder.start(); BufferedReader reader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = reader.readLine()) != null) { System.out.println(line); } } }",java,0
SSRF,"import requests
def fetch_url(url):
    return requests.get(url).text","import requests
def fetch_url(url):
    return requests.get(url).text",python,1
Memory Corruption,"#include <iostream>

void unsafe_virtual_call() {
    // Potential vtable corruption vulnerability
    class Base {
    public:
        virtual void func() { std::cout << ""Base"" << std::endl; }
    };
    
    class Derived : public Base {
    public:
        void func() override { std::cout << ""Derived"" << std::endl; }
    };
}","#include <iostream>

void unsafe_virtual_call() {
    // Potential vtable corruption vulnerability
    class Base {
    public:
        virtual void func() { std::cout << ""Base"" << std::endl; }
    };
    
    class Derived : public Base {
    public:
        void func() override { std::cout << ""Derived"" << std::endl; }
    };
}",cpp,1
Path Traversal,"import java.io.File;
import java.io.FileInputStream;
import java.io.IOException;

public class FileReadExample {

    public static void main(String[] args) {
        String userInput = ""../../../../../etc/passwd"";
        String fileName = ""files/"" + userInput; // User input is directly concatenated with the file path

        try {
            File file = new File(fileName);
            FileInputStream fis = new FileInputStream(file);

            int data;
            while ((data = fis.read()) != -1) {
                System.out.print((char) data);
            }

            fis.close();
        } catch (IOException e) {
            System.out.println(""Error reading file: "" + e.getMessage());
        }
    }
}","import java.io.File; import java.io.FileInputStream; import java.io.IOException; public class FileReadExample { public static void main(String[] args) { String userInput = ""../../../../../etc/passwd""; String fileName = ""files/"" + userInput; // User input is directly concatenated with the file path try { File file = new File(fileName); FileInputStream fis = new FileInputStream(file); int data; while ((data = fis.read()) != -1) { System.out.print((char) data); } fis.close(); } catch (IOException e) { System.out.println(""Error reading file: "" + e.getMessage()); } } }",java,1
Clear,"def safe_comment_display(comment_text):
    import html
    escaped_text = html.escape(comment_text)
    return f""<div class='comment'>{escaped_text}</div>"" ","def safe_comment_display(comment_text):
    import html
    escaped_text = html.escape(comment_text)
    return f""<div class='comment'>{escaped_text}</div>"" ",python,0
Code Injection,"const userData = eval('(' + userInput + ')'); // eval injection
","const userData = eval('(' + userInput + ')'); // eval injection
",javascript,1
Buffer Overflow,"#include <iostream>
#include <cstdio>

void unsafe_c_input() {
    char buffer[50];
    scanf(""%s"", buffer); // no length limit
    std::cout << buffer << std::endl;
}","#include <iostream>
#include <cstdio>

void unsafe_c_input() {
    char buffer[50];
    scanf(""%s"", buffer); // no length limit
    std::cout << buffer << std::endl;
}",cpp,1
Clear,"#include <iostream>
#include <memory>

void safe_memory_management() {
    auto ptr = std::make_unique<int>(42);
    std::cout << *ptr << std::endl;
}","#include <iostream>
#include <memory>

void safe_memory_management() {
    auto ptr = std::make_unique<int>(42);
    std::cout << *ptr << std::endl;
}",cpp,0
Clear,"const userInput = new URLSearchParams(window.location.search).get('input');
const safeOutput = document.createElement('div');
safeOutput.textContent = userInput; // Safe DOM manipulation
document.body.appendChild(safeOutput);
","const userInput = new URLSearchParams(window.location.search).get('input');
const safeOutput = document.createElement('div');
safeOutput.textContent = userInput; // Safe DOM manipulation
document.body.appendChild(safeOutput);
",javascript,0
Command Injection,"<?php
$cmd = $_GET['cmd'];
system($cmd); // Command Injection
?>","<?php
$cmd = $_GET['cmd'];
system($cmd); // Command Injection
?>",php,1
Insecure Deserialization,"<?php
$data = $_POST['data'];
unserialize($data); // Insecure Deserialization
?>","<?php
$data = $_POST['data'];
unserialize($data); // Insecure Deserialization
?>",php,1
Clear,"import java.sql.*;

public class SQLInjectionSecure {
    public static void main(String[] args) {
        String userInput = ""'; DROP TABLE users; --""; // Malicious input

        try {
            Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");
            
            String query = ""SELECT * FROM users WHERE username = ?"";
            PreparedStatement pstmt = conn.prepareStatement(query);
            pstmt.setString(1, userInput);
            
            ResultSet rs = pstmt.executeQuery();
            
            while (rs.next()) {
                System.out.println(rs.getString(""username""));
            }
            
            conn.close();
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.*; public class SQLInjectionSecure { public static void main(String[] args) { String userInput = ""'; DROP TABLE users; --""; // Malicious input try { Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); String query = ""SELECT * FROM users WHERE username = ?""; PreparedStatement pstmt = conn.prepareStatement(query); pstmt.setString(1, userInput); ResultSet rs = pstmt.executeQuery(); while (rs.next()) { System.out.println(rs.getString(""username"")); } conn.close(); } catch (SQLException e) { e.printStackTrace(); } } }",java,0
Clear,"import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.ResultSet;

public class SQLInjectionSecureExample {

    public static void main(String[] args) {
        String userInput = ""'; DROP TABLE users; --"";
        
        try {
            Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");
            
            String query = ""SELECT * FROM users WHERE username=?"";
            PreparedStatement pstmt = conn.prepareStatement(query);
            pstmt.setString(1, userInput);
            
            ResultSet rs = pstmt.executeQuery();
            
            while (rs.next()) {
                System.out.println(rs.getString(""username""));
            }
            
            conn.close();
        } catch (Exception e) {
            e.printStackTrace();
        }
    }
}","import java.sql.Connection; import java.sql.DriverManager; import java.sql.PreparedStatement; import java.sql.ResultSet; public class SQLInjectionSecureExample { public static void main(String[] args) { String userInput = ""'; DROP TABLE users; --""; try { Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); String query = ""SELECT * FROM users WHERE username=?""; PreparedStatement pstmt = conn.prepareStatement(query); pstmt.setString(1, userInput); ResultSet rs = pstmt.executeQuery(); while (rs.next()) { System.out.println(rs.getString(""username"")); } conn.close(); } catch (Exception e) { e.printStackTrace(); } } }",java,0
Command Injection,"const shell = require('child_process');
shell.exec('ping ' + userInput); // Command Injection
","const shell = require('child_process');
shell.exec('ping ' + userInput); // Command Injection
",javascript,1
Clear,"import java.util.Scanner;

public class SecureBuffer {
    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        
        System.out.print(""Enter a string: "");
        String userInput = scanner.nextLine();
        
        int bufferSize = 10;
        char[] buffer = new char[bufferSize];
        
        if (userInput.length() > bufferSize) {
            System.out.println(""Input string exceeds buffer size. Please enter a shorter string."");
            return;
        }
        
        userInput.getChars(0, userInput.length(), buffer, 0);
        
        System.out.println(""Buffer contents: "" + new String(buffer));
    }
}","import java.util.Scanner; public class SecureBuffer { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter a string: ""); String userInput = scanner.nextLine(); int bufferSize = 10; char[] buffer = new char[bufferSize]; if (userInput.length() > bufferSize) { System.out.println(""Input string exceeds buffer size. Please enter a shorter string.""); return; } userInput.getChars(0, userInput.length(), buffer, 0); System.out.println(""Buffer contents: "" + new String(buffer)); } }",java,0
XSS,"const userInput = document.location.search.split('=')[1];
document.write(userInput); // XSS
","const userInput = document.location.search.split('=')[1];
document.write(userInput); // XSS
",javascript,1
Clear,"#include <stdio.h>
#include <stdlib.h>

int safe_string_to_int(const char *str) {
    char *endptr;
    long value = strtol(str, &endptr, 10);
    if (*endptr != '\0' || str == endptr) {
        return -1; // error
    }
    return (int)value;
}","#include <stdio.h>
#include <stdlib.h>

int safe_string_to_int(const char *str) {
    char *endptr;
    long value = strtol(str, &endptr, 10);
    if (*endptr != '\0' || str == endptr) {
        return -1; // error
    }
    return (int)value;
}",c,0
Command Injection,"<?php
$cmd = $_GET['cmd'];
system($cmd); // Command Injection
?>","<?php
$cmd = $_GET['cmd'];
system($cmd); // Command Injection
?>",php,1
Clear,"import java.io.File;
import java.io.FileInputStream;
import java.io.IOException;
import java.util.Scanner;

public class SecurePathTraversal {

    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        System.out.print(""Enter the file name: "");
        String fileName = scanner.next();

        if (!isValidFileName(fileName)) {
            System.out.println(""Invalid file name."");
            return;
        }

        File file = new File(fileName);

        try {
            FileInputStream fis = new FileInputStream(file);
            int content;
            while ((content = fis.read()) != -1) {
                System.out.print((char) content);
            }
            fis.close();
        } catch (IOException e) {
            System.out.println(""File not found or an error occurred."");
        }
    }

    private static boolean isValidFileName(String fileName) {
        // Check if the file name contains any directory traversal characters
        return !fileName.contains("".."");
    }
}","import java.io.File; import java.io.FileInputStream; import java.io.IOException; import java.util.Scanner; public class SecurePathTraversal { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter the file name: ""); String fileName = scanner.next(); if (!isValidFileName(fileName)) { System.out.println(""Invalid file name.""); return; } File file = new File(fileName); try { FileInputStream fis = new FileInputStream(file); int content; while ((content = fis.read()) != -1) { System.out.print((char) content); } fis.close(); } catch (IOException e) { System.out.println(""File not found or an error occurred.""); } } private static boolean isValidFileName(String fileName) { // Check if the file name contains any directory traversal characters return !fileName.contains(""..""); } }",java,0
Clear,"#include <stdio.h>
#include <string.h>

void safe_string_copy(char *dest, const char *src, size_t dest_size) {
    if (dest_size > 0) {
        strncpy(dest, src, dest_size - 1);
        dest[dest_size - 1] = '\0';
    }
}","#include <stdio.h>
#include <string.h>

void safe_string_copy(char *dest, const char *src, size_t dest_size) {
    if (dest_size > 0) {
        strncpy(dest, src, dest_size - 1);
        dest[dest_size - 1] = '\0';
    }
}",c,0
Path Traversal,"import java.io.File;
import java.io.FileInputStream;
import java.io.IOException;
import java.util.Scanner;

public class PathTraversalVulnerability {
    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        System.out.print(""Enter file name: "");
        String fileName = scanner.nextLine();
        
        try {
            File file = new File(""/path/to/directory/"" + fileName);
            FileInputStream fis = new FileInputStream(file);
            
            int data;
            while ((data = fis.read()) != -1) {
                System.out.print((char) data);
            }
            
            fis.close();
        } catch (IOException e) {
            System.out.println(""Error reading file: "" + e.getMessage());
        }
    }
}","import java.io.File; import java.io.FileInputStream; import java.io.IOException; import java.util.Scanner; public class PathTraversalVulnerability { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter file name: ""); String fileName = scanner.nextLine(); try { File file = new File(""/path/to/directory/"" + fileName); FileInputStream fis = new FileInputStream(file); int data; while ((data = fis.read()) != -1) { System.out.print((char) data); } fis.close(); } catch (IOException e) { System.out.println(""Error reading file: "" + e.getMessage()); } } }",java,1
Command Injection,"import os
def backup_database(db_name):
    os.system(f""pg_dump {db_name} > backup.sql"")","import os
def backup_database(db_name):
    os.system(f""pg_dump {db_name} > backup.sql"")",python,1
Clear,"To fix the buffer overflow vulnerability in the provided Java code snippet, you can implement proper bounds checking to ensure that the user input does not exceed the size of the buffer. Here's an improved version of the code that addresses this issue:

```java
import java.util.Scanner;

public class SecureBuffer {
    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        
        System.out.print(""Enter a string: "");
        String input = scanner.nextLine();
        
        // Define a maximum buffer size
        int maxSize = 10;
        
        // Ensure input does not exceed buffer size
        if (input.length() > maxSize) {
            System.out.println(""Input exceeds buffer size. Please enter a shorter string."");
            return;
        }
        
        char[] buffer = new char[maxSize]; // Fixed size buffer
        
        // Copy user input into the fixed size buffer with bounds checking
        for (int i = 0; i < input.length() && i < maxSize; i++) {
            buffer[i] = input.charAt(i);
        }
        
        // Accessing index within the bounds of the buffer
        System.out.println(""Buffer content: "" + new String(buffer));
        
        scanner.close();","To fix the buffer overflow vulnerability in the provided Java code snippet, you can implement proper bounds checking to ensure that the user input does not exceed the size of the buffer. Here's an improved version of the code that addresses this issue: ```java import java.util.Scanner; public class SecureBuffer { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter a string: ""); String input = scanner.nextLine(); // Define a maximum buffer size int maxSize = 10; // Ensure input does not exceed buffer size if (input.length() > maxSize) { System.out.println(""Input exceeds buffer size. Please enter a shorter string.""); return; } char[] buffer = new char[maxSize]; // Fixed size buffer // Copy user input into the fixed size buffer with bounds checking for (int i = 0; i < input.length() && i < maxSize; i++) { buffer[i] = input.charAt(i); } // Accessing index within the bounds of the buffer System.out.println(""Buffer content: "" + new String(buffer)); scanner.close();",java,0
Clear,"const userData = JSON.parse(userInput); // Safe JSON parsing
if (userData && typeof userData === 'object') {
    processUserData(userData);
}
","const userData = JSON.parse(userInput); // Safe JSON parsing
if (userData && typeof userData === 'object') {
    processUserData(userData);
}
",javascript,0
Command Injection,"import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class CommandInjectionExample {
    public static void main(String[] args) {
        try {
            BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));
            System.out.print(""Enter a file name to display its contents: "");
            String fileName = reader.readLine();

            // Vulnerable code - user input directly used in command execution
            String command = ""cat "" + fileName;
            Process process = Runtime.getRuntime().exec(command);

            BufferedReader outputReader = new BufferedReader(new InputStreamReader(process.getInputStream()));
            String line;
            while ((line = outputReader.readLine()) != null) {
                System.out.println(line);
            }
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}","import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class CommandInjectionExample { public static void main(String[] args) { try { BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a file name to display its contents: ""); String fileName = reader.readLine(); // Vulnerable code - user input directly used in command execution String command = ""cat "" + fileName; Process process = Runtime.getRuntime().exec(command); BufferedReader outputReader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = outputReader.readLine()) != null) { System.out.println(line); } } catch (IOException e) { e.printStackTrace(); } } }",java,1
Cross-Site Scripting (XSS),"from flask import Flask, request
app = Flask(__name__)

@app.route('/search')
def search():
    query = request.args.get('q', '')
    return f'<h1>Search results for: {query}</h1>'","from flask import Flask, request
app = Flask(__name__)

@app.route('/search')
def search():
    query = request.args.get('q', '')
    return f'<h1>Search results for: {query}</h1>'",python,1
Command Injection,"import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class CommandInjectionDemo {
    public static void main(String[] args) {
        try {
            BufferedReader br = new BufferedReader(new InputStreamReader(System.in));
            System.out.print(""Enter a command to execute: "");
            String command = br.readLine();

            // Vulnerable code - directly executing user input as a command
            Process process = Runtime.getRuntime().exec(command);

            BufferedReader reader = new BufferedReader(new InputStreamReader(process.getInputStream()));
            String line;
            while ((line = reader.readLine()) != null) {
                System.out.println(line);
            }
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}","import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class CommandInjectionDemo { public static void main(String[] args) { try { BufferedReader br = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a command to execute: ""); String command = br.readLine(); // Vulnerable code - directly executing user input as a command Process process = Runtime.getRuntime().exec(command); BufferedReader reader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = reader.readLine()) != null) { System.out.println(line); } } catch (IOException e) { e.printStackTrace(); } } }",java,1
Clear,"<?php
$file = basename($_GET['file']);
$allowed = ['page1.php', 'page2.php'];
if (in_array($file, $allowed)) {
    include($file);
}
?>","<?php
$file = basename($_GET['file']);
$allowed = ['page1.php', 'page2.php'];
if (in_array($file, $allowed)) {
    include($file);
}
?>",php,0
SQL Injection,"import sqlite3
def get_user_data(username):
    conn = sqlite3.connect('database.db')
    cursor = conn.cursor()
    query = ""SELECT * FROM users WHERE username = '"" + username + ""'""
    cursor.execute(query)
    return cursor.fetchall()","import sqlite3
def get_user_data(username):
    conn = sqlite3.connect('database.db')
    cursor = conn.cursor()
    query = ""SELECT * FROM users WHERE username = '"" + username + ""'""
    cursor.execute(query)
    return cursor.fetchall()",python,1
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Clear,"To fix the Path Traversal vulnerability in the given Java code snippet, you need to ensure that the user input for the file name is properly validated to prevent directory traversal attacks. One common approach is to use a whitelist approach where you restrict the user input to a specific directory or file pattern.

Here's an improved version of the code with proper security measures:

```java
import java.io.File;
import java.io.IOException;
import java.nio.file.Files;
import java.util.Scanner;

public class SecurePathTraversal {

    private static final String BASE_DIRECTORY = ""C:/data/"";

    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);

        System.out.println(""Enter the file name to read:"");
        String fileName = scanner.nextLine();

        if (!isValidFileName(fileName)) {
            System.out.println(""Invalid file name."");
            return;
        }

        File file = new File(BASE_DIRECTORY + fileName);

        try {
            byte[] fileContent = Files.readAllBytes(file.toPath());
            String content = new String(fileContent);
            System.out.println(""File content: "" + content);
        } catch (IOException e) {
            System.out.println(""Error reading file: "" + e.getMessage());
        }

        scanner.close","To fix the Path Traversal vulnerability in the given Java code snippet, you need to ensure that the user input for the file name is properly validated to prevent directory traversal attacks. One common approach is to use a whitelist approach where you restrict the user input to a specific directory or file pattern. Here's an improved version of the code with proper security measures: ```java import java.io.File; import java.io.IOException; import java.nio.file.Files; import java.util.Scanner; public class SecurePathTraversal { private static final String BASE_DIRECTORY = ""C:/data/""; public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.println(""Enter the file name to read:""); String fileName = scanner.nextLine(); if (!isValidFileName(fileName)) { System.out.println(""Invalid file name.""); return; } File file = new File(BASE_DIRECTORY + fileName); try { byte[] fileContent = Files.readAllBytes(file.toPath()); String content = new String(fileContent); System.out.println(""File content: "" + content); } catch (IOException e) { System.out.println(""Error reading file: "" + e.getMessage()); } scanner.close",java,0
File Inclusion,"<?php
$file = $_GET['file'];
include($file); // File Inclusion
?>","<?php
$file = $_GET['file'];
include($file); // File Inclusion
?>",php,1
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Buffer Overflow,"import java.util.Scanner;

public class BufferOverflowVulnerability {
    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        
        System.out.print(""Enter your name: "");
        String name = scanner.nextLine();
        
        // Assuming the input string length is limited to 10 characters
        char[] buffer = new char[10];
        
        // Copy the user input into the buffer without checking the length
        name.getChars(0, name.length(), buffer, 0);
        
        System.out.println(""Welcome, "" + new String(buffer));
    }
}","import java.util.Scanner; public class BufferOverflowVulnerability { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter your name: ""); String name = scanner.nextLine(); // Assuming the input string length is limited to 10 characters char[] buffer = new char[10]; // Copy the user input into the buffer without checking the length name.getChars(0, name.length(), buffer, 0); System.out.println(""Welcome, "" + new String(buffer)); } }",java,1
Cross-Site Scripting (XSS),"import java.io.*;
import javax.servlet.*;
import javax.servlet.http.*;

public class VulnerableServlet extends HttpServlet {
    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        String userInput = request.getParameter(""input"");
        PrintWriter out = response.getWriter();
        out.println(""<html><body>"");
        out.println(""User input: "" + userInput); // Unsafe user input directly printed to the HTML response
        out.println(""</body></html>"");
    }
}","import java.io.*; import javax.servlet.*; import javax.servlet.http.*; public class VulnerableServlet extends HttpServlet { protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { String userInput = request.getParameter(""input""); PrintWriter out = response.getWriter(); out.println(""<html><body>""); out.println(""User input: "" + userInput); // Unsafe user input directly printed to the HTML response out.println(""</body></html>""); } }",java,1
Clear,"#include <iostream>
#include <string>
#include <vector>

void safe_string_handling(const std::string& input) {
    std::string safe_copy = input;
    std::cout << safe_copy << std::endl;
}","#include <iostream>
#include <string>
#include <vector>

void safe_string_handling(const std::string& input) {
    std::string safe_copy = input;
    std::cout << safe_copy << std::endl;
}",cpp,0
SSRF,"import urllib.request
def download_file(file_url):
    return urllib.request.urlopen(file_url).read()","import urllib.request
def download_file(file_url):
    return urllib.request.urlopen(file_url).read()",python,1
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Clear,"const userData = JSON.parse(userInput); // Safe JSON parsing
if (userData && typeof userData === 'object') {
    processUserData(userData);
}
","const userData = JSON.parse(userInput); // Safe JSON parsing
if (userData && typeof userData === 'object') {
    processUserData(userData);
}
",javascript,0
Clear,"import java.sql.*;

public class SecureCode {

    public static void main(String[] args) {
        String userInput = ""'; DROP TABLE users; --""; // Malicious input simulating SQL Injection

        try {
            Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");

            // Using prepared statement for secure parameterized query
            String query = ""SELECT * FROM users WHERE username = ?"";
            PreparedStatement pstmt = conn.prepareStatement(query);
            pstmt.setString(1, userInput);

            ResultSet rs = pstmt.executeQuery();

            while (rs.next()) {
                System.out.println(""User found: "" + rs.getString(""username""));
            }

        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.*; public class SecureCode { public static void main(String[] args) { String userInput = ""'; DROP TABLE users; --""; // Malicious input simulating SQL Injection try { Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); // Using prepared statement for secure parameterized query String query = ""SELECT * FROM users WHERE username = ?""; PreparedStatement pstmt = conn.prepareStatement(query); pstmt.setString(1, userInput); ResultSet rs = pstmt.executeQuery(); while (rs.next()) { System.out.println(""User found: "" + rs.getString(""username"")); } } catch (SQLException e) { e.printStackTrace(); } } }",java,0
Command Injection,"import java.io.*;

public class CommandInjectionExample {

    public static void main(String[] args) throws IOException {
        BufferedReader br = new BufferedReader(new InputStreamReader(System.in));
        System.out.print(""Enter a command to execute: "");
        String command = br.readLine();
        
        Process process = Runtime.getRuntime().exec(""echo "" + command);
        
        BufferedReader reader = new BufferedReader(new InputStreamReader(process.getInputStream()));
        String line;
        
        while ((line = reader.readLine()) != null) {
            System.out.println(line);
        }
        
        process.waitFor();
    }
}","import java.io.*; public class CommandInjectionExample { public static void main(String[] args) throws IOException { BufferedReader br = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a command to execute: ""); String command = br.readLine(); Process process = Runtime.getRuntime().exec(""echo "" + command); BufferedReader reader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = reader.readLine()) != null) { System.out.println(line); } process.waitFor(); } }",java,1
Clear,"<?php
$username = $_POST['username'];
$stmt = $pdo->prepare(""SELECT * FROM users WHERE username = ?"");
$stmt->execute([$username]); // Parameterized query
?>","<?php
$username = $_POST['username'];
$stmt = $pdo->prepare(""SELECT * FROM users WHERE username = ?"");
$stmt->execute([$username]); // Parameterized query
?>",php,0
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Clear,"#include <iostream>
#include <string>
#include <vector>

void safe_string_handling(const std::string& input) {
    std::string safe_copy = input;
    std::cout << safe_copy << std::endl;
}","#include <iostream>
#include <string>
#include <vector>

void safe_string_handling(const std::string& input) {
    std::string safe_copy = input;
    std::cout << safe_copy << std::endl;
}",cpp,0
Clear,"<?php
$file = basename($_GET['file']);
$allowed = ['page1.php', 'page2.php'];
if (in_array($file, $allowed)) {
    include($file);
}
?>","<?php
$file = basename($_GET['file']);
$allowed = ['page1.php', 'page2.php'];
if (in_array($file, $allowed)) {
    include($file);
}
?>",php,0
Command Injection,"import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class CommandInjectionVulnerability {

    public static void main(String[] args) {
        try {
            BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));
            System.out.print(""Enter a command to execute: "");
            String userInput = reader.readLine();

            // This is where the vulnerability exists - user input is directly passed to the system command
            Process process = Runtime.getRuntime().exec(""ping "" + userInput);

            BufferedReader inputReader = new BufferedReader(new InputStreamReader(process.getInputStream()));
            String line;
            while ((line = inputReader.readLine()) != null) {
                System.out.println(line);
            }

        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}","import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class CommandInjectionVulnerability { public static void main(String[] args) { try { BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a command to execute: ""); String userInput = reader.readLine(); // This is where the vulnerability exists - user input is directly passed to the system command Process process = Runtime.getRuntime().exec(""ping "" + userInput); BufferedReader inputReader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = inputReader.readLine()) != null) { System.out.println(line); } } catch (IOException e) { e.printStackTrace(); } } }",java,1
Buffer Overflow,"#include <iostream>
#include <cstdio>

void unsafe_c_input() {
    char buffer[50];
    scanf(""%s"", buffer); // no length limit
    std::cout << buffer << std::endl;
}","#include <iostream>
#include <cstdio>

void unsafe_c_input() {
    char buffer[50];
    scanf(""%s"", buffer); // no length limit
    std::cout << buffer << std::endl;
}",cpp,1
Buffer Overflow,"#include <iostream>
#include <cstring>

void unsafe_c_string(char* input) {
    char buffer[100];
    strcpy(buffer, input); // potential buffer overflow
    std::cout << buffer << std::endl;
}","#include <iostream>
#include <cstring>

void unsafe_c_string(char* input) {
    char buffer[100];
    strcpy(buffer, input); // potential buffer overflow
    std::cout << buffer << std::endl;
}",cpp,1
Clear,"import java.util.Scanner;

public class SecureBufferInput {
    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        
        System.out.print(""Enter your name: "");
        String name = scanner.nextLine();
        
        int maxLength = 10; // Maximum length of input allowed
        if (name.length() > maxLength) {
            name = name.substring(0, maxLength); // Truncate input if it exceeds maxLength
        }
        
        char[] buffer = new char[maxLength];
        name.getChars(0, Math.min(name.length(), maxLength), buffer, 0); // Copy input to buffer
        
        System.out.println(""Hello, "" + new String(buffer));
    }
}","import java.util.Scanner; public class SecureBufferInput { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter your name: ""); String name = scanner.nextLine(); int maxLength = 10; // Maximum length of input allowed if (name.length() > maxLength) { name = name.substring(0, maxLength); // Truncate input if it exceeds maxLength } char[] buffer = new char[maxLength]; name.getChars(0, Math.min(name.length(), maxLength), buffer, 0); // Copy input to buffer System.out.println(""Hello, "" + new String(buffer)); } }",java,0
Clear,import org.owasp.encoder.Encode;,import org.owasp.encoder.Encode;,python,0
Clear,"#include <iostream>
#include <string>
#include <vector>

void safe_string_handling(const std::string& input) {
    std::string safe_copy = input;
    std::cout << safe_copy << std::endl;
}","#include <iostream>
#include <string>
#include <vector>

void safe_string_handling(const std::string& input) {
    std::string safe_copy = input;
    std::cout << safe_copy << std::endl;
}",cpp,0
Clear,"import os
def get_database_config():
    return {
        'host': os.environ.get('DB_HOST'),
        'user': os.environ.get('DB_USER'),
        'password': os.environ.get('DB_PASSWORD')
    }","import os
def get_database_config():
    return {
        'host': os.environ.get('DB_HOST'),
        'user': os.environ.get('DB_USER'),
        'password': os.environ.get('DB_PASSWORD')
    }",python,0
Path Traversal,"import java.io.BufferedReader;
import java.io.File;
import java.io.FileReader;
import java.io.IOException;

public class FileReadExample {

    public static void main(String[] args) {
        String fileName = args[0]; // Assume user provides the file name as input

        try {
            File file = new File(fileName);
            BufferedReader br = new BufferedReader(new FileReader(file));
            String line;

            while ((line = br.readLine()) != null) {
                System.out.println(line);
            }

            br.close();
        } catch (IOException e) {
            System.out.println(""Error reading file: "" + e.getMessage());
        }
    }
}","import java.io.BufferedReader; import java.io.File; import java.io.FileReader; import java.io.IOException; public class FileReadExample { public static void main(String[] args) { String fileName = args[0]; // Assume user provides the file name as input try { File file = new File(fileName); BufferedReader br = new BufferedReader(new FileReader(file)); String line; while ((line = br.readLine()) != null) { System.out.println(line); } br.close(); } catch (IOException e) { System.out.println(""Error reading file: "" + e.getMessage()); } } }",java,1
Memory Corruption,"#include <iostream>

void unsafe_pointer_arithmetic(int* array, int size) {
    for (int i = 0; i <= size; i++) {
        std::cout << *(array + i) << std::endl; // potential out-of-bounds
    }
}","#include <iostream>

void unsafe_pointer_arithmetic(int* array, int size) {
    for (int i = 0; i <= size; i++) {
        std::cout << *(array + i) << std::endl; // potential out-of-bounds
    }
}",cpp,1
Cross-Site Scripting (XSS),"import java.io.IOException;
import javax.servlet.http.*;

public class XSSVulnerableServlet extends HttpServlet {
    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws IOException {
        String userInput = request.getParameter(""input"");
        String output = ""<html><body>User Input: "" + userInput + ""</body></html>"";
        
        response.getWriter().write(output);
    }
}","import java.io.IOException; import javax.servlet.http.*; public class XSSVulnerableServlet extends HttpServlet { protected void doGet(HttpServletRequest request, HttpServletResponse response) throws IOException { String userInput = request.getParameter(""input""); String output = ""<html><body>User Input: "" + userInput + ""</body></html>""; response.getWriter().write(output); } }",java,1
Clear,"#include <iostream>
#include <vector>
#include <stdexcept>

int safe_vector_access(const std::vector<int>& vec, size_t index) {
    if (index >= vec.size()) {
        throw std::out_of_range(""Index out of range"");
    }
    return vec[index];
}","#include <iostream>
#include <vector>
#include <stdexcept>

int safe_vector_access(const std::vector<int>& vec, size_t index) {
    if (index >= vec.size()) {
        throw std::out_of_range(""Index out of range"");
    }
    return vec[index];
}",cpp,0
Clear,"To fix the Path Traversal vulnerability in the provided Java code snippet, you need to ensure that the user input for the file name is properly validated and sanitized before constructing the file path. Here's an improved version of the code that addresses this security issue:

```java
import java.io.File;
import java.io.IOException;
import java.nio.file.Files;
import java.util.Scanner;

public class SecurePathTraversal {

    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        System.out.print(""Enter file name: "");
        String fileName = scanner.next();

        if (!isValidFileName(fileName)) {
            System.err.println(""Invalid file name."");
            return;
        }

        File directory = new File(""/path/to/directory/"");
        
        try {
            File file = new File(directory, fileName);
            
            if (!file.getCanonicalPath().startsWith(directory.getCanonicalPath() + File.separator)) {
                System.err.println(""Access to files outside directory is not allowed."");
                return;
            }
            
            byte[] fileContent = Files.readAllBytes(file.toPath());
            System.out.println(""File content: "" + new String(fileContent));
        } catch (IOException e) {
            System.err.println(""Error reading file","To fix the Path Traversal vulnerability in the provided Java code snippet, you need to ensure that the user input for the file name is properly validated and sanitized before constructing the file path. Here's an improved version of the code that addresses this security issue: ```java import java.io.File; import java.io.IOException; import java.nio.file.Files; import java.util.Scanner; public class SecurePathTraversal { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter file name: ""); String fileName = scanner.next(); if (!isValidFileName(fileName)) { System.err.println(""Invalid file name.""); return; } File directory = new File(""/path/to/directory/""); try { File file = new File(directory, fileName); if (!file.getCanonicalPath().startsWith(directory.getCanonicalPath() + File.separator)) { System.err.println(""Access to files outside directory is not allowed.""); return; } byte[] fileContent = Files.readAllBytes(file.toPath()); System.out.println(""File content: "" + new String(fileContent)); } catch (IOException e) { System.err.println(""Error reading file",java,0
SQL Injection,"import java.sql.*;

public class SQLInjectionVulnerability {
    public static void main(String[] args) {
        try {
            // Simulating user input (this should come from user input in a real application)
            String userInput = ""'; DROP TABLE users; --"";

            // Improperly handling user input in SQL query
            String query = ""SELECT * FROM users WHERE username = '"" + userInput + ""'"";

            // Establishing connection to the database
            Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");

            // Executing the SQL query
            Statement stmt = conn.createStatement();
            ResultSet rs = stmt.executeQuery(query);

            // Processing the results
            while (rs.next()) {
                System.out.println(rs.getString(""username""));
                System.out.println(rs.getString(""password""));
            }

            // Closing connections
            rs.close();
            stmt.close();
            conn.close();
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.*; public class SQLInjectionVulnerability { public static void main(String[] args) { try { // Simulating user input (this should come from user input in a real application) String userInput = ""'; DROP TABLE users; --""; // Improperly handling user input in SQL query String query = ""SELECT * FROM users WHERE username = '"" + userInput + ""'""; // Establishing connection to the database Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); // Executing the SQL query Statement stmt = conn.createStatement(); ResultSet rs = stmt.executeQuery(query); // Processing the results while (rs.next()) { System.out.println(rs.getString(""username"")); System.out.println(rs.getString(""password"")); } // Closing connections rs.close(); stmt.close(); conn.close(); } catch (SQLException e) { e.printStackTrace(); } } }",java,1
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Buffer Overflow,"import java.util.Scanner;

public class BufferOverflowExample {

    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        System.out.print(""Enter a string: "");
        String input = scanner.nextLine();

        char[] buffer = new char[10];
        
        // Vulnerability: No bounds checking on the input length
        for (int i = 0; i < input.length(); i++) {
            buffer[i] = input.charAt(i);
        }

        System.out.println(""Buffer contents: "" + new String(buffer));
    }
}","import java.util.Scanner; public class BufferOverflowExample { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter a string: ""); String input = scanner.nextLine(); char[] buffer = new char[10]; // Vulnerability: No bounds checking on the input length for (int i = 0; i < input.length(); i++) { buffer[i] = input.charAt(i); } System.out.println(""Buffer contents: "" + new String(buffer)); } }",java,1
SQL Injection,"String username = getUserInput(); // Assume this function gets user input
String query = ""SELECT * FROM users WHERE username='"" + username + ""'"";
Statement statement = connection.createStatement();
ResultSet resultSet = statement.executeQuery(query);","String username = getUserInput(); // Assume this function gets user input String query = ""SELECT * FROM users WHERE username='"" + username + ""'""; Statement statement = connection.createStatement(); ResultSet resultSet = statement.executeQuery(query);",javascript,1
Out-of-Bounds,"#include <iostream>

class UnsafeClass {
    int data[10];
public:
    int get_data(int index) {
        return data[index]; // no bounds checking
    }
};","#include <iostream>

class UnsafeClass {
    int data[10];
public:
    int get_data(int index) {
        return data[index]; // no bounds checking
    }
};",cpp,1
Clear,"To fix the Path Traversal vulnerability in the given Java code snippet, you need to ensure that the user input for the file name is properly sanitized to prevent directory traversal attacks. One way to do this is by using the `Paths` class from `java.nio.file` package to resolve the file path and check if it is within an allowed directory.

Here's an updated version of the code with proper security measures:

```java
import java.io.File;
import java.nio.file.Path;
import java.nio.file.Paths;
import java.util.Scanner;

public class SecurePathTraversal {

    private static final String BASE_DIRECTORY = ""C:/data/"";

    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        
        System.out.println(""Enter file name to read:"");
        String fileName = scanner.nextLine();
        
        // Resolve the file path using Paths.get() to prevent path traversal attacks
        Path filePath = Paths.get(BASE_DIRECTORY, fileName).normalize();
        
        if (filePath.startsWith(Paths.get(BASE_DIRECTORY))) {
            File file = filePath.toFile();
            
            if (file.exists()) {
                System.out.println(""Reading file contents..."");
                // Code to read and display file contents
            } else {
                System.out","To fix the Path Traversal vulnerability in the given Java code snippet, you need to ensure that the user input for the file name is properly sanitized to prevent directory traversal attacks. One way to do this is by using the `Paths` class from `java.nio.file` package to resolve the file path and check if it is within an allowed directory. Here's an updated version of the code with proper security measures: ```java import java.io.File; import java.nio.file.Path; import java.nio.file.Paths; import java.util.Scanner; public class SecurePathTraversal { private static final String BASE_DIRECTORY = ""C:/data/""; public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.println(""Enter file name to read:""); String fileName = scanner.nextLine(); // Resolve the file path using Paths.get() to prevent path traversal attacks Path filePath = Paths.get(BASE_DIRECTORY, fileName).normalize(); if (filePath.startsWith(Paths.get(BASE_DIRECTORY))) { File file = filePath.toFile(); if (file.exists()) { System.out.println(""Reading file contents...""); // Code to read and display file contents } else { System.out",java,0
Clear,"#include <iostream>
#include <memory>

void safe_memory_management() {
    auto ptr = std::make_unique<int>(42);
    std::cout << *ptr << std::endl;
}","#include <iostream>
#include <memory>

void safe_memory_management() {
    auto ptr = std::make_unique<int>(42);
    std::cout << *ptr << std::endl;
}",cpp,0
Clear,"import psycopg2
def safe_admin_query(admin_id):
    conn = psycopg2.connect(""dbname=test user=postgres"")
    cur = conn.cursor()
    cur.execute(""SELECT * FROM admins WHERE id = %s"", (admin_id,))
    return cur.fetchone()","import psycopg2
def safe_admin_query(admin_id):
    conn = psycopg2.connect(""dbname=test user=postgres"")
    cur = conn.cursor()
    cur.execute(""SELECT * FROM admins WHERE id = %s"", (admin_id,))
    return cur.fetchone()",python,0
Command Injection,"import os
def ping_host(host):
    os.system(""ping -c 4 "" + host)","import os
def ping_host(host):
    os.system(""ping -c 4 "" + host)",python,1
Clear,"import java.util.Scanner;

public class SecureBufferExample {
    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        System.out.print(""Enter a string: "");
        String userInput = scanner.nextLine();

        // Implementing proper security measures
        int maxLength = 10; // Maximum length of buffer
        char[] buffer = new char[maxLength];
        
        // Copy only up to maxLength characters from userInput to buffer
        int copyLength = Math.min(userInput.length(), maxLength);
        userInput.getChars(0, copyLength, buffer, 0);

        System.out.println(""Buffer contents: "" + new String(buffer));
    }
}","import java.util.Scanner; public class SecureBufferExample { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter a string: ""); String userInput = scanner.nextLine(); // Implementing proper security measures int maxLength = 10; // Maximum length of buffer char[] buffer = new char[maxLength]; // Copy only up to maxLength characters from userInput to buffer int copyLength = Math.min(userInput.length(), maxLength); userInput.getChars(0, copyLength, buffer, 0); System.out.println(""Buffer contents: "" + new String(buffer)); } }",java,0
Path Traversal,"import java.io.File;
import java.io.FileInputStream;
import java.io.IOException;

public class PathTraversalVulnerability {
    
    public static void main(String[] args) {
        String userProvidedFileName = args[0];
        String directoryPath = ""/path/to/directory/"";
        
        try {
            File file = new File(directoryPath + userProvidedFileName);
            FileInputStream fis = new FileInputStream(file);
            // Read file contents and do something with it
        } catch (IOException e) {
            System.out.println(""Error reading file: "" + e.getMessage());
        }
    }
}","import java.io.File; import java.io.FileInputStream; import java.io.IOException; public class PathTraversalVulnerability { public static void main(String[] args) { String userProvidedFileName = args[0]; String directoryPath = ""/path/to/directory/""; try { File file = new File(directoryPath + userProvidedFileName); FileInputStream fis = new FileInputStream(file); // Read file contents and do something with it } catch (IOException e) { System.out.println(""Error reading file: "" + e.getMessage()); } } }",java,1
XSS,"<?php
echo $_GET['message']; // XSS
?>","<?php
echo $_GET['message']; // XSS
?>",php,1
Clear,"import subprocess
def safe_ping(host):
    import re
    if not re.match(r'^[a-zA-Z0-9.-]+$', host):
        raise ValueError(""Invalid host"")
    result = subprocess.run(['ping', '-c', '4', host], capture_output=True, text=True)
    return result.stdout","import subprocess
def safe_ping(host):
    import re
    if not re.match(r'^[a-zA-Z0-9.-]+$', host):
        raise ValueError(""Invalid host"")
    result = subprocess.run(['ping', '-c', '4', host], capture_output=True, text=True)
    return result.stdout",python,0
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Clear,"import java.util.Scanner;

public class SecureBufferExample {
    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        System.out.print(""Enter a string: "");
        String input = scanner.nextLine();

        int maxLength = Math.min(input.length(), 10); // Limit the input to maximum buffer size
        char[] buffer = new char[10];
        input.getChars(0, maxLength, buffer, 0);

        System.out.println(""Buffer content: "" + new String(buffer));
    }
}","import java.util.Scanner; public class SecureBufferExample { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter a string: ""); String input = scanner.nextLine(); int maxLength = Math.min(input.length(), 10); // Limit the input to maximum buffer size char[] buffer = new char[10]; input.getChars(0, maxLength, buffer, 0); System.out.println(""Buffer content: "" + new String(buffer)); } }",java,0
Command Injection,"import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class CommandInjectionExample {
    public static void main(String[] args) {
        try {
            BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));
            
            System.out.print(""Enter a command to execute: "");
            String userInput = reader.readLine();
            
            // Vulnerable code: executing user input as a command
            Process process = Runtime.getRuntime().exec(userInput);
            
            BufferedReader inputReader = new BufferedReader(new InputStreamReader(process.getInputStream()));
            String line;
            while ((line = inputReader.readLine()) != null) {
                System.out.println(line);
            }
            
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}","import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class CommandInjectionExample { public static void main(String[] args) { try { BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a command to execute: ""); String userInput = reader.readLine(); // Vulnerable code: executing user input as a command Process process = Runtime.getRuntime().exec(userInput); BufferedReader inputReader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = inputReader.readLine()) != null) { System.out.println(line); } } catch (IOException e) { e.printStackTrace(); } } }",java,1
Path Traversal,"import java.io.BufferedReader;
import java.io.FileReader;
import java.io.IOException;
import java.util.Scanner;

public class PathTraversalVulnerabilityExample {

    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        
        System.out.print(""Enter the file name to read: "");
        String fileName = scanner.nextLine();
        
        try {
            BufferedReader br = new BufferedReader(new FileReader(fileName));
            String line;
            while ((line = br.readLine()) != null) {
                System.out.println(line);
            }
            br.close();
        } catch (IOException e) {
            System.out.println(""Error reading the file."");
        }
    }
}","import java.io.BufferedReader; import java.io.FileReader; import java.io.IOException; import java.util.Scanner; public class PathTraversalVulnerabilityExample { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter the file name to read: ""); String fileName = scanner.nextLine(); try { BufferedReader br = new BufferedReader(new FileReader(fileName)); String line; while ((line = br.readLine()) != null) { System.out.println(line); } br.close(); } catch (IOException e) { System.out.println(""Error reading the file.""); } } }",java,1
Clear,"import requests
def safe_fetch_url(url):
    allowed_domains = ['example.com', 'api.trusted.com']
    from urllib.parse import urlparse
    domain = urlparse(url).netloc
    if domain not in allowed_domains:
        raise ValueError(""Domain not allowed"")
    return requests.get(url).text","import requests
def safe_fetch_url(url):
    allowed_domains = ['example.com', 'api.trusted.com']
    from urllib.parse import urlparse
    domain = urlparse(url).netloc
    if domain not in allowed_domains:
        raise ValueError(""Domain not allowed"")
    return requests.get(url).text",python,0
Buffer Overflow,"#include <iostream>
#include <cstdio>

void unsafe_c_input() {
    char buffer[50];
    scanf(""%s"", buffer); // no length limit
    std::cout << buffer << std::endl;
}","#include <iostream>
#include <cstdio>

void unsafe_c_input() {
    char buffer[50];
    scanf(""%s"", buffer); // no length limit
    std::cout << buffer << std::endl;
}",cpp,1
Command Injection,"<?php
$cmd = $_GET['cmd'];
system($cmd); // Command Injection
?>","<?php
$cmd = $_GET['cmd'];
system($cmd); // Command Injection
?>",php,1
Memory Corruption,"#include <iostream>

void unsafe_pointer_arithmetic(int* array, int size) {
    for (int i = 0; i <= size; i++) {
        std::cout << *(array + i) << std::endl; // potential out-of-bounds
    }
}","#include <iostream>

void unsafe_pointer_arithmetic(int* array, int size) {
    for (int i = 0; i <= size; i++) {
        std::cout << *(array + i) << std::endl; // potential out-of-bounds
    }
}",cpp,1
Command Injection,"const shell = require('child_process');
shell.exec('ping ' + userInput); // Command Injection
","const shell = require('child_process');
shell.exec('ping ' + userInput); // Command Injection
",javascript,1
Clear,"<?php
$file = basename($_GET['file']);
$allowed = ['page1.php', 'page2.php'];
if (in_array($file, $allowed)) {
    include($file);
}
?>","<?php
$file = basename($_GET['file']);
$allowed = ['page1.php', 'page2.php'];
if (in_array($file, $allowed)) {
    include($file);
}
?>",php,0
Clear,"const token = process.env.API_TOKEN; // Environment variable
fetch('/api/data', {
    headers: { 'Authorization': `Bearer ${token}` }
});
","const token = process.env.API_TOKEN; // Environment variable
fetch('/api/data', {
    headers: { 'Authorization': `Bearer ${token}` }
});
",javascript,0
Buffer Overflow,"#include <iostream>
#include <cstdio>

void unsafe_c_input() {
    char buffer[50];
    scanf(""%s"", buffer); // no length limit
    std::cout << buffer << std::endl;
}","#include <iostream>
#include <cstdio>

void unsafe_c_input() {
    char buffer[50];
    scanf(""%s"", buffer); // no length limit
    std::cout << buffer << std::endl;
}",cpp,1
Clear,"import java.io.*;
import javax.servlet.*;
import javax.servlet.http.*;
import org.owasp.esapi.ESAPI;

public class SecureServlet extends HttpServlet {
    protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        String userInput = request.getParameter(""input"");
        PrintWriter out = response.getWriter();
        
        out.println(""<html>"");
        out.println(""<body>"");
        out.println(""<h1>User Input: "" + ESAPI.encoder().encodeForHTML(userInput) + ""</h1>""); // Properly encode user input using ESAPI
        out.println(""</body>"");
        out.println(""</html>"");
    }
}","import java.io.*; import javax.servlet.*; import javax.servlet.http.*; import org.owasp.esapi.ESAPI; public class SecureServlet extends HttpServlet { protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { String userInput = request.getParameter(""input""); PrintWriter out = response.getWriter(); out.println(""<html>""); out.println(""<body>""); out.println(""<h1>User Input: "" + ESAPI.encoder().encodeForHTML(userInput) + ""</h1>""); // Properly encode user input using ESAPI out.println(""</body>""); out.println(""</html>""); } }",java,0
Clear,"#include <stdio.h>
#include <stdlib.h>

int safe_string_to_int(const char *str) {
    char *endptr;
    long value = strtol(str, &endptr, 10);
    if (*endptr != '\0' || str == endptr) {
        return -1; // error
    }
    return (int)value;
}","#include <stdio.h>
#include <stdlib.h>

int safe_string_to_int(const char *str) {
    char *endptr;
    long value = strtol(str, &endptr, 10);
    if (*endptr != '\0' || str == endptr) {
        return -1; // error
    }
    return (int)value;
}",c,0
Clear,"import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;

public class SQLInjectionFixed {

    public static void main(String[] args) {
        String userInput = ""'; DROP TABLE users; --""; // Malicious input

        String url = ""jdbc:mysql://localhost:3306/mydatabase"";
        String username = ""root"";
        String password = ""password"";

        try {
            Connection connection = DriverManager.getConnection(url, username, password);

            // Use PreparedStatement to prevent SQL Injection
            String query = ""SELECT * FROM users WHERE username=?"";
            PreparedStatement statement = connection.prepareStatement(query);
            statement.setString(1, userInput);

            ResultSet resultSet = statement.executeQuery();

            while (resultSet.next()) {
                System.out.println(""User found: "" + resultSet.getString(""username""));
            }

            resultSet.close();
            statement.close();
            connection.close();
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.Connection; import java.sql.DriverManager; import java.sql.PreparedStatement; import java.sql.ResultSet; import java.sql.SQLException; public class SQLInjectionFixed { public static void main(String[] args) { String userInput = ""'; DROP TABLE users; --""; // Malicious input String url = ""jdbc:mysql://localhost:3306/mydatabase""; String username = ""root""; String password = ""password""; try { Connection connection = DriverManager.getConnection(url, username, password); // Use PreparedStatement to prevent SQL Injection String query = ""SELECT * FROM users WHERE username=?""; PreparedStatement statement = connection.prepareStatement(query); statement.setString(1, userInput); ResultSet resultSet = statement.executeQuery(); while (resultSet.next()) { System.out.println(""User found: "" + resultSet.getString(""username"")); } resultSet.close(); statement.close(); connection.close(); } catch (SQLException e) { e.printStackTrace(); } } }",java,0
Clear,"import subprocess
def safe_directory_listing(path):
    result = subprocess.run(['ls', path], capture_output=True, text=True)
    return result.stdout","import subprocess
def safe_directory_listing(path):
    result = subprocess.run(['ls', path], capture_output=True, text=True)
    return result.stdout",python,0
Clear,"import java.io.*;
import java.util.*;
import org.owasp.encoder.Encode;

public class XSSSecureCode {

    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        
        System.out.print(""Enter your name: "");
        String name = scanner.nextLine();
        
        String safeName = Encode.forHtml(name); // Sanitize user input
        
        System.out.println(""Hello, "" + safeName + ""!"");
        
        scanner.close();
    }
}","import java.io.*; import java.util.*; import org.owasp.encoder.Encode; public class XSSSecureCode { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter your name: ""); String name = scanner.nextLine(); String safeName = Encode.forHtml(name); // Sanitize user input System.out.println(""Hello, "" + safeName + ""!""); scanner.close(); } }",java,0
Clear,"import java.io.*;
import javax.servlet.*;
import javax.servlet.http.*;
import org.owasp.esapi.ESAPI;
import org.owasp.esapi.Encoder;

public class XSSFixedServlet extends HttpServlet {
    protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        String userInput = request.getParameter(""input"");

        // Properly encode user input to prevent XSS
        Encoder encoder = ESAPI.encoder();
        String safeUserInput = encoder.encodeForHTML(userInput);

        String output = ""<p>User input: "" + safeUserInput + ""</p>"";

        PrintWriter out = response.getWriter();
        out.println(output);
    }
}","import java.io.*; import javax.servlet.*; import javax.servlet.http.*; import org.owasp.esapi.ESAPI; import org.owasp.esapi.Encoder; public class XSSFixedServlet extends HttpServlet { protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { String userInput = request.getParameter(""input""); // Properly encode user input to prevent XSS Encoder encoder = ESAPI.encoder(); String safeUserInput = encoder.encodeForHTML(userInput); String output = ""<p>User input: "" + safeUserInput + ""</p>""; PrintWriter out = response.getWriter(); out.println(output); } }",java,0
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Clear,"import psycopg2
def safe_admin_query(admin_id):
    conn = psycopg2.connect(""dbname=test user=postgres"")
    cur = conn.cursor()
    cur.execute(""SELECT * FROM admins WHERE id = %s"", (admin_id,))
    return cur.fetchone()","import psycopg2
def safe_admin_query(admin_id):
    conn = psycopg2.connect(""dbname=test user=postgres"")
    cur = conn.cursor()
    cur.execute(""SELECT * FROM admins WHERE id = %s"", (admin_id,))
    return cur.fetchone()",python,0
Clear,"To fix the insecure deserialization vulnerability in the given Java code snippet, you need to implement proper security measures to prevent malicious code execution during deserialization. Here are some steps you can take to secure the code:

1. Use a Secure Deserialization Framework: Instead of directly deserializing objects using ObjectInputStream, consider using a secure deserialization framework such as Jackson Databind with added security measures or Google's GSON library with TypeAdapters for safer deserialization.

2. Implement Input Validation: Validate the serialized input data before deserializing it to ensure that it comes from a trusted and expected source. You can use cryptographic signatures or checksums to verify the integrity of the serialized data.

3. Implement a Whitelist Approach: Maintain a whitelist of allowed classes that can be deserialized and validate that the incoming serialized object belongs to one of these whitelisted classes.

4. Use Serialization Filters: If your serialization framework supports it, consider using serialization filters or custom serialization mechanisms to control and restrict which classes can be deserialized.

5. Avoid Serializable Interface: Instead of implementing the Serializable interface in your classes, consider using alternative serialization methods like JSON or XML serialization, which are less prone to security vulnerabilities.

Here is an updated version of your code","To fix the insecure deserialization vulnerability in the given Java code snippet, you need to implement proper security measures to prevent malicious code execution during deserialization. Here are some steps you can take to secure the code: 1. Use a Secure Deserialization Framework: Instead of directly deserializing objects using ObjectInputStream, consider using a secure deserialization framework such as Jackson Databind with added security measures or Google's GSON library with TypeAdapters for safer deserialization. 2. Implement Input Validation: Validate the serialized input data before deserializing it to ensure that it comes from a trusted and expected source. You can use cryptographic signatures or checksums to verify the integrity of the serialized data. 3. Implement a Whitelist Approach: Maintain a whitelist of allowed classes that can be deserialized and validate that the incoming serialized object belongs to one of these whitelisted classes. 4. Use Serialization Filters: If your serialization framework supports it, consider using serialization filters or custom serialization mechanisms to control and restrict which classes can be deserialized. 5. Avoid Serializable Interface: Instead of implementing the Serializable interface in your classes, consider using alternative serialization methods like JSON or XML serialization, which are less prone to security vulnerabilities. Here is an updated version of your code",php,0
Hardcoded Secrets,"localStorage.setItem('token', 'hardcoded-secret-token-123'); // Hardcoded secret
","localStorage.setItem('token', 'hardcoded-secret-token-123'); // Hardcoded secret
",javascript,1
Command Injection,"const shell = require('child_process');
shell.exec('ping ' + userInput); // Command Injection
","const shell = require('child_process');
shell.exec('ping ' + userInput); // Command Injection
",javascript,1
Out-of-Bounds,"#include <iostream>

class UnsafeClass {
    int data[10];
public:
    int get_data(int index) {
        return data[index]; // no bounds checking
    }
};","#include <iostream>

class UnsafeClass {
    int data[10];
public:
    int get_data(int index) {
        return data[index]; // no bounds checking
    }
};",cpp,1
Clear,"<?php
$message = htmlspecialchars($_GET['message'], ENT_QUOTES, 'UTF-8');
echo $message; // Sanitized output
?>","<?php
$message = htmlspecialchars($_GET['message'], ENT_QUOTES, 'UTF-8');
echo $message; // Sanitized output
?>",php,0
SQL Injection,"<?php
$username = $_POST['username'];
$query = ""SELECT * FROM users WHERE username = '$username'"";
$result = mysql_query($query); // SQL Injection
?>","<?php
$username = $_POST['username'];
$query = ""SELECT * FROM users WHERE username = '$username'"";
$result = mysql_query($query); // SQL Injection
?>",php,1
Clear,"const shell = require('child_process');
const safeInput = userInput.replace(/[^a-zA-Z0-9.]/g, '');
shell.execFile('ping', [safeInput]); // Safe command execution
","const shell = require('child_process');
const safeInput = userInput.replace(/[^a-zA-Z0-9.]/g, '');
shell.execFile('ping', [safeInput]); // Safe command execution
",javascript,0
Clear,"import yaml
def safe_yaml_load(config_str):
    return yaml.safe_load(config_str)","import yaml
def safe_yaml_load(config_str):
    return yaml.safe_load(config_str)",python,0
SQL Injection,"import java.sql.*;

public class SQLInjectionVulnerability {

    public static void main(String[] args) {
        String userInput = ""'; DROP TABLE users; --""; // User input containing malicious SQL code

        try {
            Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");
            Statement stmt = conn.createStatement();

            // Vulnerable code: Concatenating user input directly into the SQL query
            String query = ""SELECT * FROM users WHERE username = '"" + userInput + ""'"";
            ResultSet rs = stmt.executeQuery(query);

            while (rs.next()) {
                System.out.println(""User found: "" + rs.getString(""username""));
            }

            conn.close();
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.*; public class SQLInjectionVulnerability { public static void main(String[] args) { String userInput = ""'; DROP TABLE users; --""; // User input containing malicious SQL code try { Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); Statement stmt = conn.createStatement(); // Vulnerable code: Concatenating user input directly into the SQL query String query = ""SELECT * FROM users WHERE username = '"" + userInput + ""'""; ResultSet rs = stmt.executeQuery(query); while (rs.next()) { System.out.println(""User found: "" + rs.getString(""username"")); } conn.close(); } catch (SQLException e) { e.printStackTrace(); } } }",java,1
SSRF,"import requests
def fetch_url(url):
    return requests.get(url).text","import requests
def fetch_url(url):
    return requests.get(url).text",python,1
Command Injection,"<?php
$cmd = $_GET['cmd'];
system($cmd); // Command Injection
?>","<?php
$cmd = $_GET['cmd'];
system($cmd); // Command Injection
?>",php,1
SSRF,"import urllib.request
def download_file(file_url):
    return urllib.request.urlopen(file_url).read()","import urllib.request
def download_file(file_url):
    return urllib.request.urlopen(file_url).read()",python,1
Clear,"#include <iostream>
#include <vector>
#include <stdexcept>

int safe_vector_access(const std::vector<int>& vec, size_t index) {
    if (index >= vec.size()) {
        throw std::out_of_range(""Index out of range"");
    }
    return vec[index];
}","#include <iostream>
#include <vector>
#include <stdexcept>

int safe_vector_access(const std::vector<int>& vec, size_t index) {
    if (index >= vec.size()) {
        throw std::out_of_range(""Index out of range"");
    }
    return vec[index];
}",cpp,0
Cross-Site Scripting (XSS),"from flask import Flask, request
app = Flask(__name__)

@app.route('/search')
def search():
    query = request.args.get('q', '')
    return f'<h1>Search results for: {query}</h1>'","from flask import Flask, request
app = Flask(__name__)

@app.route('/search')
def search():
    query = request.args.get('q', '')
    return f'<h1>Search results for: {query}</h1>'",python,1
SQL Injection,"<?php
$username = $_POST['username'];
$query = ""SELECT * FROM users WHERE username = '$username'"";
$result = mysql_query($query); // SQL Injection
?>","<?php
$username = $_POST['username'];
$query = ""SELECT * FROM users WHERE username = '$username'"";
$result = mysql_query($query); // SQL Injection
?>",php,1
Insecure Deserialization,"import pickle
def load_user_data(filename):
    with open(filename, 'rb') as f:
        data = pickle.load(f)
    return data","import pickle
def load_user_data(filename):
    with open(filename, 'rb') as f:
        data = pickle.load(f)
    return data",python,1
Clear,"import java.sql.*;

public class SecureSQLInjection {
    public static void main(String[] args) {
        String userInput = args[0]; // Simulating user input

        try {
            // Establish connection to the database
            Connection connection = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");

            // Prepared statement with parameterized query
            String query = ""SELECT * FROM users WHERE username = ?"";
            PreparedStatement preparedStatement = connection.prepareStatement(query);
            preparedStatement.setString(1, userInput);

            // Execute the query
            ResultSet resultSet = preparedStatement.executeQuery();

            // Process the results
            while(resultSet.next()) {
                System.out.println(""User ID: "" + resultSet.getInt(""id"") + "", Username: "" + resultSet.getString(""username""));
            }

            // Close connections
            resultSet.close();
            preparedStatement.close();
            connection.close();
        } catch (SQLException e) {
           e.printStackTrace();
        }
    }
}","import java.sql.*; public class SecureSQLInjection { public static void main(String[] args) { String userInput = args[0]; // Simulating user input try { // Establish connection to the database Connection connection = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); // Prepared statement with parameterized query String query = ""SELECT * FROM users WHERE username = ?""; PreparedStatement preparedStatement = connection.prepareStatement(query); preparedStatement.setString(1, userInput); // Execute the query ResultSet resultSet = preparedStatement.executeQuery(); // Process the results while(resultSet.next()) { System.out.println(""User ID: "" + resultSet.getInt(""id"") + "", Username: "" + resultSet.getString(""username"")); } // Close connections resultSet.close(); preparedStatement.close(); connection.close(); } catch (SQLException e) { e.printStackTrace(); } } }",java,0
Clear,"#include <iostream>
#include <fstream>
#include <string>

void safe_file_reading(const std::string& filename) {
    std::ifstream file(filename);
    if (file.is_open()) {
        std::string line;
        while (std::getline(file, line)) {
            std::cout << line << std::endl;
        }
    }
}","#include <iostream>
#include <fstream>
#include <string>

void safe_file_reading(const std::string& filename) {
    std::ifstream file(filename);
    if (file.is_open()) {
        std::string line;
        while (std::getline(file, line)) {
            std::cout << line << std::endl;
        }
    }
}",cpp,0
Path Traversal,"def get_user_file(username, filepath):
    import os
    base_path = f""/home/{username}/files/""
    full_path = base_path + filepath
    with open(full_path, 'r') as f:
        return f.read()","def get_user_file(username, filepath):
    import os
    base_path = f""/home/{username}/files/""
    full_path = base_path + filepath
    with open(full_path, 'r') as f:
        return f.read()",python,1
Clear,"import logging
def safe_log_user_action(user_id, action):
    logging.info(f""User {user_id} performed action: {action}"")","import logging
def safe_log_user_action(user_id, action):
    logging.info(f""User {user_id} performed action: {action}"")",python,0
Clear,"To fix the vulnerability related to insecure deserialization in the provided Java code snippet, we need to implement proper security measures. Here are some steps to enhance the security of the deserialization process:

1. **Implement a whitelist**: Instead of deserializing any arbitrary object, maintain a whitelist of allowed classes that can be deserialized. This restricts the types of objects that can be instantiated during deserialization.

2. **Use a secure serialization library**: Consider using a secure serialization library like Google's Protocol Buffers or Apache Avro, which provide mechanisms for safe and efficient serialization and deserialization.

3. **Validate input data**: Validate the input data before deserializing it to ensure it is not tampered with or maliciously crafted. For example, you can validate the size and structure of serialized data before proceeding with deserialization.

4. **Avoid using default Java serialization**: Default Java serialization is known to have security vulnerabilities due to its flexibility in handling object graphs. Prefer using custom serialization mechanisms that offer more control over the process.

5. **Handle exceptions securely**: When handling exceptions during deserialization, avoid leaking sensitive information in error messages. Instead, log errors securely without exposing internal details that could aid potential attackers.

6. **Sanitize user","To fix the vulnerability related to insecure deserialization in the provided Java code snippet, we need to implement proper security measures. Here are some steps to enhance the security of the deserialization process: 1. **Implement a whitelist**: Instead of deserializing any arbitrary object, maintain a whitelist of allowed classes that can be deserialized. This restricts the types of objects that can be instantiated during deserialization. 2. **Use a secure serialization library**: Consider using a secure serialization library like Google's Protocol Buffers or Apache Avro, which provide mechanisms for safe and efficient serialization and deserialization. 3. **Validate input data**: Validate the input data before deserializing it to ensure it is not tampered with or maliciously crafted. For example, you can validate the size and structure of serialized data before proceeding with deserialization. 4. **Avoid using default Java serialization**: Default Java serialization is known to have security vulnerabilities due to its flexibility in handling object graphs. Prefer using custom serialization mechanisms that offer more control over the process. 5. **Handle exceptions securely**: When handling exceptions during deserialization, avoid leaking sensitive information in error messages. Instead, log errors securely without exposing internal details that could aid potential attackers. 6. **Sanitize user",php,0
Clear,"#include <iostream>
#include <vector>
#include <stdexcept>

int safe_vector_access(const std::vector<int>& vec, size_t index) {
    if (index >= vec.size()) {
        throw std::out_of_range(""Index out of range"");
    }
    return vec[index];
}","#include <iostream>
#include <vector>
#include <stdexcept>

int safe_vector_access(const std::vector<int>& vec, size_t index) {
    if (index >= vec.size()) {
        throw std::out_of_range(""Index out of range"");
    }
    return vec[index];
}",cpp,0
Clear,"#include <iostream>
#include <memory>

void safe_memory_management() {
    auto ptr = std::make_unique<int>(42);
    std::cout << *ptr << std::endl;
}","#include <iostream>
#include <memory>

void safe_memory_management() {
    auto ptr = std::make_unique<int>(42);
    std::cout << *ptr << std::endl;
}",cpp,0
Clear,"#include <stdio.h>
#include <string.h>

int safe_buffer_operation(char *input) {
    char buffer[100];
    if (strlen(input) < sizeof(buffer)) {
        strcpy(buffer, input);
        return 0;
    }
    return -1; // buffer too small
}","#include <stdio.h>
#include <string.h>

int safe_buffer_operation(char *input) {
    char buffer[100];
    if (strlen(input) < sizeof(buffer)) {
        strcpy(buffer, input);
        return 0;
    }
    return -1; // buffer too small
}",c,0
Clear,"from django.http import HttpResponse
from django.utils.html import escape

def safe_user_profile(request, username):
    safe_username = escape(username)
    return HttpResponse(f""Welcome, {safe_username}!"")","from django.http import HttpResponse
from django.utils.html import escape

def safe_user_profile(request, username):
    safe_username = escape(username)
    return HttpResponse(f""Welcome, {safe_username}!"")",python,0
Clear,import org.apache.commons.text.StringEscapeUtils;,import org.apache.commons.text.StringEscapeUtils;,python,0
Clear,"#include <iostream>
#include <fstream>
#include <string>

void safe_file_reading(const std::string& filename) {
    std::ifstream file(filename);
    if (file.is_open()) {
        std::string line;
        while (std::getline(file, line)) {
            std::cout << line << std::endl;
        }
    }
}","#include <iostream>
#include <fstream>
#include <string>

void safe_file_reading(const std::string& filename) {
    std::ifstream file(filename);
    if (file.is_open()) {
        std::string line;
        while (std::getline(file, line)) {
            std::cout << line << std::endl;
        }
    }
}",cpp,0
Clear,"#include <iostream>
#include <string>
#include <vector>

void safe_string_handling(const std::string& input) {
    std::string safe_copy = input;
    std::cout << safe_copy << std::endl;
}","#include <iostream>
#include <string>
#include <vector>

void safe_string_handling(const std::string& input) {
    std::string safe_copy = input;
    std::cout << safe_copy << std::endl;
}",cpp,0
Clear,"import os
def get_database_config():
    return {
        'host': os.environ.get('DB_HOST'),
        'user': os.environ.get('DB_USER'),
        'password': os.environ.get('DB_PASSWORD')
    }","import os
def get_database_config():
    return {
        'host': os.environ.get('DB_HOST'),
        'user': os.environ.get('DB_USER'),
        'password': os.environ.get('DB_PASSWORD')
    }",python,0
Command Injection,"import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class CommandInjectionVulnerable {
    public static void main(String[] args) {
        try {
            BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));
            System.out.print(""Enter a command to execute: "");
            String userInput = reader.readLine();

            // Vulnerability: User input is directly passed to the system command
            Process process = Runtime.getRuntime().exec(""ping "" + userInput);

            BufferedReader inputReader = new BufferedReader(new InputStreamReader(process.getInputStream()));
            String line;
            while ((line = inputReader.readLine()) != null) {
                System.out.println(line);
            }

        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}","import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class CommandInjectionVulnerable { public static void main(String[] args) { try { BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a command to execute: ""); String userInput = reader.readLine(); // Vulnerability: User input is directly passed to the system command Process process = Runtime.getRuntime().exec(""ping "" + userInput); BufferedReader inputReader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = inputReader.readLine()) != null) { System.out.println(line); } } catch (IOException e) { e.printStackTrace(); } } }",java,1
Clear,"To fix the Path Traversal vulnerability in the provided Java code snippet, you need to ensure that user input is properly sanitized and validated before constructing the file path. Here's an example of how you can improve the code by validating the input file name:

```java
import java.io.File;
import java.util.Scanner;
import java.util.regex.Pattern;

public class SecurePathTraversalExample {

    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        
        System.out.println(""Enter a file name: "");
        String fileName = scanner.nextLine();
        
        if (!isValidFileName(fileName)) {
            System.out.println(""Invalid file name."");
            return;
        }

        File file = new File(""/path/to/directory/"" + fileName);

        if (file.exists()) {
            System.out.println(""File exists!"");
        } else {
            System.out.println(""File does not exist."");
        }
    }

    private static boolean isValidFileName(String fileName) {
        // Define a regular expression to only allow alphanumeric characters, underscores, and dots
        String pattern = ""^[a-zA-Z0-9_.-]+$"";

        // Check if the fileName matches the pattern
        return Pattern.matches(pattern, fileName);
    }
}
``","To fix the Path Traversal vulnerability in the provided Java code snippet, you need to ensure that user input is properly sanitized and validated before constructing the file path. Here's an example of how you can improve the code by validating the input file name: ```java import java.io.File; import java.util.Scanner; import java.util.regex.Pattern; public class SecurePathTraversalExample { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.println(""Enter a file name: ""); String fileName = scanner.nextLine(); if (!isValidFileName(fileName)) { System.out.println(""Invalid file name.""); return; } File file = new File(""/path/to/directory/"" + fileName); if (file.exists()) { System.out.println(""File exists!""); } else { System.out.println(""File does not exist.""); } } private static boolean isValidFileName(String fileName) { // Define a regular expression to only allow alphanumeric characters, underscores, and dots String pattern = ""^[a-zA-Z0-9_.-]+$""; // Check if the fileName matches the pattern return Pattern.matches(pattern, fileName); } } ``",java,0
Buffer Overflow,"import java.util.Scanner;

public class BufferOverflowVulnerability {

    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        System.out.print(""Enter your name: "");
        String name = scanner.next();

        // Simulating buffer overflow vulnerability
        char[] buffer = new char[10];
        for (int i = 0; i < name.length(); i++) {
            buffer[i] = name.charAt(i);
        }

        System.out.println(""Hello, "" + new String(buffer));
    }
}","import java.util.Scanner; public class BufferOverflowVulnerability { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter your name: ""); String name = scanner.next(); // Simulating buffer overflow vulnerability char[] buffer = new char[10]; for (int i = 0; i < name.length(); i++) { buffer[i] = name.charAt(i); } System.out.println(""Hello, "" + new String(buffer)); } }",java,1
SQL Injection,"<?php
$username = $_POST['username'];
$query = ""SELECT * FROM users WHERE username = '$username'"";
$result = mysql_query($query); // SQL Injection
?>","<?php
$username = $_POST['username'];
$query = ""SELECT * FROM users WHERE username = '$username'"";
$result = mysql_query($query); // SQL Injection
?>",php,1
Clear,"const token = process.env.API_TOKEN; // Environment variable
fetch('/api/data', {
    headers: { 'Authorization': `Bearer ${token}` }
});
","const token = process.env.API_TOKEN; // Environment variable
fetch('/api/data', {
    headers: { 'Authorization': `Bearer ${token}` }
});
",javascript,0
Clear,"<?php
$username = $_POST['username'];
$stmt = $pdo->prepare(""SELECT * FROM users WHERE username = ?"");
$stmt->execute([$username]); // Parameterized query
?>","<?php
$username = $_POST['username'];
$stmt = $pdo->prepare(""SELECT * FROM users WHERE username = ?"");
$stmt->execute([$username]); // Parameterized query
?>",php,0
Clear,"import java.sql.*;

public class SecureSQLInjectionProtection {
    public static void main(String[] args) {
        try {
            String userInput = ""'; DROP TABLE users; --""; // User input containing malicious SQL code

            Connection connection = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");
            String query = ""SELECT * FROM users WHERE username = ?"";
            PreparedStatement statement = connection.prepareStatement(query);
            statement.setString(1, userInput);

            ResultSet resultSet = statement.executeQuery();

            while (resultSet.next()) {
                System.out.println(""Username: "" + resultSet.getString(""username""));
                System.out.println(""Password: "" + resultSet.getString(""password""));
            }

        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.*; public class SecureSQLInjectionProtection { public static void main(String[] args) { try { String userInput = ""'; DROP TABLE users; --""; // User input containing malicious SQL code Connection connection = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); String query = ""SELECT * FROM users WHERE username = ?""; PreparedStatement statement = connection.prepareStatement(query); statement.setString(1, userInput); ResultSet resultSet = statement.executeQuery(); while (resultSet.next()) { System.out.println(""Username: "" + resultSet.getString(""username"")); System.out.println(""Password: "" + resultSet.getString(""password"")); } } catch (SQLException e) { e.printStackTrace(); } } }",java,0
Cross-Site Scripting (XSS),"import java.io.IOException;
import java.io.PrintWriter;

public class XSSVulnerableCode {
    public static void main(String[] args) {
        // Simulating user input
        String userInput = ""<script>alert('XSS Vulnerability')</script>"";

        // Improperly handling user input without proper escaping
        String output = ""<div>"" + userInput + ""</div>"";

        try {
            // Writing the output to an HTML file
            PrintWriter writer = new PrintWriter(""output.html"", ""UTF-8"");
            writer.println(output);
            writer.close();
            
            System.out.println(""Output written to output.html"");
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}","import java.io.IOException; import java.io.PrintWriter; public class XSSVulnerableCode { public static void main(String[] args) { // Simulating user input String userInput = ""<script>alert('XSS Vulnerability')</script>""; // Improperly handling user input without proper escaping String output = ""<div>"" + userInput + ""</div>""; try { // Writing the output to an HTML file PrintWriter writer = new PrintWriter(""output.html"", ""UTF-8""); writer.println(output); writer.close(); System.out.println(""Output written to output.html""); } catch (IOException e) { e.printStackTrace(); } } }",java,1
Clear,"const userData = JSON.parse(userInput); // Safe JSON parsing
if (userData && typeof userData === 'object') {
    processUserData(userData);
}
","const userData = JSON.parse(userInput); // Safe JSON parsing
if (userData && typeof userData === 'object') {
    processUserData(userData);
}
",javascript,0
Clear,"import java.util.Scanner;

public class SecureBufferExample {
    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        System.out.print(""Enter your name: "");
        String name = scanner.nextLine();

        // Allocate memory dynamically based on the length of the input string
        byte[] buffer = new byte[name.length()];
        buffer = name.getBytes();
        
        System.out.println(""Hello, "" + new String(buffer));
    }
}","import java.util.Scanner; public class SecureBufferExample { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter your name: ""); String name = scanner.nextLine(); // Allocate memory dynamically based on the length of the input string byte[] buffer = new byte[name.length()]; buffer = name.getBytes(); System.out.println(""Hello, "" + new String(buffer)); } }",java,0
Clear,"To fix the command injection vulnerability in the provided Java code snippet, you should not directly concatenate user input into the command string that is executed by `Runtime.getRuntime().exec()`. Instead, you should use a safer way to execute system commands. One way to achieve this is by using `ProcessBuilder` and providing each command argument separately.

Here is an updated version of the code that addresses the command injection vulnerability:

```java
import java.io.IOException;
import java.util.Scanner;

public class CommandInjectionFixed {

    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        
        System.out.println(""Enter the name of the file to delete:"");
        String fileName = scanner.next();

        try {
            // Use ProcessBuilder to execute system commands safely
            ProcessBuilder processBuilder = new ProcessBuilder(""rm"", fileName);
            Process process = processBuilder.start();
            
            int exitCode = process.waitFor();
            
            if (exitCode == 0) {
                System.out.println(""File deleted successfully."");
            } else {
                System.out.println(""Error occurred while deleting the file."");
            }
        } catch (IOException | InterruptedException e) {
            System.out.println(""Error occurred: "" + e.getMessage());
        }","To fix the command injection vulnerability in the provided Java code snippet, you should not directly concatenate user input into the command string that is executed by `Runtime.getRuntime().exec()`. Instead, you should use a safer way to execute system commands. One way to achieve this is by using `ProcessBuilder` and providing each command argument separately. Here is an updated version of the code that addresses the command injection vulnerability: ```java import java.io.IOException; import java.util.Scanner; public class CommandInjectionFixed { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.println(""Enter the name of the file to delete:""); String fileName = scanner.next(); try { // Use ProcessBuilder to execute system commands safely ProcessBuilder processBuilder = new ProcessBuilder(""rm"", fileName); Process process = processBuilder.start(); int exitCode = process.waitFor(); if (exitCode == 0) { System.out.println(""File deleted successfully.""); } else { System.out.println(""Error occurred while deleting the file.""); } } catch (IOException | InterruptedException e) { System.out.println(""Error occurred: "" + e.getMessage()); }",java,0
Insecure Deserialization,"<?php
$data = $_POST['data'];
unserialize($data); // Insecure Deserialization
?>","<?php
$data = $_POST['data'];
unserialize($data); // Insecure Deserialization
?>",php,1
XSS,"const userInput = document.location.search.split('=')[1];
document.write(userInput); // XSS
","const userInput = document.location.search.split('=')[1];
document.write(userInput); // XSS
",javascript,1
SQL Injection,"import java.sql.*;

public class SQLInjectionVulnerable {

    public static void main(String[] args) {
        String userInput = args[0]; // Assume this userInput is provided by the user

        try {
            Connection connection = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");
            Statement statement = connection.createStatement();

            // Vulnerable query construction
            String query = ""SELECT * FROM users WHERE username='"" + userInput + ""'"";
            
            ResultSet resultSet = statement.executeQuery(query);
            
            while(resultSet.next()) {
                System.out.println(""User found: "" + resultSet.getString(""username""));
            }

            connection.close();
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.*; public class SQLInjectionVulnerable { public static void main(String[] args) { String userInput = args[0]; // Assume this userInput is provided by the user try { Connection connection = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); Statement statement = connection.createStatement(); // Vulnerable query construction String query = ""SELECT * FROM users WHERE username='"" + userInput + ""'""; ResultSet resultSet = statement.executeQuery(query); while(resultSet.next()) { System.out.println(""User found: "" + resultSet.getString(""username"")); } connection.close(); } catch (SQLException e) { e.printStackTrace(); } } }",java,1
Buffer Overflow,"#include <iostream>
#include <cstdio>

void unsafe_c_input() {
    char buffer[50];
    scanf(""%s"", buffer); // no length limit
    std::cout << buffer << std::endl;
}","#include <iostream>
#include <cstdio>

void unsafe_c_input() {
    char buffer[50];
    scanf(""%s"", buffer); // no length limit
    std::cout << buffer << std::endl;
}",cpp,1
Out-of-Bounds,"#include <iostream>

class UnsafeClass {
    int data[10];
public:
    int get_data(int index) {
        return data[index]; // no bounds checking
    }
};","#include <iostream>

class UnsafeClass {
    int data[10];
public:
    int get_data(int index) {
        return data[index]; // no bounds checking
    }
};",cpp,1
Clear,"app.get('/user/:id', (req, res) => {
    const userId = parseInt(req.params.id);
    db.query('SELECT * FROM users WHERE id = ?', [userId], (err, result) => {
        res.json(result);
    });
});
","app.get('/user/:id', (req, res) => {
    const userId = parseInt(req.params.id);
    db.query('SELECT * FROM users WHERE id = ?', [userId], (err, result) => {
        res.json(result);
    });
});
",javascript,0
Code Injection,"const userData = eval('(' + userInput + ')'); // eval injection
","const userData = eval('(' + userInput + ')'); // eval injection
",javascript,1
Memory Corruption,"#include <iostream>

void unsafe_pointer_arithmetic(int* array, int size) {
    for (int i = 0; i <= size; i++) {
        std::cout << *(array + i) << std::endl; // potential out-of-bounds
    }
}","#include <iostream>

void unsafe_pointer_arithmetic(int* array, int size) {
    for (int i = 0; i <= size; i++) {
        std::cout << *(array + i) << std::endl; // potential out-of-bounds
    }
}",cpp,1
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Clear,"To fix the Path Traversal vulnerability in the given Java code snippet, you should ensure that the user-provided file name is sanitized and restricted to a specific directory or path. Here's an improved version of the code with proper security measures:

```java
import java.io.File;
import java.io.IOException;
import java.nio.file.Files;
import java.util.Scanner;

public class SecurePathTraversal {

    private static final String BASE_PATH = ""C:\\data\\""; // Define a base directory

    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        System.out.print(""Enter file name: "");
        String fileName = scanner.nextLine();

        if (isValidFileName(fileName)) {
            File file = new File(BASE_PATH + fileName);

            if (file.exists()) {
                try {
                    byte[] fileContent = Files.readAllBytes(file.toPath());
                    System.out.println(new String(fileContent));
                } catch (IOException e) {
                    e.printStackTrace();
                }
            } else {
                System.out.println(""File not found."");
            }
        } else {
            System.out.println(""Invalid file name."");
        }
    }

    private static boolean isValidFileName(String fileName) {
        // Implement validation logic to restrict access","To fix the Path Traversal vulnerability in the given Java code snippet, you should ensure that the user-provided file name is sanitized and restricted to a specific directory or path. Here's an improved version of the code with proper security measures: ```java import java.io.File; import java.io.IOException; import java.nio.file.Files; import java.util.Scanner; public class SecurePathTraversal { private static final String BASE_PATH = ""C:\\data\\""; // Define a base directory public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter file name: ""); String fileName = scanner.nextLine(); if (isValidFileName(fileName)) { File file = new File(BASE_PATH + fileName); if (file.exists()) { try { byte[] fileContent = Files.readAllBytes(file.toPath()); System.out.println(new String(fileContent)); } catch (IOException e) { e.printStackTrace(); } } else { System.out.println(""File not found.""); } } else { System.out.println(""Invalid file name.""); } } private static boolean isValidFileName(String fileName) { // Implement validation logic to restrict access",java,0
Cross-Site Scripting (XSS),"import java.io.IOException;
import java.io.PrintWriter;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

public class VulnerableServlet extends HttpServlet {
    
    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws IOException {
        String userInput = request.getParameter(""input"");
        
        PrintWriter out = response.getWriter();
        out.println(""<html>"");
        out.println(""<body>"");
        out.println(""<h1>Hello, "" + userInput + ""!</h1>""); // Vulnerability: User input is directly inserted into HTML response
        out.println(""</body>"");
        out.println(""</html>"");
    }
}","import java.io.IOException; import java.io.PrintWriter; import javax.servlet.http.HttpServlet; import javax.servlet.http.HttpServletRequest; import javax.servlet.http.HttpServletResponse; public class VulnerableServlet extends HttpServlet { protected void doGet(HttpServletRequest request, HttpServletResponse response) throws IOException { String userInput = request.getParameter(""input""); PrintWriter out = response.getWriter(); out.println(""<html>""); out.println(""<body>""); out.println(""<h1>Hello, "" + userInput + ""!</h1>""); // Vulnerability: User input is directly inserted into HTML response out.println(""</body>""); out.println(""</html>""); } }",java,1
Clear,"#include <stdio.h>
#include <string.h>

int validate_input(const char *input) {
    if (input == NULL) return 0;
    for (int i = 0; input[i] != '\0'; i++) {
        if (input[i] < 32 || input[i] > 126) {
            return 0; // invalid character
        }
    }
    return 1;
}","#include <stdio.h>
#include <string.h>

int validate_input(const char *input) {
    if (input == NULL) return 0;
    for (int i = 0; input[i] != '\0'; i++) {
        if (input[i] < 32 || input[i] > 126) {
            return 0; // invalid character
        }
    }
    return 1;
}",c,0
Clear,"To fix the potential buffer overflow vulnerability in the provided Java code snippet, you can implement proper bounds checking before copying user input into the fixed-size buffer. Here's an updated version of the code with bounds checking:

```java
import java.util.Scanner;

public class SecureBufferHandling {

    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        System.out.print(""Enter your name: "");
        String input = scanner.nextLine(); // Use nextLine() to read the entire line including spaces
        
        // Creating a fixed-size array with potential buffer overflow vulnerability
        char[] buffer = new char[10];
        
        // Copying user input into the fixed-size buffer with bounds checking
        for (int i = 0; i < input.length() && i < buffer.length; i++) {
            buffer[i] = input.charAt(i);
        }
        
        // Ensure that any remaining space in the buffer is filled with null characters
        for (int i = Math.min(input.length(), buffer.length); i < buffer.length; i++) {
            buffer[i] = '\0'; // Null character to fill remaining space
        }
        
        // Print out the contents of the buffer for demonstration purposes","To fix the potential buffer overflow vulnerability in the provided Java code snippet, you can implement proper bounds checking before copying user input into the fixed-size buffer. Here's an updated version of the code with bounds checking: ```java import java.util.Scanner; public class SecureBufferHandling { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter your name: ""); String input = scanner.nextLine(); // Use nextLine() to read the entire line including spaces // Creating a fixed-size array with potential buffer overflow vulnerability char[] buffer = new char[10]; // Copying user input into the fixed-size buffer with bounds checking for (int i = 0; i < input.length() && i < buffer.length; i++) { buffer[i] = input.charAt(i); } // Ensure that any remaining space in the buffer is filled with null characters for (int i = Math.min(input.length(), buffer.length); i < buffer.length; i++) { buffer[i] = '\0'; // Null character to fill remaining space } // Print out the contents of the buffer for demonstration purposes",java,0
Clear,"app.get('/user/:id', (req, res) => {
    const userId = parseInt(req.params.id);
    db.query('SELECT * FROM users WHERE id = ?', [userId], (err, result) => {
        res.json(result);
    });
});
","app.get('/user/:id', (req, res) => {
    const userId = parseInt(req.params.id);
    db.query('SELECT * FROM users WHERE id = ?', [userId], (err, result) => {
        res.json(result);
    });
});
",javascript,0
Path Traversal,"def get_user_file(username, filepath):
    import os
    base_path = f""/home/{username}/files/""
    full_path = base_path + filepath
    with open(full_path, 'r') as f:
        return f.read()","def get_user_file(username, filepath):
    import os
    base_path = f""/home/{username}/files/""
    full_path = base_path + filepath
    with open(full_path, 'r') as f:
        return f.read()",python,1
Clear,"To fix the SQL Injection vulnerability in the provided Java code snippet, you should use PreparedStatement instead of directly concatenating user input into the SQL query. PreparedStatement helps to prevent SQL Injection by separating SQL code from user input.

Here is the fixed version of the code with proper security measures implemented:

```java
import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;

public class SecureSQLCode {

    public static void main(String[] args) {
        String userInput = args[0]; // Simulating user input from command line

        String url = ""jdbc:mysql://localhost:3306/mydatabase"";
        String username = ""myusername"";
        String password = ""mypassword"";

        try {
            Connection conn = DriverManager.getConnection(url, username, password);

            // Using a PreparedStatement to safely handle user input
            String query = ""SELECT * FROM users WHERE username=?"";
            PreparedStatement stmt = conn.prepareStatement(query);
            stmt.setString(1, userInput);

            ResultSet rs = stmt.executeQuery();

            while (rs.next()) {
                System.out.println(""User found: "" + rs.getString(""username""));
            }

            rs.close();
            stmt.close();
            conn.close();
        } catch (","To fix the SQL Injection vulnerability in the provided Java code snippet, you should use PreparedStatement instead of directly concatenating user input into the SQL query. PreparedStatement helps to prevent SQL Injection by separating SQL code from user input. Here is the fixed version of the code with proper security measures implemented: ```java import java.sql.Connection; import java.sql.DriverManager; import java.sql.PreparedStatement; import java.sql.ResultSet; import java.sql.SQLException; public class SecureSQLCode { public static void main(String[] args) { String userInput = args[0]; // Simulating user input from command line String url = ""jdbc:mysql://localhost:3306/mydatabase""; String username = ""myusername""; String password = ""mypassword""; try { Connection conn = DriverManager.getConnection(url, username, password); // Using a PreparedStatement to safely handle user input String query = ""SELECT * FROM users WHERE username=?""; PreparedStatement stmt = conn.prepareStatement(query); stmt.setString(1, userInput); ResultSet rs = stmt.executeQuery(); while (rs.next()) { System.out.println(""User found: "" + rs.getString(""username"")); } rs.close(); stmt.close(); conn.close(); } catch (",java,0
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
SQL Injection,"app.get('/user/:id', (req, res) => {
    const query = `SELECT * FROM users WHERE id = ${req.params.id}`; // SQL Injection
    db.query(query, (err, result) => {
        res.json(result);
    });
});
","app.get('/user/:id', (req, res) => {
    const query = `SELECT * FROM users WHERE id = ${req.params.id}`; // SQL Injection
    db.query(query, (err, result) => {
        res.json(result);
    });
});
",javascript,1
Clear,"This code snippet demonstrates an insecure deserialization vulnerability where user-supplied serialized data is deserialized without proper validation, which can lead to remote code execution and other security risks. To fix this code and implement proper security measures for deserialization, you can follow these guidelines:

1. Implement a whitelist approach: Only allow deserialization of known and trusted classes by maintaining a whitelist of allowed classes. Restrict the deserialization process to only accept objects of these whitelisted classes.

2. Use a secure deserialization library: Consider using a secure deserialization library like Jackson or GSON, which provide better protection against common deserialization vulnerabilities.

3. Validate input data: Before deserializing any input data, validate it to ensure it comes from a trusted and authenticated source. Perform input validation checks to prevent malicious input from being processed.

4. Implement input validation filters: Use input validation filters to sanitize the user-supplied serialized data before deserialization to remove any potentially harmful content or unexpected object types.

5. Apply cryptographic integrity checks: Use digital signatures or checksums to verify the integrity of serialized data before deserialization. This helps ensure that the data has not been tampered with during transit.

6. Monitor and log deserialization activities: Implement logging mechanisms to","This code snippet demonstrates an insecure deserialization vulnerability where user-supplied serialized data is deserialized without proper validation, which can lead to remote code execution and other security risks. To fix this code and implement proper security measures for deserialization, you can follow these guidelines: 1. Implement a whitelist approach: Only allow deserialization of known and trusted classes by maintaining a whitelist of allowed classes. Restrict the deserialization process to only accept objects of these whitelisted classes. 2. Use a secure deserialization library: Consider using a secure deserialization library like Jackson or GSON, which provide better protection against common deserialization vulnerabilities. 3. Validate input data: Before deserializing any input data, validate it to ensure it comes from a trusted and authenticated source. Perform input validation checks to prevent malicious input from being processed. 4. Implement input validation filters: Use input validation filters to sanitize the user-supplied serialized data before deserialization to remove any potentially harmful content or unexpected object types. 5. Apply cryptographic integrity checks: Use digital signatures or checksums to verify the integrity of serialized data before deserialization. This helps ensure that the data has not been tampered with during transit. 6. Monitor and log deserialization activities: Implement logging mechanisms to",php,0
Clear,"#include <iostream>
#include <memory>

void safe_memory_management() {
    auto ptr = std::make_unique<int>(42);
    std::cout << *ptr << std::endl;
}","#include <iostream>
#include <memory>

void safe_memory_management() {
    auto ptr = std::make_unique<int>(42);
    std::cout << *ptr << std::endl;
}",cpp,0
Insecure Deserialization,"import pickle
def load_user_data(filename):
    with open(filename, 'rb') as f:
        data = pickle.load(f)
    return data","import pickle
def load_user_data(filename):
    with open(filename, 'rb') as f:
        data = pickle.load(f)
    return data",python,1
Path Traversal,"import java.io.File;
import java.io.IOException;
import java.nio.file.Files;
import java.util.Scanner;

public class PathTraversalVulnerability {

    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        System.out.println(""Enter a file name:"");
        String fileName = scanner.nextLine();

        File file = new File(""/path/to/directory/"" + fileName);

        try {
            byte[] fileContent = Files.readAllBytes(file.toPath());
            System.out.println(""File content: "" + new String(fileContent));
        } catch (IOException e) {
            System.out.println(""Error reading file: "" + e.getMessage());
        }
    }
}","import java.io.File; import java.io.IOException; import java.nio.file.Files; import java.util.Scanner; public class PathTraversalVulnerability { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.println(""Enter a file name:""); String fileName = scanner.nextLine(); File file = new File(""/path/to/directory/"" + fileName); try { byte[] fileContent = Files.readAllBytes(file.toPath()); System.out.println(""File content: "" + new String(fileContent)); } catch (IOException e) { System.out.println(""Error reading file: "" + e.getMessage()); } } }",java,1
Command Injection,"import os
def backup_database(db_name):
    os.system(f""pg_dump {db_name} > backup.sql"")","import os
def backup_database(db_name):
    os.system(f""pg_dump {db_name} > backup.sql"")",python,1
Clear,"To fix the insecure Java code snippet for Command Injection, you should sanitize and validate user input to prevent malicious commands from being executed. Here's an improved version of the code with proper security measures:

```java
import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class SecureCommandExecution {

    public static void main(String[] args) throws IOException {
        BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));

        System.out.print(""Enter a file name to display its content: "");
        String fileName = reader.readLine();

        // Validate and sanitize user input to prevent command injection
        if (!isValidFileName(fileName)) {
            System.err.println(""Invalid file name."");
            return;
        }

        // Safe code - user input is properly sanitized before executing system command
        String command = ""cat "" + fileName;
        Process process = Runtime.getRuntime().exec(command);

        BufferedReader processReader = new BufferedReader(new InputStreamReader(process.getInputStream()));
        String line;

        while ((line = processReader.readLine()) != null) {
            System.out.println(line);
        }
    }

    // Method to validate file name format
    private static boolean isValidFileName(String fileName) {
        // Implement validation logic here, e.g., check for allowed characters,","To fix the insecure Java code snippet for Command Injection, you should sanitize and validate user input to prevent malicious commands from being executed. Here's an improved version of the code with proper security measures: ```java import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class SecureCommandExecution { public static void main(String[] args) throws IOException { BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a file name to display its content: ""); String fileName = reader.readLine(); // Validate and sanitize user input to prevent command injection if (!isValidFileName(fileName)) { System.err.println(""Invalid file name.""); return; } // Safe code - user input is properly sanitized before executing system command String command = ""cat "" + fileName; Process process = Runtime.getRuntime().exec(command); BufferedReader processReader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = processReader.readLine()) != null) { System.out.println(line); } } // Method to validate file name format private static boolean isValidFileName(String fileName) { // Implement validation logic here, e.g., check for allowed characters,",java,0
Clear,"<?php
$input = json_decode($_POST['data'], true); // Safe JSON parsing
if (json_last_error() === JSON_ERROR_NONE) {
    process_data($input);
}
?>","<?php
$input = json_decode($_POST['data'], true); // Safe JSON parsing
if (json_last_error() === JSON_ERROR_NONE) {
    process_data($input);
}
?>",php,0
Clear,"#include <iostream>
#include <fstream>
#include <string>

void safe_file_reading(const std::string& filename) {
    std::ifstream file(filename);
    if (file.is_open()) {
        std::string line;
        while (std::getline(file, line)) {
            std::cout << line << std::endl;
        }
    }
}","#include <iostream>
#include <fstream>
#include <string>

void safe_file_reading(const std::string& filename) {
    std::ifstream file(filename);
    if (file.is_open()) {
        std::string line;
        while (std::getline(file, line)) {
            std::cout << line << std::endl;
        }
    }
}",cpp,0
Memory Corruption,"#include <iostream>

void unsafe_virtual_call() {
    // Potential vtable corruption vulnerability
    class Base {
    public:
        virtual void func() { std::cout << ""Base"" << std::endl; }
    };
    
    class Derived : public Base {
    public:
        void func() override { std::cout << ""Derived"" << std::endl; }
    };
}","#include <iostream>

void unsafe_virtual_call() {
    // Potential vtable corruption vulnerability
    class Base {
    public:
        virtual void func() { std::cout << ""Base"" << std::endl; }
    };
    
    class Derived : public Base {
    public:
        void func() override { std::cout << ""Derived"" << std::endl; }
    };
}",cpp,1
Clear,"#include <iostream>
#include <string>
#include <vector>

void safe_string_handling(const std::string& input) {
    std::string safe_copy = input;
    std::cout << safe_copy << std::endl;
}","#include <iostream>
#include <string>
#include <vector>

void safe_string_handling(const std::string& input) {
    std::string safe_copy = input;
    std::cout << safe_copy << std::endl;
}",cpp,0
Clear,"#include <iostream>
#include <memory>

void safe_memory_management() {
    auto ptr = std::make_unique<int>(42);
    std::cout << *ptr << std::endl;
}","#include <iostream>
#include <memory>

void safe_memory_management() {
    auto ptr = std::make_unique<int>(42);
    std::cout << *ptr << std::endl;
}",cpp,0
Command Injection,"import os
def ping_host(host):
    os.system(""ping -c 4 "" + host)","import os
def ping_host(host):
    os.system(""ping -c 4 "" + host)",python,1
Clear,"#include <stdio.h>
#include <string.h>

int validate_input(const char *input) {
    if (input == NULL) return 0;
    for (int i = 0; input[i] != '\0'; i++) {
        if (input[i] < 32 || input[i] > 126) {
            return 0; // invalid character
        }
    }
    return 1;
}","#include <stdio.h>
#include <string.h>

int validate_input(const char *input) {
    if (input == NULL) return 0;
    for (int i = 0; input[i] != '\0'; i++) {
        if (input[i] < 32 || input[i] > 126) {
            return 0; // invalid character
        }
    }
    return 1;
}",c,0
Insecure Deserialization,"import java.io.*;

public class InsecureDeserializationExample {

    public static void main(String[] args) {
        try {
            // Simulating user input as a serialized object
            String userInput = ""rO0ABXNyACRqYXZhLnV0aWwuUHJpb3JpdHlTdHJpbmcAAAAAAAAAAQIAAHhyADB0ABJMamF2YS9sYW5nL1N0cmluZzt4cD9AAAAAAAABAAE="";
            
            // Deserialize the user input
            ByteArrayInputStream bis = new ByteArrayInputStream(Base64.getDecoder().decode(userInput));
            ObjectInputStream ois = new ObjectInputStream(bis);
            Object obj = ois.readObject();
            
            // Perform some operation with the deserialized object (e.g., cast it to a specific type)
            String str = (String) obj;
            
            System.out.println(""Deserialized object: "" + str);
        } catch (Exception e) {
            e.printStackTrace();
        }
    }
}","import java.io.*; public class InsecureDeserializationExample { public static void main(String[] args) { try { // Simulating user input as a serialized object String userInput = ""rO0ABXNyACRqYXZhLnV0aWwuUHJpb3JpdHlTdHJpbmcAAAAAAAAAAQIAAHhyADB0ABJMamF2YS9sYW5nL1N0cmluZzt4cD9AAAAAAAABAAE=""; // Deserialize the user input ByteArrayInputStream bis = new ByteArrayInputStream(Base64.getDecoder().decode(userInput)); ObjectInputStream ois = new ObjectInputStream(bis); Object obj = ois.readObject(); // Perform some operation with the deserialized object (e.g., cast it to a specific type) String str = (String) obj; System.out.println(""Deserialized object: "" + str); } catch (Exception e) { e.printStackTrace(); } } }",java,1
Buffer Overflow,"#include <iostream>
#include <cstring>

void unsafe_c_string(char* input) {
    char buffer[100];
    strcpy(buffer, input); // potential buffer overflow
    std::cout << buffer << std::endl;
}","#include <iostream>
#include <cstring>

void unsafe_c_string(char* input) {
    char buffer[100];
    strcpy(buffer, input); // potential buffer overflow
    std::cout << buffer << std::endl;
}",cpp,1
Clear,"#include <iostream>
#include <vector>
#include <stdexcept>

int safe_vector_access(const std::vector<int>& vec, size_t index) {
    if (index >= vec.size()) {
        throw std::out_of_range(""Index out of range"");
    }
    return vec[index];
}","#include <iostream>
#include <vector>
#include <stdexcept>

int safe_vector_access(const std::vector<int>& vec, size_t index) {
    if (index >= vec.size()) {
        throw std::out_of_range(""Index out of range"");
    }
    return vec[index];
}",cpp,0
Command Injection,"import java.io.IOException;

public class CommandInjectionDemo {

    public static void main(String[] args) {
        String userInput = ""127.0.0.1; ls"";

        try {
            // Improperly handling user input by directly concatenating it into a command
            Process process = Runtime.getRuntime().exec(""ping "" + userInput);

            // Reading the output of the command
            java.util.Scanner scanner = new java.util.Scanner(process.getInputStream());
            while (scanner.hasNextLine()) {
                System.out.println(scanner.nextLine());
            }
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}","import java.io.IOException; public class CommandInjectionDemo { public static void main(String[] args) { String userInput = ""127.0.0.1; ls""; try { // Improperly handling user input by directly concatenating it into a command Process process = Runtime.getRuntime().exec(""ping "" + userInput); // Reading the output of the command java.util.Scanner scanner = new java.util.Scanner(process.getInputStream()); while (scanner.hasNextLine()) { System.out.println(scanner.nextLine()); } } catch (IOException e) { e.printStackTrace(); } } }",java,1
Clear,"const shell = require('child_process');
const safeInput = userInput.replace(/[^a-zA-Z0-9.]/g, '');
shell.execFile('ping', [safeInput]); // Safe command execution
","const shell = require('child_process');
const safeInput = userInput.replace(/[^a-zA-Z0-9.]/g, '');
shell.execFile('ping', [safeInput]); // Safe command execution
",javascript,0
Clear,"#include <stdio.h>
#include <string.h>

int validate_input(const char *input) {
    if (input == NULL) return 0;
    for (int i = 0; input[i] != '\0'; i++) {
        if (input[i] < 32 || input[i] > 126) {
            return 0; // invalid character
        }
    }
    return 1;
}","#include <stdio.h>
#include <string.h>

int validate_input(const char *input) {
    if (input == NULL) return 0;
    for (int i = 0; input[i] != '\0'; i++) {
        if (input[i] < 32 || input[i] > 126) {
            return 0; // invalid character
        }
    }
    return 1;
}",c,0
Cross-Site Scripting (XSS),"import java.io.*;
import javax.servlet.*;
import javax.servlet.http.*;

public class VulnerableServlet extends HttpServlet {
    
    protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        String userInput = request.getParameter(""input"");
        response.setContentType(""text/html"");
        
        PrintWriter out = response.getWriter();
        out.println(""<html><body>"");
        out.println(""<h1>User Input:</h1>"");
        out.println(userInput); // Vulnerability: User input is directly outputted without proper encoding
        
        out.println(""</body></html>"");
    }
}","import java.io.*; import javax.servlet.*; import javax.servlet.http.*; public class VulnerableServlet extends HttpServlet { protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { String userInput = request.getParameter(""input""); response.setContentType(""text/html""); PrintWriter out = response.getWriter(); out.println(""<html><body>""); out.println(""<h1>User Input:</h1>""); out.println(userInput); // Vulnerability: User input is directly outputted without proper encoding out.println(""</body></html>""); } }",java,1
Clear,"const userData = JSON.parse(userInput); // Safe JSON parsing
if (userData && typeof userData === 'object') {
    processUserData(userData);
}
","const userData = JSON.parse(userInput); // Safe JSON parsing
if (userData && typeof userData === 'object') {
    processUserData(userData);
}
",javascript,0
Clear,"To secure the code against SQL Injection, you should use prepared statements with parameterized queries instead of directly concatenating user input into the SQL query. Here's how you can modify the code to prevent SQL Injection:

```java
import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.util.Scanner;

public class SecureSQLInjection {

    public static void main(String[] args) {
        try {
            // Get user input
            Scanner scanner = new Scanner(System.in);
            System.out.println(""Enter username: "");
            String username = scanner.nextLine();

            // Establish database connection
            Connection connection = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""root"", ""password"");
            
            // Use prepared statement to prevent SQL Injection
            String query = ""SELECT * FROM users WHERE username=?"";
            PreparedStatement preparedStatement = connection.prepareStatement(query);
            preparedStatement.setString(1, username);

            // Execute the prepared statement
            ResultSet resultSet = preparedStatement.executeQuery();
            
            // Process the result set
            while(resultSet.next()) {
                System.out.println(""User ID: "" + resultSet.getInt(""id"") + "", Username: "" + resultSet.getString(""username""));
            }
            
            // Close resources","To secure the code against SQL Injection, you should use prepared statements with parameterized queries instead of directly concatenating user input into the SQL query. Here's how you can modify the code to prevent SQL Injection: ```java import java.sql.Connection; import java.sql.DriverManager; import java.sql.PreparedStatement; import java.sql.ResultSet; import java.util.Scanner; public class SecureSQLInjection { public static void main(String[] args) { try { // Get user input Scanner scanner = new Scanner(System.in); System.out.println(""Enter username: ""); String username = scanner.nextLine(); // Establish database connection Connection connection = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""root"", ""password""); // Use prepared statement to prevent SQL Injection String query = ""SELECT * FROM users WHERE username=?""; PreparedStatement preparedStatement = connection.prepareStatement(query); preparedStatement.setString(1, username); // Execute the prepared statement ResultSet resultSet = preparedStatement.executeQuery(); // Process the result set while(resultSet.next()) { System.out.println(""User ID: "" + resultSet.getInt(""id"") + "", Username: "" + resultSet.getString(""username"")); } // Close resources",java,0
Clear,"import java.sql.*;

public class SQLInjectionSecureCode {

    public static void main(String[] args) {
        String userInput = ""'; DROP TABLE users; --"";

        try {
            Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");
            
            String query = ""SELECT * FROM users WHERE username = ?"";
            PreparedStatement stmt = conn.prepareStatement(query);
            stmt.setString(1, userInput);

            ResultSet rs = stmt.executeQuery();

            while (rs.next()) {
                System.out.println(rs.getString(""username""));
            }

            conn.close();
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.*; public class SQLInjectionSecureCode { public static void main(String[] args) { String userInput = ""'; DROP TABLE users; --""; try { Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); String query = ""SELECT * FROM users WHERE username = ?""; PreparedStatement stmt = conn.prepareStatement(query); stmt.setString(1, userInput); ResultSet rs = stmt.executeQuery(); while (rs.next()) { System.out.println(rs.getString(""username"")); } conn.close(); } catch (SQLException e) { e.printStackTrace(); } } }",java,0
Clear,"import java.io.*;

public class SecureCommandExecutionExample {
    public static void main(String[] args) {
        try {
            BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));
            System.out.print(""Enter a command to execute: "");
            String[] command = {""/bin/sh"", ""-c"", reader.readLine()}; // Use shell invocation for compatibility

            ProcessBuilder processBuilder = new ProcessBuilder(command);
            Process process = processBuilder.start();

            BufferedReader inputReader = new BufferedReader(new InputStreamReader(process.getInputStream()));
            String line;
            while ((line = inputReader.readLine()) != null) {
                System.out.println(line);
            }

        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}","import java.io.*; public class SecureCommandExecutionExample { public static void main(String[] args) { try { BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a command to execute: ""); String[] command = {""/bin/sh"", ""-c"", reader.readLine()}; // Use shell invocation for compatibility ProcessBuilder processBuilder = new ProcessBuilder(command); Process process = processBuilder.start(); BufferedReader inputReader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = inputReader.readLine()) != null) { System.out.println(line); } } catch (IOException e) { e.printStackTrace(); } } }",java,0
Out-of-Bounds,"#include <iostream>

class UnsafeClass {
    int data[10];
public:
    int get_data(int index) {
        return data[index]; // no bounds checking
    }
};","#include <iostream>

class UnsafeClass {
    int data[10];
public:
    int get_data(int index) {
        return data[index]; // no bounds checking
    }
};",cpp,1
Clear,"To fix the XSS vulnerability in the provided Java code snippet, you need to properly encode the user input before outputting it to the response. One way to prevent XSS attacks is by using OWASP recommended HTML escaping methods. Here's an updated version of the code that addresses the XSS vulnerability:

```java
import java.io.IOException;
import java.io.PrintWriter;

import javax.servlet.ServletException;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

@WebServlet(""/xss-secure"")
public class XSSSecureServlet extends HttpServlet {
    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        String userInput = request.getParameter(""input"");
        
        response.setContentType(""text/html"");
        PrintWriter out = response.getWriter();
        
        out.println(""<html><body>"");
        out.println(""<h1>User Input:</h1>"");
        out.println(""<p>"" + encodeHtml(userInput) + ""</p>""); // Encode user input before outputting
        out.println(""</body></html>"");
    }
    
    private String encodeHtml(String input) {
        if (input == null) {
            return """";
        }
        
        return input
                .replaceAll(""&"", ""&amp;"")
                .replaceAll(""<","To fix the XSS vulnerability in the provided Java code snippet, you need to properly encode the user input before outputting it to the response. One way to prevent XSS attacks is by using OWASP recommended HTML escaping methods. Here's an updated version of the code that addresses the XSS vulnerability: ```java import java.io.IOException; import java.io.PrintWriter; import javax.servlet.ServletException; import javax.servlet.annotation.WebServlet; import javax.servlet.http.HttpServlet; import javax.servlet.http.HttpServletRequest; import javax.servlet.http.HttpServletResponse; @WebServlet(""/xss-secure"") public class XSSSecureServlet extends HttpServlet { protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { String userInput = request.getParameter(""input""); response.setContentType(""text/html""); PrintWriter out = response.getWriter(); out.println(""<html><body>""); out.println(""<h1>User Input:</h1>""); out.println(""<p>"" + encodeHtml(userInput) + ""</p>""); // Encode user input before outputting out.println(""</body></html>""); } private String encodeHtml(String input) { if (input == null) { return """"; } return input .replaceAll(""&"", ""&amp;"") .replaceAll(""<",java,0
Clear,"import java.util.Scanner;

public class SecureBufferExample {
    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        System.out.print(""Enter a string: "");
        String input = scanner.nextLine(); // Read the entire line

        // Creating a fixed-size array with size 10
        char[] buffer = new char[10];

        // Copying user input into the buffer with bounds checking
        int length = Math.min(input.length(), buffer.length); // Determine maximum length to copy
        for (int i = 0; i < length; i++) {
            buffer[i] = input.charAt(i);
        }

        System.out.println(""Input safely copied into the buffer."");
    }
}","import java.util.Scanner; public class SecureBufferExample { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter a string: ""); String input = scanner.nextLine(); // Read the entire line // Creating a fixed-size array with size 10 char[] buffer = new char[10]; // Copying user input into the buffer with bounds checking int length = Math.min(input.length(), buffer.length); // Determine maximum length to copy for (int i = 0; i < length; i++) { buffer[i] = input.charAt(i); } System.out.println(""Input safely copied into the buffer.""); } }",java,0
Clear,"import re
def validate_email(email):
    pattern = r'^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$'
    return bool(re.match(pattern, email))","import re
def validate_email(email):
    pattern = r'^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$'
    return bool(re.match(pattern, email))",python,0
Clear,"<?php
$cmd = escapeshellarg($_GET['cmd']);
system(""ls "" . $cmd); // Escaped command
?>","<?php
$cmd = escapeshellarg($_GET['cmd']);
system(""ls "" . $cmd); // Escaped command
?>",php,0
Clear,"import subprocess
def safe_directory_listing(path):
    result = subprocess.run(['ls', path], capture_output=True, text=True)
    return result.stdout","import subprocess
def safe_directory_listing(path):
    result = subprocess.run(['ls', path], capture_output=True, text=True)
    return result.stdout",python,0
Code Injection,"const userData = eval('(' + userInput + ')'); // eval injection
","const userData = eval('(' + userInput + ')'); // eval injection
",javascript,1
Code Injection,"const userData = eval('(' + userInput + ')'); // eval injection
","const userData = eval('(' + userInput + ')'); // eval injection
",javascript,1
Clear,"#include <iostream>
#include <vector>
#include <stdexcept>

int safe_vector_access(const std::vector<int>& vec, size_t index) {
    if (index >= vec.size()) {
        throw std::out_of_range(""Index out of range"");
    }
    return vec[index];
}","#include <iostream>
#include <vector>
#include <stdexcept>

int safe_vector_access(const std::vector<int>& vec, size_t index) {
    if (index >= vec.size()) {
        throw std::out_of_range(""Index out of range"");
    }
    return vec[index];
}",cpp,0
SQL Injection,"import java.sql.*;

public class SQLInjectionVulnerability {

    public static void main(String[] args) {
        String userInput = ""'; DROP TABLE users; --"";
        
        try {
            Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");
            Statement stmt = conn.createStatement();
            
            // Vulnerable query construction
            String query = ""SELECT * FROM users WHERE username = '"" + userInput + ""'"";
            
            ResultSet rs = stmt.executeQuery(query);
            
            while (rs.next()) {
                System.out.println(""User found: "" + rs.getString(""username""));
            }
            
            conn.close();
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.*; public class SQLInjectionVulnerability { public static void main(String[] args) { String userInput = ""'; DROP TABLE users; --""; try { Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); Statement stmt = conn.createStatement(); // Vulnerable query construction String query = ""SELECT * FROM users WHERE username = '"" + userInput + ""'""; ResultSet rs = stmt.executeQuery(query); while (rs.next()) { System.out.println(""User found: "" + rs.getString(""username"")); } conn.close(); } catch (SQLException e) { e.printStackTrace(); } } }",java,1
Cross-Site Scripting (XSS),"import java.io.IOException;
import java.io.PrintWriter;

public class XSSVulnerableCode {

    public static void main(String[] args) {
        String userInput = ""<script>alert('XSS Vulnerability')</script>"";

        // Improperly handling user input by directly printing it to the HTML response
        try {
            PrintWriter out = new PrintWriter(""output.html"");
            out.println(""<html>"");
            out.println(""<body>"");
            out.println(""<h1>Hello, "" + userInput + ""</h1>"");
            out.println(""</body>"");
            out.println(""</html>"");
            out.close();
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}","import java.io.IOException; import java.io.PrintWriter; public class XSSVulnerableCode { public static void main(String[] args) { String userInput = ""<script>alert('XSS Vulnerability')</script>""; // Improperly handling user input by directly printing it to the HTML response try { PrintWriter out = new PrintWriter(""output.html""); out.println(""<html>""); out.println(""<body>""); out.println(""<h1>Hello, "" + userInput + ""</h1>""); out.println(""</body>""); out.println(""</html>""); out.close(); } catch (IOException e) { e.printStackTrace(); } } }",java,1
Cross-Site Scripting (XSS),"def display_comment(comment_text):
    return f""<div class='comment'>{comment_text}</div>"" ","def display_comment(comment_text):
    return f""<div class='comment'>{comment_text}</div>"" ",python,1
Clear,"<?php
$input = json_decode($_POST['data'], true); // Safe JSON parsing
if (json_last_error() === JSON_ERROR_NONE) {
    process_data($input);
}
?>","<?php
$input = json_decode($_POST['data'], true); // Safe JSON parsing
if (json_last_error() === JSON_ERROR_NONE) {
    process_data($input);
}
?>",php,0
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Clear,"To prevent Cross-Site Scripting (XSS) vulnerabilities in the Java servlet code, you need to sanitize the user input before using it in the response output. Here is an improved version of the code that properly handles input sanitization:

```java
import java.io.IOException;
import javax.servlet.http.*;

public class XSSSafeServlet extends HttpServlet {
    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws IOException {
        String userInput = request.getParameter(""input"");

        // Sanitize user input to prevent XSS
        userInput = sanitizeInput(userInput);

        String greeting = ""Hello, "" + userInput + ""!"";

        response.setContentType(""text/html"");
        response.getWriter().println(""<html><body>"");
        response.getWriter().println(""<h1>"" + greeting + ""</h1>"");
        response.getWriter().println(""</body></html>"");
    }

    private String sanitizeInput(String input) {
        // Implement proper input sanitization here based on your application's requirements
        // For example, you can use OWASP ESAPI library or HTML escaping functions

        // Here is a simple example of HTML escaping
        return input != null ? input.replace(""&"", ""&amp;"").replace(""<"", ""&lt;"").replace("">"", ""&gt;"").replace(""\""","To prevent Cross-Site Scripting (XSS) vulnerabilities in the Java servlet code, you need to sanitize the user input before using it in the response output. Here is an improved version of the code that properly handles input sanitization: ```java import java.io.IOException; import javax.servlet.http.*; public class XSSSafeServlet extends HttpServlet { protected void doGet(HttpServletRequest request, HttpServletResponse response) throws IOException { String userInput = request.getParameter(""input""); // Sanitize user input to prevent XSS userInput = sanitizeInput(userInput); String greeting = ""Hello, "" + userInput + ""!""; response.setContentType(""text/html""); response.getWriter().println(""<html><body>""); response.getWriter().println(""<h1>"" + greeting + ""</h1>""); response.getWriter().println(""</body></html>""); } private String sanitizeInput(String input) { // Implement proper input sanitization here based on your application's requirements // For example, you can use OWASP ESAPI library or HTML escaping functions // Here is a simple example of HTML escaping return input != null ? input.replace(""&"", ""&amp;"").replace(""<"", ""&lt;"").replace("">"", ""&gt;"").replace(""\""",java,0
Buffer Overflow,"#include <iostream>
#include <cstring>

void unsafe_c_string(char* input) {
    char buffer[100];
    strcpy(buffer, input); // potential buffer overflow
    std::cout << buffer << std::endl;
}","#include <iostream>
#include <cstring>

void unsafe_c_string(char* input) {
    char buffer[100];
    strcpy(buffer, input); // potential buffer overflow
    std::cout << buffer << std::endl;
}",cpp,1
Clear,"#include <iostream>
#include <memory>

void safe_memory_management() {
    auto ptr = std::make_unique<int>(42);
    std::cout << *ptr << std::endl;
}","#include <iostream>
#include <memory>

void safe_memory_management() {
    auto ptr = std::make_unique<int>(42);
    std::cout << *ptr << std::endl;
}",cpp,0
Clear,"import requests
def safe_api_call():
    api_key = os.environ.get('API_KEY')
    headers = {'Authorization': f'Bearer {api_key}'}
    return requests.get('https://api.example.com/data', headers=headers)","import requests
def safe_api_call():
    api_key = os.environ.get('API_KEY')
    headers = {'Authorization': f'Bearer {api_key}'}
    return requests.get('https://api.example.com/data', headers=headers)",python,0
Buffer Overflow,"import java.util.Scanner;

public class BufferOverflowVulnerability {
    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        
        System.out.print(""Enter your name: "");
        String name = scanner.next();
        
        // Vulnerability: Not validating the length of user input before copying to a fixed-size array
        char[] buffer = new char[10];
        name.getChars(0, name.length(), buffer, 0);
        
        System.out.println(""Hello, "" + new String(buffer));
    }
}","import java.util.Scanner; public class BufferOverflowVulnerability { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter your name: ""); String name = scanner.next(); // Vulnerability: Not validating the length of user input before copying to a fixed-size array char[] buffer = new char[10]; name.getChars(0, name.length(), buffer, 0); System.out.println(""Hello, "" + new String(buffer)); } }",java,1
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
SSRF,"import urllib.request
def download_file(file_url):
    return urllib.request.urlopen(file_url).read()","import urllib.request
def download_file(file_url):
    return urllib.request.urlopen(file_url).read()",python,1
Clear,"#include <stdio.h>
#include <string.h>

int safe_buffer_operation(char *input) {
    char buffer[100];
    if (strlen(input) < sizeof(buffer)) {
        strcpy(buffer, input);
        return 0;
    }
    return -1; // buffer too small
}","#include <stdio.h>
#include <string.h>

int safe_buffer_operation(char *input) {
    char buffer[100];
    if (strlen(input) < sizeof(buffer)) {
        strcpy(buffer, input);
        return 0;
    }
    return -1; // buffer too small
}",c,0
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Clear,"import java.io.*;
import javax.servlet.*;
import javax.servlet.http.*;
import org.owasp.esapi.ESAPI;

public class XSSFixedServlet extends HttpServlet {
    protected void doGet(HttpServletRequest request, HttpServletResponse response)
            throws ServletException, IOException {
        response.setContentType(""text/html"");
        PrintWriter out = response.getWriter();

        String userInput = request.getParameter(""input"");

        // Sanitize and escape user input using ESAPI to prevent XSS
        String safeUserInput = ESAPI.encoder().encodeForHTML(userInput);

        out.println(""<html>"");
        out.println(""<body>"");
        out.println(""<h1>User Input: "" + safeUserInput + ""</h1>"");
        out.println(""</body>"");
        out.println(""</html>"");
    }
}","import java.io.*; import javax.servlet.*; import javax.servlet.http.*; import org.owasp.esapi.ESAPI; public class XSSFixedServlet extends HttpServlet { protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { response.setContentType(""text/html""); PrintWriter out = response.getWriter(); String userInput = request.getParameter(""input""); // Sanitize and escape user input using ESAPI to prevent XSS String safeUserInput = ESAPI.encoder().encodeForHTML(userInput); out.println(""<html>""); out.println(""<body>""); out.println(""<h1>User Input: "" + safeUserInput + ""</h1>""); out.println(""</body>""); out.println(""</html>""); } }",java,0
Clear,"import java.sql.*;

public class SQLInjectionSecure {
    public static void main(String[] args) {
        String userInput = ""'; DROP TABLE users; --""; // Malicious input simulating SQL injection
        String query = ""SELECT * FROM users WHERE username = ?"";

        try {
            Connection connection = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");
            PreparedStatement statement = connection.prepareStatement(query);
            statement.setString(1, userInput);

            ResultSet resultSet = statement.executeQuery();

            while (resultSet.next()) {
                System.out.println(""User: "" + resultSet.getString(""username""));
            }

            connection.close();
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.*; public class SQLInjectionSecure { public static void main(String[] args) { String userInput = ""'; DROP TABLE users; --""; // Malicious input simulating SQL injection String query = ""SELECT * FROM users WHERE username = ?""; try { Connection connection = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); PreparedStatement statement = connection.prepareStatement(query); statement.setString(1, userInput); ResultSet resultSet = statement.executeQuery(); while (resultSet.next()) { System.out.println(""User: "" + resultSet.getString(""username"")); } connection.close(); } catch (SQLException e) { e.printStackTrace(); } } }",java,0
Clear,"import re
def validate_email(email):
    pattern = r'^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$'
    return bool(re.match(pattern, email))","import re
def validate_email(email):
    pattern = r'^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$'
    return bool(re.match(pattern, email))",python,0
Memory Corruption,"#include <iostream>

void unsafe_virtual_call() {
    // Potential vtable corruption vulnerability
    class Base {
    public:
        virtual void func() { std::cout << ""Base"" << std::endl; }
    };
    
    class Derived : public Base {
    public:
        void func() override { std::cout << ""Derived"" << std::endl; }
    };
}","#include <iostream>

void unsafe_virtual_call() {
    // Potential vtable corruption vulnerability
    class Base {
    public:
        virtual void func() { std::cout << ""Base"" << std::endl; }
    };
    
    class Derived : public Base {
    public:
        void func() override { std::cout << ""Derived"" << std::endl; }
    };
}",cpp,1
Clear,"To fix the Path Traversal vulnerability in the given Java code snippet, you need to ensure that user input for the file name is properly validated and sanitized. Here is an improved version of the code with proper security measures:

```java
import java.io.File;
import java.io.IOException;
import java.util.Scanner;

public class SecurePathTraversal {

    private static final String BASE_PATH = ""/path/to/directory/"";

    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);

        System.out.print(""Enter file name: "");
        String fileName = scanner.nextLine();

        // Validate the input file name to prevent path traversal
        if (!isValidFileName(fileName)) {
            System.out.println(""Invalid file name."");
            return;
        }

        try {
            File file = new File(BASE_PATH + fileName);
            if (file.exists() && file.isFile()) { // Check if it's a valid file
                System.out.println(""File content:"");
                Scanner fileScanner = new Scanner(file);
                while (fileScanner.hasNextLine()) {
                    System.out.println(fileScanner.nextLine());
                }
                fileScanner.close();
            } else {
                System.out.println(""File not found or invalid."");
            }
        } catch (IOException e","To fix the Path Traversal vulnerability in the given Java code snippet, you need to ensure that user input for the file name is properly validated and sanitized. Here is an improved version of the code with proper security measures: ```java import java.io.File; import java.io.IOException; import java.util.Scanner; public class SecurePathTraversal { private static final String BASE_PATH = ""/path/to/directory/""; public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter file name: ""); String fileName = scanner.nextLine(); // Validate the input file name to prevent path traversal if (!isValidFileName(fileName)) { System.out.println(""Invalid file name.""); return; } try { File file = new File(BASE_PATH + fileName); if (file.exists() && file.isFile()) { // Check if it's a valid file System.out.println(""File content:""); Scanner fileScanner = new Scanner(file); while (fileScanner.hasNextLine()) { System.out.println(fileScanner.nextLine()); } fileScanner.close(); } else { System.out.println(""File not found or invalid.""); } } catch (IOException e",java,0
Clear,"import org.owasp.encoder.Encode;

public class XSSFixedCode {

    public static void main(String[] args) {
        // Simulating user input, but in a real scenario, this input would come from user interaction
        String userInput = ""<script>alert('XSS Vulnerability')</script>"";

        // Encoding user input before outputting it to prevent XSS
        String encodedUserInput = Encode.forHtml(userInput);
        
        // Outputting the properly encoded user input
        System.out.println(""<div>"" + encodedUserInput + ""</div>"");
    }
}","import org.owasp.encoder.Encode; public class XSSFixedCode { public static void main(String[] args) { // Simulating user input, but in a real scenario, this input would come from user interaction String userInput = ""<script>alert('XSS Vulnerability')</script>""; // Encoding user input before outputting it to prevent XSS String encodedUserInput = Encode.forHtml(userInput); // Outputting the properly encoded user input System.out.println(""<div>"" + encodedUserInput + ""</div>""); } }",java,0
Clear,"import java.util.Scanner;

public class SecureBuffer {

    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        System.out.print(""Enter a string (max 10 characters): "");
        String userInput = scanner.nextLine();

        if (userInput.length() > 10) {
            System.out.println(""Input string exceeds maximum length."");
            return;
        }

        char[] buffer = new char[10];
        userInput.getChars(0, Math.min(userInput.length(), buffer.length), buffer, 0);

        System.out.println(""Buffer content: "" + new String(buffer));
    }
}","import java.util.Scanner; public class SecureBuffer { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter a string (max 10 characters): ""); String userInput = scanner.nextLine(); if (userInput.length() > 10) { System.out.println(""Input string exceeds maximum length.""); return; } char[] buffer = new char[10]; userInput.getChars(0, Math.min(userInput.length(), buffer.length), buffer, 0); System.out.println(""Buffer content: "" + new String(buffer)); } }",java,0
Cross-Site Scripting (XSS),"import java.io.*;

public class XSSVulnerableCode {
    public static void main(String[] args) {
        // Simulating user input, but in reality, this could come from a user form input
        String userInput = ""<script>alert('XSS Vulnerability!')</script>"";

        // Improperly handling user input by directly outputting it to the response
        System.out.println(""<html>"");
        System.out.println(""<body>"");
        System.out.println(""<h1>Welcome, "" + userInput + ""</h1>"");
        System.out.println(""</body>"");
        System.out.println(""</html>"");
    }
}","import java.io.*; public class XSSVulnerableCode { public static void main(String[] args) { // Simulating user input, but in reality, this could come from a user form input String userInput = ""<script>alert('XSS Vulnerability!')</script>""; // Improperly handling user input by directly outputting it to the response System.out.println(""<html>""); System.out.println(""<body>""); System.out.println(""<h1>Welcome, "" + userInput + ""</h1>""); System.out.println(""</body>""); System.out.println(""</html>""); } }",java,1
Clear,"To fix the Buffer Overflow vulnerability in the given Java code snippet, you can implement the following secure coding practices:

1. Use `Scanner.nextLine()` instead of `Scanner.next()` to read a full line of input including spaces.
2. Perform bounds checking to ensure that the user input does not exceed the size of the buffer.
3. Use `String.substring()` or `String.toCharArray()` to copy a safe portion of the user input into the buffer.
4. Consider using dynamic data structures like `StringBuilder` or `ArrayList` instead of fixed-size arrays to handle variable-length input.

Here is an updated version of the code that addresses these security concerns:

```java
import java.util.Scanner;

public class SecureBuffer {
    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        
        System.out.print(""Enter your name: "");
        String userInput = scanner.nextLine(); // Read a full line
        
        int bufferSize = Math.min(userInput.length(), 10); // Limit buffer size
        
        char[] buffer = new char[bufferSize]; // Buffer with dynamic size
        
        // Copy user input into the buffer with bounds checking
        for (int i = 0; i < bufferSize; i++) {","To fix the Buffer Overflow vulnerability in the given Java code snippet, you can implement the following secure coding practices: 1. Use `Scanner.nextLine()` instead of `Scanner.next()` to read a full line of input including spaces. 2. Perform bounds checking to ensure that the user input does not exceed the size of the buffer. 3. Use `String.substring()` or `String.toCharArray()` to copy a safe portion of the user input into the buffer. 4. Consider using dynamic data structures like `StringBuilder` or `ArrayList` instead of fixed-size arrays to handle variable-length input. Here is an updated version of the code that addresses these security concerns: ```java import java.util.Scanner; public class SecureBuffer { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter your name: ""); String userInput = scanner.nextLine(); // Read a full line int bufferSize = Math.min(userInput.length(), 10); // Limit buffer size char[] buffer = new char[bufferSize]; // Buffer with dynamic size // Copy user input into the buffer with bounds checking for (int i = 0; i < bufferSize; i++) {",java,0
Clear,"<?php
$cmd = escapeshellarg($_GET['cmd']);
system(""ls "" . $cmd); // Escaped command
?>","<?php
$cmd = escapeshellarg($_GET['cmd']);
system(""ls "" . $cmd); // Escaped command
?>",php,0
Command Injection,"import os
def backup_database(db_name):
    os.system(f""pg_dump {db_name} > backup.sql"")","import os
def backup_database(db_name):
    os.system(f""pg_dump {db_name} > backup.sql"")",python,1
Clear,"import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.util.Scanner;

public class SecureSQLInjectionFix {
    public static void main(String[] args) {
        try {
            Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");

            Scanner scanner = new Scanner(System.in);
            System.out.print(""Enter username: "");
            String userInput = scanner.nextLine();

            String query = ""SELECT * FROM users WHERE username=?"";
            
            PreparedStatement pstmt = conn.prepareStatement(query);
            pstmt.setString(1, userInput);
            
            ResultSet rs = pstmt.executeQuery();

            while (rs.next()) {
                System.out.println(""User ID: "" + rs.getInt(""id"") + "", Username: "" + rs.getString(""username""));
            }

            conn.close();
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.Connection; import java.sql.DriverManager; import java.sql.PreparedStatement; import java.sql.ResultSet; import java.sql.SQLException; import java.util.Scanner; public class SecureSQLInjectionFix { public static void main(String[] args) { try { Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); Scanner scanner = new Scanner(System.in); System.out.print(""Enter username: ""); String userInput = scanner.nextLine(); String query = ""SELECT * FROM users WHERE username=?""; PreparedStatement pstmt = conn.prepareStatement(query); pstmt.setString(1, userInput); ResultSet rs = pstmt.executeQuery(); while (rs.next()) { System.out.println(""User ID: "" + rs.getInt(""id"") + "", Username: "" + rs.getString(""username"")); } conn.close(); } catch (SQLException e) { e.printStackTrace(); } } }",java,0
Clear,"To fix the command injection vulnerability in the provided Java code snippet, you should avoid directly concatenating user input to form a shell command. Instead, you should validate and sanitize the user input to prevent any malicious commands from being executed. Here's an improved version of the code using `ProcessBuilder` and properly sanitizing the input:

```java
import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class CommandInjectionSecure {

    public static void main(String[] args) throws IOException {
        BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));

        System.out.print(""Enter the name of the file to display its contents: "");
        String fileName = reader.readLine();

        // Sanitize user input by only allowing alphanumeric characters and specific characters like ""."", ""_""
        if (!fileName.matches(""[a-zA-Z0-9_.-]+"")) {
            System.out.println(""Invalid file name. Please enter a valid file name."");
            return;
        }

        // Use ProcessBuilder to safely execute the command
        ProcessBuilder processBuilder = new ProcessBuilder(""cat"", fileName);
        
        Process process = processBuilder.start();
        
        BufferedReader processOutputReader = new BufferedReader(new InputStreamReader(process.getInputStream()));
        String line;
        
        while ((line","To fix the command injection vulnerability in the provided Java code snippet, you should avoid directly concatenating user input to form a shell command. Instead, you should validate and sanitize the user input to prevent any malicious commands from being executed. Here's an improved version of the code using `ProcessBuilder` and properly sanitizing the input: ```java import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class CommandInjectionSecure { public static void main(String[] args) throws IOException { BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter the name of the file to display its contents: ""); String fileName = reader.readLine(); // Sanitize user input by only allowing alphanumeric characters and specific characters like ""."", ""_"" if (!fileName.matches(""[a-zA-Z0-9_.-]+"")) { System.out.println(""Invalid file name. Please enter a valid file name.""); return; } // Use ProcessBuilder to safely execute the command ProcessBuilder processBuilder = new ProcessBuilder(""cat"", fileName); Process process = processBuilder.start(); BufferedReader processOutputReader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line",java,0
Cross-Site Scripting (XSS),"def display_comment(comment_text):
    return f""<div class='comment'>{comment_text}</div>"" ","def display_comment(comment_text):
    return f""<div class='comment'>{comment_text}</div>"" ",python,1
Clear,"#include <stdio.h>
#include <string.h>

int safe_buffer_operation(char *input) {
    char buffer[100];
    if (strlen(input) < sizeof(buffer)) {
        strcpy(buffer, input);
        return 0;
    }
    return -1; // buffer too small
}","#include <stdio.h>
#include <string.h>

int safe_buffer_operation(char *input) {
    char buffer[100];
    if (strlen(input) < sizeof(buffer)) {
        strcpy(buffer, input);
        return 0;
    }
    return -1; // buffer too small
}",c,0
Path Traversal,"def get_user_file(username, filepath):
    import os
    base_path = f""/home/{username}/files/""
    full_path = base_path + filepath
    with open(full_path, 'r') as f:
        return f.read()","def get_user_file(username, filepath):
    import os
    base_path = f""/home/{username}/files/""
    full_path = base_path + filepath
    with open(full_path, 'r') as f:
        return f.read()",python,1
Clear,"from django.http import HttpResponse
from django.utils.html import escape

def safe_user_profile(request, username):
    safe_username = escape(username)
    return HttpResponse(f""Welcome, {safe_username}!"")","from django.http import HttpResponse
from django.utils.html import escape

def safe_user_profile(request, username):
    safe_username = escape(username)
    return HttpResponse(f""Welcome, {safe_username}!"")",python,0
Cross-Site Scripting (XSS),"import java.io.*;

public class XssVulnerableCode {
    public static void main(String[] args) {
        BufferedReader br = new BufferedReader(new InputStreamReader(System.in));
        
        System.out.print(""Enter your name: "");
        String name = br.readLine();
        
        System.out.println(""Hello, "" + name + ""! Welcome to our website."");
    }
}","import java.io.*; public class XssVulnerableCode { public static void main(String[] args) { BufferedReader br = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter your name: ""); String name = br.readLine(); System.out.println(""Hello, "" + name + ""! Welcome to our website.""); } }",java,1
Clear,"To fix this code and prevent SQL Injection vulnerabilities, you should use parameterized queries instead of concatenating user input directly into the SQL query string. Here is an updated version of your Java code that uses PreparedStatement with parameterized queries:

```java
import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;

public class SecureSQLInjectionExample {

    public static void main(String[] args) {
        String userInput = ""'; DROP TABLE users; --""; // Malicious input for SQL Injection

        try {
            // Establish database connection
            Connection connection = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");

            // Create parameterized SQL query
            String query = ""SELECT * FROM users WHERE username = ?"";
            PreparedStatement preparedStatement = connection.prepareStatement(query);
            preparedStatement.setString(1, userInput);

            // Execute the parameterized query
            ResultSet resultSet = preparedStatement.executeQuery();

            // Process the query result
            while (resultSet.next()) {
                System.out.println(""Username: "" + resultSet.getString(""username""));
                System.out.println(""Email: "" + resultSet.getString(""email""));
                System.out.println(""----------------------"");
            }

        } catch (","To fix this code and prevent SQL Injection vulnerabilities, you should use parameterized queries instead of concatenating user input directly into the SQL query string. Here is an updated version of your Java code that uses PreparedStatement with parameterized queries: ```java import java.sql.Connection; import java.sql.DriverManager; import java.sql.PreparedStatement; import java.sql.ResultSet; import java.sql.SQLException; public class SecureSQLInjectionExample { public static void main(String[] args) { String userInput = ""'; DROP TABLE users; --""; // Malicious input for SQL Injection try { // Establish database connection Connection connection = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); // Create parameterized SQL query String query = ""SELECT * FROM users WHERE username = ?""; PreparedStatement preparedStatement = connection.prepareStatement(query); preparedStatement.setString(1, userInput); // Execute the parameterized query ResultSet resultSet = preparedStatement.executeQuery(); // Process the query result while (resultSet.next()) { System.out.println(""Username: "" + resultSet.getString(""username"")); System.out.println(""Email: "" + resultSet.getString(""email"")); System.out.println(""----------------------""); } } catch (",java,0
Clear,"import subprocess
def safe_database_backup(db_name):
    result = subprocess.run(['pg_dump', db_name], capture_output=True, text=True)
    with open('backup.sql', 'w') as f:
        f.write(result.stdout)","import subprocess
def safe_database_backup(db_name):
    result = subprocess.run(['pg_dump', db_name], capture_output=True, text=True)
    with open('backup.sql', 'w') as f:
        f.write(result.stdout)",python,0
Code Injection,"const userData = eval('(' + userInput + ')'); // eval injection
","const userData = eval('(' + userInput + ')'); // eval injection
",javascript,1
SQL Injection,"import java.sql.*;

public class UserAuthentication {
    public static void main(String[] args) {
        String username = args[0];
        String password = args[1];

        try {
            Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""root"", ""password"");
            Statement stmt = conn.createStatement();

            // Vulnerable SQL query
            String query = ""SELECT * FROM users WHERE username='"" + username + ""' AND password='"" + password + ""'"";
            
            ResultSet rs = stmt.executeQuery(query);

            if (rs.next()) {
                System.out.println(""Login successful"");
            } else {
                System.out.println(""Login failed"");
            }

            conn.close();
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.*; public class UserAuthentication { public static void main(String[] args) { String username = args[0]; String password = args[1]; try { Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""root"", ""password""); Statement stmt = conn.createStatement(); // Vulnerable SQL query String query = ""SELECT * FROM users WHERE username='"" + username + ""' AND password='"" + password + ""'""; ResultSet rs = stmt.executeQuery(query); if (rs.next()) { System.out.println(""Login successful""); } else { System.out.println(""Login failed""); } conn.close(); } catch (SQLException e) { e.printStackTrace(); } } }",java,1
Hardcoded Secrets,"localStorage.setItem('token', 'hardcoded-secret-token-123'); // Hardcoded secret
","localStorage.setItem('token', 'hardcoded-secret-token-123'); // Hardcoded secret
",javascript,1
Clear,"import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;

public class SecureSQLCode {

    public static void main(String[] args) {
        String userInput = ""'; DROP TABLE users; --"";

        try {
            Connection connection = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");

            String query = ""SELECT * FROM users WHERE username=?"";
            PreparedStatement statement = connection.prepareStatement(query);
            statement.setString(1, userInput);

            ResultSet resultSet = statement.executeQuery();

            while (resultSet.next()) {
                System.out.println(""User found: "" + resultSet.getString(""username""));
            }

            resultSet.close();
            statement.close();
            connection.close();
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.Connection; import java.sql.DriverManager; import java.sql.PreparedStatement; import java.sql.ResultSet; import java.sql.SQLException; public class SecureSQLCode { public static void main(String[] args) { String userInput = ""'; DROP TABLE users; --""; try { Connection connection = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); String query = ""SELECT * FROM users WHERE username=?""; PreparedStatement statement = connection.prepareStatement(query); statement.setString(1, userInput); ResultSet resultSet = statement.executeQuery(); while (resultSet.next()) { System.out.println(""User found: "" + resultSet.getString(""username"")); } resultSet.close(); statement.close(); connection.close(); } catch (SQLException e) { e.printStackTrace(); } } }",java,0
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
XSS,"<?php
echo $_GET['message']; // XSS
?>","<?php
echo $_GET['message']; // XSS
?>",php,1
Path Traversal,"import java.io.File;
import java.io.FileInputStream;
import java.io.IOException;

public class PathTraversalVulnerability {

    public static void main(String[] args) {
        String fileName = args[0]; // Assume user input for file name
        
        try {
            File file = new File(""C:/data/"" + fileName); // Vulnerable code: User input is directly concatenated to the path
            
            FileInputStream fis = new FileInputStream(file);
            // Read the contents of the file
            int data;
            while ((data = fis.read()) != -1) {
                System.out.print((char) data);
            }
            
            fis.close();
        } catch (IOException e) {
            System.out.println(""Error reading file: "" + e.getMessage());
        }
    }
}","import java.io.File; import java.io.FileInputStream; import java.io.IOException; public class PathTraversalVulnerability { public static void main(String[] args) { String fileName = args[0]; // Assume user input for file name try { File file = new File(""C:/data/"" + fileName); // Vulnerable code: User input is directly concatenated to the path FileInputStream fis = new FileInputStream(file); // Read the contents of the file int data; while ((data = fis.read()) != -1) { System.out.print((char) data); } fis.close(); } catch (IOException e) { System.out.println(""Error reading file: "" + e.getMessage()); } } }",java,1
SQL Injection,"<?php
$username = $_POST['username'];
$query = ""SELECT * FROM users WHERE username = '$username'"";
$result = mysql_query($query); // SQL Injection
?>","<?php
$username = $_POST['username'];
$query = ""SELECT * FROM users WHERE username = '$username'"";
$result = mysql_query($query); // SQL Injection
?>",php,1
Path Traversal,"import java.io.File;
import java.io.FileInputStream;
import java.io.IOException;

public class FileRead {

    public static void main(String[] args) {
        String fileName = args[0]; // User input for file name

        try {
            File file = new File(fileName);
            FileInputStream fis = new FileInputStream(file);

            int content;
            while ((content = fis.read()) != -1) {
                System.out.print((char) content);
            }

            fis.close();
        } catch (IOException e) {
            System.out.println(""Error reading file: "" + e.getMessage());
        }
    }
}","import java.io.File; import java.io.FileInputStream; import java.io.IOException; public class FileRead { public static void main(String[] args) { String fileName = args[0]; // User input for file name try { File file = new File(fileName); FileInputStream fis = new FileInputStream(file); int content; while ((content = fis.read()) != -1) { System.out.print((char) content); } fis.close(); } catch (IOException e) { System.out.println(""Error reading file: "" + e.getMessage()); } } }",java,1
Clear,"#include <stdio.h>
#include <string.h>

int validate_input(const char *input) {
    if (input == NULL) return 0;
    for (int i = 0; input[i] != '\0'; i++) {
        if (input[i] < 32 || input[i] > 126) {
            return 0; // invalid character
        }
    }
    return 1;
}","#include <stdio.h>
#include <string.h>

int validate_input(const char *input) {
    if (input == NULL) return 0;
    for (int i = 0; input[i] != '\0'; i++) {
        if (input[i] < 32 || input[i] > 126) {
            return 0; // invalid character
        }
    }
    return 1;
}",c,0
SQL Injection,"app.get('/user/:id', (req, res) => {
    const query = `SELECT * FROM users WHERE id = ${req.params.id}`; // SQL Injection
    db.query(query, (err, result) => {
        res.json(result);
    });
});
","app.get('/user/:id', (req, res) => {
    const query = `SELECT * FROM users WHERE id = ${req.params.id}`; // SQL Injection
    db.query(query, (err, result) => {
        res.json(result);
    });
});
",javascript,1
SQL Injection,"import psycopg2
def admin_login(admin_id):
    conn = psycopg2.connect(""dbname=test user=postgres"")
    cur = conn.cursor()
    cur.execute(f""SELECT * FROM admins WHERE id = {admin_id}"")
    return cur.fetchone()","import psycopg2
def admin_login(admin_id):
    conn = psycopg2.connect(""dbname=test user=postgres"")
    cur = conn.cursor()
    cur.execute(f""SELECT * FROM admins WHERE id = {admin_id}"")
    return cur.fetchone()",python,1
Clear,"#include <iostream>
#include <vector>
#include <stdexcept>

int safe_vector_access(const std::vector<int>& vec, size_t index) {
    if (index >= vec.size()) {
        throw std::out_of_range(""Index out of range"");
    }
    return vec[index];
}","#include <iostream>
#include <vector>
#include <stdexcept>

int safe_vector_access(const std::vector<int>& vec, size_t index) {
    if (index >= vec.size()) {
        throw std::out_of_range(""Index out of range"");
    }
    return vec[index];
}",cpp,0
Buffer Overflow,"#include <iostream>
#include <cstring>

void unsafe_c_string(char* input) {
    char buffer[100];
    strcpy(buffer, input); // potential buffer overflow
    std::cout << buffer << std::endl;
}","#include <iostream>
#include <cstring>

void unsafe_c_string(char* input) {
    char buffer[100];
    strcpy(buffer, input); // potential buffer overflow
    std::cout << buffer << std::endl;
}",cpp,1
Insecure Deserialization,"import pickle
def load_user_data(filename):
    with open(filename, 'rb') as f:
        data = pickle.load(f)
    return data","import pickle
def load_user_data(filename):
    with open(filename, 'rb') as f:
        data = pickle.load(f)
    return data",python,1
SQL Injection,"import java.sql.*;

public class SQLInjectionVulnerableExample {
    public static void main(String[] args) {
        String userInput = ""'; DROP TABLE users; --"";
        
        try {
            Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");
            Statement stmt = conn.createStatement();
            
            String query = ""SELECT * FROM users WHERE username = '"" + userInput + ""'"";
            ResultSet rs = stmt.executeQuery(query);
            
            while (rs.next()) {
                System.out.println(rs.getString(""username""));
            }
            
            conn.close();
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.*; public class SQLInjectionVulnerableExample { public static void main(String[] args) { String userInput = ""'; DROP TABLE users; --""; try { Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); Statement stmt = conn.createStatement(); String query = ""SELECT * FROM users WHERE username = '"" + userInput + ""'""; ResultSet rs = stmt.executeQuery(query); while (rs.next()) { System.out.println(rs.getString(""username"")); } conn.close(); } catch (SQLException e) { e.printStackTrace(); } } }",java,1
Clear,"<?php
$input = json_decode($_POST['data'], true); // Safe JSON parsing
if (json_last_error() === JSON_ERROR_NONE) {
    process_data($input);
}
?>","<?php
$input = json_decode($_POST['data'], true); // Safe JSON parsing
if (json_last_error() === JSON_ERROR_NONE) {
    process_data($input);
}
?>",php,0
Clear,"#include <stdio.h>
#include <stdlib.h>

void safe_file_operation(const char *filename) {
    FILE *file = fopen(filename, ""r"");
    if (file != NULL) {
        char buffer[256];
        while (fgets(buffer, sizeof(buffer), file)) {
            printf(""%s"", buffer);
        }
        fclose(file);
    }
}","#include <stdio.h>
#include <stdlib.h>

void safe_file_operation(const char *filename) {
    FILE *file = fopen(filename, ""r"");
    if (file != NULL) {
        char buffer[256];
        while (fgets(buffer, sizeof(buffer), file)) {
            printf(""%s"", buffer);
        }
        fclose(file);
    }
}",c,0
Clear,"import java.util.Scanner;

public class SecureBufferExample {
    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        System.out.print(""Enter a string: "");
        String userInput = scanner.nextLine();
        
        int bufferSize = 10;
        
        // Check if user input exceeds buffer size
        if (userInput.length() > bufferSize) {
            System.out.println(""Input string is too long. Please enter a string with maximum "" + bufferSize + "" characters."");
            return;
        }
        
        char[] buffer = new char[bufferSize];
        
        userInput.getChars(0, Math.min(userInput.length(), bufferSize), buffer, 0);
        
        System.out.println(""Buffer contents: "" + new String(buffer));
    }
}","import java.util.Scanner; public class SecureBufferExample { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter a string: ""); String userInput = scanner.nextLine(); int bufferSize = 10; // Check if user input exceeds buffer size if (userInput.length() > bufferSize) { System.out.println(""Input string is too long. Please enter a string with maximum "" + bufferSize + "" characters.""); return; } char[] buffer = new char[bufferSize]; userInput.getChars(0, Math.min(userInput.length(), bufferSize), buffer, 0); System.out.println(""Buffer contents: "" + new String(buffer)); } }",java,0
Clear,"<?php
$input = json_decode($_POST['data'], true); // Safe JSON parsing
if (json_last_error() === JSON_ERROR_NONE) {
    process_data($input);
}
?>","<?php
$input = json_decode($_POST['data'], true); // Safe JSON parsing
if (json_last_error() === JSON_ERROR_NONE) {
    process_data($input);
}
?>",php,0
Clear,"#include <stdio.h>
#include <stdlib.h>

void safe_file_operation(const char *filename) {
    FILE *file = fopen(filename, ""r"");
    if (file != NULL) {
        char buffer[256];
        while (fgets(buffer, sizeof(buffer), file)) {
            printf(""%s"", buffer);
        }
        fclose(file);
    }
}","#include <stdio.h>
#include <stdlib.h>

void safe_file_operation(const char *filename) {
    FILE *file = fopen(filename, ""r"");
    if (file != NULL) {
        char buffer[256];
        while (fgets(buffer, sizeof(buffer), file)) {
            printf(""%s"", buffer);
        }
        fclose(file);
    }
}",c,0
Cross-Site Scripting (XSS),"import java.io.IOException;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

public class InputHandlerServlet extends HttpServlet {

    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws IOException {
        String userInput = request.getParameter(""input"");
        response.getWriter().println(""Hello, "" + userInput);
    }
}","import java.io.IOException; import javax.servlet.http.HttpServletRequest; import javax.servlet.http.HttpServletResponse; public class InputHandlerServlet extends HttpServlet { protected void doGet(HttpServletRequest request, HttpServletResponse response) throws IOException { String userInput = request.getParameter(""input""); response.getWriter().println(""Hello, "" + userInput); } }",java,1
Clear,"<?php
$input = json_decode($_POST['data'], true); // Safe JSON parsing
if (json_last_error() === JSON_ERROR_NONE) {
    process_data($input);
}
?>","<?php
$input = json_decode($_POST['data'], true); // Safe JSON parsing
if (json_last_error() === JSON_ERROR_NONE) {
    process_data($input);
}
?>",php,0
Clear,"import requests
def safe_fetch_url(url):
    allowed_domains = ['example.com', 'api.trusted.com']
    from urllib.parse import urlparse
    domain = urlparse(url).netloc
    if domain not in allowed_domains:
        raise ValueError(""Domain not allowed"")
    return requests.get(url).text","import requests
def safe_fetch_url(url):
    allowed_domains = ['example.com', 'api.trusted.com']
    from urllib.parse import urlparse
    domain = urlparse(url).netloc
    if domain not in allowed_domains:
        raise ValueError(""Domain not allowed"")
    return requests.get(url).text",python,0
Clear,"import java.sql.*;

public class SQLInjectionSecure {

    public static void main(String[] args) {
        String userInput = ""'; DROP TABLE users; --"";

        try {
            Connection connection = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");

            String query = ""SELECT * FROM users WHERE username=?"";
            PreparedStatement preparedStatement = connection.prepareStatement(query);
            preparedStatement.setString(1, userInput);

            ResultSet resultSet = preparedStatement.executeQuery();

            while (resultSet.next()) {
                System.out.println(resultSet.getString(""username""));
            }

            connection.close();
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.*; public class SQLInjectionSecure { public static void main(String[] args) { String userInput = ""'; DROP TABLE users; --""; try { Connection connection = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); String query = ""SELECT * FROM users WHERE username=?""; PreparedStatement preparedStatement = connection.prepareStatement(query); preparedStatement.setString(1, userInput); ResultSet resultSet = preparedStatement.executeQuery(); while (resultSet.next()) { System.out.println(resultSet.getString(""username"")); } connection.close(); } catch (SQLException e) { e.printStackTrace(); } } }",java,0
Clear,"#include <stdio.h>
#include <string.h>

void safe_string_copy(char *dest, const char *src, size_t dest_size) {
    if (dest_size > 0) {
        strncpy(dest, src, dest_size - 1);
        dest[dest_size - 1] = '\0';
    }
}","#include <stdio.h>
#include <string.h>

void safe_string_copy(char *dest, const char *src, size_t dest_size) {
    if (dest_size > 0) {
        strncpy(dest, src, dest_size - 1);
        dest[dest_size - 1] = '\0';
    }
}",c,0
Hardcoded Secrets,"localStorage.setItem('token', 'hardcoded-secret-token-123'); // Hardcoded secret
","localStorage.setItem('token', 'hardcoded-secret-token-123'); // Hardcoded secret
",javascript,1
Clear,"This code snippet demonstrates a vulnerability related to Insecure Deserialization. To fix this code and implement proper security measures, you can follow these steps:

1. Use a secure serialization format: Instead of using Java serialization, which is vulnerable to various attacks, consider using a more secure serialization format like JSON or XML with proper validation.

2. Implement input validation: Validate user input to ensure that it is safe and not malicious. Do not directly deserialize data from untrusted sources.

3. Use a secure deserialization library: If deserialization is necessary, use a secure deserialization library that provides protection against common vulnerabilities like object injection and remote code execution.

4. Enable class whitelisting: Restrict the classes that can be deserialized by maintaining a whitelist of allowed classes and packages.

5. Implement integrity checks: Use digital signatures or checksums to verify the integrity of serialized data before deserialization.

6. Monitor and log deserialization activities: Implement logging mechanisms to track deserialization activities for detecting potential security incidents.

By following these steps and best practices for secure coding, you can mitigate the risks associated with insecure deserialization vulnerabilities in your Java applications.","This code snippet demonstrates a vulnerability related to Insecure Deserialization. To fix this code and implement proper security measures, you can follow these steps: 1. Use a secure serialization format: Instead of using Java serialization, which is vulnerable to various attacks, consider using a more secure serialization format like JSON or XML with proper validation. 2. Implement input validation: Validate user input to ensure that it is safe and not malicious. Do not directly deserialize data from untrusted sources. 3. Use a secure deserialization library: If deserialization is necessary, use a secure deserialization library that provides protection against common vulnerabilities like object injection and remote code execution. 4. Enable class whitelisting: Restrict the classes that can be deserialized by maintaining a whitelist of allowed classes and packages. 5. Implement integrity checks: Use digital signatures or checksums to verify the integrity of serialized data before deserialization. 6. Monitor and log deserialization activities: Implement logging mechanisms to track deserialization activities for detecting potential security incidents. By following these steps and best practices for secure coding, you can mitigate the risks associated with insecure deserialization vulnerabilities in your Java applications.",php,0
Clear,"const token = process.env.API_TOKEN; // Environment variable
fetch('/api/data', {
    headers: { 'Authorization': `Bearer ${token}` }
});
","const token = process.env.API_TOKEN; // Environment variable
fetch('/api/data', {
    headers: { 'Authorization': `Bearer ${token}` }
});
",javascript,0
Clear,"import subprocess
def safe_ping(host):
    import re
    if not re.match(r'^[a-zA-Z0-9.-]+$', host):
        raise ValueError(""Invalid host"")
    result = subprocess.run(['ping', '-c', '4', host], capture_output=True, text=True)
    return result.stdout","import subprocess
def safe_ping(host):
    import re
    if not re.match(r'^[a-zA-Z0-9.-]+$', host):
        raise ValueError(""Invalid host"")
    result = subprocess.run(['ping', '-c', '4', host], capture_output=True, text=True)
    return result.stdout",python,0
Clear,"import java.io.IOException;
import javax.servlet.ServletException;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

public class SecureServlet extends HttpServlet {
    @Override
    protected void doPost(HttpServletRequest request, HttpServletResponse response)
            throws ServletException, IOException {
        String userInput = request.getParameter(""input"");
        String sanitizedInput = sanitizeInput(userInput);
        
        response.setContentType(""text/html"");
        response.setCharacterEncoding(""UTF-8"");
        response.getWriter().println(""<p>User Input: "" + sanitizedInput + ""</p>"");
    }

    private String sanitizeInput(String input) {
        // Replace special characters with their HTML entity equivalents
        input = input.replace(""&"", ""&amp;"")
                     .replace(""<"", ""&lt;"")
                     .replace("">"", ""&gt;"")
                     .replace(""\"""", ""&quot;"")
                     .replace(""'"", ""&#x27;"")
                     .replace(""/"", ""&#x2F;"");
        
        return input;
    }
}","import java.io.IOException; import javax.servlet.ServletException; import javax.servlet.http.HttpServlet; import javax.servlet.http.HttpServletRequest; import javax.servlet.http.HttpServletResponse; public class SecureServlet extends HttpServlet { @Override protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { String userInput = request.getParameter(""input""); String sanitizedInput = sanitizeInput(userInput); response.setContentType(""text/html""); response.setCharacterEncoding(""UTF-8""); response.getWriter().println(""<p>User Input: "" + sanitizedInput + ""</p>""); } private String sanitizeInput(String input) { // Replace special characters with their HTML entity equivalents input = input.replace(""&"", ""&amp;"") .replace(""<"", ""&lt;"") .replace("">"", ""&gt;"") .replace(""\"""", ""&quot;"") .replace(""'"", ""&#x27;"") .replace(""/"", ""&#x2F;""); return input; } }",java,0
Command Injection,"<?php
$cmd = $_GET['cmd'];
system($cmd); // Command Injection
?>","<?php
$cmd = $_GET['cmd'];
system($cmd); // Command Injection
?>",php,1
Clear,"<?php
$input = json_decode($_POST['data'], true); // Safe JSON parsing
if (json_last_error() === JSON_ERROR_NONE) {
    process_data($input);
}
?>","<?php
$input = json_decode($_POST['data'], true); // Safe JSON parsing
if (json_last_error() === JSON_ERROR_NONE) {
    process_data($input);
}
?>",php,0
Command Injection,"import java.io.*;

public class CommandInjectionVulnerable {

    public static void main(String[] args) {
        try {
            BufferedReader br = new BufferedReader(new InputStreamReader(System.in));
            System.out.print(""Enter a command to execute: "");
            String userInput = br.readLine();

            Process p = Runtime.getRuntime().exec(""ping "" + userInput);
            BufferedReader inputStream = new BufferedReader(new InputStreamReader(p.getInputStream()));

            String line;
            while ((line = inputStream.readLine()) != null) {
                System.out.println(line);
            }

        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}","import java.io.*; public class CommandInjectionVulnerable { public static void main(String[] args) { try { BufferedReader br = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a command to execute: ""); String userInput = br.readLine(); Process p = Runtime.getRuntime().exec(""ping "" + userInput); BufferedReader inputStream = new BufferedReader(new InputStreamReader(p.getInputStream())); String line; while ((line = inputStream.readLine()) != null) { System.out.println(line); } } catch (IOException e) { e.printStackTrace(); } } }",java,1
Clear,"import java.io.*;
import javax.servlet.*;
import javax.servlet.http.*;
import org.owasp.encoder.Encode;

public class SecureServlet extends HttpServlet {
    protected void doGet(HttpServletRequest request, HttpServletResponse response)
            throws ServletException, IOException {
        String userInput = request.getParameter(""input"");

        PrintWriter out = response.getWriter();
        out.println(""<html>"");
        out.println(""<body>"");
        out.println(""<h1>User Input: "" + Encode.forHtml(userInput) + ""</h1>""); // Sanitize user input
        out.println(""</body>"");
        out.println(""</html>"");
    }
}","import java.io.*; import javax.servlet.*; import javax.servlet.http.*; import org.owasp.encoder.Encode; public class SecureServlet extends HttpServlet { protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { String userInput = request.getParameter(""input""); PrintWriter out = response.getWriter(); out.println(""<html>""); out.println(""<body>""); out.println(""<h1>User Input: "" + Encode.forHtml(userInput) + ""</h1>""); // Sanitize user input out.println(""</body>""); out.println(""</html>""); } }",java,0
Memory Corruption,"#include <iostream>

void unsafe_virtual_call() {
    // Potential vtable corruption vulnerability
    class Base {
    public:
        virtual void func() { std::cout << ""Base"" << std::endl; }
    };
    
    class Derived : public Base {
    public:
        void func() override { std::cout << ""Derived"" << std::endl; }
    };
}","#include <iostream>

void unsafe_virtual_call() {
    // Potential vtable corruption vulnerability
    class Base {
    public:
        virtual void func() { std::cout << ""Base"" << std::endl; }
    };
    
    class Derived : public Base {
    public:
        void func() override { std::cout << ""Derived"" << std::endl; }
    };
}",cpp,1
Clear,"const shell = require('child_process');
const safeInput = userInput.replace(/[^a-zA-Z0-9.]/g, '');
shell.execFile('ping', [safeInput]); // Safe command execution
","const shell = require('child_process');
const safeInput = userInput.replace(/[^a-zA-Z0-9.]/g, '');
shell.execFile('ping', [safeInput]); // Safe command execution
",javascript,0
Clear,"<?php
$file = basename($_GET['file']);
$allowed = ['page1.php', 'page2.php'];
if (in_array($file, $allowed)) {
    include($file);
}
?>","<?php
$file = basename($_GET['file']);
$allowed = ['page1.php', 'page2.php'];
if (in_array($file, $allowed)) {
    include($file);
}
?>",php,0
Memory Corruption,"#include <iostream>

void unsafe_virtual_call() {
    // Potential vtable corruption vulnerability
    class Base {
    public:
        virtual void func() { std::cout << ""Base"" << std::endl; }
    };
    
    class Derived : public Base {
    public:
        void func() override { std::cout << ""Derived"" << std::endl; }
    };
}","#include <iostream>

void unsafe_virtual_call() {
    // Potential vtable corruption vulnerability
    class Base {
    public:
        virtual void func() { std::cout << ""Base"" << std::endl; }
    };
    
    class Derived : public Base {
    public:
        void func() override { std::cout << ""Derived"" << std::endl; }
    };
}",cpp,1
File Inclusion,"<?php
$file = $_GET['file'];
include($file); // File Inclusion
?>","<?php
$file = $_GET['file'];
include($file); // File Inclusion
?>",php,1
Clear,"import pickle
def safe_deserialize(data):
    allowed_classes = {'SafeClass', 'AnotherSafeClass'}
    return pickle.loads(data)","import pickle
def safe_deserialize(data):
    allowed_classes = {'SafeClass', 'AnotherSafeClass'}
    return pickle.loads(data)",python,0
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Command Injection,"import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class CommandInjectionVulnerable {

    public static void main(String[] args) {
        try {
            BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));
            System.out.print(""Enter a command to execute: "");
            String userInput = reader.readLine();

            // Vulnerable code - directly passing user input to the command
            Process process = Runtime.getRuntime().exec(""ping "" + userInput);

            BufferedReader inputStreamReader = new BufferedReader(new InputStreamReader(process.getInputStream()));
            String line;
            
            while ((line = inputStreamReader.readLine()) != null) {
                System.out.println(line);
            }
            
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}","import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class CommandInjectionVulnerable { public static void main(String[] args) { try { BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a command to execute: ""); String userInput = reader.readLine(); // Vulnerable code - directly passing user input to the command Process process = Runtime.getRuntime().exec(""ping "" + userInput); BufferedReader inputStreamReader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = inputStreamReader.readLine()) != null) { System.out.println(line); } } catch (IOException e) { e.printStackTrace(); } } }",java,1
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Clear,"#include <stdio.h>
#include <string.h>

int validate_input(const char *input) {
    if (input == NULL) return 0;
    for (int i = 0; input[i] != '\0'; i++) {
        if (input[i] < 32 || input[i] > 126) {
            return 0; // invalid character
        }
    }
    return 1;
}","#include <stdio.h>
#include <string.h>

int validate_input(const char *input) {
    if (input == NULL) return 0;
    for (int i = 0; input[i] != '\0'; i++) {
        if (input[i] < 32 || input[i] > 126) {
            return 0; // invalid character
        }
    }
    return 1;
}",c,0
Clear,"import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.util.Scanner;

public class SQLInjectionSecure {
    public static void main(String[] args) {
        try {
            Scanner scanner = new Scanner(System.in);
            System.out.print(""Enter username: "");
            String username = scanner.nextLine();

            // Secure code: Using PreparedStatement to prevent SQL Injection
            String query = ""SELECT * FROM users WHERE username=?"";
            
            Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");
            
            PreparedStatement pstmt = conn.prepareStatement(query);
            pstmt.setString(1, username);
            
            ResultSet rs = pstmt.executeQuery();
            
            while (rs.next()) {
                System.out.println(""User ID: "" + rs.getInt(""id"") + "", Username: "" + rs.getString(""username""));
            }
            
            conn.close();
        } catch (Exception e) {
            e.printStackTrace();
        }
    }
}","import java.sql.Connection; import java.sql.DriverManager; import java.sql.PreparedStatement; import java.sql.ResultSet; import java.util.Scanner; public class SQLInjectionSecure { public static void main(String[] args) { try { Scanner scanner = new Scanner(System.in); System.out.print(""Enter username: ""); String username = scanner.nextLine(); // Secure code: Using PreparedStatement to prevent SQL Injection String query = ""SELECT * FROM users WHERE username=?""; Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); PreparedStatement pstmt = conn.prepareStatement(query); pstmt.setString(1, username); ResultSet rs = pstmt.executeQuery(); while (rs.next()) { System.out.println(""User ID: "" + rs.getInt(""id"") + "", Username: "" + rs.getString(""username"")); } conn.close(); } catch (Exception e) { e.printStackTrace(); } } }",java,0
Clear,"#include <iostream>
#include <fstream>
#include <string>

void safe_file_reading(const std::string& filename) {
    std::ifstream file(filename);
    if (file.is_open()) {
        std::string line;
        while (std::getline(file, line)) {
            std::cout << line << std::endl;
        }
    }
}","#include <iostream>
#include <fstream>
#include <string>

void safe_file_reading(const std::string& filename) {
    std::ifstream file(filename);
    if (file.is_open()) {
        std::string line;
        while (std::getline(file, line)) {
            std::cout << line << std::endl;
        }
    }
}",cpp,0
Memory Corruption,"#include <iostream>

void unsafe_virtual_call() {
    // Potential vtable corruption vulnerability
    class Base {
    public:
        virtual void func() { std::cout << ""Base"" << std::endl; }
    };
    
    class Derived : public Base {
    public:
        void func() override { std::cout << ""Derived"" << std::endl; }
    };
}","#include <iostream>

void unsafe_virtual_call() {
    // Potential vtable corruption vulnerability
    class Base {
    public:
        virtual void func() { std::cout << ""Base"" << std::endl; }
    };
    
    class Derived : public Base {
    public:
        void func() override { std::cout << ""Derived"" << std::endl; }
    };
}",cpp,1
Insecure Deserialization,"<?php
$data = $_POST['data'];
unserialize($data); // Insecure Deserialization
?>","<?php
$data = $_POST['data'];
unserialize($data); // Insecure Deserialization
?>",php,1
SSRF,"import urllib.request
def download_file(file_url):
    return urllib.request.urlopen(file_url).read()","import urllib.request
def download_file(file_url):
    return urllib.request.urlopen(file_url).read()",python,1
Clear,"import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class SecureCommandExecutionExample {

    public static void main(String[] args) {
        try {
            BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));
            System.out.print(""Enter the file name to display its contents: "");
            String fileName = reader.readLine();

            // Secure implementation using ProcessBuilder
            ProcessBuilder processBuilder = new ProcessBuilder(""cat"", fileName);
            Process process = processBuilder.start();

            BufferedReader processOutputReader = new BufferedReader(new InputStreamReader(process.getInputStream()));
            String line;
            while ((line = processOutputReader.readLine()) != null) {
                System.out.println(line);
            }

        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}","import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class SecureCommandExecutionExample { public static void main(String[] args) { try { BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter the file name to display its contents: ""); String fileName = reader.readLine(); // Secure implementation using ProcessBuilder ProcessBuilder processBuilder = new ProcessBuilder(""cat"", fileName); Process process = processBuilder.start(); BufferedReader processOutputReader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = processOutputReader.readLine()) != null) { System.out.println(line); } } catch (IOException e) { e.printStackTrace(); } } }",java,0
Cross-Site Scripting (XSS),"import java.io.*;

public class XSSVulnerableCode {

    public static void main(String[] args) throws IOException {
        BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));
        
        System.out.print(""Enter your name: "");
        String name = reader.readLine();

        // Improperly handling user input by directly printing it to the output
        System.out.println(""Hello, "" + name + ""! Welcome to our website."");
    }
}","import java.io.*; public class XSSVulnerableCode { public static void main(String[] args) throws IOException { BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter your name: ""); String name = reader.readLine(); // Improperly handling user input by directly printing it to the output System.out.println(""Hello, "" + name + ""! Welcome to our website.""); } }",java,1
Clear,"<?php
$message = htmlspecialchars($_GET['message'], ENT_QUOTES, 'UTF-8');
echo $message; // Sanitized output
?>","<?php
$message = htmlspecialchars($_GET['message'], ENT_QUOTES, 'UTF-8');
echo $message; // Sanitized output
?>",php,0
Buffer Overflow,"#include <iostream>
#include <cstring>

void unsafe_c_string(char* input) {
    char buffer[100];
    strcpy(buffer, input); // potential buffer overflow
    std::cout << buffer << std::endl;
}","#include <iostream>
#include <cstring>

void unsafe_c_string(char* input) {
    char buffer[100];
    strcpy(buffer, input); // potential buffer overflow
    std::cout << buffer << std::endl;
}",cpp,1
Out-of-Bounds,"#include <iostream>

class UnsafeClass {
    int data[10];
public:
    int get_data(int index) {
        return data[index]; // no bounds checking
    }
};","#include <iostream>

class UnsafeClass {
    int data[10];
public:
    int get_data(int index) {
        return data[index]; // no bounds checking
    }
};",cpp,1
Clear,"#include <stdio.h>
#include <stdlib.h>

int safe_string_to_int(const char *str) {
    char *endptr;
    long value = strtol(str, &endptr, 10);
    if (*endptr != '\0' || str == endptr) {
        return -1; // error
    }
    return (int)value;
}","#include <stdio.h>
#include <stdlib.h>

int safe_string_to_int(const char *str) {
    char *endptr;
    long value = strtol(str, &endptr, 10);
    if (*endptr != '\0' || str == endptr) {
        return -1; // error
    }
    return (int)value;
}",c,0
Clear,"<?php
$cmd = escapeshellarg($_GET['cmd']);
system(""ls "" . $cmd); // Escaped command
?>","<?php
$cmd = escapeshellarg($_GET['cmd']);
system(""ls "" . $cmd); // Escaped command
?>",php,0
Clear,"import json
def parse_safe_json(json_str):
    try:
        return json.loads(json_str)
    except json.JSONDecodeError:
        raise ValueError(""Invalid JSON"")","import json
def parse_safe_json(json_str):
    try:
        return json.loads(json_str)
    except json.JSONDecodeError:
        raise ValueError(""Invalid JSON"")",python,0
Insecure Deserialization,"import pickle
def load_user_data(filename):
    with open(filename, 'rb') as f:
        data = pickle.load(f)
    return data","import pickle
def load_user_data(filename):
    with open(filename, 'rb') as f:
        data = pickle.load(f)
    return data",python,1
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Clear,"To fix the code and prevent Path Traversal vulnerabilities, you should validate the input file name to ensure it does not contain any directory traversal sequences. Here's an updated version of the code with proper security measures:

```java
import java.io.File;
import java.util.Scanner;
import java.util.regex.Pattern;

public class SecurePathTraversalExample {

    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        System.out.println(""Enter a file name:"");
        String fileName = scanner.nextLine();

        if (isValidFileName(fileName)) {
            File file = new File(""/path/to/directory/"" + fileName);

            try {
                if (file.exists()) {
                    System.out.println(""File exists."");
                } else {
                    System.out.println(""File does not exist."");
                }
            } catch (Exception e) {
                System.out.println(""Error accessing file."");
            }
        } else {
            System.out.println(""Invalid file name."");
        }
    }

    private static boolean isValidFileName(String fileName) {
        // Validate the file name to prevent path traversal
        // Here, we use a simple regex pattern to only allow alphanumeric characters, dots, and underscores
        String pattern = ""^[a-zA-Z0-","To fix the code and prevent Path Traversal vulnerabilities, you should validate the input file name to ensure it does not contain any directory traversal sequences. Here's an updated version of the code with proper security measures: ```java import java.io.File; import java.util.Scanner; import java.util.regex.Pattern; public class SecurePathTraversalExample { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.println(""Enter a file name:""); String fileName = scanner.nextLine(); if (isValidFileName(fileName)) { File file = new File(""/path/to/directory/"" + fileName); try { if (file.exists()) { System.out.println(""File exists.""); } else { System.out.println(""File does not exist.""); } } catch (Exception e) { System.out.println(""Error accessing file.""); } } else { System.out.println(""Invalid file name.""); } } private static boolean isValidFileName(String fileName) { // Validate the file name to prevent path traversal // Here, we use a simple regex pattern to only allow alphanumeric characters, dots, and underscores String pattern = ""^[a-zA-Z0-",java,0
Cross-Site Scripting (XSS),"import java.io.IOException;
import javax.servlet.ServletException;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

public class XssVulnerableServlet extends HttpServlet {
    
    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        String userInput = request.getParameter(""input"");
        String output = ""<div>"" + userInput + ""</div>"";
        
        response.getWriter().println(output);
    }
}","import java.io.IOException; import javax.servlet.ServletException; import javax.servlet.http.HttpServlet; import javax.servlet.http.HttpServletRequest; import javax.servlet.http.HttpServletResponse; public class XssVulnerableServlet extends HttpServlet { protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { String userInput = request.getParameter(""input""); String output = ""<div>"" + userInput + ""</div>""; response.getWriter().println(output); } }",java,1
Clear,"import mysql.connector
def safe_product_search(category):
    db = mysql.connector.connect(host=""localhost"", user=""user"", password=""pass"", database=""shop"")
    cursor = db.cursor()
    cursor.execute(""SELECT * FROM products WHERE category = %s"", (category,))
    return cursor.fetchall()","import mysql.connector
def safe_product_search(category):
    db = mysql.connector.connect(host=""localhost"", user=""user"", password=""pass"", database=""shop"")
    cursor = db.cursor()
    cursor.execute(""SELECT * FROM products WHERE category = %s"", (category,))
    return cursor.fetchall()",python,0
SQL Injection,"<?php
$username = $_POST['username'];
$query = ""SELECT * FROM users WHERE username = '$username'"";
$result = mysql_query($query); // SQL Injection
?>","<?php
$username = $_POST['username'];
$query = ""SELECT * FROM users WHERE username = '$username'"";
$result = mysql_query($query); // SQL Injection
?>",php,1
Path Traversal,"def get_user_file(username, filepath):
    import os
    base_path = f""/home/{username}/files/""
    full_path = base_path + filepath
    with open(full_path, 'r') as f:
        return f.read()","def get_user_file(username, filepath):
    import os
    base_path = f""/home/{username}/files/""
    full_path = base_path + filepath
    with open(full_path, 'r') as f:
        return f.read()",python,1
Clear,"#include <iostream>
#include <fstream>
#include <string>

void safe_file_reading(const std::string& filename) {
    std::ifstream file(filename);
    if (file.is_open()) {
        std::string line;
        while (std::getline(file, line)) {
            std::cout << line << std::endl;
        }
    }
}","#include <iostream>
#include <fstream>
#include <string>

void safe_file_reading(const std::string& filename) {
    std::ifstream file(filename);
    if (file.is_open()) {
        std::string line;
        while (std::getline(file, line)) {
            std::cout << line << std::endl;
        }
    }
}",cpp,0
Clear,"const userData = JSON.parse(userInput); // Safe JSON parsing
if (userData && typeof userData === 'object') {
    processUserData(userData);
}
","const userData = JSON.parse(userInput); // Safe JSON parsing
if (userData && typeof userData === 'object') {
    processUserData(userData);
}
",javascript,0
Clear,"<?php
$cmd = escapeshellarg($_GET['cmd']);
system(""ls "" . $cmd); // Escaped command
?>","<?php
$cmd = escapeshellarg($_GET['cmd']);
system(""ls "" . $cmd); // Escaped command
?>",php,0
Command Injection,"import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class CommandInjectionExample {

    public static void main(String[] args) {
        try {
            BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));
            System.out.print(""Enter a hostname to ping: "");
            String hostname = reader.readLine();

            // Vulnerability: User input is directly concatenated into the command string
            String command = ""ping "" + hostname;

            Process process = Runtime.getRuntime().exec(command);
            BufferedReader processOutputReader = new BufferedReader(new InputStreamReader(process.getInputStream()));

            String outputLine;
            while ((outputLine = processOutputReader.readLine()) != null) {
                System.out.println(outputLine);
            }

        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}","import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class CommandInjectionExample { public static void main(String[] args) { try { BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a hostname to ping: ""); String hostname = reader.readLine(); // Vulnerability: User input is directly concatenated into the command string String command = ""ping "" + hostname; Process process = Runtime.getRuntime().exec(command); BufferedReader processOutputReader = new BufferedReader(new InputStreamReader(process.getInputStream())); String outputLine; while ((outputLine = processOutputReader.readLine()) != null) { System.out.println(outputLine); } } catch (IOException e) { e.printStackTrace(); } } }",java,1
Clear,"#include <iostream>
#include <memory>

void safe_memory_management() {
    auto ptr = std::make_unique<int>(42);
    std::cout << *ptr << std::endl;
}","#include <iostream>
#include <memory>

void safe_memory_management() {
    auto ptr = std::make_unique<int>(42);
    std::cout << *ptr << std::endl;
}",cpp,0
Insecure Deserialization,"import pickle
def load_user_data(filename):
    with open(filename, 'rb') as f:
        data = pickle.load(f)
    return data","import pickle
def load_user_data(filename):
    with open(filename, 'rb') as f:
        data = pickle.load(f)
    return data",python,1
Clear,"To fix the Command Injection vulnerability in the provided Java code snippet, you should not directly concatenate user input into the command to be executed. Instead, you should validate and sanitize user input to prevent malicious commands from being injected. 

Here is an improved version of the code that mitigates the Command Injection vulnerability by using ProcessBuilder and properly sanitizing user input:

```java
import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class SecureCommandExecution {

    public static void main(String[] args) {
        try {
            BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));
            System.out.print(""Enter a directory name: "");
            String directoryName = reader.readLine();

            // Validate and sanitize user input
            if (!isValidDirectoryName(directoryName)) {
                System.out.println(""Invalid directory name"");
                return;
            }

            // Construct the command using ProcessBuilder
            ProcessBuilder processBuilder = new ProcessBuilder(""ls"", directoryName);
            
            // Start the process
            Process process = processBuilder.start();

            BufferedReader inputStreamReader = new BufferedReader(new InputStreamReader(process.getInputStream()));
            String line;
            while ((line = inputStreamReader.readLine()) != null) {
                System.out.println(line);
            }

        } catch (IOException","To fix the Command Injection vulnerability in the provided Java code snippet, you should not directly concatenate user input into the command to be executed. Instead, you should validate and sanitize user input to prevent malicious commands from being injected. Here is an improved version of the code that mitigates the Command Injection vulnerability by using ProcessBuilder and properly sanitizing user input: ```java import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class SecureCommandExecution { public static void main(String[] args) { try { BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a directory name: ""); String directoryName = reader.readLine(); // Validate and sanitize user input if (!isValidDirectoryName(directoryName)) { System.out.println(""Invalid directory name""); return; } // Construct the command using ProcessBuilder ProcessBuilder processBuilder = new ProcessBuilder(""ls"", directoryName); // Start the process Process process = processBuilder.start(); BufferedReader inputStreamReader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = inputStreamReader.readLine()) != null) { System.out.println(line); } } catch (IOException",java,0
Clear,"import os
def safe_read_file(filename):
    base_path = '/var/www/uploads/'
    full_path = os.path.join(base_path, filename)
    full_path = os.path.normpath(full_path)
    if not full_path.startswith(base_path):
        raise ValueError(""Path traversal detected"")
    with open(full_path, 'r') as f:
        return f.read()","import os
def safe_read_file(filename):
    base_path = '/var/www/uploads/'
    full_path = os.path.join(base_path, filename)
    full_path = os.path.normpath(full_path)
    if not full_path.startswith(base_path):
        raise ValueError(""Path traversal detected"")
    with open(full_path, 'r') as f:
        return f.read()",python,0
Clear,"<?php
$message = htmlspecialchars($_GET['message'], ENT_QUOTES, 'UTF-8');
echo $message; // Sanitized output
?>","<?php
$message = htmlspecialchars($_GET['message'], ENT_QUOTES, 'UTF-8');
echo $message; // Sanitized output
?>",php,0
Clear,"To fix the vulnerability in the given code and prevent Command Injection attacks, you should not directly execute user input as a command. Instead, you should validate and sanitize the user input before executing any command. Here's an example of how you can improve the code to mitigate Command Injection:

```java
import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class SecureCommandExecution {

    public static void main(String[] args) {
        try {
            BufferedReader br = new BufferedReader(new InputStreamReader(System.in));
            System.out.print(""Enter a command to execute: "");
            String userInput = br.readLine();

            // Sanitize user input to only allow alphanumeric characters and specific safe symbols
            if (isValidInput(userInput)) {
                Process process = Runtime.getRuntime().exec(userInput);

                BufferedReader reader = new BufferedReader(new InputStreamReader(process.getInputStream()));
                String line;
                while ((line = reader.readLine()) != null) {
                    System.out.println(line);
                }
            } else {
                System.out.println(""Invalid input. Please provide a safe command."");
            }
        } catch (IOException e) {
            e.printStackTrace();
        }
    }

    private static boolean isValidInput(String userInput) {
        // Add validation logic here based on your requirements","To fix the vulnerability in the given code and prevent Command Injection attacks, you should not directly execute user input as a command. Instead, you should validate and sanitize the user input before executing any command. Here's an example of how you can improve the code to mitigate Command Injection: ```java import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class SecureCommandExecution { public static void main(String[] args) { try { BufferedReader br = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a command to execute: ""); String userInput = br.readLine(); // Sanitize user input to only allow alphanumeric characters and specific safe symbols if (isValidInput(userInput)) { Process process = Runtime.getRuntime().exec(userInput); BufferedReader reader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = reader.readLine()) != null) { System.out.println(line); } } else { System.out.println(""Invalid input. Please provide a safe command.""); } } catch (IOException e) { e.printStackTrace(); } } private static boolean isValidInput(String userInput) { // Add validation logic here based on your requirements",java,0
Clear,"To secure the code against Path Traversal attacks, you should validate the user input to ensure that the file path does not allow directory traversal outside of the intended directory. Here's an updated version of the code with proper security measures implemented:

```java
import java.io.File;
import java.io.FileInputStream;
import java.io.IOException;
import java.util.Scanner;

public class SecurePathTraversalExample {

    private static final String BASE_PATH = ""/path/to/files/"";

    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        System.out.print(""Enter file name: "");
        String fileName = scanner.next();

        if (isValidFileName(fileName)) {
            File file = new File(BASE_PATH + fileName);

            try {
                FileInputStream fis = new FileInputStream(file);
                int data;
                while ((data = fis.read()) != -1) {
                    System.out.print((char) data);
                }
                fis.close();
            } catch (IOException e) {
                System.out.println(""Error reading file: "" + e.getMessage());
            }
        } else {
            System.out.println(""Invalid file name"");
        }
    }

    private static boolean isValidFileName(String fileName) {
        // Add validation logic here to prevent directory traversal","To secure the code against Path Traversal attacks, you should validate the user input to ensure that the file path does not allow directory traversal outside of the intended directory. Here's an updated version of the code with proper security measures implemented: ```java import java.io.File; import java.io.FileInputStream; import java.io.IOException; import java.util.Scanner; public class SecurePathTraversalExample { private static final String BASE_PATH = ""/path/to/files/""; public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter file name: ""); String fileName = scanner.next(); if (isValidFileName(fileName)) { File file = new File(BASE_PATH + fileName); try { FileInputStream fis = new FileInputStream(file); int data; while ((data = fis.read()) != -1) { System.out.print((char) data); } fis.close(); } catch (IOException e) { System.out.println(""Error reading file: "" + e.getMessage()); } } else { System.out.println(""Invalid file name""); } } private static boolean isValidFileName(String fileName) { // Add validation logic here to prevent directory traversal",java,0
Clear,"import os
def secure_file_access(username, filepath):
    base_dir = f""/home/{username}/files/""
    full_path = os.path.join(base_dir, filepath)
    full_path = os.path.normpath(full_path)
    if not full_path.startswith(base_dir):
        raise PermissionError(""Access denied"")
    with open(full_path, 'r') as f:
        return f.read()","import os
def secure_file_access(username, filepath):
    base_dir = f""/home/{username}/files/""
    full_path = os.path.join(base_dir, filepath)
    full_path = os.path.normpath(full_path)
    if not full_path.startswith(base_dir):
        raise PermissionError(""Access denied"")
    with open(full_path, 'r') as f:
        return f.read()",python,0
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Hardcoded Secrets,"localStorage.setItem('token', 'hardcoded-secret-token-123'); // Hardcoded secret
","localStorage.setItem('token', 'hardcoded-secret-token-123'); // Hardcoded secret
",javascript,1
Insecure Deserialization,"import yaml
def load_config(config_str):
    return yaml.load(config_str, Loader=yaml.Loader)","import yaml
def load_config(config_str):
    return yaml.load(config_str, Loader=yaml.Loader)",python,1
Clear,"const token = process.env.API_TOKEN; // Environment variable
fetch('/api/data', {
    headers: { 'Authorization': `Bearer ${token}` }
});
","const token = process.env.API_TOKEN; // Environment variable
fetch('/api/data', {
    headers: { 'Authorization': `Bearer ${token}` }
});
",javascript,0
Cross-Site Scripting (XSS),"import java.io.IOException;
import java.io.PrintWriter;
import javax.servlet.ServletException;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

public class VulnerableServlet extends HttpServlet {
    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        String userInput = request.getParameter(""input"");
        PrintWriter out = response.getWriter();
        
        out.println(""<html>"");
        out.println(""<body>"");
        out.println(""<h1>User Input: "" + userInput + ""</h1>"");
        out.println(""</body>"");
        out.println(""</html>"");
    }
}","import java.io.IOException; import java.io.PrintWriter; import javax.servlet.ServletException; import javax.servlet.http.HttpServlet; import javax.servlet.http.HttpServletRequest; import javax.servlet.http.HttpServletResponse; public class VulnerableServlet extends HttpServlet { protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { String userInput = request.getParameter(""input""); PrintWriter out = response.getWriter(); out.println(""<html>""); out.println(""<body>""); out.println(""<h1>User Input: "" + userInput + ""</h1>""); out.println(""</body>""); out.println(""</html>""); } }",java,1
XSS,"const userInput = document.location.search.split('=')[1];
document.write(userInput); // XSS
","const userInput = document.location.search.split('=')[1];
document.write(userInput); // XSS
",javascript,1
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Hardcoded Secrets,"localStorage.setItem('token', 'hardcoded-secret-token-123'); // Hardcoded secret
","localStorage.setItem('token', 'hardcoded-secret-token-123'); // Hardcoded secret
",javascript,1
Memory Corruption,"#include <iostream>

void unsafe_pointer_arithmetic(int* array, int size) {
    for (int i = 0; i <= size; i++) {
        std::cout << *(array + i) << std::endl; // potential out-of-bounds
    }
}","#include <iostream>

void unsafe_pointer_arithmetic(int* array, int size) {
    for (int i = 0; i <= size; i++) {
        std::cout << *(array + i) << std::endl; // potential out-of-bounds
    }
}",cpp,1
Buffer Overflow,"#include <iostream>
#include <cstring>

void unsafe_c_string(char* input) {
    char buffer[100];
    strcpy(buffer, input); // potential buffer overflow
    std::cout << buffer << std::endl;
}","#include <iostream>
#include <cstring>

void unsafe_c_string(char* input) {
    char buffer[100];
    strcpy(buffer, input); // potential buffer overflow
    std::cout << buffer << std::endl;
}",cpp,1
Clear,"import java.util.Scanner;

public class SecureBufferExample {
    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);

        System.out.print(""Enter a string: "");
        String userInput = scanner.nextLine();

        // Limit the input size to prevent buffer overflow
        if (userInput.length() > 10) {
            System.out.println(""Input string exceeds buffer size limit."");
            return;
        }

        char[] buffer = new char[10];
        userInput.getChars(0, userInput.length(), buffer, 0);

        System.out.println(""Buffer content: "" + new String(buffer));

        scanner.close();
    }
}","import java.util.Scanner; public class SecureBufferExample { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter a string: ""); String userInput = scanner.nextLine(); // Limit the input size to prevent buffer overflow if (userInput.length() > 10) { System.out.println(""Input string exceeds buffer size limit.""); return; } char[] buffer = new char[10]; userInput.getChars(0, userInput.length(), buffer, 0); System.out.println(""Buffer content: "" + new String(buffer)); scanner.close(); } }",java,0
Command Injection,"import os
def ping_host(host):
    os.system(""ping -c 4 "" + host)","import os
def ping_host(host):
    os.system(""ping -c 4 "" + host)",python,1
Clear,"import java.io.*;
import javax.servlet.*;
import javax.servlet.http.*;
import org.owasp.esapi.ESAPI;
import org.owasp.esapi.Encoder;

public class XSSFixedServlet extends HttpServlet {
    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        response.setContentType(""text/html"");

        String userInput = request.getParameter(""input"");

        PrintWriter out = response.getWriter();
        out.println(""<html><body>"");
        out.println(""<h1>User Input:</h1>"");
        
        Encoder encoder = ESAPI.encoder();
        out.println(encoder.encodeForHTML(userInput)); // Encode user input before outputting
        
        out.println(""</body></html>"");
    }
}","import java.io.*; import javax.servlet.*; import javax.servlet.http.*; import org.owasp.esapi.ESAPI; import org.owasp.esapi.Encoder; public class XSSFixedServlet extends HttpServlet { protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { response.setContentType(""text/html""); String userInput = request.getParameter(""input""); PrintWriter out = response.getWriter(); out.println(""<html><body>""); out.println(""<h1>User Input:</h1>""); Encoder encoder = ESAPI.encoder(); out.println(encoder.encodeForHTML(userInput)); // Encode user input before outputting out.println(""</body></html>""); } }",java,0
SQL Injection,"import java.sql.*;

public class SQLInjectionExample {

    public static void main(String[] args) {
        try {
            String userInput = ""'; DROP TABLE users; --""; // Simulated user input
            String query = ""SELECT * FROM users WHERE username = '"" + userInput + ""'"";

            Connection connection = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");
            Statement statement = connection.createStatement();
            ResultSet resultSet = statement.executeQuery(query);

            while (resultSet.next()) {
                System.out.println(resultSet.getString(""username""));
            }

        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.*; public class SQLInjectionExample { public static void main(String[] args) { try { String userInput = ""'; DROP TABLE users; --""; // Simulated user input String query = ""SELECT * FROM users WHERE username = '"" + userInput + ""'""; Connection connection = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); Statement statement = connection.createStatement(); ResultSet resultSet = statement.executeQuery(query); while (resultSet.next()) { System.out.println(resultSet.getString(""username"")); } } catch (SQLException e) { e.printStackTrace(); } } }",java,1
Memory Corruption,"#include <iostream>

void unsafe_virtual_call() {
    // Potential vtable corruption vulnerability
    class Base {
    public:
        virtual void func() { std::cout << ""Base"" << std::endl; }
    };
    
    class Derived : public Base {
    public:
        void func() override { std::cout << ""Derived"" << std::endl; }
    };
}","#include <iostream>

void unsafe_virtual_call() {
    // Potential vtable corruption vulnerability
    class Base {
    public:
        virtual void func() { std::cout << ""Base"" << std::endl; }
    };
    
    class Derived : public Base {
    public:
        void func() override { std::cout << ""Derived"" << std::endl; }
    };
}",cpp,1
Clear,"import java.io.*;

public class XSSFixedCode {
    
    // Function to escape special characters in user input
    public static String escapeHtml(String input) {
        return input
            .replace(""&"", ""&amp;"")
            .replace(""<"", ""&lt;"")
            .replace("">"", ""&gt;"")
            .replace(""\"""", ""&quot;"")
            .replace(""'"", ""&#39;"");
    }

    public static void main(String[] args) {
        // Simulating user input
        String userInput = ""<script>alert('XSS Vulnerability')</script>"";

        // Properly handling user input by escaping special characters before outputting it to the webpage
        String sanitizedInput = escapeHtml(userInput);
        
        System.out.println(""Welcome, "" + sanitizedInput);
    }
}","import java.io.*; public class XSSFixedCode { // Function to escape special characters in user input public static String escapeHtml(String input) { return input .replace(""&"", ""&amp;"") .replace(""<"", ""&lt;"") .replace("">"", ""&gt;"") .replace(""\"""", ""&quot;"") .replace(""'"", ""&#39;""); } public static void main(String[] args) { // Simulating user input String userInput = ""<script>alert('XSS Vulnerability')</script>""; // Properly handling user input by escaping special characters before outputting it to the webpage String sanitizedInput = escapeHtml(userInput); System.out.println(""Welcome, "" + sanitizedInput); } }",java,0
Buffer Overflow,"#include <iostream>
#include <cstring>

void unsafe_c_string(char* input) {
    char buffer[100];
    strcpy(buffer, input); // potential buffer overflow
    std::cout << buffer << std::endl;
}","#include <iostream>
#include <cstring>

void unsafe_c_string(char* input) {
    char buffer[100];
    strcpy(buffer, input); // potential buffer overflow
    std::cout << buffer << std::endl;
}",cpp,1
Clear,"<?php
$input = json_decode($_POST['data'], true); // Safe JSON parsing
if (json_last_error() === JSON_ERROR_NONE) {
    process_data($input);
}
?>","<?php
$input = json_decode($_POST['data'], true); // Safe JSON parsing
if (json_last_error() === JSON_ERROR_NONE) {
    process_data($input);
}
?>",php,0
Cross-Site Scripting (XSS),"import java.io.IOException;
import java.io.PrintWriter;

public class XSSVulnerableCode {

    public static void main(String[] args) {
        // Simulating user input from a form field
        String userInput = ""<script>alert('XSS Vulnerability!')</script>"";

        // Improperly handling user input by directly outputting it to the response
        try {
            PrintWriter out = new PrintWriter(""output.html"");
            out.println(""<html>"");
            out.println(""<body>"");
            out.println(""<h1>Welcome "" + userInput + ""</h1>"");
            out.println(""</body>"");
            out.println(""</html>"");
            out.close();
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}","import java.io.IOException; import java.io.PrintWriter; public class XSSVulnerableCode { public static void main(String[] args) { // Simulating user input from a form field String userInput = ""<script>alert('XSS Vulnerability!')</script>""; // Improperly handling user input by directly outputting it to the response try { PrintWriter out = new PrintWriter(""output.html""); out.println(""<html>""); out.println(""<body>""); out.println(""<h1>Welcome "" + userInput + ""</h1>""); out.println(""</body>""); out.println(""</html>""); out.close(); } catch (IOException e) { e.printStackTrace(); } } }",java,1
Clear,"#include <stdio.h>
#include <string.h>

int validate_input(const char *input) {
    if (input == NULL) return 0;
    for (int i = 0; input[i] != '\0'; i++) {
        if (input[i] < 32 || input[i] > 126) {
            return 0; // invalid character
        }
    }
    return 1;
}","#include <stdio.h>
#include <string.h>

int validate_input(const char *input) {
    if (input == NULL) return 0;
    for (int i = 0; input[i] != '\0'; i++) {
        if (input[i] < 32 || input[i] > 126) {
            return 0; // invalid character
        }
    }
    return 1;
}",c,0
Clear,"To fix the Command Injection vulnerability in the provided Java code snippet, you need to sanitize and validate user input before executing it as a command. Here is an updated version of the code with proper security measures:

```java
import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class SecureCommandExecution {

    public static void main(String[] args) {
        try {
            BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));
            System.out.print(""Enter a command to execute: "");
            String userInput = reader.readLine();

            // Validate user input to prevent command injection
            if (isValidInput(userInput)) {
                // Execute the sanitized command
                Process process = Runtime.getRuntime().exec(""ping "" + userInput);

                BufferedReader inputStream = new BufferedReader(new InputStreamReader(process.getInputStream()));
                String line;
                while ((line = inputStream.readLine()) != null) {
                    System.out.println(line);
                }
            } else {
                System.out.println(""Invalid input. Please try again."");
            }
        } catch (IOException e) {
            e.printStackTrace();
        }
    }

    private static boolean isValidInput(String userInput) {
        // Implement your validation logic here based on allowed characters or patterns
        // For example, you can restrict to","To fix the Command Injection vulnerability in the provided Java code snippet, you need to sanitize and validate user input before executing it as a command. Here is an updated version of the code with proper security measures: ```java import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class SecureCommandExecution { public static void main(String[] args) { try { BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a command to execute: ""); String userInput = reader.readLine(); // Validate user input to prevent command injection if (isValidInput(userInput)) { // Execute the sanitized command Process process = Runtime.getRuntime().exec(""ping "" + userInput); BufferedReader inputStream = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = inputStream.readLine()) != null) { System.out.println(line); } } else { System.out.println(""Invalid input. Please try again.""); } } catch (IOException e) { e.printStackTrace(); } } private static boolean isValidInput(String userInput) { // Implement your validation logic here based on allowed characters or patterns // For example, you can restrict to",java,0
File Inclusion,"<?php
$file = $_GET['file'];
include($file); // File Inclusion
?>","<?php
$file = $_GET['file'];
include($file); // File Inclusion
?>",php,1
Clear,"import java.util.Scanner;
import org.owasp.encoder.Encode;

public class XSSFixedCode {
    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        
        System.out.print(""Enter your name: "");
        String userInput = scanner.nextLine();
        
        // Sanitize and escape user input to prevent XSS
        String sanitizedInput = Encode.forHtml(userInput);
        
        System.out.println(""Hello, "" + sanitizedInput + ""!"");
        
        scanner.close();
    }
}","import java.util.Scanner; import org.owasp.encoder.Encode; public class XSSFixedCode { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter your name: ""); String userInput = scanner.nextLine(); // Sanitize and escape user input to prevent XSS String sanitizedInput = Encode.forHtml(userInput); System.out.println(""Hello, "" + sanitizedInput + ""!""); scanner.close(); } }",java,0
Clear,"#include <stdio.h>
#include <string.h>

void safe_string_copy(char *dest, const char *src, size_t dest_size) {
    if (dest_size > 0) {
        strncpy(dest, src, dest_size - 1);
        dest[dest_size - 1] = '\0';
    }
}","#include <stdio.h>
#include <string.h>

void safe_string_copy(char *dest, const char *src, size_t dest_size) {
    if (dest_size > 0) {
        strncpy(dest, src, dest_size - 1);
        dest[dest_size - 1] = '\0';
    }
}",c,0
Out-of-Bounds,"#include <iostream>

class UnsafeClass {
    int data[10];
public:
    int get_data(int index) {
        return data[index]; // no bounds checking
    }
};","#include <iostream>

class UnsafeClass {
    int data[10];
public:
    int get_data(int index) {
        return data[index]; // no bounds checking
    }
};",cpp,1
Cross-Site Scripting (XSS),"import java.io.*;
import javax.servlet.*;
import javax.servlet.http.*;

public class VulnerableServlet extends HttpServlet {
    
    protected void doGet(HttpServletRequest request, HttpServletResponse response)
            throws ServletException, IOException {
        
        String userInput = request.getParameter(""input"");
        
        // Improperly handling user input by directly outputting it to the response
        PrintWriter out = response.getWriter();
        out.println(""<html>"");
        out.println(""<body>"");
        out.println(""<h1>Hello "" + userInput + ""</h1>"");
        out.println(""</body>"");
        out.println(""</html>"");
    }
}","import java.io.*; import javax.servlet.*; import javax.servlet.http.*; public class VulnerableServlet extends HttpServlet { protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { String userInput = request.getParameter(""input""); // Improperly handling user input by directly outputting it to the response PrintWriter out = response.getWriter(); out.println(""<html>""); out.println(""<body>""); out.println(""<h1>Hello "" + userInput + ""</h1>""); out.println(""</body>""); out.println(""</html>""); } }",java,1
Insecure Deserialization,"import pickle
def load_user_data(filename):
    with open(filename, 'rb') as f:
        data = pickle.load(f)
    return data","import pickle
def load_user_data(filename):
    with open(filename, 'rb') as f:
        data = pickle.load(f)
    return data",python,1
Cross-Site Scripting (XSS),"import java.io.*;

public class XSSVulnerableCode {

    public static void main(String[] args) throws IOException {
        
        BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));
        
        System.out.print(""Enter your name: "");
        String name = reader.readLine();
        
        System.out.println(""Hello, "" + name + ""! Welcome to our website."");
    }
}","import java.io.*; public class XSSVulnerableCode { public static void main(String[] args) throws IOException { BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter your name: ""); String name = reader.readLine(); System.out.println(""Hello, "" + name + ""! Welcome to our website.""); } }",java,1
Clear,"import java.io.IOException;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

public class XSSFixedServlet extends HttpServlet {

    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws IOException {
        String userInput = request.getParameter(""input"");
        String escapedInput = escapeHtml(userInput);
        String output = ""<p>"" + escapedInput + ""</p>"";

        response.setContentType(""text/html"");
        response.getWriter().write(output);
    }

    private String escapeHtml(String input) {
        if (input == null) {
            return """";
        }
        return input
                .replace(""&"", ""&amp;"")
                .replace(""<"", ""&lt;"")
                .replace("">"", ""&gt;"")
                .replace(""\"""", ""&quot;"")
                .replace(""'"", ""&#39;"");
    }
}","import java.io.IOException; import javax.servlet.http.HttpServlet; import javax.servlet.http.HttpServletRequest; import javax.servlet.http.HttpServletResponse; public class XSSFixedServlet extends HttpServlet { protected void doGet(HttpServletRequest request, HttpServletResponse response) throws IOException { String userInput = request.getParameter(""input""); String escapedInput = escapeHtml(userInput); String output = ""<p>"" + escapedInput + ""</p>""; response.setContentType(""text/html""); response.getWriter().write(output); } private String escapeHtml(String input) { if (input == null) { return """"; } return input .replace(""&"", ""&amp;"") .replace(""<"", ""&lt;"") .replace("">"", ""&gt;"") .replace(""\"""", ""&quot;"") .replace(""'"", ""&#39;""); } }",java,0
Path Traversal,"import java.io.File;
import java.io.FileInputStream;
import java.io.IOException;
import java.util.Scanner;

public class PathTraversalVulnerability {

    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        System.out.println(""Enter file name:"");
        String fileName = scanner.nextLine();

        try {
            File file = new File(""C:/data/"" + fileName);
            FileInputStream fis = new FileInputStream(file);

            int data;
            while ((data = fis.read()) != -1) {
                System.out.print((char) data);
            }

            fis.close();
        } catch (IOException e) {
            System.out.println(""Error reading file: "" + e.getMessage());
        }
    }
}","import java.io.File; import java.io.FileInputStream; import java.io.IOException; import java.util.Scanner; public class PathTraversalVulnerability { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.println(""Enter file name:""); String fileName = scanner.nextLine(); try { File file = new File(""C:/data/"" + fileName); FileInputStream fis = new FileInputStream(file); int data; while ((data = fis.read()) != -1) { System.out.print((char) data); } fis.close(); } catch (IOException e) { System.out.println(""Error reading file: "" + e.getMessage()); } } }",java,1
SQL Injection,"app.get('/user/:id', (req, res) => {
    const query = `SELECT * FROM users WHERE id = ${req.params.id}`; // SQL Injection
    db.query(query, (err, result) => {
        res.json(result);
    });
});
","app.get('/user/:id', (req, res) => {
    const query = `SELECT * FROM users WHERE id = ${req.params.id}`; // SQL Injection
    db.query(query, (err, result) => {
        res.json(result);
    });
});
",javascript,1
Command Injection,"import subprocess
def list_directory(path):
    result = subprocess.run(f""ls {path}"", shell=True, capture_output=True, text=True)
    return result.stdout","import subprocess
def list_directory(path):
    result = subprocess.run(f""ls {path}"", shell=True, capture_output=True, text=True)
    return result.stdout",python,1
SQL Injection,"import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Statement;

public class VulnerableCode {

    public static void main(String[] args) {
        String userInput = ""'; DROP TABLE users; --""; // User input containing malicious SQL injection payload

        try {
            Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");
            Statement stmt = conn.createStatement();

            // Vulnerable code: Concatenating user input directly into the SQL query
            String query = ""SELECT * FROM users WHERE username = '"" + userInput + ""'"";
            
            ResultSet rs = stmt.executeQuery(query);
            
            while (rs.next()) {
                System.out.println(""User found: "" + rs.getString(""username""));
            }

        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.Connection; import java.sql.DriverManager; import java.sql.ResultSet; import java.sql.SQLException; import java.sql.Statement; public class VulnerableCode { public static void main(String[] args) { String userInput = ""'; DROP TABLE users; --""; // User input containing malicious SQL injection payload try { Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); Statement stmt = conn.createStatement(); // Vulnerable code: Concatenating user input directly into the SQL query String query = ""SELECT * FROM users WHERE username = '"" + userInput + ""'""; ResultSet rs = stmt.executeQuery(query); while (rs.next()) { System.out.println(""User found: "" + rs.getString(""username"")); } } catch (SQLException e) { e.printStackTrace(); } } }",java,1
Memory Corruption,"#include <iostream>

void unsafe_pointer_arithmetic(int* array, int size) {
    for (int i = 0; i <= size; i++) {
        std::cout << *(array + i) << std::endl; // potential out-of-bounds
    }
}","#include <iostream>

void unsafe_pointer_arithmetic(int* array, int size) {
    for (int i = 0; i <= size; i++) {
        std::cout << *(array + i) << std::endl; // potential out-of-bounds
    }
}",cpp,1
Clear,"const shell = require('child_process');
const safeInput = userInput.replace(/[^a-zA-Z0-9.]/g, '');
shell.execFile('ping', [safeInput]); // Safe command execution
","const shell = require('child_process');
const safeInput = userInput.replace(/[^a-zA-Z0-9.]/g, '');
shell.execFile('ping', [safeInput]); // Safe command execution
",javascript,0
Clear,"To fix the insecure deserialization vulnerability in the provided Java code snippet, you need to implement proper security measures to prevent potential attacks like remote code execution. Here are some steps to make the code more secure:

1. Use a whitelist approach: Implement a whitelist of allowed classes that can be deserialized to prevent attackers from injecting malicious classes into the deserialization process. You can create a custom SecurityManager and override the checkPermission method to restrict the classes that can be deserialized.

2. Validate input: Validate the serialized data before deserializing it to ensure it comes from a trusted and authenticated source. You can use digital signatures or checksums to verify the integrity of the serialized data.

3. Avoid using ObjectInputStream: Instead of directly using ObjectInputStream for deserialization, consider using safer alternatives like JSON or XML serialization libraries (e.g., Jackson, Gson, JAXB) that provide better control over the deserialization process and allow you to define custom mappings.

4. Sanitize input: If you must use ObjectInputStream for deserialization, sanitize user input by validating and filtering out any unexpected or malicious data before passing it to ObjectInputStream.

5. Enable class validation: Enable class validation by setting a SecurityManager and configuring it to perform strict classloading checks","To fix the insecure deserialization vulnerability in the provided Java code snippet, you need to implement proper security measures to prevent potential attacks like remote code execution. Here are some steps to make the code more secure: 1. Use a whitelist approach: Implement a whitelist of allowed classes that can be deserialized to prevent attackers from injecting malicious classes into the deserialization process. You can create a custom SecurityManager and override the checkPermission method to restrict the classes that can be deserialized. 2. Validate input: Validate the serialized data before deserializing it to ensure it comes from a trusted and authenticated source. You can use digital signatures or checksums to verify the integrity of the serialized data. 3. Avoid using ObjectInputStream: Instead of directly using ObjectInputStream for deserialization, consider using safer alternatives like JSON or XML serialization libraries (e.g., Jackson, Gson, JAXB) that provide better control over the deserialization process and allow you to define custom mappings. 4. Sanitize input: If you must use ObjectInputStream for deserialization, sanitize user input by validating and filtering out any unexpected or malicious data before passing it to ObjectInputStream. 5. Enable class validation: Enable class validation by setting a SecurityManager and configuring it to perform strict classloading checks",php,0
Buffer Overflow,"#include <iostream>
#include <cstring>

void unsafe_c_string(char* input) {
    char buffer[100];
    strcpy(buffer, input); // potential buffer overflow
    std::cout << buffer << std::endl;
}","#include <iostream>
#include <cstring>

void unsafe_c_string(char* input) {
    char buffer[100];
    strcpy(buffer, input); // potential buffer overflow
    std::cout << buffer << std::endl;
}",cpp,1
Command Injection,"import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class CommandInjectionExample {

    public static void main(String[] args) {
        try {
            BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));
            System.out.print(""Enter a command to execute: "");
            String userInput = reader.readLine();

            // WARNING: Improper handling of user input can lead to command injection vulnerability
            Process process = Runtime.getRuntime().exec(""ping "" + userInput);

            BufferedReader inputReader = new BufferedReader(new InputStreamReader(process.getInputStream()));
            String line;
            while ((line = inputReader.readLine()) != null) {
                System.out.println(line);
            }
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}","import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class CommandInjectionExample { public static void main(String[] args) { try { BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a command to execute: ""); String userInput = reader.readLine(); // WARNING: Improper handling of user input can lead to command injection vulnerability Process process = Runtime.getRuntime().exec(""ping "" + userInput); BufferedReader inputReader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = inputReader.readLine()) != null) { System.out.println(line); } } catch (IOException e) { e.printStackTrace(); } } }",java,1
Path Traversal,"import java.io.File;
import java.io.FileInputStream;
import java.io.IOException;
import java.util.Scanner;

public class PathTraversalVulnerability {
    
    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        
        System.out.println(""Enter file name to read:"");
        String fileName = scanner.next();
        
        try {
            File file = new File(fileName);
            FileInputStream fis = new FileInputStream(file);
            int content;
            
            while ((content = fis.read()) != -1) {
                System.out.print((char) content);
            }
            
            fis.close();
        } catch (IOException e) {
            System.out.println(""File not found or cannot be read."");
        }
        
        scanner.close();
    }
}","import java.io.File; import java.io.FileInputStream; import java.io.IOException; import java.util.Scanner; public class PathTraversalVulnerability { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.println(""Enter file name to read:""); String fileName = scanner.next(); try { File file = new File(fileName); FileInputStream fis = new FileInputStream(file); int content; while ((content = fis.read()) != -1) { System.out.print((char) content); } fis.close(); } catch (IOException e) { System.out.println(""File not found or cannot be read.""); } scanner.close(); } }",java,1
SQL Injection,"import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;

public class SQLInjectionExample {

    public static void main(String[] args) {
        String userInput = ""'; DROP TABLE users; --"";

        try {
            Connection connection = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");
            
            String query = ""SELECT * FROM users WHERE username = '"" + userInput + ""'"";
            PreparedStatement statement = connection.prepareStatement(query);

            ResultSet resultSet = statement.executeQuery();

            while (resultSet.next()) {
                System.out.println(""User: "" + resultSet.getString(""username""));
            }

        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.Connection; import java.sql.DriverManager; import java.sql.PreparedStatement; import java.sql.ResultSet; import java.sql.SQLException; public class SQLInjectionExample { public static void main(String[] args) { String userInput = ""'; DROP TABLE users; --""; try { Connection connection = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); String query = ""SELECT * FROM users WHERE username = '"" + userInput + ""'""; PreparedStatement statement = connection.prepareStatement(query); ResultSet resultSet = statement.executeQuery(); while (resultSet.next()) { System.out.println(""User: "" + resultSet.getString(""username"")); } } catch (SQLException e) { e.printStackTrace(); } } }",java,1
Clear,"#include <iostream>
#include <memory>

void safe_memory_management() {
    auto ptr = std::make_unique<int>(42);
    std::cout << *ptr << std::endl;
}","#include <iostream>
#include <memory>

void safe_memory_management() {
    auto ptr = std::make_unique<int>(42);
    std::cout << *ptr << std::endl;
}",cpp,0
Clear,"import os
def get_api_key():
    return os.environ.get('API_KEY')","import os
def get_api_key():
    return os.environ.get('API_KEY')",python,0
Clear,"<?php
$message = htmlspecialchars($_GET['message'], ENT_QUOTES, 'UTF-8');
echo $message; // Sanitized output
?>","<?php
$message = htmlspecialchars($_GET['message'], ENT_QUOTES, 'UTF-8');
echo $message; // Sanitized output
?>",php,0
Clear,"import java.io.*;
import javax.servlet.*;
import javax.servlet.http.*;

public class SecureServlet extends HttpServlet {
    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        String userInput = request.getParameter(""input"");
        PrintWriter out = response.getWriter();
        out.println(""<html>"");
        out.println(""<body>"");
        out.println(""<h1>Welcome, "" + escapeHtml(userInput) + ""!</h1>"");
        out.println(""</body>"");
        out.println(""</html>"");
    }

    private String escapeHtml(String input) {
        if (input == null) {
            return """";
        }
        return input.replace(""&"", ""&amp;"")
                    .replace(""<"", ""&lt;"")
                    .replace("">"", ""&gt;"")
                    .replace(""\"""", ""&quot;"")
                    .replace(""'"", ""&#39;"");
    }
}","import java.io.*; import javax.servlet.*; import javax.servlet.http.*; public class SecureServlet extends HttpServlet { protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { String userInput = request.getParameter(""input""); PrintWriter out = response.getWriter(); out.println(""<html>""); out.println(""<body>""); out.println(""<h1>Welcome, "" + escapeHtml(userInput) + ""!</h1>""); out.println(""</body>""); out.println(""</html>""); } private String escapeHtml(String input) { if (input == null) { return """"; } return input.replace(""&"", ""&amp;"") .replace(""<"", ""&lt;"") .replace("">"", ""&gt;"") .replace(""\"""", ""&quot;"") .replace(""'"", ""&#39;""); } }",java,0
Command Injection,"const shell = require('child_process');
shell.exec('ping ' + userInput); // Command Injection
","const shell = require('child_process');
shell.exec('ping ' + userInput); // Command Injection
",javascript,1
Hardcoded Secrets,"import requests
def call_api():
    api_key = ""sk_live_1234567890abcdef""
    headers = {'Authorization': f'Bearer {api_key}'}
    return requests.get('https://api.example.com/data', headers=headers)","import requests
def call_api():
    api_key = ""sk_live_1234567890abcdef""
    headers = {'Authorization': f'Bearer {api_key}'}
    return requests.get('https://api.example.com/data', headers=headers)",python,1
Clear,"import java.io.*;
import javax.servlet.*;
import javax.servlet.http.*;
import org.owasp.encoder.Encode;

public class SecureServlet extends HttpServlet {
    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        String userInput = request.getParameter(""input"");
        String sanitizedInput = Encode.forHtml(userInput);
        String output = ""Hello, "" + sanitizedInput + ""!"";

        PrintWriter out = response.getWriter();
        out.println(""<html><body>"");
        out.println(""<h1>"" + output + ""</h1>"");
        out.println(""</body></html>"");
    }
}","import java.io.*; import javax.servlet.*; import javax.servlet.http.*; import org.owasp.encoder.Encode; public class SecureServlet extends HttpServlet { protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { String userInput = request.getParameter(""input""); String sanitizedInput = Encode.forHtml(userInput); String output = ""Hello, "" + sanitizedInput + ""!""; PrintWriter out = response.getWriter(); out.println(""<html><body>""); out.println(""<h1>"" + output + ""</h1>""); out.println(""</body></html>""); } }",java,0
Clear,"To fix the insecure deserialization vulnerability in the provided Java code snippet, you need to implement proper security measures to prevent malicious objects from being deserialized. Here are some steps you can take to make the code more secure:

1. Use a whitelist approach: Define a list of allowed classes that can be deserialized and only deserialize objects of those classes. This will prevent malicious objects from being deserialized.

2. Validate input: Before deserializing the object, validate the input to ensure it is not tampered with or modified. You can use techniques like digital signatures or checksums to verify the integrity of the serialized data.

3. Implement input validation checks: Perform input validation checks on the serialized data to ensure it meets expected criteria before attempting deserialization. This can help prevent common attacks like injection or manipulation of serialized data.

4. Use a secure serialization library: Consider using a secure serialization library that provides protection against common deserialization vulnerabilities, such as Apache Commons Collections or Google's GSON library with appropriate settings.

5. Handle exceptions securely: Instead of catching generic exceptions like IOException and ClassNotFoundException, handle specific exceptions related to deserialization vulnerabilities, such as SecurityException or InvalidClassException.

Here is an updated version of your code snippet with these security measures","To fix the insecure deserialization vulnerability in the provided Java code snippet, you need to implement proper security measures to prevent malicious objects from being deserialized. Here are some steps you can take to make the code more secure: 1. Use a whitelist approach: Define a list of allowed classes that can be deserialized and only deserialize objects of those classes. This will prevent malicious objects from being deserialized. 2. Validate input: Before deserializing the object, validate the input to ensure it is not tampered with or modified. You can use techniques like digital signatures or checksums to verify the integrity of the serialized data. 3. Implement input validation checks: Perform input validation checks on the serialized data to ensure it meets expected criteria before attempting deserialization. This can help prevent common attacks like injection or manipulation of serialized data. 4. Use a secure serialization library: Consider using a secure serialization library that provides protection against common deserialization vulnerabilities, such as Apache Commons Collections or Google's GSON library with appropriate settings. 5. Handle exceptions securely: Instead of catching generic exceptions like IOException and ClassNotFoundException, handle specific exceptions related to deserialization vulnerabilities, such as SecurityException or InvalidClassException. Here is an updated version of your code snippet with these security measures",php,0
Clear,"const userInput = new URLSearchParams(window.location.search).get('input');
const safeOutput = document.createElement('div');
safeOutput.textContent = userInput; // Safe DOM manipulation
document.body.appendChild(safeOutput);
","const userInput = new URLSearchParams(window.location.search).get('input');
const safeOutput = document.createElement('div');
safeOutput.textContent = userInput; // Safe DOM manipulation
document.body.appendChild(safeOutput);
",javascript,0
Clear,"const token = process.env.API_TOKEN; // Environment variable
fetch('/api/data', {
    headers: { 'Authorization': `Bearer ${token}` }
});
","const token = process.env.API_TOKEN; // Environment variable
fetch('/api/data', {
    headers: { 'Authorization': `Bearer ${token}` }
});
",javascript,0
SQL Injection,"<?php
$username = $_POST['username'];
$query = ""SELECT * FROM users WHERE username = '$username'"";
$result = mysql_query($query); // SQL Injection
?>","<?php
$username = $_POST['username'];
$query = ""SELECT * FROM users WHERE username = '$username'"";
$result = mysql_query($query); // SQL Injection
?>",php,1
XSS,"<?php
echo $_GET['message']; // XSS
?>","<?php
echo $_GET['message']; // XSS
?>",php,1
File Inclusion,"<?php
$file = $_GET['file'];
include($file); // File Inclusion
?>","<?php
$file = $_GET['file'];
include($file); // File Inclusion
?>",php,1
Cross-Site Scripting (XSS),"import java.io.*;
import javax.servlet.*;
import javax.servlet.http.*;

public class VulnerableServlet extends HttpServlet {
    protected void doGet(HttpServletRequest request, HttpServletResponse response)
            throws ServletException, IOException {

        String userInput = request.getParameter(""input"");
        String output = ""<p>User input: "" + userInput + ""</p>"";

        response.setContentType(""text/html"");
        PrintWriter out = response.getWriter();
        out.println(""<html><body>"");
        out.println(output);
        out.println(""</body></html>"");
    }
}","import java.io.*; import javax.servlet.*; import javax.servlet.http.*; public class VulnerableServlet extends HttpServlet { protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { String userInput = request.getParameter(""input""); String output = ""<p>User input: "" + userInput + ""</p>""; response.setContentType(""text/html""); PrintWriter out = response.getWriter(); out.println(""<html><body>""); out.println(output); out.println(""</body></html>""); } }",java,1
Clear,"import java.sql.*;

public class SQLInjectionFixed {

    public static void main(String[] args) {
        try {
            String userInput = ""'; DROP TABLE users; --""; // This is the malicious user input

            Connection connection = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");

            // Use a PreparedStatement to safely handle user input
            String query = ""SELECT * FROM users WHERE username = ?"";
            PreparedStatement statement = connection.prepareStatement(query);
            statement.setString(1, userInput);

            ResultSet resultSet = statement.executeQuery();

            while (resultSet.next()) {
                System.out.println(""User found: "" + resultSet.getString(""username""));
            }

        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.*; public class SQLInjectionFixed { public static void main(String[] args) { try { String userInput = ""'; DROP TABLE users; --""; // This is the malicious user input Connection connection = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); // Use a PreparedStatement to safely handle user input String query = ""SELECT * FROM users WHERE username = ?""; PreparedStatement statement = connection.prepareStatement(query); statement.setString(1, userInput); ResultSet resultSet = statement.executeQuery(); while (resultSet.next()) { System.out.println(""User found: "" + resultSet.getString(""username"")); } } catch (SQLException e) { e.printStackTrace(); } } }",java,0
Out-of-Bounds,"#include <iostream>

class UnsafeClass {
    int data[10];
public:
    int get_data(int index) {
        return data[index]; // no bounds checking
    }
};","#include <iostream>

class UnsafeClass {
    int data[10];
public:
    int get_data(int index) {
        return data[index]; // no bounds checking
    }
};",cpp,1
Clear,"#include <stdio.h>
#include <string.h>

int validate_input(const char *input) {
    if (input == NULL) return 0;
    for (int i = 0; input[i] != '\0'; i++) {
        if (input[i] < 32 || input[i] > 126) {
            return 0; // invalid character
        }
    }
    return 1;
}","#include <stdio.h>
#include <string.h>

int validate_input(const char *input) {
    if (input == NULL) return 0;
    for (int i = 0; input[i] != '\0'; i++) {
        if (input[i] < 32 || input[i] > 126) {
            return 0; // invalid character
        }
    }
    return 1;
}",c,0
Clear,"const shell = require('child_process');
const safeInput = userInput.replace(/[^a-zA-Z0-9.]/g, '');
shell.execFile('ping', [safeInput]); // Safe command execution
","const shell = require('child_process');
const safeInput = userInput.replace(/[^a-zA-Z0-9.]/g, '');
shell.execFile('ping', [safeInput]); // Safe command execution
",javascript,0
Clear,"<?php
$message = htmlspecialchars($_GET['message'], ENT_QUOTES, 'UTF-8');
echo $message; // Sanitized output
?>","<?php
$message = htmlspecialchars($_GET['message'], ENT_QUOTES, 'UTF-8');
echo $message; // Sanitized output
?>",php,0
Clear,"To fix the command injection vulnerability in the provided Java code, you should not directly execute user input as a command. Instead, you should sanitize and validate the user input to ensure that only safe commands can be executed. Here is an improved version of the code that addresses this vulnerability by using a white-list approach:

```java
import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class CommandInjectionSecure {

    public static void main(String[] args) {
        try {
            BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));
            System.out.print(""Enter a command to execute: "");
            String userInput = reader.readLine();

            // Secure code - validating user input against a white-list of allowed commands
            if (isValidCommand(userInput)) {
                Process process = Runtime.getRuntime().exec(userInput);

                BufferedReader processOutputReader = new BufferedReader(new InputStreamReader(process.getInputStream()));
                String line;
                while ((line = processOutputReader.readLine()) != null) {
                    System.out.println(line);
                }
            } else {
                System.out.println(""Invalid command. Only specific commands are allowed."");
            }
        } catch (IOException e) {
            e.printStackTrace();
        }
    }

    private static boolean isValidCommand(String command) {","To fix the command injection vulnerability in the provided Java code, you should not directly execute user input as a command. Instead, you should sanitize and validate the user input to ensure that only safe commands can be executed. Here is an improved version of the code that addresses this vulnerability by using a white-list approach: ```java import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class CommandInjectionSecure { public static void main(String[] args) { try { BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a command to execute: ""); String userInput = reader.readLine(); // Secure code - validating user input against a white-list of allowed commands if (isValidCommand(userInput)) { Process process = Runtime.getRuntime().exec(userInput); BufferedReader processOutputReader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = processOutputReader.readLine()) != null) { System.out.println(line); } } else { System.out.println(""Invalid command. Only specific commands are allowed.""); } } catch (IOException e) { e.printStackTrace(); } } private static boolean isValidCommand(String command) {",java,0
Clear,"<?php
$file = basename($_GET['file']);
$allowed = ['page1.php', 'page2.php'];
if (in_array($file, $allowed)) {
    include($file);
}
?>","<?php
$file = basename($_GET['file']);
$allowed = ['page1.php', 'page2.php'];
if (in_array($file, $allowed)) {
    include($file);
}
?>",php,0
Clear,"#include <stdio.h>
#include <stdlib.h>

int safe_string_to_int(const char *str) {
    char *endptr;
    long value = strtol(str, &endptr, 10);
    if (*endptr != '\0' || str == endptr) {
        return -1; // error
    }
    return (int)value;
}","#include <stdio.h>
#include <stdlib.h>

int safe_string_to_int(const char *str) {
    char *endptr;
    long value = strtol(str, &endptr, 10);
    if (*endptr != '\0' || str == endptr) {
        return -1; // error
    }
    return (int)value;
}",c,0
Command Injection,"import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class CommandInjectionVulnerability {

    public static void main(String[] args) throws IOException {
        BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));

        System.out.print(""Enter a directory name to list its contents: "");
        String directory = reader.readLine();

        // Vulnerable code - user input is directly passed to the command execution
        Process process = Runtime.getRuntime().exec(""ls "" + directory);

        BufferedReader outputReader = new BufferedReader(new InputStreamReader(process.getInputStream()));
        String line;
        while ((line = outputReader.readLine()) != null) {
            System.out.println(line);
        }

        process.destroy();
    }
}","import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class CommandInjectionVulnerability { public static void main(String[] args) throws IOException { BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a directory name to list its contents: ""); String directory = reader.readLine(); // Vulnerable code - user input is directly passed to the command execution Process process = Runtime.getRuntime().exec(""ls "" + directory); BufferedReader outputReader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = outputReader.readLine()) != null) { System.out.println(line); } process.destroy(); } }",java,1
Clear,"#include <stdio.h>
#include <stdlib.h>

void safe_file_operation(const char *filename) {
    FILE *file = fopen(filename, ""r"");
    if (file != NULL) {
        char buffer[256];
        while (fgets(buffer, sizeof(buffer), file)) {
            printf(""%s"", buffer);
        }
        fclose(file);
    }
}","#include <stdio.h>
#include <stdlib.h>

void safe_file_operation(const char *filename) {
    FILE *file = fopen(filename, ""r"");
    if (file != NULL) {
        char buffer[256];
        while (fgets(buffer, sizeof(buffer), file)) {
            printf(""%s"", buffer);
        }
        fclose(file);
    }
}",c,0
Memory Corruption,"#include <iostream>

void unsafe_virtual_call() {
    // Potential vtable corruption vulnerability
    class Base {
    public:
        virtual void func() { std::cout << ""Base"" << std::endl; }
    };
    
    class Derived : public Base {
    public:
        void func() override { std::cout << ""Derived"" << std::endl; }
    };
}","#include <iostream>

void unsafe_virtual_call() {
    // Potential vtable corruption vulnerability
    class Base {
    public:
        virtual void func() { std::cout << ""Base"" << std::endl; }
    };
    
    class Derived : public Base {
    public:
        void func() override { std::cout << ""Derived"" << std::endl; }
    };
}",cpp,1
Clear,"import java.io.IOException;
import javax.servlet.ServletException;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

import org.apache.commons.text.StringEscapeUtils;

public class SecureServlet extends HttpServlet {
    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        String userInput = request.getParameter(""input"");
        String sanitizedInput = StringEscapeUtils.escapeHtml4(userInput); // Sanitize user input

        String output = ""Hello "" + sanitizedInput;

        response.setContentType(""text/html"");
        response.getWriter().println(output);
    }
}","import java.io.IOException; import javax.servlet.ServletException; import javax.servlet.http.HttpServlet; import javax.servlet.http.HttpServletRequest; import javax.servlet.http.HttpServletResponse; import org.apache.commons.text.StringEscapeUtils; public class SecureServlet extends HttpServlet { protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { String userInput = request.getParameter(""input""); String sanitizedInput = StringEscapeUtils.escapeHtml4(userInput); // Sanitize user input String output = ""Hello "" + sanitizedInput; response.setContentType(""text/html""); response.getWriter().println(output); } }",java,0
Clear,"#include <iostream>
#include <fstream>
#include <string>

void safe_file_reading(const std::string& filename) {
    std::ifstream file(filename);
    if (file.is_open()) {
        std::string line;
        while (std::getline(file, line)) {
            std::cout << line << std::endl;
        }
    }
}","#include <iostream>
#include <fstream>
#include <string>

void safe_file_reading(const std::string& filename) {
    std::ifstream file(filename);
    if (file.is_open()) {
        std::string line;
        while (std::getline(file, line)) {
            std::cout << line << std::endl;
        }
    }
}",cpp,0
Clear,"import java.sql.*;

public class SecureSQLInjectionExample {

    public static void main(String[] args) {
        String userInput = ""'; DROP TABLE users; --"";

        try {
            Connection connection = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");
            
            String query = ""SELECT * FROM users WHERE username = ?"";
            PreparedStatement preparedStatement = connection.prepareStatement(query);
            preparedStatement.setString(1, userInput);

            ResultSet resultSet = preparedStatement.executeQuery();

            while (resultSet.next()) {
                System.out.println(resultSet.getString(""username""));
            }

            connection.close();
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.*; public class SecureSQLInjectionExample { public static void main(String[] args) { String userInput = ""'; DROP TABLE users; --""; try { Connection connection = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); String query = ""SELECT * FROM users WHERE username = ?""; PreparedStatement preparedStatement = connection.prepareStatement(query); preparedStatement.setString(1, userInput); ResultSet resultSet = preparedStatement.executeQuery(); while (resultSet.next()) { System.out.println(resultSet.getString(""username"")); } connection.close(); } catch (SQLException e) { e.printStackTrace(); } } }",java,0
Hardcoded Secrets,"localStorage.setItem('token', 'hardcoded-secret-token-123'); // Hardcoded secret
","localStorage.setItem('token', 'hardcoded-secret-token-123'); // Hardcoded secret
",javascript,1
Clear,"import jwt
import os
from datetime import datetime, timedelta

def create_safe_token(user_id):
    payload = {
        'user_id': user_id,
        'exp': datetime.utcnow() + timedelta(hours=1)
    }
    secret = os.environ.get('JWT_SECRET')
    return jwt.encode(payload, secret, algorithm='HS256')","import jwt
import os
from datetime import datetime, timedelta

def create_safe_token(user_id):
    payload = {
        'user_id': user_id,
        'exp': datetime.utcnow() + timedelta(hours=1)
    }
    secret = os.environ.get('JWT_SECRET')
    return jwt.encode(payload, secret, algorithm='HS256')",python,0
Clear,"#include <iostream>
#include <fstream>
#include <string>

void safe_file_reading(const std::string& filename) {
    std::ifstream file(filename);
    if (file.is_open()) {
        std::string line;
        while (std::getline(file, line)) {
            std::cout << line << std::endl;
        }
    }
}","#include <iostream>
#include <fstream>
#include <string>

void safe_file_reading(const std::string& filename) {
    std::ifstream file(filename);
    if (file.is_open()) {
        std::string line;
        while (std::getline(file, line)) {
            std::cout << line << std::endl;
        }
    }
}",cpp,0
Clear,"import java.io.*;
import javax.servlet.*;
import javax.servlet.http.*;
import org.owasp.esapi.ESAPI;

public class SecureServlet extends HttpServlet {
    protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        String userInput = request.getParameter(""input"");
        String sanitizedInput = ESAPI.encoder().encodeForHTML(userInput);

        PrintWriter out = response.getWriter();
        out.println(""<html>"");
        out.println(""<body>"");
        out.println(""<h1>User Input: "" + sanitizedInput + ""</h1>""); // Properly sanitized user input
        out.println(""</body>"");
        out.println(""</html>"");
    }
}","import java.io.*; import javax.servlet.*; import javax.servlet.http.*; import org.owasp.esapi.ESAPI; public class SecureServlet extends HttpServlet { protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { String userInput = request.getParameter(""input""); String sanitizedInput = ESAPI.encoder().encodeForHTML(userInput); PrintWriter out = response.getWriter(); out.println(""<html>""); out.println(""<body>""); out.println(""<h1>User Input: "" + sanitizedInput + ""</h1>""); // Properly sanitized user input out.println(""</body>""); out.println(""</html>""); } }",java,0
SSRF,"import requests
def fetch_url(url):
    return requests.get(url).text","import requests
def fetch_url(url):
    return requests.get(url).text",python,1
Clear,"#include <stdio.h>
#include <stdlib.h>

int safe_string_to_int(const char *str) {
    char *endptr;
    long value = strtol(str, &endptr, 10);
    if (*endptr != '\0' || str == endptr) {
        return -1; // error
    }
    return (int)value;
}","#include <stdio.h>
#include <stdlib.h>

int safe_string_to_int(const char *str) {
    char *endptr;
    long value = strtol(str, &endptr, 10);
    if (*endptr != '\0' || str == endptr) {
        return -1; // error
    }
    return (int)value;
}",c,0
Clear,"import hashlib
import os

def hash_password(password):
    salt = os.urandom(32)
    key = hashlib.pbkdf2_hmac('sha256', password.encode(), salt, 100000)
    return salt + key","import hashlib
import os

def hash_password(password):
    salt = os.urandom(32)
    key = hashlib.pbkdf2_hmac('sha256', password.encode(), salt, 100000)
    return salt + key",python,0
Clear,"import java.io.*;
import javax.servlet.*;
import javax.servlet.http.*;
import org.owasp.esapi.ESAPI;
import org.owasp.esapi.codecs.HTMLEntityCodec;

public class SecureServlet extends HttpServlet {
    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        String userInput = request.getParameter(""input"");
        
        // Sanitize user input to prevent XSS
        HTMLEntityCodec codec = new HTMLEntityCodec();
        String sanitizedInput = codec.encodeForHTML(userInput);

        String output = ""<h1>Hello, "" + sanitizedInput + ""!</h1>"";

        PrintWriter out = response.getWriter();
        out.println(output);
    }
}","import java.io.*; import javax.servlet.*; import javax.servlet.http.*; import org.owasp.esapi.ESAPI; import org.owasp.esapi.codecs.HTMLEntityCodec; public class SecureServlet extends HttpServlet { protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { String userInput = request.getParameter(""input""); // Sanitize user input to prevent XSS HTMLEntityCodec codec = new HTMLEntityCodec(); String sanitizedInput = codec.encodeForHTML(userInput); String output = ""<h1>Hello, "" + sanitizedInput + ""!</h1>""; PrintWriter out = response.getWriter(); out.println(output); } }",java,0
SQL Injection,"import mysql.connector
def search_products(category):
    db = mysql.connector.connect(host=""localhost"", user=""user"", password=""pass"", database=""shop"")
    cursor = db.cursor()
    cursor.execute(""SELECT * FROM products WHERE category = '%s'"" % category)
    return cursor.fetchall()","import mysql.connector
def search_products(category):
    db = mysql.connector.connect(host=""localhost"", user=""user"", password=""pass"", database=""shop"")
    cursor = db.cursor()
    cursor.execute(""SELECT * FROM products WHERE category = '%s'"" % category)
    return cursor.fetchall()",python,1
XSS,"const userInput = document.location.search.split('=')[1];
document.write(userInput); // XSS
","const userInput = document.location.search.split('=')[1];
document.write(userInput); // XSS
",javascript,1
Clear,"#include <stdio.h>
#include <string.h>

int safe_buffer_operation(char *input) {
    char buffer[100];
    if (strlen(input) < sizeof(buffer)) {
        strcpy(buffer, input);
        return 0;
    }
    return -1; // buffer too small
}","#include <stdio.h>
#include <string.h>

int safe_buffer_operation(char *input) {
    char buffer[100];
    if (strlen(input) < sizeof(buffer)) {
        strcpy(buffer, input);
        return 0;
    }
    return -1; // buffer too small
}",c,0
Insecure Deserialization,"import yaml
def load_config(config_str):
    return yaml.load(config_str, Loader=yaml.Loader)","import yaml
def load_config(config_str):
    return yaml.load(config_str, Loader=yaml.Loader)",python,1
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Cross-Site Scripting (XSS),"import java.io.IOException;
import java.io.PrintWriter;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

public class XSSVulnerableServlet extends HttpServlet {

    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws IOException {
        String userInput = request.getParameter(""input"");
        
        response.setContentType(""text/html"");
        PrintWriter out = response.getWriter();
        
        out.println(""<html>"");
        out.println(""<head><title>XSS Vulnerable Page</title></head>"");
        out.println(""<body>"");
        
        // Improperly handling user input without proper escaping
        out.println(""<h1>User Input: "" + userInput + ""</h1>"");
        
        out.println(""</body></html>"");
    }
}","import java.io.IOException; import java.io.PrintWriter; import javax.servlet.http.HttpServlet; import javax.servlet.http.HttpServletRequest; import javax.servlet.http.HttpServletResponse; public class XSSVulnerableServlet extends HttpServlet { protected void doGet(HttpServletRequest request, HttpServletResponse response) throws IOException { String userInput = request.getParameter(""input""); response.setContentType(""text/html""); PrintWriter out = response.getWriter(); out.println(""<html>""); out.println(""<head><title>XSS Vulnerable Page</title></head>""); out.println(""<body>""); // Improperly handling user input without proper escaping out.println(""<h1>User Input: "" + userInput + ""</h1>""); out.println(""</body></html>""); } }",java,1
Clear,"const userInput = new URLSearchParams(window.location.search).get('input');
const safeOutput = document.createElement('div');
safeOutput.textContent = userInput; // Safe DOM manipulation
document.body.appendChild(safeOutput);
","const userInput = new URLSearchParams(window.location.search).get('input');
const safeOutput = document.createElement('div');
safeOutput.textContent = userInput; // Safe DOM manipulation
document.body.appendChild(safeOutput);
",javascript,0
XSS,"<?php
echo $_GET['message']; // XSS
?>","<?php
echo $_GET['message']; // XSS
?>",php,1
Clear,"#include <stdio.h>
#include <stdlib.h>

void safe_file_operation(const char *filename) {
    FILE *file = fopen(filename, ""r"");
    if (file != NULL) {
        char buffer[256];
        while (fgets(buffer, sizeof(buffer), file)) {
            printf(""%s"", buffer);
        }
        fclose(file);
    }
}","#include <stdio.h>
#include <stdlib.h>

void safe_file_operation(const char *filename) {
    FILE *file = fopen(filename, ""r"");
    if (file != NULL) {
        char buffer[256];
        while (fgets(buffer, sizeof(buffer), file)) {
            printf(""%s"", buffer);
        }
        fclose(file);
    }
}",c,0
Clear,"#include <stdio.h>
#include <stdlib.h>

void safe_file_operation(const char *filename) {
    FILE *file = fopen(filename, ""r"");
    if (file != NULL) {
        char buffer[256];
        while (fgets(buffer, sizeof(buffer), file)) {
            printf(""%s"", buffer);
        }
        fclose(file);
    }
}","#include <stdio.h>
#include <stdlib.h>

void safe_file_operation(const char *filename) {
    FILE *file = fopen(filename, ""r"");
    if (file != NULL) {
        char buffer[256];
        while (fgets(buffer, sizeof(buffer), file)) {
            printf(""%s"", buffer);
        }
        fclose(file);
    }
}",c,0
Clear,"import java.io.IOException;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import org.apache.commons.text.StringEscapeUtils;

public class SecureServlet extends HttpServlet {
    
    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws IOException {
        String userInput = request.getParameter(""input"");
        
        // Properly encoding user input to prevent XSS
        String sanitizedInput = StringEscapeUtils.escapeHtml4(userInput);
        
        String output = ""<p>User Input: "" + sanitizedInput + ""</p>"";
        
        response.getWriter().println(output);
    }
}","import java.io.IOException; import javax.servlet.http.HttpServlet; import javax.servlet.http.HttpServletRequest; import javax.servlet.http.HttpServletResponse; import org.apache.commons.text.StringEscapeUtils; public class SecureServlet extends HttpServlet { protected void doGet(HttpServletRequest request, HttpServletResponse response) throws IOException { String userInput = request.getParameter(""input""); // Properly encoding user input to prevent XSS String sanitizedInput = StringEscapeUtils.escapeHtml4(userInput); String output = ""<p>User Input: "" + sanitizedInput + ""</p>""; response.getWriter().println(output); } }",java,0
Clear,"#include <iostream>
#include <memory>

void safe_memory_management() {
    auto ptr = std::make_unique<int>(42);
    std::cout << *ptr << std::endl;
}","#include <iostream>
#include <memory>

void safe_memory_management() {
    auto ptr = std::make_unique<int>(42);
    std::cout << *ptr << std::endl;
}",cpp,0
Command Injection,"const shell = require('child_process');
shell.exec('ping ' + userInput); // Command Injection
","const shell = require('child_process');
shell.exec('ping ' + userInput); // Command Injection
",javascript,1
Path Traversal,"import java.io.File;
import java.io.IOException;
import java.nio.file.Files;
import java.util.Scanner;

public class PathTraversalVulnerability {

    public static void main(String[] args) throws IOException {
        Scanner scanner = new Scanner(System.in);
        System.out.print(""Enter file name: "");
        String fileName = scanner.nextLine();

        File file = new File(""/path/to/some/directory/"" + fileName);
        
        if (file.exists()) {
            byte[] fileContent = Files.readAllBytes(file.toPath());
            System.out.println(new String(fileContent));
        } else {
            System.out.println(""File not found."");
        }
        
        scanner.close();
    }
}","import java.io.File; import java.io.IOException; import java.nio.file.Files; import java.util.Scanner; public class PathTraversalVulnerability { public static void main(String[] args) throws IOException { Scanner scanner = new Scanner(System.in); System.out.print(""Enter file name: ""); String fileName = scanner.nextLine(); File file = new File(""/path/to/some/directory/"" + fileName); if (file.exists()) { byte[] fileContent = Files.readAllBytes(file.toPath()); System.out.println(new String(fileContent)); } else { System.out.println(""File not found.""); } scanner.close(); } }",java,1
Clear,"const token = process.env.API_TOKEN; // Environment variable
fetch('/api/data', {
    headers: { 'Authorization': `Bearer ${token}` }
});
","const token = process.env.API_TOKEN; // Environment variable
fetch('/api/data', {
    headers: { 'Authorization': `Bearer ${token}` }
});
",javascript,0
Clear,"import java.io.IOException;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import org.apache.commons.text.StringEscapeUtils;

public class XSSFixedCode {

    public void handleUserInput(HttpServletRequest request, HttpServletResponse response) throws IOException {
        String userInput = request.getParameter(""input"");
        String safeUserInput = StringEscapeUtils.escapeHtml4(userInput);
        String output = ""<p>User input: "" + safeUserInput + ""</p>"";

        response.getWriter().println(output);
    }
}","import java.io.IOException; import javax.servlet.http.HttpServletRequest; import javax.servlet.http.HttpServletResponse; import org.apache.commons.text.StringEscapeUtils; public class XSSFixedCode { public void handleUserInput(HttpServletRequest request, HttpServletResponse response) throws IOException { String userInput = request.getParameter(""input""); String safeUserInput = StringEscapeUtils.escapeHtml4(userInput); String output = ""<p>User input: "" + safeUserInput + ""</p>""; response.getWriter().println(output); } }",java,0
Clear,"#include <stdio.h>
#include <string.h>

void safe_string_copy(char *dest, const char *src, size_t dest_size) {
    if (dest_size > 0) {
        strncpy(dest, src, dest_size - 1);
        dest[dest_size - 1] = '\0';
    }
}","#include <stdio.h>
#include <string.h>

void safe_string_copy(char *dest, const char *src, size_t dest_size) {
    if (dest_size > 0) {
        strncpy(dest, src, dest_size - 1);
        dest[dest_size - 1] = '\0';
    }
}",c,0
Clear,"#include <stdio.h>
#include <stdlib.h>

int safe_string_to_int(const char *str) {
    char *endptr;
    long value = strtol(str, &endptr, 10);
    if (*endptr != '\0' || str == endptr) {
        return -1; // error
    }
    return (int)value;
}","#include <stdio.h>
#include <stdlib.h>

int safe_string_to_int(const char *str) {
    char *endptr;
    long value = strtol(str, &endptr, 10);
    if (*endptr != '\0' || str == endptr) {
        return -1; // error
    }
    return (int)value;
}",c,0
Command Injection,"import os
def ping_host(host):
    os.system(""ping -c 4 "" + host)","import os
def ping_host(host):
    os.system(""ping -c 4 "" + host)",python,1
Clear,"#include <iostream>
#include <memory>

void safe_memory_management() {
    auto ptr = std::make_unique<int>(42);
    std::cout << *ptr << std::endl;
}","#include <iostream>
#include <memory>

void safe_memory_management() {
    auto ptr = std::make_unique<int>(42);
    std::cout << *ptr << std::endl;
}",cpp,0
Cross-Site Scripting (XSS),"def display_comment(comment_text):
    return f""<div class='comment'>{comment_text}</div>"" ","def display_comment(comment_text):
    return f""<div class='comment'>{comment_text}</div>"" ",python,1
Clear,"import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class CommandInjectionFixed {

    public static void main(String[] args) {
        try {
            BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));
            System.out.print(""Enter a command to execute: "");
            String command = reader.readLine();

            // Separate the command and arguments using ProcessBuilder
            ProcessBuilder processBuilder = new ProcessBuilder(command.split(""\\s+""));
            
            // Start the process
            Process process = processBuilder.start();

            // Read and display the output
            BufferedReader inputReader = new BufferedReader(new InputStreamReader(process.getInputStream()));
            String line;
            while ((line = inputReader.readLine()) != null) {
                System.out.println(line);
            }

        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}","import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class CommandInjectionFixed { public static void main(String[] args) { try { BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a command to execute: ""); String command = reader.readLine(); // Separate the command and arguments using ProcessBuilder ProcessBuilder processBuilder = new ProcessBuilder(command.split(""\\s+"")); // Start the process Process process = processBuilder.start(); // Read and display the output BufferedReader inputReader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = inputReader.readLine()) != null) { System.out.println(line); } } catch (IOException e) { e.printStackTrace(); } } }",java,0
SQL Injection,"import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Statement;

public class SQLInjectionVulnerability {
    public static void main(String[] args) {
        String userInput = ""'; DROP TABLE users; --"";
        
        try {
            Connection connection = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");
            Statement statement = connection.createStatement();
            
            String query = ""SELECT * FROM users WHERE username='"" + userInput + ""'"";
            ResultSet resultSet = statement.executeQuery(query);
            
            while (resultSet.next()) {
                System.out.println(resultSet.getString(""username""));
            }
            
            resultSet.close();
            statement.close();
            connection.close();
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.Connection; import java.sql.DriverManager; import java.sql.ResultSet; import java.sql.SQLException; import java.sql.Statement; public class SQLInjectionVulnerability { public static void main(String[] args) { String userInput = ""'; DROP TABLE users; --""; try { Connection connection = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); Statement statement = connection.createStatement(); String query = ""SELECT * FROM users WHERE username='"" + userInput + ""'""; ResultSet resultSet = statement.executeQuery(query); while (resultSet.next()) { System.out.println(resultSet.getString(""username"")); } resultSet.close(); statement.close(); connection.close(); } catch (SQLException e) { e.printStackTrace(); } } }",java,1
Clear,"const userData = JSON.parse(userInput); // Safe JSON parsing
if (userData && typeof userData === 'object') {
    processUserData(userData);
}
","const userData = JSON.parse(userInput); // Safe JSON parsing
if (userData && typeof userData === 'object') {
    processUserData(userData);
}
",javascript,0
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
SQL Injection,"import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Statement;

public class SQLInjectionVulnerableCode {

    public static void main(String[] args) {
        String userInput = ""'; DROP TABLE users; --""; // User input containing SQL Injection payload

        try {
            Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");
            Statement stmt = conn.createStatement();

            String query = ""SELECT * FROM users WHERE username = '"" + userInput + ""'"";
            ResultSet rs = stmt.executeQuery(query);

            while (rs.next()) {
                System.out.println(""User ID: "" + rs.getInt(""id"") + "", Username: "" + rs.getString(""username""));
            }

            conn.close();
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.Connection; import java.sql.DriverManager; import java.sql.ResultSet; import java.sql.SQLException; import java.sql.Statement; public class SQLInjectionVulnerableCode { public static void main(String[] args) { String userInput = ""'; DROP TABLE users; --""; // User input containing SQL Injection payload try { Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); Statement stmt = conn.createStatement(); String query = ""SELECT * FROM users WHERE username = '"" + userInput + ""'""; ResultSet rs = stmt.executeQuery(query); while (rs.next()) { System.out.println(""User ID: "" + rs.getInt(""id"") + "", Username: "" + rs.getString(""username"")); } conn.close(); } catch (SQLException e) { e.printStackTrace(); } } }",java,1
File Inclusion,"<?php
$file = $_GET['file'];
include($file); // File Inclusion
?>","<?php
$file = $_GET['file'];
include($file); // File Inclusion
?>",php,1
Clear,"To fix the Path Traversal vulnerability in the given Java code snippet, you should sanitize the input file name provided by the user to prevent directory traversal attacks. One common approach is to restrict the file name to be within a specific directory or whitelist allowed file names.

Here's an improved version of the code with proper security measures implemented:

```java
import java.io.File;
import java.io.FileInputStream;
import java.io.IOException;
import java.util.Scanner;

public class SecurePathTraversal {

    private static final String BASE_DIRECTORY = ""/path/to/some/directory/"";

    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        System.out.print(""Enter file name: "");
        String fileName = scanner.nextLine();

        if (!isFileNameValid(fileName)) {
            System.err.println(""Invalid file name."");
            return;
        }

        File file = new File(BASE_DIRECTORY + fileName);

        try (FileInputStream fis = new FileInputStream(file)) {
            int data;
            while ((data = fis.read()) != -1) {
                System.out.print((char) data);
            }
        } catch (IOException e) {
            System.err.println(""Error reading file: "" + e.getMessage());
        }
    }

    private static","To fix the Path Traversal vulnerability in the given Java code snippet, you should sanitize the input file name provided by the user to prevent directory traversal attacks. One common approach is to restrict the file name to be within a specific directory or whitelist allowed file names. Here's an improved version of the code with proper security measures implemented: ```java import java.io.File; import java.io.FileInputStream; import java.io.IOException; import java.util.Scanner; public class SecurePathTraversal { private static final String BASE_DIRECTORY = ""/path/to/some/directory/""; public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter file name: ""); String fileName = scanner.nextLine(); if (!isFileNameValid(fileName)) { System.err.println(""Invalid file name.""); return; } File file = new File(BASE_DIRECTORY + fileName); try (FileInputStream fis = new FileInputStream(file)) { int data; while ((data = fis.read()) != -1) { System.out.print((char) data); } } catch (IOException e) { System.err.println(""Error reading file: "" + e.getMessage()); } } private static",java,0
Hardcoded Secrets,"localStorage.setItem('token', 'hardcoded-secret-token-123'); // Hardcoded secret
","localStorage.setItem('token', 'hardcoded-secret-token-123'); // Hardcoded secret
",javascript,1
Code Injection,"const userData = eval('(' + userInput + ')'); // eval injection
","const userData = eval('(' + userInput + ')'); // eval injection
",javascript,1
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Clear,"import java.util.Scanner;

public class SecureBufferExample {
    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        
        System.out.print(""Enter your name: "");
        String name = scanner.nextLine();
        
        // Use StringBuilder to dynamically allocate memory for the string
        StringBuilder buffer = new StringBuilder();
        buffer.append(name);
        
        System.out.println(""Welcome, "" + buffer.toString());
    }
}","import java.util.Scanner; public class SecureBufferExample { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter your name: ""); String name = scanner.nextLine(); // Use StringBuilder to dynamically allocate memory for the string StringBuilder buffer = new StringBuilder(); buffer.append(name); System.out.println(""Welcome, "" + buffer.toString()); } }",java,0
Clear,"To fix the Path Traversal vulnerability in the given Java code snippet, you should validate and sanitize user input before constructing the file path. Here's an improved version of the code that addresses this vulnerability:

```java
import java.io.File;
import java.io.FileInputStream;
import java.io.IOException;
import java.util.Scanner;

public class SecurePathTraversal {

    public static void main(String[] args) throws IOException {
        Scanner scanner = new Scanner(System.in);
        System.out.print(""Enter file name: "");
        String fileName = scanner.next();

        // Validate and sanitize user input to prevent path traversal
        if (!isValidFileName(fileName)) {
            System.out.println(""Invalid file name."");
            return;
        }

        File file = new File(""/path/to/files/"" + fileName);

        if (!file.exists() || !file.isFile()) {
            System.out.println(""File not found."");
            return;
        }

        FileInputStream fis = new FileInputStream(file);

        int data;
        while ((data = fis.read()) != -1) {
            System.out.print((char) data);
        }

        fis.close();
    }

    private static boolean isValidFileName(String fileName) {
        // Add your validation logic here (e.g., restrict certain characters, check file","To fix the Path Traversal vulnerability in the given Java code snippet, you should validate and sanitize user input before constructing the file path. Here's an improved version of the code that addresses this vulnerability: ```java import java.io.File; import java.io.FileInputStream; import java.io.IOException; import java.util.Scanner; public class SecurePathTraversal { public static void main(String[] args) throws IOException { Scanner scanner = new Scanner(System.in); System.out.print(""Enter file name: ""); String fileName = scanner.next(); // Validate and sanitize user input to prevent path traversal if (!isValidFileName(fileName)) { System.out.println(""Invalid file name.""); return; } File file = new File(""/path/to/files/"" + fileName); if (!file.exists() || !file.isFile()) { System.out.println(""File not found.""); return; } FileInputStream fis = new FileInputStream(file); int data; while ((data = fis.read()) != -1) { System.out.print((char) data); } fis.close(); } private static boolean isValidFileName(String fileName) { // Add your validation logic here (e.g., restrict certain characters, check file",java,0
SQL Injection,"<?php
$username = $_POST['username'];
$query = ""SELECT * FROM users WHERE username = '$username'"";
$result = mysql_query($query); // SQL Injection
?>","<?php
$username = $_POST['username'];
$query = ""SELECT * FROM users WHERE username = '$username'"";
$result = mysql_query($query); // SQL Injection
?>",php,1
Clear,"const userData = JSON.parse(userInput); // Safe JSON parsing
if (userData && typeof userData === 'object') {
    processUserData(userData);
}
","const userData = JSON.parse(userInput); // Safe JSON parsing
if (userData && typeof userData === 'object') {
    processUserData(userData);
}
",javascript,0
Clear,"#include <iostream>
#include <memory>

void safe_memory_management() {
    auto ptr = std::make_unique<int>(42);
    std::cout << *ptr << std::endl;
}","#include <iostream>
#include <memory>

void safe_memory_management() {
    auto ptr = std::make_unique<int>(42);
    std::cout << *ptr << std::endl;
}",cpp,0
Clear,"To fix the Command Injection vulnerability in the provided Java code, you need to sanitize and validate the user input before using it to construct the command. Here is an improved version of the code that implements proper security measures:

```java
import java.io.*;

public class SecureCommandExecution {

    public static void main(String[] args) {
        try {
            BufferedReader br = new BufferedReader(new InputStreamReader(System.in));
            System.out.print(""Enter a file name to display its content: "");
            String fileName = br.readLine();

            // Sanitize and validate user input
            if (!isValidFileName(fileName)) {
                System.out.println(""Invalid file name."");
                return;
            }

            String command = ""cat "" + fileName; // Construct command securely

            Process process = Runtime.getRuntime().exec(command);
            BufferedReader reader = new BufferedReader(new InputStreamReader(process.getInputStream()));

            String line;
            while ((line = reader.readLine()) != null) {
                System.out.println(line);
            }

        } catch (IOException e) {
            e.printStackTrace();
        }
    }

    private static boolean isValidFileName(String fileName) {
        // Add your validation logic here, e.g., check for allowed characters
        // You can also restrict access to specific directories or files

        //","To fix the Command Injection vulnerability in the provided Java code, you need to sanitize and validate the user input before using it to construct the command. Here is an improved version of the code that implements proper security measures: ```java import java.io.*; public class SecureCommandExecution { public static void main(String[] args) { try { BufferedReader br = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a file name to display its content: ""); String fileName = br.readLine(); // Sanitize and validate user input if (!isValidFileName(fileName)) { System.out.println(""Invalid file name.""); return; } String command = ""cat "" + fileName; // Construct command securely Process process = Runtime.getRuntime().exec(command); BufferedReader reader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = reader.readLine()) != null) { System.out.println(line); } } catch (IOException e) { e.printStackTrace(); } } private static boolean isValidFileName(String fileName) { // Add your validation logic here, e.g., check for allowed characters // You can also restrict access to specific directories or files //",java,0
SQL Injection,"import java.sql.*;

public class SQLInjectionExample {
    public static void main(String[] args) {
        try {
            // Simulating user input
            String userInput = ""admin'; DROP TABLE users; --"";

            // Constructing SQL query with user input directly concatenated
            String query = ""SELECT * FROM users WHERE username='"" + userInput + ""'"";

            Connection connection = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");
            Statement statement = connection.createStatement();
            ResultSet resultSet = statement.executeQuery(query);

            while (resultSet.next()) {
                System.out.println(""Username: "" + resultSet.getString(""username""));
                System.out.println(""Email: "" + resultSet.getString(""email""));
            }

            connection.close();
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.*; public class SQLInjectionExample { public static void main(String[] args) { try { // Simulating user input String userInput = ""admin'; DROP TABLE users; --""; // Constructing SQL query with user input directly concatenated String query = ""SELECT * FROM users WHERE username='"" + userInput + ""'""; Connection connection = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); Statement statement = connection.createStatement(); ResultSet resultSet = statement.executeQuery(query); while (resultSet.next()) { System.out.println(""Username: "" + resultSet.getString(""username"")); System.out.println(""Email: "" + resultSet.getString(""email"")); } connection.close(); } catch (SQLException e) { e.printStackTrace(); } } }",java,1
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Clear,"#include <iostream>
#include <vector>
#include <stdexcept>

int safe_vector_access(const std::vector<int>& vec, size_t index) {
    if (index >= vec.size()) {
        throw std::out_of_range(""Index out of range"");
    }
    return vec[index];
}","#include <iostream>
#include <vector>
#include <stdexcept>

int safe_vector_access(const std::vector<int>& vec, size_t index) {
    if (index >= vec.size()) {
        throw std::out_of_range(""Index out of range"");
    }
    return vec[index];
}",cpp,0
Clear,"import pickle
def safe_deserialize(data):
    allowed_classes = {'SafeClass', 'AnotherSafeClass'}
    return pickle.loads(data)","import pickle
def safe_deserialize(data):
    allowed_classes = {'SafeClass', 'AnotherSafeClass'}
    return pickle.loads(data)",python,0
Hardcoded Secrets,"localStorage.setItem('token', 'hardcoded-secret-token-123'); // Hardcoded secret
","localStorage.setItem('token', 'hardcoded-secret-token-123'); // Hardcoded secret
",javascript,1
Clear,"def safe_comment_display(comment_text):
    import html
    escaped_text = html.escape(comment_text)
    return f""<div class='comment'>{escaped_text}</div>"" ","def safe_comment_display(comment_text):
    import html
    escaped_text = html.escape(comment_text)
    return f""<div class='comment'>{escaped_text}</div>"" ",python,0
Clear,"#include <stdio.h>
#include <stdlib.h>

void safe_file_operation(const char *filename) {
    FILE *file = fopen(filename, ""r"");
    if (file != NULL) {
        char buffer[256];
        while (fgets(buffer, sizeof(buffer), file)) {
            printf(""%s"", buffer);
        }
        fclose(file);
    }
}","#include <stdio.h>
#include <stdlib.h>

void safe_file_operation(const char *filename) {
    FILE *file = fopen(filename, ""r"");
    if (file != NULL) {
        char buffer[256];
        while (fgets(buffer, sizeof(buffer), file)) {
            printf(""%s"", buffer);
        }
        fclose(file);
    }
}",c,0
SQL Injection,"app.get('/user/:id', (req, res) => {
    const query = `SELECT * FROM users WHERE id = ${req.params.id}`; // SQL Injection
    db.query(query, (err, result) => {
        res.json(result);
    });
});
","app.get('/user/:id', (req, res) => {
    const query = `SELECT * FROM users WHERE id = ${req.params.id}`; // SQL Injection
    db.query(query, (err, result) => {
        res.json(result);
    });
});
",javascript,1
Clear,"To fix the Command Injection vulnerability in the provided Java code snippet, you need to ensure that user input is properly validated and sanitized before being passed to the `Runtime.exec()` method. Here's an improved version of the code that incorporates security measures to prevent command injection:

```java
import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class SecureCommandExecution {

    public static void main(String[] args) throws IOException {
        BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));

        System.out.print(""Enter a command to execute: "");
        String userInput = reader.readLine();

        // Validate user input to prevent command injection
        if (!isValidCommand(userInput)) {
            System.out.println(""Invalid command. Aborting execution."");
            return;
        }

        // Execute the validated command securely
        Process process = Runtime.getRuntime().exec(new String[] { ""/bin/sh"", ""-c"", userInput });

        BufferedReader inputReader = new BufferedReader(new InputStreamReader(process.getInputStream()));
        String line;

        while ((line = inputReader.readLine()) != null) {
            System.out.println(line);
        }

        process.waitFor();
    }

    private static boolean isValidCommand(String command) {
        // Add your custom validation logic here based on your application requirements","To fix the Command Injection vulnerability in the provided Java code snippet, you need to ensure that user input is properly validated and sanitized before being passed to the `Runtime.exec()` method. Here's an improved version of the code that incorporates security measures to prevent command injection: ```java import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class SecureCommandExecution { public static void main(String[] args) throws IOException { BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a command to execute: ""); String userInput = reader.readLine(); // Validate user input to prevent command injection if (!isValidCommand(userInput)) { System.out.println(""Invalid command. Aborting execution.""); return; } // Execute the validated command securely Process process = Runtime.getRuntime().exec(new String[] { ""/bin/sh"", ""-c"", userInput }); BufferedReader inputReader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = inputReader.readLine()) != null) { System.out.println(line); } process.waitFor(); } private static boolean isValidCommand(String command) { // Add your custom validation logic here based on your application requirements",java,0
Clear,"import java.io.*;

public class CommandInjectionDemo {

    public static void main(String[] args) {
        try {
            BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));
            System.out.print(""Enter a command to execute: "");
            String command = reader.readLine();

            ProcessBuilder processBuilder = new ProcessBuilder();
            processBuilder.command(""ping"", command);
            
            Process process = processBuilder.start();

            BufferedReader inputStreamReader = new BufferedReader(new InputStreamReader(process.getInputStream()));
            String line;
            while ((line = inputStreamReader.readLine()) != null) {
                System.out.println(line);
            }

        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}","import java.io.*; public class CommandInjectionDemo { public static void main(String[] args) { try { BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a command to execute: ""); String command = reader.readLine(); ProcessBuilder processBuilder = new ProcessBuilder(); processBuilder.command(""ping"", command); Process process = processBuilder.start(); BufferedReader inputStreamReader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = inputStreamReader.readLine()) != null) { System.out.println(line); } } catch (IOException e) { e.printStackTrace(); } } }",java,0
Buffer Overflow,"#include <iostream>
#include <cstring>

void unsafe_c_string(char* input) {
    char buffer[100];
    strcpy(buffer, input); // potential buffer overflow
    std::cout << buffer << std::endl;
}","#include <iostream>
#include <cstring>

void unsafe_c_string(char* input) {
    char buffer[100];
    strcpy(buffer, input); // potential buffer overflow
    std::cout << buffer << std::endl;
}",cpp,1
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Clear,"#include <iostream>
#include <memory>

void safe_memory_management() {
    auto ptr = std::make_unique<int>(42);
    std::cout << *ptr << std::endl;
}","#include <iostream>
#include <memory>

void safe_memory_management() {
    auto ptr = std::make_unique<int>(42);
    std::cout << *ptr << std::endl;
}",cpp,0
Insecure Deserialization,"import yaml
def load_config(config_str):
    return yaml.load(config_str, Loader=yaml.Loader)","import yaml
def load_config(config_str):
    return yaml.load(config_str, Loader=yaml.Loader)",python,1
Clear,"app.get('/user/:id', (req, res) => {
    const userId = parseInt(req.params.id);
    db.query('SELECT * FROM users WHERE id = ?', [userId], (err, result) => {
        res.json(result);
    });
});
","app.get('/user/:id', (req, res) => {
    const userId = parseInt(req.params.id);
    db.query('SELECT * FROM users WHERE id = ?', [userId], (err, result) => {
        res.json(result);
    });
});
",javascript,0
Clear,"import java.io.*;
import javax.servlet.*;
import javax.servlet.http.*;

import org.owasp.encoder.Encode;

public class XSSSafeServlet extends HttpServlet {
    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        String userInput = request.getParameter(""input"");
        String safeUserInput = Encode.forHtml(userInput);
        
        String htmlResponse = ""<html><body>User input: "" + safeUserInput + ""</body></html>"";
        
        response.setContentType(""text/html"");
        PrintWriter out = response.getWriter();
        out.println(htmlResponse);
    }
}","import java.io.*; import javax.servlet.*; import javax.servlet.http.*; import org.owasp.encoder.Encode; public class XSSSafeServlet extends HttpServlet { protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { String userInput = request.getParameter(""input""); String safeUserInput = Encode.forHtml(userInput); String htmlResponse = ""<html><body>User input: "" + safeUserInput + ""</body></html>""; response.setContentType(""text/html""); PrintWriter out = response.getWriter(); out.println(htmlResponse); } }",java,0
File Inclusion,"<?php
$file = $_GET['file'];
include($file); // File Inclusion
?>","<?php
$file = $_GET['file'];
include($file); // File Inclusion
?>",php,1
Code Injection,"const userData = eval('(' + userInput + ')'); // eval injection
","const userData = eval('(' + userInput + ')'); // eval injection
",javascript,1
SQL Injection,"import java.sql.*;

public class SQLInjectionVulnerability {

    public static void main(String[] args) {
        String userInput = ""'; DROP TABLE users; --"";
        
        try {
            Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");
            Statement stmt = conn.createStatement();
            
            String query = ""SELECT * FROM users WHERE username='"" + userInput + ""'"";
            ResultSet rs = stmt.executeQuery(query);
            
            while (rs.next()) {
                System.out.println(""User ID: "" + rs.getInt(""id"") + "", Username: "" + rs.getString(""username""));
            }
            
            conn.close();
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.*; public class SQLInjectionVulnerability { public static void main(String[] args) { String userInput = ""'; DROP TABLE users; --""; try { Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); Statement stmt = conn.createStatement(); String query = ""SELECT * FROM users WHERE username='"" + userInput + ""'""; ResultSet rs = stmt.executeQuery(query); while (rs.next()) { System.out.println(""User ID: "" + rs.getInt(""id"") + "", Username: "" + rs.getString(""username"")); } conn.close(); } catch (SQLException e) { e.printStackTrace(); } } }",java,1
Buffer Overflow,"#include <iostream>
#include <cstdio>

void unsafe_c_input() {
    char buffer[50];
    scanf(""%s"", buffer); // no length limit
    std::cout << buffer << std::endl;
}","#include <iostream>
#include <cstdio>

void unsafe_c_input() {
    char buffer[50];
    scanf(""%s"", buffer); // no length limit
    std::cout << buffer << std::endl;
}",cpp,1
Clear,"import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class CommandInjectionFixed {
    public static void main(String[] args) throws IOException {
        BufferedReader br = new BufferedReader(new InputStreamReader(System.in));

        System.out.print(""Enter a command to execute: "");
        String command = br.readLine();

        // Safer code using ProcessBuilder
        ProcessBuilder processBuilder = new ProcessBuilder(command.split("" ""));
        Process process = processBuilder.start();

        // Read output from the process if needed
        BufferedReader reader =
                new BufferedReader(new InputStreamReader(process.getInputStream()));
        String line;
        while ((line = reader.readLine()) != null) {
            System.out.println(line);
        }

        System.out.println(""Command executed successfully."");
    }
}","import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class CommandInjectionFixed { public static void main(String[] args) throws IOException { BufferedReader br = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a command to execute: ""); String command = br.readLine(); // Safer code using ProcessBuilder ProcessBuilder processBuilder = new ProcessBuilder(command.split("" "")); Process process = processBuilder.start(); // Read output from the process if needed BufferedReader reader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = reader.readLine()) != null) { System.out.println(line); } System.out.println(""Command executed successfully.""); } }",java,0
Clear,"import org.owasp.esapi.ESAPI;
import org.owasp.esapi.codecs.HTMLEntityCodec;

public class XSSSecureCode {

    public static void main(String[] args) {
        // Simulating user input
        String userInput = ""<script>alert('XSS attack!')</script>"";

        // Properly encode user input using OWASP ESAPI library
        HTMLEntityCodec codec = new HTMLEntityCodec();
        String encodedUserInput = codec.encodeForHTML(userInput);

        // Print the properly encoded user input
        System.out.println(""Welcome, "" + encodedUserInput);
    }
}","import org.owasp.esapi.ESAPI; import org.owasp.esapi.codecs.HTMLEntityCodec; public class XSSSecureCode { public static void main(String[] args) { // Simulating user input String userInput = ""<script>alert('XSS attack!')</script>""; // Properly encode user input using OWASP ESAPI library HTMLEntityCodec codec = new HTMLEntityCodec(); String encodedUserInput = codec.encodeForHTML(userInput); // Print the properly encoded user input System.out.println(""Welcome, "" + encodedUserInput); } }",java,0
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Clear,"const shell = require('child_process');
const safeInput = userInput.replace(/[^a-zA-Z0-9.]/g, '');
shell.execFile('ping', [safeInput]); // Safe command execution
","const shell = require('child_process');
const safeInput = userInput.replace(/[^a-zA-Z0-9.]/g, '');
shell.execFile('ping', [safeInput]); // Safe command execution
",javascript,0
Clear,"#include <stdio.h>
#include <stdlib.h>

void safe_file_operation(const char *filename) {
    FILE *file = fopen(filename, ""r"");
    if (file != NULL) {
        char buffer[256];
        while (fgets(buffer, sizeof(buffer), file)) {
            printf(""%s"", buffer);
        }
        fclose(file);
    }
}","#include <stdio.h>
#include <stdlib.h>

void safe_file_operation(const char *filename) {
    FILE *file = fopen(filename, ""r"");
    if (file != NULL) {
        char buffer[256];
        while (fgets(buffer, sizeof(buffer), file)) {
            printf(""%s"", buffer);
        }
        fclose(file);
    }
}",c,0
Clear,"#include <iostream>
#include <vector>
#include <stdexcept>

int safe_vector_access(const std::vector<int>& vec, size_t index) {
    if (index >= vec.size()) {
        throw std::out_of_range(""Index out of range"");
    }
    return vec[index];
}","#include <iostream>
#include <vector>
#include <stdexcept>

int safe_vector_access(const std::vector<int>& vec, size_t index) {
    if (index >= vec.size()) {
        throw std::out_of_range(""Index out of range"");
    }
    return vec[index];
}",cpp,0
Clear,"To fix the Path Traversal vulnerability in the provided Java code snippet, you can implement the following secure code generation practices:

1. Validate User Input: 
Ensure that the user input (file name) does not contain any malicious characters or sequences that could lead to path traversal attacks. You can restrict the input to alphanumeric characters and certain safe symbols.

2. Sanitize File Paths:
Instead of directly concatenating the directory path and user-provided file name, use methods like `Paths.get(directory, fileName).toAbsolutePath().normalize()` to construct the file path safely. This will resolve any relative paths and eliminate any potential traversal vulnerabilities.

3. Check File Existence:
Before attempting to read the file, check if the file actually exists at the specified path using `file.exists()`. This helps prevent errors when trying to access non-existent files.

4. Use Whitelisting:
If possible, maintain a whitelist of allowed file names or directories that users are allowed to access. Validate user input against this whitelist before proceeding with file operations.

5. Handle Exceptions Appropriately:
Catch specific exceptions like `FileNotFoundException` along with `SecurityException` in addition to `IOException` for better error handling. Log only generic error messages without exposing sensitive information.

Here's an","To fix the Path Traversal vulnerability in the provided Java code snippet, you can implement the following secure code generation practices: 1. Validate User Input: Ensure that the user input (file name) does not contain any malicious characters or sequences that could lead to path traversal attacks. You can restrict the input to alphanumeric characters and certain safe symbols. 2. Sanitize File Paths: Instead of directly concatenating the directory path and user-provided file name, use methods like `Paths.get(directory, fileName).toAbsolutePath().normalize()` to construct the file path safely. This will resolve any relative paths and eliminate any potential traversal vulnerabilities. 3. Check File Existence: Before attempting to read the file, check if the file actually exists at the specified path using `file.exists()`. This helps prevent errors when trying to access non-existent files. 4. Use Whitelisting: If possible, maintain a whitelist of allowed file names or directories that users are allowed to access. Validate user input against this whitelist before proceeding with file operations. 5. Handle Exceptions Appropriately: Catch specific exceptions like `FileNotFoundException` along with `SecurityException` in addition to `IOException` for better error handling. Log only generic error messages without exposing sensitive information. Here's an",php,0
Command Injection,"import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class CommandInjectionVulnerable {
    public static void main(String[] args) throws IOException {
        BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));
        
        System.out.print(""Enter a command to execute: "");
        String userInput = reader.readLine();
        
        String command = ""echo "" + userInput; // Vulnerable code, user input is directly concatenated into the command
        
        Process process = Runtime.getRuntime().exec(command);
        
        BufferedReader outputReader = new BufferedReader(new InputStreamReader(process.getInputStream()));
        String outputLine;
        
        while ((outputLine = outputReader.readLine()) != null) {
            System.out.println(outputLine);
        }
    }
}","import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class CommandInjectionVulnerable { public static void main(String[] args) throws IOException { BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a command to execute: ""); String userInput = reader.readLine(); String command = ""echo "" + userInput; // Vulnerable code, user input is directly concatenated into the command Process process = Runtime.getRuntime().exec(command); BufferedReader outputReader = new BufferedReader(new InputStreamReader(process.getInputStream())); String outputLine; while ((outputLine = outputReader.readLine()) != null) { System.out.println(outputLine); } } }",java,1
Clear,"import json
def parse_safe_json(json_str):
    try:
        return json.loads(json_str)
    except json.JSONDecodeError:
        raise ValueError(""Invalid JSON"")","import json
def parse_safe_json(json_str):
    try:
        return json.loads(json_str)
    except json.JSONDecodeError:
        raise ValueError(""Invalid JSON"")",python,0
Clear,"#include <stdio.h>
#include <stdlib.h>

void safe_file_operation(const char *filename) {
    FILE *file = fopen(filename, ""r"");
    if (file != NULL) {
        char buffer[256];
        while (fgets(buffer, sizeof(buffer), file)) {
            printf(""%s"", buffer);
        }
        fclose(file);
    }
}","#include <stdio.h>
#include <stdlib.h>

void safe_file_operation(const char *filename) {
    FILE *file = fopen(filename, ""r"");
    if (file != NULL) {
        char buffer[256];
        while (fgets(buffer, sizeof(buffer), file)) {
            printf(""%s"", buffer);
        }
        fclose(file);
    }
}",c,0
Clear,"import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class SecureCommandExecution {

    public static void main(String[] args) {
        try {
            BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));
            System.out.print(""Enter a command to execute: "");
            String command = reader.readLine();

            // Sanitize the input by splitting it into arguments
            String[] commandArgs = command.split(""\\s+"");

            // Build the process with sanitized input
            ProcessBuilder processBuilder = new ProcessBuilder(commandArgs);
            
            Process process = processBuilder.start();
            
            BufferedReader inputStreamReader = new BufferedReader(new InputStreamReader(process.getInputStream()));

            String line;
            while ((line = inputStreamReader.readLine()) != null) {
                System.out.println(line);
            }

        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}","import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class SecureCommandExecution { public static void main(String[] args) { try { BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a command to execute: ""); String command = reader.readLine(); // Sanitize the input by splitting it into arguments String[] commandArgs = command.split(""\\s+""); // Build the process with sanitized input ProcessBuilder processBuilder = new ProcessBuilder(commandArgs); Process process = processBuilder.start(); BufferedReader inputStreamReader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = inputStreamReader.readLine()) != null) { System.out.println(line); } } catch (IOException e) { e.printStackTrace(); } } }",java,0
Clear,"To fix the Path Traversal vulnerability in the provided Java code snippet, you need to ensure that the user input does not allow directory traversal beyond the intended base path. One way to achieve this is by validating and sanitizing the user input before constructing the full path.

Here is an improved version of the code with proper security measures:

```java
import java.io.File;
import java.io.FileInputStream;
import java.io.IOException;
import java.nio.file.Paths;

public class SecurePathTraversal {

    public static void main(String[] args) {
        String userInput = ""../../../../../etc/passwd"";
        String basePath = ""/path/to/files/"";

        // Use Paths.get() to normalize and resolve the paths
        String fullPath = Paths.get(basePath, userInput).normalize().toString();

        // Ensure that the normalized fullPath still starts with basePath
        if (!fullPath.startsWith(basePath)) {
            System.out.println(""Invalid path traversal attempt detected."");
            return;
        }

        try {
            File file = new File(fullPath);
            FileInputStream fis = new FileInputStream(file);

            int data;
            while ((data = fis.read()) != -1) {
                System.out.print((char) data);
            }

            fis.close();
        } catch (IOException e)","To fix the Path Traversal vulnerability in the provided Java code snippet, you need to ensure that the user input does not allow directory traversal beyond the intended base path. One way to achieve this is by validating and sanitizing the user input before constructing the full path. Here is an improved version of the code with proper security measures: ```java import java.io.File; import java.io.FileInputStream; import java.io.IOException; import java.nio.file.Paths; public class SecurePathTraversal { public static void main(String[] args) { String userInput = ""../../../../../etc/passwd""; String basePath = ""/path/to/files/""; // Use Paths.get() to normalize and resolve the paths String fullPath = Paths.get(basePath, userInput).normalize().toString(); // Ensure that the normalized fullPath still starts with basePath if (!fullPath.startsWith(basePath)) { System.out.println(""Invalid path traversal attempt detected.""); return; } try { File file = new File(fullPath); FileInputStream fis = new FileInputStream(file); int data; while ((data = fis.read()) != -1) { System.out.print((char) data); } fis.close(); } catch (IOException e)",java,0
Clear,"const userData = JSON.parse(userInput); // Safe JSON parsing
if (userData && typeof userData === 'object') {
    processUserData(userData);
}
","const userData = JSON.parse(userInput); // Safe JSON parsing
if (userData && typeof userData === 'object') {
    processUserData(userData);
}
",javascript,0
SQL Injection,"<?php
$username = $_POST['username'];
$query = ""SELECT * FROM users WHERE username = '$username'"";
$result = mysql_query($query); // SQL Injection
?>","<?php
$username = $_POST['username'];
$query = ""SELECT * FROM users WHERE username = '$username'"";
$result = mysql_query($query); // SQL Injection
?>",php,1
Clear,"#include <stdio.h>
#include <stdlib.h>

int safe_string_to_int(const char *str) {
    char *endptr;
    long value = strtol(str, &endptr, 10);
    if (*endptr != '\0' || str == endptr) {
        return -1; // error
    }
    return (int)value;
}","#include <stdio.h>
#include <stdlib.h>

int safe_string_to_int(const char *str) {
    char *endptr;
    long value = strtol(str, &endptr, 10);
    if (*endptr != '\0' || str == endptr) {
        return -1; // error
    }
    return (int)value;
}",c,0
SQL Injection,"import psycopg2
def admin_login(admin_id):
    conn = psycopg2.connect(""dbname=test user=postgres"")
    cur = conn.cursor()
    cur.execute(f""SELECT * FROM admins WHERE id = {admin_id}"")
    return cur.fetchone()","import psycopg2
def admin_login(admin_id):
    conn = psycopg2.connect(""dbname=test user=postgres"")
    cur = conn.cursor()
    cur.execute(f""SELECT * FROM admins WHERE id = {admin_id}"")
    return cur.fetchone()",python,1
Clear,"#include <iostream>
#include <memory>

void safe_memory_management() {
    auto ptr = std::make_unique<int>(42);
    std::cout << *ptr << std::endl;
}","#include <iostream>
#include <memory>

void safe_memory_management() {
    auto ptr = std::make_unique<int>(42);
    std::cout << *ptr << std::endl;
}",cpp,0
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Memory Corruption,"#include <iostream>

void unsafe_pointer_arithmetic(int* array, int size) {
    for (int i = 0; i <= size; i++) {
        std::cout << *(array + i) << std::endl; // potential out-of-bounds
    }
}","#include <iostream>

void unsafe_pointer_arithmetic(int* array, int size) {
    for (int i = 0; i <= size; i++) {
        std::cout << *(array + i) << std::endl; // potential out-of-bounds
    }
}",cpp,1
Clear,"#include <iostream>
#include <sstream>

int safe_string_to_int(const std::string& str) {
    std::stringstream ss(str);
    int value;
    if (ss >> value) {
        return value;
    }
    throw std::invalid_argument(""Invalid integer"");
}","#include <iostream>
#include <sstream>

int safe_string_to_int(const std::string& str) {
    std::stringstream ss(str);
    int value;
    if (ss >> value) {
        return value;
    }
    throw std::invalid_argument(""Invalid integer"");
}",cpp,0
Clear,"#include <iostream>
#include <fstream>
#include <string>

void safe_file_reading(const std::string& filename) {
    std::ifstream file(filename);
    if (file.is_open()) {
        std::string line;
        while (std::getline(file, line)) {
            std::cout << line << std::endl;
        }
    }
}","#include <iostream>
#include <fstream>
#include <string>

void safe_file_reading(const std::string& filename) {
    std::ifstream file(filename);
    if (file.is_open()) {
        std::string line;
        while (std::getline(file, line)) {
            std::cout << line << std::endl;
        }
    }
}",cpp,0
Command Injection,"import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class CommandInjectionExample {
    public static void main(String[] args) {
        try {
            // Prompt user for input
            System.out.print(""Enter a hostname to ping: "");
            BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));
            String hostname = reader.readLine();

            // Construct and execute the command
            String command = ""ping -c 4 "" + hostname;
            Process process = Runtime.getRuntime().exec(command);

            // Read and display the output of the command
            BufferedReader inputReader = new BufferedReader(new InputStreamReader(process.getInputStream()));
            String line;
            while ((line = inputReader.readLine()) != null) {
                System.out.println(line);
            }
            
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}","import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class CommandInjectionExample { public static void main(String[] args) { try { // Prompt user for input System.out.print(""Enter a hostname to ping: ""); BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); String hostname = reader.readLine(); // Construct and execute the command String command = ""ping -c 4 "" + hostname; Process process = Runtime.getRuntime().exec(command); // Read and display the output of the command BufferedReader inputReader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = inputReader.readLine()) != null) { System.out.println(line); } } catch (IOException e) { e.printStackTrace(); } } }",java,1
Clear,"#include <iostream>
#include <memory>

void safe_memory_management() {
    auto ptr = std::make_unique<int>(42);
    std::cout << *ptr << std::endl;
}","#include <iostream>
#include <memory>

void safe_memory_management() {
    auto ptr = std::make_unique<int>(42);
    std::cout << *ptr << std::endl;
}",cpp,0
SQL Injection,"import psycopg2
def admin_login(admin_id):
    conn = psycopg2.connect(""dbname=test user=postgres"")
    cur = conn.cursor()
    cur.execute(f""SELECT * FROM admins WHERE id = {admin_id}"")
    return cur.fetchone()","import psycopg2
def admin_login(admin_id):
    conn = psycopg2.connect(""dbname=test user=postgres"")
    cur = conn.cursor()
    cur.execute(f""SELECT * FROM admins WHERE id = {admin_id}"")
    return cur.fetchone()",python,1
Clear,"import tempfile
import os

def create_secure_temp(data):
    with tempfile.NamedTemporaryFile(mode='w', delete=True, suffix='.tmp') as temp:
        temp.write(data)
        temp.flush()
        return temp.name","import tempfile
import os

def create_secure_temp(data):
    with tempfile.NamedTemporaryFile(mode='w', delete=True, suffix='.tmp') as temp:
        temp.write(data)
        temp.flush()
        return temp.name",python,0
Clear,"To fix the Path Traversal vulnerability in the provided Java code snippet, you need to ensure that the user input for the file name does not allow directory traversal. One way to achieve this is by validating the input against a whitelist of allowed characters and rejecting any input that contains directory traversal characters.

Here's an improved version of the code with proper security measures:

```java
import java.io.File;
import java.io.IOException;
import java.nio.file.Files;
import java.nio.file.Paths;
import java.util.Scanner;

public class SecurePathTraversal {

    private static final String BASE_PATH = ""C:\\Users\\Documents\\"";

    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        System.out.print(""Enter file name: "");
        String fileName = scanner.nextLine();

        if (!isValidFileName(fileName)) {
            System.out.println(""Invalid file name."");
            return;
        }

        try {
            File file = new File(BASE_PATH + fileName);
            byte[] fileContent = Files.readAllBytes(Paths.get(file.toURI()));
            String content = new String(fileContent);
            System.out.println(""File content: "" + content);
        } catch (IOException e) {
            System.out.println(""Error reading file:","To fix the Path Traversal vulnerability in the provided Java code snippet, you need to ensure that the user input for the file name does not allow directory traversal. One way to achieve this is by validating the input against a whitelist of allowed characters and rejecting any input that contains directory traversal characters. Here's an improved version of the code with proper security measures: ```java import java.io.File; import java.io.IOException; import java.nio.file.Files; import java.nio.file.Paths; import java.util.Scanner; public class SecurePathTraversal { private static final String BASE_PATH = ""C:\\Users\\Documents\\""; public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter file name: ""); String fileName = scanner.nextLine(); if (!isValidFileName(fileName)) { System.out.println(""Invalid file name.""); return; } try { File file = new File(BASE_PATH + fileName); byte[] fileContent = Files.readAllBytes(Paths.get(file.toURI())); String content = new String(fileContent); System.out.println(""File content: "" + content); } catch (IOException e) { System.out.println(""Error reading file:",java,0
Memory Corruption,"#include <iostream>

void unsafe_virtual_call() {
    // Potential vtable corruption vulnerability
    class Base {
    public:
        virtual void func() { std::cout << ""Base"" << std::endl; }
    };
    
    class Derived : public Base {
    public:
        void func() override { std::cout << ""Derived"" << std::endl; }
    };
}","#include <iostream>

void unsafe_virtual_call() {
    // Potential vtable corruption vulnerability
    class Base {
    public:
        virtual void func() { std::cout << ""Base"" << std::endl; }
    };
    
    class Derived : public Base {
    public:
        void func() override { std::cout << ""Derived"" << std::endl; }
    };
}",cpp,1
Clear,"import re
def validate_email(email):
    pattern = r'^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$'
    return bool(re.match(pattern, email))","import re
def validate_email(email):
    pattern = r'^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$'
    return bool(re.match(pattern, email))",python,0
Clear,"def safe_comment_display(comment_text):
    import html
    escaped_text = html.escape(comment_text)
    return f""<div class='comment'>{escaped_text}</div>"" ","def safe_comment_display(comment_text):
    import html
    escaped_text = html.escape(comment_text)
    return f""<div class='comment'>{escaped_text}</div>"" ",python,0
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Memory Corruption,"#include <iostream>

void unsafe_virtual_call() {
    // Potential vtable corruption vulnerability
    class Base {
    public:
        virtual void func() { std::cout << ""Base"" << std::endl; }
    };
    
    class Derived : public Base {
    public:
        void func() override { std::cout << ""Derived"" << std::endl; }
    };
}","#include <iostream>

void unsafe_virtual_call() {
    // Potential vtable corruption vulnerability
    class Base {
    public:
        virtual void func() { std::cout << ""Base"" << std::endl; }
    };
    
    class Derived : public Base {
    public:
        void func() override { std::cout << ""Derived"" << std::endl; }
    };
}",cpp,1
Clear,"#include <iostream>
#include <memory>

void safe_memory_management() {
    auto ptr = std::make_unique<int>(42);
    std::cout << *ptr << std::endl;
}","#include <iostream>
#include <memory>

void safe_memory_management() {
    auto ptr = std::make_unique<int>(42);
    std::cout << *ptr << std::endl;
}",cpp,0
Clear,"const token = process.env.API_TOKEN; // Environment variable
fetch('/api/data', {
    headers: { 'Authorization': `Bearer ${token}` }
});
","const token = process.env.API_TOKEN; // Environment variable
fetch('/api/data', {
    headers: { 'Authorization': `Bearer ${token}` }
});
",javascript,0
Clear,"To prevent SQL Injection attacks in Java code, it's important to use parameterized queries instead of concatenating user input directly into the SQL query. Here's a secure version of the code snippet:

```java
import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.util.Scanner;

public class SecureSQLInjectionExample {

    public static void main(String[] args) {
        try {
            Scanner scanner = new Scanner(System.in);
            System.out.print(""Enter username: "");
            String username = scanner.nextLine();

            Connection connection = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""root"", ""password"");
            
            // Using prepared statement with parameterized query
            String query = ""SELECT * FROM users WHERE username=?"";
            PreparedStatement preparedStatement = connection.prepareStatement(query);
            
            // Set the parameter for the query
            preparedStatement.setString(1, username);
            
            ResultSet resultSet = preparedStatement.executeQuery();

            while (resultSet.next()) {
                System.out.println(""User ID: "" + resultSet.getInt(""id"") + "", Username: "" + resultSet.getString(""username""));
            }

            resultSet.close();
            preparedStatement.close();
            connection.close();
        } catch (Exception e) {
            e.printStackTrace","To prevent SQL Injection attacks in Java code, it's important to use parameterized queries instead of concatenating user input directly into the SQL query. Here's a secure version of the code snippet: ```java import java.sql.Connection; import java.sql.DriverManager; import java.sql.PreparedStatement; import java.sql.ResultSet; import java.util.Scanner; public class SecureSQLInjectionExample { public static void main(String[] args) { try { Scanner scanner = new Scanner(System.in); System.out.print(""Enter username: ""); String username = scanner.nextLine(); Connection connection = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""root"", ""password""); // Using prepared statement with parameterized query String query = ""SELECT * FROM users WHERE username=?""; PreparedStatement preparedStatement = connection.prepareStatement(query); // Set the parameter for the query preparedStatement.setString(1, username); ResultSet resultSet = preparedStatement.executeQuery(); while (resultSet.next()) { System.out.println(""User ID: "" + resultSet.getInt(""id"") + "", Username: "" + resultSet.getString(""username"")); } resultSet.close(); preparedStatement.close(); connection.close(); } catch (Exception e) { e.printStackTrace",java,0
Cross-Site Scripting (XSS),"from flask import Flask, request
app = Flask(__name__)

@app.route('/search')
def search():
    query = request.args.get('q', '')
    return f'<h1>Search results for: {query}</h1>'","from flask import Flask, request
app = Flask(__name__)

@app.route('/search')
def search():
    query = request.args.get('q', '')
    return f'<h1>Search results for: {query}</h1>'",python,1
XSS,"const userInput = document.location.search.split('=')[1];
document.write(userInput); // XSS
","const userInput = document.location.search.split('=')[1];
document.write(userInput); // XSS
",javascript,1
Insecure Deserialization,"import yaml
def load_config(config_str):
    return yaml.load(config_str, Loader=yaml.Loader)","import yaml
def load_config(config_str):
    return yaml.load(config_str, Loader=yaml.Loader)",python,1
Clear,"import java.io.IOException;
import javax.servlet.http.*;
import org.owasp.encoder.Encode;

public class XssSecureServlet extends HttpServlet {
    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws IOException {
        String userInput = request.getParameter(""input"");
        String safeInput = Encode.forHtml(userInput);
        String output = ""<p>User input: "" + safeInput + ""</p>"";

        response.setContentType(""text/html"");
        response.getWriter().println(output);
    }
}","import java.io.IOException; import javax.servlet.http.*; import org.owasp.encoder.Encode; public class XssSecureServlet extends HttpServlet { protected void doGet(HttpServletRequest request, HttpServletResponse response) throws IOException { String userInput = request.getParameter(""input""); String safeInput = Encode.forHtml(userInput); String output = ""<p>User input: "" + safeInput + ""</p>""; response.setContentType(""text/html""); response.getWriter().println(output); } }",java,0
Insecure Deserialization,"<?php
$data = $_POST['data'];
unserialize($data); // Insecure Deserialization
?>","<?php
$data = $_POST['data'];
unserialize($data); // Insecure Deserialization
?>",php,1
Clear,"const userData = JSON.parse(userInput); // Safe JSON parsing
if (userData && typeof userData === 'object') {
    processUserData(userData);
}
","const userData = JSON.parse(userInput); // Safe JSON parsing
if (userData && typeof userData === 'object') {
    processUserData(userData);
}
",javascript,0
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Cross-Site Scripting (XSS),"def display_comment(comment_text):
    return f""<div class='comment'>{comment_text}</div>"" ","def display_comment(comment_text):
    return f""<div class='comment'>{comment_text}</div>"" ",python,1
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
SQL Injection,"<?php
$username = $_POST['username'];
$query = ""SELECT * FROM users WHERE username = '$username'"";
$result = mysql_query($query); // SQL Injection
?>","<?php
$username = $_POST['username'];
$query = ""SELECT * FROM users WHERE username = '$username'"";
$result = mysql_query($query); // SQL Injection
?>",php,1
Clear,"#include <iostream>
#include <vector>
#include <stdexcept>

int safe_vector_access(const std::vector<int>& vec, size_t index) {
    if (index >= vec.size()) {
        throw std::out_of_range(""Index out of range"");
    }
    return vec[index];
}","#include <iostream>
#include <vector>
#include <stdexcept>

int safe_vector_access(const std::vector<int>& vec, size_t index) {
    if (index >= vec.size()) {
        throw std::out_of_range(""Index out of range"");
    }
    return vec[index];
}",cpp,0
Clear,"#include <stdio.h>
#include <string.h>

void safe_string_copy(char *dest, const char *src, size_t dest_size) {
    if (dest_size > 0) {
        strncpy(dest, src, dest_size - 1);
        dest[dest_size - 1] = '\0';
    }
}","#include <stdio.h>
#include <string.h>

void safe_string_copy(char *dest, const char *src, size_t dest_size) {
    if (dest_size > 0) {
        strncpy(dest, src, dest_size - 1);
        dest[dest_size - 1] = '\0';
    }
}",c,0
Clear,"#include <stdio.h>
#include <stdlib.h>

int safe_string_to_int(const char *str) {
    char *endptr;
    long value = strtol(str, &endptr, 10);
    if (*endptr != '\0' || str == endptr) {
        return -1; // error
    }
    return (int)value;
}","#include <stdio.h>
#include <stdlib.h>

int safe_string_to_int(const char *str) {
    char *endptr;
    long value = strtol(str, &endptr, 10);
    if (*endptr != '\0' || str == endptr) {
        return -1; // error
    }
    return (int)value;
}",c,0
Command Injection,"import java.io.*;

public class CommandInjectionVulnerable {
    public static void main(String[] args) {
        try {
            BufferedReader br = new BufferedReader(new InputStreamReader(System.in));
            System.out.print(""Enter a command to execute: "");
            String command = br.readLine();

            // Vulnerable code - directly executing user input as a command
            Process process = Runtime.getRuntime().exec(command);

            BufferedReader reader = new BufferedReader(new InputStreamReader(process.getInputStream()));
            String line;
            while ((line = reader.readLine()) != null) {
                System.out.println(line);
            }
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}","import java.io.*; public class CommandInjectionVulnerable { public static void main(String[] args) { try { BufferedReader br = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a command to execute: ""); String command = br.readLine(); // Vulnerable code - directly executing user input as a command Process process = Runtime.getRuntime().exec(command); BufferedReader reader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = reader.readLine()) != null) { System.out.println(line); } } catch (IOException e) { e.printStackTrace(); } } }",java,1
Out-of-Bounds,"#include <iostream>

class UnsafeClass {
    int data[10];
public:
    int get_data(int index) {
        return data[index]; // no bounds checking
    }
};","#include <iostream>

class UnsafeClass {
    int data[10];
public:
    int get_data(int index) {
        return data[index]; // no bounds checking
    }
};",cpp,1
Cross-Site Scripting (XSS),"import java.io.IOException;
import java.io.PrintWriter;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

public class VulnerableServlet extends HttpServlet {

    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws IOException {
        String userInput = request.getParameter(""input"");
        
        // Improper handling of user input, directly printing it to the response
        PrintWriter out = response.getWriter();
        out.println(""<html>"");
        out.println(""<body>"");
        out.println(""<h1>Welcome "" + userInput + ""</h1>"");
        out.println(""</body>"");
        out.println(""</html>"");
    }
}","import java.io.IOException; import java.io.PrintWriter; import javax.servlet.http.HttpServlet; import javax.servlet.http.HttpServletRequest; import javax.servlet.http.HttpServletResponse; public class VulnerableServlet extends HttpServlet { protected void doGet(HttpServletRequest request, HttpServletResponse response) throws IOException { String userInput = request.getParameter(""input""); // Improper handling of user input, directly printing it to the response PrintWriter out = response.getWriter(); out.println(""<html>""); out.println(""<body>""); out.println(""<h1>Welcome "" + userInput + ""</h1>""); out.println(""</body>""); out.println(""</html>""); } }",java,1
Command Injection,"<?php
$cmd = $_GET['cmd'];
system($cmd); // Command Injection
?>","<?php
$cmd = $_GET['cmd'];
system($cmd); // Command Injection
?>",php,1
Clear,"const shell = require('child_process');
const safeInput = userInput.replace(/[^a-zA-Z0-9.]/g, '');
shell.execFile('ping', [safeInput]); // Safe command execution
","const shell = require('child_process');
const safeInput = userInput.replace(/[^a-zA-Z0-9.]/g, '');
shell.execFile('ping', [safeInput]); // Safe command execution
",javascript,0
Clear,"#include <iostream>
#include <sstream>

int safe_string_to_int(const std::string& str) {
    std::stringstream ss(str);
    int value;
    if (ss >> value) {
        return value;
    }
    throw std::invalid_argument(""Invalid integer"");
}","#include <iostream>
#include <sstream>

int safe_string_to_int(const std::string& str) {
    std::stringstream ss(str);
    int value;
    if (ss >> value) {
        return value;
    }
    throw std::invalid_argument(""Invalid integer"");
}",cpp,0
Clear,"To fix the insecure code snippet for Command Injection in Java, you need to properly validate and sanitize the user input before executing it as a command. Here is an improved version of the code with security measures in place:

```java
import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class CommandInjectionSecure {
    public static void main(String[] args) throws IOException {
        BufferedReader br = new BufferedReader(new InputStreamReader(System.in));

        System.out.print(""Enter a command to execute: "");
        String command = br.readLine();

        if (!isValidCommand(command)) {
            System.out.println(""Invalid command. Please try again."");
            return;
        }

        Process process = Runtime.getRuntime().exec(command);

        BufferedReader reader = new BufferedReader(new InputStreamReader(process.getInputStream()));
        String line;

        while ((line = reader.readLine()) != null) {
            System.out.println(line);
        }
    }

    private static boolean isValidCommand(String command) {
        // Implement proper validation/sanitization logic here
        // For example, allow only certain whitelisted commands or patterns
        // You can also check for specific keywords to prevent injection

        // For demonstration purposes, let's allow only 'ls' and 'pwd' commands","To fix the insecure code snippet for Command Injection in Java, you need to properly validate and sanitize the user input before executing it as a command. Here is an improved version of the code with security measures in place: ```java import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class CommandInjectionSecure { public static void main(String[] args) throws IOException { BufferedReader br = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a command to execute: ""); String command = br.readLine(); if (!isValidCommand(command)) { System.out.println(""Invalid command. Please try again.""); return; } Process process = Runtime.getRuntime().exec(command); BufferedReader reader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = reader.readLine()) != null) { System.out.println(line); } } private static boolean isValidCommand(String command) { // Implement proper validation/sanitization logic here // For example, allow only certain whitelisted commands or patterns // You can also check for specific keywords to prevent injection // For demonstration purposes, let's allow only 'ls' and 'pwd' commands",java,0
SQL Injection,"import java.sql.*;

public class SQLInjectionExample {
    public static void main(String[] args) {
        String userInput = ""'; DROP TABLE users; --"";
        
        try {
            Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");
            Statement stmt = conn.createStatement();
            
            String query = ""SELECT * FROM users WHERE username = '"" + userInput + ""'"";
            
            ResultSet rs = stmt.executeQuery(query);
            
            while (rs.next()) {
                System.out.println(""Username: "" + rs.getString(""username""));
                System.out.println(""Password: "" + rs.getString(""password""));
            }
            
            conn.close();
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.*; public class SQLInjectionExample { public static void main(String[] args) { String userInput = ""'; DROP TABLE users; --""; try { Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); Statement stmt = conn.createStatement(); String query = ""SELECT * FROM users WHERE username = '"" + userInput + ""'""; ResultSet rs = stmt.executeQuery(query); while (rs.next()) { System.out.println(""Username: "" + rs.getString(""username"")); System.out.println(""Password: "" + rs.getString(""password"")); } conn.close(); } catch (SQLException e) { e.printStackTrace(); } } }",java,1
Clear,"#include <stdio.h>
#include <stdlib.h>

int safe_string_to_int(const char *str) {
    char *endptr;
    long value = strtol(str, &endptr, 10);
    if (*endptr != '\0' || str == endptr) {
        return -1; // error
    }
    return (int)value;
}","#include <stdio.h>
#include <stdlib.h>

int safe_string_to_int(const char *str) {
    char *endptr;
    long value = strtol(str, &endptr, 10);
    if (*endptr != '\0' || str == endptr) {
        return -1; // error
    }
    return (int)value;
}",c,0
Clear,"const shell = require('child_process');
const safeInput = userInput.replace(/[^a-zA-Z0-9.]/g, '');
shell.execFile('ping', [safeInput]); // Safe command execution
","const shell = require('child_process');
const safeInput = userInput.replace(/[^a-zA-Z0-9.]/g, '');
shell.execFile('ping', [safeInput]); // Safe command execution
",javascript,0
Clear,"app.get('/user/:id', (req, res) => {
    const userId = parseInt(req.params.id);
    db.query('SELECT * FROM users WHERE id = ?', [userId], (err, result) => {
        res.json(result);
    });
});
","app.get('/user/:id', (req, res) => {
    const userId = parseInt(req.params.id);
    db.query('SELECT * FROM users WHERE id = ?', [userId], (err, result) => {
        res.json(result);
    });
});
",javascript,0
Clear,"app.get('/user/:id', (req, res) => {
    const userId = parseInt(req.params.id);
    db.query('SELECT * FROM users WHERE id = ?', [userId], (err, result) => {
        res.json(result);
    });
});
","app.get('/user/:id', (req, res) => {
    const userId = parseInt(req.params.id);
    db.query('SELECT * FROM users WHERE id = ?', [userId], (err, result) => {
        res.json(result);
    });
});
",javascript,0
Clear,"#include <stdio.h>
#include <stdlib.h>

int safe_string_to_int(const char *str) {
    char *endptr;
    long value = strtol(str, &endptr, 10);
    if (*endptr != '\0' || str == endptr) {
        return -1; // error
    }
    return (int)value;
}","#include <stdio.h>
#include <stdlib.h>

int safe_string_to_int(const char *str) {
    char *endptr;
    long value = strtol(str, &endptr, 10);
    if (*endptr != '\0' || str == endptr) {
        return -1; // error
    }
    return (int)value;
}",c,0
Clear,"import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.util.Scanner;

public class SecureSQLQuery {

    public static void main(String[] args) {
        try {
            Scanner scanner = new Scanner(System.in);
            System.out.println(""Enter username: "");
            String userInput = scanner.nextLine();

            String query = ""SELECT * FROM users WHERE username = ?"";
            
            Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""root"", ""password"");
            
            PreparedStatement pstmt = conn.prepareStatement(query);
            pstmt.setString(1, userInput);
            
            ResultSet rs = pstmt.executeQuery();
            
            while (rs.next()) {
                System.out.println(""User found: "" + rs.getString(""username""));
            }
            
            rs.close();
            pstmt.close();
            conn.close();

        } catch (Exception e) {
            e.printStackTrace();
        }
    }

}","import java.sql.Connection; import java.sql.DriverManager; import java.sql.PreparedStatement; import java.sql.ResultSet; import java.util.Scanner; public class SecureSQLQuery { public static void main(String[] args) { try { Scanner scanner = new Scanner(System.in); System.out.println(""Enter username: ""); String userInput = scanner.nextLine(); String query = ""SELECT * FROM users WHERE username = ?""; Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""root"", ""password""); PreparedStatement pstmt = conn.prepareStatement(query); pstmt.setString(1, userInput); ResultSet rs = pstmt.executeQuery(); while (rs.next()) { System.out.println(""User found: "" + rs.getString(""username"")); } rs.close(); pstmt.close(); conn.close(); } catch (Exception e) { e.printStackTrace(); } } }",java,0
Clear,"#include <stdio.h>
#include <string.h>

int safe_buffer_operation(char *input) {
    char buffer[100];
    if (strlen(input) < sizeof(buffer)) {
        strcpy(buffer, input);
        return 0;
    }
    return -1; // buffer too small
}","#include <stdio.h>
#include <string.h>

int safe_buffer_operation(char *input) {
    char buffer[100];
    if (strlen(input) < sizeof(buffer)) {
        strcpy(buffer, input);
        return 0;
    }
    return -1; // buffer too small
}",c,0
XSS,"const userInput = document.location.search.split('=')[1];
document.write(userInput); // XSS
","const userInput = document.location.search.split('=')[1];
document.write(userInput); // XSS
",javascript,1
Clear,"import jwt
import os
from datetime import datetime, timedelta

def create_safe_token(user_id):
    payload = {
        'user_id': user_id,
        'exp': datetime.utcnow() + timedelta(hours=1)
    }
    secret = os.environ.get('JWT_SECRET')
    return jwt.encode(payload, secret, algorithm='HS256')","import jwt
import os
from datetime import datetime, timedelta

def create_safe_token(user_id):
    payload = {
        'user_id': user_id,
        'exp': datetime.utcnow() + timedelta(hours=1)
    }
    secret = os.environ.get('JWT_SECRET')
    return jwt.encode(payload, secret, algorithm='HS256')",python,0
Hardcoded Secrets,"localStorage.setItem('token', 'hardcoded-secret-token-123'); // Hardcoded secret
","localStorage.setItem('token', 'hardcoded-secret-token-123'); // Hardcoded secret
",javascript,1
Insecure Deserialization,"import pickle
def load_user_data(filename):
    with open(filename, 'rb') as f:
        data = pickle.load(f)
    return data","import pickle
def load_user_data(filename):
    with open(filename, 'rb') as f:
        data = pickle.load(f)
    return data",python,1
Cross-Site Scripting (XSS),"import java.io.IOException;
import java.io.PrintWriter;
import javax.servlet.ServletException;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

public class XSSVulnerableServlet extends HttpServlet {
    protected void doGet(HttpServletRequest request, HttpServletResponse response)
            throws ServletException, IOException {
        String userInput = request.getParameter(""input"");
        
        // Vulnerable code: user input is directly inserted into the response without proper sanitization
        response.setContentType(""text/html"");
        PrintWriter out = response.getWriter();
        out.println(""<html><body>"");
        out.println(""<h1>User Input: "" + userInput + ""</h1>"");
        out.println(""</body></html>"");
    }
}","import java.io.IOException; import java.io.PrintWriter; import javax.servlet.ServletException; import javax.servlet.http.HttpServlet; import javax.servlet.http.HttpServletRequest; import javax.servlet.http.HttpServletResponse; public class XSSVulnerableServlet extends HttpServlet { protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { String userInput = request.getParameter(""input""); // Vulnerable code: user input is directly inserted into the response without proper sanitization response.setContentType(""text/html""); PrintWriter out = response.getWriter(); out.println(""<html><body>""); out.println(""<h1>User Input: "" + userInput + ""</h1>""); out.println(""</body></html>""); } }",java,1
Code Injection,"const userData = eval('(' + userInput + ')'); // eval injection
","const userData = eval('(' + userInput + ')'); // eval injection
",javascript,1
Clear,"from flask import Flask, request
import html
app = Flask(__name__)

@app.route('/search_safe')
def search_safe():
    query = request.args.get('q', '')
    safe_query = html.escape(query)
    return f'<h1>Search results for: {safe_query}</h1>'","from flask import Flask, request
import html
app = Flask(__name__)

@app.route('/search_safe')
def search_safe():
    query = request.args.get('q', '')
    safe_query = html.escape(query)
    return f'<h1>Search results for: {safe_query}</h1>'",python,0
Cross-Site Scripting (XSS),"import java.io.*;
import javax.servlet.*;
import javax.servlet.http.*;

public class XSSVulnerableServlet extends HttpServlet {
    protected void doPost(HttpServletRequest request, HttpServletResponse response)
            throws ServletException, IOException {
        
        String userInput = request.getParameter(""input"");
        
        String output = ""<html><body>User input: "" + userInput + ""</body></html>"";
        
        PrintWriter out = response.getWriter();
        out.println(output);
    }
}","import java.io.*; import javax.servlet.*; import javax.servlet.http.*; public class XSSVulnerableServlet extends HttpServlet { protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { String userInput = request.getParameter(""input""); String output = ""<html><body>User input: "" + userInput + ""</body></html>""; PrintWriter out = response.getWriter(); out.println(output); } }",java,1
Command Injection,"<?php
$cmd = $_GET['cmd'];
system($cmd); // Command Injection
?>","<?php
$cmd = $_GET['cmd'];
system($cmd); // Command Injection
?>",php,1
Cross-Site Scripting (XSS),"from flask import Flask, request
app = Flask(__name__)

@app.route('/search')
def search():
    query = request.args.get('q', '')
    return f'<h1>Search results for: {query}</h1>'","from flask import Flask, request
app = Flask(__name__)

@app.route('/search')
def search():
    query = request.args.get('q', '')
    return f'<h1>Search results for: {query}</h1>'",python,1
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Clear,"#include <stdio.h>
#include <stdlib.h>

int safe_string_to_int(const char *str) {
    char *endptr;
    long value = strtol(str, &endptr, 10);
    if (*endptr != '\0' || str == endptr) {
        return -1; // error
    }
    return (int)value;
}","#include <stdio.h>
#include <stdlib.h>

int safe_string_to_int(const char *str) {
    char *endptr;
    long value = strtol(str, &endptr, 10);
    if (*endptr != '\0' || str == endptr) {
        return -1; // error
    }
    return (int)value;
}",c,0
SQL Injection,"app.get('/user/:id', (req, res) => {
    const query = `SELECT * FROM users WHERE id = ${req.params.id}`; // SQL Injection
    db.query(query, (err, result) => {
        res.json(result);
    });
});
","app.get('/user/:id', (req, res) => {
    const query = `SELECT * FROM users WHERE id = ${req.params.id}`; // SQL Injection
    db.query(query, (err, result) => {
        res.json(result);
    });
});
",javascript,1
Clear,"#include <iostream>
#include <sstream>

int safe_string_to_int(const std::string& str) {
    std::stringstream ss(str);
    int value;
    if (ss >> value) {
        return value;
    }
    throw std::invalid_argument(""Invalid integer"");
}","#include <iostream>
#include <sstream>

int safe_string_to_int(const std::string& str) {
    std::stringstream ss(str);
    int value;
    if (ss >> value) {
        return value;
    }
    throw std::invalid_argument(""Invalid integer"");
}",cpp,0
Clear,"To prevent Cross-Site Scripting (XSS) attacks in the provided Java servlet code, you need to sanitize the user input before including it in the HTML response. One common approach is to escape special characters that could be interpreted as HTML or JavaScript code. Here's how you can fix the code:

```java
import java.io.IOException;
import java.io.PrintWriter;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

public class XSSFixedServlet extends HttpServlet {

    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws IOException {
        String userInput = request.getParameter(""input"");
        
        // Sanitize user input to prevent XSS
        String sanitizedInput = escapeHtml(userInput);
        
        PrintWriter out = response.getWriter();
        out.println(""<html>"");
        out.println(""<body>"");
        out.println(""<h1>Hello, "" + sanitizedInput + ""</h1>"");
        out.println(""</body>"");
        out.println(""</html>"");
    }

    private String escapeHtml(String input) {
        return input != null ? input
            .replace(""&"", ""&amp;"")
            .replace(""<"", ""&lt;"")
            .replace("">"", ""&gt;"")
            .replace(""\"""", ""&quot;"")
            .replace(""'"", ""&#39;","To prevent Cross-Site Scripting (XSS) attacks in the provided Java servlet code, you need to sanitize the user input before including it in the HTML response. One common approach is to escape special characters that could be interpreted as HTML or JavaScript code. Here's how you can fix the code: ```java import java.io.IOException; import java.io.PrintWriter; import javax.servlet.http.HttpServlet; import javax.servlet.http.HttpServletRequest; import javax.servlet.http.HttpServletResponse; public class XSSFixedServlet extends HttpServlet { protected void doGet(HttpServletRequest request, HttpServletResponse response) throws IOException { String userInput = request.getParameter(""input""); // Sanitize user input to prevent XSS String sanitizedInput = escapeHtml(userInput); PrintWriter out = response.getWriter(); out.println(""<html>""); out.println(""<body>""); out.println(""<h1>Hello, "" + sanitizedInput + ""</h1>""); out.println(""</body>""); out.println(""</html>""); } private String escapeHtml(String input) { return input != null ? input .replace(""&"", ""&amp;"") .replace(""<"", ""&lt;"") .replace("">"", ""&gt;"") .replace(""\"""", ""&quot;"") .replace(""'"", ""&#39;",java,0
Command Injection,"<?php
$cmd = $_GET['cmd'];
system($cmd); // Command Injection
?>","<?php
$cmd = $_GET['cmd'];
system($cmd); // Command Injection
?>",php,1
SQL Injection,"import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.ResultSet;
import java.sql.Statement;
import java.util.Scanner;

public class SQLInjectionVulnerability {

    public static void main(String[] args) {
        try {
            Scanner scanner = new Scanner(System.in);
            System.out.println(""Enter a user ID to fetch data:"");
            String userId = scanner.nextLine();

            Connection connection = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");
            Statement statement = connection.createStatement();
            
            // Vulnerable code - user input is directly concatenated into the SQL query
            String query = ""SELECT * FROM users WHERE id="" + userId;

            ResultSet resultSet = statement.executeQuery(query);
            
            while (resultSet.next()) {
                System.out.println(""Username: "" + resultSet.getString(""username""));
                System.out.println(""Email: "" + resultSet.getString(""email""));
            }

        } catch (Exception e) {
            e.printStackTrace();
        }
    }
}","import java.sql.Connection; import java.sql.DriverManager; import java.sql.ResultSet; import java.sql.Statement; import java.util.Scanner; public class SQLInjectionVulnerability { public static void main(String[] args) { try { Scanner scanner = new Scanner(System.in); System.out.println(""Enter a user ID to fetch data:""); String userId = scanner.nextLine(); Connection connection = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); Statement statement = connection.createStatement(); // Vulnerable code - user input is directly concatenated into the SQL query String query = ""SELECT * FROM users WHERE id="" + userId; ResultSet resultSet = statement.executeQuery(query); while (resultSet.next()) { System.out.println(""Username: "" + resultSet.getString(""username"")); System.out.println(""Email: "" + resultSet.getString(""email"")); } } catch (Exception e) { e.printStackTrace(); } } }",java,1
Hardcoded Secrets,"DATABASE_PASSWORD = ""my_super_secret_password_123""
def db_connect():
    import psycopg2
    return psycopg2.connect(f""dbname=test user=admin password={DATABASE_PASSWORD}"")","DATABASE_PASSWORD = ""my_super_secret_password_123""
def db_connect():
    import psycopg2
    return psycopg2.connect(f""dbname=test user=admin password={DATABASE_PASSWORD}"")",python,1
Command Injection,"import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class CommandInjectionVulnerability {

    public static void main(String[] args) {
        try {
            BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));
            System.out.print(""Enter a command to execute: "");
            String userInput = reader.readLine();

            // Vulnerable code - directly executing user input as a command
            Process process = Runtime.getRuntime().exec(userInput);

            BufferedReader inputReader = new BufferedReader(new InputStreamReader(process.getInputStream()));
            String line;
            while ((line = inputReader.readLine()) != null) {
                System.out.println(line);
            }
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}","import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class CommandInjectionVulnerability { public static void main(String[] args) { try { BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a command to execute: ""); String userInput = reader.readLine(); // Vulnerable code - directly executing user input as a command Process process = Runtime.getRuntime().exec(userInput); BufferedReader inputReader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = inputReader.readLine()) != null) { System.out.println(line); } } catch (IOException e) { e.printStackTrace(); } } }",java,1
Clear,"String username = getUserInput(); // Assume this function gets user input
String query = ""SELECT * FROM users WHERE username=?"";
PreparedStatement statement = connection.prepareStatement(query);
statement.setString(1, username);
ResultSet resultSet = statement.executeQuery();","String username = getUserInput(); // Assume this function gets user input String query = ""SELECT * FROM users WHERE username=?""; PreparedStatement statement = connection.prepareStatement(query); statement.setString(1, username); ResultSet resultSet = statement.executeQuery();",javascript,0
File Inclusion,"<?php
$file = $_GET['file'];
include($file); // File Inclusion
?>","<?php
$file = $_GET['file'];
include($file); // File Inclusion
?>",php,1
XSS,"const userInput = document.location.search.split('=')[1];
document.write(userInput); // XSS
","const userInput = document.location.search.split('=')[1];
document.write(userInput); // XSS
",javascript,1
SQL Injection,"<?php
$username = $_POST['username'];
$query = ""SELECT * FROM users WHERE username = '$username'"";
$result = mysql_query($query); // SQL Injection
?>","<?php
$username = $_POST['username'];
$query = ""SELECT * FROM users WHERE username = '$username'"";
$result = mysql_query($query); // SQL Injection
?>",php,1
Clear,"import mysql.connector
def safe_product_search(category):
    db = mysql.connector.connect(host=""localhost"", user=""user"", password=""pass"", database=""shop"")
    cursor = db.cursor()
    cursor.execute(""SELECT * FROM products WHERE category = %s"", (category,))
    return cursor.fetchall()","import mysql.connector
def safe_product_search(category):
    db = mysql.connector.connect(host=""localhost"", user=""user"", password=""pass"", database=""shop"")
    cursor = db.cursor()
    cursor.execute(""SELECT * FROM products WHERE category = %s"", (category,))
    return cursor.fetchall()",python,0
Path Traversal,"import java.io.BufferedReader;
import java.io.File;
import java.io.FileReader;
import java.io.IOException;

public class PathTraversalVulnerability {

    public static void main(String[] args) {
        String userInput = ""../../etc/passwd"";
        String basePath = ""/var/data/"";

        String filePath = basePath + userInput;

        try {
            File file = new File(filePath);
            BufferedReader reader = new BufferedReader(new FileReader(file));

            String line;
            while ((line = reader.readLine()) != null) {
                System.out.println(line);
            }

            reader.close();
        } catch (IOException e) {
            System.out.println(""Error reading file: "" + e.getMessage());
        }
    }
}","import java.io.BufferedReader; import java.io.File; import java.io.FileReader; import java.io.IOException; public class PathTraversalVulnerability { public static void main(String[] args) { String userInput = ""../../etc/passwd""; String basePath = ""/var/data/""; String filePath = basePath + userInput; try { File file = new File(filePath); BufferedReader reader = new BufferedReader(new FileReader(file)); String line; while ((line = reader.readLine()) != null) { System.out.println(line); } reader.close(); } catch (IOException e) { System.out.println(""Error reading file: "" + e.getMessage()); } } }",java,1
Command Injection,"import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class CommandInjectionVulnerability {
    public static void main(String[] args) throws IOException {
        BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));

        System.out.print(""Enter a directory name: "");
        String directoryName = reader.readLine();

        // Vulnerable code - User input directly used in a command
        String command = ""ls "" + directoryName;
        
        Process process = Runtime.getRuntime().exec(command);
        
        BufferedReader processOutputReader = new BufferedReader(new InputStreamReader(process.getInputStream()));
        String line;
        while ((line = processOutputReader.readLine()) != null) {
            System.out.println(line);
        }
    }
}","import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class CommandInjectionVulnerability { public static void main(String[] args) throws IOException { BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a directory name: ""); String directoryName = reader.readLine(); // Vulnerable code - User input directly used in a command String command = ""ls "" + directoryName; Process process = Runtime.getRuntime().exec(command); BufferedReader processOutputReader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = processOutputReader.readLine()) != null) { System.out.println(line); } } }",java,1
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Hardcoded Secrets,"DATABASE_PASSWORD = ""my_super_secret_password_123""
def db_connect():
    import psycopg2
    return psycopg2.connect(f""dbname=test user=admin password={DATABASE_PASSWORD}"")","DATABASE_PASSWORD = ""my_super_secret_password_123""
def db_connect():
    import psycopg2
    return psycopg2.connect(f""dbname=test user=admin password={DATABASE_PASSWORD}"")",python,1
Command Injection,"import os
def backup_database(db_name):
    os.system(f""pg_dump {db_name} > backup.sql"")","import os
def backup_database(db_name):
    os.system(f""pg_dump {db_name} > backup.sql"")",python,1
Clear,"<?php
$file = basename($_GET['file']);
$allowed = ['page1.php', 'page2.php'];
if (in_array($file, $allowed)) {
    include($file);
}
?>","<?php
$file = basename($_GET['file']);
$allowed = ['page1.php', 'page2.php'];
if (in_array($file, $allowed)) {
    include($file);
}
?>",php,0
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Cross-Site Scripting (XSS),"import java.io.*;
import javax.servlet.*;
import javax.servlet.http.*;

public class XSSVulnerableServlet extends HttpServlet {
    public void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        String userInput = request.getParameter(""input"");
        String output = ""<p>User input: "" + userInput + ""</p>"";
        
        response.setContentType(""text/html"");
        PrintWriter out = response.getWriter();
        out.println(""<html>"");
        out.println(""<head><title>XSS Vulnerable Page</title></head>"");
        out.println(""<body>"");
        out.println(output); // User input is directly outputted without proper encoding
        out.println(""</body>"");
        out.println(""</html>"");
    }
}","import java.io.*; import javax.servlet.*; import javax.servlet.http.*; public class XSSVulnerableServlet extends HttpServlet { public void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { String userInput = request.getParameter(""input""); String output = ""<p>User input: "" + userInput + ""</p>""; response.setContentType(""text/html""); PrintWriter out = response.getWriter(); out.println(""<html>""); out.println(""<head><title>XSS Vulnerable Page</title></head>""); out.println(""<body>""); out.println(output); // User input is directly outputted without proper encoding out.println(""</body>""); out.println(""</html>""); } }",java,1
Clear,"#include <stdio.h>
#include <stdlib.h>

void safe_file_operation(const char *filename) {
    FILE *file = fopen(filename, ""r"");
    if (file != NULL) {
        char buffer[256];
        while (fgets(buffer, sizeof(buffer), file)) {
            printf(""%s"", buffer);
        }
        fclose(file);
    }
}","#include <stdio.h>
#include <stdlib.h>

void safe_file_operation(const char *filename) {
    FILE *file = fopen(filename, ""r"");
    if (file != NULL) {
        char buffer[256];
        while (fgets(buffer, sizeof(buffer), file)) {
            printf(""%s"", buffer);
        }
        fclose(file);
    }
}",c,0
Clear,"import pickle
def safe_deserialize(data):
    allowed_classes = {'SafeClass', 'AnotherSafeClass'}
    return pickle.loads(data)","import pickle
def safe_deserialize(data):
    allowed_classes = {'SafeClass', 'AnotherSafeClass'}
    return pickle.loads(data)",python,0
Clear,"<?php
$input = json_decode($_POST['data'], true); // Safe JSON parsing
if (json_last_error() === JSON_ERROR_NONE) {
    process_data($input);
}
?>","<?php
$input = json_decode($_POST['data'], true); // Safe JSON parsing
if (json_last_error() === JSON_ERROR_NONE) {
    process_data($input);
}
?>",php,0
Buffer Overflow,"import java.util.Scanner;

public class BufferOverflowVulnerability {
    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        System.out.print(""Enter your name: "");
        String name = scanner.nextLine();

        // Vulnerability: Improper handling of user input may lead to buffer overflow
        char[] buffer = new char[10];
        int length = name.length();
        
        if (length <= 10) {
            name.getChars(0, length, buffer, 0);
            System.out.println(""Hello, "" + String.valueOf(buffer));
        } else {
            System.out.println(""Input exceeds buffer size!"");
        }
        
    }
}","import java.util.Scanner; public class BufferOverflowVulnerability { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter your name: ""); String name = scanner.nextLine(); // Vulnerability: Improper handling of user input may lead to buffer overflow char[] buffer = new char[10]; int length = name.length(); if (length <= 10) { name.getChars(0, length, buffer, 0); System.out.println(""Hello, "" + String.valueOf(buffer)); } else { System.out.println(""Input exceeds buffer size!""); } } }",java,1
Clear,"To fix the Command Injection vulnerability in the given Java code snippet, we need to ensure that user input is properly sanitized and validated before being used to execute commands. Here is an example of a more secure version of the code that mitigates the Command Injection vulnerability:

```java
import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class SecureCommandExecution {

    public static void main(String[] args) {
        try {
            BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));
            System.out.print(""Enter a command to execute: "");
            String command = reader.readLine();

            // Sanitize and validate user input command
            if (!isValidCommand(command)) {
                System.out.println(""Invalid command"");
                return;
            }

            // Execute the validated command using ProcessBuilder
            ProcessBuilder processBuilder = new ProcessBuilder(command.split("" ""));
            Process process = processBuilder.start();

            // Read the output of the executed command
            BufferedReader outputReader = new BufferedReader(new InputStreamReader(process.getInputStream()));
            String line;
            while ((line = outputReader.readLine()) != null) {
                System.out.println(line);
            }

        } catch (IOException e) {
            e.printStackTrace();
        }
    }

    private static boolean isValidCommand","To fix the Command Injection vulnerability in the given Java code snippet, we need to ensure that user input is properly sanitized and validated before being used to execute commands. Here is an example of a more secure version of the code that mitigates the Command Injection vulnerability: ```java import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class SecureCommandExecution { public static void main(String[] args) { try { BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a command to execute: ""); String command = reader.readLine(); // Sanitize and validate user input command if (!isValidCommand(command)) { System.out.println(""Invalid command""); return; } // Execute the validated command using ProcessBuilder ProcessBuilder processBuilder = new ProcessBuilder(command.split("" "")); Process process = processBuilder.start(); // Read the output of the executed command BufferedReader outputReader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = outputReader.readLine()) != null) { System.out.println(line); } } catch (IOException e) { e.printStackTrace(); } } private static boolean isValidCommand",java,0
Out-of-Bounds,"#include <iostream>

class UnsafeClass {
    int data[10];
public:
    int get_data(int index) {
        return data[index]; // no bounds checking
    }
};","#include <iostream>

class UnsafeClass {
    int data[10];
public:
    int get_data(int index) {
        return data[index]; // no bounds checking
    }
};",cpp,1
Clear,"import java.sql.*;

public class SecureSQLQuery {
    public static void main(String[] args) {
        String userInput = ""admin'; DROP TABLE users; --"";

        try {
            Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");
            
            // Use PreparedStatement to avoid SQL Injection
            String query = ""SELECT * FROM users WHERE username=?"";
            PreparedStatement pstmt = conn.prepareStatement(query);
            pstmt.setString(1, userInput);
            
            ResultSet rs = pstmt.executeQuery();
            
            while (rs.next()) {
                System.out.println(rs.getString(""username""));
            }
            
            conn.close();
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.*; public class SecureSQLQuery { public static void main(String[] args) { String userInput = ""admin'; DROP TABLE users; --""; try { Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); // Use PreparedStatement to avoid SQL Injection String query = ""SELECT * FROM users WHERE username=?""; PreparedStatement pstmt = conn.prepareStatement(query); pstmt.setString(1, userInput); ResultSet rs = pstmt.executeQuery(); while (rs.next()) { System.out.println(rs.getString(""username"")); } conn.close(); } catch (SQLException e) { e.printStackTrace(); } } }",java,0
Clear,"import requests
def safe_fetch_url(url):
    allowed_domains = ['example.com', 'api.trusted.com']
    from urllib.parse import urlparse
    domain = urlparse(url).netloc
    if domain not in allowed_domains:
        raise ValueError(""Domain not allowed"")
    return requests.get(url).text","import requests
def safe_fetch_url(url):
    allowed_domains = ['example.com', 'api.trusted.com']
    from urllib.parse import urlparse
    domain = urlparse(url).netloc
    if domain not in allowed_domains:
        raise ValueError(""Domain not allowed"")
    return requests.get(url).text",python,0
Memory Corruption,"#include <iostream>

void unsafe_virtual_call() {
    // Potential vtable corruption vulnerability
    class Base {
    public:
        virtual void func() { std::cout << ""Base"" << std::endl; }
    };
    
    class Derived : public Base {
    public:
        void func() override { std::cout << ""Derived"" << std::endl; }
    };
}","#include <iostream>

void unsafe_virtual_call() {
    // Potential vtable corruption vulnerability
    class Base {
    public:
        virtual void func() { std::cout << ""Base"" << std::endl; }
    };
    
    class Derived : public Base {
    public:
        void func() override { std::cout << ""Derived"" << std::endl; }
    };
}",cpp,1
Clear,"#include <stdio.h>
#include <stdlib.h>

void safe_file_operation(const char *filename) {
    FILE *file = fopen(filename, ""r"");
    if (file != NULL) {
        char buffer[256];
        while (fgets(buffer, sizeof(buffer), file)) {
            printf(""%s"", buffer);
        }
        fclose(file);
    }
}","#include <stdio.h>
#include <stdlib.h>

void safe_file_operation(const char *filename) {
    FILE *file = fopen(filename, ""r"");
    if (file != NULL) {
        char buffer[256];
        while (fgets(buffer, sizeof(buffer), file)) {
            printf(""%s"", buffer);
        }
        fclose(file);
    }
}",c,0
Memory Corruption,"#include <iostream>

void unsafe_virtual_call() {
    // Potential vtable corruption vulnerability
    class Base {
    public:
        virtual void func() { std::cout << ""Base"" << std::endl; }
    };
    
    class Derived : public Base {
    public:
        void func() override { std::cout << ""Derived"" << std::endl; }
    };
}","#include <iostream>

void unsafe_virtual_call() {
    // Potential vtable corruption vulnerability
    class Base {
    public:
        virtual void func() { std::cout << ""Base"" << std::endl; }
    };
    
    class Derived : public Base {
    public:
        void func() override { std::cout << ""Derived"" << std::endl; }
    };
}",cpp,1
Clear,"To secure the code against insecure deserialization vulnerabilities, you should implement proper validation and filtering mechanisms before deserializing the input. Here's an updated version of the code with security measures in place:

```java
import java.io.*;
import java.util.Base64;

public class SecureDeserializationExample {

    public static void main(String[] args) {
        try {
            String userInput = ""rO0ABXNyACZqYXZhLnV0aWwuRGVzZXJ2aWV3SGFzaFNldNhp7e4fAwABTAADdHdvcnQAAltCrPMX"";
            byte[] serializedObject = Base64.getDecoder().decode(userInput);

            // Implement input validation and filtering
            if (!isValidSerializedObject(serializedObject)) {
                System.out.println(""Invalid serialized object"");
                return;
            }

            ByteArrayInputStream bais = new ByteArrayInputStream(serializedObject);
            ObjectInputStream ois = new ObjectInputStream(bais);

            Object obj = ois.readObject();

            // Perform additional security checks on the deserialized object if needed

            System.out.println(obj.toString());

        } catch (IOException | ClassNotFoundException e) {
            e.printStackTrace();
        }
    }","To secure the code against insecure deserialization vulnerabilities, you should implement proper validation and filtering mechanisms before deserializing the input. Here's an updated version of the code with security measures in place: ```java import java.io.*; import java.util.Base64; public class SecureDeserializationExample { public static void main(String[] args) { try { String userInput = ""rO0ABXNyACZqYXZhLnV0aWwuRGVzZXJ2aWV3SGFzaFNldNhp7e4fAwABTAADdHdvcnQAAltCrPMX""; byte[] serializedObject = Base64.getDecoder().decode(userInput); // Implement input validation and filtering if (!isValidSerializedObject(serializedObject)) { System.out.println(""Invalid serialized object""); return; } ByteArrayInputStream bais = new ByteArrayInputStream(serializedObject); ObjectInputStream ois = new ObjectInputStream(bais); Object obj = ois.readObject(); // Perform additional security checks on the deserialized object if needed System.out.println(obj.toString()); } catch (IOException | ClassNotFoundException e) { e.printStackTrace(); } }",java,0
Clear,"import java.util.Scanner;

public class SecureBufferUsage {
    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        
        System.out.print(""Enter a string: "");
        String userInput = scanner.nextLine(); // Read entire line
        
        int maxLength = 10;
        
        if (userInput.length() > maxLength) {
            System.out.println(""Input string exceeds maximum length of "" + maxLength + "". Truncating..."");
            userInput = userInput.substring(0, maxLength); // Truncate input if it exceeds max length
        }
        
        char[] buffer = new char[maxLength];
        userInput.getChars(0, userInput.length(), buffer, 0);
        
        System.out.println(""Buffer contents: "" + new String(buffer));
    }
}","import java.util.Scanner; public class SecureBufferUsage { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter a string: ""); String userInput = scanner.nextLine(); // Read entire line int maxLength = 10; if (userInput.length() > maxLength) { System.out.println(""Input string exceeds maximum length of "" + maxLength + "". Truncating...""); userInput = userInput.substring(0, maxLength); // Truncate input if it exceeds max length } char[] buffer = new char[maxLength]; userInput.getChars(0, userInput.length(), buffer, 0); System.out.println(""Buffer contents: "" + new String(buffer)); } }",java,0
SQL Injection,"import sqlite3
def get_user_data(username):
    conn = sqlite3.connect('database.db')
    cursor = conn.cursor()
    query = ""SELECT * FROM users WHERE username = '"" + username + ""'""
    cursor.execute(query)
    return cursor.fetchall()","import sqlite3
def get_user_data(username):
    conn = sqlite3.connect('database.db')
    cursor = conn.cursor()
    query = ""SELECT * FROM users WHERE username = '"" + username + ""'""
    cursor.execute(query)
    return cursor.fetchall()",python,1
Command Injection,"import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class CommandInjectionVulnerable {

    public static void main(String[] args) {
        try {
            // Taking user input for the command to execute
            BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));
            System.out.print(""Enter a command to execute: "");
            String userInput = reader.readLine();

            // Executing the user input as a command using Runtime.exec()
            Process process = Runtime.getRuntime().exec(""ls "" + userInput);

            // Reading and printing the output of the command
            BufferedReader outputReader = new BufferedReader(new InputStreamReader(process.getInputStream()));
            String line;
            while ((line = outputReader.readLine()) != null) {
                System.out.println(line);
            }

        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}","import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class CommandInjectionVulnerable { public static void main(String[] args) { try { // Taking user input for the command to execute BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a command to execute: ""); String userInput = reader.readLine(); // Executing the user input as a command using Runtime.exec() Process process = Runtime.getRuntime().exec(""ls "" + userInput); // Reading and printing the output of the command BufferedReader outputReader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = outputReader.readLine()) != null) { System.out.println(line); } } catch (IOException e) { e.printStackTrace(); } } }",java,1
SSRF,"import requests
def fetch_url(url):
    return requests.get(url).text","import requests
def fetch_url(url):
    return requests.get(url).text",python,1
Insecure Deserialization,"<?php
$data = $_POST['data'];
unserialize($data); // Insecure Deserialization
?>","<?php
$data = $_POST['data'];
unserialize($data); // Insecure Deserialization
?>",php,1
Command Injection,"const shell = require('child_process');
shell.exec('ping ' + userInput); // Command Injection
","const shell = require('child_process');
shell.exec('ping ' + userInput); // Command Injection
",javascript,1
Command Injection,"import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class CommandInjectionVulnerable {

    public static void main(String[] args) {
        try {
            BufferedReader br = new BufferedReader(new InputStreamReader(System.in));
            System.out.print(""Enter a file name to display: "");
            String fileName = br.readLine();

            // Vulnerable code - user input is directly concatenated to form command
            String command = ""cat "" + fileName; 
            Process process = Runtime.getRuntime().exec(command);

            BufferedReader reader = new BufferedReader(new InputStreamReader(process.getInputStream()));
            String line;
            while ((line = reader.readLine()) != null) {
                System.out.println(line);
            }

        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}","import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class CommandInjectionVulnerable { public static void main(String[] args) { try { BufferedReader br = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a file name to display: ""); String fileName = br.readLine(); // Vulnerable code - user input is directly concatenated to form command String command = ""cat "" + fileName; Process process = Runtime.getRuntime().exec(command); BufferedReader reader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = reader.readLine()) != null) { System.out.println(line); } } catch (IOException e) { e.printStackTrace(); } } }",java,1
SQL Injection,"<?php
$username = $_POST['username'];
$query = ""SELECT * FROM users WHERE username = '$username'"";
$result = mysql_query($query); // SQL Injection
?>","<?php
$username = $_POST['username'];
$query = ""SELECT * FROM users WHERE username = '$username'"";
$result = mysql_query($query); // SQL Injection
?>",php,1
Clear,"To fix the Command Injection vulnerability in the given Java code, you need to ensure that user input is properly validated and sanitized before being used in constructing the command. One way to mitigate Command Injection vulnerabilities is to use parameterized commands or validate the input string.

Here's an updated version of the code that addresses the vulnerability by using a ProcessBuilder with separated arguments:

```java
import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class SecureCommandExecution {

    public static void main(String[] args) {
        try {
            BufferedReader br = new BufferedReader(new InputStreamReader(System.in));
            System.out.print(""Enter a file name to display its contents: "");
            String fileName = br.readLine();

            // Validate the input filename
            if (!isValidFileName(fileName)) {
                System.out.println(""Invalid file name"");
                return;
            }

            // Use ProcessBuilder with separated arguments to avoid command injection
            Process process = new ProcessBuilder(""cat"", fileName).start();

            BufferedReader reader = new BufferedReader(new InputStreamReader(process.getInputStream()));

            String line;
            while ((line = reader.readLine()) != null) {
                System.out.println(line);
            }
        } catch (IOException e) {
            e.printStackTrace();
        }
    }","To fix the Command Injection vulnerability in the given Java code, you need to ensure that user input is properly validated and sanitized before being used in constructing the command. One way to mitigate Command Injection vulnerabilities is to use parameterized commands or validate the input string. Here's an updated version of the code that addresses the vulnerability by using a ProcessBuilder with separated arguments: ```java import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class SecureCommandExecution { public static void main(String[] args) { try { BufferedReader br = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a file name to display its contents: ""); String fileName = br.readLine(); // Validate the input filename if (!isValidFileName(fileName)) { System.out.println(""Invalid file name""); return; } // Use ProcessBuilder with separated arguments to avoid command injection Process process = new ProcessBuilder(""cat"", fileName).start(); BufferedReader reader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = reader.readLine()) != null) { System.out.println(line); } } catch (IOException e) { e.printStackTrace(); } }",java,0
Clear,"from django.http import HttpResponse
from django.utils.html import escape

def safe_user_profile(request, username):
    safe_username = escape(username)
    return HttpResponse(f""Welcome, {safe_username}!"")","from django.http import HttpResponse
from django.utils.html import escape

def safe_user_profile(request, username):
    safe_username = escape(username)
    return HttpResponse(f""Welcome, {safe_username}!"")",python,0
Clear,"To fix the XSS vulnerability in the given Java code snippet, you need to properly validate and encode user input before displaying it in the response. Here's an improved version of the code with security measures:

```java
import java.io.IOException;
import java.io.PrintWriter;
import javax.servlet.ServletException;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

public class XSSFixedServlet extends HttpServlet {

    @Override
    protected void doPost(HttpServletRequest request, HttpServletResponse response)
            throws ServletException, IOException {
        String userInput = request.getParameter(""input"");
        
        response.setContentType(""text/html"");
        PrintWriter out = response.getWriter();
        
        out.println(""<html>"");
        out.println(""<head><title>Secure Page</title></head>"");
        out.println(""<body>"");
        
        // Properly handle user input by encoding it to prevent XSS attacks
        out.println(""<h1>User Input: "" + encodeHtml(userInput) + ""</h1>"");
        
        out.println(""</body>"");
        out.println(""</html>"");
    }
    
    // Method to encode special characters in user input to prevent XSS
    private String encodeHtml(String input) {
        if (input == null) {
            return """";
        }
        
        StringBuilder encoded =","To fix the XSS vulnerability in the given Java code snippet, you need to properly validate and encode user input before displaying it in the response. Here's an improved version of the code with security measures: ```java import java.io.IOException; import java.io.PrintWriter; import javax.servlet.ServletException; import javax.servlet.http.HttpServlet; import javax.servlet.http.HttpServletRequest; import javax.servlet.http.HttpServletResponse; public class XSSFixedServlet extends HttpServlet { @Override protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { String userInput = request.getParameter(""input""); response.setContentType(""text/html""); PrintWriter out = response.getWriter(); out.println(""<html>""); out.println(""<head><title>Secure Page</title></head>""); out.println(""<body>""); // Properly handle user input by encoding it to prevent XSS attacks out.println(""<h1>User Input: "" + encodeHtml(userInput) + ""</h1>""); out.println(""</body>""); out.println(""</html>""); } // Method to encode special characters in user input to prevent XSS private String encodeHtml(String input) { if (input == null) { return """"; } StringBuilder encoded =",java,0
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Command Injection,"import subprocess
def list_directory(path):
    result = subprocess.run(f""ls {path}"", shell=True, capture_output=True, text=True)
    return result.stdout","import subprocess
def list_directory(path):
    result = subprocess.run(f""ls {path}"", shell=True, capture_output=True, text=True)
    return result.stdout",python,1
Clear,"const userData = JSON.parse(userInput); // Safe JSON parsing
if (userData && typeof userData === 'object') {
    processUserData(userData);
}
","const userData = JSON.parse(userInput); // Safe JSON parsing
if (userData && typeof userData === 'object') {
    processUserData(userData);
}
",javascript,0
Command Injection,"import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class CommandInjectionExample {
    public static void main(String[] args) {
        try {
            BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));
            System.out.print(""Enter a command to execute: "");
            String userInput = reader.readLine();

            // Unsafe command execution
            Process process = Runtime.getRuntime().exec(""ping "" + userInput);

            BufferedReader inputReader = new BufferedReader(new InputStreamReader(process.getInputStream()));
            String line;
            while ((line = inputReader.readLine()) != null) {
                System.out.println(line);
            }
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}","import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class CommandInjectionExample { public static void main(String[] args) { try { BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a command to execute: ""); String userInput = reader.readLine(); // Unsafe command execution Process process = Runtime.getRuntime().exec(""ping "" + userInput); BufferedReader inputReader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = inputReader.readLine()) != null) { System.out.println(line); } } catch (IOException e) { e.printStackTrace(); } } }",java,1
Buffer Overflow,"#include <iostream>
#include <cstdio>

void unsafe_c_input() {
    char buffer[50];
    scanf(""%s"", buffer); // no length limit
    std::cout << buffer << std::endl;
}","#include <iostream>
#include <cstdio>

void unsafe_c_input() {
    char buffer[50];
    scanf(""%s"", buffer); // no length limit
    std::cout << buffer << std::endl;
}",cpp,1
Insecure Deserialization,"<?php
$data = $_POST['data'];
unserialize($data); // Insecure Deserialization
?>","<?php
$data = $_POST['data'];
unserialize($data); // Insecure Deserialization
?>",php,1
Command Injection,"<?php
$cmd = $_GET['cmd'];
system($cmd); // Command Injection
?>","<?php
$cmd = $_GET['cmd'];
system($cmd); // Command Injection
?>",php,1
Buffer Overflow,"import java.util.Scanner;

public class BufferOverflowVulnerability {

    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        System.out.print(""Enter a string: "");
        String userInput = scanner.nextLine();
        
        // Vulnerable code - buffer overflow can occur if the user enters a very long input
        char[] buffer = new char[10];
        userInput.getChars(0, userInput.length(), buffer, 0);
        
        System.out.println(""Buffer contents: "" + new String(buffer));
    }
}","import java.util.Scanner; public class BufferOverflowVulnerability { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter a string: ""); String userInput = scanner.nextLine(); // Vulnerable code - buffer overflow can occur if the user enters a very long input char[] buffer = new char[10]; userInput.getChars(0, userInput.length(), buffer, 0); System.out.println(""Buffer contents: "" + new String(buffer)); } }",java,1
Command Injection,"import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class CommandInjectionExample {

    public static void main(String[] args) {
        try {
            BufferedReader br = new BufferedReader(new InputStreamReader(System.in));
            System.out.print(""Enter a hostname to ping: "");
            String hostname = br.readLine();

            // Vulnerable code: directly concatenating user input into the command
            String command = ""ping "" + hostname;

            Process process = Runtime.getRuntime().exec(command);

            BufferedReader reader = new BufferedReader(new InputStreamReader(process.getInputStream()));
            String line;
            while ((line = reader.readLine()) != null) {
                System.out.println(line);
            }

        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}","import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class CommandInjectionExample { public static void main(String[] args) { try { BufferedReader br = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a hostname to ping: ""); String hostname = br.readLine(); // Vulnerable code: directly concatenating user input into the command String command = ""ping "" + hostname; Process process = Runtime.getRuntime().exec(command); BufferedReader reader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = reader.readLine()) != null) { System.out.println(line); } } catch (IOException e) { e.printStackTrace(); } } }",java,1
SQL Injection,"import sqlite3
def get_user_data(username):
    conn = sqlite3.connect('database.db')
    cursor = conn.cursor()
    query = ""SELECT * FROM users WHERE username = '"" + username + ""'""
    cursor.execute(query)
    return cursor.fetchall()","import sqlite3
def get_user_data(username):
    conn = sqlite3.connect('database.db')
    cursor = conn.cursor()
    query = ""SELECT * FROM users WHERE username = '"" + username + ""'""
    cursor.execute(query)
    return cursor.fetchall()",python,1
Command Injection,"import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class CommandInjectionVulnerability {

    public static void main(String[] args) {
        try {
            BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));
            System.out.print(""Enter a file name: "");
            String fileName = reader.readLine();

            // Vulnerable code - user input is directly concatenated into command string
            String command = ""cat "" + fileName; // User can inject malicious commands here

            Process process = Runtime.getRuntime().exec(command);
            
            BufferedReader inputStreamReader = new BufferedReader(new InputStreamReader(process.getInputStream()));
            String line;
            
            while ((line = inputStreamReader.readLine()) != null) {
                System.out.println(line);
            }
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}","import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class CommandInjectionVulnerability { public static void main(String[] args) { try { BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a file name: ""); String fileName = reader.readLine(); // Vulnerable code - user input is directly concatenated into command string String command = ""cat "" + fileName; // User can inject malicious commands here Process process = Runtime.getRuntime().exec(command); BufferedReader inputStreamReader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = inputStreamReader.readLine()) != null) { System.out.println(line); } } catch (IOException e) { e.printStackTrace(); } } }",java,1
Clear,"app.get('/user/:id', (req, res) => {
    const userId = parseInt(req.params.id);
    db.query('SELECT * FROM users WHERE id = ?', [userId], (err, result) => {
        res.json(result);
    });
});
","app.get('/user/:id', (req, res) => {
    const userId = parseInt(req.params.id);
    db.query('SELECT * FROM users WHERE id = ?', [userId], (err, result) => {
        res.json(result);
    });
});
",javascript,0
Clear,"#include <iostream>
#include <fstream>
#include <string>

void safe_file_reading(const std::string& filename) {
    std::ifstream file(filename);
    if (file.is_open()) {
        std::string line;
        while (std::getline(file, line)) {
            std::cout << line << std::endl;
        }
    }
}","#include <iostream>
#include <fstream>
#include <string>

void safe_file_reading(const std::string& filename) {
    std::ifstream file(filename);
    if (file.is_open()) {
        std::string line;
        while (std::getline(file, line)) {
            std::cout << line << std::endl;
        }
    }
}",cpp,0
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Clear,"import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.util.Scanner;

public class SecureSQLCode {

    public static void main(String[] args) {
        try {
            Scanner scanner = new Scanner(System.in);

            System.out.print(""Enter username: "");
            String username = scanner.nextLine();

            // Using a parameterized query to prevent SQL Injection
            String query = ""SELECT * FROM users WHERE username=?"";
            
            Connection connection = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");
            
            PreparedStatement preparedStatement = connection.prepareStatement(query);
            preparedStatement.setString(1, username);
            
            ResultSet resultSet = preparedStatement.executeQuery();
            
            while(resultSet.next()) {
                System.out.println(""User found: "" + resultSet.getString(""username""));
            }
            
            connection.close();
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }

}","import java.sql.Connection; import java.sql.DriverManager; import java.sql.PreparedStatement; import java.sql.ResultSet; import java.sql.SQLException; import java.util.Scanner; public class SecureSQLCode { public static void main(String[] args) { try { Scanner scanner = new Scanner(System.in); System.out.print(""Enter username: ""); String username = scanner.nextLine(); // Using a parameterized query to prevent SQL Injection String query = ""SELECT * FROM users WHERE username=?""; Connection connection = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); PreparedStatement preparedStatement = connection.prepareStatement(query); preparedStatement.setString(1, username); ResultSet resultSet = preparedStatement.executeQuery(); while(resultSet.next()) { System.out.println(""User found: "" + resultSet.getString(""username"")); } connection.close(); } catch (SQLException e) { e.printStackTrace(); } } }",java,0
Clear,"#include <stdio.h>
#include <string.h>

int validate_input(const char *input) {
    if (input == NULL) return 0;
    for (int i = 0; input[i] != '\0'; i++) {
        if (input[i] < 32 || input[i] > 126) {
            return 0; // invalid character
        }
    }
    return 1;
}","#include <stdio.h>
#include <string.h>

int validate_input(const char *input) {
    if (input == NULL) return 0;
    for (int i = 0; input[i] != '\0'; i++) {
        if (input[i] < 32 || input[i] > 126) {
            return 0; // invalid character
        }
    }
    return 1;
}",c,0
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Clear,"import pickle
def safe_deserialize(data):
    allowed_classes = {'SafeClass', 'AnotherSafeClass'}
    return pickle.loads(data)","import pickle
def safe_deserialize(data):
    allowed_classes = {'SafeClass', 'AnotherSafeClass'}
    return pickle.loads(data)",python,0
Clear,"<?php
$cmd = escapeshellarg($_GET['cmd']);
system(""ls "" . $cmd); // Escaped command
?>","<?php
$cmd = escapeshellarg($_GET['cmd']);
system(""ls "" . $cmd); // Escaped command
?>",php,0
Command Injection,"import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class CommandInjectionExample {

    public static void main(String[] args) {
        try {
            // Accept user input for a command
            System.out.print(""Enter a command to execute: "");
            BufferedReader br = new BufferedReader(new InputStreamReader(System.in));
            String userInput = br.readLine();

            // Execute the command using Runtime.exec()
            Process process = Runtime.getRuntime().exec(""ping "" + userInput);

            // Read and print the output of the executed command
            BufferedReader reader = new BufferedReader(new InputStreamReader(process.getInputStream()));
            String line;
            while ((line = reader.readLine()) != null) {
                System.out.println(line);
            }
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}","import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class CommandInjectionExample { public static void main(String[] args) { try { // Accept user input for a command System.out.print(""Enter a command to execute: ""); BufferedReader br = new BufferedReader(new InputStreamReader(System.in)); String userInput = br.readLine(); // Execute the command using Runtime.exec() Process process = Runtime.getRuntime().exec(""ping "" + userInput); // Read and print the output of the executed command BufferedReader reader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = reader.readLine()) != null) { System.out.println(line); } } catch (IOException e) { e.printStackTrace(); } } }",java,1
Clear,"const userData = JSON.parse(userInput); // Safe JSON parsing
if (userData && typeof userData === 'object') {
    processUserData(userData);
}
","const userData = JSON.parse(userInput); // Safe JSON parsing
if (userData && typeof userData === 'object') {
    processUserData(userData);
}
",javascript,0
Clear,"#include <iostream>
#include <string>
#include <vector>

void safe_string_handling(const std::string& input) {
    std::string safe_copy = input;
    std::cout << safe_copy << std::endl;
}","#include <iostream>
#include <string>
#include <vector>

void safe_string_handling(const std::string& input) {
    std::string safe_copy = input;
    std::cout << safe_copy << std::endl;
}",cpp,0
Clear,"import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;

public class SecureSQLExample {
    public static void main(String[] args) {
        String userInput = ""'; DROP TABLE users; --""; // User input containing malicious SQL

        try (Connection connection = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"")) {
            String query = ""SELECT * FROM users WHERE username = ?"";
            try (PreparedStatement statement = connection.prepareStatement(query)) {
                statement.setString(1, userInput);
                ResultSet resultSet = statement.executeQuery();

                while (resultSet.next()) {
                    System.out.println(resultSet.getString(""username""));
                }
            }
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.Connection; import java.sql.DriverManager; import java.sql.PreparedStatement; import java.sql.ResultSet; import java.sql.SQLException; public class SecureSQLExample { public static void main(String[] args) { String userInput = ""'; DROP TABLE users; --""; // User input containing malicious SQL try (Connection connection = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"")) { String query = ""SELECT * FROM users WHERE username = ?""; try (PreparedStatement statement = connection.prepareStatement(query)) { statement.setString(1, userInput); ResultSet resultSet = statement.executeQuery(); while (resultSet.next()) { System.out.println(resultSet.getString(""username"")); } } } catch (SQLException e) { e.printStackTrace(); } } }",java,0
SQL Injection,"import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.ResultSet;
import java.sql.Statement;
import java.util.Scanner;

public class SQLInjectionVulnerable {

    public static void main(String[] args) {
        try {
            Scanner scanner = new Scanner(System.in);
            System.out.print(""Enter username: "");
            String username = scanner.nextLine();

            Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");
            Statement stmt = conn.createStatement();
            
            String query = ""SELECT * FROM users WHERE username='"" + username + ""'"";
            
            ResultSet rs = stmt.executeQuery(query);
            
            while (rs.next()) {
                System.out.println(""User found: "" + rs.getString(""username""));
            }
            
            conn.close();
        } catch (Exception e) {
            e.printStackTrace();
        }
    }
}","import java.sql.Connection; import java.sql.DriverManager; import java.sql.ResultSet; import java.sql.Statement; import java.util.Scanner; public class SQLInjectionVulnerable { public static void main(String[] args) { try { Scanner scanner = new Scanner(System.in); System.out.print(""Enter username: ""); String username = scanner.nextLine(); Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); Statement stmt = conn.createStatement(); String query = ""SELECT * FROM users WHERE username='"" + username + ""'""; ResultSet rs = stmt.executeQuery(query); while (rs.next()) { System.out.println(""User found: "" + rs.getString(""username"")); } conn.close(); } catch (Exception e) { e.printStackTrace(); } } }",java,1
Command Injection,"import subprocess
def list_directory(path):
    result = subprocess.run(f""ls {path}"", shell=True, capture_output=True, text=True)
    return result.stdout","import subprocess
def list_directory(path):
    result = subprocess.run(f""ls {path}"", shell=True, capture_output=True, text=True)
    return result.stdout",python,1
Clear,"import mysql.connector
def safe_product_search(category):
    db = mysql.connector.connect(host=""localhost"", user=""user"", password=""pass"", database=""shop"")
    cursor = db.cursor()
    cursor.execute(""SELECT * FROM products WHERE category = %s"", (category,))
    return cursor.fetchall()","import mysql.connector
def safe_product_search(category):
    db = mysql.connector.connect(host=""localhost"", user=""user"", password=""pass"", database=""shop"")
    cursor = db.cursor()
    cursor.execute(""SELECT * FROM products WHERE category = %s"", (category,))
    return cursor.fetchall()",python,0
Clear,"#include <iostream>
#include <vector>
#include <stdexcept>

int safe_vector_access(const std::vector<int>& vec, size_t index) {
    if (index >= vec.size()) {
        throw std::out_of_range(""Index out of range"");
    }
    return vec[index];
}","#include <iostream>
#include <vector>
#include <stdexcept>

int safe_vector_access(const std::vector<int>& vec, size_t index) {
    if (index >= vec.size()) {
        throw std::out_of_range(""Index out of range"");
    }
    return vec[index];
}",cpp,0
Clear,"#include <iostream>
#include <memory>

void safe_memory_management() {
    auto ptr = std::make_unique<int>(42);
    std::cout << *ptr << std::endl;
}","#include <iostream>
#include <memory>

void safe_memory_management() {
    auto ptr = std::make_unique<int>(42);
    std::cout << *ptr << std::endl;
}",cpp,0
Buffer Overflow,"#include <iostream>
#include <cstring>

void unsafe_c_string(char* input) {
    char buffer[100];
    strcpy(buffer, input); // potential buffer overflow
    std::cout << buffer << std::endl;
}","#include <iostream>
#include <cstring>

void unsafe_c_string(char* input) {
    char buffer[100];
    strcpy(buffer, input); // potential buffer overflow
    std::cout << buffer << std::endl;
}",cpp,1
Clear,"#include <iostream>
#include <memory>

void safe_memory_management() {
    auto ptr = std::make_unique<int>(42);
    std::cout << *ptr << std::endl;
}","#include <iostream>
#include <memory>

void safe_memory_management() {
    auto ptr = std::make_unique<int>(42);
    std::cout << *ptr << std::endl;
}",cpp,0
Clear,"#include <stdio.h>
#include <string.h>

void safe_string_copy(char *dest, const char *src, size_t dest_size) {
    if (dest_size > 0) {
        strncpy(dest, src, dest_size - 1);
        dest[dest_size - 1] = '\0';
    }
}","#include <stdio.h>
#include <string.h>

void safe_string_copy(char *dest, const char *src, size_t dest_size) {
    if (dest_size > 0) {
        strncpy(dest, src, dest_size - 1);
        dest[dest_size - 1] = '\0';
    }
}",c,0
Clear,"def safe_division(a, b):
    if b == 0:
        raise ValueError(""Division by zero"")
    return a / b","def safe_division(a, b):
    if b == 0:
        raise ValueError(""Division by zero"")
    return a / b",python,0
Clear,"import subprocess
def safe_ping(host):
    import re
    if not re.match(r'^[a-zA-Z0-9.-]+$', host):
        raise ValueError(""Invalid host"")
    result = subprocess.run(['ping', '-c', '4', host], capture_output=True, text=True)
    return result.stdout","import subprocess
def safe_ping(host):
    import re
    if not re.match(r'^[a-zA-Z0-9.-]+$', host):
        raise ValueError(""Invalid host"")
    result = subprocess.run(['ping', '-c', '4', host], capture_output=True, text=True)
    return result.stdout",python,0
SQL Injection,"import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.ResultSet;
import java.sql.Statement;

public class SQLInjectionExample {

    public static void main(String[] args) {
        String userInput = ""'; DROP TABLE users; --""; // Simulating user input

        try {
            Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");
            Statement stmt = conn.createStatement();

            // Vulnerable query where user input is directly concatenated into the SQL query
            String query = ""SELECT * FROM users WHERE username='"" + userInput + ""'"";
            ResultSet rs = stmt.executeQuery(query);

            while (rs.next()) {
                System.out.println(""User found: "" + rs.getString(""username""));
            }

            conn.close();
        } catch (Exception e) {
            e.printStackTrace();
        }
    }
}","import java.sql.Connection; import java.sql.DriverManager; import java.sql.ResultSet; import java.sql.Statement; public class SQLInjectionExample { public static void main(String[] args) { String userInput = ""'; DROP TABLE users; --""; // Simulating user input try { Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); Statement stmt = conn.createStatement(); // Vulnerable query where user input is directly concatenated into the SQL query String query = ""SELECT * FROM users WHERE username='"" + userInput + ""'""; ResultSet rs = stmt.executeQuery(query); while (rs.next()) { System.out.println(""User found: "" + rs.getString(""username"")); } conn.close(); } catch (Exception e) { e.printStackTrace(); } } }",java,1
SQL Injection,"import psycopg2
def admin_login(admin_id):
    conn = psycopg2.connect(""dbname=test user=postgres"")
    cur = conn.cursor()
    cur.execute(f""SELECT * FROM admins WHERE id = {admin_id}"")
    return cur.fetchone()","import psycopg2
def admin_login(admin_id):
    conn = psycopg2.connect(""dbname=test user=postgres"")
    cur = conn.cursor()
    cur.execute(f""SELECT * FROM admins WHERE id = {admin_id}"")
    return cur.fetchone()",python,1
Clear,"<?php
$input = json_decode($_POST['data'], true); // Safe JSON parsing
if (json_last_error() === JSON_ERROR_NONE) {
    process_data($input);
}
?>","<?php
$input = json_decode($_POST['data'], true); // Safe JSON parsing
if (json_last_error() === JSON_ERROR_NONE) {
    process_data($input);
}
?>",php,0
Clear,"#include <iostream>
#include <fstream>
#include <string>

void safe_file_reading(const std::string& filename) {
    std::ifstream file(filename);
    if (file.is_open()) {
        std::string line;
        while (std::getline(file, line)) {
            std::cout << line << std::endl;
        }
    }
}","#include <iostream>
#include <fstream>
#include <string>

void safe_file_reading(const std::string& filename) {
    std::ifstream file(filename);
    if (file.is_open()) {
        std::string line;
        while (std::getline(file, line)) {
            std::cout << line << std::endl;
        }
    }
}",cpp,0
Path Traversal,"import os
def read_file(filename):
    with open('/var/www/uploads/' + filename, 'r') as f:
        return f.read()","import os
def read_file(filename):
    with open('/var/www/uploads/' + filename, 'r') as f:
        return f.read()",python,1
Clear,"#include <iostream>
#include <sstream>

int safe_string_to_int(const std::string& str) {
    std::stringstream ss(str);
    int value;
    if (ss >> value) {
        return value;
    }
    throw std::invalid_argument(""Invalid integer"");
}","#include <iostream>
#include <sstream>

int safe_string_to_int(const std::string& str) {
    std::stringstream ss(str);
    int value;
    if (ss >> value) {
        return value;
    }
    throw std::invalid_argument(""Invalid integer"");
}",cpp,0
SQL Injection,"import java.sql.*;

public class SQLInjectionVulnerableExample {

    public static void main(String[] args) {
        String userInput = ""admin'; DROP TABLE users;--"";
        
        try {
            Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");
            Statement stmt = conn.createStatement();
            
            String query = ""SELECT * FROM users WHERE username='"" + userInput + ""'"";
            ResultSet rs = stmt.executeQuery(query);
            
            while (rs.next()) {
                System.out.println(rs.getString(""username""));
            }
            
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.*; public class SQLInjectionVulnerableExample { public static void main(String[] args) { String userInput = ""admin'; DROP TABLE users;--""; try { Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); Statement stmt = conn.createStatement(); String query = ""SELECT * FROM users WHERE username='"" + userInput + ""'""; ResultSet rs = stmt.executeQuery(query); while (rs.next()) { System.out.println(rs.getString(""username"")); } } catch (SQLException e) { e.printStackTrace(); } } }",java,1
Memory Corruption,"#include <iostream>

void unsafe_virtual_call() {
    // Potential vtable corruption vulnerability
    class Base {
    public:
        virtual void func() { std::cout << ""Base"" << std::endl; }
    };
    
    class Derived : public Base {
    public:
        void func() override { std::cout << ""Derived"" << std::endl; }
    };
}","#include <iostream>

void unsafe_virtual_call() {
    // Potential vtable corruption vulnerability
    class Base {
    public:
        virtual void func() { std::cout << ""Base"" << std::endl; }
    };
    
    class Derived : public Base {
    public:
        void func() override { std::cout << ""Derived"" << std::endl; }
    };
}",cpp,1
Command Injection,"import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class CommandInjectionVulnerable {
    public static void main(String[] args) throws IOException {
        BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));
        
        System.out.print(""Enter a command to execute: "");
        String command = reader.readLine();
        
        Runtime runtime = Runtime.getRuntime();
        Process process = runtime.exec(command);
        
        BufferedReader outputReader = new BufferedReader(new InputStreamReader(process.getInputStream()));
        String line;
        while ((line = outputReader.readLine()) != null) {
            System.out.println(line);
        }
    }
}","import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class CommandInjectionVulnerable { public static void main(String[] args) throws IOException { BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a command to execute: ""); String command = reader.readLine(); Runtime runtime = Runtime.getRuntime(); Process process = runtime.exec(command); BufferedReader outputReader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = outputReader.readLine()) != null) { System.out.println(line); } } }",java,1
Out-of-Bounds,"#include <iostream>

class UnsafeClass {
    int data[10];
public:
    int get_data(int index) {
        return data[index]; // no bounds checking
    }
};","#include <iostream>

class UnsafeClass {
    int data[10];
public:
    int get_data(int index) {
        return data[index]; // no bounds checking
    }
};",cpp,1
Clear,"const shell = require('child_process');
const safeInput = userInput.replace(/[^a-zA-Z0-9.]/g, '');
shell.execFile('ping', [safeInput]); // Safe command execution
","const shell = require('child_process');
const safeInput = userInput.replace(/[^a-zA-Z0-9.]/g, '');
shell.execFile('ping', [safeInput]); // Safe command execution
",javascript,0
Clear,"#include <stdio.h>
#include <string.h>

int validate_input(const char *input) {
    if (input == NULL) return 0;
    for (int i = 0; input[i] != '\0'; i++) {
        if (input[i] < 32 || input[i] > 126) {
            return 0; // invalid character
        }
    }
    return 1;
}","#include <stdio.h>
#include <string.h>

int validate_input(const char *input) {
    if (input == NULL) return 0;
    for (int i = 0; input[i] != '\0'; i++) {
        if (input[i] < 32 || input[i] > 126) {
            return 0; // invalid character
        }
    }
    return 1;
}",c,0
Clear,"<?php
$username = $_POST['username'];
$stmt = $pdo->prepare(""SELECT * FROM users WHERE username = ?"");
$stmt->execute([$username]); // Parameterized query
?>","<?php
$username = $_POST['username'];
$stmt = $pdo->prepare(""SELECT * FROM users WHERE username = ?"");
$stmt->execute([$username]); // Parameterized query
?>",php,0
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
SQL Injection,"import mysql.connector
def search_products(category):
    db = mysql.connector.connect(host=""localhost"", user=""user"", password=""pass"", database=""shop"")
    cursor = db.cursor()
    cursor.execute(""SELECT * FROM products WHERE category = '%s'"" % category)
    return cursor.fetchall()","import mysql.connector
def search_products(category):
    db = mysql.connector.connect(host=""localhost"", user=""user"", password=""pass"", database=""shop"")
    cursor = db.cursor()
    cursor.execute(""SELECT * FROM products WHERE category = '%s'"" % category)
    return cursor.fetchall()",python,1
Clear,"To fix the code and prevent Cross-Site Scripting (XSS) vulnerabilities, you should properly sanitize the user input before including it in the HTML response. One common approach is to use an HTML escaping function to encode special characters in the user input. Here's an updated version of the code that implements this security measure:

```java
import java.io.*;
import javax.servlet.*;
import javax.servlet.http.*;

public class SecureServlet extends HttpServlet {
    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        String userInput = request.getParameter(""input"");
        
        String safeUserInput = escapeHtml(userInput);
        
        String htmlResponse = ""<html><body>Welcome, "" + safeUserInput + ""!</body></html>"";
        
        response.setContentType(""text/html"");
        response.getWriter().write(htmlResponse);
    }
    
    private String escapeHtml(String input) {
        if (input == null) {
            return """";
        }
        
        StringBuilder result = new StringBuilder();
        
        for (char c : input.toCharArray()) {
            switch (c) {
                case '<':
                    result.append(""&lt;"");
                    break;
                case '>':
                    result.append(""&gt;"");
                    break;
                case '&':
                    result.append(""&amp;"");","To fix the code and prevent Cross-Site Scripting (XSS) vulnerabilities, you should properly sanitize the user input before including it in the HTML response. One common approach is to use an HTML escaping function to encode special characters in the user input. Here's an updated version of the code that implements this security measure: ```java import java.io.*; import javax.servlet.*; import javax.servlet.http.*; public class SecureServlet extends HttpServlet { protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { String userInput = request.getParameter(""input""); String safeUserInput = escapeHtml(userInput); String htmlResponse = ""<html><body>Welcome, "" + safeUserInput + ""!</body></html>""; response.setContentType(""text/html""); response.getWriter().write(htmlResponse); } private String escapeHtml(String input) { if (input == null) { return """"; } StringBuilder result = new StringBuilder(); for (char c : input.toCharArray()) { switch (c) { case '<': result.append(""&lt;""); break; case '>': result.append(""&gt;""); break; case '&': result.append(""&amp;"");",java,0
Clear,"#include <iostream>
#include <string>
#include <vector>

void safe_string_handling(const std::string& input) {
    std::string safe_copy = input;
    std::cout << safe_copy << std::endl;
}","#include <iostream>
#include <string>
#include <vector>

void safe_string_handling(const std::string& input) {
    std::string safe_copy = input;
    std::cout << safe_copy << std::endl;
}",cpp,0
Clear,"import re
def validate_email(email):
    pattern = r'^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$'
    return bool(re.match(pattern, email))","import re
def validate_email(email):
    pattern = r'^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$'
    return bool(re.match(pattern, email))",python,0
Command Injection,"import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class CommandInjectionExample {

    public static void main(String[] args) {
        try {
            BufferedReader br = new BufferedReader(new InputStreamReader(System.in));
            System.out.print(""Enter a file name: "");
            String fileName = br.readLine();

            // This code snippet is vulnerable to Command Injection
            String command = ""cat "" + fileName;  // Vulnerable command injection point

            Process process = Runtime.getRuntime().exec(command);
            BufferedReader reader = new BufferedReader(new InputStreamReader(process.getInputStream()));

            String line;
            while ((line = reader.readLine()) != null) {
                System.out.println(line);
            }
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}","import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class CommandInjectionExample { public static void main(String[] args) { try { BufferedReader br = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a file name: ""); String fileName = br.readLine(); // This code snippet is vulnerable to Command Injection String command = ""cat "" + fileName; // Vulnerable command injection point Process process = Runtime.getRuntime().exec(command); BufferedReader reader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = reader.readLine()) != null) { System.out.println(line); } } catch (IOException e) { e.printStackTrace(); } } }",java,1
SQL Injection,"app.get('/user/:id', (req, res) => {
    const query = `SELECT * FROM users WHERE id = ${req.params.id}`; // SQL Injection
    db.query(query, (err, result) => {
        res.json(result);
    });
});
","app.get('/user/:id', (req, res) => {
    const query = `SELECT * FROM users WHERE id = ${req.params.id}`; // SQL Injection
    db.query(query, (err, result) => {
        res.json(result);
    });
});
",javascript,1
SQL Injection,"import java.sql.*;

public class SQLInjectionVulnerable {

    public static void main(String[] args) {
        String userInput = ""'; DROP TABLE users; --""; // Malicious input that can cause SQL Injection
        
        try {
            Connection connection = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");
            Statement statement = connection.createStatement();
            
            String query = ""SELECT * FROM users WHERE username = '"" + userInput + ""'"";
            
            ResultSet resultSet = statement.executeQuery(query);
            
            while(resultSet.next()) {
                System.out.println(""User found: "" + resultSet.getString(""username""));
            }
            
            connection.close();
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.*; public class SQLInjectionVulnerable { public static void main(String[] args) { String userInput = ""'; DROP TABLE users; --""; // Malicious input that can cause SQL Injection try { Connection connection = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); Statement statement = connection.createStatement(); String query = ""SELECT * FROM users WHERE username = '"" + userInput + ""'""; ResultSet resultSet = statement.executeQuery(query); while(resultSet.next()) { System.out.println(""User found: "" + resultSet.getString(""username"")); } connection.close(); } catch (SQLException e) { e.printStackTrace(); } } }",java,1
Clear,"To fix the insecure Java code snippet and prevent Cross-Site Scripting (XSS) attacks, you need to properly sanitize and encode the user input before including it in the HTML response. Here's an updated version of the code with proper security measures implemented:

```java
import java.io.IOException;
import java.io.PrintWriter;
import javax.servlet.ServletException;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

public class SecureServlet extends HttpServlet {

    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        String userInput = request.getParameter(""input"");
        
        // Sanitize user input to prevent XSS
        String sanitizedInput = escapeHtml(userInput);
        
        String output = ""<h1>Welcome "" + sanitizedInput + ""</h1>"";
        
        response.setContentType(""text/html"");
        PrintWriter out = response.getWriter();
        out.println(output);
    }
    
    // Function to escape HTML characters to prevent XSS
    private String escapeHtml(String input) {
        if (input == null) {
            return """";
        }
        
        return input.replaceAll(""&"", ""&amp;"")
                     .replaceAll(""<"", ""&lt;"")
                     .replaceAll("">"", ""&gt;"")
                     .replaceAll(""\"""", ""&quot;"")
                     .","To fix the insecure Java code snippet and prevent Cross-Site Scripting (XSS) attacks, you need to properly sanitize and encode the user input before including it in the HTML response. Here's an updated version of the code with proper security measures implemented: ```java import java.io.IOException; import java.io.PrintWriter; import javax.servlet.ServletException; import javax.servlet.http.HttpServlet; import javax.servlet.http.HttpServletRequest; import javax.servlet.http.HttpServletResponse; public class SecureServlet extends HttpServlet { protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { String userInput = request.getParameter(""input""); // Sanitize user input to prevent XSS String sanitizedInput = escapeHtml(userInput); String output = ""<h1>Welcome "" + sanitizedInput + ""</h1>""; response.setContentType(""text/html""); PrintWriter out = response.getWriter(); out.println(output); } // Function to escape HTML characters to prevent XSS private String escapeHtml(String input) { if (input == null) { return """"; } return input.replaceAll(""&"", ""&amp;"") .replaceAll(""<"", ""&lt;"") .replaceAll("">"", ""&gt;"") .replaceAll(""\"""", ""&quot;"") .",java,0
Clear,"#include <iostream>
#include <fstream>
#include <string>

void safe_file_reading(const std::string& filename) {
    std::ifstream file(filename);
    if (file.is_open()) {
        std::string line;
        while (std::getline(file, line)) {
            std::cout << line << std::endl;
        }
    }
}","#include <iostream>
#include <fstream>
#include <string>

void safe_file_reading(const std::string& filename) {
    std::ifstream file(filename);
    if (file.is_open()) {
        std::string line;
        while (std::getline(file, line)) {
            std::cout << line << std::endl;
        }
    }
}",cpp,0
SQL Injection,"<?php
$username = $_POST['username'];
$query = ""SELECT * FROM users WHERE username = '$username'"";
$result = mysql_query($query); // SQL Injection
?>","<?php
$username = $_POST['username'];
$query = ""SELECT * FROM users WHERE username = '$username'"";
$result = mysql_query($query); // SQL Injection
?>",php,1
Clear,"To fix this insecure deserialization vulnerability in Java, you need to implement proper security measures to prevent malicious code execution. Here are some recommendations:

1. Use a Safe Deserialization Mechanism:
   - Implement a whitelist approach where only known and trusted classes are allowed to be deserialized.
   - Use libraries like Apache Commons Collections or XStream that provide safe deserialization features.

2. Validate Input Data:
   - Ensure that the input data is validated and sanitized before deserialization to prevent malicious input.
   - Implement proper input validation checks to avoid executing arbitrary code.

3. Use Signed Serialized Objects:
   - Sign the serialized objects with a digital signature to ensure their integrity and authenticity during deserialization.
   - Verify the signature before deserializing the object to prevent tampering.

4. Implement Input Validation Filters:
   - Implement input validation filters to check for unexpected or malicious content in the serialized data.
   - Reject any input that does not conform to the expected format or structure.

5. Restrict Class Loading:
   - Restrict class loading during deserialization by using security managers or custom class loaders.
   - Limit the classes that can be loaded during deserialization to reduce the attack surface.

Here is an updated version of your code snippet with","To fix this insecure deserialization vulnerability in Java, you need to implement proper security measures to prevent malicious code execution. Here are some recommendations: 1. Use a Safe Deserialization Mechanism: - Implement a whitelist approach where only known and trusted classes are allowed to be deserialized. - Use libraries like Apache Commons Collections or XStream that provide safe deserialization features. 2. Validate Input Data: - Ensure that the input data is validated and sanitized before deserialization to prevent malicious input. - Implement proper input validation checks to avoid executing arbitrary code. 3. Use Signed Serialized Objects: - Sign the serialized objects with a digital signature to ensure their integrity and authenticity during deserialization. - Verify the signature before deserializing the object to prevent tampering. 4. Implement Input Validation Filters: - Implement input validation filters to check for unexpected or malicious content in the serialized data. - Reject any input that does not conform to the expected format or structure. 5. Restrict Class Loading: - Restrict class loading during deserialization by using security managers or custom class loaders. - Limit the classes that can be loaded during deserialization to reduce the attack surface. Here is an updated version of your code snippet with",php,0
Clear,"#include <stdio.h>
#include <string.h>

int validate_input(const char *input) {
    if (input == NULL) return 0;
    for (int i = 0; input[i] != '\0'; i++) {
        if (input[i] < 32 || input[i] > 126) {
            return 0; // invalid character
        }
    }
    return 1;
}","#include <stdio.h>
#include <string.h>

int validate_input(const char *input) {
    if (input == NULL) return 0;
    for (int i = 0; input[i] != '\0'; i++) {
        if (input[i] < 32 || input[i] > 126) {
            return 0; // invalid character
        }
    }
    return 1;
}",c,0
Clear,"import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.util.Scanner;

public class SecureSQLInjectionExample {
    public static void main(String[] args) {
        try {
            Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");
            
            Scanner scanner = new Scanner(System.in);
            System.out.print(""Enter username: "");
            String username = scanner.nextLine();

            String query = ""SELECT * FROM users WHERE username=?"";
            PreparedStatement pstmt = conn.prepareStatement(query);
            pstmt.setString(1, username);

            ResultSet rs = pstmt.executeQuery();

            while (rs.next()) {
                System.out.println(""User found: "" + rs.getString(""username""));
            }

            pstmt.close();
            conn.close();
        } catch (Exception e) {
            e.printStackTrace();
        }
    }
}","import java.sql.Connection; import java.sql.DriverManager; import java.sql.PreparedStatement; import java.sql.ResultSet; import java.util.Scanner; public class SecureSQLInjectionExample { public static void main(String[] args) { try { Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); Scanner scanner = new Scanner(System.in); System.out.print(""Enter username: ""); String username = scanner.nextLine(); String query = ""SELECT * FROM users WHERE username=?""; PreparedStatement pstmt = conn.prepareStatement(query); pstmt.setString(1, username); ResultSet rs = pstmt.executeQuery(); while (rs.next()) { System.out.println(""User found: "" + rs.getString(""username"")); } pstmt.close(); conn.close(); } catch (Exception e) { e.printStackTrace(); } } }",java,0
Cross-Site Scripting (XSS),"import java.io.*;

public class XSSVulnerableCode {
    public static void main(String[] args) {
        try {
            BufferedReader br = new BufferedReader(new InputStreamReader(System.in));
            System.out.print(""Enter your name: "");
            String name = br.readLine();
            
            System.out.println(""Hello, "" + name + ""!""); // Vulnerable code
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}","import java.io.*; public class XSSVulnerableCode { public static void main(String[] args) { try { BufferedReader br = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter your name: ""); String name = br.readLine(); System.out.println(""Hello, "" + name + ""!""); // Vulnerable code } catch (IOException e) { e.printStackTrace(); } } }",java,1
Out-of-Bounds,"#include <iostream>

class UnsafeClass {
    int data[10];
public:
    int get_data(int index) {
        return data[index]; // no bounds checking
    }
};","#include <iostream>

class UnsafeClass {
    int data[10];
public:
    int get_data(int index) {
        return data[index]; // no bounds checking
    }
};",cpp,1
Out-of-Bounds,"#include <iostream>

class UnsafeClass {
    int data[10];
public:
    int get_data(int index) {
        return data[index]; // no bounds checking
    }
};","#include <iostream>

class UnsafeClass {
    int data[10];
public:
    int get_data(int index) {
        return data[index]; // no bounds checking
    }
};",cpp,1
Clear,"#include <iostream>
#include <string>
#include <vector>

void safe_string_handling(const std::string& input) {
    std::string safe_copy = input;
    std::cout << safe_copy << std::endl;
}","#include <iostream>
#include <string>
#include <vector>

void safe_string_handling(const std::string& input) {
    std::string safe_copy = input;
    std::cout << safe_copy << std::endl;
}",cpp,0
Cross-Site Scripting (XSS),"import java.io.*;

public class XSSVulnerableCode {
    public static void main(String[] args) {
        // Simulating user input
        String userInput = ""<script>alert('XSS attack!')</script>"";

        // Outputting user input without proper sanitization
        System.out.println(""Welcome, "" + userInput);
    }
}","import java.io.*; public class XSSVulnerableCode { public static void main(String[] args) { // Simulating user input String userInput = ""<script>alert('XSS attack!')</script>""; // Outputting user input without proper sanitization System.out.println(""Welcome, "" + userInput); } }",java,1
XSS,"const userInput = document.location.search.split('=')[1];
document.write(userInput); // XSS
","const userInput = document.location.search.split('=')[1];
document.write(userInput); // XSS
",javascript,1
Path Traversal,"import java.io.File;
import java.io.FileInputStream;
import java.io.IOException;
import java.util.Scanner;

public class PathTraversalVulnerability {

    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        
        System.out.println(""Enter file name to read:"");
        String fileName = scanner.nextLine();
        
        try {
            File file = new File(""/path/to/some/directory/"" + fileName);
            FileInputStream fis = new FileInputStream(file);
            
            int content;
            while ((content = fis.read()) != -1) {
                System.out.print((char) content);
            }
            
            fis.close();
        } catch (IOException e) {
            System.out.println(""Error reading file: "" + e.getMessage());
        }
    }
}","import java.io.File; import java.io.FileInputStream; import java.io.IOException; import java.util.Scanner; public class PathTraversalVulnerability { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.println(""Enter file name to read:""); String fileName = scanner.nextLine(); try { File file = new File(""/path/to/some/directory/"" + fileName); FileInputStream fis = new FileInputStream(file); int content; while ((content = fis.read()) != -1) { System.out.print((char) content); } fis.close(); } catch (IOException e) { System.out.println(""Error reading file: "" + e.getMessage()); } } }",java,1
Clear,"import java.io.*;
import javax.servlet.*;
import javax.servlet.http.*;

import org.owasp.esapi.ESAPI;
import org.owasp.esapi.errors.EncodingException;

public class XSSSafeServlet extends HttpServlet {
    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        String userInput = request.getParameter(""input"");
        String sanitizedInput = """";

        if (userInput != null && !userInput.isEmpty()) {
            try {
                sanitizedInput = ESAPI.encoder().encodeForHTML(userInput);
            } catch (EncodingException e) {
                // Handle encoding exception
                sanitizedInput = ""Error processing input"";
            }
        }

        String output = ""<p>User input: "" + sanitizedInput + ""</p>"";

        PrintWriter out = response.getWriter();
        out.println(output);
    }
}","import java.io.*; import javax.servlet.*; import javax.servlet.http.*; import org.owasp.esapi.ESAPI; import org.owasp.esapi.errors.EncodingException; public class XSSSafeServlet extends HttpServlet { protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { String userInput = request.getParameter(""input""); String sanitizedInput = """"; if (userInput != null && !userInput.isEmpty()) { try { sanitizedInput = ESAPI.encoder().encodeForHTML(userInput); } catch (EncodingException e) { // Handle encoding exception sanitizedInput = ""Error processing input""; } } String output = ""<p>User input: "" + sanitizedInput + ""</p>""; PrintWriter out = response.getWriter(); out.println(output); } }",java,0
Hardcoded Secrets,"import requests
def call_api():
    api_key = ""sk_live_1234567890abcdef""
    headers = {'Authorization': f'Bearer {api_key}'}
    return requests.get('https://api.example.com/data', headers=headers)","import requests
def call_api():
    api_key = ""sk_live_1234567890abcdef""
    headers = {'Authorization': f'Bearer {api_key}'}
    return requests.get('https://api.example.com/data', headers=headers)",python,1
Memory Corruption,"#include <iostream>

void unsafe_virtual_call() {
    // Potential vtable corruption vulnerability
    class Base {
    public:
        virtual void func() { std::cout << ""Base"" << std::endl; }
    };
    
    class Derived : public Base {
    public:
        void func() override { std::cout << ""Derived"" << std::endl; }
    };
}","#include <iostream>

void unsafe_virtual_call() {
    // Potential vtable corruption vulnerability
    class Base {
    public:
        virtual void func() { std::cout << ""Base"" << std::endl; }
    };
    
    class Derived : public Base {
    public:
        void func() override { std::cout << ""Derived"" << std::endl; }
    };
}",cpp,1
Clear,"const token = process.env.API_TOKEN; // Environment variable
fetch('/api/data', {
    headers: { 'Authorization': `Bearer ${token}` }
});
","const token = process.env.API_TOKEN; // Environment variable
fetch('/api/data', {
    headers: { 'Authorization': `Bearer ${token}` }
});
",javascript,0
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Command Injection,"import os
def backup_database(db_name):
    os.system(f""pg_dump {db_name} > backup.sql"")","import os
def backup_database(db_name):
    os.system(f""pg_dump {db_name} > backup.sql"")",python,1
Clear,"#include <iostream>
#include <sstream>

int safe_string_to_int(const std::string& str) {
    std::stringstream ss(str);
    int value;
    if (ss >> value) {
        return value;
    }
    throw std::invalid_argument(""Invalid integer"");
}","#include <iostream>
#include <sstream>

int safe_string_to_int(const std::string& str) {
    std::stringstream ss(str);
    int value;
    if (ss >> value) {
        return value;
    }
    throw std::invalid_argument(""Invalid integer"");
}",cpp,0
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Cross-Site Scripting (XSS),"import java.io.*;
import javax.servlet.*;
import javax.servlet.http.*;

public class XSSVulnerableServlet extends HttpServlet {
    
    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        String userInput = request.getParameter(""input"");
        
        String htmlResponse = ""<html><body><h1>Welcome "" + userInput + ""!</h1></body></html>"";
        
        PrintWriter out = response.getWriter();
        out.println(htmlResponse);
    }
}","import java.io.*; import javax.servlet.*; import javax.servlet.http.*; public class XSSVulnerableServlet extends HttpServlet { protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { String userInput = request.getParameter(""input""); String htmlResponse = ""<html><body><h1>Welcome "" + userInput + ""!</h1></body></html>""; PrintWriter out = response.getWriter(); out.println(htmlResponse); } }",java,1
Command Injection,"import os
def backup_database(db_name):
    os.system(f""pg_dump {db_name} > backup.sql"")","import os
def backup_database(db_name):
    os.system(f""pg_dump {db_name} > backup.sql"")",python,1
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Clear,import org.apache.commons.text.StringEscapeUtils;,import org.apache.commons.text.StringEscapeUtils;,python,0
Buffer Overflow,"#include <iostream>
#include <cstring>

void unsafe_c_string(char* input) {
    char buffer[100];
    strcpy(buffer, input); // potential buffer overflow
    std::cout << buffer << std::endl;
}","#include <iostream>
#include <cstring>

void unsafe_c_string(char* input) {
    char buffer[100];
    strcpy(buffer, input); // potential buffer overflow
    std::cout << buffer << std::endl;
}",cpp,1
Clear,"#include <iostream>
#include <string>
#include <vector>

void safe_string_handling(const std::string& input) {
    std::string safe_copy = input;
    std::cout << safe_copy << std::endl;
}","#include <iostream>
#include <string>
#include <vector>

void safe_string_handling(const std::string& input) {
    std::string safe_copy = input;
    std::cout << safe_copy << std::endl;
}",cpp,0
Clear,"To fix the Command Injection vulnerability in the provided Java code, you should sanitize and validate the user input before using it in the command execution. Here's an improved version of the code that addresses the vulnerability:

```java
import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class SecureCommandExecution {
    public static void main(String[] args) throws IOException {
        BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));

        System.out.print(""Enter a website to ping: "");
        String website = reader.readLine();

        // Sanitize and validate user input
        if (!isValidWebsite(website)) {
            System.out.println(""Invalid website. Please enter a valid website."");
            return;
        }

        // Secure code - Avoid command injection by using ProcessBuilder
        ProcessBuilder processBuilder = new ProcessBuilder(""ping"", website);
        
        Process process = processBuilder.start();

        BufferedReader inputReader = new BufferedReader(new InputStreamReader(process.getInputStream()));
        
        String inputLine;
        while ((inputLine = inputReader.readLine()) != null) {
            System.out.println(inputLine);
        }

        process.destroy();
    }

    // Simple validation for website format (you can enhance this as needed)
    private static boolean isValidWebsite(String website","To fix the Command Injection vulnerability in the provided Java code, you should sanitize and validate the user input before using it in the command execution. Here's an improved version of the code that addresses the vulnerability: ```java import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class SecureCommandExecution { public static void main(String[] args) throws IOException { BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a website to ping: ""); String website = reader.readLine(); // Sanitize and validate user input if (!isValidWebsite(website)) { System.out.println(""Invalid website. Please enter a valid website.""); return; } // Secure code - Avoid command injection by using ProcessBuilder ProcessBuilder processBuilder = new ProcessBuilder(""ping"", website); Process process = processBuilder.start(); BufferedReader inputReader = new BufferedReader(new InputStreamReader(process.getInputStream())); String inputLine; while ((inputLine = inputReader.readLine()) != null) { System.out.println(inputLine); } process.destroy(); } // Simple validation for website format (you can enhance this as needed) private static boolean isValidWebsite(String website",java,0
Clear,"To secure the code against Command Injection, you should not directly concatenate user input into the command string. Instead, you should validate and sanitize the user input before using it in the command execution. Here is an improved version of the code that utilizes a ProcessBuilder to construct and execute the command securely:

```java
import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class SecureCommandExecution {

    public static void main(String[] args) throws IOException {
        BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));

        System.out.print(""Enter a command to execute: "");
        String userInput = reader.readLine();

        // Validate and sanitize user input before using it in the command
        if (isValidCommand(userInput)) {
            String[] command = {""ping"", userInput};

            ProcessBuilder processBuilder = new ProcessBuilder(command);
            Process process = processBuilder.start();

            BufferedReader inputReader = new BufferedReader(new InputStreamReader(process.getInputStream()));
            String line;
            while ((line = inputReader.readLine()) != null) {
                System.out.println(line);
            }
        } else {
            System.out.println(""Invalid command input."");
        }
    }

    private static boolean isValidCommand(String userInput) {
        // Add your validation logic here to ensure","To secure the code against Command Injection, you should not directly concatenate user input into the command string. Instead, you should validate and sanitize the user input before using it in the command execution. Here is an improved version of the code that utilizes a ProcessBuilder to construct and execute the command securely: ```java import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class SecureCommandExecution { public static void main(String[] args) throws IOException { BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a command to execute: ""); String userInput = reader.readLine(); // Validate and sanitize user input before using it in the command if (isValidCommand(userInput)) { String[] command = {""ping"", userInput}; ProcessBuilder processBuilder = new ProcessBuilder(command); Process process = processBuilder.start(); BufferedReader inputReader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = inputReader.readLine()) != null) { System.out.println(line); } } else { System.out.println(""Invalid command input.""); } } private static boolean isValidCommand(String userInput) { // Add your validation logic here to ensure",java,0
SQL Injection,"import mysql.connector
def search_products(category):
    db = mysql.connector.connect(host=""localhost"", user=""user"", password=""pass"", database=""shop"")
    cursor = db.cursor()
    cursor.execute(""SELECT * FROM products WHERE category = '%s'"" % category)
    return cursor.fetchall()","import mysql.connector
def search_products(category):
    db = mysql.connector.connect(host=""localhost"", user=""user"", password=""pass"", database=""shop"")
    cursor = db.cursor()
    cursor.execute(""SELECT * FROM products WHERE category = '%s'"" % category)
    return cursor.fetchall()",python,1
Clear,"const token = process.env.API_TOKEN; // Environment variable
fetch('/api/data', {
    headers: { 'Authorization': `Bearer ${token}` }
});
","const token = process.env.API_TOKEN; // Environment variable
fetch('/api/data', {
    headers: { 'Authorization': `Bearer ${token}` }
});
",javascript,0
Clear,"#include <stdio.h>
#include <string.h>

int safe_buffer_operation(char *input) {
    char buffer[100];
    if (strlen(input) < sizeof(buffer)) {
        strcpy(buffer, input);
        return 0;
    }
    return -1; // buffer too small
}","#include <stdio.h>
#include <string.h>

int safe_buffer_operation(char *input) {
    char buffer[100];
    if (strlen(input) < sizeof(buffer)) {
        strcpy(buffer, input);
        return 0;
    }
    return -1; // buffer too small
}",c,0
Clear,"const shell = require('child_process');
const safeInput = userInput.replace(/[^a-zA-Z0-9.]/g, '');
shell.execFile('ping', [safeInput]); // Safe command execution
","const shell = require('child_process');
const safeInput = userInput.replace(/[^a-zA-Z0-9.]/g, '');
shell.execFile('ping', [safeInput]); // Safe command execution
",javascript,0
Clear,"app.get('/user/:id', (req, res) => {
    const userId = parseInt(req.params.id);
    db.query('SELECT * FROM users WHERE id = ?', [userId], (err, result) => {
        res.json(result);
    });
});
","app.get('/user/:id', (req, res) => {
    const userId = parseInt(req.params.id);
    db.query('SELECT * FROM users WHERE id = ?', [userId], (err, result) => {
        res.json(result);
    });
});
",javascript,0
Clear,"import java.io.*;
import javax.servlet.*;
import javax.servlet.http.*;
import org.owasp.encoder.Encode;

public class SecureServlet extends HttpServlet {
    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        String userInput = request.getParameter(""input"");
        String encodedUserInput = Encode.forHtml(userInput);
        String output = ""Hello, "" + encodedUserInput + ""!"";

        PrintWriter out = response.getWriter();
        out.println(""<html>"");
        out.println(""<body>"");
        out.println(""<h1>"" + output + ""</h1>"");
        out.println(""</body>"");
        out.println(""</html>"");
    }
}","import java.io.*; import javax.servlet.*; import javax.servlet.http.*; import org.owasp.encoder.Encode; public class SecureServlet extends HttpServlet { protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { String userInput = request.getParameter(""input""); String encodedUserInput = Encode.forHtml(userInput); String output = ""Hello, "" + encodedUserInput + ""!""; PrintWriter out = response.getWriter(); out.println(""<html>""); out.println(""<body>""); out.println(""<h1>"" + output + ""</h1>""); out.println(""</body>""); out.println(""</html>""); } }",java,0
Code Injection,"const userData = eval('(' + userInput + ')'); // eval injection
","const userData = eval('(' + userInput + ')'); // eval injection
",javascript,1
XSS,"const userInput = document.location.search.split('=')[1];
document.write(userInput); // XSS
","const userInput = document.location.search.split('=')[1];
document.write(userInput); // XSS
",javascript,1
Clear,"#include <iostream>
#include <string>
#include <vector>

void safe_string_handling(const std::string& input) {
    std::string safe_copy = input;
    std::cout << safe_copy << std::endl;
}","#include <iostream>
#include <string>
#include <vector>

void safe_string_handling(const std::string& input) {
    std::string safe_copy = input;
    std::cout << safe_copy << std::endl;
}",cpp,0
Clear,"#include <stdio.h>
#include <string.h>

int safe_buffer_operation(char *input) {
    char buffer[100];
    if (strlen(input) < sizeof(buffer)) {
        strcpy(buffer, input);
        return 0;
    }
    return -1; // buffer too small
}","#include <stdio.h>
#include <string.h>

int safe_buffer_operation(char *input) {
    char buffer[100];
    if (strlen(input) < sizeof(buffer)) {
        strcpy(buffer, input);
        return 0;
    }
    return -1; // buffer too small
}",c,0
Hardcoded Secrets,"localStorage.setItem('token', 'hardcoded-secret-token-123'); // Hardcoded secret
","localStorage.setItem('token', 'hardcoded-secret-token-123'); // Hardcoded secret
",javascript,1
Clear,"const shell = require('child_process');
const safeInput = userInput.replace(/[^a-zA-Z0-9.]/g, '');
shell.execFile('ping', [safeInput]); // Safe command execution
","const shell = require('child_process');
const safeInput = userInput.replace(/[^a-zA-Z0-9.]/g, '');
shell.execFile('ping', [safeInput]); // Safe command execution
",javascript,0
Clear,"import hashlib
import os

def hash_password(password):
    salt = os.urandom(32)
    key = hashlib.pbkdf2_hmac('sha256', password.encode(), salt, 100000)
    return salt + key","import hashlib
import os

def hash_password(password):
    salt = os.urandom(32)
    key = hashlib.pbkdf2_hmac('sha256', password.encode(), salt, 100000)
    return salt + key",python,0
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Clear,"from flask import Flask, request
import html
app = Flask(__name__)

@app.route('/search_safe')
def search_safe():
    query = request.args.get('q', '')
    safe_query = html.escape(query)
    return f'<h1>Search results for: {safe_query}</h1>'","from flask import Flask, request
import html
app = Flask(__name__)

@app.route('/search_safe')
def search_safe():
    query = request.args.get('q', '')
    safe_query = html.escape(query)
    return f'<h1>Search results for: {safe_query}</h1>'",python,0
Clear,"#include <iostream>
#include <sstream>

int safe_string_to_int(const std::string& str) {
    std::stringstream ss(str);
    int value;
    if (ss >> value) {
        return value;
    }
    throw std::invalid_argument(""Invalid integer"");
}","#include <iostream>
#include <sstream>

int safe_string_to_int(const std::string& str) {
    std::stringstream ss(str);
    int value;
    if (ss >> value) {
        return value;
    }
    throw std::invalid_argument(""Invalid integer"");
}",cpp,0
SQL Injection,"<?php
$username = $_POST['username'];
$query = ""SELECT * FROM users WHERE username = '$username'"";
$result = mysql_query($query); // SQL Injection
?>","<?php
$username = $_POST['username'];
$query = ""SELECT * FROM users WHERE username = '$username'"";
$result = mysql_query($query); // SQL Injection
?>",php,1
SSRF,"import urllib.request
def download_file(file_url):
    return urllib.request.urlopen(file_url).read()","import urllib.request
def download_file(file_url):
    return urllib.request.urlopen(file_url).read()",python,1
Clear,"#include <iostream>
#include <string>
#include <vector>

void safe_string_handling(const std::string& input) {
    std::string safe_copy = input;
    std::cout << safe_copy << std::endl;
}","#include <iostream>
#include <string>
#include <vector>

void safe_string_handling(const std::string& input) {
    std::string safe_copy = input;
    std::cout << safe_copy << std::endl;
}",cpp,0
Clear,"<?php
$message = htmlspecialchars($_GET['message'], ENT_QUOTES, 'UTF-8');
echo $message; // Sanitized output
?>","<?php
$message = htmlspecialchars($_GET['message'], ENT_QUOTES, 'UTF-8');
echo $message; // Sanitized output
?>",php,0
Clear,"To secure the code against insecure deserialization vulnerabilities, you can implement the following measures:

1. **Validate Input**: Ensure that the user input for the serialized object file is validated before deserializing it. This can prevent malicious input manipulation.

2. **Use a Whitelist**: Implement a whitelist of allowed classes that can be deserialized to restrict the types of objects that can be deserialized.

3. **Check Class Validation**: Validate the class type of the deserialized object to ensure it is of an expected type.

4. **Enable Security Manager**: Use Java Security Manager to restrict permissions and prevent potentially harmful operations during deserialization.

5. **Implement Custom Serialization**: Implement custom serialization methods using Externalizable interface to have more control over serialization and deserialization process.

Here's an updated version of your code with these security measures implemented:

```java
import java.io.*;

public class SecureDeserializationExample {
    
    public static void main(String[] args) {
        try {
            String userInput = ""input.ser""; // User input for serialized object file
            
            FileInputStream fis = new FileInputStream(userInput);
            ObjectInputStream ois = new ObjectInputStream(fis);
            
            // Check if class is allowed before deserializing
            Class<?> objClass","To secure the code against insecure deserialization vulnerabilities, you can implement the following measures: 1. **Validate Input**: Ensure that the user input for the serialized object file is validated before deserializing it. This can prevent malicious input manipulation. 2. **Use a Whitelist**: Implement a whitelist of allowed classes that can be deserialized to restrict the types of objects that can be deserialized. 3. **Check Class Validation**: Validate the class type of the deserialized object to ensure it is of an expected type. 4. **Enable Security Manager**: Use Java Security Manager to restrict permissions and prevent potentially harmful operations during deserialization. 5. **Implement Custom Serialization**: Implement custom serialization methods using Externalizable interface to have more control over serialization and deserialization process. Here's an updated version of your code with these security measures implemented: ```java import java.io.*; public class SecureDeserializationExample { public static void main(String[] args) { try { String userInput = ""input.ser""; // User input for serialized object file FileInputStream fis = new FileInputStream(userInput); ObjectInputStream ois = new ObjectInputStream(fis); // Check if class is allowed before deserializing Class<?> objClass",java,0
Command Injection,"import subprocess
def list_directory(path):
    result = subprocess.run(f""ls {path}"", shell=True, capture_output=True, text=True)
    return result.stdout","import subprocess
def list_directory(path):
    result = subprocess.run(f""ls {path}"", shell=True, capture_output=True, text=True)
    return result.stdout",python,1
Hardcoded Secrets,"DATABASE_PASSWORD = ""my_super_secret_password_123""
def db_connect():
    import psycopg2
    return psycopg2.connect(f""dbname=test user=admin password={DATABASE_PASSWORD}"")","DATABASE_PASSWORD = ""my_super_secret_password_123""
def db_connect():
    import psycopg2
    return psycopg2.connect(f""dbname=test user=admin password={DATABASE_PASSWORD}"")",python,1
Clear,"<?php
$cmd = escapeshellarg($_GET['cmd']);
system(""ls "" . $cmd); // Escaped command
?>","<?php
$cmd = escapeshellarg($_GET['cmd']);
system(""ls "" . $cmd); // Escaped command
?>",php,0
SQL Injection,"import java.sql.*;

public class SQLInjectionVulnerableCode {

    public static void main(String[] args) {
        try {
            // Simulated user input
            String userInput = ""'; DROP TABLE users; --"";

            // Vulnerable code where user input is directly concatenated into the SQL query
            String query = ""SELECT * FROM users WHERE username = '"" + userInput + ""'"";

            Connection connection = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");
            Statement statement = connection.createStatement();
            ResultSet resultSet = statement.executeQuery(query);

            while (resultSet.next()) {
                System.out.println(""Username: "" + resultSet.getString(""username""));
                System.out.println(""Password: "" + resultSet.getString(""password""));
            }

        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.*; public class SQLInjectionVulnerableCode { public static void main(String[] args) { try { // Simulated user input String userInput = ""'; DROP TABLE users; --""; // Vulnerable code where user input is directly concatenated into the SQL query String query = ""SELECT * FROM users WHERE username = '"" + userInput + ""'""; Connection connection = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); Statement statement = connection.createStatement(); ResultSet resultSet = statement.executeQuery(query); while (resultSet.next()) { System.out.println(""Username: "" + resultSet.getString(""username"")); System.out.println(""Password: "" + resultSet.getString(""password"")); } } catch (SQLException e) { e.printStackTrace(); } } }",java,1
Clear,"import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;
import java.util.ArrayList;
import java.util.List;

public class CommandInjectionSecure {

    public static void main(String[] args) throws IOException {
        BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));

        System.out.print(""Enter a directory name: "");
        String directoryName = reader.readLine();

        List<String> command = new ArrayList<>();
        command.add(""ls"");
        command.add(directoryName);

        ProcessBuilder processBuilder = new ProcessBuilder(command);
        
        Process process = processBuilder.start();
        
        BufferedReader processReader = new BufferedReader(new InputStreamReader(process.getInputStream()));
        String line;

        while ((line = processReader.readLine()) != null) {
            System.out.println(line);
        }
    }
}","import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; import java.util.ArrayList; import java.util.List; public class CommandInjectionSecure { public static void main(String[] args) throws IOException { BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a directory name: ""); String directoryName = reader.readLine(); List<String> command = new ArrayList<>(); command.add(""ls""); command.add(directoryName); ProcessBuilder processBuilder = new ProcessBuilder(command); Process process = processBuilder.start(); BufferedReader processReader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = processReader.readLine()) != null) { System.out.println(line); } } }",java,0
Cross-Site Scripting (XSS),"from flask import Flask, request
app = Flask(__name__)

@app.route('/search')
def search():
    query = request.args.get('q', '')
    return f'<h1>Search results for: {query}</h1>'","from flask import Flask, request
app = Flask(__name__)

@app.route('/search')
def search():
    query = request.args.get('q', '')
    return f'<h1>Search results for: {query}</h1>'",python,1
Code Injection,"const userData = eval('(' + userInput + ')'); // eval injection
","const userData = eval('(' + userInput + ')'); // eval injection
",javascript,1
SQL Injection,"import mysql.connector
def search_products(category):
    db = mysql.connector.connect(host=""localhost"", user=""user"", password=""pass"", database=""shop"")
    cursor = db.cursor()
    cursor.execute(""SELECT * FROM products WHERE category = '%s'"" % category)
    return cursor.fetchall()","import mysql.connector
def search_products(category):
    db = mysql.connector.connect(host=""localhost"", user=""user"", password=""pass"", database=""shop"")
    cursor = db.cursor()
    cursor.execute(""SELECT * FROM products WHERE category = '%s'"" % category)
    return cursor.fetchall()",python,1
Clear,"To fix the insecure deserialization vulnerability in the given code snippet, you need to implement proper security measures to prevent potential attacks such as object injection, code execution, or data manipulation through deserialization.

Here are some steps to secure the deserialization process in Java:

1. Use a Secure Deserialization Library:
   - Consider using a secure deserialization library like Jackson or Gson that provides additional security features to prevent common vulnerabilities associated with Java deserialization.

2. Implement Input Validation:
   - Validate the input data before deserializing it to ensure it comes from a trusted and expected source.
   - Perform data validation checks on the serialized input data to prevent malicious payloads.

3. Use Whitelisting:
   - Implement whitelisting of allowed classes during deserialization to restrict which classes can be instantiated.
   - Avoid deserializing arbitrary classes sent by an untrusted source.

4. Enable Security Manager:
   - Configure and enable a Security Manager to control the permissions granted during deserialization.
   - Define a custom Security Policy that restricts access to sensitive resources and operations during deserialization.

5. Implement Custom Serialization:
   - For critical classes, consider implementing custom serialization methods (writeObject, readObject) with proper validation checks and safeguards against malicious","To fix the insecure deserialization vulnerability in the given code snippet, you need to implement proper security measures to prevent potential attacks such as object injection, code execution, or data manipulation through deserialization. Here are some steps to secure the deserialization process in Java: 1. Use a Secure Deserialization Library: - Consider using a secure deserialization library like Jackson or Gson that provides additional security features to prevent common vulnerabilities associated with Java deserialization. 2. Implement Input Validation: - Validate the input data before deserializing it to ensure it comes from a trusted and expected source. - Perform data validation checks on the serialized input data to prevent malicious payloads. 3. Use Whitelisting: - Implement whitelisting of allowed classes during deserialization to restrict which classes can be instantiated. - Avoid deserializing arbitrary classes sent by an untrusted source. 4. Enable Security Manager: - Configure and enable a Security Manager to control the permissions granted during deserialization. - Define a custom Security Policy that restricts access to sensitive resources and operations during deserialization. 5. Implement Custom Serialization: - For critical classes, consider implementing custom serialization methods (writeObject, readObject) with proper validation checks and safeguards against malicious",php,0
Clear,"const token = process.env.API_TOKEN; // Environment variable
fetch('/api/data', {
    headers: { 'Authorization': `Bearer ${token}` }
});
","const token = process.env.API_TOKEN; // Environment variable
fetch('/api/data', {
    headers: { 'Authorization': `Bearer ${token}` }
});
",javascript,0
Clear,"#include <stdio.h>
#include <string.h>

void safe_string_copy(char *dest, const char *src, size_t dest_size) {
    if (dest_size > 0) {
        strncpy(dest, src, dest_size - 1);
        dest[dest_size - 1] = '\0';
    }
}","#include <stdio.h>
#include <string.h>

void safe_string_copy(char *dest, const char *src, size_t dest_size) {
    if (dest_size > 0) {
        strncpy(dest, src, dest_size - 1);
        dest[dest_size - 1] = '\0';
    }
}",c,0
SQL Injection,"import java.sql.*;

public class SQLInjectionVulnerable {

    public static void main(String[] args) {
        try {
            String userInput = ""'; DROP TABLE users; --""; // User input with malicious SQL injection
            String query = ""SELECT * FROM users WHERE username = '"" + userInput + ""'"";

            Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");
            Statement stmt = conn.createStatement();
            ResultSet rs = stmt.executeQuery(query);

            while (rs.next()) {
                System.out.println(""Username: "" + rs.getString(""username""));
                System.out.println(""Password: "" + rs.getString(""password""));
            }

            conn.close();
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.*; public class SQLInjectionVulnerable { public static void main(String[] args) { try { String userInput = ""'; DROP TABLE users; --""; // User input with malicious SQL injection String query = ""SELECT * FROM users WHERE username = '"" + userInput + ""'""; Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); Statement stmt = conn.createStatement(); ResultSet rs = stmt.executeQuery(query); while (rs.next()) { System.out.println(""Username: "" + rs.getString(""username"")); System.out.println(""Password: "" + rs.getString(""password"")); } conn.close(); } catch (SQLException e) { e.printStackTrace(); } } }",java,1
SQL Injection,"import java.sql.*;

public class SQLInjectionExample {
    public static void main(String[] args) {
        String userInput = ""'; DROP TABLE users; --""; // This simulates malicious user input
        
        try {
            Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");
            Statement stmt = conn.createStatement();
            
            // Vulnerable code - concatenating user input directly into the SQL query
            String query = ""SELECT * FROM users WHERE username = '"" + userInput + ""'"";
            
            ResultSet rs = stmt.executeQuery(query);
            
            while (rs.next()) {
                System.out.println(""User found: "" + rs.getString(""username""));
            }
            
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.*; public class SQLInjectionExample { public static void main(String[] args) { String userInput = ""'; DROP TABLE users; --""; // This simulates malicious user input try { Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); Statement stmt = conn.createStatement(); // Vulnerable code - concatenating user input directly into the SQL query String query = ""SELECT * FROM users WHERE username = '"" + userInput + ""'""; ResultSet rs = stmt.executeQuery(query); while (rs.next()) { System.out.println(""User found: "" + rs.getString(""username"")); } } catch (SQLException e) { e.printStackTrace(); } } }",java,1
Clear,"To fix this insecure deserialization vulnerability in the provided Java code snippet, we need to implement proper security measures. Here are the steps to enhance the security of deserialization:

1. Use a Safe Deserialization Mechanism:
   Avoid using Java Object Serialization for deserialization due to its inherent security risks. Instead, consider using safer alternatives like JSON or XML serialization libraries that allow for controlled deserialization.

2. Implement Input Validation:
   Validate and sanitize user input before deserializing it to prevent malicious data from being processed. Check the integrity of the input data and only deserialize trusted sources.

3. Use a Secure Deserialization Library:
   Utilize secure deserialization libraries like Jackson or Gson with proper configurations to prevent common vulnerabilities such as arbitrary code execution through gadgets.

4. Enable Class Whitelisting/Blacklisting:
   Maintain a whitelist of allowed classes for deserialization to restrict which classes can be instantiated during the deserialization process. Avoid using default serialization mechanisms that can instantiate arbitrary classes.

5. Perform Code Review and Testing:
   Thoroughly review the code for any potential security vulnerabilities related to deserialization. Conduct security testing, including penetration testing and fuzz testing, to identify and address any weaknesses.

Here is an updated version of your code snippet with","To fix this insecure deserialization vulnerability in the provided Java code snippet, we need to implement proper security measures. Here are the steps to enhance the security of deserialization: 1. Use a Safe Deserialization Mechanism: Avoid using Java Object Serialization for deserialization due to its inherent security risks. Instead, consider using safer alternatives like JSON or XML serialization libraries that allow for controlled deserialization. 2. Implement Input Validation: Validate and sanitize user input before deserializing it to prevent malicious data from being processed. Check the integrity of the input data and only deserialize trusted sources. 3. Use a Secure Deserialization Library: Utilize secure deserialization libraries like Jackson or Gson with proper configurations to prevent common vulnerabilities such as arbitrary code execution through gadgets. 4. Enable Class Whitelisting/Blacklisting: Maintain a whitelist of allowed classes for deserialization to restrict which classes can be instantiated during the deserialization process. Avoid using default serialization mechanisms that can instantiate arbitrary classes. 5. Perform Code Review and Testing: Thoroughly review the code for any potential security vulnerabilities related to deserialization. Conduct security testing, including penetration testing and fuzz testing, to identify and address any weaknesses. Here is an updated version of your code snippet with",php,0
Cross-Site Scripting (XSS),"import java.io.IOException;
import javax.servlet.ServletException;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

public class VulnerableServlet extends HttpServlet {

    protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        String userInput = request.getParameter(""input"");
        
        String output = ""<html><body>User input: "" + userInput + ""</body></html>"";
        
        response.getWriter().write(output);
    }
}","import java.io.IOException; import javax.servlet.ServletException; import javax.servlet.http.HttpServlet; import javax.servlet.http.HttpServletRequest; import javax.servlet.http.HttpServletResponse; public class VulnerableServlet extends HttpServlet { protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { String userInput = request.getParameter(""input""); String output = ""<html><body>User input: "" + userInput + ""</body></html>""; response.getWriter().write(output); } }",java,1
Clear,"import java.io.*;
import javax.servlet.*;
import javax.servlet.http.*;

import org.owasp.encoder.Encode;

public class XSSSafeServlet extends HttpServlet {
    protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        String userInput = request.getParameter(""input"");
        
        String encodedUserInput = Encode.forHtml(userInput);
        
        String htmlResponse = ""<html><body>User input: "" + encodedUserInput + ""</body></html>"";
        
        response.getWriter().write(htmlResponse);
    }
}","import java.io.*; import javax.servlet.*; import javax.servlet.http.*; import org.owasp.encoder.Encode; public class XSSSafeServlet extends HttpServlet { protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { String userInput = request.getParameter(""input""); String encodedUserInput = Encode.forHtml(userInput); String htmlResponse = ""<html><body>User input: "" + encodedUserInput + ""</body></html>""; response.getWriter().write(htmlResponse); } }",java,0
Clear,"const token = process.env.API_TOKEN; // Environment variable
fetch('/api/data', {
    headers: { 'Authorization': `Bearer ${token}` }
});
","const token = process.env.API_TOKEN; // Environment variable
fetch('/api/data', {
    headers: { 'Authorization': `Bearer ${token}` }
});
",javascript,0
Clear,"const shell = require('child_process');
const safeInput = userInput.replace(/[^a-zA-Z0-9.]/g, '');
shell.execFile('ping', [safeInput]); // Safe command execution
","const shell = require('child_process');
const safeInput = userInput.replace(/[^a-zA-Z0-9.]/g, '');
shell.execFile('ping', [safeInput]); // Safe command execution
",javascript,0
SQL Injection,"app.get('/user/:id', (req, res) => {
    const query = `SELECT * FROM users WHERE id = ${req.params.id}`; // SQL Injection
    db.query(query, (err, result) => {
        res.json(result);
    });
});
","app.get('/user/:id', (req, res) => {
    const query = `SELECT * FROM users WHERE id = ${req.params.id}`; // SQL Injection
    db.query(query, (err, result) => {
        res.json(result);
    });
});
",javascript,1
Clear,"def safe_comment_display(comment_text):
    import html
    escaped_text = html.escape(comment_text)
    return f""<div class='comment'>{escaped_text}</div>"" ","def safe_comment_display(comment_text):
    import html
    escaped_text = html.escape(comment_text)
    return f""<div class='comment'>{escaped_text}</div>"" ",python,0
Code Injection,"const userData = eval('(' + userInput + ')'); // eval injection
","const userData = eval('(' + userInput + ')'); // eval injection
",javascript,1
SQL Injection,"app.get('/user/:id', (req, res) => {
    const query = `SELECT * FROM users WHERE id = ${req.params.id}`; // SQL Injection
    db.query(query, (err, result) => {
        res.json(result);
    });
});
","app.get('/user/:id', (req, res) => {
    const query = `SELECT * FROM users WHERE id = ${req.params.id}`; // SQL Injection
    db.query(query, (err, result) => {
        res.json(result);
    });
});
",javascript,1
Path Traversal,"import os
def read_file(filename):
    with open('/var/www/uploads/' + filename, 'r') as f:
        return f.read()","import os
def read_file(filename):
    with open('/var/www/uploads/' + filename, 'r') as f:
        return f.read()",python,1
SQL Injection,"import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.ResultSet;
import java.sql.Statement;
import java.util.Scanner;

public class SQLInjectionVulnerable {

    public static void main(String[] args) {
        try {
            Scanner scanner = new Scanner(System.in);
            System.out.println(""Enter a username to search for: "");
            String userInput = scanner.nextLine();

            // Vulnerable code that concatenates user input directly into the SQL query
            String query = ""SELECT * FROM users WHERE username = '"" + userInput + ""'"";
            
            Connection connection = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");
            Statement statement = connection.createStatement();
            
            ResultSet resultSet = statement.executeQuery(query);
            
            while(resultSet.next()) {
                System.out.println(""User found: "" + resultSet.getString(""username""));
            }
            
            resultSet.close();
            statement.close();
            connection.close();

        } catch (Exception e) {
            e.printStackTrace();
        }
    }
}","import java.sql.Connection; import java.sql.DriverManager; import java.sql.ResultSet; import java.sql.Statement; import java.util.Scanner; public class SQLInjectionVulnerable { public static void main(String[] args) { try { Scanner scanner = new Scanner(System.in); System.out.println(""Enter a username to search for: ""); String userInput = scanner.nextLine(); // Vulnerable code that concatenates user input directly into the SQL query String query = ""SELECT * FROM users WHERE username = '"" + userInput + ""'""; Connection connection = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); Statement statement = connection.createStatement(); ResultSet resultSet = statement.executeQuery(query); while(resultSet.next()) { System.out.println(""User found: "" + resultSet.getString(""username"")); } resultSet.close(); statement.close(); connection.close(); } catch (Exception e) { e.printStackTrace(); } } }",java,1
Clear,"#include <iostream>
#include <vector>
#include <stdexcept>

int safe_vector_access(const std::vector<int>& vec, size_t index) {
    if (index >= vec.size()) {
        throw std::out_of_range(""Index out of range"");
    }
    return vec[index];
}","#include <iostream>
#include <vector>
#include <stdexcept>

int safe_vector_access(const std::vector<int>& vec, size_t index) {
    if (index >= vec.size()) {
        throw std::out_of_range(""Index out of range"");
    }
    return vec[index];
}",cpp,0
Clear,"#include <stdio.h>
#include <stdlib.h>

int safe_string_to_int(const char *str) {
    char *endptr;
    long value = strtol(str, &endptr, 10);
    if (*endptr != '\0' || str == endptr) {
        return -1; // error
    }
    return (int)value;
}","#include <stdio.h>
#include <stdlib.h>

int safe_string_to_int(const char *str) {
    char *endptr;
    long value = strtol(str, &endptr, 10);
    if (*endptr != '\0' || str == endptr) {
        return -1; // error
    }
    return (int)value;
}",c,0
Cross-Site Scripting (XSS),"import java.io.*;

public class XSSVulnerableCode {

    public static void main(String[] args) {
        BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));
        
        System.out.print(""Enter your name: "");
        String userInput = """";
        try {
            userInput = reader.readLine();
        } catch (IOException e) {
            e.printStackTrace();
        }
        
        System.out.println(""Hello, "" + userInput + ""!""); // Vulnerability here
        
    }
}","import java.io.*; public class XSSVulnerableCode { public static void main(String[] args) { BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter your name: ""); String userInput = """"; try { userInput = reader.readLine(); } catch (IOException e) { e.printStackTrace(); } System.out.println(""Hello, "" + userInput + ""!""); // Vulnerability here } }",java,1
SQL Injection,"<?php
$username = $_POST['username'];
$query = ""SELECT * FROM users WHERE username = '$username'"";
$result = mysql_query($query); // SQL Injection
?>","<?php
$username = $_POST['username'];
$query = ""SELECT * FROM users WHERE username = '$username'"";
$result = mysql_query($query); // SQL Injection
?>",php,1
Clear,"import subprocess
def safe_database_backup(db_name):
    result = subprocess.run(['pg_dump', db_name], capture_output=True, text=True)
    with open('backup.sql', 'w') as f:
        f.write(result.stdout)","import subprocess
def safe_database_backup(db_name):
    result = subprocess.run(['pg_dump', db_name], capture_output=True, text=True)
    with open('backup.sql', 'w') as f:
        f.write(result.stdout)",python,0
Clear,"<?php
$username = $_POST['username'];
$stmt = $pdo->prepare(""SELECT * FROM users WHERE username = ?"");
$stmt->execute([$username]); // Parameterized query
?>","<?php
$username = $_POST['username'];
$stmt = $pdo->prepare(""SELECT * FROM users WHERE username = ?"");
$stmt->execute([$username]); // Parameterized query
?>",php,0
Clear,"import java.sql.*;

public class SQLInjectionFixed {
    public static void main(String[] args) {
        String username = args[0]; // User input - should be sanitized
        String password = ""123456""; // Fixed password for demo purposes
        
        try {
            Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""root"", ""password"");
            
            String query = ""SELECT * FROM users WHERE username=? AND password=?"";
            PreparedStatement pstmt = conn.prepareStatement(query);
            pstmt.setString(1, username);
            pstmt.setString(2, password);
            
            ResultSet rs = pstmt.executeQuery();
            
            while(rs.next()) {
                System.out.println(""Welcome, "" + rs.getString(""username""));
            }
            
            conn.close();
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.*; public class SQLInjectionFixed { public static void main(String[] args) { String username = args[0]; // User input - should be sanitized String password = ""123456""; // Fixed password for demo purposes try { Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""root"", ""password""); String query = ""SELECT * FROM users WHERE username=? AND password=?""; PreparedStatement pstmt = conn.prepareStatement(query); pstmt.setString(1, username); pstmt.setString(2, password); ResultSet rs = pstmt.executeQuery(); while(rs.next()) { System.out.println(""Welcome, "" + rs.getString(""username"")); } conn.close(); } catch (SQLException e) { e.printStackTrace(); } } }",java,0
Clear,"#include <iostream>
#include <string>
#include <vector>

void safe_string_handling(const std::string& input) {
    std::string safe_copy = input;
    std::cout << safe_copy << std::endl;
}","#include <iostream>
#include <string>
#include <vector>

void safe_string_handling(const std::string& input) {
    std::string safe_copy = input;
    std::cout << safe_copy << std::endl;
}",cpp,0
XSS,"<?php
echo $_GET['message']; // XSS
?>","<?php
echo $_GET['message']; // XSS
?>",php,1
Memory Corruption,"#include <iostream>

void unsafe_pointer_arithmetic(int* array, int size) {
    for (int i = 0; i <= size; i++) {
        std::cout << *(array + i) << std::endl; // potential out-of-bounds
    }
}","#include <iostream>

void unsafe_pointer_arithmetic(int* array, int size) {
    for (int i = 0; i <= size; i++) {
        std::cout << *(array + i) << std::endl; // potential out-of-bounds
    }
}",cpp,1
Cross-Site Scripting (XSS),"import java.io.*;
import javax.servlet.*;
import javax.servlet.http.*;

public class XSSVulnerableServlet extends HttpServlet {
    protected void doGet(HttpServletRequest request, HttpServletResponse response)
            throws ServletException, IOException {
        String userInput = request.getParameter(""input"");
        String output = ""<p>User input: "" + userInput + ""</p>"";

        PrintWriter out = response.getWriter();
        out.println(output);
    }
}","import java.io.*; import javax.servlet.*; import javax.servlet.http.*; public class XSSVulnerableServlet extends HttpServlet { protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { String userInput = request.getParameter(""input""); String output = ""<p>User input: "" + userInput + ""</p>""; PrintWriter out = response.getWriter(); out.println(output); } }",java,1
Hardcoded Secrets,"import requests
def call_api():
    api_key = ""sk_live_1234567890abcdef""
    headers = {'Authorization': f'Bearer {api_key}'}
    return requests.get('https://api.example.com/data', headers=headers)","import requests
def call_api():
    api_key = ""sk_live_1234567890abcdef""
    headers = {'Authorization': f'Bearer {api_key}'}
    return requests.get('https://api.example.com/data', headers=headers)",python,1
Clear,"const userData = JSON.parse(userInput); // Safe JSON parsing
if (userData && typeof userData === 'object') {
    processUserData(userData);
}
","const userData = JSON.parse(userInput); // Safe JSON parsing
if (userData && typeof userData === 'object') {
    processUserData(userData);
}
",javascript,0
Out-of-Bounds,"#include <iostream>

class UnsafeClass {
    int data[10];
public:
    int get_data(int index) {
        return data[index]; // no bounds checking
    }
};","#include <iostream>

class UnsafeClass {
    int data[10];
public:
    int get_data(int index) {
        return data[index]; // no bounds checking
    }
};",cpp,1
XSS,"const userInput = document.location.search.split('=')[1];
document.write(userInput); // XSS
","const userInput = document.location.search.split('=')[1];
document.write(userInput); // XSS
",javascript,1
XSS,"const userInput = document.location.search.split('=')[1];
document.write(userInput); // XSS
","const userInput = document.location.search.split('=')[1];
document.write(userInput); // XSS
",javascript,1
Clear,"import tempfile
import os

def create_secure_temp(data):
    with tempfile.NamedTemporaryFile(mode='w', delete=True, suffix='.tmp') as temp:
        temp.write(data)
        temp.flush()
        return temp.name","import tempfile
import os

def create_secure_temp(data):
    with tempfile.NamedTemporaryFile(mode='w', delete=True, suffix='.tmp') as temp:
        temp.write(data)
        temp.flush()
        return temp.name",python,0
Clear,"<?php
$file = basename($_GET['file']);
$allowed = ['page1.php', 'page2.php'];
if (in_array($file, $allowed)) {
    include($file);
}
?>","<?php
$file = basename($_GET['file']);
$allowed = ['page1.php', 'page2.php'];
if (in_array($file, $allowed)) {
    include($file);
}
?>",php,0
Clear,"import java.util.Scanner;

public class SecureBufferExample {
    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);

        System.out.print(""Enter a string: "");
        String input = scanner.nextLine();

        StringBuilder buffer = new StringBuilder();
        buffer.append(input);

        System.out.println(""Buffer content: "" + buffer.toString());

        scanner.close();
    }
}","import java.util.Scanner; public class SecureBufferExample { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter a string: ""); String input = scanner.nextLine(); StringBuilder buffer = new StringBuilder(); buffer.append(input); System.out.println(""Buffer content: "" + buffer.toString()); scanner.close(); } }",java,0
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Clear,"import tempfile
import os

def create_secure_temp(data):
    with tempfile.NamedTemporaryFile(mode='w', delete=True, suffix='.tmp') as temp:
        temp.write(data)
        temp.flush()
        return temp.name","import tempfile
import os

def create_secure_temp(data):
    with tempfile.NamedTemporaryFile(mode='w', delete=True, suffix='.tmp') as temp:
        temp.write(data)
        temp.flush()
        return temp.name",python,0
Clear,"import java.io.*;
import javax.servlet.*;
import javax.servlet.http.*;

public class XSSFixedServlet extends HttpServlet {
    protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        String userInput = request.getParameter(""input"");
        String sanitizedInput = escapeHtml(userInput);
        String responseMessage = ""Hello, "" + sanitizedInput + ""!"";

        PrintWriter out = response.getWriter();
        out.println(""<html>"");
        out.println(""<body>"");
        out.println(""<h1>"" + responseMessage + ""</h1>"");
        out.println(""</body>"");
        out.println(""</html>"");
    }

    private String escapeHtml(String input) {
        return input
            .replace(""&"", ""&amp;"")
            .replace(""<"", ""&lt;"")
            .replace("">"", ""&gt;"")
            .replace(""\"""", ""&quot;"")
            .replace(""'"", ""&#39;"");
    }
}","import java.io.*; import javax.servlet.*; import javax.servlet.http.*; public class XSSFixedServlet extends HttpServlet { protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { String userInput = request.getParameter(""input""); String sanitizedInput = escapeHtml(userInput); String responseMessage = ""Hello, "" + sanitizedInput + ""!""; PrintWriter out = response.getWriter(); out.println(""<html>""); out.println(""<body>""); out.println(""<h1>"" + responseMessage + ""</h1>""); out.println(""</body>""); out.println(""</html>""); } private String escapeHtml(String input) { return input .replace(""&"", ""&amp;"") .replace(""<"", ""&lt;"") .replace("">"", ""&gt;"") .replace(""\"""", ""&quot;"") .replace(""'"", ""&#39;""); } }",java,0
Clear,"To fix the buffer overflow vulnerability in the provided Java code snippet, you can implement the following secure code generation practices:

1. Use `Scanner.nextLine()` instead of `Scanner.next()` to read the entire input line, including spaces. This helps prevent buffer overflow caused by reading only part of the input.

2. Limit the size of the input to prevent buffer overflow. You can enforce a maximum input length and handle cases where the input exceeds this limit.

3. Use a dynamic data structure like `StringBuilder` instead of fixed-size arrays to store and manipulate strings. This eliminates the risk of buffer overflow due to exceeding array bounds.

Here is an updated version of the code with these security measures implemented:

```java
import java.util.Scanner;

public class SecureBuffer {

    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        
        System.out.print(""Enter a string: "");
        String input = scanner.nextLine(); // Read the whole line
        
        int maxLength = 10; // Maximum length for buffer
        if (input.length() > maxLength) {
            System.out.println(""Input exceeds maximum length."");
            return;
        }
        
        char[] buffer = new char[maxLength]; // Fixed size buffer","To fix the buffer overflow vulnerability in the provided Java code snippet, you can implement the following secure code generation practices: 1. Use `Scanner.nextLine()` instead of `Scanner.next()` to read the entire input line, including spaces. This helps prevent buffer overflow caused by reading only part of the input. 2. Limit the size of the input to prevent buffer overflow. You can enforce a maximum input length and handle cases where the input exceeds this limit. 3. Use a dynamic data structure like `StringBuilder` instead of fixed-size arrays to store and manipulate strings. This eliminates the risk of buffer overflow due to exceeding array bounds. Here is an updated version of the code with these security measures implemented: ```java import java.util.Scanner; public class SecureBuffer { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter a string: ""); String input = scanner.nextLine(); // Read the whole line int maxLength = 10; // Maximum length for buffer if (input.length() > maxLength) { System.out.println(""Input exceeds maximum length.""); return; } char[] buffer = new char[maxLength]; // Fixed size buffer",java,0
Code Injection,"const userData = eval('(' + userInput + ')'); // eval injection
","const userData = eval('(' + userInput + ')'); // eval injection
",javascript,1
Code Injection,"const userData = eval('(' + userInput + ')'); // eval injection
","const userData = eval('(' + userInput + ')'); // eval injection
",javascript,1
Insecure Deserialization,"<?php
$data = $_POST['data'];
unserialize($data); // Insecure Deserialization
?>","<?php
$data = $_POST['data'];
unserialize($data); // Insecure Deserialization
?>",php,1
Clear,"To fix the Path Traversal vulnerability in the provided Java code snippet, you can implement the following secure code generation practices:

1. Sanitize User Input:
   - Ensure that the user input (file name) is properly sanitized to prevent any malicious input that could lead to path traversal attacks. One way to sanitize input is by validating it against a whitelist of allowed characters or using a regular expression pattern.

2. Use Absolute Paths:
   - Instead of directly concatenating the file name with a base directory path, use absolute paths to ensure that the file is accessed from a specific location. This prevents attackers from navigating outside the intended directory.

3. Validate File Existence and Location:
   - Before attempting to read the file, validate that the file exists and is located within an expected directory structure. You can use methods like `File.exists()` and `File.getCanonicalPath()` to validate this.

4. Implement Access Controls:
   - Ensure that the application has appropriate access controls in place to restrict access to sensitive files or directories. Consider using file permissions and access control mechanisms provided by the operating system.

5. Use Try-With-Resources:
   - Use try-with-resources statement for handling resources like FileInputStream to automatically close them when they are no longer needed","To fix the Path Traversal vulnerability in the provided Java code snippet, you can implement the following secure code generation practices: 1. Sanitize User Input: - Ensure that the user input (file name) is properly sanitized to prevent any malicious input that could lead to path traversal attacks. One way to sanitize input is by validating it against a whitelist of allowed characters or using a regular expression pattern. 2. Use Absolute Paths: - Instead of directly concatenating the file name with a base directory path, use absolute paths to ensure that the file is accessed from a specific location. This prevents attackers from navigating outside the intended directory. 3. Validate File Existence and Location: - Before attempting to read the file, validate that the file exists and is located within an expected directory structure. You can use methods like `File.exists()` and `File.getCanonicalPath()` to validate this. 4. Implement Access Controls: - Ensure that the application has appropriate access controls in place to restrict access to sensitive files or directories. Consider using file permissions and access control mechanisms provided by the operating system. 5. Use Try-With-Resources: - Use try-with-resources statement for handling resources like FileInputStream to automatically close them when they are no longer needed",php,0
Clear,"#include <stdio.h>
#include <string.h>

void safe_string_copy(char *dest, const char *src, size_t dest_size) {
    if (dest_size > 0) {
        strncpy(dest, src, dest_size - 1);
        dest[dest_size - 1] = '\0';
    }
}","#include <stdio.h>
#include <string.h>

void safe_string_copy(char *dest, const char *src, size_t dest_size) {
    if (dest_size > 0) {
        strncpy(dest, src, dest_size - 1);
        dest[dest_size - 1] = '\0';
    }
}",c,0
Cross-Site Scripting (XSS),"import java.io.IOException;
import java.io.PrintWriter;

public class XSSVulnerableCode {
    public static void main(String[] args) {
        String userInput = ""<script>alert('XSS Attack!')</script>"";

        // Improper handling of user input
        String output = ""<p>"" + userInput + ""</p>"";

        try {
            PrintWriter out = new PrintWriter(""output.html"");
            out.println(output);
            out.close();
        } catch (IOException e) {
            System.out.println(""Error writing output file: "" + e.getMessage());
        }
    }
}","import java.io.IOException; import java.io.PrintWriter; public class XSSVulnerableCode { public static void main(String[] args) { String userInput = ""<script>alert('XSS Attack!')</script>""; // Improper handling of user input String output = ""<p>"" + userInput + ""</p>""; try { PrintWriter out = new PrintWriter(""output.html""); out.println(output); out.close(); } catch (IOException e) { System.out.println(""Error writing output file: "" + e.getMessage()); } } }",java,1
Path Traversal,"def get_user_file(username, filepath):
    import os
    base_path = f""/home/{username}/files/""
    full_path = base_path + filepath
    with open(full_path, 'r') as f:
        return f.read()","def get_user_file(username, filepath):
    import os
    base_path = f""/home/{username}/files/""
    full_path = base_path + filepath
    with open(full_path, 'r') as f:
        return f.read()",python,1
Clear,"def safe_comment_display(comment_text):
    import html
    escaped_text = html.escape(comment_text)
    return f""<div class='comment'>{escaped_text}</div>"" ","def safe_comment_display(comment_text):
    import html
    escaped_text = html.escape(comment_text)
    return f""<div class='comment'>{escaped_text}</div>"" ",python,0
Clear,"import os
def safe_read_file(filename):
    base_path = '/var/www/uploads/'
    full_path = os.path.join(base_path, filename)
    full_path = os.path.normpath(full_path)
    if not full_path.startswith(base_path):
        raise ValueError(""Path traversal detected"")
    with open(full_path, 'r') as f:
        return f.read()","import os
def safe_read_file(filename):
    base_path = '/var/www/uploads/'
    full_path = os.path.join(base_path, filename)
    full_path = os.path.normpath(full_path)
    if not full_path.startswith(base_path):
        raise ValueError(""Path traversal detected"")
    with open(full_path, 'r') as f:
        return f.read()",python,0
Clear,"const token = process.env.API_TOKEN; // Environment variable
fetch('/api/data', {
    headers: { 'Authorization': `Bearer ${token}` }
});
","const token = process.env.API_TOKEN; // Environment variable
fetch('/api/data', {
    headers: { 'Authorization': `Bearer ${token}` }
});
",javascript,0
Clear,"To fix the XSS vulnerability in the provided Java code snippet, you should ensure that user input is properly sanitized before embedding it into the HTML response. One common approach to prevent XSS attacks is to escape special characters in the user input before rendering it in the HTML output. Here's an example of how you can modify the code to address this issue:

```java
import java.io.IOException;
import java.io.PrintWriter;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

public class XSSFixedServlet extends HttpServlet {

    protected void doPost(HttpServletRequest request, HttpServletResponse response) throws IOException {
        String userInput = request.getParameter(""input"");
        PrintWriter out = response.getWriter();

        out.println(""<html>"");
        out.println(""<body>"");
        out.println(""<h1>User Input:</h1>"");
        out.println(""<p>"" + escapeHtml(userInput) + ""</p>""); // Sanitize user input by escaping HTML special characters
        out.println(""</body>"");
        out.println(""</html>"");
    }

    private String escapeHtml(String input) {
        if (input == null) {
            return """";
        }
        
        return input
            .replaceAll(""&"", ""&amp;"")
            .replaceAll(""<"", ""&lt;"")
            .replaceAll(""","To fix the XSS vulnerability in the provided Java code snippet, you should ensure that user input is properly sanitized before embedding it into the HTML response. One common approach to prevent XSS attacks is to escape special characters in the user input before rendering it in the HTML output. Here's an example of how you can modify the code to address this issue: ```java import java.io.IOException; import java.io.PrintWriter; import javax.servlet.http.HttpServlet; import javax.servlet.http.HttpServletRequest; import javax.servlet.http.HttpServletResponse; public class XSSFixedServlet extends HttpServlet { protected void doPost(HttpServletRequest request, HttpServletResponse response) throws IOException { String userInput = request.getParameter(""input""); PrintWriter out = response.getWriter(); out.println(""<html>""); out.println(""<body>""); out.println(""<h1>User Input:</h1>""); out.println(""<p>"" + escapeHtml(userInput) + ""</p>""); // Sanitize user input by escaping HTML special characters out.println(""</body>""); out.println(""</html>""); } private String escapeHtml(String input) { if (input == null) { return """"; } return input .replaceAll(""&"", ""&amp;"") .replaceAll(""<"", ""&lt;"") .replaceAll(""",java,0
Clear,"This code snippet demonstrates a common vulnerability related to insecure deserialization in Java. Insecure deserialization can lead to various security risks, including remote code execution and data tampering.

To fix this code and implement proper security measures for deserialization, you can consider the following recommendations:

1. **Implement Input Validation:** Validate the input data before deserializing it to ensure that it comes from a trusted and expected source. This can help prevent malicious objects from being deserialized.

2. **Use a Secure Deserialization Framework:** Consider using a secure deserialization framework that provides additional protection against common attacks, such as Apache Commons Collections (ACC) or Java Serialization Filter (JSF).

3. **Implement Whitelisting/Blacklisting:** Implement a whitelist or blacklist approach to restrict the types of classes that can be deserialized. Whitelisting allows only specified classes to be deserialized, while blacklisting blocks known dangerous classes.

4. **Enable Security Manager:** Utilize Java Security Manager to define a security policy that restricts the permissions granted to the deserialized objects, limiting their capabilities.

5. **Apply Digital Signatures or Message Authentication Codes (MACs):** Sign the serialized data with digital signatures or MACs to ensure its integrity and authenticity during","This code snippet demonstrates a common vulnerability related to insecure deserialization in Java. Insecure deserialization can lead to various security risks, including remote code execution and data tampering. To fix this code and implement proper security measures for deserialization, you can consider the following recommendations: 1. **Implement Input Validation:** Validate the input data before deserializing it to ensure that it comes from a trusted and expected source. This can help prevent malicious objects from being deserialized. 2. **Use a Secure Deserialization Framework:** Consider using a secure deserialization framework that provides additional protection against common attacks, such as Apache Commons Collections (ACC) or Java Serialization Filter (JSF). 3. **Implement Whitelisting/Blacklisting:** Implement a whitelist or blacklist approach to restrict the types of classes that can be deserialized. Whitelisting allows only specified classes to be deserialized, while blacklisting blocks known dangerous classes. 4. **Enable Security Manager:** Utilize Java Security Manager to define a security policy that restricts the permissions granted to the deserialized objects, limiting their capabilities. 5. **Apply Digital Signatures or Message Authentication Codes (MACs):** Sign the serialized data with digital signatures or MACs to ensure its integrity and authenticity during",php,0
SQL Injection,"app.get('/user/:id', (req, res) => {
    const query = `SELECT * FROM users WHERE id = ${req.params.id}`; // SQL Injection
    db.query(query, (err, result) => {
        res.json(result);
    });
});
","app.get('/user/:id', (req, res) => {
    const query = `SELECT * FROM users WHERE id = ${req.params.id}`; // SQL Injection
    db.query(query, (err, result) => {
        res.json(result);
    });
});
",javascript,1
Command Injection,"import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class CommandInjectionVulnerable {

    public static void main(String[] args) {
        try {
            BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));
            System.out.print(""Enter a website to ping: "");
            String website = reader.readLine();

            // Vulnerable code that directly passes user input to the system command
            String command = ""ping "" + website;
            Process process = Runtime.getRuntime().exec(command);

            BufferedReader inputReader = new BufferedReader(new InputStreamReader(process.getInputStream()));
            String line;
            while ((line = inputReader.readLine()) != null) {
                System.out.println(line);
            }

        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}","import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class CommandInjectionVulnerable { public static void main(String[] args) { try { BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a website to ping: ""); String website = reader.readLine(); // Vulnerable code that directly passes user input to the system command String command = ""ping "" + website; Process process = Runtime.getRuntime().exec(command); BufferedReader inputReader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = inputReader.readLine()) != null) { System.out.println(line); } } catch (IOException e) { e.printStackTrace(); } } }",java,1
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Clear,"#include <stdio.h>
#include <string.h>

int validate_input(const char *input) {
    if (input == NULL) return 0;
    for (int i = 0; input[i] != '\0'; i++) {
        if (input[i] < 32 || input[i] > 126) {
            return 0; // invalid character
        }
    }
    return 1;
}","#include <stdio.h>
#include <string.h>

int validate_input(const char *input) {
    if (input == NULL) return 0;
    for (int i = 0; input[i] != '\0'; i++) {
        if (input[i] < 32 || input[i] > 126) {
            return 0; // invalid character
        }
    }
    return 1;
}",c,0
Clear,"const shell = require('child_process');
const safeInput = userInput.replace(/[^a-zA-Z0-9.]/g, '');
shell.execFile('ping', [safeInput]); // Safe command execution
","const shell = require('child_process');
const safeInput = userInput.replace(/[^a-zA-Z0-9.]/g, '');
shell.execFile('ping', [safeInput]); // Safe command execution
",javascript,0
Clear,"import java.sql.*;

public class SecureSQLInjectionExample {

    public static void main(String[] args) {
        try {
            String userInput = ""'; DROP TABLE users; --""; // Malicious input

            // Establish connection to the database
            Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");

            // Use prepared statement with parameterized query
            String query = ""SELECT * FROM users WHERE username = ?"";
            PreparedStatement pstmt = conn.prepareStatement(query);
            
            // Set the parameter value safely
            pstmt.setString(1, userInput);

            // Execute the query
            ResultSet rs = pstmt.executeQuery();

            while (rs.next()) {
                System.out.println(""Username: "" + rs.getString(""username""));
                System.out.println(""Password: "" + rs.getString(""password""));
            }

        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.*; public class SecureSQLInjectionExample { public static void main(String[] args) { try { String userInput = ""'; DROP TABLE users; --""; // Malicious input // Establish connection to the database Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); // Use prepared statement with parameterized query String query = ""SELECT * FROM users WHERE username = ?""; PreparedStatement pstmt = conn.prepareStatement(query); // Set the parameter value safely pstmt.setString(1, userInput); // Execute the query ResultSet rs = pstmt.executeQuery(); while (rs.next()) { System.out.println(""Username: "" + rs.getString(""username"")); System.out.println(""Password: "" + rs.getString(""password"")); } } catch (SQLException e) { e.printStackTrace(); } } }",java,0
Hardcoded Secrets,"localStorage.setItem('token', 'hardcoded-secret-token-123'); // Hardcoded secret
","localStorage.setItem('token', 'hardcoded-secret-token-123'); // Hardcoded secret
",javascript,1
Clear,"import java.util.Scanner;

public class SecureBufferExample {
    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        
        System.out.print(""Enter a string: "");
        String userInput = scanner.nextLine(); // Use nextLine() to read the entire line
        
        // Define a maximum buffer size to prevent buffer overflow
        int bufferSize = 10;
        
        char[] buffer = new char[bufferSize];
        
        // Copy only up to bufferSize characters from userInput to buffer
        userInput.getChars(0, Math.min(userInput.length(), bufferSize), buffer, 0);
        
        System.out.println(""Buffer contents: "" + String.valueOf(buffer));
    }
}","import java.util.Scanner; public class SecureBufferExample { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter a string: ""); String userInput = scanner.nextLine(); // Use nextLine() to read the entire line // Define a maximum buffer size to prevent buffer overflow int bufferSize = 10; char[] buffer = new char[bufferSize]; // Copy only up to bufferSize characters from userInput to buffer userInput.getChars(0, Math.min(userInput.length(), bufferSize), buffer, 0); System.out.println(""Buffer contents: "" + String.valueOf(buffer)); } }",java,0
Code Injection,"const userData = eval('(' + userInput + ')'); // eval injection
","const userData = eval('(' + userInput + ')'); // eval injection
",javascript,1
SQL Injection,"import sqlite3
def get_user_data(username):
    conn = sqlite3.connect('database.db')
    cursor = conn.cursor()
    query = ""SELECT * FROM users WHERE username = '"" + username + ""'""
    cursor.execute(query)
    return cursor.fetchall()","import sqlite3
def get_user_data(username):
    conn = sqlite3.connect('database.db')
    cursor = conn.cursor()
    query = ""SELECT * FROM users WHERE username = '"" + username + ""'""
    cursor.execute(query)
    return cursor.fetchall()",python,1
SQL Injection,"import java.sql.*;

public class SQLInjectionExample {

    public static void main(String[] args) {
        String userInput = ""'; DROP TABLE users; --""; // Malicious input simulating SQL Injection
        
        try {
            Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");
            
            Statement stmt = conn.createStatement();
            String query = ""SELECT * FROM users WHERE username='"" + userInput + ""'"";
            
            ResultSet rs = stmt.executeQuery(query);
            
            while (rs.next()) {
                System.out.println(""User: "" + rs.getString(""username""));
            }
            
            conn.close();
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.*; public class SQLInjectionExample { public static void main(String[] args) { String userInput = ""'; DROP TABLE users; --""; // Malicious input simulating SQL Injection try { Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); Statement stmt = conn.createStatement(); String query = ""SELECT * FROM users WHERE username='"" + userInput + ""'""; ResultSet rs = stmt.executeQuery(query); while (rs.next()) { System.out.println(""User: "" + rs.getString(""username"")); } conn.close(); } catch (SQLException e) { e.printStackTrace(); } } }",java,1
File Inclusion,"<?php
$file = $_GET['file'];
include($file); // File Inclusion
?>","<?php
$file = $_GET['file'];
include($file); // File Inclusion
?>",php,1
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Clear,"app.get('/user/:id', (req, res) => {
    const userId = parseInt(req.params.id);
    db.query('SELECT * FROM users WHERE id = ?', [userId], (err, result) => {
        res.json(result);
    });
});
","app.get('/user/:id', (req, res) => {
    const userId = parseInt(req.params.id);
    db.query('SELECT * FROM users WHERE id = ?', [userId], (err, result) => {
        res.json(result);
    });
});
",javascript,0
Clear,"<?php
$input = json_decode($_POST['data'], true); // Safe JSON parsing
if (json_last_error() === JSON_ERROR_NONE) {
    process_data($input);
}
?>","<?php
$input = json_decode($_POST['data'], true); // Safe JSON parsing
if (json_last_error() === JSON_ERROR_NONE) {
    process_data($input);
}
?>",php,0
File Inclusion,"<?php
$file = $_GET['file'];
include($file); // File Inclusion
?>","<?php
$file = $_GET['file'];
include($file); // File Inclusion
?>",php,1
Buffer Overflow,"#include <iostream>
#include <cstring>

void unsafe_c_string(char* input) {
    char buffer[100];
    strcpy(buffer, input); // potential buffer overflow
    std::cout << buffer << std::endl;
}","#include <iostream>
#include <cstring>

void unsafe_c_string(char* input) {
    char buffer[100];
    strcpy(buffer, input); // potential buffer overflow
    std::cout << buffer << std::endl;
}",cpp,1
SQL Injection,"import sqlite3
def get_user_data(username):
    conn = sqlite3.connect('database.db')
    cursor = conn.cursor()
    query = ""SELECT * FROM users WHERE username = '"" + username + ""'""
    cursor.execute(query)
    return cursor.fetchall()","import sqlite3
def get_user_data(username):
    conn = sqlite3.connect('database.db')
    cursor = conn.cursor()
    query = ""SELECT * FROM users WHERE username = '"" + username + ""'""
    cursor.execute(query)
    return cursor.fetchall()",python,1
SQL Injection,"import java.sql.*;

public class VulnerableCode {
    public static void main(String[] args) {
        String userInput = ""admin'; DROP TABLE users; --"";

        try {
            Connection connection = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""root"", ""password"");
            Statement statement = connection.createStatement();
            
            String query = ""SELECT * FROM users WHERE username='"" + userInput + ""'"";
            
            ResultSet resultSet = statement.executeQuery(query);
            
            while (resultSet.next()) {
                System.out.println(resultSet.getString(""username""));
            }
            
            connection.close();
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.*; public class VulnerableCode { public static void main(String[] args) { String userInput = ""admin'; DROP TABLE users; --""; try { Connection connection = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""root"", ""password""); Statement statement = connection.createStatement(); String query = ""SELECT * FROM users WHERE username='"" + userInput + ""'""; ResultSet resultSet = statement.executeQuery(query); while (resultSet.next()) { System.out.println(resultSet.getString(""username"")); } connection.close(); } catch (SQLException e) { e.printStackTrace(); } } }",java,1
Clear,"#include <stdio.h>
#include <string.h>

int validate_input(const char *input) {
    if (input == NULL) return 0;
    for (int i = 0; input[i] != '\0'; i++) {
        if (input[i] < 32 || input[i] > 126) {
            return 0; // invalid character
        }
    }
    return 1;
}","#include <stdio.h>
#include <string.h>

int validate_input(const char *input) {
    if (input == NULL) return 0;
    for (int i = 0; input[i] != '\0'; i++) {
        if (input[i] < 32 || input[i] > 126) {
            return 0; // invalid character
        }
    }
    return 1;
}",c,0
Buffer Overflow,"#include <iostream>
#include <cstdio>

void unsafe_c_input() {
    char buffer[50];
    scanf(""%s"", buffer); // no length limit
    std::cout << buffer << std::endl;
}","#include <iostream>
#include <cstdio>

void unsafe_c_input() {
    char buffer[50];
    scanf(""%s"", buffer); // no length limit
    std::cout << buffer << std::endl;
}",cpp,1
Buffer Overflow,"#include <iostream>
#include <cstdio>

void unsafe_c_input() {
    char buffer[50];
    scanf(""%s"", buffer); // no length limit
    std::cout << buffer << std::endl;
}","#include <iostream>
#include <cstdio>

void unsafe_c_input() {
    char buffer[50];
    scanf(""%s"", buffer); // no length limit
    std::cout << buffer << std::endl;
}",cpp,1
Clear,"const token = process.env.API_TOKEN; // Environment variable
fetch('/api/data', {
    headers: { 'Authorization': `Bearer ${token}` }
});
","const token = process.env.API_TOKEN; // Environment variable
fetch('/api/data', {
    headers: { 'Authorization': `Bearer ${token}` }
});
",javascript,0
Clear,"import java.io.IOException;
import java.io.PrintWriter;
import javax.servlet.ServletException;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

import org.owasp.encoder.Encode;

public class SecureServlet extends HttpServlet {
    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        String userInput = request.getParameter(""input"");
        
        // Sanitize user input using OWASP Java Encoder library
        String sanitizedInput = Encode.forHtml(userInput);

        PrintWriter out = response.getWriter();
        out.println(""<html><body>"");
        out.println(""<h1>User Input: "" + sanitizedInput + ""</h1>"");
        out.println(""</body></html>"");
    }
}","import java.io.IOException; import java.io.PrintWriter; import javax.servlet.ServletException; import javax.servlet.http.HttpServlet; import javax.servlet.http.HttpServletRequest; import javax.servlet.http.HttpServletResponse; import org.owasp.encoder.Encode; public class SecureServlet extends HttpServlet { protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { String userInput = request.getParameter(""input""); // Sanitize user input using OWASP Java Encoder library String sanitizedInput = Encode.forHtml(userInput); PrintWriter out = response.getWriter(); out.println(""<html><body>""); out.println(""<h1>User Input: "" + sanitizedInput + ""</h1>""); out.println(""</body></html>""); } }",java,0
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Clear,"import org.owasp.esapi.ESAPI;
import org.owasp.esapi.codecs.HTMLEntityCodec;

public class XSSFixedCode {
    public static void main(String[] args) {
        // Simulating user input from an untrusted source
        String userInput = ""<script>alert('XSS Vulnerability!')</script>"";
        
        // Properly escaping user input before outputting it to the webpage
        HTMLEntityCodec codec = new HTMLEntityCodec();
        String escapedInput = codec.encodeForHTML(userInput);
        
        System.out.println(""<div>"" + escapedInput + ""</div>"");
    }
}","import org.owasp.esapi.ESAPI; import org.owasp.esapi.codecs.HTMLEntityCodec; public class XSSFixedCode { public static void main(String[] args) { // Simulating user input from an untrusted source String userInput = ""<script>alert('XSS Vulnerability!')</script>""; // Properly escaping user input before outputting it to the webpage HTMLEntityCodec codec = new HTMLEntityCodec(); String escapedInput = codec.encodeForHTML(userInput); System.out.println(""<div>"" + escapedInput + ""</div>""); } }",java,0
Buffer Overflow,"import java.util.Scanner;

public class BufferOverflowVulnerability {

    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        System.out.print(""Enter your name: "");
        String name = scanner.nextLine();

        // Vulnerable code - buffer overflow can occur if the user input is larger than the allocated buffer size
        byte[] buffer = new byte[10];
        System.arraycopy(name.getBytes(), 0, buffer, 0, name.length());

        System.out.println(""Hello, "" + new String(buffer));
    }
}","import java.util.Scanner; public class BufferOverflowVulnerability { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter your name: ""); String name = scanner.nextLine(); // Vulnerable code - buffer overflow can occur if the user input is larger than the allocated buffer size byte[] buffer = new byte[10]; System.arraycopy(name.getBytes(), 0, buffer, 0, name.length()); System.out.println(""Hello, "" + new String(buffer)); } }",java,1
Command Injection,"const shell = require('child_process');
shell.exec('ping ' + userInput); // Command Injection
","const shell = require('child_process');
shell.exec('ping ' + userInput); // Command Injection
",javascript,1
Clear,"#include <stdio.h>
#include <string.h>

int validate_input(const char *input) {
    if (input == NULL) return 0;
    for (int i = 0; input[i] != '\0'; i++) {
        if (input[i] < 32 || input[i] > 126) {
            return 0; // invalid character
        }
    }
    return 1;
}","#include <stdio.h>
#include <string.h>

int validate_input(const char *input) {
    if (input == NULL) return 0;
    for (int i = 0; input[i] != '\0'; i++) {
        if (input[i] < 32 || input[i] > 126) {
            return 0; // invalid character
        }
    }
    return 1;
}",c,0
Cross-Site Scripting (XSS),"def display_comment(comment_text):
    return f""<div class='comment'>{comment_text}</div>"" ","def display_comment(comment_text):
    return f""<div class='comment'>{comment_text}</div>"" ",python,1
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Buffer Overflow,"import java.util.Scanner;

public class BufferOverflowExample {
    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        
        System.out.print(""Enter a string: "");
        String userInput = scanner.next();
        
        char[] buffer = new char[10];
        userInput.getChars(0, userInput.length(), buffer, 0);
        
        System.out.println(""Buffer contents: "" + String.valueOf(buffer));
    }
}","import java.util.Scanner; public class BufferOverflowExample { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter a string: ""); String userInput = scanner.next(); char[] buffer = new char[10]; userInput.getChars(0, userInput.length(), buffer, 0); System.out.println(""Buffer contents: "" + String.valueOf(buffer)); } }",java,1
Clear,"To fix the SQL injection vulnerability in the provided Java code snippet, you should use parameterized queries instead of directly concatenating user input into the SQL query string. Parameterized queries help prevent SQL injection attacks by separating the SQL code from the user input data.

Here is an updated version of the code with a secure parameterized query:

```java
import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;

public class SecureSQLCode {

    public static void main(String[] args) {
        String userInput = ""'; DROP TABLE users; --""; // Malicious input simulating SQL injection
        
        try {
            Connection connection = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");
            
            String query = ""SELECT * FROM users WHERE username=?"";
            PreparedStatement statement = connection.prepareStatement(query);
            statement.setString(1, userInput); // Set parameter value
            
            ResultSet resultSet = statement.executeQuery();
            
            while (resultSet.next()) {
                System.out.println(""User: "" + resultSet.getString(""username""));
            }
            
            resultSet.close();
            statement.close();
            connection.close();
            
        } catch (SQLException e) {
            e.printStackTrace();
        }","To fix the SQL injection vulnerability in the provided Java code snippet, you should use parameterized queries instead of directly concatenating user input into the SQL query string. Parameterized queries help prevent SQL injection attacks by separating the SQL code from the user input data. Here is an updated version of the code with a secure parameterized query: ```java import java.sql.Connection; import java.sql.DriverManager; import java.sql.PreparedStatement; import java.sql.ResultSet; import java.sql.SQLException; public class SecureSQLCode { public static void main(String[] args) { String userInput = ""'; DROP TABLE users; --""; // Malicious input simulating SQL injection try { Connection connection = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); String query = ""SELECT * FROM users WHERE username=?""; PreparedStatement statement = connection.prepareStatement(query); statement.setString(1, userInput); // Set parameter value ResultSet resultSet = statement.executeQuery(); while (resultSet.next()) { System.out.println(""User: "" + resultSet.getString(""username"")); } resultSet.close(); statement.close(); connection.close(); } catch (SQLException e) { e.printStackTrace(); }",java,0
Hardcoded Secrets,"localStorage.setItem('token', 'hardcoded-secret-token-123'); // Hardcoded secret
","localStorage.setItem('token', 'hardcoded-secret-token-123'); // Hardcoded secret
",javascript,1
Command Injection,"import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class CommandInjectionExample {

    public static void main(String[] args) {
        try {
            // Accept user input for the command to execute
            BufferedReader br = new BufferedReader(new InputStreamReader(System.in));
            System.out.print(""Enter the command to execute: "");
            String command = br.readLine();

            // Execute the command using Runtime.getRuntime().exec()
            Process process = Runtime.getRuntime().exec(command);

            // Read and display the output of the command
            BufferedReader reader = new BufferedReader(new InputStreamReader(process.getInputStream()));
            String line;
            while ((line = reader.readLine()) != null) {
                System.out.println(line);
            }

        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}","import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class CommandInjectionExample { public static void main(String[] args) { try { // Accept user input for the command to execute BufferedReader br = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter the command to execute: ""); String command = br.readLine(); // Execute the command using Runtime.getRuntime().exec() Process process = Runtime.getRuntime().exec(command); // Read and display the output of the command BufferedReader reader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = reader.readLine()) != null) { System.out.println(line); } } catch (IOException e) { e.printStackTrace(); } } }",java,1
Clear,"import java.io.*;
import javax.servlet.*;
import javax.servlet.http.*;
import org.owasp.encoder.Encode;

public class XSSFixedServlet extends HttpServlet {
    protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        String userInput = request.getParameter(""input"");
        
        PrintWriter out = response.getWriter();
        out.println(""<html>"");
        out.println(""<body>"");
        out.println(""User input: "" + Encode.forHtml(userInput)); // Encoding user input to prevent XSS
        out.println(""</body>"");
        out.println(""</html>"");
    }
}","import java.io.*; import javax.servlet.*; import javax.servlet.http.*; import org.owasp.encoder.Encode; public class XSSFixedServlet extends HttpServlet { protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { String userInput = request.getParameter(""input""); PrintWriter out = response.getWriter(); out.println(""<html>""); out.println(""<body>""); out.println(""User input: "" + Encode.forHtml(userInput)); // Encoding user input to prevent XSS out.println(""</body>""); out.println(""</html>""); } }",java,0
Clear,"#include <iostream>
#include <string>
#include <vector>

void safe_string_handling(const std::string& input) {
    std::string safe_copy = input;
    std::cout << safe_copy << std::endl;
}","#include <iostream>
#include <string>
#include <vector>

void safe_string_handling(const std::string& input) {
    std::string safe_copy = input;
    std::cout << safe_copy << std::endl;
}",cpp,0
Path Traversal,"def get_user_file(username, filepath):
    import os
    base_path = f""/home/{username}/files/""
    full_path = base_path + filepath
    with open(full_path, 'r') as f:
        return f.read()","def get_user_file(username, filepath):
    import os
    base_path = f""/home/{username}/files/""
    full_path = base_path + filepath
    with open(full_path, 'r') as f:
        return f.read()",python,1
Clear,"#include <iostream>
#include <string>
#include <vector>

void safe_string_handling(const std::string& input) {
    std::string safe_copy = input;
    std::cout << safe_copy << std::endl;
}","#include <iostream>
#include <string>
#include <vector>

void safe_string_handling(const std::string& input) {
    std::string safe_copy = input;
    std::cout << safe_copy << std::endl;
}",cpp,0
Clear,"To secure the code snippet from Insecure Deserialization vulnerability, you can implement the following security measures:

1. Use a whitelist approach: 
   - Maintain a list of allowed classes that can be deserialized and reject any other classes during deserialization.
   - Implement input validation to ensure that only expected and trusted data is being deserialized.

2. Implement input validation:
   - Validate the input data before deserialization to prevent any malicious or unexpected input.
   - Perform thorough validation checks on the serialized data to ensure its integrity and authenticity.

3. Use secure serialization mechanisms:
   - Consider using secure serialization libraries or mechanisms that provide protection against common vulnerabilities like object injection attacks.
   - Use encryption and digital signatures to protect the integrity and confidentiality of serialized data.

4. Implement custom serialization:
   - Implement custom serialization methods for sensitive classes to have more control over the serialization and deserialization process.
   - Override default serialization behavior with customized logic that enforces security checks.

5. Monitor and log deserialization activities:
   - Log deserialization activities for auditing and monitoring purposes.
   - Monitor for any suspicious or unexpected deserialization attempts and take appropriate actions when anomalies are detected.

Here is an updated version of your code snippet with some basic security measures implemented","To secure the code snippet from Insecure Deserialization vulnerability, you can implement the following security measures: 1. Use a whitelist approach: - Maintain a list of allowed classes that can be deserialized and reject any other classes during deserialization. - Implement input validation to ensure that only expected and trusted data is being deserialized. 2. Implement input validation: - Validate the input data before deserialization to prevent any malicious or unexpected input. - Perform thorough validation checks on the serialized data to ensure its integrity and authenticity. 3. Use secure serialization mechanisms: - Consider using secure serialization libraries or mechanisms that provide protection against common vulnerabilities like object injection attacks. - Use encryption and digital signatures to protect the integrity and confidentiality of serialized data. 4. Implement custom serialization: - Implement custom serialization methods for sensitive classes to have more control over the serialization and deserialization process. - Override default serialization behavior with customized logic that enforces security checks. 5. Monitor and log deserialization activities: - Log deserialization activities for auditing and monitoring purposes. - Monitor for any suspicious or unexpected deserialization attempts and take appropriate actions when anomalies are detected. Here is an updated version of your code snippet with some basic security measures implemented",php,0
Path Traversal,"import os
def read_file(filename):
    with open('/var/www/uploads/' + filename, 'r') as f:
        return f.read()","import os
def read_file(filename):
    with open('/var/www/uploads/' + filename, 'r') as f:
        return f.read()",python,1
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Buffer Overflow,"import java.util.Scanner;

public class BufferOverflowVulnerability {
    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);

        System.out.print(""Enter a string: "");
        String userInput = scanner.nextLine();

        char[] buffer = new char[10]; // Vulnerable buffer size

        // Copy user input into the buffer
        for (int i = 0; i < userInput.length(); i++) {
            buffer[i] = userInput.charAt(i);
        }

        System.out.println(""Buffer contents: "" + String.valueOf(buffer));
    }
}","import java.util.Scanner; public class BufferOverflowVulnerability { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter a string: ""); String userInput = scanner.nextLine(); char[] buffer = new char[10]; // Vulnerable buffer size // Copy user input into the buffer for (int i = 0; i < userInput.length(); i++) { buffer[i] = userInput.charAt(i); } System.out.println(""Buffer contents: "" + String.valueOf(buffer)); } }",java,1
Command Injection,"import java.io.*;

public class CommandInjectionVulnerable {

    public static void main(String[] args) {
        try {
            BufferedReader br = new BufferedReader(new InputStreamReader(System.in));
            System.out.print(""Enter a directory name: "");
            String directoryName = br.readLine();

            // Vulnerable code: directly concatenating user input into the command
            String command = ""ls "" + directoryName;
            Process process = Runtime.getRuntime().exec(command);

            BufferedReader reader = new BufferedReader(new InputStreamReader(process.getInputStream()));
            String line;
            while ((line = reader.readLine()) != null) {
                System.out.println(line);
            }
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}","import java.io.*; public class CommandInjectionVulnerable { public static void main(String[] args) { try { BufferedReader br = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a directory name: ""); String directoryName = br.readLine(); // Vulnerable code: directly concatenating user input into the command String command = ""ls "" + directoryName; Process process = Runtime.getRuntime().exec(command); BufferedReader reader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = reader.readLine()) != null) { System.out.println(line); } } catch (IOException e) { e.printStackTrace(); } } }",java,1
SQL Injection,"import java.sql.*;

public class VulnerableCode {

    public static void main(String[] args) {
        String userInput = ""'; DROP TABLE users; --"";

        try {
            Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");
            Statement stmt = conn.createStatement();

            String query = ""SELECT * FROM users WHERE username='"" + userInput + ""'"";
            ResultSet rs = stmt.executeQuery(query);

            while (rs.next()) {
                System.out.println(rs.getString(""username""));
            }

            rs.close();
            stmt.close();
            conn.close();
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.*; public class VulnerableCode { public static void main(String[] args) { String userInput = ""'; DROP TABLE users; --""; try { Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); Statement stmt = conn.createStatement(); String query = ""SELECT * FROM users WHERE username='"" + userInput + ""'""; ResultSet rs = stmt.executeQuery(query); while (rs.next()) { System.out.println(rs.getString(""username"")); } rs.close(); stmt.close(); conn.close(); } catch (SQLException e) { e.printStackTrace(); } } }",java,1
Clear,"import re
def validate_email(email):
    pattern = r'^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$'
    return bool(re.match(pattern, email))","import re
def validate_email(email):
    pattern = r'^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$'
    return bool(re.match(pattern, email))",python,0
Cross-Site Scripting (XSS),"import java.io.*;

public class XSSVulnerableCode {
    public static void main(String[] args) {
        // Simulating user input from an untrusted source
        String userInput = ""<script>alert('XSS Vulnerability')</script>"";

        // Improperly handling user input by directly outputting it without proper sanitization
        System.out.println(""Welcome, "" + userInput);
    }
}","import java.io.*; public class XSSVulnerableCode { public static void main(String[] args) { // Simulating user input from an untrusted source String userInput = ""<script>alert('XSS Vulnerability')</script>""; // Improperly handling user input by directly outputting it without proper sanitization System.out.println(""Welcome, "" + userInput); } }",java,1
SQL Injection,"import java.sql.*;

public class SQLInjectionVulnerable {

    public static void main(String[] args) {
        try {
            // Simulating user input, which can be manipulated to perform SQL Injection
            String userInput = ""1 OR 1=1"";

            // Establishing a connection to the database
            Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");

            // Creating a SQL statement with user input concatenated directly into the query
            String query = ""SELECT * FROM users WHERE id = "" + userInput;
            Statement stmt = conn.createStatement();

            // Executing the query
            ResultSet rs = stmt.executeQuery(query);

            // Processing the results
            while (rs.next()) {
                System.out.println(""User ID: "" + rs.getInt(""id"") + "", Name: "" + rs.getString(""name""));
            }

            // Closing resources
            rs.close();
            stmt.close();
            conn.close();

        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.*; public class SQLInjectionVulnerable { public static void main(String[] args) { try { // Simulating user input, which can be manipulated to perform SQL Injection String userInput = ""1 OR 1=1""; // Establishing a connection to the database Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); // Creating a SQL statement with user input concatenated directly into the query String query = ""SELECT * FROM users WHERE id = "" + userInput; Statement stmt = conn.createStatement(); // Executing the query ResultSet rs = stmt.executeQuery(query); // Processing the results while (rs.next()) { System.out.println(""User ID: "" + rs.getInt(""id"") + "", Name: "" + rs.getString(""name"")); } // Closing resources rs.close(); stmt.close(); conn.close(); } catch (SQLException e) { e.printStackTrace(); } } }",java,1
Command Injection,"const shell = require('child_process');
shell.exec('ping ' + userInput); // Command Injection
","const shell = require('child_process');
shell.exec('ping ' + userInput); // Command Injection
",javascript,1
XSS,"const userInput = document.location.search.split('=')[1];
document.write(userInput); // XSS
","const userInput = document.location.search.split('=')[1];
document.write(userInput); // XSS
",javascript,1
Clear,"import java.io.*;
import javax.servlet.*;
import javax.servlet.http.*;
import org.owasp.encoder.Encode;

public class XSSFixedServlet extends HttpServlet {

    protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        String userInput = request.getParameter(""input"");
        
        String safeUserInput = Encode.forHtml(userInput); // Encode user input to prevent XSS
        
        String htmlResponse = ""<html><body><h1>Hello, "" + safeUserInput + ""!</h1></body></html>"";
        
        PrintWriter out = response.getWriter();
        out.println(htmlResponse);
    }
}","import java.io.*; import javax.servlet.*; import javax.servlet.http.*; import org.owasp.encoder.Encode; public class XSSFixedServlet extends HttpServlet { protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { String userInput = request.getParameter(""input""); String safeUserInput = Encode.forHtml(userInput); // Encode user input to prevent XSS String htmlResponse = ""<html><body><h1>Hello, "" + safeUserInput + ""!</h1></body></html>""; PrintWriter out = response.getWriter(); out.println(htmlResponse); } }",java,0
Clear,"import logging
def safe_log_user_action(user_id, action):
    logging.info(f""User {user_id} performed action: {action}"")","import logging
def safe_log_user_action(user_id, action):
    logging.info(f""User {user_id} performed action: {action}"")",python,0
Clear,"#include <iostream>
#include <string>
#include <vector>

void safe_string_handling(const std::string& input) {
    std::string safe_copy = input;
    std::cout << safe_copy << std::endl;
}","#include <iostream>
#include <string>
#include <vector>

void safe_string_handling(const std::string& input) {
    std::string safe_copy = input;
    std::cout << safe_copy << std::endl;
}",cpp,0
Clear,"import java.sql.*;

public class SecureSQLExample {

    public static void main(String[] args) {
        try {
            String userInput = ""admin'; DROP TABLE users; --"";

            Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");
            
            // Using a parameterized query to prevent SQL injection
            String query = ""SELECT * FROM users WHERE username = ?"";
            PreparedStatement stmt = conn.prepareStatement(query);
            stmt.setString(1, userInput);

            ResultSet rs = stmt.executeQuery();

            while (rs.next()) {
                System.out.println(""Username: "" + rs.getString(""username""));
                System.out.println(""Password: "" + rs.getString(""password""));
            }

            conn.close();
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.*; public class SecureSQLExample { public static void main(String[] args) { try { String userInput = ""admin'; DROP TABLE users; --""; Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); // Using a parameterized query to prevent SQL injection String query = ""SELECT * FROM users WHERE username = ?""; PreparedStatement stmt = conn.prepareStatement(query); stmt.setString(1, userInput); ResultSet rs = stmt.executeQuery(); while (rs.next()) { System.out.println(""Username: "" + rs.getString(""username"")); System.out.println(""Password: "" + rs.getString(""password"")); } conn.close(); } catch (SQLException e) { e.printStackTrace(); } } }",java,0
Clear,"#include <iostream>
#include <string>
#include <vector>

void safe_string_handling(const std::string& input) {
    std::string safe_copy = input;
    std::cout << safe_copy << std::endl;
}","#include <iostream>
#include <string>
#include <vector>

void safe_string_handling(const std::string& input) {
    std::string safe_copy = input;
    std::cout << safe_copy << std::endl;
}",cpp,0
Path Traversal,"import os
def read_file(filename):
    with open('/var/www/uploads/' + filename, 'r') as f:
        return f.read()","import os
def read_file(filename):
    with open('/var/www/uploads/' + filename, 'r') as f:
        return f.read()",python,1
XSS,"const userInput = document.location.search.split('=')[1];
document.write(userInput); // XSS
","const userInput = document.location.search.split('=')[1];
document.write(userInput); // XSS
",javascript,1
Command Injection,"import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class CommandInjectionExample {

    public static void main(String[] args) throws IOException {
        BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));
        System.out.print(""Enter a command to execute: "");
        String command = reader.readLine();

        Runtime runtime = Runtime.getRuntime();
        Process process = runtime.exec(command);

        BufferedReader inputReader = new BufferedReader(new InputStreamReader(process.getInputStream()));
        String line;
        while ((line = inputReader.readLine()) != null) {
            System.out.println(line);
        }

        process.destroy();
    }
}","import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class CommandInjectionExample { public static void main(String[] args) throws IOException { BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a command to execute: ""); String command = reader.readLine(); Runtime runtime = Runtime.getRuntime(); Process process = runtime.exec(command); BufferedReader inputReader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = inputReader.readLine()) != null) { System.out.println(line); } process.destroy(); } }",java,1
Clear,"import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;

public class SQLInjectionSecure {
    public static void main(String[] args) {
        String userInput = ""'; DROP TABLE users; --"";
        
        try {
            Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");
            
            String query = ""SELECT * FROM users WHERE username = ?"";
            PreparedStatement pstmt = conn.prepareStatement(query);
            pstmt.setString(1, userInput);
            
            ResultSet rs = pstmt.executeQuery();
            
            while (rs.next()) {
                System.out.println(rs.getString(""username""));
            }
            
            conn.close();
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.Connection; import java.sql.DriverManager; import java.sql.PreparedStatement; import java.sql.ResultSet; import java.sql.SQLException; public class SQLInjectionSecure { public static void main(String[] args) { String userInput = ""'; DROP TABLE users; --""; try { Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); String query = ""SELECT * FROM users WHERE username = ?""; PreparedStatement pstmt = conn.prepareStatement(query); pstmt.setString(1, userInput); ResultSet rs = pstmt.executeQuery(); while (rs.next()) { System.out.println(rs.getString(""username"")); } conn.close(); } catch (SQLException e) { e.printStackTrace(); } } }",java,0
Clear,"def safe_division(a, b):
    if b == 0:
        raise ValueError(""Division by zero"")
    return a / b","def safe_division(a, b):
    if b == 0:
        raise ValueError(""Division by zero"")
    return a / b",python,0
Cross-Site Scripting (XSS),"import java.io.*;
import javax.servlet.*;
import javax.servlet.http.*;

public class XssVulnerableServlet extends HttpServlet {
    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        String userInput = request.getParameter(""input"");
        
        String output = ""<html><body>User input: "" + userInput + ""</body></html>"";
        
        PrintWriter out = response.getWriter();
        out.println(output);
    }
}","import java.io.*; import javax.servlet.*; import javax.servlet.http.*; public class XssVulnerableServlet extends HttpServlet { protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { String userInput = request.getParameter(""input""); String output = ""<html><body>User input: "" + userInput + ""</body></html>""; PrintWriter out = response.getWriter(); out.println(output); } }",java,1
Memory Corruption,"#include <iostream>

void unsafe_virtual_call() {
    // Potential vtable corruption vulnerability
    class Base {
    public:
        virtual void func() { std::cout << ""Base"" << std::endl; }
    };
    
    class Derived : public Base {
    public:
        void func() override { std::cout << ""Derived"" << std::endl; }
    };
}","#include <iostream>

void unsafe_virtual_call() {
    // Potential vtable corruption vulnerability
    class Base {
    public:
        virtual void func() { std::cout << ""Base"" << std::endl; }
    };
    
    class Derived : public Base {
    public:
        void func() override { std::cout << ""Derived"" << std::endl; }
    };
}",cpp,1
Clear,"const userInput = new URLSearchParams(window.location.search).get('input');
const safeOutput = document.createElement('div');
safeOutput.textContent = userInput; // Safe DOM manipulation
document.body.appendChild(safeOutput);
","const userInput = new URLSearchParams(window.location.search).get('input');
const safeOutput = document.createElement('div');
safeOutput.textContent = userInput; // Safe DOM manipulation
document.body.appendChild(safeOutput);
",javascript,0
Code Injection,"const userData = eval('(' + userInput + ')'); // eval injection
","const userData = eval('(' + userInput + ')'); // eval injection
",javascript,1
Clear,"import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;
import java.util.ArrayList;
import java.util.List;

public class CommandInjectionSecure {

    public static void main(String[] args) {
        try {
            BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));
            System.out.print(""Enter a command to execute: "");
            String command = reader.readLine();

            List<String> commands = new ArrayList<>();
            commands.add(""ping"");
            commands.add(command);

            ProcessBuilder processBuilder = new ProcessBuilder(commands);
            Process process = processBuilder.start();

            BufferedReader inputReader = new BufferedReader(new InputStreamReader(process.getInputStream()));
            String line;
            while ((line = inputReader.readLine()) != null) {
                System.out.println(line);
            }

        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}","import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; import java.util.ArrayList; import java.util.List; public class CommandInjectionSecure { public static void main(String[] args) { try { BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a command to execute: ""); String command = reader.readLine(); List<String> commands = new ArrayList<>(); commands.add(""ping""); commands.add(command); ProcessBuilder processBuilder = new ProcessBuilder(commands); Process process = processBuilder.start(); BufferedReader inputReader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = inputReader.readLine()) != null) { System.out.println(line); } } catch (IOException e) { e.printStackTrace(); } } }",java,0
SQL Injection,"import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.ResultSet;
import java.sql.Statement;
import java.util.Scanner;

public class SQLInjectionVulnerable {
    public static void main(String[] args) {
        try {
            Scanner scanner = new Scanner(System.in);
            System.out.print(""Enter username: "");
            String username = scanner.nextLine();

            Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");
            Statement stmt = conn.createStatement();

            String query = ""SELECT * FROM users WHERE username='"" + username + ""'"";
            
            ResultSet rs = stmt.executeQuery(query);

            while (rs.next()) {
                System.out.println(""User ID: "" + rs.getInt(""id"") + "", Username: "" + rs.getString(""username""));
            }

            stmt.close();
            conn.close();
        } catch (Exception e) {
            e.printStackTrace();
        }
    }
}","import java.sql.Connection; import java.sql.DriverManager; import java.sql.ResultSet; import java.sql.Statement; import java.util.Scanner; public class SQLInjectionVulnerable { public static void main(String[] args) { try { Scanner scanner = new Scanner(System.in); System.out.print(""Enter username: ""); String username = scanner.nextLine(); Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); Statement stmt = conn.createStatement(); String query = ""SELECT * FROM users WHERE username='"" + username + ""'""; ResultSet rs = stmt.executeQuery(query); while (rs.next()) { System.out.println(""User ID: "" + rs.getInt(""id"") + "", Username: "" + rs.getString(""username"")); } stmt.close(); conn.close(); } catch (Exception e) { e.printStackTrace(); } } }",java,1
Clear,"To fix the insecure deserialization vulnerability in the given Java code snippet, you can implement proper security measures to prevent malicious code execution. Here are some steps you can take to enhance the security of deserialization:

1. Use a Secure Deserialization Framework: Instead of directly deserializing data using `ObjectInputStream`, consider using a secure deserialization framework like Google's GSON, Jackson, or Java's Serialization Filtering. These frameworks provide mechanisms to control which classes can be deserialized and help prevent code execution from unexpected or malicious objects.

2. Implement Input Validation: Validate the input data before deserializing it to ensure that it meets the expected format and content. This can help prevent malicious input from being processed.

3. Use Whitelisting: Maintain a whitelist of allowed classes that can be deserialized and restrict deserialization to only those classes. This helps prevent arbitrary class instantiation and execution.

4. Enable Serialization Filtering: If you are using Java 9 or later, you can enable serialization filtering by setting the system property `jdk.serialFilter` to specify a filter configuration file that defines which classes are allowed for serialization/deserialization.

5. Implement Secure Deserialization Handlers: Handle deserialization errors and exceptions properly by logging them securely without exposing sensitive information","To fix the insecure deserialization vulnerability in the given Java code snippet, you can implement proper security measures to prevent malicious code execution. Here are some steps you can take to enhance the security of deserialization: 1. Use a Secure Deserialization Framework: Instead of directly deserializing data using `ObjectInputStream`, consider using a secure deserialization framework like Google's GSON, Jackson, or Java's Serialization Filtering. These frameworks provide mechanisms to control which classes can be deserialized and help prevent code execution from unexpected or malicious objects. 2. Implement Input Validation: Validate the input data before deserializing it to ensure that it meets the expected format and content. This can help prevent malicious input from being processed. 3. Use Whitelisting: Maintain a whitelist of allowed classes that can be deserialized and restrict deserialization to only those classes. This helps prevent arbitrary class instantiation and execution. 4. Enable Serialization Filtering: If you are using Java 9 or later, you can enable serialization filtering by setting the system property `jdk.serialFilter` to specify a filter configuration file that defines which classes are allowed for serialization/deserialization. 5. Implement Secure Deserialization Handlers: Handle deserialization errors and exceptions properly by logging them securely without exposing sensitive information",php,0
File Inclusion,"<?php
$file = $_GET['file'];
include($file); // File Inclusion
?>","<?php
$file = $_GET['file'];
include($file); // File Inclusion
?>",php,1
SQL Injection,"app.get('/user/:id', (req, res) => {
    const query = `SELECT * FROM users WHERE id = ${req.params.id}`; // SQL Injection
    db.query(query, (err, result) => {
        res.json(result);
    });
});
","app.get('/user/:id', (req, res) => {
    const query = `SELECT * FROM users WHERE id = ${req.params.id}`; // SQL Injection
    db.query(query, (err, result) => {
        res.json(result);
    });
});
",javascript,1
SQL Injection,"import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;

public class VulnerableCode {

    public static void main(String[] args) {
        String userInput = ""'; DROP TABLE users; --"";
        
        try {
            Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");
            
            String sql = ""SELECT * FROM users WHERE username = '"" + userInput + ""'"";
            PreparedStatement stmt = conn.prepareStatement(sql);
            
            ResultSet rs = stmt.executeQuery();
            
            while (rs.next()) {
                System.out.println(""Username: "" + rs.getString(""username""));
            }
            
            conn.close();
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.Connection; import java.sql.DriverManager; import java.sql.PreparedStatement; import java.sql.ResultSet; import java.sql.SQLException; public class VulnerableCode { public static void main(String[] args) { String userInput = ""'; DROP TABLE users; --""; try { Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); String sql = ""SELECT * FROM users WHERE username = '"" + userInput + ""'""; PreparedStatement stmt = conn.prepareStatement(sql); ResultSet rs = stmt.executeQuery(); while (rs.next()) { System.out.println(""Username: "" + rs.getString(""username"")); } conn.close(); } catch (SQLException e) { e.printStackTrace(); } } }",java,1
Clear,"import java.io.*;
import javax.servlet.*;
import javax.servlet.http.*;
import org.owasp.esapi.ESAPI;

public class SecureServlet extends HttpServlet {
    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        String userInput = request.getParameter(""input"");
        String encodedInput = ESAPI.encoder().encodeForHTML(userInput);
        String output = ""<h1>Welcome, "" + encodedInput + ""</h1>"";

        PrintWriter out = response.getWriter();
        out.println(output);
    }
}","import java.io.*; import javax.servlet.*; import javax.servlet.http.*; import org.owasp.esapi.ESAPI; public class SecureServlet extends HttpServlet { protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { String userInput = request.getParameter(""input""); String encodedInput = ESAPI.encoder().encodeForHTML(userInput); String output = ""<h1>Welcome, "" + encodedInput + ""</h1>""; PrintWriter out = response.getWriter(); out.println(output); } }",java,0
Command Injection,"const shell = require('child_process');
shell.exec('ping ' + userInput); // Command Injection
","const shell = require('child_process');
shell.exec('ping ' + userInput); // Command Injection
",javascript,1
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Path Traversal,"import os
def read_file(filename):
    with open('/var/www/uploads/' + filename, 'r') as f:
        return f.read()","import os
def read_file(filename):
    with open('/var/www/uploads/' + filename, 'r') as f:
        return f.read()",python,1
Cross-Site Scripting (XSS),"import java.io.*;
import javax.servlet.*;
import javax.servlet.http.*;

public class XssVulnerableServlet extends HttpServlet {
    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        String userInput = request.getParameter(""input"");
        String message = ""Hello, "" + userInput + ""!"";

        response.setContentType(""text/html"");
        PrintWriter out = response.getWriter();
        out.println(""<html><body>"");
        out.println(""<h1>"" + message + ""</h1>"");
        out.println(""</body></html>"");
    }
}","import java.io.*; import javax.servlet.*; import javax.servlet.http.*; public class XssVulnerableServlet extends HttpServlet { protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { String userInput = request.getParameter(""input""); String message = ""Hello, "" + userInput + ""!""; response.setContentType(""text/html""); PrintWriter out = response.getWriter(); out.println(""<html><body>""); out.println(""<h1>"" + message + ""</h1>""); out.println(""</body></html>""); } }",java,1
Clear,"To fix the Command Injection vulnerability in the given Java code snippet, you need to properly sanitize and validate the input command before executing it. One way to address this vulnerability is by using a whitelist approach where only specific commands are allowed to be executed.

Here is an improved version of the code with proper security measures implemented:

```java
import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;
import java.util.Arrays;
import java.util.List;

public class CommandInjectionFixed {

    private static final List<String> ALLOWED_COMMANDS = Arrays.asList(""echo"", ""dir""); // Define a whitelist of allowed commands

    public static void main(String[] args) {
        try {
            ProcessBuilder processBuilder = new ProcessBuilder();

            BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));
            System.out.print(""Enter a command to execute: "");
            String command = reader.readLine().trim();

            if (!isCommandAllowed(command)) {
                System.out.println(""Command not allowed"");
                return;
            }

            processBuilder.command(""cmd"", ""/c"", command);

            Process process = processBuilder.start();

            BufferedReader inputReader = new BufferedReader(new InputStreamReader(process.getInputStream()));
            String line;
            while ((line = inputReader.readLine()) != null","To fix the Command Injection vulnerability in the given Java code snippet, you need to properly sanitize and validate the input command before executing it. One way to address this vulnerability is by using a whitelist approach where only specific commands are allowed to be executed. Here is an improved version of the code with proper security measures implemented: ```java import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; import java.util.Arrays; import java.util.List; public class CommandInjectionFixed { private static final List<String> ALLOWED_COMMANDS = Arrays.asList(""echo"", ""dir""); // Define a whitelist of allowed commands public static void main(String[] args) { try { ProcessBuilder processBuilder = new ProcessBuilder(); BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a command to execute: ""); String command = reader.readLine().trim(); if (!isCommandAllowed(command)) { System.out.println(""Command not allowed""); return; } processBuilder.command(""cmd"", ""/c"", command); Process process = processBuilder.start(); BufferedReader inputReader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = inputReader.readLine()) != null",java,0
Clear,"const userInput = new URLSearchParams(window.location.search).get('input');
const safeOutput = document.createElement('div');
safeOutput.textContent = userInput; // Safe DOM manipulation
document.body.appendChild(safeOutput);
","const userInput = new URLSearchParams(window.location.search).get('input');
const safeOutput = document.createElement('div');
safeOutput.textContent = userInput; // Safe DOM manipulation
document.body.appendChild(safeOutput);
",javascript,0
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Clear,"To fix the Path Traversal vulnerability in the provided Java code, you need to sanitize the user input and ensure that the input file path is within a safe directory. Here is an improved version of the code with proper security measures implemented:

```java
import java.io.File;
import java.io.IOException;
import java.nio.file.Paths;
import java.util.Scanner;

public class SecurePathTraversal {

    private static final String BASE_DIRECTORY = ""/path/to/secure/directory/"";

    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        System.out.print(""Enter file name: "");
        String fileName = scanner.nextLine();

        // Sanitize the file name to prevent path traversal
        fileName = sanitizeFileName(fileName);

        try {
            File file = new File(BASE_DIRECTORY + fileName);
            if (file.exists() && Paths.get(file.getAbsolutePath()).startsWith(Paths.get(BASE_DIRECTORY))) {
                System.out.println(""File content: "");
                Scanner fileScanner = new Scanner(file);
                while (fileScanner.hasNextLine()) {
                    System.out.println(fileScanner.nextLine());
                }
            } else {
                System.out.println(""File not found or access denied."");
            }
        } catch (IOException e) {
            System.out.println(""","To fix the Path Traversal vulnerability in the provided Java code, you need to sanitize the user input and ensure that the input file path is within a safe directory. Here is an improved version of the code with proper security measures implemented: ```java import java.io.File; import java.io.IOException; import java.nio.file.Paths; import java.util.Scanner; public class SecurePathTraversal { private static final String BASE_DIRECTORY = ""/path/to/secure/directory/""; public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter file name: ""); String fileName = scanner.nextLine(); // Sanitize the file name to prevent path traversal fileName = sanitizeFileName(fileName); try { File file = new File(BASE_DIRECTORY + fileName); if (file.exists() && Paths.get(file.getAbsolutePath()).startsWith(Paths.get(BASE_DIRECTORY))) { System.out.println(""File content: ""); Scanner fileScanner = new Scanner(file); while (fileScanner.hasNextLine()) { System.out.println(fileScanner.nextLine()); } } else { System.out.println(""File not found or access denied.""); } } catch (IOException e) { System.out.println(""",java,0
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Clear,"import java.io.*;
import javax.servlet.*;
import javax.servlet.http.*;
import org.owasp.encoder.Encode;

public class SecureServlet extends HttpServlet {
    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        String userInput = request.getParameter(""input"");
        PrintWriter out = response.getWriter();
        
        out.println(""<html>"");
        out.println(""<body>"");
        out.println(""User input: "" + Encode.forHtml(userInput)); // Encoding user input to prevent XSS
        out.println(""</body>"");
        out.println(""</html>"");
    }
}","import java.io.*; import javax.servlet.*; import javax.servlet.http.*; import org.owasp.encoder.Encode; public class SecureServlet extends HttpServlet { protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { String userInput = request.getParameter(""input""); PrintWriter out = response.getWriter(); out.println(""<html>""); out.println(""<body>""); out.println(""User input: "" + Encode.forHtml(userInput)); // Encoding user input to prevent XSS out.println(""</body>""); out.println(""</html>""); } }",java,0
Clear,"#include <iostream>
#include <vector>
#include <stdexcept>

int safe_vector_access(const std::vector<int>& vec, size_t index) {
    if (index >= vec.size()) {
        throw std::out_of_range(""Index out of range"");
    }
    return vec[index];
}","#include <iostream>
#include <vector>
#include <stdexcept>

int safe_vector_access(const std::vector<int>& vec, size_t index) {
    if (index >= vec.size()) {
        throw std::out_of_range(""Index out of range"");
    }
    return vec[index];
}",cpp,0
Clear,"#include <stdio.h>
#include <stdlib.h>

int safe_string_to_int(const char *str) {
    char *endptr;
    long value = strtol(str, &endptr, 10);
    if (*endptr != '\0' || str == endptr) {
        return -1; // error
    }
    return (int)value;
}","#include <stdio.h>
#include <stdlib.h>

int safe_string_to_int(const char *str) {
    char *endptr;
    long value = strtol(str, &endptr, 10);
    if (*endptr != '\0' || str == endptr) {
        return -1; // error
    }
    return (int)value;
}",c,0
Clear,"To fix the vulnerability in the provided code snippet and prevent Cross-Site Scripting (XSS) attacks, you need to properly sanitize the user input before displaying it on the web page. One common approach is to use HTML escaping to convert special characters into their respective HTML entities.

Here's an updated version of the code that implements proper security measures to prevent XSS attacks:

```java
import java.io.*;
import javax.servlet.*;
import javax.servlet.http.*;

public class SecureServlet extends HttpServlet {
    protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        String userInput = request.getParameter(""input"");
        PrintWriter out = response.getWriter();
        
        out.println(""<html>"");
        out.println(""<body>"");
        out.println(""<p>User Input: "" + escapeHtml(userInput) + ""</p>"");
        out.println(""</body>"");
        out.println(""</html>"");
    }

    private String escapeHtml(String input) {
        if (input == null) {
            return """";
        }
        
        StringBuilder builder = new StringBuilder();
        for (char c : input.toCharArray()) {
            switch (c) {
                case '<':
                    builder.append(""&lt;"");
                    break;
                case '>':
                    builder.append(""&gt;"");
                    break;
                case '&':","To fix the vulnerability in the provided code snippet and prevent Cross-Site Scripting (XSS) attacks, you need to properly sanitize the user input before displaying it on the web page. One common approach is to use HTML escaping to convert special characters into their respective HTML entities. Here's an updated version of the code that implements proper security measures to prevent XSS attacks: ```java import java.io.*; import javax.servlet.*; import javax.servlet.http.*; public class SecureServlet extends HttpServlet { protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { String userInput = request.getParameter(""input""); PrintWriter out = response.getWriter(); out.println(""<html>""); out.println(""<body>""); out.println(""<p>User Input: "" + escapeHtml(userInput) + ""</p>""); out.println(""</body>""); out.println(""</html>""); } private String escapeHtml(String input) { if (input == null) { return """"; } StringBuilder builder = new StringBuilder(); for (char c : input.toCharArray()) { switch (c) { case '<': builder.append(""&lt;""); break; case '>': builder.append(""&gt;""); break; case '&':",java,0
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Clear,"To make this code snippet secure against Insecure Deserialization attacks, you can implement the following security measures:

1. Implement a whitelist approach: Restrict the classes that can be deserialized by maintaining a whitelist of allowed classes. You can do this by defining a custom subclass of ObjectInputStream that overrides the resolveClass method to check if the class is allowed for deserialization.

2. Validate and sanitize input: Ensure that the serialized data provided by the user is validated and sanitized before deserializing it. You can perform input validation to check if the serialized data follows a specific format or structure.

3. Implement input validation checks: Validate the integrity of the serialized data to prevent tampering or injection of malicious objects. You can use cryptographic checksums or digital signatures to verify the integrity of the serialized data.

4. Use safer alternatives: Consider using safer alternatives for object serialization and deserialization, such as JSON serialization/deserialization libraries like Jackson or Gson, which have built-in protections against Java object deserialization vulnerabilities.

5. Apply secure coding practices: Follow secure coding practices such as input validation, output encoding, and proper error handling to prevent security vulnerabilities in your code.

Here's an updated version of your code snippet with some of these security measures implemented:","To make this code snippet secure against Insecure Deserialization attacks, you can implement the following security measures: 1. Implement a whitelist approach: Restrict the classes that can be deserialized by maintaining a whitelist of allowed classes. You can do this by defining a custom subclass of ObjectInputStream that overrides the resolveClass method to check if the class is allowed for deserialization. 2. Validate and sanitize input: Ensure that the serialized data provided by the user is validated and sanitized before deserializing it. You can perform input validation to check if the serialized data follows a specific format or structure. 3. Implement input validation checks: Validate the integrity of the serialized data to prevent tampering or injection of malicious objects. You can use cryptographic checksums or digital signatures to verify the integrity of the serialized data. 4. Use safer alternatives: Consider using safer alternatives for object serialization and deserialization, such as JSON serialization/deserialization libraries like Jackson or Gson, which have built-in protections against Java object deserialization vulnerabilities. 5. Apply secure coding practices: Follow secure coding practices such as input validation, output encoding, and proper error handling to prevent security vulnerabilities in your code. Here's an updated version of your code snippet with some of these security measures implemented:",php,0
Clear,"Scanner scanner = new Scanner(System.in);
System.out.print(""Enter your name: "");
String input = scanner.nextLine();

// Ensure that input does not exceed buffer size
int maxLength = Math.min(input.length(), 10);
char[] buffer = new char[maxLength];
input.getChars(0, maxLength, buffer, 0);","Scanner scanner = new Scanner(System.in); System.out.print(""Enter your name: ""); String input = scanner.nextLine(); // Ensure that input does not exceed buffer size int maxLength = Math.min(input.length(), 10); char[] buffer = new char[maxLength]; input.getChars(0, maxLength, buffer, 0);",python,0
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Clear,"app.get('/user/:id', (req, res) => {
    const userId = parseInt(req.params.id);
    db.query('SELECT * FROM users WHERE id = ?', [userId], (err, result) => {
        res.json(result);
    });
});
","app.get('/user/:id', (req, res) => {
    const userId = parseInt(req.params.id);
    db.query('SELECT * FROM users WHERE id = ?', [userId], (err, result) => {
        res.json(result);
    });
});
",javascript,0
Clear,"import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class SecureCommandExecutionDemo {
    public static void main(String[] args) {
        try {
            BufferedReader br = new BufferedReader(new InputStreamReader(System.in));
            System.out.print(""Enter a command to execute: "");
            String command = br.readLine();

            // Split the user input command into parts
            String[] commandParts = command.split("" "");

            // Use ProcessBuilder to safely execute the command
            ProcessBuilder processBuilder = new ProcessBuilder(commandParts);
            
            Process process = processBuilder.start();

            BufferedReader reader = new BufferedReader(new InputStreamReader(process.getInputStream()));
            String line;
            while ((line = reader.readLine()) != null) {
                System.out.println(line);
            }

        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}","import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class SecureCommandExecutionDemo { public static void main(String[] args) { try { BufferedReader br = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a command to execute: ""); String command = br.readLine(); // Split the user input command into parts String[] commandParts = command.split("" ""); // Use ProcessBuilder to safely execute the command ProcessBuilder processBuilder = new ProcessBuilder(commandParts); Process process = processBuilder.start(); BufferedReader reader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = reader.readLine()) != null) { System.out.println(line); } } catch (IOException e) { e.printStackTrace(); } } }",java,0
Clear,"#include <stdio.h>
#include <string.h>

int safe_buffer_operation(char *input) {
    char buffer[100];
    if (strlen(input) < sizeof(buffer)) {
        strcpy(buffer, input);
        return 0;
    }
    return -1; // buffer too small
}","#include <stdio.h>
#include <string.h>

int safe_buffer_operation(char *input) {
    char buffer[100];
    if (strlen(input) < sizeof(buffer)) {
        strcpy(buffer, input);
        return 0;
    }
    return -1; // buffer too small
}",c,0
Clear,"import java.sql.*;

public class SecureSQLQuery {
    public static void main(String[] args) {
        String userInput = ""'; DROP TABLE users; --""; // Malicious input

        try {
            Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");
            
            // Use PreparedStatement to securely handle user input
            String query = ""SELECT * FROM users WHERE username = ?"";
            PreparedStatement pstmt = conn.prepareStatement(query);
            pstmt.setString(1, userInput);

            ResultSet rs = pstmt.executeQuery();

            while (rs.next()) {
                System.out.println(rs.getString(""username""));
            }

            conn.close();
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.*; public class SecureSQLQuery { public static void main(String[] args) { String userInput = ""'; DROP TABLE users; --""; // Malicious input try { Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); // Use PreparedStatement to securely handle user input String query = ""SELECT * FROM users WHERE username = ?""; PreparedStatement pstmt = conn.prepareStatement(query); pstmt.setString(1, userInput); ResultSet rs = pstmt.executeQuery(); while (rs.next()) { System.out.println(rs.getString(""username"")); } conn.close(); } catch (SQLException e) { e.printStackTrace(); } } }",java,0
Clear,"import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;

public class SecureCode {

    public static void main(String[] args) {
        String userInput = ""'; DROP TABLE users; --""; // Simulated user input

        try (Connection connection = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"")) {
            String query = ""SELECT * FROM users WHERE username = ?"";
            PreparedStatement preparedStatement = connection.prepareStatement(query);
            preparedStatement.setString(1, userInput);

            ResultSet resultSet = preparedStatement.executeQuery();

            while (resultSet.next()) {
                System.out.println(resultSet.getString(""username""));
            }
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.Connection; import java.sql.DriverManager; import java.sql.PreparedStatement; import java.sql.ResultSet; import java.sql.SQLException; public class SecureCode { public static void main(String[] args) { String userInput = ""'; DROP TABLE users; --""; // Simulated user input try (Connection connection = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"")) { String query = ""SELECT * FROM users WHERE username = ?""; PreparedStatement preparedStatement = connection.prepareStatement(query); preparedStatement.setString(1, userInput); ResultSet resultSet = preparedStatement.executeQuery(); while (resultSet.next()) { System.out.println(resultSet.getString(""username"")); } } catch (SQLException e) { e.printStackTrace(); } } }",java,0
Clear,"#include <iostream>
#include <string>
#include <vector>

void safe_string_handling(const std::string& input) {
    std::string safe_copy = input;
    std::cout << safe_copy << std::endl;
}","#include <iostream>
#include <string>
#include <vector>

void safe_string_handling(const std::string& input) {
    std::string safe_copy = input;
    std::cout << safe_copy << std::endl;
}",cpp,0
Code Injection,"const userData = eval('(' + userInput + ')'); // eval injection
","const userData = eval('(' + userInput + ')'); // eval injection
",javascript,1
Clear,"This code snippet demonstrates a common vulnerability known as insecure deserialization. Insecure deserialization can lead to serious security risks, such as remote code execution and data tampering. To address this vulnerability and make the code more secure, you can implement the following security measures:

1. **Implement Whitelisting:** Restrict the types of objects that can be deserialized by maintaining a whitelist of allowed classes. Only allow deserialization of classes that are explicitly whitelisted to prevent malicious object instantiation.

2. **Validate Input:** Validate any input data before deserialization to ensure it comes from a trusted and authenticated source. This can help prevent injection attacks and ensure the integrity of the serialized data.

3. **Enable Security Manager:** Utilize Java Security Manager to restrict access to sensitive resources and prevent malicious code execution during deserialization.

4. **Use Signed Serialized Objects:** Sign serialized objects using digital signatures to verify their authenticity before deserialization. This helps ensure that the serialized data has not been tampered with.

5. **Implement Serialization Filters:** Implement custom serialization filters or use libraries like Apache Commons Collections or XStream with security patches to mitigate known deserialization vulnerabilities.

Here is an updated version of your code snippet with some of these security measures implemented:

```java","This code snippet demonstrates a common vulnerability known as insecure deserialization. Insecure deserialization can lead to serious security risks, such as remote code execution and data tampering. To address this vulnerability and make the code more secure, you can implement the following security measures: 1. **Implement Whitelisting:** Restrict the types of objects that can be deserialized by maintaining a whitelist of allowed classes. Only allow deserialization of classes that are explicitly whitelisted to prevent malicious object instantiation. 2. **Validate Input:** Validate any input data before deserialization to ensure it comes from a trusted and authenticated source. This can help prevent injection attacks and ensure the integrity of the serialized data. 3. **Enable Security Manager:** Utilize Java Security Manager to restrict access to sensitive resources and prevent malicious code execution during deserialization. 4. **Use Signed Serialized Objects:** Sign serialized objects using digital signatures to verify their authenticity before deserialization. This helps ensure that the serialized data has not been tampered with. 5. **Implement Serialization Filters:** Implement custom serialization filters or use libraries like Apache Commons Collections or XStream with security patches to mitigate known deserialization vulnerabilities. Here is an updated version of your code snippet with some of these security measures implemented: ```java",php,0
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Hardcoded Secrets,"DATABASE_PASSWORD = ""my_super_secret_password_123""
def db_connect():
    import psycopg2
    return psycopg2.connect(f""dbname=test user=admin password={DATABASE_PASSWORD}"")","DATABASE_PASSWORD = ""my_super_secret_password_123""
def db_connect():
    import psycopg2
    return psycopg2.connect(f""dbname=test user=admin password={DATABASE_PASSWORD}"")",python,1
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
File Inclusion,"<?php
$file = $_GET['file'];
include($file); // File Inclusion
?>","<?php
$file = $_GET['file'];
include($file); // File Inclusion
?>",php,1
Clear,"To fix the insecure Java code snippet for Command Injection, you need to ensure that user input is properly sanitized and validated before being used in the command execution. Here is an improved version of the code with security measures:

```java
import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class SecureCommandInjectionExample {

    public static void main(String[] args) {
        try {
            BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));
            System.out.print(""Enter a website to ping: "");
            String website = reader.readLine();

            // Validate user input to prevent command injection
            if (!isValidInput(website)) {
                System.out.println(""Invalid input. Please enter a valid website."");
                return;
            }

            String[] command = {""ping"", website};

            ProcessBuilder processBuilder = new ProcessBuilder(command);
            Process process = processBuilder.start();

            BufferedReader inputStream = new BufferedReader(new InputStreamReader(process.getInputStream()));

            String line;
            while ((line = inputStream.readLine()) != null) {
                System.out.println(line);
            }

        } catch (IOException e) {
            e.printStackTrace();
        }
    }

    // Validate user input to prevent command injection
    private static boolean isValidInput(String input) {","To fix the insecure Java code snippet for Command Injection, you need to ensure that user input is properly sanitized and validated before being used in the command execution. Here is an improved version of the code with security measures: ```java import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class SecureCommandInjectionExample { public static void main(String[] args) { try { BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a website to ping: ""); String website = reader.readLine(); // Validate user input to prevent command injection if (!isValidInput(website)) { System.out.println(""Invalid input. Please enter a valid website.""); return; } String[] command = {""ping"", website}; ProcessBuilder processBuilder = new ProcessBuilder(command); Process process = processBuilder.start(); BufferedReader inputStream = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = inputStream.readLine()) != null) { System.out.println(line); } } catch (IOException e) { e.printStackTrace(); } } // Validate user input to prevent command injection private static boolean isValidInput(String input) {",java,0
Path Traversal,"import java.io.File;
import java.io.IOException;
import java.nio.file.Files;
import java.util.Scanner;

public class PathTraversalVulnerability {
    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        System.out.print(""Enter a file name: "");
        String fileName = scanner.nextLine();
        
        File file = new File(""/path/to/files/"" + fileName);
        
        try {
            byte[] fileContent = Files.readAllBytes(file.toPath());
            System.out.println(""File content: "" + new String(fileContent));
        } catch (IOException e) {
            System.out.println(""Error reading file: "" + e.getMessage());
        }
    }
}","import java.io.File; import java.io.IOException; import java.nio.file.Files; import java.util.Scanner; public class PathTraversalVulnerability { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter a file name: ""); String fileName = scanner.nextLine(); File file = new File(""/path/to/files/"" + fileName); try { byte[] fileContent = Files.readAllBytes(file.toPath()); System.out.println(""File content: "" + new String(fileContent)); } catch (IOException e) { System.out.println(""Error reading file: "" + e.getMessage()); } } }",java,1
Buffer Overflow,"import java.util.Scanner;

public class BufferOverflowExample {

    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        
        System.out.print(""Enter your name: "");
        String name = scanner.nextLine();
        
        char[] buffer = new char[10];
        // Simulating buffer overflow vulnerability
        for (int i = 0; i < name.length(); i++) {
            buffer[i] = name.charAt(i);
        }
        
        System.out.println(""Buffer contents: "" + new String(buffer));
    }
}","import java.util.Scanner; public class BufferOverflowExample { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter your name: ""); String name = scanner.nextLine(); char[] buffer = new char[10]; // Simulating buffer overflow vulnerability for (int i = 0; i < name.length(); i++) { buffer[i] = name.charAt(i); } System.out.println(""Buffer contents: "" + new String(buffer)); } }",java,1
Clear,"#include <stdio.h>
#include <stdlib.h>

int safe_string_to_int(const char *str) {
    char *endptr;
    long value = strtol(str, &endptr, 10);
    if (*endptr != '\0' || str == endptr) {
        return -1; // error
    }
    return (int)value;
}","#include <stdio.h>
#include <stdlib.h>

int safe_string_to_int(const char *str) {
    char *endptr;
    long value = strtol(str, &endptr, 10);
    if (*endptr != '\0' || str == endptr) {
        return -1; // error
    }
    return (int)value;
}",c,0
Path Traversal,"import java.io.BufferedReader;
import java.io.File;
import java.io.FileReader;
import java.io.IOException;

public class PathTraversalVulnerability {

    public static void main(String[] args) {
        String userInput = ""../secretFile.txt"";
        String directory = ""/home/user/files/"";

        String filePath = directory + userInput;

        try {
            File file = new File(filePath);
            BufferedReader br = new BufferedReader(new FileReader(file));
            String line;
            while ((line = br.readLine()) != null) {
                System.out.println(line);
            }
            br.close();
        } catch (IOException e) {
            System.out.println(""Error reading file: "" + e.getMessage());
        }
    }
}","import java.io.BufferedReader; import java.io.File; import java.io.FileReader; import java.io.IOException; public class PathTraversalVulnerability { public static void main(String[] args) { String userInput = ""../secretFile.txt""; String directory = ""/home/user/files/""; String filePath = directory + userInput; try { File file = new File(filePath); BufferedReader br = new BufferedReader(new FileReader(file)); String line; while ((line = br.readLine()) != null) { System.out.println(line); } br.close(); } catch (IOException e) { System.out.println(""Error reading file: "" + e.getMessage()); } } }",java,1
SQL Injection,"import mysql.connector
def search_products(category):
    db = mysql.connector.connect(host=""localhost"", user=""user"", password=""pass"", database=""shop"")
    cursor = db.cursor()
    cursor.execute(""SELECT * FROM products WHERE category = '%s'"" % category)
    return cursor.fetchall()","import mysql.connector
def search_products(category):
    db = mysql.connector.connect(host=""localhost"", user=""user"", password=""pass"", database=""shop"")
    cursor = db.cursor()
    cursor.execute(""SELECT * FROM products WHERE category = '%s'"" % category)
    return cursor.fetchall()",python,1
Out-of-Bounds,"#include <iostream>

class UnsafeClass {
    int data[10];
public:
    int get_data(int index) {
        return data[index]; // no bounds checking
    }
};","#include <iostream>

class UnsafeClass {
    int data[10];
public:
    int get_data(int index) {
        return data[index]; // no bounds checking
    }
};",cpp,1
Clear,"To fix the Path Traversal vulnerability in the provided Java code snippet, you need to ensure that the user input is properly validated and sanitized before constructing the file path. Here's an improved version of the code with security measures implemented:

```java
import java.io.File;
import java.io.IOException;
import java.util.Scanner;

public class SecurePathTraversal {
    
    public static void main(String[] args) throws IOException {
        Scanner scanner = new Scanner(System.in);
        
        System.out.print(""Enter file name: "");
        String fileName = scanner.next();
        
        // Validate input to prevent Path Traversal
        if (!isValidFileName(fileName)) {
            System.out.println(""Invalid file name."");
            return;
        }
        
        File file = new File(""/path/to/directory/"" + fileName);
        
        if(file.exists()) {
            System.out.println(""File exists."");
            // Code to read or manipulate the file
        } else {
            System.out.println(""File does not exist."");
        }
    }
    
    // Method to validate file name against Path Traversal
    private static boolean isValidFileName(String fileName) {
        // Add your validation logic here, e.g., disallowing path separators like ""../""
        if (fileName.contains(""..","To fix the Path Traversal vulnerability in the provided Java code snippet, you need to ensure that the user input is properly validated and sanitized before constructing the file path. Here's an improved version of the code with security measures implemented: ```java import java.io.File; import java.io.IOException; import java.util.Scanner; public class SecurePathTraversal { public static void main(String[] args) throws IOException { Scanner scanner = new Scanner(System.in); System.out.print(""Enter file name: ""); String fileName = scanner.next(); // Validate input to prevent Path Traversal if (!isValidFileName(fileName)) { System.out.println(""Invalid file name.""); return; } File file = new File(""/path/to/directory/"" + fileName); if(file.exists()) { System.out.println(""File exists.""); // Code to read or manipulate the file } else { System.out.println(""File does not exist.""); } } // Method to validate file name against Path Traversal private static boolean isValidFileName(String fileName) { // Add your validation logic here, e.g., disallowing path separators like ""../"" if (fileName.contains(""..",java,0
Path Traversal,"import java.io.File;
import java.io.IOException;
import java.nio.file.Files;
import java.util.Scanner;

public class PathTraversalVulnerability {

    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        System.out.print(""Enter file name: "");
        String fileName = scanner.nextLine();

        File file = new File(""C:/data/"" + fileName); // Vulnerable code - Concatenating user input directly into the file path

        try {
            byte[] fileData = Files.readAllBytes(file.toPath());
            System.out.println(new String(fileData));
        } catch (IOException e) {
            System.out.println(""Error reading file: "" + e.getMessage());
        }
    }
}","import java.io.File; import java.io.IOException; import java.nio.file.Files; import java.util.Scanner; public class PathTraversalVulnerability { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter file name: ""); String fileName = scanner.nextLine(); File file = new File(""C:/data/"" + fileName); // Vulnerable code - Concatenating user input directly into the file path try { byte[] fileData = Files.readAllBytes(file.toPath()); System.out.println(new String(fileData)); } catch (IOException e) { System.out.println(""Error reading file: "" + e.getMessage()); } } }",java,1
Clear,"def validate_input(input_str):
    if not isinstance(input_str, str):
        raise TypeError(""Input must be string"")
    if len(input_str) > 100:
        raise ValueError(""Input too long"")
    if '<script>' in input_str.lower():
        raise ValueError(""Invalid input"")
    return input_str.strip()","def validate_input(input_str):
    if not isinstance(input_str, str):
        raise TypeError(""Input must be string"")
    if len(input_str) > 100:
        raise ValueError(""Input too long"")
    if '<script>' in input_str.lower():
        raise ValueError(""Invalid input"")
    return input_str.strip()",python,0
Clear,"<?php
$input = json_decode($_POST['data'], true); // Safe JSON parsing
if (json_last_error() === JSON_ERROR_NONE) {
    process_data($input);
}
?>","<?php
$input = json_decode($_POST['data'], true); // Safe JSON parsing
if (json_last_error() === JSON_ERROR_NONE) {
    process_data($input);
}
?>",php,0
Clear,"#include <stdio.h>
#include <stdlib.h>

void safe_file_operation(const char *filename) {
    FILE *file = fopen(filename, ""r"");
    if (file != NULL) {
        char buffer[256];
        while (fgets(buffer, sizeof(buffer), file)) {
            printf(""%s"", buffer);
        }
        fclose(file);
    }
}","#include <stdio.h>
#include <stdlib.h>

void safe_file_operation(const char *filename) {
    FILE *file = fopen(filename, ""r"");
    if (file != NULL) {
        char buffer[256];
        while (fgets(buffer, sizeof(buffer), file)) {
            printf(""%s"", buffer);
        }
        fclose(file);
    }
}",c,0
Clear,"import os
def get_api_key():
    return os.environ.get('API_KEY')","import os
def get_api_key():
    return os.environ.get('API_KEY')",python,0
Clear,"import java.io.*;
import javax.servlet.*;
import javax.servlet.http.*;
import org.owasp.encoder.Encode;

public class SecureServlet extends HttpServlet {
    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        String userInput = request.getParameter(""input"");
        
        // Properly encode user input using OWASP Java Encoder
        String encodedUserInput = Encode.forHtml(userInput);

        String output = ""<html><body>Welcome, "" + encodedUserInput + ""</body></html>"";

        PrintWriter out = response.getWriter();
        out.println(output);
    }
}","import java.io.*; import javax.servlet.*; import javax.servlet.http.*; import org.owasp.encoder.Encode; public class SecureServlet extends HttpServlet { protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { String userInput = request.getParameter(""input""); // Properly encode user input using OWASP Java Encoder String encodedUserInput = Encode.forHtml(userInput); String output = ""<html><body>Welcome, "" + encodedUserInput + ""</body></html>""; PrintWriter out = response.getWriter(); out.println(output); } }",java,0
Out-of-Bounds,"#include <iostream>

class UnsafeClass {
    int data[10];
public:
    int get_data(int index) {
        return data[index]; // no bounds checking
    }
};","#include <iostream>

class UnsafeClass {
    int data[10];
public:
    int get_data(int index) {
        return data[index]; // no bounds checking
    }
};",cpp,1
Hardcoded Secrets,"DATABASE_PASSWORD = ""my_super_secret_password_123""
def db_connect():
    import psycopg2
    return psycopg2.connect(f""dbname=test user=admin password={DATABASE_PASSWORD}"")","DATABASE_PASSWORD = ""my_super_secret_password_123""
def db_connect():
    import psycopg2
    return psycopg2.connect(f""dbname=test user=admin password={DATABASE_PASSWORD}"")",python,1
Clear,"#include <stdio.h>
#include <stdlib.h>

int safe_string_to_int(const char *str) {
    char *endptr;
    long value = strtol(str, &endptr, 10);
    if (*endptr != '\0' || str == endptr) {
        return -1; // error
    }
    return (int)value;
}","#include <stdio.h>
#include <stdlib.h>

int safe_string_to_int(const char *str) {
    char *endptr;
    long value = strtol(str, &endptr, 10);
    if (*endptr != '\0' || str == endptr) {
        return -1; // error
    }
    return (int)value;
}",c,0
Clear,"const userInput = new URLSearchParams(window.location.search).get('input');
const safeOutput = document.createElement('div');
safeOutput.textContent = userInput; // Safe DOM manipulation
document.body.appendChild(safeOutput);
","const userInput = new URLSearchParams(window.location.search).get('input');
const safeOutput = document.createElement('div');
safeOutput.textContent = userInput; // Safe DOM manipulation
document.body.appendChild(safeOutput);
",javascript,0
XSS,"<?php
echo $_GET['message']; // XSS
?>","<?php
echo $_GET['message']; // XSS
?>",php,1
Clear,"import requests
def safe_fetch_url(url):
    allowed_domains = ['example.com', 'api.trusted.com']
    from urllib.parse import urlparse
    domain = urlparse(url).netloc
    if domain not in allowed_domains:
        raise ValueError(""Domain not allowed"")
    return requests.get(url).text","import requests
def safe_fetch_url(url):
    allowed_domains = ['example.com', 'api.trusted.com']
    from urllib.parse import urlparse
    domain = urlparse(url).netloc
    if domain not in allowed_domains:
        raise ValueError(""Domain not allowed"")
    return requests.get(url).text",python,0
Buffer Overflow,"#include <iostream>
#include <cstdio>

void unsafe_c_input() {
    char buffer[50];
    scanf(""%s"", buffer); // no length limit
    std::cout << buffer << std::endl;
}","#include <iostream>
#include <cstdio>

void unsafe_c_input() {
    char buffer[50];
    scanf(""%s"", buffer); // no length limit
    std::cout << buffer << std::endl;
}",cpp,1
SQL Injection,"<?php
$username = $_POST['username'];
$query = ""SELECT * FROM users WHERE username = '$username'"";
$result = mysql_query($query); // SQL Injection
?>","<?php
$username = $_POST['username'];
$query = ""SELECT * FROM users WHERE username = '$username'"";
$result = mysql_query($query); // SQL Injection
?>",php,1
Clear,"import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class SecureCommandExecutionExample {
    public static void main(String[] args) {
        try {
            BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));
            System.out.print(""Enter the name of the file to display: "");
            String fileName = reader.readLine();

            // Safely build and execute the command using ProcessBuilder
            ProcessBuilder processBuilder = new ProcessBuilder(""cat"", fileName);
            Process process = processBuilder.start();

            BufferedReader outputReader = new BufferedReader(new InputStreamReader(process.getInputStream()));
            String line;

            System.out.println(""Output:"");
            while ((line = outputReader.readLine()) != null) {
                System.out.println(line);
            }

        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}","import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class SecureCommandExecutionExample { public static void main(String[] args) { try { BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter the name of the file to display: ""); String fileName = reader.readLine(); // Safely build and execute the command using ProcessBuilder ProcessBuilder processBuilder = new ProcessBuilder(""cat"", fileName); Process process = processBuilder.start(); BufferedReader outputReader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; System.out.println(""Output:""); while ((line = outputReader.readLine()) != null) { System.out.println(line); } } catch (IOException e) { e.printStackTrace(); } } }",java,0
Buffer Overflow,"#include <iostream>
#include <cstdio>

void unsafe_c_input() {
    char buffer[50];
    scanf(""%s"", buffer); // no length limit
    std::cout << buffer << std::endl;
}","#include <iostream>
#include <cstdio>

void unsafe_c_input() {
    char buffer[50];
    scanf(""%s"", buffer); // no length limit
    std::cout << buffer << std::endl;
}",cpp,1
Hardcoded Secrets,"import requests
def call_api():
    api_key = ""sk_live_1234567890abcdef""
    headers = {'Authorization': f'Bearer {api_key}'}
    return requests.get('https://api.example.com/data', headers=headers)","import requests
def call_api():
    api_key = ""sk_live_1234567890abcdef""
    headers = {'Authorization': f'Bearer {api_key}'}
    return requests.get('https://api.example.com/data', headers=headers)",python,1
Clear,"const userData = JSON.parse(userInput); // Safe JSON parsing
if (userData && typeof userData === 'object') {
    processUserData(userData);
}
","const userData = JSON.parse(userInput); // Safe JSON parsing
if (userData && typeof userData === 'object') {
    processUserData(userData);
}
",javascript,0
Clear,"<?php
$message = htmlspecialchars($_GET['message'], ENT_QUOTES, 'UTF-8');
echo $message; // Sanitized output
?>","<?php
$message = htmlspecialchars($_GET['message'], ENT_QUOTES, 'UTF-8');
echo $message; // Sanitized output
?>",php,0
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Clear,"const userInput = new URLSearchParams(window.location.search).get('input');
const safeOutput = document.createElement('div');
safeOutput.textContent = userInput; // Safe DOM manipulation
document.body.appendChild(safeOutput);
","const userInput = new URLSearchParams(window.location.search).get('input');
const safeOutput = document.createElement('div');
safeOutput.textContent = userInput; // Safe DOM manipulation
document.body.appendChild(safeOutput);
",javascript,0
Command Injection,"<?php
$cmd = $_GET['cmd'];
system($cmd); // Command Injection
?>","<?php
$cmd = $_GET['cmd'];
system($cmd); // Command Injection
?>",php,1
Command Injection,"<?php
$cmd = $_GET['cmd'];
system($cmd); // Command Injection
?>","<?php
$cmd = $_GET['cmd'];
system($cmd); // Command Injection
?>",php,1
Clear,"To fix the insecure deserialization vulnerability in the code snippet, you need to implement proper security measures to prevent malicious code execution via deserialization. Here are some steps you can take to secure the deserialization process:

1. Use a Safe Deserialization Mechanism:
   - Avoid using `ObjectInputStream` directly for deserialization as it can lead to security vulnerabilities.
   - Instead, consider using safer alternatives like JSON or XML serialization libraries that do not execute arbitrary code during deserialization.

2. Implement Whitelisting:
   - Implement a whitelist of allowed classes that can be deserialized to prevent unauthorized or malicious classes from being instantiated.
   - Use a custom `ObjectInputFilter` or library-provided mechanisms for class filtering during deserialization.

3. Validate Input Data:
   - Validate the input data before deserializing it to ensure that it is well-formed and not tampered with.
   - Perform input validation checks such as length verification, content type verification, and integrity checks.

4. Apply Digital Signatures or Encryption:
   - Sign serialized data with digital signatures to ensure data integrity and authenticity during transmission.
   - Encrypt serialized data to protect it from tampering and eavesdropping.

5. Monitor and Log Deserialization Activities:","To fix the insecure deserialization vulnerability in the code snippet, you need to implement proper security measures to prevent malicious code execution via deserialization. Here are some steps you can take to secure the deserialization process: 1. Use a Safe Deserialization Mechanism: - Avoid using `ObjectInputStream` directly for deserialization as it can lead to security vulnerabilities. - Instead, consider using safer alternatives like JSON or XML serialization libraries that do not execute arbitrary code during deserialization. 2. Implement Whitelisting: - Implement a whitelist of allowed classes that can be deserialized to prevent unauthorized or malicious classes from being instantiated. - Use a custom `ObjectInputFilter` or library-provided mechanisms for class filtering during deserialization. 3. Validate Input Data: - Validate the input data before deserializing it to ensure that it is well-formed and not tampered with. - Perform input validation checks such as length verification, content type verification, and integrity checks. 4. Apply Digital Signatures or Encryption: - Sign serialized data with digital signatures to ensure data integrity and authenticity during transmission. - Encrypt serialized data to protect it from tampering and eavesdropping. 5. Monitor and Log Deserialization Activities:",php,0
Out-of-Bounds,"#include <iostream>

class UnsafeClass {
    int data[10];
public:
    int get_data(int index) {
        return data[index]; // no bounds checking
    }
};","#include <iostream>

class UnsafeClass {
    int data[10];
public:
    int get_data(int index) {
        return data[index]; // no bounds checking
    }
};",cpp,1
Insecure Deserialization,"<?php
$data = $_POST['data'];
unserialize($data); // Insecure Deserialization
?>","<?php
$data = $_POST['data'];
unserialize($data); // Insecure Deserialization
?>",php,1
Memory Corruption,"#include <iostream>

void unsafe_pointer_arithmetic(int* array, int size) {
    for (int i = 0; i <= size; i++) {
        std::cout << *(array + i) << std::endl; // potential out-of-bounds
    }
}","#include <iostream>

void unsafe_pointer_arithmetic(int* array, int size) {
    for (int i = 0; i <= size; i++) {
        std::cout << *(array + i) << std::endl; // potential out-of-bounds
    }
}",cpp,1
Clear,"const shell = require('child_process');
const safeInput = userInput.replace(/[^a-zA-Z0-9.]/g, '');
shell.execFile('ping', [safeInput]); // Safe command execution
","const shell = require('child_process');
const safeInput = userInput.replace(/[^a-zA-Z0-9.]/g, '');
shell.execFile('ping', [safeInput]); // Safe command execution
",javascript,0
SQL Injection,"import java.sql.*;

public class VulnerableCode {

    public static void main(String[] args) {
        String userInput = ""'; DROP TABLE users; --"";

        try {
            Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");
            Statement stmt = conn.createStatement();

            String query = ""SELECT * FROM users WHERE username = '"" + userInput + ""'"";
            ResultSet rs = stmt.executeQuery(query);

            while (rs.next()) {
                System.out.println(rs.getString(""username""));
            }

            rs.close();
            stmt.close();
            conn.close();

        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.*; public class VulnerableCode { public static void main(String[] args) { String userInput = ""'; DROP TABLE users; --""; try { Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); Statement stmt = conn.createStatement(); String query = ""SELECT * FROM users WHERE username = '"" + userInput + ""'""; ResultSet rs = stmt.executeQuery(query); while (rs.next()) { System.out.println(rs.getString(""username"")); } rs.close(); stmt.close(); conn.close(); } catch (SQLException e) { e.printStackTrace(); } } }",java,1
Buffer Overflow,"import java.util.Scanner;

public class BufferOverflowExample {

    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        System.out.print(""Enter a string: "");
        String userInput = scanner.next();
        
        // Assume the buffer size is fixed to 10 characters
        char[] buffer = new char[10];
        
        // Copy user input into the buffer without proper bounds checking
        userInput.getChars(0, userInput.length(), buffer, 0);
        
        System.out.println(""Buffer contents: "" + new String(buffer));
    }
}","import java.util.Scanner; public class BufferOverflowExample { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter a string: ""); String userInput = scanner.next(); // Assume the buffer size is fixed to 10 characters char[] buffer = new char[10]; // Copy user input into the buffer without proper bounds checking userInput.getChars(0, userInput.length(), buffer, 0); System.out.println(""Buffer contents: "" + new String(buffer)); } }",java,1
Path Traversal,"import java.io.File;
import java.io.IOException;
import java.nio.file.Files;
import java.nio.file.Paths;

public class FileHandler {

    public void readFile(String fileName) {
        try {
            String path = ""/var/www/files/"" + fileName; // Unsafe concatenation

            byte[] content = Files.readAllBytes(Paths.get(path));
            System.out.println(""File content: "" + new String(content));
        } catch (IOException e) {
            System.out.println(""Error reading file: "" + e.getMessage());
        }
    }

    public static void main(String[] args) {
        FileHandler fileHandler = new FileHandler();
        fileHandler.readFile(""../secret.txt""); // User input passed directly without proper validation
    }
}","import java.io.File; import java.io.IOException; import java.nio.file.Files; import java.nio.file.Paths; public class FileHandler { public void readFile(String fileName) { try { String path = ""/var/www/files/"" + fileName; // Unsafe concatenation byte[] content = Files.readAllBytes(Paths.get(path)); System.out.println(""File content: "" + new String(content)); } catch (IOException e) { System.out.println(""Error reading file: "" + e.getMessage()); } } public static void main(String[] args) { FileHandler fileHandler = new FileHandler(); fileHandler.readFile(""../secret.txt""); // User input passed directly without proper validation } }",java,1
SQL Injection,"import java.sql.*;

public class SQLInjectionVulnerable {
    public static void main(String[] args) {
        String userInput = ""'; DROP TABLE users; --"";
        
        try {
            Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");
            Statement stmt = conn.createStatement();
            
            String query = ""SELECT * FROM users WHERE username = '"" + userInput + ""'"";
            ResultSet rs = stmt.executeQuery(query);
            
            while (rs.next()) {
                System.out.println(rs.getString(""username"") + "" - "" + rs.getString(""email""));
            }
            
            conn.close();
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.*; public class SQLInjectionVulnerable { public static void main(String[] args) { String userInput = ""'; DROP TABLE users; --""; try { Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); Statement stmt = conn.createStatement(); String query = ""SELECT * FROM users WHERE username = '"" + userInput + ""'""; ResultSet rs = stmt.executeQuery(query); while (rs.next()) { System.out.println(rs.getString(""username"") + "" - "" + rs.getString(""email"")); } conn.close(); } catch (SQLException e) { e.printStackTrace(); } } }",java,1
Clear,"#include <stdio.h>
#include <string.h>

int safe_buffer_operation(char *input) {
    char buffer[100];
    if (strlen(input) < sizeof(buffer)) {
        strcpy(buffer, input);
        return 0;
    }
    return -1; // buffer too small
}","#include <stdio.h>
#include <string.h>

int safe_buffer_operation(char *input) {
    char buffer[100];
    if (strlen(input) < sizeof(buffer)) {
        strcpy(buffer, input);
        return 0;
    }
    return -1; // buffer too small
}",c,0
Clear,"import java.sql.*;

public class SecureSQLInjectionExample {
    public static void main(String[] args) {
        String userInput = ""1 OR 1=1"";

        try {
            Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");
            
            String query = ""SELECT * FROM users WHERE id = ?"";
            PreparedStatement pstmt = conn.prepareStatement(query);
            pstmt.setString(1, userInput);
            
            ResultSet rs = pstmt.executeQuery();
            
            while (rs.next()) {
                System.out.println(""User ID: "" + rs.getInt(""id"") + "", Name: "" + rs.getString(""name""));
            }
            
            conn.close();
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.*; public class SecureSQLInjectionExample { public static void main(String[] args) { String userInput = ""1 OR 1=1""; try { Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); String query = ""SELECT * FROM users WHERE id = ?""; PreparedStatement pstmt = conn.prepareStatement(query); pstmt.setString(1, userInput); ResultSet rs = pstmt.executeQuery(); while (rs.next()) { System.out.println(""User ID: "" + rs.getInt(""id"") + "", Name: "" + rs.getString(""name"")); } conn.close(); } catch (SQLException e) { e.printStackTrace(); } } }",java,0
Command Injection,"import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class CommandInjectionExample {

    public static void main(String[] args) {
        try {
            BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));
            System.out.print(""Enter a command to execute: "");
            String userInput = reader.readLine();

            // This code is vulnerable to Command Injection
            Process process = Runtime.getRuntime().exec(""ping "" + userInput);
            BufferedReader inputReader = new BufferedReader(new InputStreamReader(process.getInputStream()));

            String line;
            while ((line = inputReader.readLine()) != null) {
                System.out.println(line);
            }

        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}","import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class CommandInjectionExample { public static void main(String[] args) { try { BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a command to execute: ""); String userInput = reader.readLine(); // This code is vulnerable to Command Injection Process process = Runtime.getRuntime().exec(""ping "" + userInput); BufferedReader inputReader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = inputReader.readLine()) != null) { System.out.println(line); } } catch (IOException e) { e.printStackTrace(); } } }",java,1
XSS,"<?php
echo $_GET['message']; // XSS
?>","<?php
echo $_GET['message']; // XSS
?>",php,1
Clear,"app.get('/user/:id', (req, res) => {
    const userId = parseInt(req.params.id);
    db.query('SELECT * FROM users WHERE id = ?', [userId], (err, result) => {
        res.json(result);
    });
});
","app.get('/user/:id', (req, res) => {
    const userId = parseInt(req.params.id);
    db.query('SELECT * FROM users WHERE id = ?', [userId], (err, result) => {
        res.json(result);
    });
});
",javascript,0
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Clear,"const userInput = new URLSearchParams(window.location.search).get('input');
const safeOutput = document.createElement('div');
safeOutput.textContent = userInput; // Safe DOM manipulation
document.body.appendChild(safeOutput);
","const userInput = new URLSearchParams(window.location.search).get('input');
const safeOutput = document.createElement('div');
safeOutput.textContent = userInput; // Safe DOM manipulation
document.body.appendChild(safeOutput);
",javascript,0
XSS,"<?php
echo $_GET['message']; // XSS
?>","<?php
echo $_GET['message']; // XSS
?>",php,1
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Buffer Overflow,"#include <iostream>
#include <cstring>

void unsafe_c_string(char* input) {
    char buffer[100];
    strcpy(buffer, input); // potential buffer overflow
    std::cout << buffer << std::endl;
}","#include <iostream>
#include <cstring>

void unsafe_c_string(char* input) {
    char buffer[100];
    strcpy(buffer, input); // potential buffer overflow
    std::cout << buffer << std::endl;
}",cpp,1
Clear,"#include <iostream>
#include <string>
#include <vector>

void safe_string_handling(const std::string& input) {
    std::string safe_copy = input;
    std::cout << safe_copy << std::endl;
}","#include <iostream>
#include <string>
#include <vector>

void safe_string_handling(const std::string& input) {
    std::string safe_copy = input;
    std::cout << safe_copy << std::endl;
}",cpp,0
Clear,"import java.io.File;
import java.io.FileInputStream;
import java.io.IOException;

public class PathTraversalExample {

    public static void main(String[] args) {
        String userInput = ""../etc/passwd"";
        String directory = ""/home/user/files/"";

        // Validate the userInput to ensure it does not contain any path traversal sequences
        if (!userInput.contains("".."") && !userInput.contains(""/"")) {
            File file = new File(directory + userInput);

            try (FileInputStream fis = new FileInputStream(file)) {
                int content;
                while ((content = fis.read()) != -1) {
                    System.out.print((char) content);
                }
            } catch (IOException e) {
                e.printStackTrace();
            }
        } else {
            System.out.println(""Invalid file path"");
        }
    }
}","import java.io.File; import java.io.FileInputStream; import java.io.IOException; public class PathTraversalExample { public static void main(String[] args) { String userInput = ""../etc/passwd""; String directory = ""/home/user/files/""; // Validate the userInput to ensure it does not contain any path traversal sequences if (!userInput.contains("".."") && !userInput.contains(""/"")) { File file = new File(directory + userInput); try (FileInputStream fis = new FileInputStream(file)) { int content; while ((content = fis.read()) != -1) { System.out.print((char) content); } } catch (IOException e) { e.printStackTrace(); } } else { System.out.println(""Invalid file path""); } } }",java,0
Cross-Site Scripting (XSS),"def display_comment(comment_text):
    return f""<div class='comment'>{comment_text}</div>"" ","def display_comment(comment_text):
    return f""<div class='comment'>{comment_text}</div>"" ",python,1
Command Injection,"import java.io.*;

public class CommandInjectionDemo {
    public static void main(String[] args) {
        try {
            BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));
            
            System.out.print(""Enter a command to execute: "");
            String command = reader.readLine();
            
            // WARNING: Improperly handling user input can lead to command injection vulnerability
            Process process = Runtime.getRuntime().exec(""ping -c 4 "" + command);
            
            BufferedReader inputReader = new BufferedReader(new InputStreamReader(process.getInputStream()));
            String line;
            
            while ((line = inputReader.readLine()) != null) {
                System.out.println(line);
            }
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}","import java.io.*; public class CommandInjectionDemo { public static void main(String[] args) { try { BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a command to execute: ""); String command = reader.readLine(); // WARNING: Improperly handling user input can lead to command injection vulnerability Process process = Runtime.getRuntime().exec(""ping -c 4 "" + command); BufferedReader inputReader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = inputReader.readLine()) != null) { System.out.println(line); } } catch (IOException e) { e.printStackTrace(); } } }",java,1
Command Injection,"import subprocess
def list_directory(path):
    result = subprocess.run(f""ls {path}"", shell=True, capture_output=True, text=True)
    return result.stdout","import subprocess
def list_directory(path):
    result = subprocess.run(f""ls {path}"", shell=True, capture_output=True, text=True)
    return result.stdout",python,1
Clear,"<?php
$file = basename($_GET['file']);
$allowed = ['page1.php', 'page2.php'];
if (in_array($file, $allowed)) {
    include($file);
}
?>","<?php
$file = basename($_GET['file']);
$allowed = ['page1.php', 'page2.php'];
if (in_array($file, $allowed)) {
    include($file);
}
?>",php,0
Clear,"import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;

public class SecureSQLInjectionFixed {

    public static void main(String[] args) {
        String userInput = ""'; DROP TABLE users; --""; // Simulated user input

        try {
            Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");

            String query = ""SELECT * FROM users WHERE username = ?"";
            PreparedStatement statement = conn.prepareStatement(query);
            statement.setString(1, userInput); // Set user input as a parameter

            ResultSet resultSet = statement.executeQuery();

            while (resultSet.next()) {
                System.out.println(resultSet.getString(""username""));
            }

            conn.close();
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.Connection; import java.sql.DriverManager; import java.sql.PreparedStatement; import java.sql.ResultSet; import java.sql.SQLException; public class SecureSQLInjectionFixed { public static void main(String[] args) { String userInput = ""'; DROP TABLE users; --""; // Simulated user input try { Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); String query = ""SELECT * FROM users WHERE username = ?""; PreparedStatement statement = conn.prepareStatement(query); statement.setString(1, userInput); // Set user input as a parameter ResultSet resultSet = statement.executeQuery(); while (resultSet.next()) { System.out.println(resultSet.getString(""username"")); } conn.close(); } catch (SQLException e) { e.printStackTrace(); } } }",java,0
Clear,"#include <stdio.h>
#include <stdlib.h>

void safe_file_operation(const char *filename) {
    FILE *file = fopen(filename, ""r"");
    if (file != NULL) {
        char buffer[256];
        while (fgets(buffer, sizeof(buffer), file)) {
            printf(""%s"", buffer);
        }
        fclose(file);
    }
}","#include <stdio.h>
#include <stdlib.h>

void safe_file_operation(const char *filename) {
    FILE *file = fopen(filename, ""r"");
    if (file != NULL) {
        char buffer[256];
        while (fgets(buffer, sizeof(buffer), file)) {
            printf(""%s"", buffer);
        }
        fclose(file);
    }
}",c,0
Clear,"from flask import Flask, request
import html
app = Flask(__name__)

@app.route('/search_safe')
def search_safe():
    query = request.args.get('q', '')
    safe_query = html.escape(query)
    return f'<h1>Search results for: {safe_query}</h1>'","from flask import Flask, request
import html
app = Flask(__name__)

@app.route('/search_safe')
def search_safe():
    query = request.args.get('q', '')
    safe_query = html.escape(query)
    return f'<h1>Search results for: {safe_query}</h1>'",python,0
Memory Corruption,"#include <iostream>

void unsafe_virtual_call() {
    // Potential vtable corruption vulnerability
    class Base {
    public:
        virtual void func() { std::cout << ""Base"" << std::endl; }
    };
    
    class Derived : public Base {
    public:
        void func() override { std::cout << ""Derived"" << std::endl; }
    };
}","#include <iostream>

void unsafe_virtual_call() {
    // Potential vtable corruption vulnerability
    class Base {
    public:
        virtual void func() { std::cout << ""Base"" << std::endl; }
    };
    
    class Derived : public Base {
    public:
        void func() override { std::cout << ""Derived"" << std::endl; }
    };
}",cpp,1
Buffer Overflow,"#include <iostream>
#include <cstring>

void unsafe_c_string(char* input) {
    char buffer[100];
    strcpy(buffer, input); // potential buffer overflow
    std::cout << buffer << std::endl;
}","#include <iostream>
#include <cstring>

void unsafe_c_string(char* input) {
    char buffer[100];
    strcpy(buffer, input); // potential buffer overflow
    std::cout << buffer << std::endl;
}",cpp,1
Command Injection,"<?php
$cmd = $_GET['cmd'];
system($cmd); // Command Injection
?>","<?php
$cmd = $_GET['cmd'];
system($cmd); // Command Injection
?>",php,1
Clear,"const userData = JSON.parse(userInput); // Safe JSON parsing
if (userData && typeof userData === 'object') {
    processUserData(userData);
}
","const userData = JSON.parse(userInput); // Safe JSON parsing
if (userData && typeof userData === 'object') {
    processUserData(userData);
}
",javascript,0
Clear,"import sqlite3
def get_user_data_safe(username):
    conn = sqlite3.connect('database.db')
    cursor = conn.cursor()
    query = ""SELECT * FROM users WHERE username = ?""
    cursor.execute(query, (username,))
    return cursor.fetchall()","import sqlite3
def get_user_data_safe(username):
    conn = sqlite3.connect('database.db')
    cursor = conn.cursor()
    query = ""SELECT * FROM users WHERE username = ?""
    cursor.execute(query, (username,))
    return cursor.fetchall()",python,0
Cross-Site Scripting (XSS),"import java.io.IOException;
import java.io.PrintWriter;

import javax.servlet.ServletException;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

@WebServlet(""/xss"")
public class XssVulnerableServlet extends HttpServlet {

    protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        String userInput = request.getParameter(""input"");
        
        // Improper handling of user input without sanitization
        PrintWriter out = response.getWriter();
        out.println(""<html><body>"");
        out.println(""<h1>User Input: "" + userInput + ""</h1>"");
        out.println(""</body></html>"");
    }
}","import java.io.IOException; import java.io.PrintWriter; import javax.servlet.ServletException; import javax.servlet.annotation.WebServlet; import javax.servlet.http.HttpServlet; import javax.servlet.http.HttpServletRequest; import javax.servlet.http.HttpServletResponse; @WebServlet(""/xss"") public class XssVulnerableServlet extends HttpServlet { protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { String userInput = request.getParameter(""input""); // Improper handling of user input without sanitization PrintWriter out = response.getWriter(); out.println(""<html><body>""); out.println(""<h1>User Input: "" + userInput + ""</h1>""); out.println(""</body></html>""); } }",java,1
Cross-Site Scripting (XSS),"import java.io.IOException;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

public class XSSVulnerableServlet extends HttpServlet {

    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws IOException {
        String userInput = request.getParameter(""input"");
        String output = ""<p>"" + userInput + ""</p>""; // Improperly handling user input
        
        response.setContentType(""text/html"");
        response.getWriter().write(output);
    }
}","import java.io.IOException; import javax.servlet.http.HttpServletRequest; import javax.servlet.http.HttpServletResponse; public class XSSVulnerableServlet extends HttpServlet { protected void doGet(HttpServletRequest request, HttpServletResponse response) throws IOException { String userInput = request.getParameter(""input""); String output = ""<p>"" + userInput + ""</p>""; // Improperly handling user input response.setContentType(""text/html""); response.getWriter().write(output); } }",java,1
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Clear,"<?php
$cmd = escapeshellarg($_GET['cmd']);
system(""ls "" . $cmd); // Escaped command
?>","<?php
$cmd = escapeshellarg($_GET['cmd']);
system(""ls "" . $cmd); // Escaped command
?>",php,0
Command Injection,"import os
def backup_database(db_name):
    os.system(f""pg_dump {db_name} > backup.sql"")","import os
def backup_database(db_name):
    os.system(f""pg_dump {db_name} > backup.sql"")",python,1
Out-of-Bounds,"#include <iostream>

class UnsafeClass {
    int data[10];
public:
    int get_data(int index) {
        return data[index]; // no bounds checking
    }
};","#include <iostream>

class UnsafeClass {
    int data[10];
public:
    int get_data(int index) {
        return data[index]; // no bounds checking
    }
};",cpp,1
Clear,"#include <stdio.h>
#include <stdlib.h>

void safe_file_operation(const char *filename) {
    FILE *file = fopen(filename, ""r"");
    if (file != NULL) {
        char buffer[256];
        while (fgets(buffer, sizeof(buffer), file)) {
            printf(""%s"", buffer);
        }
        fclose(file);
    }
}","#include <stdio.h>
#include <stdlib.h>

void safe_file_operation(const char *filename) {
    FILE *file = fopen(filename, ""r"");
    if (file != NULL) {
        char buffer[256];
        while (fgets(buffer, sizeof(buffer), file)) {
            printf(""%s"", buffer);
        }
        fclose(file);
    }
}",c,0
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Command Injection,"import os
def ping_host(host):
    os.system(""ping -c 4 "" + host)","import os
def ping_host(host):
    os.system(""ping -c 4 "" + host)",python,1
Clear,"This code snippet demonstrates a vulnerability related to insecure deserialization, which can lead to serious security issues such as remote code execution. To fix this vulnerability and implement proper security measures, you should consider the following recommendations:

1. **Avoid Deserializing Untrusted Data**: Do not deserialize data from untrusted sources like user input or network communication directly using `ObjectInputStream`. Instead, consider using safer alternatives like JSON or XML serialization libraries that do not execute arbitrary code during deserialization.

2. **Implement Input Validation**: Validate the input data before deserialization to ensure it meets the expected format and does not contain malicious content. This can help prevent various attacks, including injection attacks.

3. **Use a Secure Deserialization Framework**: If deserialization is necessary, use a secure deserialization framework such as Google's GSON or Jackson with appropriate security configurations to mitigate common vulnerabilities.

4. **Implement Whitelisting/Blacklisting**: Implement a whitelist approach where only known and trusted classes are allowed for deserialization. Alternatively, you can use blacklisting to restrict specific classes that should not be deserialized.

5. **Enable Security Manager**: Consider using Java Security Manager to restrict the actions that can be performed during deserialization. This can help prevent malicious code execution by","This code snippet demonstrates a vulnerability related to insecure deserialization, which can lead to serious security issues such as remote code execution. To fix this vulnerability and implement proper security measures, you should consider the following recommendations: 1. **Avoid Deserializing Untrusted Data**: Do not deserialize data from untrusted sources like user input or network communication directly using `ObjectInputStream`. Instead, consider using safer alternatives like JSON or XML serialization libraries that do not execute arbitrary code during deserialization. 2. **Implement Input Validation**: Validate the input data before deserialization to ensure it meets the expected format and does not contain malicious content. This can help prevent various attacks, including injection attacks. 3. **Use a Secure Deserialization Framework**: If deserialization is necessary, use a secure deserialization framework such as Google's GSON or Jackson with appropriate security configurations to mitigate common vulnerabilities. 4. **Implement Whitelisting/Blacklisting**: Implement a whitelist approach where only known and trusted classes are allowed for deserialization. Alternatively, you can use blacklisting to restrict specific classes that should not be deserialized. 5. **Enable Security Manager**: Consider using Java Security Manager to restrict the actions that can be performed during deserialization. This can help prevent malicious code execution by",php,0
Hardcoded Secrets,"import requests
def call_api():
    api_key = ""sk_live_1234567890abcdef""
    headers = {'Authorization': f'Bearer {api_key}'}
    return requests.get('https://api.example.com/data', headers=headers)","import requests
def call_api():
    api_key = ""sk_live_1234567890abcdef""
    headers = {'Authorization': f'Bearer {api_key}'}
    return requests.get('https://api.example.com/data', headers=headers)",python,1
Command Injection,"<?php
$cmd = $_GET['cmd'];
system($cmd); // Command Injection
?>","<?php
$cmd = $_GET['cmd'];
system($cmd); // Command Injection
?>",php,1
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Clear,"def validate_input(input_str):
    if not isinstance(input_str, str):
        raise TypeError(""Input must be string"")
    if len(input_str) > 100:
        raise ValueError(""Input too long"")
    if '<script>' in input_str.lower():
        raise ValueError(""Invalid input"")
    return input_str.strip()","def validate_input(input_str):
    if not isinstance(input_str, str):
        raise TypeError(""Input must be string"")
    if len(input_str) > 100:
        raise ValueError(""Input too long"")
    if '<script>' in input_str.lower():
        raise ValueError(""Invalid input"")
    return input_str.strip()",python,0
SQL Injection,"import java.sql.*;

public class VulnerableCode {
    public static void main(String[] args) {
        String userInput = ""'; DROP TABLE users; --""; // User input with malicious SQL injection
        String query = ""SELECT * FROM users WHERE username = '"" + userInput + ""'"";

        try {
            Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");
            Statement stmt = conn.createStatement();
            ResultSet rs = stmt.executeQuery(query);

            while (rs.next()) {
                System.out.println(""User found: "" + rs.getString(""username""));
            }

            conn.close();
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.*; public class VulnerableCode { public static void main(String[] args) { String userInput = ""'; DROP TABLE users; --""; // User input with malicious SQL injection String query = ""SELECT * FROM users WHERE username = '"" + userInput + ""'""; try { Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); Statement stmt = conn.createStatement(); ResultSet rs = stmt.executeQuery(query); while (rs.next()) { System.out.println(""User found: "" + rs.getString(""username"")); } conn.close(); } catch (SQLException e) { e.printStackTrace(); } } }",java,1
Clear,"#include <stdio.h>
#include <stdlib.h>

int safe_string_to_int(const char *str) {
    char *endptr;
    long value = strtol(str, &endptr, 10);
    if (*endptr != '\0' || str == endptr) {
        return -1; // error
    }
    return (int)value;
}","#include <stdio.h>
#include <stdlib.h>

int safe_string_to_int(const char *str) {
    char *endptr;
    long value = strtol(str, &endptr, 10);
    if (*endptr != '\0' || str == endptr) {
        return -1; // error
    }
    return (int)value;
}",c,0
Clear,"import java.io.IOException;
import java.io.PrintWriter;
import org.owasp.esapi.ESAPI;
import org.owasp.esapi.errors.EncodingException;

public class XSSFixedCode {

    public static void main(String[] args) throws IOException, EncodingException {
        String userInput = ""<script>alert('XSS Vulnerability')</script>"";

        // Properly escaping user input before outputting it to an HTML page
        PrintWriter out = new PrintWriter(""output.html"");
        out.println(""<html>"");
        out.println(""<head><title>XSS Fixed Page</title></head>"");
        out.println(""<body>"");
        
        // Use ESAPI to encode user input to prevent XSS attacks
        out.println(""<h1>Welcome, "" + ESAPI.encoder().encodeForHTML(userInput) + ""</h1>"");
        
        out.println(""</body>"");
        out.println(""</html>"");

        System.out.println(""Secure HTML page generated successfully."");
    }
}","import java.io.IOException; import java.io.PrintWriter; import org.owasp.esapi.ESAPI; import org.owasp.esapi.errors.EncodingException; public class XSSFixedCode { public static void main(String[] args) throws IOException, EncodingException { String userInput = ""<script>alert('XSS Vulnerability')</script>""; // Properly escaping user input before outputting it to an HTML page PrintWriter out = new PrintWriter(""output.html""); out.println(""<html>""); out.println(""<head><title>XSS Fixed Page</title></head>""); out.println(""<body>""); // Use ESAPI to encode user input to prevent XSS attacks out.println(""<h1>Welcome, "" + ESAPI.encoder().encodeForHTML(userInput) + ""</h1>""); out.println(""</body>""); out.println(""</html>""); System.out.println(""Secure HTML page generated successfully.""); } }",java,0
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Clear,"#include <stdio.h>
#include <string.h>

void safe_string_copy(char *dest, const char *src, size_t dest_size) {
    if (dest_size > 0) {
        strncpy(dest, src, dest_size - 1);
        dest[dest_size - 1] = '\0';
    }
}","#include <stdio.h>
#include <string.h>

void safe_string_copy(char *dest, const char *src, size_t dest_size) {
    if (dest_size > 0) {
        strncpy(dest, src, dest_size - 1);
        dest[dest_size - 1] = '\0';
    }
}",c,0
Clear,"app.get('/user/:id', (req, res) => {
    const userId = parseInt(req.params.id);
    db.query('SELECT * FROM users WHERE id = ?', [userId], (err, result) => {
        res.json(result);
    });
});
","app.get('/user/:id', (req, res) => {
    const userId = parseInt(req.params.id);
    db.query('SELECT * FROM users WHERE id = ?', [userId], (err, result) => {
        res.json(result);
    });
});
",javascript,0
Buffer Overflow,"import java.util.Scanner;

public class BufferOverflowExample {
    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        System.out.print(""Enter your name: "");
        String name = scanner.nextLine();
        
        // Creating a fixed-size array with size 10
        char[] buffer = new char[10];
        
        // Copying user input into the buffer array without proper bounds checking
        name.getChars(0, name.length(), buffer, 0);
        
        System.out.println(""Hello, "" + new String(buffer));
    }
}","import java.util.Scanner; public class BufferOverflowExample { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter your name: ""); String name = scanner.nextLine(); // Creating a fixed-size array with size 10 char[] buffer = new char[10]; // Copying user input into the buffer array without proper bounds checking name.getChars(0, name.length(), buffer, 0); System.out.println(""Hello, "" + new String(buffer)); } }",java,1
Command Injection,"const shell = require('child_process');
shell.exec('ping ' + userInput); // Command Injection
","const shell = require('child_process');
shell.exec('ping ' + userInput); // Command Injection
",javascript,1
Buffer Overflow,"import java.util.Scanner;

public class BufferOverflowExample {

    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        System.out.print(""Enter a string: "");
        String input = scanner.nextLine();

        // Define a fixed size buffer
        char[] buffer = new char[10];

        // Copy user input into the fixed size buffer without proper bounds checking
        input.getChars(0, input.length(), buffer, 0);

        // Print the contents of the buffer
        System.out.println(""Buffer content: "" + new String(buffer));

    }
}","import java.util.Scanner; public class BufferOverflowExample { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter a string: ""); String input = scanner.nextLine(); // Define a fixed size buffer char[] buffer = new char[10]; // Copy user input into the fixed size buffer without proper bounds checking input.getChars(0, input.length(), buffer, 0); // Print the contents of the buffer System.out.println(""Buffer content: "" + new String(buffer)); } }",java,1
Cross-Site Scripting (XSS),"import java.io.IOException;
import javax.servlet.http.*;

public class VulnerableServlet extends HttpServlet {
    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws IOException {
        String userInput = request.getParameter(""input"");
        
        String output = ""<p>User input: "" + userInput + ""</p>"";
        
        response.getWriter().println(output);
    }
}","import java.io.IOException; import javax.servlet.http.*; public class VulnerableServlet extends HttpServlet { protected void doGet(HttpServletRequest request, HttpServletResponse response) throws IOException { String userInput = request.getParameter(""input""); String output = ""<p>User input: "" + userInput + ""</p>""; response.getWriter().println(output); } }",java,1
Command Injection,"<?php
$cmd = $_GET['cmd'];
system($cmd); // Command Injection
?>","<?php
$cmd = $_GET['cmd'];
system($cmd); // Command Injection
?>",php,1
Buffer Overflow,"import java.util.Scanner;

public class BufferOverflowVulnerability {

    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        
        System.out.print(""Enter a string: "");
        String userInput = scanner.nextLine();
        
        // Assume that the buffer size is fixed and set to 10 characters
        char[] buffer = new char[10];
        
        // Copy user input into the buffer without proper bounds checking
        for (int i = 0; i < userInput.length(); i++) {
            buffer[i] = userInput.charAt(i);
        }
        
        System.out.println(""Buffer overflow vulnerability exploited successfully!"");
    }
}","import java.util.Scanner; public class BufferOverflowVulnerability { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter a string: ""); String userInput = scanner.nextLine(); // Assume that the buffer size is fixed and set to 10 characters char[] buffer = new char[10]; // Copy user input into the buffer without proper bounds checking for (int i = 0; i < userInput.length(); i++) { buffer[i] = userInput.charAt(i); } System.out.println(""Buffer overflow vulnerability exploited successfully!""); } }",java,1
SQL Injection,"import java.sql.*;

public class VulnerableCode {
    public static void main(String[] args) {
        String userInput = ""'; DROP TABLE users; --""; // Malicious input for SQL Injection

        try {
            Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");
            Statement stmt = conn.createStatement();

            // Vulnerable code - concatenating user input directly into the SQL query
            String query = ""SELECT * FROM users WHERE username='"" + userInput + ""'"";
            ResultSet rs = stmt.executeQuery(query);

            while (rs.next()) {
                System.out.println(rs.getString(""username""));
            }

            conn.close();
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.*; public class VulnerableCode { public static void main(String[] args) { String userInput = ""'; DROP TABLE users; --""; // Malicious input for SQL Injection try { Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); Statement stmt = conn.createStatement(); // Vulnerable code - concatenating user input directly into the SQL query String query = ""SELECT * FROM users WHERE username='"" + userInput + ""'""; ResultSet rs = stmt.executeQuery(query); while (rs.next()) { System.out.println(rs.getString(""username"")); } conn.close(); } catch (SQLException e) { e.printStackTrace(); } } }",java,1
Clear,"const userData = JSON.parse(userInput); // Safe JSON parsing
if (userData && typeof userData === 'object') {
    processUserData(userData);
}
","const userData = JSON.parse(userInput); // Safe JSON parsing
if (userData && typeof userData === 'object') {
    processUserData(userData);
}
",javascript,0
Clear,"const shell = require('child_process');
const safeInput = userInput.replace(/[^a-zA-Z0-9.]/g, '');
shell.execFile('ping', [safeInput]); // Safe command execution
","const shell = require('child_process');
const safeInput = userInput.replace(/[^a-zA-Z0-9.]/g, '');
shell.execFile('ping', [safeInput]); // Safe command execution
",javascript,0
Clear,"import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class SecureCommandInjectionExample {

    public static void main(String[] args) throws IOException {
        BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));
        System.out.print(""Enter a website to ping: "");
        String website = reader.readLine();

        // Secure code: using ProcessBuilder to safely execute the command
        ProcessBuilder processBuilder = new ProcessBuilder(""ping"", ""-c"", ""3"", website);
        Process process = processBuilder.start();

        BufferedReader inputReader = new BufferedReader(new InputStreamReader(process.getInputStream()));

        String line;
        while ((line = inputReader.readLine()) != null) {
            System.out.println(line);
        }
    }
}","import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class SecureCommandInjectionExample { public static void main(String[] args) throws IOException { BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a website to ping: ""); String website = reader.readLine(); // Secure code: using ProcessBuilder to safely execute the command ProcessBuilder processBuilder = new ProcessBuilder(""ping"", ""-c"", ""3"", website); Process process = processBuilder.start(); BufferedReader inputReader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = inputReader.readLine()) != null) { System.out.println(line); } } }",java,0
Insecure Deserialization,"import yaml
def load_config(config_str):
    return yaml.load(config_str, Loader=yaml.Loader)","import yaml
def load_config(config_str):
    return yaml.load(config_str, Loader=yaml.Loader)",python,1
Path Traversal,"import java.io.File;
import java.io.IOException;
import java.nio.file.Files;
import java.nio.nio.file.Paths;

public class PathTraversalVulnerability {

    public static void main(String[] args) {
        String userInput = ""../confidential.txt"";
        String baseDir = ""/var/www/public/"";

        String fullPath = baseDir + userInput;

        File file = new File(fullPath);
        
        try {
            byte[] data = Files.readAllBytes(Paths.get(file.getPath()));
            System.out.println(new String(data));
        } catch (IOException e) {
            System.out.println(""Error reading file: "" + e.getMessage());
        }
    }
}","import java.io.File; import java.io.IOException; import java.nio.file.Files; import java.nio.nio.file.Paths; public class PathTraversalVulnerability { public static void main(String[] args) { String userInput = ""../confidential.txt""; String baseDir = ""/var/www/public/""; String fullPath = baseDir + userInput; File file = new File(fullPath); try { byte[] data = Files.readAllBytes(Paths.get(file.getPath())); System.out.println(new String(data)); } catch (IOException e) { System.out.println(""Error reading file: "" + e.getMessage()); } } }",java,1
Clear,"const token = process.env.API_TOKEN; // Environment variable
fetch('/api/data', {
    headers: { 'Authorization': `Bearer ${token}` }
});
","const token = process.env.API_TOKEN; // Environment variable
fetch('/api/data', {
    headers: { 'Authorization': `Bearer ${token}` }
});
",javascript,0
Clear,"#include <iostream>
#include <vector>
#include <stdexcept>

int safe_vector_access(const std::vector<int>& vec, size_t index) {
    if (index >= vec.size()) {
        throw std::out_of_range(""Index out of range"");
    }
    return vec[index];
}","#include <iostream>
#include <vector>
#include <stdexcept>

int safe_vector_access(const std::vector<int>& vec, size_t index) {
    if (index >= vec.size()) {
        throw std::out_of_range(""Index out of range"");
    }
    return vec[index];
}",cpp,0
Clear,"app.get('/user/:id', (req, res) => {
    const userId = parseInt(req.params.id);
    db.query('SELECT * FROM users WHERE id = ?', [userId], (err, result) => {
        res.json(result);
    });
});
","app.get('/user/:id', (req, res) => {
    const userId = parseInt(req.params.id);
    db.query('SELECT * FROM users WHERE id = ?', [userId], (err, result) => {
        res.json(result);
    });
});
",javascript,0
Clear,"To fix the insecure Java code snippet for Path Traversal, you need to ensure that the file path provided by the user is properly validated to prevent directory traversal attacks. Here's an improved version of the code with proper security measures:

```java
import java.io.File;
import java.io.FileInputStream;
import java.io.IOException;
import java.util.Scanner;

public class SecurePathTraversalExample {

    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);

        System.out.print(""Enter file path: "");
        String filePath = scanner.nextLine(); // Read the whole line to allow spaces

        if (isPathSafe(filePath)) {
            try {
                File file = new File(filePath);
                if (file.exists() && file.isFile()) {
                    FileInputStream fis = new FileInputStream(file);

                    int data;
                    while ((data = fis.read()) != -1) {
                        System.out.print((char) data);
                    }

                    fis.close();
                } else {
                    System.out.println(""Invalid file path."");
                }
            } catch (IOException e) {
                System.out.println(""Error reading file: "" + e.getMessage());
            }
        } else {
            System.out.println(""Invalid file path."");
        }
    }

    private","To fix the insecure Java code snippet for Path Traversal, you need to ensure that the file path provided by the user is properly validated to prevent directory traversal attacks. Here's an improved version of the code with proper security measures: ```java import java.io.File; import java.io.FileInputStream; import java.io.IOException; import java.util.Scanner; public class SecurePathTraversalExample { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter file path: ""); String filePath = scanner.nextLine(); // Read the whole line to allow spaces if (isPathSafe(filePath)) { try { File file = new File(filePath); if (file.exists() && file.isFile()) { FileInputStream fis = new FileInputStream(file); int data; while ((data = fis.read()) != -1) { System.out.print((char) data); } fis.close(); } else { System.out.println(""Invalid file path.""); } } catch (IOException e) { System.out.println(""Error reading file: "" + e.getMessage()); } } else { System.out.println(""Invalid file path.""); } } private",java,0
Clear,"const userInput = new URLSearchParams(window.location.search).get('input');
const safeOutput = document.createElement('div');
safeOutput.textContent = userInput; // Safe DOM manipulation
document.body.appendChild(safeOutput);
","const userInput = new URLSearchParams(window.location.search).get('input');
const safeOutput = document.createElement('div');
safeOutput.textContent = userInput; // Safe DOM manipulation
document.body.appendChild(safeOutput);
",javascript,0
Command Injection,"<?php
$cmd = $_GET['cmd'];
system($cmd); // Command Injection
?>","<?php
$cmd = $_GET['cmd'];
system($cmd); // Command Injection
?>",php,1
Cross-Site Scripting (XSS),"import java.io.*;

public class XSSVulnerableCode {
    public static void main(String[] args) {
        // Simulating user input
        String userInput = ""<script>alert('XSS Vulnerability!')</script>"";

        // Displaying the user input without proper handling
        System.out.println(""User input: "" + userInput);
    }
}","import java.io.*; public class XSSVulnerableCode { public static void main(String[] args) { // Simulating user input String userInput = ""<script>alert('XSS Vulnerability!')</script>""; // Displaying the user input without proper handling System.out.println(""User input: "" + userInput); } }",java,1
Clear,"#include <iostream>
#include <vector>
#include <stdexcept>

int safe_vector_access(const std::vector<int>& vec, size_t index) {
    if (index >= vec.size()) {
        throw std::out_of_range(""Index out of range"");
    }
    return vec[index];
}","#include <iostream>
#include <vector>
#include <stdexcept>

int safe_vector_access(const std::vector<int>& vec, size_t index) {
    if (index >= vec.size()) {
        throw std::out_of_range(""Index out of range"");
    }
    return vec[index];
}",cpp,0
Cross-Site Scripting (XSS),"import java.io.*;

public class XSSVulnerableCode {

    public static void main(String[] args) {
        // Simulating user input
        String userInput = ""<script>alert('XSS Vulnerability!')</script>"";

        // Improper handling of user input
        String output = ""<div>"" + userInput + ""</div>"";

        System.out.println(output);
    }
}","import java.io.*; public class XSSVulnerableCode { public static void main(String[] args) { // Simulating user input String userInput = ""<script>alert('XSS Vulnerability!')</script>""; // Improper handling of user input String output = ""<div>"" + userInput + ""</div>""; System.out.println(output); } }",java,1
Clear,"#include <stdio.h>
#include <stdlib.h>

void safe_file_operation(const char *filename) {
    FILE *file = fopen(filename, ""r"");
    if (file != NULL) {
        char buffer[256];
        while (fgets(buffer, sizeof(buffer), file)) {
            printf(""%s"", buffer);
        }
        fclose(file);
    }
}","#include <stdio.h>
#include <stdlib.h>

void safe_file_operation(const char *filename) {
    FILE *file = fopen(filename, ""r"");
    if (file != NULL) {
        char buffer[256];
        while (fgets(buffer, sizeof(buffer), file)) {
            printf(""%s"", buffer);
        }
        fclose(file);
    }
}",c,0
Clear,"import java.io.IOException;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import org.owasp.esapi.ESAPI;

public class SecureServlet extends HttpServlet {

    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws IOException {
        String userInput = request.getParameter(""input"");
        String safeInput = ESAPI.encoder().encodeForHTML(userInput);
        String output = ""<p>User input: "" + safeInput + ""</p>"";

        response.setContentType(""text/html"");
        response.getWriter().println(output);
    }
}","import java.io.IOException; import javax.servlet.http.HttpServlet; import javax.servlet.http.HttpServletRequest; import javax.servlet.http.HttpServletResponse; import org.owasp.esapi.ESAPI; public class SecureServlet extends HttpServlet { protected void doGet(HttpServletRequest request, HttpServletResponse response) throws IOException { String userInput = request.getParameter(""input""); String safeInput = ESAPI.encoder().encodeForHTML(userInput); String output = ""<p>User input: "" + safeInput + ""</p>""; response.setContentType(""text/html""); response.getWriter().println(output); } }",java,0
Clear,"<?php
$message = htmlspecialchars($_GET['message'], ENT_QUOTES, 'UTF-8');
echo $message; // Sanitized output
?>","<?php
$message = htmlspecialchars($_GET['message'], ENT_QUOTES, 'UTF-8');
echo $message; // Sanitized output
?>",php,0
Buffer Overflow,"#include <iostream>
#include <cstring>

void unsafe_c_string(char* input) {
    char buffer[100];
    strcpy(buffer, input); // potential buffer overflow
    std::cout << buffer << std::endl;
}","#include <iostream>
#include <cstring>

void unsafe_c_string(char* input) {
    char buffer[100];
    strcpy(buffer, input); // potential buffer overflow
    std::cout << buffer << std::endl;
}",cpp,1
Clear,"import org.owasp.esapi.ESAPI;
import org.owasp.esapi.codecs.HTMLEntityCodec;

import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class XSSFixedCode {
    public static void main(String[] args) {
        try {
            BufferedReader br = new BufferedReader(new InputStreamReader(System.in));
            System.out.print(""Enter your name: "");
            String input = br.readLine();

            // Sanitize and encode user input using ESAPI HTML entity encoding
            HTMLEntityCodec codec = new HTMLEntityCodec();
            String sanitizedInput = codec.encodeForHTML(input);

            System.out.println(""Hello, "" + sanitizedInput + ""! Welcome to our website."");
        } catch (IOException e) {
            System.err.println(""Error reading user input"");
        }
    }
}","import org.owasp.esapi.ESAPI; import org.owasp.esapi.codecs.HTMLEntityCodec; import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class XSSFixedCode { public static void main(String[] args) { try { BufferedReader br = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter your name: ""); String input = br.readLine(); // Sanitize and encode user input using ESAPI HTML entity encoding HTMLEntityCodec codec = new HTMLEntityCodec(); String sanitizedInput = codec.encodeForHTML(input); System.out.println(""Hello, "" + sanitizedInput + ""! Welcome to our website.""); } catch (IOException e) { System.err.println(""Error reading user input""); } } }",java,0
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Clear,"#include <stdio.h>
#include <stdlib.h>

int safe_string_to_int(const char *str) {
    char *endptr;
    long value = strtol(str, &endptr, 10);
    if (*endptr != '\0' || str == endptr) {
        return -1; // error
    }
    return (int)value;
}","#include <stdio.h>
#include <stdlib.h>

int safe_string_to_int(const char *str) {
    char *endptr;
    long value = strtol(str, &endptr, 10);
    if (*endptr != '\0' || str == endptr) {
        return -1; // error
    }
    return (int)value;
}",c,0
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Hardcoded Secrets,"localStorage.setItem('token', 'hardcoded-secret-token-123'); // Hardcoded secret
","localStorage.setItem('token', 'hardcoded-secret-token-123'); // Hardcoded secret
",javascript,1
Clear,"import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class CommandInjectionFixed {

    public static void main(String[] args) {
        try {
            BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));
            System.out.print(""Enter a command to execute: "");
            String command = reader.readLine();

            // Securely execute the command using ProcessBuilder
            ProcessBuilder processBuilder = new ProcessBuilder(""echo"", command);
            Process process = processBuilder.start();

            BufferedReader inputReader = new BufferedReader(new InputStreamReader(process.getInputStream()));

            String output;
            while ((output = inputReader.readLine()) != null) {
                System.out.println(output);
            }

        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}","import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class CommandInjectionFixed { public static void main(String[] args) { try { BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a command to execute: ""); String command = reader.readLine(); // Securely execute the command using ProcessBuilder ProcessBuilder processBuilder = new ProcessBuilder(""echo"", command); Process process = processBuilder.start(); BufferedReader inputReader = new BufferedReader(new InputStreamReader(process.getInputStream())); String output; while ((output = inputReader.readLine()) != null) { System.out.println(output); } } catch (IOException e) { e.printStackTrace(); } } }",java,0
Memory Corruption,"#include <iostream>

void unsafe_pointer_arithmetic(int* array, int size) {
    for (int i = 0; i <= size; i++) {
        std::cout << *(array + i) << std::endl; // potential out-of-bounds
    }
}","#include <iostream>

void unsafe_pointer_arithmetic(int* array, int size) {
    for (int i = 0; i <= size; i++) {
        std::cout << *(array + i) << std::endl; // potential out-of-bounds
    }
}",cpp,1
Clear,"import sqlite3
def get_user_data_safe(username):
    conn = sqlite3.connect('database.db')
    cursor = conn.cursor()
    query = ""SELECT * FROM users WHERE username = ?""
    cursor.execute(query, (username,))
    return cursor.fetchall()","import sqlite3
def get_user_data_safe(username):
    conn = sqlite3.connect('database.db')
    cursor = conn.cursor()
    query = ""SELECT * FROM users WHERE username = ?""
    cursor.execute(query, (username,))
    return cursor.fetchall()",python,0
Clear,"#include <stdio.h>
#include <string.h>

void safe_string_copy(char *dest, const char *src, size_t dest_size) {
    if (dest_size > 0) {
        strncpy(dest, src, dest_size - 1);
        dest[dest_size - 1] = '\0';
    }
}","#include <stdio.h>
#include <string.h>

void safe_string_copy(char *dest, const char *src, size_t dest_size) {
    if (dest_size > 0) {
        strncpy(dest, src, dest_size - 1);
        dest[dest_size - 1] = '\0';
    }
}",c,0
Clear,"#include <stdio.h>
#include <stdlib.h>

void safe_file_operation(const char *filename) {
    FILE *file = fopen(filename, ""r"");
    if (file != NULL) {
        char buffer[256];
        while (fgets(buffer, sizeof(buffer), file)) {
            printf(""%s"", buffer);
        }
        fclose(file);
    }
}","#include <stdio.h>
#include <stdlib.h>

void safe_file_operation(const char *filename) {
    FILE *file = fopen(filename, ""r"");
    if (file != NULL) {
        char buffer[256];
        while (fgets(buffer, sizeof(buffer), file)) {
            printf(""%s"", buffer);
        }
        fclose(file);
    }
}",c,0
Out-of-Bounds,"#include <iostream>

class UnsafeClass {
    int data[10];
public:
    int get_data(int index) {
        return data[index]; // no bounds checking
    }
};","#include <iostream>

class UnsafeClass {
    int data[10];
public:
    int get_data(int index) {
        return data[index]; // no bounds checking
    }
};",cpp,1
Buffer Overflow,"#include <iostream>
#include <cstdio>

void unsafe_c_input() {
    char buffer[50];
    scanf(""%s"", buffer); // no length limit
    std::cout << buffer << std::endl;
}","#include <iostream>
#include <cstdio>

void unsafe_c_input() {
    char buffer[50];
    scanf(""%s"", buffer); // no length limit
    std::cout << buffer << std::endl;
}",cpp,1
SQL Injection,"import java.sql.*;

public class SQLInjectionExample {

    public static void main(String[] args) {
        try {
            String userInput = ""admin'; DROP TABLE users; --"";

            // Assume this userInput is coming from user input
            String query = ""SELECT * FROM users WHERE username = '"" + userInput + ""'"";

            Connection connection = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");
            Statement statement = connection.createStatement();

            ResultSet resultSet = statement.executeQuery(query);

            while (resultSet.next()) {
                System.out.println(""User ID: "" + resultSet.getInt(""id"") + "", Username: "" + resultSet.getString(""username""));
            }

        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.*; public class SQLInjectionExample { public static void main(String[] args) { try { String userInput = ""admin'; DROP TABLE users; --""; // Assume this userInput is coming from user input String query = ""SELECT * FROM users WHERE username = '"" + userInput + ""'""; Connection connection = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); Statement statement = connection.createStatement(); ResultSet resultSet = statement.executeQuery(query); while (resultSet.next()) { System.out.println(""User ID: "" + resultSet.getInt(""id"") + "", Username: "" + resultSet.getString(""username"")); } } catch (SQLException e) { e.printStackTrace(); } } }",java,1
Buffer Overflow,"#include <iostream>
#include <cstring>

void unsafe_c_string(char* input) {
    char buffer[100];
    strcpy(buffer, input); // potential buffer overflow
    std::cout << buffer << std::endl;
}","#include <iostream>
#include <cstring>

void unsafe_c_string(char* input) {
    char buffer[100];
    strcpy(buffer, input); // potential buffer overflow
    std::cout << buffer << std::endl;
}",cpp,1
Clear,"#include <stdio.h>
#include <stdlib.h>

void safe_file_operation(const char *filename) {
    FILE *file = fopen(filename, ""r"");
    if (file != NULL) {
        char buffer[256];
        while (fgets(buffer, sizeof(buffer), file)) {
            printf(""%s"", buffer);
        }
        fclose(file);
    }
}","#include <stdio.h>
#include <stdlib.h>

void safe_file_operation(const char *filename) {
    FILE *file = fopen(filename, ""r"");
    if (file != NULL) {
        char buffer[256];
        while (fgets(buffer, sizeof(buffer), file)) {
            printf(""%s"", buffer);
        }
        fclose(file);
    }
}",c,0
Clear,"import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class CommandInjectionFixed {

    public static void main(String[] args) {
        try {
            BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));
            System.out.print(""Enter a command to execute: "");
            String command = reader.readLine();

            // Secure code - Use ProcessBuilder with proper arguments
            ProcessBuilder processBuilder = new ProcessBuilder(""ping"", command);
            Process process = processBuilder.start();

            BufferedReader inputStreamReader = new BufferedReader(new InputStreamReader(process.getInputStream()));
            String line;
            while ((line = inputStreamReader.readLine()) != null) {
                System.out.println(line);
            }
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}","import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class CommandInjectionFixed { public static void main(String[] args) { try { BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a command to execute: ""); String command = reader.readLine(); // Secure code - Use ProcessBuilder with proper arguments ProcessBuilder processBuilder = new ProcessBuilder(""ping"", command); Process process = processBuilder.start(); BufferedReader inputStreamReader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = inputStreamReader.readLine()) != null) { System.out.println(line); } } catch (IOException e) { e.printStackTrace(); } } }",java,0
Path Traversal,"import java.io.File;
import java.io.FileInputStream;
import java.io.IOException;

public class PathTraversalVulnerable {
    public static void main(String[] args) {
        String directory = ""/path/to/directory/"";
        String userInput = ""../../../../../etc/passwd"";
        String filePath = directory + userInput;

        try {
            File file = new File(filePath);
            FileInputStream fis = new FileInputStream(file);
            int data;
            while ((data = fis.read()) != -1) {
                System.out.print((char) data);
            }
            fis.close();
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}","import java.io.File; import java.io.FileInputStream; import java.io.IOException; public class PathTraversalVulnerable { public static void main(String[] args) { String directory = ""/path/to/directory/""; String userInput = ""../../../../../etc/passwd""; String filePath = directory + userInput; try { File file = new File(filePath); FileInputStream fis = new FileInputStream(file); int data; while ((data = fis.read()) != -1) { System.out.print((char) data); } fis.close(); } catch (IOException e) { e.printStackTrace(); } } }",java,1
SQL Injection,"import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.ResultSet;
import java.sql.Statement;

public class VulnerableCode {
    public static void main(String[] args) {
        String userInput = args[0]; // User input directly used in SQL query

        try {
            Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");
            Statement stmt = conn.createStatement();

            String query = ""SELECT * FROM users WHERE username = '"" + userInput + ""'"";
            ResultSet rs = stmt.executeQuery(query);

            while (rs.next()) {
                System.out.println(""User ID: "" + rs.getInt(""id"") + "", Username: "" + rs.getString(""username""));
            }

            rs.close();
            stmt.close();
            conn.close();
        } catch (Exception e) {
            e.printStackTrace();
        }
    }
}","import java.sql.Connection; import java.sql.DriverManager; import java.sql.ResultSet; import java.sql.Statement; public class VulnerableCode { public static void main(String[] args) { String userInput = args[0]; // User input directly used in SQL query try { Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); Statement stmt = conn.createStatement(); String query = ""SELECT * FROM users WHERE username = '"" + userInput + ""'""; ResultSet rs = stmt.executeQuery(query); while (rs.next()) { System.out.println(""User ID: "" + rs.getInt(""id"") + "", Username: "" + rs.getString(""username"")); } rs.close(); stmt.close(); conn.close(); } catch (Exception e) { e.printStackTrace(); } } }",java,1
Clear,"import mysql.connector
def safe_product_search(category):
    db = mysql.connector.connect(host=""localhost"", user=""user"", password=""pass"", database=""shop"")
    cursor = db.cursor()
    cursor.execute(""SELECT * FROM products WHERE category = %s"", (category,))
    return cursor.fetchall()","import mysql.connector
def safe_product_search(category):
    db = mysql.connector.connect(host=""localhost"", user=""user"", password=""pass"", database=""shop"")
    cursor = db.cursor()
    cursor.execute(""SELECT * FROM products WHERE category = %s"", (category,))
    return cursor.fetchall()",python,0
SQL Injection,"app.get('/user/:id', (req, res) => {
    const query = `SELECT * FROM users WHERE id = ${req.params.id}`; // SQL Injection
    db.query(query, (err, result) => {
        res.json(result);
    });
});
","app.get('/user/:id', (req, res) => {
    const query = `SELECT * FROM users WHERE id = ${req.params.id}`; // SQL Injection
    db.query(query, (err, result) => {
        res.json(result);
    });
});
",javascript,1
Hardcoded Secrets,"localStorage.setItem('token', 'hardcoded-secret-token-123'); // Hardcoded secret
","localStorage.setItem('token', 'hardcoded-secret-token-123'); // Hardcoded secret
",javascript,1
Clear,"#include <iostream>
#include <sstream>

int safe_string_to_int(const std::string& str) {
    std::stringstream ss(str);
    int value;
    if (ss >> value) {
        return value;
    }
    throw std::invalid_argument(""Invalid integer"");
}","#include <iostream>
#include <sstream>

int safe_string_to_int(const std::string& str) {
    std::stringstream ss(str);
    int value;
    if (ss >> value) {
        return value;
    }
    throw std::invalid_argument(""Invalid integer"");
}",cpp,0
Command Injection,"<?php
$cmd = $_GET['cmd'];
system($cmd); // Command Injection
?>","<?php
$cmd = $_GET['cmd'];
system($cmd); // Command Injection
?>",php,1
Command Injection,"import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class CommandInjectionExample {

    public static void main(String[] args) {
        try {
            BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));
            System.out.print(""Enter the IP address to ping: "");
            String ipAddress = reader.readLine();

            // Vulnerable code: directly concatenating user input into command
            String command = ""ping "" + ipAddress;
            Process process = Runtime.getRuntime().exec(command);

            BufferedReader inputReader = new BufferedReader(new InputStreamReader(process.getInputStream()));
            String line;
            while ((line = inputReader.readLine()) != null) {
                System.out.println(line);
            }

        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}","import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class CommandInjectionExample { public static void main(String[] args) { try { BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter the IP address to ping: ""); String ipAddress = reader.readLine(); // Vulnerable code: directly concatenating user input into command String command = ""ping "" + ipAddress; Process process = Runtime.getRuntime().exec(command); BufferedReader inputReader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = inputReader.readLine()) != null) { System.out.println(line); } } catch (IOException e) { e.printStackTrace(); } } }",java,1
Insecure Deserialization,"<?php
$data = $_POST['data'];
unserialize($data); // Insecure Deserialization
?>","<?php
$data = $_POST['data'];
unserialize($data); // Insecure Deserialization
?>",php,1
Clear,"#include <stdio.h>
#include <stdlib.h>

void safe_file_operation(const char *filename) {
    FILE *file = fopen(filename, ""r"");
    if (file != NULL) {
        char buffer[256];
        while (fgets(buffer, sizeof(buffer), file)) {
            printf(""%s"", buffer);
        }
        fclose(file);
    }
}","#include <stdio.h>
#include <stdlib.h>

void safe_file_operation(const char *filename) {
    FILE *file = fopen(filename, ""r"");
    if (file != NULL) {
        char buffer[256];
        while (fgets(buffer, sizeof(buffer), file)) {
            printf(""%s"", buffer);
        }
        fclose(file);
    }
}",c,0
Clear,"#include <stdio.h>
#include <string.h>

int safe_buffer_operation(char *input) {
    char buffer[100];
    if (strlen(input) < sizeof(buffer)) {
        strcpy(buffer, input);
        return 0;
    }
    return -1; // buffer too small
}","#include <stdio.h>
#include <string.h>

int safe_buffer_operation(char *input) {
    char buffer[100];
    if (strlen(input) < sizeof(buffer)) {
        strcpy(buffer, input);
        return 0;
    }
    return -1; // buffer too small
}",c,0
Clear,"#include <stdio.h>
#include <stdlib.h>

void safe_file_operation(const char *filename) {
    FILE *file = fopen(filename, ""r"");
    if (file != NULL) {
        char buffer[256];
        while (fgets(buffer, sizeof(buffer), file)) {
            printf(""%s"", buffer);
        }
        fclose(file);
    }
}","#include <stdio.h>
#include <stdlib.h>

void safe_file_operation(const char *filename) {
    FILE *file = fopen(filename, ""r"");
    if (file != NULL) {
        char buffer[256];
        while (fgets(buffer, sizeof(buffer), file)) {
            printf(""%s"", buffer);
        }
        fclose(file);
    }
}",c,0
SQL Injection,"import java.sql.*;

public class SQLInjectionExample {

    public static void main(String[] args) {
        String userInput = ""'; DROP TABLE users; --"";
        
        try {
            Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");
            Statement stmt = conn.createStatement();
            
            // Vulnerable code - user input directly concatenated into the SQL query
            String query = ""SELECT * FROM users WHERE username = '"" + userInput + ""'"";
            ResultSet rs = stmt.executeQuery(query);
            
            while (rs.next()) {
                System.out.println(""Username: "" + rs.getString(""username""));
            }
            
            conn.close();
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.*; public class SQLInjectionExample { public static void main(String[] args) { String userInput = ""'; DROP TABLE users; --""; try { Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); Statement stmt = conn.createStatement(); // Vulnerable code - user input directly concatenated into the SQL query String query = ""SELECT * FROM users WHERE username = '"" + userInput + ""'""; ResultSet rs = stmt.executeQuery(query); while (rs.next()) { System.out.println(""Username: "" + rs.getString(""username"")); } conn.close(); } catch (SQLException e) { e.printStackTrace(); } } }",java,1
Clear,"To fix the Command Injection vulnerability in the provided Java code snippet, you should not directly concatenate user input into the command string that is passed to `Runtime.exec()`. Instead, you should properly sanitize and validate user input to prevent malicious commands from being executed. One way to achieve this is by using a `ProcessBuilder` and providing the command and its arguments separately.

Here's an updated version of the code with proper security measures:

```java
import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class CommandInjectionSecure {
    public static void main(String[] args) throws IOException {
        BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));
        
        System.out.print(""Enter a command to execute: "");
        String command = reader.readLine();
        
        // Sanitize and validate user input before executing the command
        String[] commandArgs = { ""ping"", ""-c"", ""4"", command }; // Define the command and its arguments
        
        ProcessBuilder processBuilder = new ProcessBuilder(commandArgs);
        
        Process process = processBuilder.start();
        
        BufferedReader outputReader = new BufferedReader(new InputStreamReader(process.getInputStream()));
        String line;
        while ((line = outputReader.readLine()) != null) {
            System.out.println(line);","To fix the Command Injection vulnerability in the provided Java code snippet, you should not directly concatenate user input into the command string that is passed to `Runtime.exec()`. Instead, you should properly sanitize and validate user input to prevent malicious commands from being executed. One way to achieve this is by using a `ProcessBuilder` and providing the command and its arguments separately. Here's an updated version of the code with proper security measures: ```java import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class CommandInjectionSecure { public static void main(String[] args) throws IOException { BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a command to execute: ""); String command = reader.readLine(); // Sanitize and validate user input before executing the command String[] commandArgs = { ""ping"", ""-c"", ""4"", command }; // Define the command and its arguments ProcessBuilder processBuilder = new ProcessBuilder(commandArgs); Process process = processBuilder.start(); BufferedReader outputReader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = outputReader.readLine()) != null) { System.out.println(line);",java,0
Clear,"To fix the Command Injection vulnerability in the provided Java code snippet, you should avoid directly executing user input as a command and instead use proper sanitization and validation. Here is an improved version of the code that prevents Command Injection by using ProcessBuilder and validating user input:

```java
import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;
import java.util.ArrayList;
import java.util.List;

public class CommandInjectionSecure {

    public static void main(String[] args) {
        try {
            BufferedReader br = new BufferedReader(new InputStreamReader(System.in));
            System.out.print(""Enter a command to execute: "");
            String userInput = br.readLine();

            // Validate user input to prevent command injection
            if (!isValidInput(userInput)) {
                System.out.println(""Invalid input. Please try again."");
                return;
            }

            List<String> command = new ArrayList<>();
            command.add(""ls"");
            command.add(userInput);

            // Execute the command using ProcessBuilder
            ProcessBuilder processBuilder = new ProcessBuilder(command);
            Process process = processBuilder.start();

            BufferedReader reader = new BufferedReader(new InputStreamReader(process.getInputStream()));
            String line;
            while ((line = reader.readLine()) != null) {
                System.out.println(line);
            }","To fix the Command Injection vulnerability in the provided Java code snippet, you should avoid directly executing user input as a command and instead use proper sanitization and validation. Here is an improved version of the code that prevents Command Injection by using ProcessBuilder and validating user input: ```java import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; import java.util.ArrayList; import java.util.List; public class CommandInjectionSecure { public static void main(String[] args) { try { BufferedReader br = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a command to execute: ""); String userInput = br.readLine(); // Validate user input to prevent command injection if (!isValidInput(userInput)) { System.out.println(""Invalid input. Please try again.""); return; } List<String> command = new ArrayList<>(); command.add(""ls""); command.add(userInput); // Execute the command using ProcessBuilder ProcessBuilder processBuilder = new ProcessBuilder(command); Process process = processBuilder.start(); BufferedReader reader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = reader.readLine()) != null) { System.out.println(line); }",java,0
Command Injection,"import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class CommandInjectionExample {
    public static void main(String[] args) {
        try {
            BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));
            System.out.print(""Enter the name of the file to display: "");
            String fileName = reader.readLine();

            // Vulnerable code - user input is directly passed to the command
            String command = ""cat "" + fileName;
            
            Process process = Runtime.getRuntime().exec(command);
            BufferedReader processOutput = new BufferedReader(new InputStreamReader(process.getInputStream()));

            String line;
            while ((line = processOutput.readLine()) != null) {
                System.out.println(line);
            }

        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}","import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class CommandInjectionExample { public static void main(String[] args) { try { BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter the name of the file to display: ""); String fileName = reader.readLine(); // Vulnerable code - user input is directly passed to the command String command = ""cat "" + fileName; Process process = Runtime.getRuntime().exec(command); BufferedReader processOutput = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = processOutput.readLine()) != null) { System.out.println(line); } } catch (IOException e) { e.printStackTrace(); } } }",java,1
Clear,"import requests
def safe_api_call():
    api_key = os.environ.get('API_KEY')
    headers = {'Authorization': f'Bearer {api_key}'}
    return requests.get('https://api.example.com/data', headers=headers)","import requests
def safe_api_call():
    api_key = os.environ.get('API_KEY')
    headers = {'Authorization': f'Bearer {api_key}'}
    return requests.get('https://api.example.com/data', headers=headers)",python,0
Clear,"#include <iostream>
#include <vector>
#include <stdexcept>

int safe_vector_access(const std::vector<int>& vec, size_t index) {
    if (index >= vec.size()) {
        throw std::out_of_range(""Index out of range"");
    }
    return vec[index];
}","#include <iostream>
#include <vector>
#include <stdexcept>

int safe_vector_access(const std::vector<int>& vec, size_t index) {
    if (index >= vec.size()) {
        throw std::out_of_range(""Index out of range"");
    }
    return vec[index];
}",cpp,0
Path Traversal,"import java.io.BufferedReader;
import java.io.File;
import java.io.FileReader;
import java.io.IOException;
import java.util.Scanner;

public class PathTraversalVulnerable {
    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        System.out.print(""Enter file name: "");
        String fileName = scanner.nextLine();

        File file = new File(fileName);

        try (BufferedReader br = new BufferedReader(new FileReader(file))) {
            String line;
            while ((line = br.readLine()) != null) {
                System.out.println(line);
            }
        } catch (IOException e) {
            System.err.println(""Error reading file: "" + e.getMessage());
        }
    }
}","import java.io.BufferedReader; import java.io.File; import java.io.FileReader; import java.io.IOException; import java.util.Scanner; public class PathTraversalVulnerable { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter file name: ""); String fileName = scanner.nextLine(); File file = new File(fileName); try (BufferedReader br = new BufferedReader(new FileReader(file))) { String line; while ((line = br.readLine()) != null) { System.out.println(line); } } catch (IOException e) { System.err.println(""Error reading file: "" + e.getMessage()); } } }",java,1
Insecure Deserialization,"<?php
$data = $_POST['data'];
unserialize($data); // Insecure Deserialization
?>","<?php
$data = $_POST['data'];
unserialize($data); // Insecure Deserialization
?>",php,1
Command Injection,"<?php
$cmd = $_GET['cmd'];
system($cmd); // Command Injection
?>","<?php
$cmd = $_GET['cmd'];
system($cmd); // Command Injection
?>",php,1
Clear,"#include <iostream>
#include <sstream>

int safe_string_to_int(const std::string& str) {
    std::stringstream ss(str);
    int value;
    if (ss >> value) {
        return value;
    }
    throw std::invalid_argument(""Invalid integer"");
}","#include <iostream>
#include <sstream>

int safe_string_to_int(const std::string& str) {
    std::stringstream ss(str);
    int value;
    if (ss >> value) {
        return value;
    }
    throw std::invalid_argument(""Invalid integer"");
}",cpp,0
Clear,"To fix the SQL Injection vulnerability in the provided Java code snippet, you need to use parameterized queries instead of concatenating user input directly into the SQL query. Parameterized queries help prevent SQL Injection attacks by separating the SQL query logic from the user input data.

Here's an updated version of the code snippet with a parameterized query:

```java
import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.util.Scanner;

public class SecureSQLQuery {

    public static void main(String[] args) {
        try {
            Scanner scanner = new Scanner(System.in);
            System.out.print(""Enter a username to search for: "");
            String inputUsername = scanner.nextLine();

            String url = ""jdbc:mysql://localhost:3306/mydatabase"";
            String username = ""root"";
            String password = ""password"";

            Connection conn = DriverManager.getConnection(url, username, password);

            // Use a PreparedStatement with parameterized query
            String query = ""SELECT * FROM users WHERE username=?"";
            PreparedStatement pstmt = conn.prepareStatement(query);
            pstmt.setString(1, inputUsername);

            ResultSet rs = pstmt.executeQuery();

            while (rs.next()) {
                System.out.println(""User ID: "" + rs.getInt","To fix the SQL Injection vulnerability in the provided Java code snippet, you need to use parameterized queries instead of concatenating user input directly into the SQL query. Parameterized queries help prevent SQL Injection attacks by separating the SQL query logic from the user input data. Here's an updated version of the code snippet with a parameterized query: ```java import java.sql.Connection; import java.sql.DriverManager; import java.sql.PreparedStatement; import java.sql.ResultSet; import java.util.Scanner; public class SecureSQLQuery { public static void main(String[] args) { try { Scanner scanner = new Scanner(System.in); System.out.print(""Enter a username to search for: ""); String inputUsername = scanner.nextLine(); String url = ""jdbc:mysql://localhost:3306/mydatabase""; String username = ""root""; String password = ""password""; Connection conn = DriverManager.getConnection(url, username, password); // Use a PreparedStatement with parameterized query String query = ""SELECT * FROM users WHERE username=?""; PreparedStatement pstmt = conn.prepareStatement(query); pstmt.setString(1, inputUsername); ResultSet rs = pstmt.executeQuery(); while (rs.next()) { System.out.println(""User ID: "" + rs.getInt",java,0
File Inclusion,"<?php
$file = $_GET['file'];
include($file); // File Inclusion
?>","<?php
$file = $_GET['file'];
include($file); // File Inclusion
?>",php,1
Command Injection,"const shell = require('child_process');
shell.exec('ping ' + userInput); // Command Injection
","const shell = require('child_process');
shell.exec('ping ' + userInput); // Command Injection
",javascript,1
XSS,"<?php
echo $_GET['message']; // XSS
?>","<?php
echo $_GET['message']; // XSS
?>",php,1
Clear,"const userData = JSON.parse(userInput); // Safe JSON parsing
if (userData && typeof userData === 'object') {
    processUserData(userData);
}
","const userData = JSON.parse(userInput); // Safe JSON parsing
if (userData && typeof userData === 'object') {
    processUserData(userData);
}
",javascript,0
Insecure Deserialization,"import yaml
def load_config(config_str):
    return yaml.load(config_str, Loader=yaml.Loader)","import yaml
def load_config(config_str):
    return yaml.load(config_str, Loader=yaml.Loader)",python,1
Command Injection,"import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class CommandInjectionVulnerability {

    public static void main(String[] args) {
        try {
            BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));
            System.out.print(""Enter a command to execute: "");
            String command = reader.readLine();

            // This is where the vulnerability lies
            Process process = Runtime.getRuntime().exec(""ping "" + command);

            BufferedReader inputStreamReader = new BufferedReader(new InputStreamReader(process.getInputStream()));
            String line;
            while ((line = inputStreamReader.readLine()) != null) {
                System.out.println(line);
            }
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}","import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class CommandInjectionVulnerability { public static void main(String[] args) { try { BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a command to execute: ""); String command = reader.readLine(); // This is where the vulnerability lies Process process = Runtime.getRuntime().exec(""ping "" + command); BufferedReader inputStreamReader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = inputStreamReader.readLine()) != null) { System.out.println(line); } } catch (IOException e) { e.printStackTrace(); } } }",java,1
Buffer Overflow,"#include <iostream>
#include <cstring>

void unsafe_c_string(char* input) {
    char buffer[100];
    strcpy(buffer, input); // potential buffer overflow
    std::cout << buffer << std::endl;
}","#include <iostream>
#include <cstring>

void unsafe_c_string(char* input) {
    char buffer[100];
    strcpy(buffer, input); // potential buffer overflow
    std::cout << buffer << std::endl;
}",cpp,1
SQL Injection,"import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.ResultSet;
import java.sql.Statement;
import java.util.Scanner;

public class SQLInjectionVulnerable {

    public static void main(String[] args) {
        try {
            // Establishing a connection to a SQLite database
            Connection conn = DriverManager.getConnection(""jdbc:sqlite:test.db"");
            
            // Taking user input for username
            Scanner scanner = new Scanner(System.in);
            System.out.println(""Enter username:"");
            String username = scanner.nextLine();
            
            // Constructing the SQL query with user input directly concatenated into the query
            String query = ""SELECT * FROM users WHERE username='"" + username + ""'"";
            
            Statement statement = conn.createStatement();
            ResultSet resultSet = statement.executeQuery(query);
            
            while(resultSet.next()) {
                System.out.println(""User found: "" + resultSet.getString(""username""));
            }
            
            conn.close();
        } catch (Exception e) {
            e.printStackTrace();
        }
    }
}","import java.sql.Connection; import java.sql.DriverManager; import java.sql.ResultSet; import java.sql.Statement; import java.util.Scanner; public class SQLInjectionVulnerable { public static void main(String[] args) { try { // Establishing a connection to a SQLite database Connection conn = DriverManager.getConnection(""jdbc:sqlite:test.db""); // Taking user input for username Scanner scanner = new Scanner(System.in); System.out.println(""Enter username:""); String username = scanner.nextLine(); // Constructing the SQL query with user input directly concatenated into the query String query = ""SELECT * FROM users WHERE username='"" + username + ""'""; Statement statement = conn.createStatement(); ResultSet resultSet = statement.executeQuery(query); while(resultSet.next()) { System.out.println(""User found: "" + resultSet.getString(""username"")); } conn.close(); } catch (Exception e) { e.printStackTrace(); } } }",java,1
Clear,"To fix the Path Traversal vulnerability in the provided Java code, you should validate the input file name to prevent directory traversal attacks. Here is an updated version of the code that includes proper security measures:

```java
import java.io.File;
import java.io.FileInputStream;
import java.io.IOException;
import java.util.Scanner;

public class SecurePathTraversal {

    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        System.out.print(""Enter file name: "");
        String fileName = scanner.nextLine();

        // Validate input file name to prevent directory traversal
        if (!isValidFileName(fileName)) {
            System.out.println(""Invalid file name"");
            return;
        }

        try {
            File file = new File(""/path/to/files/"" + fileName);
            if (!file.exists() || !file.isFile()) {
                System.out.println(""File not found or invalid"");
                return;
            }
            
            FileInputStream fis = new FileInputStream(file);
            int data;
            while ((data = fis.read()) != -1) {
                System.out.print((char) data);
            }
            fis.close();
        } catch (IOException e) {
            System.out.println(""Error reading file: "" + e.getMessage());
        }
    }","To fix the Path Traversal vulnerability in the provided Java code, you should validate the input file name to prevent directory traversal attacks. Here is an updated version of the code that includes proper security measures: ```java import java.io.File; import java.io.FileInputStream; import java.io.IOException; import java.util.Scanner; public class SecurePathTraversal { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter file name: ""); String fileName = scanner.nextLine(); // Validate input file name to prevent directory traversal if (!isValidFileName(fileName)) { System.out.println(""Invalid file name""); return; } try { File file = new File(""/path/to/files/"" + fileName); if (!file.exists() || !file.isFile()) { System.out.println(""File not found or invalid""); return; } FileInputStream fis = new FileInputStream(file); int data; while ((data = fis.read()) != -1) { System.out.print((char) data); } fis.close(); } catch (IOException e) { System.out.println(""Error reading file: "" + e.getMessage()); } }",java,0
Clear,"To make this code snippet more secure, you can implement the following security measures to prevent Insecure Deserialization vulnerabilities:

1. Implement input validation: Validate the deserialized object to ensure it is of an expected type or class before using it. This can help prevent malicious objects from being deserialized and executed.

2. Use a safe deserialization library: Consider using a safe deserialization library such as Google's GSON or Jackson that provides additional security features to prevent common vulnerabilities associated with Java Object Serialization.

3. Enable ClassLoader restrictions: Limit the classes that can be loaded during deserialization by setting a custom ClassLoader with restricted permissions. This can help mitigate the risk of executing malicious code embedded in serialized objects.

4. Implement data integrity checks: Use cryptographic signatures or checksums to verify the integrity of serialized data before deserializing it. This can help detect tampering or unauthorized modifications to the serialized data.

5. Avoid using ObjectInputStream for untrusted input: If possible, avoid deserializing untrusted input altogether. If deserialization is necessary, consider using safer alternatives such as JSON or XML serialization formats instead of Java Object Serialization.

Here's an updated version of your code snippet with some of these security measures implemented:

```java
import java","To make this code snippet more secure, you can implement the following security measures to prevent Insecure Deserialization vulnerabilities: 1. Implement input validation: Validate the deserialized object to ensure it is of an expected type or class before using it. This can help prevent malicious objects from being deserialized and executed. 2. Use a safe deserialization library: Consider using a safe deserialization library such as Google's GSON or Jackson that provides additional security features to prevent common vulnerabilities associated with Java Object Serialization. 3. Enable ClassLoader restrictions: Limit the classes that can be loaded during deserialization by setting a custom ClassLoader with restricted permissions. This can help mitigate the risk of executing malicious code embedded in serialized objects. 4. Implement data integrity checks: Use cryptographic signatures or checksums to verify the integrity of serialized data before deserializing it. This can help detect tampering or unauthorized modifications to the serialized data. 5. Avoid using ObjectInputStream for untrusted input: If possible, avoid deserializing untrusted input altogether. If deserialization is necessary, consider using safer alternatives such as JSON or XML serialization formats instead of Java Object Serialization. Here's an updated version of your code snippet with some of these security measures implemented: ```java import java",python,0
Command Injection,"import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class CommandInjectionVulnerable {
    public static void main(String[] args) throws IOException {
        BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));
        
        System.out.print(""Enter a website to ping: "");
        String website = reader.readLine();
        
        // Vulnerable code - User input is directly concatenated into the command string
        String command = ""ping "" + website;
        
        Process process = Runtime.getRuntime().exec(command);
        
        BufferedReader outputReader = new BufferedReader(new InputStreamReader(process.getInputStream()));
        
        String outputLine;
        while ((outputLine = outputReader.readLine()) != null) {
            System.out.println(outputLine);
        }
    }
}","import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class CommandInjectionVulnerable { public static void main(String[] args) throws IOException { BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a website to ping: ""); String website = reader.readLine(); // Vulnerable code - User input is directly concatenated into the command string String command = ""ping "" + website; Process process = Runtime.getRuntime().exec(command); BufferedReader outputReader = new BufferedReader(new InputStreamReader(process.getInputStream())); String outputLine; while ((outputLine = outputReader.readLine()) != null) { System.out.println(outputLine); } } }",java,1
Clear,"#include <stdio.h>
#include <string.h>

int safe_buffer_operation(char *input) {
    char buffer[100];
    if (strlen(input) < sizeof(buffer)) {
        strcpy(buffer, input);
        return 0;
    }
    return -1; // buffer too small
}","#include <stdio.h>
#include <string.h>

int safe_buffer_operation(char *input) {
    char buffer[100];
    if (strlen(input) < sizeof(buffer)) {
        strcpy(buffer, input);
        return 0;
    }
    return -1; // buffer too small
}",c,0
Clear,"To fix the Path Traversal vulnerability in the provided Java code snippet, you should ensure that the user-supplied input for the file name does not allow directory traversal. One way to achieve this is by validating and sanitizing the input before constructing the file path.

Here's an improved version of the code with security measures implemented:

```java
import java.io.File;
import java.io.FileInputStream;
import java.io.IOException;
import java.util.Scanner;

public class SecurePathTraversal {

    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        System.out.print(""Enter file name: "");
        String fileName = scanner.next();

        // Validate and sanitize the file name input to prevent directory traversal
        if (!isValidFileName(fileName)) {
            System.out.println(""Invalid file name."");
            return;
        }

        try {
            File file = new File(""/path/to/files/"" + fileName);
            FileInputStream fis = new FileInputStream(file);
            int data;
            while ((data = fis.read()) != -1) {
                System.out.print((char) data);
            }
            fis.close();
        } catch (IOException e) {
            System.out.println(""Error reading file: "" + e.getMessage());
        }
    }","To fix the Path Traversal vulnerability in the provided Java code snippet, you should ensure that the user-supplied input for the file name does not allow directory traversal. One way to achieve this is by validating and sanitizing the input before constructing the file path. Here's an improved version of the code with security measures implemented: ```java import java.io.File; import java.io.FileInputStream; import java.io.IOException; import java.util.Scanner; public class SecurePathTraversal { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter file name: ""); String fileName = scanner.next(); // Validate and sanitize the file name input to prevent directory traversal if (!isValidFileName(fileName)) { System.out.println(""Invalid file name.""); return; } try { File file = new File(""/path/to/files/"" + fileName); FileInputStream fis = new FileInputStream(file); int data; while ((data = fis.read()) != -1) { System.out.print((char) data); } fis.close(); } catch (IOException e) { System.out.println(""Error reading file: "" + e.getMessage()); } }",java,0
Clear,"import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class SecureCommandExecutionDemo {

    public static void main(String[] args) throws IOException {
        BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));

        System.out.print(""Enter a directory name: "");
        String directoryName = reader.readLine();

        // Secure code: use ProcessBuilder to set the command and arguments
        ProcessBuilder processBuilder = new ProcessBuilder();
        processBuilder.command(""ls"", directoryName);

        Process process = processBuilder.start();

        BufferedReader processOutputReader = new BufferedReader(new InputStreamReader(process.getInputStream()));
        String line;

        while ((line = processOutputReader.readLine()) != null) {
            System.out.println(line);
        }
    }
}","import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class SecureCommandExecutionDemo { public static void main(String[] args) throws IOException { BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a directory name: ""); String directoryName = reader.readLine(); // Secure code: use ProcessBuilder to set the command and arguments ProcessBuilder processBuilder = new ProcessBuilder(); processBuilder.command(""ls"", directoryName); Process process = processBuilder.start(); BufferedReader processOutputReader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = processOutputReader.readLine()) != null) { System.out.println(line); } } }",java,0
Cross-Site Scripting (XSS),"import java.io.*;

public class XSSVulnerableCode {
    public static void main(String[] args) {
        // Simulating user input from an untrusted source
        String userInput = ""<script>alert('XSS Vulnerability!')</script>"";
        
        // Improperly handling user input by directly outputting it to the webpage
        System.out.println(""<div>"" + userInput + ""</div>"");
    }
}","import java.io.*; public class XSSVulnerableCode { public static void main(String[] args) { // Simulating user input from an untrusted source String userInput = ""<script>alert('XSS Vulnerability!')</script>""; // Improperly handling user input by directly outputting it to the webpage System.out.println(""<div>"" + userInput + ""</div>""); } }",java,1
Cross-Site Scripting (XSS),"import java.io.*;
import javax.servlet.*;
import javax.servlet.http.*;

public class XSSVulnerableServlet extends HttpServlet {
    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        String userInput = request.getParameter(""input"");
        PrintWriter out = response.getWriter();
        
        out.println(""<html>"");
        out.println(""<body>"");
        out.println(""<h1>Welcome to our website!</h1>"");
        out.println(""<p>Your input: "" + userInput + ""</p>""); // Vulnerable code - directly outputting user input without proper sanitization
        out.println(""</body>"");
        out.println(""</html>"");
    }
}","import java.io.*; import javax.servlet.*; import javax.servlet.http.*; public class XSSVulnerableServlet extends HttpServlet { protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { String userInput = request.getParameter(""input""); PrintWriter out = response.getWriter(); out.println(""<html>""); out.println(""<body>""); out.println(""<h1>Welcome to our website!</h1>""); out.println(""<p>Your input: "" + userInput + ""</p>""); // Vulnerable code - directly outputting user input without proper sanitization out.println(""</body>""); out.println(""</html>""); } }",java,1
SQL Injection,"import psycopg2
def admin_login(admin_id):
    conn = psycopg2.connect(""dbname=test user=postgres"")
    cur = conn.cursor()
    cur.execute(f""SELECT * FROM admins WHERE id = {admin_id}"")
    return cur.fetchone()","import psycopg2
def admin_login(admin_id):
    conn = psycopg2.connect(""dbname=test user=postgres"")
    cur = conn.cursor()
    cur.execute(f""SELECT * FROM admins WHERE id = {admin_id}"")
    return cur.fetchone()",python,1
Buffer Overflow,"#include <iostream>
#include <cstdio>

void unsafe_c_input() {
    char buffer[50];
    scanf(""%s"", buffer); // no length limit
    std::cout << buffer << std::endl;
}","#include <iostream>
#include <cstdio>

void unsafe_c_input() {
    char buffer[50];
    scanf(""%s"", buffer); // no length limit
    std::cout << buffer << std::endl;
}",cpp,1
Clear,"The code snippet you provided is vulnerable to Insecure Deserialization, a common security issue where an attacker can manipulate serialized data to execute malicious code when deserialized. To fix this vulnerability, you can implement proper security measures such as input validation, using a safe deserialization library, and sandboxing the deserialization process.

Here are some general guidelines for secure deserialization in Java:

1. Input Validation: Always validate and sanitize any input data before deserializing it. Ensure that the serialized data comes from a trusted source and has not been tampered with.

2. Use Safe Deserialization Libraries: Avoid using standard Java serialization for untrusted data. Consider using safer alternatives like JSON or XML serialization libraries that provide better control over the deserialization process.

3. Implement Serialization Filters: Use serialization filters or custom serializers/deserializers to restrict which classes can be deserialized and prevent the execution of arbitrary code.

4. Enable Security Manager: Configure a Security Manager with appropriate permissions to restrict the actions that can be performed during deserialization, such as accessing files or network resources.

5. Monitor and Log Deserialization Activities: Implement logging and monitoring mechanisms to track deserialization activities and detect any suspicious behavior or anomalies.

Here is an example of how you can modify","The code snippet you provided is vulnerable to Insecure Deserialization, a common security issue where an attacker can manipulate serialized data to execute malicious code when deserialized. To fix this vulnerability, you can implement proper security measures such as input validation, using a safe deserialization library, and sandboxing the deserialization process. Here are some general guidelines for secure deserialization in Java: 1. Input Validation: Always validate and sanitize any input data before deserializing it. Ensure that the serialized data comes from a trusted source and has not been tampered with. 2. Use Safe Deserialization Libraries: Avoid using standard Java serialization for untrusted data. Consider using safer alternatives like JSON or XML serialization libraries that provide better control over the deserialization process. 3. Implement Serialization Filters: Use serialization filters or custom serializers/deserializers to restrict which classes can be deserialized and prevent the execution of arbitrary code. 4. Enable Security Manager: Configure a Security Manager with appropriate permissions to restrict the actions that can be performed during deserialization, such as accessing files or network resources. 5. Monitor and Log Deserialization Activities: Implement logging and monitoring mechanisms to track deserialization activities and detect any suspicious behavior or anomalies. Here is an example of how you can modify",php,0
Clear,"#include <iostream>
#include <string>
#include <vector>

void safe_string_handling(const std::string& input) {
    std::string safe_copy = input;
    std::cout << safe_copy << std::endl;
}","#include <iostream>
#include <string>
#include <vector>

void safe_string_handling(const std::string& input) {
    std::string safe_copy = input;
    std::cout << safe_copy << std::endl;
}",cpp,0
Clear,"import java.sql.*;

public class SecureCode {
    public static void main(String[] args) {
        String userInput = ""'; DROP TABLE users; --"";

        try {
            Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");
            
            // Use PreparedStatement with parameterized query
            String query = ""SELECT * FROM users WHERE username = ?"";
            PreparedStatement pstmt = conn.prepareStatement(query);
            pstmt.setString(1, userInput);
            
            ResultSet rs = pstmt.executeQuery();

            while (rs.next()) {
                System.out.println(rs.getString(""username""));
            }

            conn.close();
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.*; public class SecureCode { public static void main(String[] args) { String userInput = ""'; DROP TABLE users; --""; try { Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); // Use PreparedStatement with parameterized query String query = ""SELECT * FROM users WHERE username = ?""; PreparedStatement pstmt = conn.prepareStatement(query); pstmt.setString(1, userInput); ResultSet rs = pstmt.executeQuery(); while (rs.next()) { System.out.println(rs.getString(""username"")); } conn.close(); } catch (SQLException e) { e.printStackTrace(); } } }",java,0
Clear,"import java.util.Scanner;
import java.util.Arrays;

public class SecureBufferExample {
    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        
        System.out.print(""Enter your name: "");
        String input = scanner.nextLine(); // Use nextLine() to read the entire line
        
        char[] buffer = new char[10];
        
        if (input.length() <= buffer.length) {
            input.getChars(0, input.length(), buffer, 0);
        } else {
            buffer = Arrays.copyOf(input.toCharArray(), buffer.length); // Safely copy input to buffer
        }
        
        System.out.println(""Hello, "" + new String(buffer));
    }
}","import java.util.Scanner; import java.util.Arrays; public class SecureBufferExample { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter your name: ""); String input = scanner.nextLine(); // Use nextLine() to read the entire line char[] buffer = new char[10]; if (input.length() <= buffer.length) { input.getChars(0, input.length(), buffer, 0); } else { buffer = Arrays.copyOf(input.toCharArray(), buffer.length); // Safely copy input to buffer } System.out.println(""Hello, "" + new String(buffer)); } }",java,0
Command Injection,"import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class CommandInjectionVulnerability {

    public static void main(String[] args) {
        try {
            // Taking user input for a command to execute
            BufferedReader br = new BufferedReader(new InputStreamReader(System.in));
            System.out.print(""Enter the command to execute: "");
            String command = br.readLine();

            // Executing the user input as a command using Runtime.getRuntime().exec()
            Process process = Runtime.getRuntime().exec(command);

            // Reading and printing the output of the executed command
            BufferedReader reader = new BufferedReader(new InputStreamReader(process.getInputStream()));
            String line;
            while ((line = reader.readLine()) != null) {
                System.out.println(line);
            }

        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}","import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class CommandInjectionVulnerability { public static void main(String[] args) { try { // Taking user input for a command to execute BufferedReader br = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter the command to execute: ""); String command = br.readLine(); // Executing the user input as a command using Runtime.getRuntime().exec() Process process = Runtime.getRuntime().exec(command); // Reading and printing the output of the executed command BufferedReader reader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = reader.readLine()) != null) { System.out.println(line); } } catch (IOException e) { e.printStackTrace(); } } }",java,1
Clear,"import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class CommandInjectionFixed {

    public static void main(String[] args) throws IOException {
        BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));
        
        System.out.print(""Enter a hostname to ping: "");
        String hostname = reader.readLine();
        
        // Secure command execution using ProcessBuilder
        ProcessBuilder processBuilder = new ProcessBuilder(""ping"", hostname);
        
        Process process = processBuilder.start();
        
        BufferedReader outputReader = new BufferedReader(new InputStreamReader(process.getInputStream()));
        String line;
        while ((line = outputReader.readLine()) != null) {
            System.out.println(line);
        }
        
    }
}","import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class CommandInjectionFixed { public static void main(String[] args) throws IOException { BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a hostname to ping: ""); String hostname = reader.readLine(); // Secure command execution using ProcessBuilder ProcessBuilder processBuilder = new ProcessBuilder(""ping"", hostname); Process process = processBuilder.start(); BufferedReader outputReader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = outputReader.readLine()) != null) { System.out.println(line); } } }",java,0
Clear,"#include <stdio.h>
#include <stdlib.h>

void safe_file_operation(const char *filename) {
    FILE *file = fopen(filename, ""r"");
    if (file != NULL) {
        char buffer[256];
        while (fgets(buffer, sizeof(buffer), file)) {
            printf(""%s"", buffer);
        }
        fclose(file);
    }
}","#include <stdio.h>
#include <stdlib.h>

void safe_file_operation(const char *filename) {
    FILE *file = fopen(filename, ""r"");
    if (file != NULL) {
        char buffer[256];
        while (fgets(buffer, sizeof(buffer), file)) {
            printf(""%s"", buffer);
        }
        fclose(file);
    }
}",c,0
Clear,"const token = process.env.API_TOKEN; // Environment variable
fetch('/api/data', {
    headers: { 'Authorization': `Bearer ${token}` }
});
","const token = process.env.API_TOKEN; // Environment variable
fetch('/api/data', {
    headers: { 'Authorization': `Bearer ${token}` }
});
",javascript,0
Command Injection,"import os
def ping_host(host):
    os.system(""ping -c 4 "" + host)","import os
def ping_host(host):
    os.system(""ping -c 4 "" + host)",python,1
SQL Injection,"import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Statement;

public class SQLInjectionVulnerableCode {

    public static void main(String[] args) {
        String userInput = ""admin'; --"";
        String query = ""SELECT * FROM users WHERE username = '"" + userInput + ""'"";
        
        try {
            Connection connection = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");
            Statement statement = connection.createStatement();
            ResultSet resultSet = statement.executeQuery(query);
            
            while (resultSet.next()) {
                System.out.println(resultSet.getString(""username""));
            }
            
            connection.close();
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.Connection; import java.sql.DriverManager; import java.sql.ResultSet; import java.sql.SQLException; import java.sql.Statement; public class SQLInjectionVulnerableCode { public static void main(String[] args) { String userInput = ""admin'; --""; String query = ""SELECT * FROM users WHERE username = '"" + userInput + ""'""; try { Connection connection = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); Statement statement = connection.createStatement(); ResultSet resultSet = statement.executeQuery(query); while (resultSet.next()) { System.out.println(resultSet.getString(""username"")); } connection.close(); } catch (SQLException e) { e.printStackTrace(); } } }",java,1
Path Traversal,"def get_user_file(username, filepath):
    import os
    base_path = f""/home/{username}/files/""
    full_path = base_path + filepath
    with open(full_path, 'r') as f:
        return f.read()","def get_user_file(username, filepath):
    import os
    base_path = f""/home/{username}/files/""
    full_path = base_path + filepath
    with open(full_path, 'r') as f:
        return f.read()",python,1
Memory Corruption,"#include <iostream>

void unsafe_virtual_call() {
    // Potential vtable corruption vulnerability
    class Base {
    public:
        virtual void func() { std::cout << ""Base"" << std::endl; }
    };
    
    class Derived : public Base {
    public:
        void func() override { std::cout << ""Derived"" << std::endl; }
    };
}","#include <iostream>

void unsafe_virtual_call() {
    // Potential vtable corruption vulnerability
    class Base {
    public:
        virtual void func() { std::cout << ""Base"" << std::endl; }
    };
    
    class Derived : public Base {
    public:
        void func() override { std::cout << ""Derived"" << std::endl; }
    };
}",cpp,1
SQL Injection,"app.get('/user/:id', (req, res) => {
    const query = `SELECT * FROM users WHERE id = ${req.params.id}`; // SQL Injection
    db.query(query, (err, result) => {
        res.json(result);
    });
});
","app.get('/user/:id', (req, res) => {
    const query = `SELECT * FROM users WHERE id = ${req.params.id}`; // SQL Injection
    db.query(query, (err, result) => {
        res.json(result);
    });
});
",javascript,1
Path Traversal,"import java.io.File;
import java.io.FileReader;
import java.io.IOException;

public class PathTraversalVulnerability {
    public static void main(String[] args) {
        String userInput = args[0]; // Assume userInput is provided by the user

        try {
            File file = new File(""C:/path/to/some/directory/"" + userInput);
            FileReader reader = new FileReader(file);

            int character;
            while ((character = reader.read()) != -1) {
                System.out.print((char) character);
            }

            reader.close();
        } catch (IOException e) {
            System.out.println(""Error reading file: "" + e.getMessage());
        }
    }
}","import java.io.File; import java.io.FileReader; import java.io.IOException; public class PathTraversalVulnerability { public static void main(String[] args) { String userInput = args[0]; // Assume userInput is provided by the user try { File file = new File(""C:/path/to/some/directory/"" + userInput); FileReader reader = new FileReader(file); int character; while ((character = reader.read()) != -1) { System.out.print((char) character); } reader.close(); } catch (IOException e) { System.out.println(""Error reading file: "" + e.getMessage()); } } }",java,1
Path Traversal,"import java.io.File;
import java.io.FileInputStream;
import java.io.IOException;
import java.util.Scanner;

public class PathTraversalVulnerability {

    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        System.out.print(""Enter the file name: "");
        String fileName = scanner.nextLine();

        File file = new File(""/path/to/files/"" + fileName);

        try (FileInputStream fis = new FileInputStream(file)) {
            // Reading the contents of the file
            int data;
            while ((data = fis.read()) != -1) {
                System.out.print((char) data);
            }
        } catch (IOException e) {
            System.out.println(""Error reading file: "" + e.getMessage());
        }
    }
}","import java.io.File; import java.io.FileInputStream; import java.io.IOException; import java.util.Scanner; public class PathTraversalVulnerability { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter the file name: ""); String fileName = scanner.nextLine(); File file = new File(""/path/to/files/"" + fileName); try (FileInputStream fis = new FileInputStream(file)) { // Reading the contents of the file int data; while ((data = fis.read()) != -1) { System.out.print((char) data); } } catch (IOException e) { System.out.println(""Error reading file: "" + e.getMessage()); } } }",java,1
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Clear,"To fix the Command Injection vulnerability in the provided Java code snippet, you should not directly concatenate user input into the command string that is passed to `Runtime.exec()`. Instead, you should validate and sanitize the user input to prevent malicious commands from being executed. 

Here's an example of how you can modify the code to prevent Command Injection:

```java
import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class SecureCommandExecution {

    public static void main(String[] args) {
        try {
            BufferedReader br = new BufferedReader(new InputStreamReader(System.in));
            System.out.print(""Enter a command to execute: "");
            String userInput = br.readLine();

            // Sanitize user input by allowing only alphanumeric characters
            if (!userInput.matches(""[a-zA-Z0-9]+"")) {
                System.out.println(""Invalid input. Only alphanumeric characters are allowed."");
                return;
            }

            // Execute the command safely
            String[] command = { ""/bin/sh"", ""-c"", ""ping "" + userInput };
            Process process = Runtime.getRuntime().exec(command);

            BufferedReader reader = new BufferedReader(new InputStreamReader(process.getInputStream()));
            String line;
            while ((line = reader.readLine()) != null) {
                System.out.println(line","To fix the Command Injection vulnerability in the provided Java code snippet, you should not directly concatenate user input into the command string that is passed to `Runtime.exec()`. Instead, you should validate and sanitize the user input to prevent malicious commands from being executed. Here's an example of how you can modify the code to prevent Command Injection: ```java import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class SecureCommandExecution { public static void main(String[] args) { try { BufferedReader br = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a command to execute: ""); String userInput = br.readLine(); // Sanitize user input by allowing only alphanumeric characters if (!userInput.matches(""[a-zA-Z0-9]+"")) { System.out.println(""Invalid input. Only alphanumeric characters are allowed.""); return; } // Execute the command safely String[] command = { ""/bin/sh"", ""-c"", ""ping "" + userInput }; Process process = Runtime.getRuntime().exec(command); BufferedReader reader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = reader.readLine()) != null) { System.out.println(line",java,0
Clear,"import java.io.*;
import javax.servlet.*;
import javax.servlet.http.*;
import org.owasp.encoder.Encode;

public class XSSSecureServlet extends HttpServlet {
    protected void doGet(HttpServletRequest request, HttpServletResponse response)
            throws ServletException, IOException {
        response.setContentType(""text/html"");
        PrintWriter out = response.getWriter();
        
        String userInput = request.getParameter(""input"");
        String safeUserInput = Encode.forHtml(userInput);

        out.println(""<html><body>"");
        out.println(""<h1>Hello, "" + safeUserInput + ""</h1>"");
        out.println(""</body></html>"");
    }
}","import java.io.*; import javax.servlet.*; import javax.servlet.http.*; import org.owasp.encoder.Encode; public class XSSSecureServlet extends HttpServlet { protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { response.setContentType(""text/html""); PrintWriter out = response.getWriter(); String userInput = request.getParameter(""input""); String safeUserInput = Encode.forHtml(userInput); out.println(""<html><body>""); out.println(""<h1>Hello, "" + safeUserInput + ""</h1>""); out.println(""</body></html>""); } }",java,0
Clear,"#include <iostream>
#include <string>
#include <vector>

void safe_string_handling(const std::string& input) {
    std::string safe_copy = input;
    std::cout << safe_copy << std::endl;
}","#include <iostream>
#include <string>
#include <vector>

void safe_string_handling(const std::string& input) {
    std::string safe_copy = input;
    std::cout << safe_copy << std::endl;
}",cpp,0
Cross-Site Scripting (XSS),"import java.io.IOException;
import java.io.PrintWriter;
import javax.servlet.ServletException;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

public class VulnerableServlet extends HttpServlet {

    @Override
    protected void doGet(HttpServletRequest request, HttpServletResponse response)
            throws ServletException, IOException {

        String userInput = request.getParameter(""input"");
        
        response.setContentType(""text/html"");
        PrintWriter out = response.getWriter();
        
        out.println(""<html>"");
        out.println(""<head><title>XSS Vulnerability Example</title></head>"");
        out.println(""<body>"");
        
        // Vulnerable code: User input is directly embedded in the HTML response without proper encoding
        out.println(""<h1>Welcome "" + userInput + ""!</h1>"");
        
        out.println(""</body>"");
        out.println(""</html>"");
    }
}","import java.io.IOException; import java.io.PrintWriter; import javax.servlet.ServletException; import javax.servlet.http.HttpServlet; import javax.servlet.http.HttpServletRequest; import javax.servlet.http.HttpServletResponse; public class VulnerableServlet extends HttpServlet { @Override protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { String userInput = request.getParameter(""input""); response.setContentType(""text/html""); PrintWriter out = response.getWriter(); out.println(""<html>""); out.println(""<head><title>XSS Vulnerability Example</title></head>""); out.println(""<body>""); // Vulnerable code: User input is directly embedded in the HTML response without proper encoding out.println(""<h1>Welcome "" + userInput + ""!</h1>""); out.println(""</body>""); out.println(""</html>""); } }",java,1
Cross-Site Scripting (XSS),"import java.io.*;
import javax.servlet.*;
import javax.servlet.http.*;

public class XSSVulnerableServlet extends HttpServlet {
    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        String userInput = request.getParameter(""input"");
        
        // Improperly handling user input by directly outputting it to the response
        response.setContentType(""text/html"");
        PrintWriter out = response.getWriter();
        out.println(""<html>"");
        out.println(""<body>"");
        out.println(""<h1>User Input: "" + userInput + ""</h1>""); // Vulnerability: User input is not sanitized or encoded
        out.println(""</body>"");
        out.println(""</html>"");
    }
}","import java.io.*; import javax.servlet.*; import javax.servlet.http.*; public class XSSVulnerableServlet extends HttpServlet { protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { String userInput = request.getParameter(""input""); // Improperly handling user input by directly outputting it to the response response.setContentType(""text/html""); PrintWriter out = response.getWriter(); out.println(""<html>""); out.println(""<body>""); out.println(""<h1>User Input: "" + userInput + ""</h1>""); // Vulnerability: User input is not sanitized or encoded out.println(""</body>""); out.println(""</html>""); } }",java,1
XSS,"const userInput = document.location.search.split('=')[1];
document.write(userInput); // XSS
","const userInput = document.location.search.split('=')[1];
document.write(userInput); // XSS
",javascript,1
Clear,"const shell = require('child_process');
const safeInput = userInput.replace(/[^a-zA-Z0-9.]/g, '');
shell.execFile('ping', [safeInput]); // Safe command execution
","const shell = require('child_process');
const safeInput = userInput.replace(/[^a-zA-Z0-9.]/g, '');
shell.execFile('ping', [safeInput]); // Safe command execution
",javascript,0
Clear,"const shell = require('child_process');
const safeInput = userInput.replace(/[^a-zA-Z0-9.]/g, '');
shell.execFile('ping', [safeInput]); // Safe command execution
","const shell = require('child_process');
const safeInput = userInput.replace(/[^a-zA-Z0-9.]/g, '');
shell.execFile('ping', [safeInput]); // Safe command execution
",javascript,0
SQL Injection,"app.get('/user/:id', (req, res) => {
    const query = `SELECT * FROM users WHERE id = ${req.params.id}`; // SQL Injection
    db.query(query, (err, result) => {
        res.json(result);
    });
});
","app.get('/user/:id', (req, res) => {
    const query = `SELECT * FROM users WHERE id = ${req.params.id}`; // SQL Injection
    db.query(query, (err, result) => {
        res.json(result);
    });
});
",javascript,1
Clear,"To fix the insecure deserialization vulnerability in the provided code snippet, you need to implement proper security measures to prevent potential exploitation. Here are some steps you can take to enhance the security of deserialization in Java:

1. Implement input validation: Validate and sanitize any user input before deserializing it. In this case, you should ensure that the input data is safe and trusted.

2. Use a secure serialization format: Consider using a secure serialization library such as Jackson or Google Gson with appropriate configuration settings to prevent malicious code execution during deserialization.

3. Enable security manager: Configure a Security Manager with a restrictive policy that limits the permissions available during deserialization to prevent potentially harmful actions.

4. Use whitelisting: Implement a whitelist of allowed classes that can be deserialized and reject any unknown or untrusted classes during the deserialization process.

5. Enable integrity checks: Implement integrity checks such as digital signatures or checksums to verify the authenticity of serialized data before deserializing it.

6. Avoid using ObjectInputStream: Instead of using ObjectInputStream directly, consider using safer alternatives like JSON or XML serialization libraries that provide more control over the deserialization process.

Here's an updated version of your code snippet with some security measures implemented:

```java","To fix the insecure deserialization vulnerability in the provided code snippet, you need to implement proper security measures to prevent potential exploitation. Here are some steps you can take to enhance the security of deserialization in Java: 1. Implement input validation: Validate and sanitize any user input before deserializing it. In this case, you should ensure that the input data is safe and trusted. 2. Use a secure serialization format: Consider using a secure serialization library such as Jackson or Google Gson with appropriate configuration settings to prevent malicious code execution during deserialization. 3. Enable security manager: Configure a Security Manager with a restrictive policy that limits the permissions available during deserialization to prevent potentially harmful actions. 4. Use whitelisting: Implement a whitelist of allowed classes that can be deserialized and reject any unknown or untrusted classes during the deserialization process. 5. Enable integrity checks: Implement integrity checks such as digital signatures or checksums to verify the authenticity of serialized data before deserializing it. 6. Avoid using ObjectInputStream: Instead of using ObjectInputStream directly, consider using safer alternatives like JSON or XML serialization libraries that provide more control over the deserialization process. Here's an updated version of your code snippet with some security measures implemented: ```java",php,0
Clear,"app.get('/user/:id', (req, res) => {
    const userId = parseInt(req.params.id);
    db.query('SELECT * FROM users WHERE id = ?', [userId], (err, result) => {
        res.json(result);
    });
});
","app.get('/user/:id', (req, res) => {
    const userId = parseInt(req.params.id);
    db.query('SELECT * FROM users WHERE id = ?', [userId], (err, result) => {
        res.json(result);
    });
});
",javascript,0
SQL Injection,"import java.sql.*;

public class VulnerableCode {

    public static void main(String[] args) {
        String userInput = ""'; DROP TABLE users; --""; // Malicious user input

        try {
            Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");
            Statement stmt = conn.createStatement();

            // Vulnerable SQL query concatenating user input directly
            String query = ""SELECT * FROM users WHERE username='"" + userInput + ""'"";
            ResultSet rs = stmt.executeQuery(query);

            while (rs.next()) {
                System.out.println(rs.getString(""username""));
            }

        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.*; public class VulnerableCode { public static void main(String[] args) { String userInput = ""'; DROP TABLE users; --""; // Malicious user input try { Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); Statement stmt = conn.createStatement(); // Vulnerable SQL query concatenating user input directly String query = ""SELECT * FROM users WHERE username='"" + userInput + ""'""; ResultSet rs = stmt.executeQuery(query); while (rs.next()) { System.out.println(rs.getString(""username"")); } } catch (SQLException e) { e.printStackTrace(); } } }",java,1
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Clear,"const shell = require('child_process');
const safeInput = userInput.replace(/[^a-zA-Z0-9.]/g, '');
shell.execFile('ping', [safeInput]); // Safe command execution
","const shell = require('child_process');
const safeInput = userInput.replace(/[^a-zA-Z0-9.]/g, '');
shell.execFile('ping', [safeInput]); // Safe command execution
",javascript,0
Clear,"To fix this code and prevent Path Traversal vulnerability, you should validate the user input to ensure that it does not contain any malicious path traversal characters. Additionally, it is recommended to restrict the file access to a specific directory.

Here's an updated version of the code with proper security measures:

```java
import java.io.File;
import java.io.FileInputStream;
import java.io.IOException;

public class SecureFileHandler {
    private static final String BASE_DIRECTORY = ""/path/to/some/directory/"";

    public static void main(String[] args) {
        if (args.length != 1) {
            System.err.println(""Please provide a file name as an argument."");
            return;
        }

        String fileName = args[0];
        
        // Validate user input to prevent path traversal
        if (!isValidFileName(fileName)) {
            System.err.println(""Invalid file name."");
            return;
        }

        File file = new File(BASE_DIRECTORY + fileName);

        try (FileInputStream fis = new FileInputStream(file)) {
            // Read and process the contents of the file
        } catch (IOException e) {
            System.err.println(""Error reading file: "" + e.getMessage());
        }
    }

    private static boolean isValidFileName(String fileName) {
        //","To fix this code and prevent Path Traversal vulnerability, you should validate the user input to ensure that it does not contain any malicious path traversal characters. Additionally, it is recommended to restrict the file access to a specific directory. Here's an updated version of the code with proper security measures: ```java import java.io.File; import java.io.FileInputStream; import java.io.IOException; public class SecureFileHandler { private static final String BASE_DIRECTORY = ""/path/to/some/directory/""; public static void main(String[] args) { if (args.length != 1) { System.err.println(""Please provide a file name as an argument.""); return; } String fileName = args[0]; // Validate user input to prevent path traversal if (!isValidFileName(fileName)) { System.err.println(""Invalid file name.""); return; } File file = new File(BASE_DIRECTORY + fileName); try (FileInputStream fis = new FileInputStream(file)) { // Read and process the contents of the file } catch (IOException e) { System.err.println(""Error reading file: "" + e.getMessage()); } } private static boolean isValidFileName(String fileName) { //",java,0
Clear,"<?php
$message = htmlspecialchars($_GET['message'], ENT_QUOTES, 'UTF-8');
echo $message; // Sanitized output
?>","<?php
$message = htmlspecialchars($_GET['message'], ENT_QUOTES, 'UTF-8');
echo $message; // Sanitized output
?>",php,0
Clear,"<?php
$file = basename($_GET['file']);
$allowed = ['page1.php', 'page2.php'];
if (in_array($file, $allowed)) {
    include($file);
}
?>","<?php
$file = basename($_GET['file']);
$allowed = ['page1.php', 'page2.php'];
if (in_array($file, $allowed)) {
    include($file);
}
?>",php,0
Command Injection,"import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class CommandInjectionVulnerable {

    public static void main(String[] args) {
        try {
            BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));
            System.out.print(""Enter a command to execute: "");
            String command = reader.readLine();

            // Vulnerable code: directly executing user input as a command
            Process process = Runtime.getRuntime().exec(command);

            BufferedReader inputReader = new BufferedReader(new InputStreamReader(process.getInputStream()));
            String line;
            while ((line = inputReader.readLine()) != null) {
                System.out.println(line);
            }

        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}","import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class CommandInjectionVulnerable { public static void main(String[] args) { try { BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a command to execute: ""); String command = reader.readLine(); // Vulnerable code: directly executing user input as a command Process process = Runtime.getRuntime().exec(command); BufferedReader inputReader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = inputReader.readLine()) != null) { System.out.println(line); } } catch (IOException e) { e.printStackTrace(); } } }",java,1
Clear,"import java.io.IOException;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

public class XssSafeServlet extends HttpServlet {
    
    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws IOException {
        String userInput = request.getParameter(""input"");
        
        // Sanitize and escape user input to prevent XSS
        String safeInput = escapeHtml(userInput);
        
        // Output sanitized user input
        String output = ""<h1>Welcome "" + safeInput + ""</h1>"";
        
        response.getWriter().write(output);
    }
    
    private String escapeHtml(String input) {
        if (input == null) {
            return """";
        }
        return input.replaceAll(""&"", ""&amp;"")
                     .replaceAll(""<"", ""&lt;"")
                     .replaceAll("">"", ""&gt;"")
                     .replaceAll(""\"""", ""&quot;"")
                     .replaceAll(""'"", ""&#39;"");
    }
}","import java.io.IOException; import javax.servlet.http.HttpServlet; import javax.servlet.http.HttpServletRequest; import javax.servlet.http.HttpServletResponse; public class XssSafeServlet extends HttpServlet { protected void doGet(HttpServletRequest request, HttpServletResponse response) throws IOException { String userInput = request.getParameter(""input""); // Sanitize and escape user input to prevent XSS String safeInput = escapeHtml(userInput); // Output sanitized user input String output = ""<h1>Welcome "" + safeInput + ""</h1>""; response.getWriter().write(output); } private String escapeHtml(String input) { if (input == null) { return """"; } return input.replaceAll(""&"", ""&amp;"") .replaceAll(""<"", ""&lt;"") .replaceAll("">"", ""&gt;"") .replaceAll(""\"""", ""&quot;"") .replaceAll(""'"", ""&#39;""); } }",java,0
Clear,"#include <stdio.h>
#include <string.h>

void safe_string_copy(char *dest, const char *src, size_t dest_size) {
    if (dest_size > 0) {
        strncpy(dest, src, dest_size - 1);
        dest[dest_size - 1] = '\0';
    }
}","#include <stdio.h>
#include <string.h>

void safe_string_copy(char *dest, const char *src, size_t dest_size) {
    if (dest_size > 0) {
        strncpy(dest, src, dest_size - 1);
        dest[dest_size - 1] = '\0';
    }
}",c,0
Command Injection,"import subprocess
def list_directory(path):
    result = subprocess.run(f""ls {path}"", shell=True, capture_output=True, text=True)
    return result.stdout","import subprocess
def list_directory(path):
    result = subprocess.run(f""ls {path}"", shell=True, capture_output=True, text=True)
    return result.stdout",python,1
File Inclusion,"<?php
$file = $_GET['file'];
include($file); // File Inclusion
?>","<?php
$file = $_GET['file'];
include($file); // File Inclusion
?>",php,1
Memory Corruption,"#include <iostream>

void unsafe_virtual_call() {
    // Potential vtable corruption vulnerability
    class Base {
    public:
        virtual void func() { std::cout << ""Base"" << std::endl; }
    };
    
    class Derived : public Base {
    public:
        void func() override { std::cout << ""Derived"" << std::endl; }
    };
}","#include <iostream>

void unsafe_virtual_call() {
    // Potential vtable corruption vulnerability
    class Base {
    public:
        virtual void func() { std::cout << ""Base"" << std::endl; }
    };
    
    class Derived : public Base {
    public:
        void func() override { std::cout << ""Derived"" << std::endl; }
    };
}",cpp,1
SQL Injection,"import psycopg2
def admin_login(admin_id):
    conn = psycopg2.connect(""dbname=test user=postgres"")
    cur = conn.cursor()
    cur.execute(f""SELECT * FROM admins WHERE id = {admin_id}"")
    return cur.fetchone()","import psycopg2
def admin_login(admin_id):
    conn = psycopg2.connect(""dbname=test user=postgres"")
    cur = conn.cursor()
    cur.execute(f""SELECT * FROM admins WHERE id = {admin_id}"")
    return cur.fetchone()",python,1
Clear,"from django.http import HttpResponse
from django.utils.html import escape

def safe_user_profile(request, username):
    safe_username = escape(username)
    return HttpResponse(f""Welcome, {safe_username}!"")","from django.http import HttpResponse
from django.utils.html import escape

def safe_user_profile(request, username):
    safe_username = escape(username)
    return HttpResponse(f""Welcome, {safe_username}!"")",python,0
Clear,"To fix the XSS vulnerability in the provided Java servlet code, you need to properly sanitize the user input before embedding it into the HTML response. One common approach is to use a library like OWASP Java HTML Sanitizer to sanitize user input and prevent XSS attacks.

Here's an updated version of the code that includes proper sanitization using OWASP Java HTML Sanitizer:

```java
import java.io.IOException;
import java.io.PrintWriter;

import javax.servlet.ServletException;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

import org.owasp.html.PolicyFactory;
import org.owasp.html.Sanitizers;

public class SecureServlet extends HttpServlet {

    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        String userInput = request.getParameter(""input"");

        // Sanitize user input to prevent XSS attacks
        PolicyFactory policy = Sanitizers.FORMATTING.and(Sanitizers.LINKS);
        String sanitizedInput = policy.sanitize(userInput);

        PrintWriter out = response.getWriter();
        out.println(""<html>"");
        out.println(""<body>"");
        out.println(""<h1>User Input: "" + sanitizedInput + ""</h1>"");
        out.println(""</body>"");
        out.println","To fix the XSS vulnerability in the provided Java servlet code, you need to properly sanitize the user input before embedding it into the HTML response. One common approach is to use a library like OWASP Java HTML Sanitizer to sanitize user input and prevent XSS attacks. Here's an updated version of the code that includes proper sanitization using OWASP Java HTML Sanitizer: ```java import java.io.IOException; import java.io.PrintWriter; import javax.servlet.ServletException; import javax.servlet.http.HttpServlet; import javax.servlet.http.HttpServletRequest; import javax.servlet.http.HttpServletResponse; import org.owasp.html.PolicyFactory; import org.owasp.html.Sanitizers; public class SecureServlet extends HttpServlet { protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { String userInput = request.getParameter(""input""); // Sanitize user input to prevent XSS attacks PolicyFactory policy = Sanitizers.FORMATTING.and(Sanitizers.LINKS); String sanitizedInput = policy.sanitize(userInput); PrintWriter out = response.getWriter(); out.println(""<html>""); out.println(""<body>""); out.println(""<h1>User Input: "" + sanitizedInput + ""</h1>""); out.println(""</body>""); out.println",java,0
SQL Injection,"import java.sql.*;

public class VulnerableCode {

    public static void main(String[] args) {
        String userInput = ""'; DROP TABLE users; --""; // Malicious input simulating SQL injection
        String query = ""SELECT * FROM users WHERE username = '"" + userInput + ""'"";

        try {
            Connection connection = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");
            Statement statement = connection.createStatement();
            ResultSet resultSet = statement.executeQuery(query);

            while(resultSet.next()) {
                System.out.println(""User found: "" + resultSet.getString(""username""));
            }

        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.*; public class VulnerableCode { public static void main(String[] args) { String userInput = ""'; DROP TABLE users; --""; // Malicious input simulating SQL injection String query = ""SELECT * FROM users WHERE username = '"" + userInput + ""'""; try { Connection connection = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); Statement statement = connection.createStatement(); ResultSet resultSet = statement.executeQuery(query); while(resultSet.next()) { System.out.println(""User found: "" + resultSet.getString(""username"")); } } catch (SQLException e) { e.printStackTrace(); } } }",java,1
Clear,"<?php
$message = htmlspecialchars($_GET['message'], ENT_QUOTES, 'UTF-8');
echo $message; // Sanitized output
?>","<?php
$message = htmlspecialchars($_GET['message'], ENT_QUOTES, 'UTF-8');
echo $message; // Sanitized output
?>",php,0
Clear,"#include <iostream>
#include <fstream>
#include <string>

void safe_file_reading(const std::string& filename) {
    std::ifstream file(filename);
    if (file.is_open()) {
        std::string line;
        while (std::getline(file, line)) {
            std::cout << line << std::endl;
        }
    }
}","#include <iostream>
#include <fstream>
#include <string>

void safe_file_reading(const std::string& filename) {
    std::ifstream file(filename);
    if (file.is_open()) {
        std::string line;
        while (std::getline(file, line)) {
            std::cout << line << std::endl;
        }
    }
}",cpp,0
Clear,"import os
def safe_read_file(filename):
    base_path = '/var/www/uploads/'
    full_path = os.path.join(base_path, filename)
    full_path = os.path.normpath(full_path)
    if not full_path.startswith(base_path):
        raise ValueError(""Path traversal detected"")
    with open(full_path, 'r') as f:
        return f.read()","import os
def safe_read_file(filename):
    base_path = '/var/www/uploads/'
    full_path = os.path.join(base_path, filename)
    full_path = os.path.normpath(full_path)
    if not full_path.startswith(base_path):
        raise ValueError(""Path traversal detected"")
    with open(full_path, 'r') as f:
        return f.read()",python,0
Clear,"#include <iostream>
#include <vector>
#include <stdexcept>

int safe_vector_access(const std::vector<int>& vec, size_t index) {
    if (index >= vec.size()) {
        throw std::out_of_range(""Index out of range"");
    }
    return vec[index];
}","#include <iostream>
#include <vector>
#include <stdexcept>

int safe_vector_access(const std::vector<int>& vec, size_t index) {
    if (index >= vec.size()) {
        throw std::out_of_range(""Index out of range"");
    }
    return vec[index];
}",cpp,0
Clear,"import sqlite3
def get_user_data_safe(username):
    conn = sqlite3.connect('database.db')
    cursor = conn.cursor()
    query = ""SELECT * FROM users WHERE username = ?""
    cursor.execute(query, (username,))
    return cursor.fetchall()","import sqlite3
def get_user_data_safe(username):
    conn = sqlite3.connect('database.db')
    cursor = conn.cursor()
    query = ""SELECT * FROM users WHERE username = ?""
    cursor.execute(query, (username,))
    return cursor.fetchall()",python,0
Clear,"app.get('/user/:id', (req, res) => {
    const userId = parseInt(req.params.id);
    db.query('SELECT * FROM users WHERE id = ?', [userId], (err, result) => {
        res.json(result);
    });
});
","app.get('/user/:id', (req, res) => {
    const userId = parseInt(req.params.id);
    db.query('SELECT * FROM users WHERE id = ?', [userId], (err, result) => {
        res.json(result);
    });
});
",javascript,0
Code Injection,"const userData = eval('(' + userInput + ')'); // eval injection
","const userData = eval('(' + userInput + ')'); // eval injection
",javascript,1
SQL Injection,"app.get('/user/:id', (req, res) => {
    const query = `SELECT * FROM users WHERE id = ${req.params.id}`; // SQL Injection
    db.query(query, (err, result) => {
        res.json(result);
    });
});
","app.get('/user/:id', (req, res) => {
    const query = `SELECT * FROM users WHERE id = ${req.params.id}`; // SQL Injection
    db.query(query, (err, result) => {
        res.json(result);
    });
});
",javascript,1
Buffer Overflow,"#include <iostream>
#include <cstring>

void unsafe_c_string(char* input) {
    char buffer[100];
    strcpy(buffer, input); // potential buffer overflow
    std::cout << buffer << std::endl;
}","#include <iostream>
#include <cstring>

void unsafe_c_string(char* input) {
    char buffer[100];
    strcpy(buffer, input); // potential buffer overflow
    std::cout << buffer << std::endl;
}",cpp,1
Clear,"import java.sql.*;

public class SecureSQLInjectionExample {
    public static void main(String[] args) {
        try {
            String userInput = ""admin'; DROP TABLE users; --"";
            
            String query = ""SELECT * FROM users WHERE username = ?"";
            
            Connection connection = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");
            PreparedStatement preparedStatement = connection.prepareStatement(query);
            preparedStatement.setString(1, userInput);
            
            ResultSet resultSet = preparedStatement.executeQuery();
            
            while (resultSet.next()) {
                System.out.println(resultSet.getString(""username""));
            }
            
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.*; public class SecureSQLInjectionExample { public static void main(String[] args) { try { String userInput = ""admin'; DROP TABLE users; --""; String query = ""SELECT * FROM users WHERE username = ?""; Connection connection = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); PreparedStatement preparedStatement = connection.prepareStatement(query); preparedStatement.setString(1, userInput); ResultSet resultSet = preparedStatement.executeQuery(); while (resultSet.next()) { System.out.println(resultSet.getString(""username"")); } } catch (SQLException e) { e.printStackTrace(); } } }",java,0
Clear,"import yaml
def safe_yaml_load(config_str):
    return yaml.safe_load(config_str)","import yaml
def safe_yaml_load(config_str):
    return yaml.safe_load(config_str)",python,0
Memory Corruption,"#include <iostream>

void unsafe_pointer_arithmetic(int* array, int size) {
    for (int i = 0; i <= size; i++) {
        std::cout << *(array + i) << std::endl; // potential out-of-bounds
    }
}","#include <iostream>

void unsafe_pointer_arithmetic(int* array, int size) {
    for (int i = 0; i <= size; i++) {
        std::cout << *(array + i) << std::endl; // potential out-of-bounds
    }
}",cpp,1
Buffer Overflow,"#include <iostream>
#include <cstring>

void unsafe_c_string(char* input) {
    char buffer[100];
    strcpy(buffer, input); // potential buffer overflow
    std::cout << buffer << std::endl;
}","#include <iostream>
#include <cstring>

void unsafe_c_string(char* input) {
    char buffer[100];
    strcpy(buffer, input); // potential buffer overflow
    std::cout << buffer << std::endl;
}",cpp,1
Clear,"app.get('/user/:id', (req, res) => {
    const userId = parseInt(req.params.id);
    db.query('SELECT * FROM users WHERE id = ?', [userId], (err, result) => {
        res.json(result);
    });
});
","app.get('/user/:id', (req, res) => {
    const userId = parseInt(req.params.id);
    db.query('SELECT * FROM users WHERE id = ?', [userId], (err, result) => {
        res.json(result);
    });
});
",javascript,0
Clear,"#include <iostream>
#include <fstream>
#include <string>

void safe_file_reading(const std::string& filename) {
    std::ifstream file(filename);
    if (file.is_open()) {
        std::string line;
        while (std::getline(file, line)) {
            std::cout << line << std::endl;
        }
    }
}","#include <iostream>
#include <fstream>
#include <string>

void safe_file_reading(const std::string& filename) {
    std::ifstream file(filename);
    if (file.is_open()) {
        std::string line;
        while (std::getline(file, line)) {
            std::cout << line << std::endl;
        }
    }
}",cpp,0
Clear,"<?php
$input = json_decode($_POST['data'], true); // Safe JSON parsing
if (json_last_error() === JSON_ERROR_NONE) {
    process_data($input);
}
?>","<?php
$input = json_decode($_POST['data'], true); // Safe JSON parsing
if (json_last_error() === JSON_ERROR_NONE) {
    process_data($input);
}
?>",php,0
Clear,"#include <stdio.h>
#include <string.h>

int safe_buffer_operation(char *input) {
    char buffer[100];
    if (strlen(input) < sizeof(buffer)) {
        strcpy(buffer, input);
        return 0;
    }
    return -1; // buffer too small
}","#include <stdio.h>
#include <string.h>

int safe_buffer_operation(char *input) {
    char buffer[100];
    if (strlen(input) < sizeof(buffer)) {
        strcpy(buffer, input);
        return 0;
    }
    return -1; // buffer too small
}",c,0
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Clear,"const token = process.env.API_TOKEN; // Environment variable
fetch('/api/data', {
    headers: { 'Authorization': `Bearer ${token}` }
});
","const token = process.env.API_TOKEN; // Environment variable
fetch('/api/data', {
    headers: { 'Authorization': `Bearer ${token}` }
});
",javascript,0
SSRF,"import requests
def fetch_url(url):
    return requests.get(url).text","import requests
def fetch_url(url):
    return requests.get(url).text",python,1
Clear,"#include <iostream>
#include <string>
#include <vector>

void safe_string_handling(const std::string& input) {
    std::string safe_copy = input;
    std::cout << safe_copy << std::endl;
}","#include <iostream>
#include <string>
#include <vector>

void safe_string_handling(const std::string& input) {
    std::string safe_copy = input;
    std::cout << safe_copy << std::endl;
}",cpp,0
Clear,"const shell = require('child_process');
const safeInput = userInput.replace(/[^a-zA-Z0-9.]/g, '');
shell.execFile('ping', [safeInput]); // Safe command execution
","const shell = require('child_process');
const safeInput = userInput.replace(/[^a-zA-Z0-9.]/g, '');
shell.execFile('ping', [safeInput]); // Safe command execution
",javascript,0
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Clear,"#include <iostream>
#include <string>
#include <vector>

void safe_string_handling(const std::string& input) {
    std::string safe_copy = input;
    std::cout << safe_copy << std::endl;
}","#include <iostream>
#include <string>
#include <vector>

void safe_string_handling(const std::string& input) {
    std::string safe_copy = input;
    std::cout << safe_copy << std::endl;
}",cpp,0
SQL Injection,"app.get('/user/:id', (req, res) => {
    const query = `SELECT * FROM users WHERE id = ${req.params.id}`; // SQL Injection
    db.query(query, (err, result) => {
        res.json(result);
    });
});
","app.get('/user/:id', (req, res) => {
    const query = `SELECT * FROM users WHERE id = ${req.params.id}`; // SQL Injection
    db.query(query, (err, result) => {
        res.json(result);
    });
});
",javascript,1
Insecure Deserialization,"<?php
$data = $_POST['data'];
unserialize($data); // Insecure Deserialization
?>","<?php
$data = $_POST['data'];
unserialize($data); // Insecure Deserialization
?>",php,1
Hardcoded Secrets,"localStorage.setItem('token', 'hardcoded-secret-token-123'); // Hardcoded secret
","localStorage.setItem('token', 'hardcoded-secret-token-123'); // Hardcoded secret
",javascript,1
Code Injection,"const userData = eval('(' + userInput + ')'); // eval injection
","const userData = eval('(' + userInput + ')'); // eval injection
",javascript,1
Clear,"#include <stdio.h>
#include <stdlib.h>

int safe_string_to_int(const char *str) {
    char *endptr;
    long value = strtol(str, &endptr, 10);
    if (*endptr != '\0' || str == endptr) {
        return -1; // error
    }
    return (int)value;
}","#include <stdio.h>
#include <stdlib.h>

int safe_string_to_int(const char *str) {
    char *endptr;
    long value = strtol(str, &endptr, 10);
    if (*endptr != '\0' || str == endptr) {
        return -1; // error
    }
    return (int)value;
}",c,0
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Clear,"import java.io.*;
import javax.servlet.*;
import javax.servlet.http.*;

import org.owasp.esapi.ESAPI;
import org.owasp.esapi.Encoder;

public class SecureServlet extends HttpServlet {
    protected void doGet(HttpServletRequest request, HttpServletResponse response)
            throws ServletException, IOException {
        response.setContentType(""text/html"");
        PrintWriter out = response.getWriter();

        String userInput = request.getParameter(""input"");

        Encoder encoder = ESAPI.encoder();
        String encodedUserInput = encoder.encodeForHTML(userInput);

        out.println(""<html>"");
        out.println(""<head><title>Secure Code Example</title></head>"");
        out.println(""<body>"");
        out.println(""User Input: "" + encodedUserInput);
        out.println(""</body>"");
        out.println(""</html>"");

    }
}","import java.io.*; import javax.servlet.*; import javax.servlet.http.*; import org.owasp.esapi.ESAPI; import org.owasp.esapi.Encoder; public class SecureServlet extends HttpServlet { protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { response.setContentType(""text/html""); PrintWriter out = response.getWriter(); String userInput = request.getParameter(""input""); Encoder encoder = ESAPI.encoder(); String encodedUserInput = encoder.encodeForHTML(userInput); out.println(""<html>""); out.println(""<head><title>Secure Code Example</title></head>""); out.println(""<body>""); out.println(""User Input: "" + encodedUserInput); out.println(""</body>""); out.println(""</html>""); } }",java,0
Clear,"const userData = JSON.parse(userInput); // Safe JSON parsing
if (userData && typeof userData === 'object') {
    processUserData(userData);
}
","const userData = JSON.parse(userInput); // Safe JSON parsing
if (userData && typeof userData === 'object') {
    processUserData(userData);
}
",javascript,0
Clear,"import hashlib
import os

def hash_password(password):
    salt = os.urandom(32)
    key = hashlib.pbkdf2_hmac('sha256', password.encode(), salt, 100000)
    return salt + key","import hashlib
import os

def hash_password(password):
    salt = os.urandom(32)
    key = hashlib.pbkdf2_hmac('sha256', password.encode(), salt, 100000)
    return salt + key",python,0
Code Injection,"const userData = eval('(' + userInput + ')'); // eval injection
","const userData = eval('(' + userInput + ')'); // eval injection
",javascript,1
Clear,"#include <stdio.h>
#include <string.h>

void safe_string_copy(char *dest, const char *src, size_t dest_size) {
    if (dest_size > 0) {
        strncpy(dest, src, dest_size - 1);
        dest[dest_size - 1] = '\0';
    }
}","#include <stdio.h>
#include <string.h>

void safe_string_copy(char *dest, const char *src, size_t dest_size) {
    if (dest_size > 0) {
        strncpy(dest, src, dest_size - 1);
        dest[dest_size - 1] = '\0';
    }
}",c,0
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Clear,"const userInput = new URLSearchParams(window.location.search).get('input');
const safeOutput = document.createElement('div');
safeOutput.textContent = userInput; // Safe DOM manipulation
document.body.appendChild(safeOutput);
","const userInput = new URLSearchParams(window.location.search).get('input');
const safeOutput = document.createElement('div');
safeOutput.textContent = userInput; // Safe DOM manipulation
document.body.appendChild(safeOutput);
",javascript,0
Clear,"#include <stdio.h>
#include <string.h>

int safe_buffer_operation(char *input) {
    char buffer[100];
    if (strlen(input) < sizeof(buffer)) {
        strcpy(buffer, input);
        return 0;
    }
    return -1; // buffer too small
}","#include <stdio.h>
#include <string.h>

int safe_buffer_operation(char *input) {
    char buffer[100];
    if (strlen(input) < sizeof(buffer)) {
        strcpy(buffer, input);
        return 0;
    }
    return -1; // buffer too small
}",c,0
Clear,"import re
def validate_email(email):
    pattern = r'^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$'
    return bool(re.match(pattern, email))","import re
def validate_email(email):
    pattern = r'^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$'
    return bool(re.match(pattern, email))",python,0
XSS,"const userInput = document.location.search.split('=')[1];
document.write(userInput); // XSS
","const userInput = document.location.search.split('=')[1];
document.write(userInput); // XSS
",javascript,1
SQL Injection,"import psycopg2
def admin_login(admin_id):
    conn = psycopg2.connect(""dbname=test user=postgres"")
    cur = conn.cursor()
    cur.execute(f""SELECT * FROM admins WHERE id = {admin_id}"")
    return cur.fetchone()","import psycopg2
def admin_login(admin_id):
    conn = psycopg2.connect(""dbname=test user=postgres"")
    cur = conn.cursor()
    cur.execute(f""SELECT * FROM admins WHERE id = {admin_id}"")
    return cur.fetchone()",python,1
Clear,"<?php
$cmd = escapeshellarg($_GET['cmd']);
system(""ls "" . $cmd); // Escaped command
?>","<?php
$cmd = escapeshellarg($_GET['cmd']);
system(""ls "" . $cmd); // Escaped command
?>",php,0
Clear,"import java.sql.*;

public class SQLInjectionSecure {

    public static void main(String[] args) {
        String userInput = ""'; DROP TABLE users; --"";

        try {
            Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");
            
            // Use a PreparedStatement to safely handle user input
            String query = ""SELECT * FROM users WHERE username = ?"";
            PreparedStatement pstmt = conn.prepareStatement(query);
            pstmt.setString(1, userInput);

            ResultSet rs = pstmt.executeQuery();

            while (rs.next()) {
                System.out.println(""User: "" + rs.getString(""username""));
            }

            conn.close();
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.*; public class SQLInjectionSecure { public static void main(String[] args) { String userInput = ""'; DROP TABLE users; --""; try { Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); // Use a PreparedStatement to safely handle user input String query = ""SELECT * FROM users WHERE username = ?""; PreparedStatement pstmt = conn.prepareStatement(query); pstmt.setString(1, userInput); ResultSet rs = pstmt.executeQuery(); while (rs.next()) { System.out.println(""User: "" + rs.getString(""username"")); } conn.close(); } catch (SQLException e) { e.printStackTrace(); } } }",java,0
Insecure Deserialization,"import yaml
def load_config(config_str):
    return yaml.load(config_str, Loader=yaml.Loader)","import yaml
def load_config(config_str):
    return yaml.load(config_str, Loader=yaml.Loader)",python,1
SQL Injection,"import java.sql.*;

public class SQLInjectionExample {

    public static void main(String[] args) {
        try {
            String userInput = args[0]; // User input directly from command line argument

            String url = ""jdbc:mysql://localhost:3306/mydatabase"";
            String username = ""root"";
            String password = ""password"";

            Connection connection = DriverManager.getConnection(url, username, password);
            
            Statement statement = connection.createStatement();
            String query = ""SELECT * FROM users WHERE username='"" + userInput + ""'"";
            
            ResultSet resultSet = statement.executeQuery(query);

            while (resultSet.next()) {
                System.out.println(""User ID: "" + resultSet.getInt(""id"") + "", Username: "" + resultSet.getString(""username""));
            }

            resultSet.close();
            statement.close();
            connection.close();

        } catch (Exception e) {
            e.printStackTrace();
        }
    }
}","import java.sql.*; public class SQLInjectionExample { public static void main(String[] args) { try { String userInput = args[0]; // User input directly from command line argument String url = ""jdbc:mysql://localhost:3306/mydatabase""; String username = ""root""; String password = ""password""; Connection connection = DriverManager.getConnection(url, username, password); Statement statement = connection.createStatement(); String query = ""SELECT * FROM users WHERE username='"" + userInput + ""'""; ResultSet resultSet = statement.executeQuery(query); while (resultSet.next()) { System.out.println(""User ID: "" + resultSet.getInt(""id"") + "", Username: "" + resultSet.getString(""username"")); } resultSet.close(); statement.close(); connection.close(); } catch (Exception e) { e.printStackTrace(); } } }",java,1
Clear,"import java.io.*;
import javax.servlet.*;
import javax.servlet.http.*;
import org.owasp.encoder.Encode;

public class XSSFixedServlet extends HttpServlet {
    protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        response.setContentType(""text/html"");
        PrintWriter out = response.getWriter();

        String userInput = request.getParameter(""input"");

        out.println(""<html>"");
        out.println(""<body>"");
        out.println(""<h2>User Input: "" + Encode.forHtml(userInput) + ""</h2>""); // Sanitize user input before outputting
        out.println(""</body>"");
        out.println(""</html>"");
    }
}","import java.io.*; import javax.servlet.*; import javax.servlet.http.*; import org.owasp.encoder.Encode; public class XSSFixedServlet extends HttpServlet { protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { response.setContentType(""text/html""); PrintWriter out = response.getWriter(); String userInput = request.getParameter(""input""); out.println(""<html>""); out.println(""<body>""); out.println(""<h2>User Input: "" + Encode.forHtml(userInput) + ""</h2>""); // Sanitize user input before outputting out.println(""</body>""); out.println(""</html>""); } }",java,0
Clear,"import pickle
def safe_deserialize(data):
    allowed_classes = {'SafeClass', 'AnotherSafeClass'}
    return pickle.loads(data)","import pickle
def safe_deserialize(data):
    allowed_classes = {'SafeClass', 'AnotherSafeClass'}
    return pickle.loads(data)",python,0
File Inclusion,"<?php
$file = $_GET['file'];
include($file); // File Inclusion
?>","<?php
$file = $_GET['file'];
include($file); // File Inclusion
?>",php,1
Buffer Overflow,"import java.util.Scanner;

public class BufferOverflowVulnerability {

    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        
        System.out.println(""Enter a string: "");
        String userInput = scanner.nextLine();
        
        char[] buffer = new char[10];
        userInput.getChars(0, userInput.length(), buffer, 0);
        
        // This loop will cause a buffer overflow if the user input is longer than the buffer size
        for (int i = 0; i <= buffer.length; i++) {
            System.out.print(buffer[i]);
        }
        
        scanner.close();
    }
}","import java.util.Scanner; public class BufferOverflowVulnerability { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.println(""Enter a string: ""); String userInput = scanner.nextLine(); char[] buffer = new char[10]; userInput.getChars(0, userInput.length(), buffer, 0); // This loop will cause a buffer overflow if the user input is longer than the buffer size for (int i = 0; i <= buffer.length; i++) { System.out.print(buffer[i]); } scanner.close(); } }",java,1
Cross-Site Scripting (XSS),"def display_comment(comment_text):
    return f""<div class='comment'>{comment_text}</div>"" ","def display_comment(comment_text):
    return f""<div class='comment'>{comment_text}</div>"" ",python,1
XSS,"<?php
echo $_GET['message']; // XSS
?>","<?php
echo $_GET['message']; // XSS
?>",php,1
Clear,"const userInput = new URLSearchParams(window.location.search).get('input');
const safeOutput = document.createElement('div');
safeOutput.textContent = userInput; // Safe DOM manipulation
document.body.appendChild(safeOutput);
","const userInput = new URLSearchParams(window.location.search).get('input');
const safeOutput = document.createElement('div');
safeOutput.textContent = userInput; // Safe DOM manipulation
document.body.appendChild(safeOutput);
",javascript,0
SQL Injection,"import psycopg2
def admin_login(admin_id):
    conn = psycopg2.connect(""dbname=test user=postgres"")
    cur = conn.cursor()
    cur.execute(f""SELECT * FROM admins WHERE id = {admin_id}"")
    return cur.fetchone()","import psycopg2
def admin_login(admin_id):
    conn = psycopg2.connect(""dbname=test user=postgres"")
    cur = conn.cursor()
    cur.execute(f""SELECT * FROM admins WHERE id = {admin_id}"")
    return cur.fetchone()",python,1
Clear,"import java.io.*;

public class CommandInjectionExample {
    public static void main(String[] args) {
        try {
            BufferedReader br = new BufferedReader(new InputStreamReader(System.in));
            System.out.print(""Enter a command to execute: "");
            String command = br.readLine();

            ProcessBuilder processBuilder = new ProcessBuilder();
            processBuilder.command(""ping"", command);
            
            Process process = processBuilder.start();

            BufferedReader reader = new BufferedReader(new InputStreamReader(process.getInputStream()));
            String line;
            while ((line = reader.readLine()) != null) {
                System.out.println(line);
            }
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}","import java.io.*; public class CommandInjectionExample { public static void main(String[] args) { try { BufferedReader br = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a command to execute: ""); String command = br.readLine(); ProcessBuilder processBuilder = new ProcessBuilder(); processBuilder.command(""ping"", command); Process process = processBuilder.start(); BufferedReader reader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = reader.readLine()) != null) { System.out.println(line); } } catch (IOException e) { e.printStackTrace(); } } }",java,0
Cross-Site Scripting (XSS),"def display_comment(comment_text):
    return f""<div class='comment'>{comment_text}</div>"" ","def display_comment(comment_text):
    return f""<div class='comment'>{comment_text}</div>"" ",python,1
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Cross-Site Scripting (XSS),"import java.io.*;
import javax.servlet.*;
import javax.servlet.http.*;

public class XSSVulnerableServlet extends HttpServlet {
    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        String userInput = request.getParameter(""input"");
        String output = ""<h1>Welcome "" + userInput + ""</h1>"";
        
        PrintWriter out = response.getWriter();
        out.println(output);
    }
}","import java.io.*; import javax.servlet.*; import javax.servlet.http.*; public class XSSVulnerableServlet extends HttpServlet { protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { String userInput = request.getParameter(""input""); String output = ""<h1>Welcome "" + userInput + ""</h1>""; PrintWriter out = response.getWriter(); out.println(output); } }",java,1
SQL Injection,"import java.sql.*;

public class SQLInjectionVulnerableApp {
    public static void main(String[] args) {
        String userInput = ""admin'; DROP TABLE users; --""; // Malicious input

        try {
            Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");
            Statement stmt = conn.createStatement();

            // Vulnerable query construction
            String query = ""SELECT * FROM users WHERE username='"" + userInput + ""'"";
            ResultSet rs = stmt.executeQuery(query);

            while (rs.next()) {
                System.out.println(""User found: "" + rs.getString(""username""));
            }

            conn.close();
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.*; public class SQLInjectionVulnerableApp { public static void main(String[] args) { String userInput = ""admin'; DROP TABLE users; --""; // Malicious input try { Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); Statement stmt = conn.createStatement(); // Vulnerable query construction String query = ""SELECT * FROM users WHERE username='"" + userInput + ""'""; ResultSet rs = stmt.executeQuery(query); while (rs.next()) { System.out.println(""User found: "" + rs.getString(""username"")); } conn.close(); } catch (SQLException e) { e.printStackTrace(); } } }",java,1
Out-of-Bounds,"#include <iostream>

class UnsafeClass {
    int data[10];
public:
    int get_data(int index) {
        return data[index]; // no bounds checking
    }
};","#include <iostream>

class UnsafeClass {
    int data[10];
public:
    int get_data(int index) {
        return data[index]; // no bounds checking
    }
};",cpp,1
Hardcoded Secrets,"localStorage.setItem('token', 'hardcoded-secret-token-123'); // Hardcoded secret
","localStorage.setItem('token', 'hardcoded-secret-token-123'); // Hardcoded secret
",javascript,1
Path Traversal,"import os
def read_file(filename):
    with open('/var/www/uploads/' + filename, 'r') as f:
        return f.read()","import os
def read_file(filename):
    with open('/var/www/uploads/' + filename, 'r') as f:
        return f.read()",python,1
Clear,"#include <stdio.h>
#include <stdlib.h>

void safe_file_operation(const char *filename) {
    FILE *file = fopen(filename, ""r"");
    if (file != NULL) {
        char buffer[256];
        while (fgets(buffer, sizeof(buffer), file)) {
            printf(""%s"", buffer);
        }
        fclose(file);
    }
}","#include <stdio.h>
#include <stdlib.h>

void safe_file_operation(const char *filename) {
    FILE *file = fopen(filename, ""r"");
    if (file != NULL) {
        char buffer[256];
        while (fgets(buffer, sizeof(buffer), file)) {
            printf(""%s"", buffer);
        }
        fclose(file);
    }
}",c,0
Clear,"import hashlib
import os

def hash_password(password):
    salt = os.urandom(32)
    key = hashlib.pbkdf2_hmac('sha256', password.encode(), salt, 100000)
    return salt + key","import hashlib
import os

def hash_password(password):
    salt = os.urandom(32)
    key = hashlib.pbkdf2_hmac('sha256', password.encode(), salt, 100000)
    return salt + key",python,0
Insecure Deserialization,"Sure, here is an example of Java code that demonstrates a vulnerability related to Insecure Deserialization:

```java
import java.io.ByteArrayInputStream;
import java.io.ObjectInputStream;

public class InsecureDeserializationDemo {

    public static void main(String[] args) {
        String userInput = ""rO0ABXNyAC5qYXZhLmV4YW1wbGUuUHJpb3JpdHlNYW5hZ2VDb25zdW1wdGlvbgAAAAAAAAABAgABSgAEa2V5TAAIZGVzdHN0cmVhbQACWwASZW1wdHQAEMjAwOC0xMC0yNwEAAAABc3IAIWNsdWRlLmNvbGxlY3Rpb25zLmNvcmUuRGF0YUNvbnN1bXB0aW9uAAAAAAAAAAAAAAA="";
        
        try {
            byte[] bytes = java.util.Base64.getDecoder().decode(userInput);
            ObjectInputStream ois = new ObjectInputStream(new ByteArrayInputStream(bytes));
            Object obj = ois.readObject();
            
            System.out.println(""Deserialized object: "" + obj","Sure, here is an example of Java code that demonstrates a vulnerability related to Insecure Deserialization: ```java import java.io.ByteArrayInputStream; import java.io.ObjectInputStream; public class InsecureDeserializationDemo { public static void main(String[] args) { String userInput = ""rO0ABXNyAC5qYXZhLmV4YW1wbGUuUHJpb3JpdHlNYW5hZ2VDb25zdW1wdGlvbgAAAAAAAAABAgABSgAEa2V5TAAIZGVzdHN0cmVhbQACWwASZW1wdHQAEMjAwOC0xMC0yNwEAAAABc3IAIWNsdWRlLmNvbGxlY3Rpb25zLmNvcmUuRGF0YUNvbnN1bXB0aW9uAAAAAAAAAAAAAAA=""; try { byte[] bytes = java.util.Base64.getDecoder().decode(userInput); ObjectInputStream ois = new ObjectInputStream(new ByteArrayInputStream(bytes)); Object obj = ois.readObject(); System.out.println(""Deserialized object: "" + obj",java,1
Clear,"#include <stdio.h>
#include <stdlib.h>

void safe_file_operation(const char *filename) {
    FILE *file = fopen(filename, ""r"");
    if (file != NULL) {
        char buffer[256];
        while (fgets(buffer, sizeof(buffer), file)) {
            printf(""%s"", buffer);
        }
        fclose(file);
    }
}","#include <stdio.h>
#include <stdlib.h>

void safe_file_operation(const char *filename) {
    FILE *file = fopen(filename, ""r"");
    if (file != NULL) {
        char buffer[256];
        while (fgets(buffer, sizeof(buffer), file)) {
            printf(""%s"", buffer);
        }
        fclose(file);
    }
}",c,0
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
SQL Injection,"import java.sql.*;

public class SQLInjectionExample {
    public static void main(String[] args) {
        String userInput = ""'; DROP TABLE users; --"";
        String query = ""SELECT * FROM users WHERE username = '"" + userInput + ""'"";

        try {
            Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");
            Statement stmt = conn.createStatement();
            ResultSet rs = stmt.executeQuery(query);

            while (rs.next()) {
                System.out.println(""User found: "" + rs.getString(""username""));
            }

            conn.close();
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.*; public class SQLInjectionExample { public static void main(String[] args) { String userInput = ""'; DROP TABLE users; --""; String query = ""SELECT * FROM users WHERE username = '"" + userInput + ""'""; try { Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); Statement stmt = conn.createStatement(); ResultSet rs = stmt.executeQuery(query); while (rs.next()) { System.out.println(""User found: "" + rs.getString(""username"")); } conn.close(); } catch (SQLException e) { e.printStackTrace(); } } }",java,1
Clear,"To make the code secure and prevent Insecure Deserialization vulnerabilities, you should implement the following security measures:

1. Use a whitelist approach: Only allow deserialization of specific classes that are known and trusted. Restrict the classes that can be deserialized to prevent malicious classes from being loaded.

2. Implement input validation: Validate the input file before deserializing it. Ensure that the file is coming from a trusted source and has not been tampered with.

3. Use a secure Deserialization mechanism: Consider using libraries or frameworks that provide secure deserialization mechanisms, such as serialization filters or custom deserialization methods.

Here is an updated version of your code snippet with these security measures implemented:

```java
import java.io.*;

public class SecureDeserializationExample {

    private static final String TRUSTED_CLASS = ""TrustedClass"";

    public static void main(String[] args) {
        String userInput = ""userInput.ser"";
        
        try {
            FileInputStream fileIn = new FileInputStream(userInput);
            ObjectInputStream in = new ObjectInputStream(fileIn) {
                @Override
                protected Class<?> resolveClass(ObjectStreamClass desc) throws IOException, ClassNotFoundException {
                    if (!desc.getName().equals(TRUSTED_CLASS)) {
                        throw new InvalidObject","To make the code secure and prevent Insecure Deserialization vulnerabilities, you should implement the following security measures: 1. Use a whitelist approach: Only allow deserialization of specific classes that are known and trusted. Restrict the classes that can be deserialized to prevent malicious classes from being loaded. 2. Implement input validation: Validate the input file before deserializing it. Ensure that the file is coming from a trusted source and has not been tampered with. 3. Use a secure Deserialization mechanism: Consider using libraries or frameworks that provide secure deserialization mechanisms, such as serialization filters or custom deserialization methods. Here is an updated version of your code snippet with these security measures implemented: ```java import java.io.*; public class SecureDeserializationExample { private static final String TRUSTED_CLASS = ""TrustedClass""; public static void main(String[] args) { String userInput = ""userInput.ser""; try { FileInputStream fileIn = new FileInputStream(userInput); ObjectInputStream in = new ObjectInputStream(fileIn) { @Override protected Class<?> resolveClass(ObjectStreamClass desc) throws IOException, ClassNotFoundException { if (!desc.getName().equals(TRUSTED_CLASS)) { throw new InvalidObject",java,0
Command Injection,"const shell = require('child_process');
shell.exec('ping ' + userInput); // Command Injection
","const shell = require('child_process');
shell.exec('ping ' + userInput); // Command Injection
",javascript,1
Clear,"import os
def safe_read_file(filename):
    base_path = '/var/www/uploads/'
    full_path = os.path.join(base_path, filename)
    full_path = os.path.normpath(full_path)
    if not full_path.startswith(base_path):
        raise ValueError(""Path traversal detected"")
    with open(full_path, 'r') as f:
        return f.read()","import os
def safe_read_file(filename):
    base_path = '/var/www/uploads/'
    full_path = os.path.join(base_path, filename)
    full_path = os.path.normpath(full_path)
    if not full_path.startswith(base_path):
        raise ValueError(""Path traversal detected"")
    with open(full_path, 'r') as f:
        return f.read()",python,0
SQL Injection,"app.get('/user/:id', (req, res) => {
    const query = `SELECT * FROM users WHERE id = ${req.params.id}`; // SQL Injection
    db.query(query, (err, result) => {
        res.json(result);
    });
});
","app.get('/user/:id', (req, res) => {
    const query = `SELECT * FROM users WHERE id = ${req.params.id}`; // SQL Injection
    db.query(query, (err, result) => {
        res.json(result);
    });
});
",javascript,1
Insecure Deserialization,"<?php
$data = $_POST['data'];
unserialize($data); // Insecure Deserialization
?>","<?php
$data = $_POST['data'];
unserialize($data); // Insecure Deserialization
?>",php,1
Clear,"#include <iostream>
#include <memory>

void safe_memory_management() {
    auto ptr = std::make_unique<int>(42);
    std::cout << *ptr << std::endl;
}","#include <iostream>
#include <memory>

void safe_memory_management() {
    auto ptr = std::make_unique<int>(42);
    std::cout << *ptr << std::endl;
}",cpp,0
Command Injection,"import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class CommandInjectionVulnerability {

    public static void main(String[] args) {
        try {
            BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));
            System.out.print(""Enter a command to execute: "");
            String userInput = reader.readLine();

            // Vulnerability: User input is directly passed to the Runtime.exec() method without proper validation
            Process process = Runtime.getRuntime().exec(""ls "" + userInput);

            BufferedReader outputReader = new BufferedReader(new InputStreamReader(process.getInputStream()));
            String line;
            while ((line = outputReader.readLine()) != null) {
                System.out.println(line);
            }

        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}","import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class CommandInjectionVulnerability { public static void main(String[] args) { try { BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a command to execute: ""); String userInput = reader.readLine(); // Vulnerability: User input is directly passed to the Runtime.exec() method without proper validation Process process = Runtime.getRuntime().exec(""ls "" + userInput); BufferedReader outputReader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = outputReader.readLine()) != null) { System.out.println(line); } } catch (IOException e) { e.printStackTrace(); } } }",java,1
Path Traversal,"import os
def read_file(filename):
    with open('/var/www/uploads/' + filename, 'r') as f:
        return f.read()","import os
def read_file(filename):
    with open('/var/www/uploads/' + filename, 'r') as f:
        return f.read()",python,1
Clear,"#include <stdio.h>
#include <string.h>

void safe_string_copy(char *dest, const char *src, size_t dest_size) {
    if (dest_size > 0) {
        strncpy(dest, src, dest_size - 1);
        dest[dest_size - 1] = '\0';
    }
}","#include <stdio.h>
#include <string.h>

void safe_string_copy(char *dest, const char *src, size_t dest_size) {
    if (dest_size > 0) {
        strncpy(dest, src, dest_size - 1);
        dest[dest_size - 1] = '\0';
    }
}",c,0
Clear,"#include <stdio.h>
#include <string.h>

void safe_string_copy(char *dest, const char *src, size_t dest_size) {
    if (dest_size > 0) {
        strncpy(dest, src, dest_size - 1);
        dest[dest_size - 1] = '\0';
    }
}","#include <stdio.h>
#include <string.h>

void safe_string_copy(char *dest, const char *src, size_t dest_size) {
    if (dest_size > 0) {
        strncpy(dest, src, dest_size - 1);
        dest[dest_size - 1] = '\0';
    }
}",c,0
SQL Injection,"import mysql.connector
def search_products(category):
    db = mysql.connector.connect(host=""localhost"", user=""user"", password=""pass"", database=""shop"")
    cursor = db.cursor()
    cursor.execute(""SELECT * FROM products WHERE category = '%s'"" % category)
    return cursor.fetchall()","import mysql.connector
def search_products(category):
    db = mysql.connector.connect(host=""localhost"", user=""user"", password=""pass"", database=""shop"")
    cursor = db.cursor()
    cursor.execute(""SELECT * FROM products WHERE category = '%s'"" % category)
    return cursor.fetchall()",python,1
SQL Injection,"app.get('/user/:id', (req, res) => {
    const query = `SELECT * FROM users WHERE id = ${req.params.id}`; // SQL Injection
    db.query(query, (err, result) => {
        res.json(result);
    });
});
","app.get('/user/:id', (req, res) => {
    const query = `SELECT * FROM users WHERE id = ${req.params.id}`; // SQL Injection
    db.query(query, (err, result) => {
        res.json(result);
    });
});
",javascript,1
Clear,"#include <iostream>
#include <fstream>
#include <string>

void safe_file_reading(const std::string& filename) {
    std::ifstream file(filename);
    if (file.is_open()) {
        std::string line;
        while (std::getline(file, line)) {
            std::cout << line << std::endl;
        }
    }
}","#include <iostream>
#include <fstream>
#include <string>

void safe_file_reading(const std::string& filename) {
    std::ifstream file(filename);
    if (file.is_open()) {
        std::string line;
        while (std::getline(file, line)) {
            std::cout << line << std::endl;
        }
    }
}",cpp,0
Cross-Site Scripting (XSS),"import java.io.*;
import javax.servlet.*;
import javax.servlet.http.*;

public class VulnerableServlet extends HttpServlet {
    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        String userInput = request.getParameter(""input"");
        String output = ""Hello, "" + userInput + ""!"";
        
        PrintWriter out = response.getWriter();
        out.println(""<html>"");
        out.println(""<body>"");
        out.println(""<h1>"" + output + ""</h1>"");
        out.println(""</body>"");
        out.println(""</html>"");
    }
}","import java.io.*; import javax.servlet.*; import javax.servlet.http.*; public class VulnerableServlet extends HttpServlet { protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { String userInput = request.getParameter(""input""); String output = ""Hello, "" + userInput + ""!""; PrintWriter out = response.getWriter(); out.println(""<html>""); out.println(""<body>""); out.println(""<h1>"" + output + ""</h1>""); out.println(""</body>""); out.println(""</html>""); } }",java,1
Clear,"import org.owasp.encoder.Encode;

import java.io.IOException;
import java.io.PrintWriter;

public class XSSSecureCode {

    public static void main(String[] args) {
        String userInput = ""<script>alert('XSS Vulnerability')</script>"";

        // Properly escaping user input to prevent XSS
        String output = ""<p>Welcome, "" + Encode.forHtml(userInput) + ""</p>"";

        try {
            // Simulating output to a webpage
            PrintWriter out = new PrintWriter(""output.html"");
            out.println(output);
            out.close();
            System.out.println(""Output written to output.html"");
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}","import org.owasp.encoder.Encode; import java.io.IOException; import java.io.PrintWriter; public class XSSSecureCode { public static void main(String[] args) { String userInput = ""<script>alert('XSS Vulnerability')</script>""; // Properly escaping user input to prevent XSS String output = ""<p>Welcome, "" + Encode.forHtml(userInput) + ""</p>""; try { // Simulating output to a webpage PrintWriter out = new PrintWriter(""output.html""); out.println(output); out.close(); System.out.println(""Output written to output.html""); } catch (IOException e) { e.printStackTrace(); } } }",java,0
Clear,"import java.io.*;
import javax.servlet.*;
import javax.servlet.http.*;
import org.owasp.encoder.Encode;

public class XSSFixedServlet extends HttpServlet {
    protected void doGet(HttpServletRequest request, HttpServletResponse response)
            throws ServletException, IOException {
        String userInput = request.getParameter(""input"");
        
        // Properly sanitize user input using OWASP Java Encoder library
        String sanitizedInput = Encode.forHtml(userInput);
        
        PrintWriter out = response.getWriter();
        out.println(""<html>"");
        out.println(""<body>"");
        out.println(""<h1>Hello "" + sanitizedInput + ""</h1>"");
        out.println(""</body>"");
        out.println(""</html>"");
    }
}","import java.io.*; import javax.servlet.*; import javax.servlet.http.*; import org.owasp.encoder.Encode; public class XSSFixedServlet extends HttpServlet { protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { String userInput = request.getParameter(""input""); // Properly sanitize user input using OWASP Java Encoder library String sanitizedInput = Encode.forHtml(userInput); PrintWriter out = response.getWriter(); out.println(""<html>""); out.println(""<body>""); out.println(""<h1>Hello "" + sanitizedInput + ""</h1>""); out.println(""</body>""); out.println(""</html>""); } }",java,0
Clear,"To prevent Cross-Site Scripting (XSS) attacks, you should properly sanitize and encode any user input before displaying it in the response. One way to achieve this is by using OWASP's ESAPI library for encoding user input.

Here's the updated code snippet that implements proper security measures to prevent XSS:

```java
import java.io.IOException;
import java.io.PrintWriter;
import org.owasp.esapi.ESAPI;
import org.owasp.esapi.codecs.HTMLEntityCodec;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

public class XSSFixedServlet extends HttpServlet {

    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws IOException {
        String userInput = request.getParameter(""input"");
        PrintWriter out = response.getWriter();
        
        // Sanitize and encode user input to prevent XSS
        HTMLEntityCodec codec = new HTMLEntityCodec();
        String safeUserInput = codec.encodeForHTML(userInput);
        
        out.println(""<html>"");
        out.println(""<head><title>Secure Page</title></head>"");
        out.println(""<body>"");
        out.println(""<h1>User Input: "" + safeUserInput + ""</h1>"");
        out.println(""</body>"");","To prevent Cross-Site Scripting (XSS) attacks, you should properly sanitize and encode any user input before displaying it in the response. One way to achieve this is by using OWASP's ESAPI library for encoding user input. Here's the updated code snippet that implements proper security measures to prevent XSS: ```java import java.io.IOException; import java.io.PrintWriter; import org.owasp.esapi.ESAPI; import org.owasp.esapi.codecs.HTMLEntityCodec; import javax.servlet.http.HttpServlet; import javax.servlet.http.HttpServletRequest; import javax.servlet.http.HttpServletResponse; public class XSSFixedServlet extends HttpServlet { protected void doGet(HttpServletRequest request, HttpServletResponse response) throws IOException { String userInput = request.getParameter(""input""); PrintWriter out = response.getWriter(); // Sanitize and encode user input to prevent XSS HTMLEntityCodec codec = new HTMLEntityCodec(); String safeUserInput = codec.encodeForHTML(userInput); out.println(""<html>""); out.println(""<head><title>Secure Page</title></head>""); out.println(""<body>""); out.println(""<h1>User Input: "" + safeUserInput + ""</h1>""); out.println(""</body>"");",java,0
Clear,"import requests
def safe_api_call():
    api_key = os.environ.get('API_KEY')
    headers = {'Authorization': f'Bearer {api_key}'}
    return requests.get('https://api.example.com/data', headers=headers)","import requests
def safe_api_call():
    api_key = os.environ.get('API_KEY')
    headers = {'Authorization': f'Bearer {api_key}'}
    return requests.get('https://api.example.com/data', headers=headers)",python,0
Clear,"<?php
$username = $_POST['username'];
$stmt = $pdo->prepare(""SELECT * FROM users WHERE username = ?"");
$stmt->execute([$username]); // Parameterized query
?>","<?php
$username = $_POST['username'];
$stmt = $pdo->prepare(""SELECT * FROM users WHERE username = ?"");
$stmt->execute([$username]); // Parameterized query
?>",php,0
Clear,"import java.io.*;

public class CommandInjectionSecure {
    public static void main(String[] args) {
        try {
            BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));
            
            System.out.print(""Enter a command to execute: "");
            String command = reader.readLine();
            
            ProcessBuilder processBuilder = new ProcessBuilder(""ping"", ""-c"", ""3"", command);
            Process process = processBuilder.start();
            
            BufferedReader inputReader = new BufferedReader(new InputStreamReader(process.getInputStream()));
            
            String line;
            while ((line = inputReader.readLine()) != null) {
                System.out.println(line);
            }
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}","import java.io.*; public class CommandInjectionSecure { public static void main(String[] args) { try { BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a command to execute: ""); String command = reader.readLine(); ProcessBuilder processBuilder = new ProcessBuilder(""ping"", ""-c"", ""3"", command); Process process = processBuilder.start(); BufferedReader inputReader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = inputReader.readLine()) != null) { System.out.println(line); } } catch (IOException e) { e.printStackTrace(); } } }",java,0
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Clear,"import tempfile
import os

def create_secure_temp(data):
    with tempfile.NamedTemporaryFile(mode='w', delete=True, suffix='.tmp') as temp:
        temp.write(data)
        temp.flush()
        return temp.name","import tempfile
import os

def create_secure_temp(data):
    with tempfile.NamedTemporaryFile(mode='w', delete=True, suffix='.tmp') as temp:
        temp.write(data)
        temp.flush()
        return temp.name",python,0
XSS,"const userInput = document.location.search.split('=')[1];
document.write(userInput); // XSS
","const userInput = document.location.search.split('=')[1];
document.write(userInput); // XSS
",javascript,1
Buffer Overflow,"#include <iostream>
#include <cstring>

void unsafe_c_string(char* input) {
    char buffer[100];
    strcpy(buffer, input); // potential buffer overflow
    std::cout << buffer << std::endl;
}","#include <iostream>
#include <cstring>

void unsafe_c_string(char* input) {
    char buffer[100];
    strcpy(buffer, input); // potential buffer overflow
    std::cout << buffer << std::endl;
}",cpp,1
Clear,"import java.io.IOException;
import javax.servlet.ServletException;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

public class SecureServlet extends HttpServlet {
    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        String userInput = request.getParameter(""input"");
        String sanitizedInput = sanitizeUserInput(userInput);
        String encodedOutput = encodeOutput(sanitizedInput);

        response.setContentType(""text/html"");
        response.getWriter().println(encodedOutput);
    }

    private String sanitizeUserInput(String input) {
        // Implement your sanitization logic here (e.g., escaping special characters)
        return input.replaceAll(""<"", ""&lt;"").replaceAll("">"", ""&gt;"");
    }

    private String encodeOutput(String output) {
        // Implement proper encoding to prevent XSS attacks
        return ""<div>"" + output + ""</div>"";
    }
}","import java.io.IOException; import javax.servlet.ServletException; import javax.servlet.http.HttpServlet; import javax.servlet.http.HttpServletRequest; import javax.servlet.http.HttpServletResponse; public class SecureServlet extends HttpServlet { protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { String userInput = request.getParameter(""input""); String sanitizedInput = sanitizeUserInput(userInput); String encodedOutput = encodeOutput(sanitizedInput); response.setContentType(""text/html""); response.getWriter().println(encodedOutput); } private String sanitizeUserInput(String input) { // Implement your sanitization logic here (e.g., escaping special characters) return input.replaceAll(""<"", ""&lt;"").replaceAll("">"", ""&gt;""); } private String encodeOutput(String output) { // Implement proper encoding to prevent XSS attacks return ""<div>"" + output + ""</div>""; } }",java,0
Clear,"import java.util.Scanner;

public class SecureBufferHandling {
    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        System.out.print(""Enter a string: "");
        String userInput = scanner.nextLine();
        
        // Validate input length to prevent buffer overflow
        if (userInput.length() > 10) {
            System.out.println(""Input string exceeds buffer size limit."");
            return;
        }
        
        char[] buffer = new char[10];
        
        // Copy the input string into the buffer
        userInput.getChars(0, Math.min(userInput.length(), buffer.length), buffer, 0);
        
        System.out.println(""Buffer content: "" + new String(buffer));
    }
}","import java.util.Scanner; public class SecureBufferHandling { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter a string: ""); String userInput = scanner.nextLine(); // Validate input length to prevent buffer overflow if (userInput.length() > 10) { System.out.println(""Input string exceeds buffer size limit.""); return; } char[] buffer = new char[10]; // Copy the input string into the buffer userInput.getChars(0, Math.min(userInput.length(), buffer.length), buffer, 0); System.out.println(""Buffer content: "" + new String(buffer)); } }",java,0
Clear,"import java.util.Scanner;

public class SecureBufferExample {

    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);

        System.out.print(""Enter your name: "");
        String name = scanner.nextLine();

        int maxLength = 10;
        
        if (name.length() <= maxLength) {
            System.out.println(""Hello, "" + name);
        } else {
            System.out.println(""Input too long!"");
        }
    }
}","import java.util.Scanner; public class SecureBufferExample { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter your name: ""); String name = scanner.nextLine(); int maxLength = 10; if (name.length() <= maxLength) { System.out.println(""Hello, "" + name); } else { System.out.println(""Input too long!""); } } }",java,0
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Clear,"import os
def safe_read_file(filename):
    base_path = '/var/www/uploads/'
    full_path = os.path.join(base_path, filename)
    full_path = os.path.normpath(full_path)
    if not full_path.startswith(base_path):
        raise ValueError(""Path traversal detected"")
    with open(full_path, 'r') as f:
        return f.read()","import os
def safe_read_file(filename):
    base_path = '/var/www/uploads/'
    full_path = os.path.join(base_path, filename)
    full_path = os.path.normpath(full_path)
    if not full_path.startswith(base_path):
        raise ValueError(""Path traversal detected"")
    with open(full_path, 'r') as f:
        return f.read()",python,0
Clear,"#include <stdio.h>
#include <string.h>

int safe_buffer_operation(char *input) {
    char buffer[100];
    if (strlen(input) < sizeof(buffer)) {
        strcpy(buffer, input);
        return 0;
    }
    return -1; // buffer too small
}","#include <stdio.h>
#include <string.h>

int safe_buffer_operation(char *input) {
    char buffer[100];
    if (strlen(input) < sizeof(buffer)) {
        strcpy(buffer, input);
        return 0;
    }
    return -1; // buffer too small
}",c,0
Cross-Site Scripting (XSS),"import java.io.*;
import javax.servlet.*;
import javax.servlet.http.*;

public class XSSVulnerableServlet extends HttpServlet {
    protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        String userInput = request.getParameter(""input"");
        String output = ""Hello, "" + userInput + ""!"";

        response.setContentType(""text/html"");
        PrintWriter out = response.getWriter();
        out.println(""<html><body>"");
        out.println(""<h1>"" + output + ""</h1>"");
        out.println(""</body></html>"");
    }
}","import java.io.*; import javax.servlet.*; import javax.servlet.http.*; public class XSSVulnerableServlet extends HttpServlet { protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { String userInput = request.getParameter(""input""); String output = ""Hello, "" + userInput + ""!""; response.setContentType(""text/html""); PrintWriter out = response.getWriter(); out.println(""<html><body>""); out.println(""<h1>"" + output + ""</h1>""); out.println(""</body></html>""); } }",java,1
Clear,"To fix the Command Injection vulnerability in the provided Java code, you should properly sanitize and validate the input command before executing it. One approach to mitigate command injection vulnerabilities is to use `ProcessBuilder` instead of `Runtime.exec()` as it provides more control and helps prevent injection attacks.

Here is an updated version of the code that addresses the vulnerability:

```java
import java.io.*;

public class SecureCommandExecution {
    public static void main(String[] args) {
        try {
            BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));
            System.out.print(""Enter a command to execute: "");
            String command = reader.readLine();

            // Validate the input command
            if (!isValidCommand(command)) {
                System.out.println(""Invalid command. Please try again."");
                return;
            }

            // Use ProcessBuilder to execute the command
            ProcessBuilder processBuilder = new ProcessBuilder(command.split("" ""));
            Process process = processBuilder.start();

            BufferedReader inputReader = new BufferedReader(new InputStreamReader(process.getInputStream()));
            String line;
            while ((line = inputReader.readLine()) != null) {
                System.out.println(line);
            }
        } catch (IOException e) {
            e.printStackTrace();
        }
    }

    // Validate the input command to prevent command","To fix the Command Injection vulnerability in the provided Java code, you should properly sanitize and validate the input command before executing it. One approach to mitigate command injection vulnerabilities is to use `ProcessBuilder` instead of `Runtime.exec()` as it provides more control and helps prevent injection attacks. Here is an updated version of the code that addresses the vulnerability: ```java import java.io.*; public class SecureCommandExecution { public static void main(String[] args) { try { BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a command to execute: ""); String command = reader.readLine(); // Validate the input command if (!isValidCommand(command)) { System.out.println(""Invalid command. Please try again.""); return; } // Use ProcessBuilder to execute the command ProcessBuilder processBuilder = new ProcessBuilder(command.split("" "")); Process process = processBuilder.start(); BufferedReader inputReader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = inputReader.readLine()) != null) { System.out.println(line); } } catch (IOException e) { e.printStackTrace(); } } // Validate the input command to prevent command",java,0
Command Injection,"import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class CommandInjectionVulnerable {
    public static void main(String[] args) {
        try {
            BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));
            System.out.print(""Enter a command to execute: "");
            String userInput = reader.readLine();

            // Vulnerable code - directly executing user input as a command
            Process process = Runtime.getRuntime().exec(userInput);

            BufferedReader inputStreamReader = new BufferedReader(new InputStreamReader(process.getInputStream()));
            String line;
            while ((line = inputStreamReader.readLine()) != null) {
                System.out.println(line);
            }
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}","import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class CommandInjectionVulnerable { public static void main(String[] args) { try { BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a command to execute: ""); String userInput = reader.readLine(); // Vulnerable code - directly executing user input as a command Process process = Runtime.getRuntime().exec(userInput); BufferedReader inputStreamReader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = inputStreamReader.readLine()) != null) { System.out.println(line); } } catch (IOException e) { e.printStackTrace(); } } }",java,1
Memory Corruption,"#include <iostream>

void unsafe_virtual_call() {
    // Potential vtable corruption vulnerability
    class Base {
    public:
        virtual void func() { std::cout << ""Base"" << std::endl; }
    };
    
    class Derived : public Base {
    public:
        void func() override { std::cout << ""Derived"" << std::endl; }
    };
}","#include <iostream>

void unsafe_virtual_call() {
    // Potential vtable corruption vulnerability
    class Base {
    public:
        virtual void func() { std::cout << ""Base"" << std::endl; }
    };
    
    class Derived : public Base {
    public:
        void func() override { std::cout << ""Derived"" << std::endl; }
    };
}",cpp,1
Clear,"#include <stdio.h>
#include <stdlib.h>

void safe_file_operation(const char *filename) {
    FILE *file = fopen(filename, ""r"");
    if (file != NULL) {
        char buffer[256];
        while (fgets(buffer, sizeof(buffer), file)) {
            printf(""%s"", buffer);
        }
        fclose(file);
    }
}","#include <stdio.h>
#include <stdlib.h>

void safe_file_operation(const char *filename) {
    FILE *file = fopen(filename, ""r"");
    if (file != NULL) {
        char buffer[256];
        while (fgets(buffer, sizeof(buffer), file)) {
            printf(""%s"", buffer);
        }
        fclose(file);
    }
}",c,0
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Clear,"import os
def secure_file_access(username, filepath):
    base_dir = f""/home/{username}/files/""
    full_path = os.path.join(base_dir, filepath)
    full_path = os.path.normpath(full_path)
    if not full_path.startswith(base_dir):
        raise PermissionError(""Access denied"")
    with open(full_path, 'r') as f:
        return f.read()","import os
def secure_file_access(username, filepath):
    base_dir = f""/home/{username}/files/""
    full_path = os.path.join(base_dir, filepath)
    full_path = os.path.normpath(full_path)
    if not full_path.startswith(base_dir):
        raise PermissionError(""Access denied"")
    with open(full_path, 'r') as f:
        return f.read()",python,0
XSS,"<?php
echo $_GET['message']; // XSS
?>","<?php
echo $_GET['message']; // XSS
?>",php,1
Clear,"const token = process.env.API_TOKEN; // Environment variable
fetch('/api/data', {
    headers: { 'Authorization': `Bearer ${token}` }
});
","const token = process.env.API_TOKEN; // Environment variable
fetch('/api/data', {
    headers: { 'Authorization': `Bearer ${token}` }
});
",javascript,0
Command Injection,"<?php
$cmd = $_GET['cmd'];
system($cmd); // Command Injection
?>","<?php
$cmd = $_GET['cmd'];
system($cmd); // Command Injection
?>",php,1
Clear,"import subprocess
def safe_directory_listing(path):
    result = subprocess.run(['ls', path], capture_output=True, text=True)
    return result.stdout","import subprocess
def safe_directory_listing(path):
    result = subprocess.run(['ls', path], capture_output=True, text=True)
    return result.stdout",python,0
SQL Injection,"import sqlite3
def get_user_data(username):
    conn = sqlite3.connect('database.db')
    cursor = conn.cursor()
    query = ""SELECT * FROM users WHERE username = '"" + username + ""'""
    cursor.execute(query)
    return cursor.fetchall()","import sqlite3
def get_user_data(username):
    conn = sqlite3.connect('database.db')
    cursor = conn.cursor()
    query = ""SELECT * FROM users WHERE username = '"" + username + ""'""
    cursor.execute(query)
    return cursor.fetchall()",python,1
SQL Injection,"app.get('/user/:id', (req, res) => {
    const query = `SELECT * FROM users WHERE id = ${req.params.id}`; // SQL Injection
    db.query(query, (err, result) => {
        res.json(result);
    });
});
","app.get('/user/:id', (req, res) => {
    const query = `SELECT * FROM users WHERE id = ${req.params.id}`; // SQL Injection
    db.query(query, (err, result) => {
        res.json(result);
    });
});
",javascript,1
Clear,"#include <iostream>
#include <sstream>

int safe_string_to_int(const std::string& str) {
    std::stringstream ss(str);
    int value;
    if (ss >> value) {
        return value;
    }
    throw std::invalid_argument(""Invalid integer"");
}","#include <iostream>
#include <sstream>

int safe_string_to_int(const std::string& str) {
    std::stringstream ss(str);
    int value;
    if (ss >> value) {
        return value;
    }
    throw std::invalid_argument(""Invalid integer"");
}",cpp,0
Clear,"To fix the Path Traversal vulnerability in the given Java code snippet, you can ensure that the input file name provided by the user is within a specific directory or path. You can achieve this by validating and sanitizing the input file name to prevent malicious users from accessing files outside of the intended directory.

Here is an updated version of the code with proper security measures implemented:

```java
import java.io.File;
import java.io.IOException;
import java.nio.file.Files;
import java.nio.file.Paths;
import java.util.Scanner;

public class SecurePathTraversal {
    private static final String BASE_DIRECTORY = ""/path/to/secure/directory/"";

    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        System.out.print(""Enter a file name: "");
        String fileName = scanner.nextLine();

        // Validate and sanitize input file name to prevent path traversal
        if (!isValidFileName(fileName)) {
            System.out.println(""Invalid file name."");
            return;
        }

        File file = new File(BASE_DIRECTORY + fileName);

        if (file.exists()) {
            try {
                byte[] fileContent = Files.readAllBytes(Paths.get(file.toURI()));
                System.out.println(""File content: "" + new String(fileContent","To fix the Path Traversal vulnerability in the given Java code snippet, you can ensure that the input file name provided by the user is within a specific directory or path. You can achieve this by validating and sanitizing the input file name to prevent malicious users from accessing files outside of the intended directory. Here is an updated version of the code with proper security measures implemented: ```java import java.io.File; import java.io.IOException; import java.nio.file.Files; import java.nio.file.Paths; import java.util.Scanner; public class SecurePathTraversal { private static final String BASE_DIRECTORY = ""/path/to/secure/directory/""; public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter a file name: ""); String fileName = scanner.nextLine(); // Validate and sanitize input file name to prevent path traversal if (!isValidFileName(fileName)) { System.out.println(""Invalid file name.""); return; } File file = new File(BASE_DIRECTORY + fileName); if (file.exists()) { try { byte[] fileContent = Files.readAllBytes(Paths.get(file.toURI())); System.out.println(""File content: "" + new String(fileContent",java,0
SSRF,"import requests
def fetch_url(url):
    return requests.get(url).text","import requests
def fetch_url(url):
    return requests.get(url).text",python,1
Command Injection,"import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class CommandInjectionDemo {
    public static void main(String[] args) throws IOException {
        BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));
        
        System.out.print(""Enter the name of the file to display its content: "");
        String fileName = reader.readLine();
        
        // Vulnerable code - user input is directly passed to execute the command
        Process process = Runtime.getRuntime().exec(""cat "" + fileName);
        
        BufferedReader outputReader = new BufferedReader(new InputStreamReader(process.getInputStream()));
        String line;
        
        while ((line = outputReader.readLine()) != null) {
            System.out.println(line);
        }
    }
}","import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class CommandInjectionDemo { public static void main(String[] args) throws IOException { BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter the name of the file to display its content: ""); String fileName = reader.readLine(); // Vulnerable code - user input is directly passed to execute the command Process process = Runtime.getRuntime().exec(""cat "" + fileName); BufferedReader outputReader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = outputReader.readLine()) != null) { System.out.println(line); } } }",java,1
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Clear,"import java.io.*;
import java.util.Scanner;
import org.apache.commons.text.StringEscapeUtils;

public class XSSFixedCode {
    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        
        System.out.print(""Enter your name: "");
        String userInput = scanner.nextLine();
        
        String sanitizedInput = StringEscapeUtils.escapeHtml4(userInput); // Sanitize user input
        
        String welcomeMessage = ""Hello, "" + sanitizedInput + ""! Welcome to our website."";
        
        System.out.println(welcomeMessage);
    }
}","import java.io.*; import java.util.Scanner; import org.apache.commons.text.StringEscapeUtils; public class XSSFixedCode { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter your name: ""); String userInput = scanner.nextLine(); String sanitizedInput = StringEscapeUtils.escapeHtml4(userInput); // Sanitize user input String welcomeMessage = ""Hello, "" + sanitizedInput + ""! Welcome to our website.""; System.out.println(welcomeMessage); } }",java,0
Memory Corruption,"#include <iostream>

void unsafe_virtual_call() {
    // Potential vtable corruption vulnerability
    class Base {
    public:
        virtual void func() { std::cout << ""Base"" << std::endl; }
    };
    
    class Derived : public Base {
    public:
        void func() override { std::cout << ""Derived"" << std::endl; }
    };
}","#include <iostream>

void unsafe_virtual_call() {
    // Potential vtable corruption vulnerability
    class Base {
    public:
        virtual void func() { std::cout << ""Base"" << std::endl; }
    };
    
    class Derived : public Base {
    public:
        void func() override { std::cout << ""Derived"" << std::endl; }
    };
}",cpp,1
Hardcoded Secrets,"localStorage.setItem('token', 'hardcoded-secret-token-123'); // Hardcoded secret
","localStorage.setItem('token', 'hardcoded-secret-token-123'); // Hardcoded secret
",javascript,1
Clear,"<?php
$username = $_POST['username'];
$stmt = $pdo->prepare(""SELECT * FROM users WHERE username = ?"");
$stmt->execute([$username]); // Parameterized query
?>","<?php
$username = $_POST['username'];
$stmt = $pdo->prepare(""SELECT * FROM users WHERE username = ?"");
$stmt->execute([$username]); // Parameterized query
?>",php,0
Clear,"const userData = JSON.parse(userInput); // Safe JSON parsing
if (userData && typeof userData === 'object') {
    processUserData(userData);
}
","const userData = JSON.parse(userInput); // Safe JSON parsing
if (userData && typeof userData === 'object') {
    processUserData(userData);
}
",javascript,0
Insecure Deserialization,"<?php
$data = $_POST['data'];
unserialize($data); // Insecure Deserialization
?>","<?php
$data = $_POST['data'];
unserialize($data); // Insecure Deserialization
?>",php,1
Clear,"#include <iostream>
#include <memory>

void safe_memory_management() {
    auto ptr = std::make_unique<int>(42);
    std::cout << *ptr << std::endl;
}","#include <iostream>
#include <memory>

void safe_memory_management() {
    auto ptr = std::make_unique<int>(42);
    std::cout << *ptr << std::endl;
}",cpp,0
Clear,"#include <stdio.h>
#include <string.h>

int safe_buffer_operation(char *input) {
    char buffer[100];
    if (strlen(input) < sizeof(buffer)) {
        strcpy(buffer, input);
        return 0;
    }
    return -1; // buffer too small
}","#include <stdio.h>
#include <string.h>

int safe_buffer_operation(char *input) {
    char buffer[100];
    if (strlen(input) < sizeof(buffer)) {
        strcpy(buffer, input);
        return 0;
    }
    return -1; // buffer too small
}",c,0
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Clear,"To fix the XSS vulnerability in the provided Java code, you need to ensure that user input is properly encoded before being reflected back in the response. Here's an improved version of the code that uses proper encoding to prevent XSS attacks:

```java
import java.io.IOException;
import java.io.PrintWriter;
import org.apache.commons.text.StringEscapeUtils;

public class XSSFixedCode {

    public static void main(String[] args) {
        String userInput = ""<script>alert('XSS Vulnerability')</script>"";
        
        // Properly encoding user input to prevent XSS attacks
        String encodedUserInput = StringEscapeUtils.escapeHtml4(userInput);
        
        System.out.println(""User Input: "" + userInput);
        
        // Generating output with properly encoded user input
        try {
            PrintWriter out = new PrintWriter(""output.html"");
            out.println(""<html>"");
            out.println(""<body>"");
            out.println(""<h1>User Input:</h1>"");
            out.println(""<p>"" + encodedUserInput + ""</p>"");  // Fixed code
            out.println(""</body>"");
            out.println(""</html>"");
            out.close();
            
            System.out.println(""Output generated successfully in output.html"");
        } catch (IOException e) {
            e.printStackTrace();","To fix the XSS vulnerability in the provided Java code, you need to ensure that user input is properly encoded before being reflected back in the response. Here's an improved version of the code that uses proper encoding to prevent XSS attacks: ```java import java.io.IOException; import java.io.PrintWriter; import org.apache.commons.text.StringEscapeUtils; public class XSSFixedCode { public static void main(String[] args) { String userInput = ""<script>alert('XSS Vulnerability')</script>""; // Properly encoding user input to prevent XSS attacks String encodedUserInput = StringEscapeUtils.escapeHtml4(userInput); System.out.println(""User Input: "" + userInput); // Generating output with properly encoded user input try { PrintWriter out = new PrintWriter(""output.html""); out.println(""<html>""); out.println(""<body>""); out.println(""<h1>User Input:</h1>""); out.println(""<p>"" + encodedUserInput + ""</p>""); // Fixed code out.println(""</body>""); out.println(""</html>""); out.close(); System.out.println(""Output generated successfully in output.html""); } catch (IOException e) { e.printStackTrace();",java,0
Clear,"def validate_input(input_str):
    if not isinstance(input_str, str):
        raise TypeError(""Input must be string"")
    if len(input_str) > 100:
        raise ValueError(""Input too long"")
    if '<script>' in input_str.lower():
        raise ValueError(""Invalid input"")
    return input_str.strip()","def validate_input(input_str):
    if not isinstance(input_str, str):
        raise TypeError(""Input must be string"")
    if len(input_str) > 100:
        raise ValueError(""Input too long"")
    if '<script>' in input_str.lower():
        raise ValueError(""Invalid input"")
    return input_str.strip()",python,0
Clear,"def safe_division(a, b):
    if b == 0:
        raise ValueError(""Division by zero"")
    return a / b","def safe_division(a, b):
    if b == 0:
        raise ValueError(""Division by zero"")
    return a / b",python,0
Clear,"import java.sql.*;

public class SQLInjectionSecure {

    public static void main(String[] args) {
        String userInput = ""'; DROP TABLE users; --""; // User input with malicious intent

        try {
            Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");
            
            // Use PreparedStatement to create a parameterized query
            String query = ""SELECT * FROM users WHERE username = ?"";
            PreparedStatement stmt = conn.prepareStatement(query);
            stmt.setString(1, userInput);

            ResultSet rs = stmt.executeQuery();

            while (rs.next()) {
                System.out.println(""User: "" + rs.getString(""username""));
            }

            conn.close();
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.*; public class SQLInjectionSecure { public static void main(String[] args) { String userInput = ""'; DROP TABLE users; --""; // User input with malicious intent try { Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); // Use PreparedStatement to create a parameterized query String query = ""SELECT * FROM users WHERE username = ?""; PreparedStatement stmt = conn.prepareStatement(query); stmt.setString(1, userInput); ResultSet rs = stmt.executeQuery(); while (rs.next()) { System.out.println(""User: "" + rs.getString(""username"")); } conn.close(); } catch (SQLException e) { e.printStackTrace(); } } }",java,0
Clear,"To fix the Command Injection vulnerability in the provided Java code snippet, you should avoid directly concatenating user input into the command executed by `Runtime.exec()`. Instead, you should properly sanitize and validate user input to prevent malicious commands from being injected.

Here is an updated and more secure version of the code that uses `ProcessBuilder` to execute commands in a safer manner:

```java
import java.io.*;

public class SecureCommandExecution {
    public static void main(String[] args) {
        try {
            BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));
            System.out.print(""Enter a command to execute: "");
            String userInput = reader.readLine();

            // Sanitize user input to prevent command injection
            if (!isValidInput(userInput)) {
                System.out.println(""Invalid input. Please try again."");
                return;
            }

            ProcessBuilder processBuilder = new ProcessBuilder(""ping"", userInput);
            Process process = processBuilder.start();

            BufferedReader inputReader = new BufferedReader(new InputStreamReader(process.getInputStream()));
            String line;
            while ((line = inputReader.readLine()) != null) {
                System.out.println(line);
            }
        } catch (IOException e) {
            e.printStackTrace();
        }
    }

    private static boolean isValidInput(String userInput","To fix the Command Injection vulnerability in the provided Java code snippet, you should avoid directly concatenating user input into the command executed by `Runtime.exec()`. Instead, you should properly sanitize and validate user input to prevent malicious commands from being injected. Here is an updated and more secure version of the code that uses `ProcessBuilder` to execute commands in a safer manner: ```java import java.io.*; public class SecureCommandExecution { public static void main(String[] args) { try { BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a command to execute: ""); String userInput = reader.readLine(); // Sanitize user input to prevent command injection if (!isValidInput(userInput)) { System.out.println(""Invalid input. Please try again.""); return; } ProcessBuilder processBuilder = new ProcessBuilder(""ping"", userInput); Process process = processBuilder.start(); BufferedReader inputReader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = inputReader.readLine()) != null) { System.out.println(line); } } catch (IOException e) { e.printStackTrace(); } } private static boolean isValidInput(String userInput",java,0
Clear,"import java.io.IOException;
import java.io.PrintWriter;
import org.owasp.encoder.Encode;

public class XSSFixedCode {

    public static void main(String[] args) throws IOException {
        String userInput = ""<script>alert('XSS Attack!')</script>"";

        PrintWriter out = new PrintWriter(""output.html"");
        out.println(""<html>"");
        out.println(""<body>"");
        out.println(""<p>User Input: "" + Encode.forHtml(userInput) + ""</p>""); // Properly encode user input
        out.println(""</body>"");
        out.println(""</html>"");

        out.close();
    }
}","import java.io.IOException; import java.io.PrintWriter; import org.owasp.encoder.Encode; public class XSSFixedCode { public static void main(String[] args) throws IOException { String userInput = ""<script>alert('XSS Attack!')</script>""; PrintWriter out = new PrintWriter(""output.html""); out.println(""<html>""); out.println(""<body>""); out.println(""<p>User Input: "" + Encode.forHtml(userInput) + ""</p>""); // Properly encode user input out.println(""</body>""); out.println(""</html>""); out.close(); } }",java,0
Path Traversal,"import java.io.File;
import java.io.FileInputStream;
import java.io.IOException;
import java.util.Scanner;

public class PathTraversalExample {

    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        
        System.out.print(""Enter file path: "");
        String filePath = scanner.nextLine();
        
        File file = new File(filePath);
        
        try (FileInputStream fis = new FileInputStream(file)) {
            int content;
            while ((content = fis.read()) != -1) {
                System.out.print((char) content);
            }
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}","import java.io.File; import java.io.FileInputStream; import java.io.IOException; import java.util.Scanner; public class PathTraversalExample { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter file path: ""); String filePath = scanner.nextLine(); File file = new File(filePath); try (FileInputStream fis = new FileInputStream(file)) { int content; while ((content = fis.read()) != -1) { System.out.print((char) content); } } catch (IOException e) { e.printStackTrace(); } } }",java,1
Path Traversal,"import java.io.File;
import java.util.Scanner;

public class PathTraversalVulnerability {

    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        System.out.print(""Enter file name: "");
        String fileName = scanner.nextLine();

        File file = new File(""/path/to/directory/"" + fileName);
        
        if (file.exists()) {
            System.out.println(""File exists."");
        } else {
            System.out.println(""File does not exist."");
        }
    }
}","import java.io.File; import java.util.Scanner; public class PathTraversalVulnerability { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter file name: ""); String fileName = scanner.nextLine(); File file = new File(""/path/to/directory/"" + fileName); if (file.exists()) { System.out.println(""File exists.""); } else { System.out.println(""File does not exist.""); } } }",java,1
Memory Corruption,"#include <iostream>

void unsafe_virtual_call() {
    // Potential vtable corruption vulnerability
    class Base {
    public:
        virtual void func() { std::cout << ""Base"" << std::endl; }
    };
    
    class Derived : public Base {
    public:
        void func() override { std::cout << ""Derived"" << std::endl; }
    };
}","#include <iostream>

void unsafe_virtual_call() {
    // Potential vtable corruption vulnerability
    class Base {
    public:
        virtual void func() { std::cout << ""Base"" << std::endl; }
    };
    
    class Derived : public Base {
    public:
        void func() override { std::cout << ""Derived"" << std::endl; }
    };
}",cpp,1
SQL Injection,"import java.sql.*;

public class SQLInjectionVulnerability {

    public static void main(String[] args) {
        String userInput = ""'; DROP TABLE users; --""; // Malicious input for SQL Injection

        try {
            Connection connection = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");
            Statement statement = connection.createStatement();

            // Vulnerable SQL query with concatenated user input
            String query = ""SELECT * FROM users WHERE username = '"" + userInput + ""'"";
            ResultSet resultSet = statement.executeQuery(query);

            // Print out the results
            while (resultSet.next()) {
                System.out.println(resultSet.getString(""username""));
                System.out.println(resultSet.getString(""email""));
            }

            connection.close();
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.*; public class SQLInjectionVulnerability { public static void main(String[] args) { String userInput = ""'; DROP TABLE users; --""; // Malicious input for SQL Injection try { Connection connection = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); Statement statement = connection.createStatement(); // Vulnerable SQL query with concatenated user input String query = ""SELECT * FROM users WHERE username = '"" + userInput + ""'""; ResultSet resultSet = statement.executeQuery(query); // Print out the results while (resultSet.next()) { System.out.println(resultSet.getString(""username"")); System.out.println(resultSet.getString(""email"")); } connection.close(); } catch (SQLException e) { e.printStackTrace(); } } }",java,1
Clear,"import re
def validate_email(email):
    pattern = r'^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$'
    return bool(re.match(pattern, email))","import re
def validate_email(email):
    pattern = r'^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$'
    return bool(re.match(pattern, email))",python,0
Clear,"const shell = require('child_process');
const safeInput = userInput.replace(/[^a-zA-Z0-9.]/g, '');
shell.execFile('ping', [safeInput]); // Safe command execution
","const shell = require('child_process');
const safeInput = userInput.replace(/[^a-zA-Z0-9.]/g, '');
shell.execFile('ping', [safeInput]); // Safe command execution
",javascript,0
Buffer Overflow,"#include <iostream>
#include <cstring>

void unsafe_c_string(char* input) {
    char buffer[100];
    strcpy(buffer, input); // potential buffer overflow
    std::cout << buffer << std::endl;
}","#include <iostream>
#include <cstring>

void unsafe_c_string(char* input) {
    char buffer[100];
    strcpy(buffer, input); // potential buffer overflow
    std::cout << buffer << std::endl;
}",cpp,1
Clear,"#include <stdio.h>
#include <string.h>

int safe_buffer_operation(char *input) {
    char buffer[100];
    if (strlen(input) < sizeof(buffer)) {
        strcpy(buffer, input);
        return 0;
    }
    return -1; // buffer too small
}","#include <stdio.h>
#include <string.h>

int safe_buffer_operation(char *input) {
    char buffer[100];
    if (strlen(input) < sizeof(buffer)) {
        strcpy(buffer, input);
        return 0;
    }
    return -1; // buffer too small
}",c,0
Cross-Site Scripting (XSS),"import java.io.*;
import javax.servlet.*;
import javax.servlet.http.*;

public class VulnerableServlet extends HttpServlet {
    protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        String userInput = request.getParameter(""input"");
        String output = ""<p>"" + userInput + ""</p>"";
        
        PrintWriter out = response.getWriter();
        out.println(output);
    }
}","import java.io.*; import javax.servlet.*; import javax.servlet.http.*; public class VulnerableServlet extends HttpServlet { protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { String userInput = request.getParameter(""input""); String output = ""<p>"" + userInput + ""</p>""; PrintWriter out = response.getWriter(); out.println(output); } }",java,1
SSRF,"import requests
def fetch_url(url):
    return requests.get(url).text","import requests
def fetch_url(url):
    return requests.get(url).text",python,1
Cross-Site Scripting (XSS),"import java.io.*;
import java.util.*;

public class XSSVulnerableCode {

    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        
        System.out.print(""Enter your name: "");
        String userInput = scanner.nextLine();
        
        // Improperly handling user input by directly outputting it to the web page
        System.out.println(""<p>Welcome, "" + userInput + ""!</p>"");
    }
}","import java.io.*; import java.util.*; public class XSSVulnerableCode { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter your name: ""); String userInput = scanner.nextLine(); // Improperly handling user input by directly outputting it to the web page System.out.println(""<p>Welcome, "" + userInput + ""!</p>""); } }",java,1
Out-of-Bounds,"#include <iostream>

class UnsafeClass {
    int data[10];
public:
    int get_data(int index) {
        return data[index]; // no bounds checking
    }
};","#include <iostream>

class UnsafeClass {
    int data[10];
public:
    int get_data(int index) {
        return data[index]; // no bounds checking
    }
};",cpp,1
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Hardcoded Secrets,"DATABASE_PASSWORD = ""my_super_secret_password_123""
def db_connect():
    import psycopg2
    return psycopg2.connect(f""dbname=test user=admin password={DATABASE_PASSWORD}"")","DATABASE_PASSWORD = ""my_super_secret_password_123""
def db_connect():
    import psycopg2
    return psycopg2.connect(f""dbname=test user=admin password={DATABASE_PASSWORD}"")",python,1
Clear,"#include <stdio.h>
#include <string.h>

void safe_string_copy(char *dest, const char *src, size_t dest_size) {
    if (dest_size > 0) {
        strncpy(dest, src, dest_size - 1);
        dest[dest_size - 1] = '\0';
    }
}","#include <stdio.h>
#include <string.h>

void safe_string_copy(char *dest, const char *src, size_t dest_size) {
    if (dest_size > 0) {
        strncpy(dest, src, dest_size - 1);
        dest[dest_size - 1] = '\0';
    }
}",c,0
Clear,"#include <iostream>
#include <string>
#include <vector>

void safe_string_handling(const std::string& input) {
    std::string safe_copy = input;
    std::cout << safe_copy << std::endl;
}","#include <iostream>
#include <string>
#include <vector>

void safe_string_handling(const std::string& input) {
    std::string safe_copy = input;
    std::cout << safe_copy << std::endl;
}",cpp,0
Out-of-Bounds,"#include <iostream>

class UnsafeClass {
    int data[10];
public:
    int get_data(int index) {
        return data[index]; // no bounds checking
    }
};","#include <iostream>

class UnsafeClass {
    int data[10];
public:
    int get_data(int index) {
        return data[index]; // no bounds checking
    }
};",cpp,1
Insecure Deserialization,"<?php
$data = $_POST['data'];
unserialize($data); // Insecure Deserialization
?>","<?php
$data = $_POST['data'];
unserialize($data); // Insecure Deserialization
?>",php,1
Memory Corruption,"#include <iostream>

void unsafe_pointer_arithmetic(int* array, int size) {
    for (int i = 0; i <= size; i++) {
        std::cout << *(array + i) << std::endl; // potential out-of-bounds
    }
}","#include <iostream>

void unsafe_pointer_arithmetic(int* array, int size) {
    for (int i = 0; i <= size; i++) {
        std::cout << *(array + i) << std::endl; // potential out-of-bounds
    }
}",cpp,1
Clear,"import yaml
def safe_yaml_load(config_str):
    return yaml.safe_load(config_str)","import yaml
def safe_yaml_load(config_str):
    return yaml.safe_load(config_str)",python,0
Clear,"To fix the insecure deserialization vulnerability in the provided code snippet, we need to implement proper security measures to prevent malicious code execution. Here are some steps to secure the deserialization process:

1. Use a Safe Deserialization Mechanism:
Instead of using the default Java ObjectInputStream for deserialization, consider using a safer alternative like JSON deserialization libraries (e.g., Jackson) or protobuf for data exchange. These libraries provide more control over what can be deserialized and offer additional security features.

2. Validate Serialized Data:
Before deserializing any object, validate the input data to ensure that it comes from a trusted and secure source. You can use digital signatures or checksums to verify the integrity of the serialized data.

3. Implement Whitelisting:
Create a whitelist of allowed classes that can be deserialized to restrict which types of objects can be reconstructed from the serialized data. This helps prevent instantiation of unauthorized classes during deserialization.

4. Use Security Managers:
Consider using Java Security Managers to restrict the permissions granted during deserialization. By defining a custom Security Manager and setting appropriate permissions, you can control access to sensitive resources and prevent potentially harmful operations.

5. Sanitize Deserialized Data:
If you must deserialize untrusted data, sanitize it before","To fix the insecure deserialization vulnerability in the provided code snippet, we need to implement proper security measures to prevent malicious code execution. Here are some steps to secure the deserialization process: 1. Use a Safe Deserialization Mechanism: Instead of using the default Java ObjectInputStream for deserialization, consider using a safer alternative like JSON deserialization libraries (e.g., Jackson) or protobuf for data exchange. These libraries provide more control over what can be deserialized and offer additional security features. 2. Validate Serialized Data: Before deserializing any object, validate the input data to ensure that it comes from a trusted and secure source. You can use digital signatures or checksums to verify the integrity of the serialized data. 3. Implement Whitelisting: Create a whitelist of allowed classes that can be deserialized to restrict which types of objects can be reconstructed from the serialized data. This helps prevent instantiation of unauthorized classes during deserialization. 4. Use Security Managers: Consider using Java Security Managers to restrict the permissions granted during deserialization. By defining a custom Security Manager and setting appropriate permissions, you can control access to sensitive resources and prevent potentially harmful operations. 5. Sanitize Deserialized Data: If you must deserialize untrusted data, sanitize it before",php,0
Clear,"import java.io.*;
import javax.servlet.*;
import javax.servlet.http.*;
import org.owasp.encoder.Encode;

public class XssSafeServlet extends HttpServlet {
    @Override
    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        String userInput = request.getParameter(""input"");
        String safeUserInput = Encode.forHtml(userInput);
        String output = ""<h1>Welcome "" + safeUserInput + ""!</h1>"";

        PrintWriter out = response.getWriter();
        out.println(output);
    }
}","import java.io.*; import javax.servlet.*; import javax.servlet.http.*; import org.owasp.encoder.Encode; public class XssSafeServlet extends HttpServlet { @Override protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { String userInput = request.getParameter(""input""); String safeUserInput = Encode.forHtml(userInput); String output = ""<h1>Welcome "" + safeUserInput + ""!</h1>""; PrintWriter out = response.getWriter(); out.println(output); } }",java,0
Clear,"#include <iostream>
#include <sstream>

int safe_string_to_int(const std::string& str) {
    std::stringstream ss(str);
    int value;
    if (ss >> value) {
        return value;
    }
    throw std::invalid_argument(""Invalid integer"");
}","#include <iostream>
#include <sstream>

int safe_string_to_int(const std::string& str) {
    std::stringstream ss(str);
    int value;
    if (ss >> value) {
        return value;
    }
    throw std::invalid_argument(""Invalid integer"");
}",cpp,0
Clear,"const userInput = new URLSearchParams(window.location.search).get('input');
const safeOutput = document.createElement('div');
safeOutput.textContent = userInput; // Safe DOM manipulation
document.body.appendChild(safeOutput);
","const userInput = new URLSearchParams(window.location.search).get('input');
const safeOutput = document.createElement('div');
safeOutput.textContent = userInput; // Safe DOM manipulation
document.body.appendChild(safeOutput);
",javascript,0
Command Injection,"import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class CommandInjectionExample {

    public static void main(String[] args) {
        try {
            BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));
            System.out.print(""Enter a command to execute: "");
            String userInput = reader.readLine();

            // WARNING: Vulnerable code - User input is directly passed to the command
            Process process = Runtime.getRuntime().exec(""ping "" + userInput);

            BufferedReader inputReader = new BufferedReader(new InputStreamReader(process.getInputStream()));
            String inputLine;
            while ((inputLine = inputReader.readLine()) != null) {
                System.out.println(inputLine);
            }

        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}","import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class CommandInjectionExample { public static void main(String[] args) { try { BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a command to execute: ""); String userInput = reader.readLine(); // WARNING: Vulnerable code - User input is directly passed to the command Process process = Runtime.getRuntime().exec(""ping "" + userInput); BufferedReader inputReader = new BufferedReader(new InputStreamReader(process.getInputStream())); String inputLine; while ((inputLine = inputReader.readLine()) != null) { System.out.println(inputLine); } } catch (IOException e) { e.printStackTrace(); } } }",java,1
Clear,"<?php
$file = basename($_GET['file']);
$allowed = ['page1.php', 'page2.php'];
if (in_array($file, $allowed)) {
    include($file);
}
?>","<?php
$file = basename($_GET['file']);
$allowed = ['page1.php', 'page2.php'];
if (in_array($file, $allowed)) {
    include($file);
}
?>",php,0
Clear,"#include <iostream>
#include <fstream>
#include <string>

void safe_file_reading(const std::string& filename) {
    std::ifstream file(filename);
    if (file.is_open()) {
        std::string line;
        while (std::getline(file, line)) {
            std::cout << line << std::endl;
        }
    }
}","#include <iostream>
#include <fstream>
#include <string>

void safe_file_reading(const std::string& filename) {
    std::ifstream file(filename);
    if (file.is_open()) {
        std::string line;
        while (std::getline(file, line)) {
            std::cout << line << std::endl;
        }
    }
}",cpp,0
Clear,"import java.io.IOException;
import java.io.PrintWriter;

import javax.servlet.ServletException;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

import org.owasp.encoder.Encode;

public class SecureServlet extends HttpServlet {

    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        String userInput = request.getParameter(""input"");
        
        response.setContentType(""text/html"");
        PrintWriter out = response.getWriter();
        
        out.println(""<html>"");
        out.println(""<head><title>Secure Page</title></head>"");
        out.println(""<body>"");
        
        // Properly encoding user input to prevent XSS
        out.println(""<h1>Hello "" + Encode.forHtml(userInput) + ""!</h1>"");
        
        out.println(""</body>"");
        out.println(""</html>"");
    }
}","import java.io.IOException; import java.io.PrintWriter; import javax.servlet.ServletException; import javax.servlet.http.HttpServlet; import javax.servlet.http.HttpServletRequest; import javax.servlet.http.HttpServletResponse; import org.owasp.encoder.Encode; public class SecureServlet extends HttpServlet { protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { String userInput = request.getParameter(""input""); response.setContentType(""text/html""); PrintWriter out = response.getWriter(); out.println(""<html>""); out.println(""<head><title>Secure Page</title></head>""); out.println(""<body>""); // Properly encoding user input to prevent XSS out.println(""<h1>Hello "" + Encode.forHtml(userInput) + ""!</h1>""); out.println(""</body>""); out.println(""</html>""); } }",java,0
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
XSS,"const userInput = document.location.search.split('=')[1];
document.write(userInput); // XSS
","const userInput = document.location.search.split('=')[1];
document.write(userInput); // XSS
",javascript,1
Clear,"<?php
$file = basename($_GET['file']);
$allowed = ['page1.php', 'page2.php'];
if (in_array($file, $allowed)) {
    include($file);
}
?>","<?php
$file = basename($_GET['file']);
$allowed = ['page1.php', 'page2.php'];
if (in_array($file, $allowed)) {
    include($file);
}
?>",php,0
Clear,"const token = process.env.API_TOKEN; // Environment variable
fetch('/api/data', {
    headers: { 'Authorization': `Bearer ${token}` }
});
","const token = process.env.API_TOKEN; // Environment variable
fetch('/api/data', {
    headers: { 'Authorization': `Bearer ${token}` }
});
",javascript,0
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Cross-Site Scripting (XSS),"import java.io.*;
import javax.servlet.*;
import javax.servlet.http.*;

public class VulnerableServlet extends HttpServlet {
    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        String userInput = request.getParameter(""input"");
        String output = ""Hello, "" + userInput + ""!"";

        response.setContentType(""text/html"");
        PrintWriter out = response.getWriter();
        out.println(""<html><body>"");
        out.println(""<h2>"" + output + ""</h2>"");
        out.println(""</body></html>"");
    }
}","import java.io.*; import javax.servlet.*; import javax.servlet.http.*; public class VulnerableServlet extends HttpServlet { protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { String userInput = request.getParameter(""input""); String output = ""Hello, "" + userInput + ""!""; response.setContentType(""text/html""); PrintWriter out = response.getWriter(); out.println(""<html><body>""); out.println(""<h2>"" + output + ""</h2>""); out.println(""</body></html>""); } }",java,1
Clear,"const userInput = new URLSearchParams(window.location.search).get('input');
const safeOutput = document.createElement('div');
safeOutput.textContent = userInput; // Safe DOM manipulation
document.body.appendChild(safeOutput);
","const userInput = new URLSearchParams(window.location.search).get('input');
const safeOutput = document.createElement('div');
safeOutput.textContent = userInput; // Safe DOM manipulation
document.body.appendChild(safeOutput);
",javascript,0
Clear,"const token = process.env.API_TOKEN; // Environment variable
fetch('/api/data', {
    headers: { 'Authorization': `Bearer ${token}` }
});
","const token = process.env.API_TOKEN; // Environment variable
fetch('/api/data', {
    headers: { 'Authorization': `Bearer ${token}` }
});
",javascript,0
Clear,"To fix the Path Traversal vulnerability in the given Java code snippet, you need to ensure that user input is properly validated and sanitized before using it to access files. Below is an example of a secure code snippet that prevents Path Traversal:

```java
import java.io.BufferedReader;
import java.io.File;
import java.io.FileReader;
import java.io.IOException;

public class FileRead {

    public static void main(String[] args) {
        String basePath = ""/path/to/secure/directory/"";
        String fileName = ""example.txt"";

        // Validate user input
        if (!fileName.matches(""[a-zA-Z0-9_\\.\\-]+"")) {
            System.out.println(""Invalid file name"");
            return;
        }

        // Construct the file path using the base path and file name
        String filePath = basePath + fileName;

        // Check if the file exists within the secure directory
        File file = new File(filePath);
        if (!file.exists() || !file.isFile()) {
            System.out.println(""File not found"");
            return;
        }

        // Read and display the contents of the file
        try (BufferedReader reader = new BufferedReader(new FileReader(file))) {
            String line;
            while ((line = reader.readLine())","To fix the Path Traversal vulnerability in the given Java code snippet, you need to ensure that user input is properly validated and sanitized before using it to access files. Below is an example of a secure code snippet that prevents Path Traversal: ```java import java.io.BufferedReader; import java.io.File; import java.io.FileReader; import java.io.IOException; public class FileRead { public static void main(String[] args) { String basePath = ""/path/to/secure/directory/""; String fileName = ""example.txt""; // Validate user input if (!fileName.matches(""[a-zA-Z0-9_\\.\\-]+"")) { System.out.println(""Invalid file name""); return; } // Construct the file path using the base path and file name String filePath = basePath + fileName; // Check if the file exists within the secure directory File file = new File(filePath); if (!file.exists() || !file.isFile()) { System.out.println(""File not found""); return; } // Read and display the contents of the file try (BufferedReader reader = new BufferedReader(new FileReader(file))) { String line; while ((line = reader.readLine())",java,0
Clear,"import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class CommandInjectionSecure {

    public static void main(String[] args) {
        try {
            BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));
            System.out.print(""Enter a command to execute: "");
            String userInput = reader.readLine();

            ProcessBuilder processBuilder = new ProcessBuilder(""ping"", userInput);
            Process process = processBuilder.start();

            BufferedReader inputReader = new BufferedReader(new InputStreamReader(process.getInputStream()));
            String line;
            while ((line = inputReader.readLine()) != null) {
                System.out.println(line);
            }

        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}","import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class CommandInjectionSecure { public static void main(String[] args) { try { BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a command to execute: ""); String userInput = reader.readLine(); ProcessBuilder processBuilder = new ProcessBuilder(""ping"", userInput); Process process = processBuilder.start(); BufferedReader inputReader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = inputReader.readLine()) != null) { System.out.println(line); } } catch (IOException e) { e.printStackTrace(); } } }",java,0
Clear,"import os
def secure_file_access(username, filepath):
    base_dir = f""/home/{username}/files/""
    full_path = os.path.join(base_dir, filepath)
    full_path = os.path.normpath(full_path)
    if not full_path.startswith(base_dir):
        raise PermissionError(""Access denied"")
    with open(full_path, 'r') as f:
        return f.read()","import os
def secure_file_access(username, filepath):
    base_dir = f""/home/{username}/files/""
    full_path = os.path.join(base_dir, filepath)
    full_path = os.path.normpath(full_path)
    if not full_path.startswith(base_dir):
        raise PermissionError(""Access denied"")
    with open(full_path, 'r') as f:
        return f.read()",python,0
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Clear,"To fix this insecure deserialization vulnerability, you need to implement proper security measures to ensure that the deserialized objects are safe. Here are some recommendations for secure deserialization in Java:

1. Use a whitelist approach: Instead of blindly deserializing any object, maintain a whitelist of allowed classes that can be deserialized. This restricts the types of objects that can be deserialized and mitigates the risk of executing malicious code.

2. Validate input data: Before deserializing any data, validate the input to ensure it comes from a trusted and authenticated source. Perform input validation checks to prevent malicious input from being processed.

3. Use a secure serialization format: Consider using a secure serialization format such as JSON or protobuf instead of Java serialization, which can be prone to security vulnerabilities.

4. Implement input/output filtering: Apply input/output filtering mechanisms to sanitize and validate serialized data before processing it. This can help prevent injection attacks and other security threats.

5. Use secure serialization libraries: If deserialization is necessary, use secure serialization libraries like Jackson or Google's GSON with appropriate configurations for safe deserialization.

6. Handle exceptions properly: Catch specific exceptions separately and handle them appropriately without revealing sensitive information to attackers in error messages.

Here's an improved","To fix this insecure deserialization vulnerability, you need to implement proper security measures to ensure that the deserialized objects are safe. Here are some recommendations for secure deserialization in Java: 1. Use a whitelist approach: Instead of blindly deserializing any object, maintain a whitelist of allowed classes that can be deserialized. This restricts the types of objects that can be deserialized and mitigates the risk of executing malicious code. 2. Validate input data: Before deserializing any data, validate the input to ensure it comes from a trusted and authenticated source. Perform input validation checks to prevent malicious input from being processed. 3. Use a secure serialization format: Consider using a secure serialization format such as JSON or protobuf instead of Java serialization, which can be prone to security vulnerabilities. 4. Implement input/output filtering: Apply input/output filtering mechanisms to sanitize and validate serialized data before processing it. This can help prevent injection attacks and other security threats. 5. Use secure serialization libraries: If deserialization is necessary, use secure serialization libraries like Jackson or Google's GSON with appropriate configurations for safe deserialization. 6. Handle exceptions properly: Catch specific exceptions separately and handle them appropriately without revealing sensitive information to attackers in error messages. Here's an improved",php,0
Clear,"To fix this code snippet and prevent insecure deserialization vulnerabilities, you can implement the following security measures:

1. **Use a Safe Deserialization Mechanism:** Instead of using the default Java deserialization mechanism, consider using a safe deserialization library such as [Jackson](https://github.com/FasterXML/jackson) or [Gson](https://github.com/google/gson) with appropriate security configurations to deserialize objects safely.

2. **Validate Input Data:** Before deserializing any input data, validate and sanitize it to ensure that it comes from a trusted and authenticated source. Implement input validation checks to prevent malicious or tampered data from being processed.

3. **Implement Whitelisting:** Restrict the classes that can be deserialized by maintaining a whitelist of allowed classes. Only deserialize objects of whitelisted classes to prevent attackers from injecting arbitrary objects into the application.

4. **Disable External Class Loading:** Disable the ability to load and execute arbitrary classes during deserialization by setting up appropriate class loading restrictions. Avoid dynamic class loading based on user input to prevent code execution vulnerabilities.

5. **Use Signed Serialized Objects:** Sign serialized objects with digital signatures to verify their integrity and authenticity during deserialization. Validate the signatures before processing the deserialized objects","To fix this code snippet and prevent insecure deserialization vulnerabilities, you can implement the following security measures: 1. **Use a Safe Deserialization Mechanism:** Instead of using the default Java deserialization mechanism, consider using a safe deserialization library such as [Jackson](https://github.com/FasterXML/jackson) or [Gson](https://github.com/google/gson) with appropriate security configurations to deserialize objects safely. 2. **Validate Input Data:** Before deserializing any input data, validate and sanitize it to ensure that it comes from a trusted and authenticated source. Implement input validation checks to prevent malicious or tampered data from being processed. 3. **Implement Whitelisting:** Restrict the classes that can be deserialized by maintaining a whitelist of allowed classes. Only deserialize objects of whitelisted classes to prevent attackers from injecting arbitrary objects into the application. 4. **Disable External Class Loading:** Disable the ability to load and execute arbitrary classes during deserialization by setting up appropriate class loading restrictions. Avoid dynamic class loading based on user input to prevent code execution vulnerabilities. 5. **Use Signed Serialized Objects:** Sign serialized objects with digital signatures to verify their integrity and authenticity during deserialization. Validate the signatures before processing the deserialized objects",php,0
Clear,"It seems like the code you provided is indeed vulnerable to Insecure Deserialization, which can lead to serious security risks. To address this vulnerability and implement proper security measures, you can consider the following best practices for secure deserialization:

1. **Validate Input**: Ensure that only trusted and expected input is deserialized. Implement strict input validation to prevent malicious or unexpected data from being processed.

2. **Use Whitelisting**: Maintain a whitelist of allowed classes that can be deserialized. Restrict the types of objects that can be deserialized to prevent malicious classes from being loaded.

3. **Enable Security Manager**: Consider using Java Security Manager to restrict the permissions of the deserialized objects. This can limit the impact of any potential code execution from malicious objects.

4. **Implement Safe Deserialization**: Use safer serialization formats such as JSON or XML instead of Java serialization, which is known to be vulnerable. Libraries like Jackson or Gson provide safer alternatives for serialization and deserialization.

5. **Sanitize Data**: If deserializing untrusted data is necessary, ensure that it is properly sanitized and validated before processing it further.

Here's an example of how you could improve the code snippet provided by implementing some of these security measures:

```java
import","It seems like the code you provided is indeed vulnerable to Insecure Deserialization, which can lead to serious security risks. To address this vulnerability and implement proper security measures, you can consider the following best practices for secure deserialization: 1. **Validate Input**: Ensure that only trusted and expected input is deserialized. Implement strict input validation to prevent malicious or unexpected data from being processed. 2. **Use Whitelisting**: Maintain a whitelist of allowed classes that can be deserialized. Restrict the types of objects that can be deserialized to prevent malicious classes from being loaded. 3. **Enable Security Manager**: Consider using Java Security Manager to restrict the permissions of the deserialized objects. This can limit the impact of any potential code execution from malicious objects. 4. **Implement Safe Deserialization**: Use safer serialization formats such as JSON or XML instead of Java serialization, which is known to be vulnerable. Libraries like Jackson or Gson provide safer alternatives for serialization and deserialization. 5. **Sanitize Data**: If deserializing untrusted data is necessary, ensure that it is properly sanitized and validated before processing it further. Here's an example of how you could improve the code snippet provided by implementing some of these security measures: ```java import",php,0
Clear,"#include <stdio.h>
#include <string.h>

int validate_input(const char *input) {
    if (input == NULL) return 0;
    for (int i = 0; input[i] != '\0'; i++) {
        if (input[i] < 32 || input[i] > 126) {
            return 0; // invalid character
        }
    }
    return 1;
}","#include <stdio.h>
#include <string.h>

int validate_input(const char *input) {
    if (input == NULL) return 0;
    for (int i = 0; input[i] != '\0'; i++) {
        if (input[i] < 32 || input[i] > 126) {
            return 0; // invalid character
        }
    }
    return 1;
}",c,0
Clear,"import org.owasp.encoder.Encode;

public class XSSFixed {
    public static void main(String[] args) {
        // Simulating user input from an untrusted source
        String userInput = ""<script>alert('XSS Vulnerability!')</script>"";

        // Properly handling user input by encoding it before outputting it to the web page
        System.out.println(""<div>"" + Encode.forHtml(userInput) + ""</div>"");
    }
}","import org.owasp.encoder.Encode; public class XSSFixed { public static void main(String[] args) { // Simulating user input from an untrusted source String userInput = ""<script>alert('XSS Vulnerability!')</script>""; // Properly handling user input by encoding it before outputting it to the web page System.out.println(""<div>"" + Encode.forHtml(userInput) + ""</div>""); } }",java,0
Clear,"#include <stdio.h>
#include <string.h>

int safe_buffer_operation(char *input) {
    char buffer[100];
    if (strlen(input) < sizeof(buffer)) {
        strcpy(buffer, input);
        return 0;
    }
    return -1; // buffer too small
}","#include <stdio.h>
#include <string.h>

int safe_buffer_operation(char *input) {
    char buffer[100];
    if (strlen(input) < sizeof(buffer)) {
        strcpy(buffer, input);
        return 0;
    }
    return -1; // buffer too small
}",c,0
Clear,"#include <iostream>
#include <string>
#include <vector>

void safe_string_handling(const std::string& input) {
    std::string safe_copy = input;
    std::cout << safe_copy << std::endl;
}","#include <iostream>
#include <string>
#include <vector>

void safe_string_handling(const std::string& input) {
    std::string safe_copy = input;
    std::cout << safe_copy << std::endl;
}",cpp,0
Clear,"import java.sql.*;

public class SecureSQLInjectionCode {

    public static void main(String[] args) {
        try {
            String userInput = ""1 OR 1=1""; // Simulated user input for SQL Injection
            
            Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");
            
            // Use PreparedStatement for secure query construction
            String query = ""SELECT * FROM users WHERE id=?"";
            PreparedStatement stmt = conn.prepareStatement(query);
            stmt.setString(1, userInput); // Set the parameter value securely
            
            ResultSet rs = stmt.executeQuery();

            while (rs.next()) {
                System.out.println(""User ID: "" + rs.getInt(""id"") + "", Username: "" + rs.getString(""username""));
            }

            conn.close();
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.*; public class SecureSQLInjectionCode { public static void main(String[] args) { try { String userInput = ""1 OR 1=1""; // Simulated user input for SQL Injection Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); // Use PreparedStatement for secure query construction String query = ""SELECT * FROM users WHERE id=?""; PreparedStatement stmt = conn.prepareStatement(query); stmt.setString(1, userInput); // Set the parameter value securely ResultSet rs = stmt.executeQuery(); while (rs.next()) { System.out.println(""User ID: "" + rs.getInt(""id"") + "", Username: "" + rs.getString(""username"")); } conn.close(); } catch (SQLException e) { e.printStackTrace(); } } }",java,0
Clear,"#include <iostream>
#include <fstream>
#include <string>

void safe_file_reading(const std::string& filename) {
    std::ifstream file(filename);
    if (file.is_open()) {
        std::string line;
        while (std::getline(file, line)) {
            std::cout << line << std::endl;
        }
    }
}","#include <iostream>
#include <fstream>
#include <string>

void safe_file_reading(const std::string& filename) {
    std::ifstream file(filename);
    if (file.is_open()) {
        std::string line;
        while (std::getline(file, line)) {
            std::cout << line << std::endl;
        }
    }
}",cpp,0
Clear,"#include <iostream>
#include <sstream>

int safe_string_to_int(const std::string& str) {
    std::stringstream ss(str);
    int value;
    if (ss >> value) {
        return value;
    }
    throw std::invalid_argument(""Invalid integer"");
}","#include <iostream>
#include <sstream>

int safe_string_to_int(const std::string& str) {
    std::stringstream ss(str);
    int value;
    if (ss >> value) {
        return value;
    }
    throw std::invalid_argument(""Invalid integer"");
}",cpp,0
Cross-Site Scripting (XSS),"import java.util.Scanner;

public class XSSVulnerableCode {
    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);

        System.out.print(""Enter your name: "");
        String userInput = scanner.nextLine();

        System.out.println(""Hello, "" + userInput + ""!""); // Vulnerability: user input is directly embedded in the output without proper encoding

        scanner.close();
    }
}","import java.util.Scanner; public class XSSVulnerableCode { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter your name: ""); String userInput = scanner.nextLine(); System.out.println(""Hello, "" + userInput + ""!""); // Vulnerability: user input is directly embedded in the output without proper encoding scanner.close(); } }",java,1
Clear,"To fix this code snippet and make it more secure against Insecure Deserialization vulnerabilities, you can implement the following security measures:

1. **Use a Safe Deserialization Mechanism**: Instead of using Java's default ObjectInputStream for deserialization, consider using a safer deserialization mechanism like [Jackson](https://github.com/FasterXML/jackson) or [Gson](https://github.com/google/gson). These libraries provide better control over the deserialization process and can help prevent common vulnerabilities.

2. **Implement Input Validation**: Validate the input data before deserializing it to ensure that it comes from a trusted and expected source. This can help prevent malicious data from being deserialized and executed.

3. **Enable Class Filtering**: Implement class filtering to restrict which classes can be deserialized. This can prevent attackers from exploiting vulnerabilities by injecting malicious classes into the serialized data.

4. **Enable Security Manager**: Consider enabling a Security Manager to control the actions that untrusted code can perform during deserialization. This adds an additional layer of protection against potentially harmful operations.

5. **Avoid using Base64 Encoding for Serialization**: While Base64 encoding is commonly used for encoding binary data, it should not be used as the sole method of securing serialized data.","To fix this code snippet and make it more secure against Insecure Deserialization vulnerabilities, you can implement the following security measures: 1. **Use a Safe Deserialization Mechanism**: Instead of using Java's default ObjectInputStream for deserialization, consider using a safer deserialization mechanism like [Jackson](https://github.com/FasterXML/jackson) or [Gson](https://github.com/google/gson). These libraries provide better control over the deserialization process and can help prevent common vulnerabilities. 2. **Implement Input Validation**: Validate the input data before deserializing it to ensure that it comes from a trusted and expected source. This can help prevent malicious data from being deserialized and executed. 3. **Enable Class Filtering**: Implement class filtering to restrict which classes can be deserialized. This can prevent attackers from exploiting vulnerabilities by injecting malicious classes into the serialized data. 4. **Enable Security Manager**: Consider enabling a Security Manager to control the actions that untrusted code can perform during deserialization. This adds an additional layer of protection against potentially harmful operations. 5. **Avoid using Base64 Encoding for Serialization**: While Base64 encoding is commonly used for encoding binary data, it should not be used as the sole method of securing serialized data.",php,0
Out-of-Bounds,"#include <iostream>

class UnsafeClass {
    int data[10];
public:
    int get_data(int index) {
        return data[index]; // no bounds checking
    }
};","#include <iostream>

class UnsafeClass {
    int data[10];
public:
    int get_data(int index) {
        return data[index]; // no bounds checking
    }
};",cpp,1
Buffer Overflow,"#include <iostream>
#include <cstdio>

void unsafe_c_input() {
    char buffer[50];
    scanf(""%s"", buffer); // no length limit
    std::cout << buffer << std::endl;
}","#include <iostream>
#include <cstdio>

void unsafe_c_input() {
    char buffer[50];
    scanf(""%s"", buffer); // no length limit
    std::cout << buffer << std::endl;
}",cpp,1
Clear,"To fix the SQL Injection vulnerability in the provided Java code snippet, you should use prepared statements instead of concatenating user input directly into the SQL query. Prepared statements provide a way to create parameterized queries that separate the SQL code from the user input, thereby preventing SQL Injection attacks.

Here is an updated version of the code that uses a PreparedStatement:

```java
import java.sql.*;

public class SecureCode {
    public static void main(String[] args) {
        String userInput = ""'; DROP TABLE users; --"";

        try {
            // Connect to the database
            Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");

            // Create a prepared statement with a parameterized query
            String query = ""SELECT * FROM users WHERE username = ?"";
            PreparedStatement pstmt = conn.prepareStatement(query);
            pstmt.setString(1, userInput);

            // Execute the prepared statement
            ResultSet rs = pstmt.executeQuery();

            // Process the results
            while (rs.next()) {
                System.out.println(""User found: "" + rs.getString(""username""));
            }

            // Close resources
            rs.close();
            pstmt.close();
            conn.close();
        } catch (SQLException e) {
            e.printStackTrace();","To fix the SQL Injection vulnerability in the provided Java code snippet, you should use prepared statements instead of concatenating user input directly into the SQL query. Prepared statements provide a way to create parameterized queries that separate the SQL code from the user input, thereby preventing SQL Injection attacks. Here is an updated version of the code that uses a PreparedStatement: ```java import java.sql.*; public class SecureCode { public static void main(String[] args) { String userInput = ""'; DROP TABLE users; --""; try { // Connect to the database Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); // Create a prepared statement with a parameterized query String query = ""SELECT * FROM users WHERE username = ?""; PreparedStatement pstmt = conn.prepareStatement(query); pstmt.setString(1, userInput); // Execute the prepared statement ResultSet rs = pstmt.executeQuery(); // Process the results while (rs.next()) { System.out.println(""User found: "" + rs.getString(""username"")); } // Close resources rs.close(); pstmt.close(); conn.close(); } catch (SQLException e) { e.printStackTrace();",java,0
Clear,"<?php
$file = basename($_GET['file']);
$allowed = ['page1.php', 'page2.php'];
if (in_array($file, $allowed)) {
    include($file);
}
?>","<?php
$file = basename($_GET['file']);
$allowed = ['page1.php', 'page2.php'];
if (in_array($file, $allowed)) {
    include($file);
}
?>",php,0
Out-of-Bounds,"#include <iostream>

class UnsafeClass {
    int data[10];
public:
    int get_data(int index) {
        return data[index]; // no bounds checking
    }
};","#include <iostream>

class UnsafeClass {
    int data[10];
public:
    int get_data(int index) {
        return data[index]; // no bounds checking
    }
};",cpp,1
Path Traversal,"import java.io.File;
import java.io.FileInputStream;
import java.io.IOException;

public class PathTraversalExample {

    public static void main(String[] args) {
        String fileName = args[0]; // User input with file name
        String directory = ""/path/to/files/""; // Base directory where files are stored
        
        try {
            File file = new File(directory + fileName);
            FileInputStream fis = new FileInputStream(file);
            
            int data;
            while ((data = fis.read()) != -1) {
                System.out.print((char) data);
            }
            
            fis.close();
        } catch (IOException e) {
            System.out.println(""Error reading file: "" + e.getMessage());
        }
    }
}","import java.io.File; import java.io.FileInputStream; import java.io.IOException; public class PathTraversalExample { public static void main(String[] args) { String fileName = args[0]; // User input with file name String directory = ""/path/to/files/""; // Base directory where files are stored try { File file = new File(directory + fileName); FileInputStream fis = new FileInputStream(file); int data; while ((data = fis.read()) != -1) { System.out.print((char) data); } fis.close(); } catch (IOException e) { System.out.println(""Error reading file: "" + e.getMessage()); } } }",java,1
Clear,"#include <iostream>
#include <sstream>

int safe_string_to_int(const std::string& str) {
    std::stringstream ss(str);
    int value;
    if (ss >> value) {
        return value;
    }
    throw std::invalid_argument(""Invalid integer"");
}","#include <iostream>
#include <sstream>

int safe_string_to_int(const std::string& str) {
    std::stringstream ss(str);
    int value;
    if (ss >> value) {
        return value;
    }
    throw std::invalid_argument(""Invalid integer"");
}",cpp,0
Command Injection,"<?php
$cmd = $_GET['cmd'];
system($cmd); // Command Injection
?>","<?php
$cmd = $_GET['cmd'];
system($cmd); // Command Injection
?>",php,1
Clear,"import java.io.File;
import java.util.Scanner;

public class SecurePathTraversal {

    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        System.out.print(""Enter file name: "");
        String fileName = scanner.nextLine();

        if (isValidFileName(fileName)) {
            File file = new File(""/path/to/directory/"" + fileName);

            if (file.exists()) {
                System.out.println(""File exists."");
                // Do something with the file
            } else {
                System.out.println(""File does not exist."");
            }
        } else {
            System.out.println(""Invalid file name."");
        }
    }

    private static boolean isValidFileName(String fileName) {
        // Implement proper validation logic here
        // You can use regex or a whitelist approach to ensure the file name is safe
        return fileName.matches(""[a-zA-Z0-9_-\\.]+""); // Example regex for alphanumeric characters, underscore, hyphen, and dot
    }
}","import java.io.File; import java.util.Scanner; public class SecurePathTraversal { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter file name: ""); String fileName = scanner.nextLine(); if (isValidFileName(fileName)) { File file = new File(""/path/to/directory/"" + fileName); if (file.exists()) { System.out.println(""File exists.""); // Do something with the file } else { System.out.println(""File does not exist.""); } } else { System.out.println(""Invalid file name.""); } } private static boolean isValidFileName(String fileName) { // Implement proper validation logic here // You can use regex or a whitelist approach to ensure the file name is safe return fileName.matches(""[a-zA-Z0-9_-\\.]+""); // Example regex for alphanumeric characters, underscore, hyphen, and dot } }",java,0
Clear,"const shell = require('child_process');
const safeInput = userInput.replace(/[^a-zA-Z0-9.]/g, '');
shell.execFile('ping', [safeInput]); // Safe command execution
","const shell = require('child_process');
const safeInput = userInput.replace(/[^a-zA-Z0-9.]/g, '');
shell.execFile('ping', [safeInput]); // Safe command execution
",javascript,0
SQL Injection,"app.get('/user/:id', (req, res) => {
    const query = `SELECT * FROM users WHERE id = ${req.params.id}`; // SQL Injection
    db.query(query, (err, result) => {
        res.json(result);
    });
});
","app.get('/user/:id', (req, res) => {
    const query = `SELECT * FROM users WHERE id = ${req.params.id}`; // SQL Injection
    db.query(query, (err, result) => {
        res.json(result);
    });
});
",javascript,1
Clear,"import java.util.Scanner;
import org.apache.commons.text.StringEscapeUtils;

public class XSSFixedCode {
    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        
        System.out.println(""Enter your name:"");
        String userInput = scanner.nextLine();
        
        // Sanitize the user input to prevent XSS
        String sanitizedUserInput = StringEscapeUtils.escapeHtml4(userInput);
        
        System.out.println(""Hello, "" + sanitizedUserInput + ""!""); // Safe line
        
        scanner.close();
    }
}","import java.util.Scanner; import org.apache.commons.text.StringEscapeUtils; public class XSSFixedCode { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.println(""Enter your name:""); String userInput = scanner.nextLine(); // Sanitize the user input to prevent XSS String sanitizedUserInput = StringEscapeUtils.escapeHtml4(userInput); System.out.println(""Hello, "" + sanitizedUserInput + ""!""); // Safe line scanner.close(); } }",java,0
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Insecure Deserialization,"import yaml
def load_config(config_str):
    return yaml.load(config_str, Loader=yaml.Loader)","import yaml
def load_config(config_str):
    return yaml.load(config_str, Loader=yaml.Loader)",python,1
Path Traversal,"import java.io.File;
import java.io.FileInputStream;
import java.io.IOException;
import java.util.Scanner;

public class PathTraversalExample {

    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        System.out.println(""Enter the file name:"");
        String fileName = scanner.nextLine();

        File file = new File(""C:/data/"" + fileName);

        try {
            FileInputStream fis = new FileInputStream(file);
            int data;
            while ((data = fis.read()) != -1) {
                System.out.print((char) data);
            }
            fis.close();
        } catch (IOException e) {
            System.out.println(""Error reading file: "" + e.getMessage());
        }
    }
}","import java.io.File; import java.io.FileInputStream; import java.io.IOException; import java.util.Scanner; public class PathTraversalExample { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.println(""Enter the file name:""); String fileName = scanner.nextLine(); File file = new File(""C:/data/"" + fileName); try { FileInputStream fis = new FileInputStream(file); int data; while ((data = fis.read()) != -1) { System.out.print((char) data); } fis.close(); } catch (IOException e) { System.out.println(""Error reading file: "" + e.getMessage()); } } }",java,1
Clear,"#include <stdio.h>
#include <string.h>

int validate_input(const char *input) {
    if (input == NULL) return 0;
    for (int i = 0; input[i] != '\0'; i++) {
        if (input[i] < 32 || input[i] > 126) {
            return 0; // invalid character
        }
    }
    return 1;
}","#include <stdio.h>
#include <string.h>

int validate_input(const char *input) {
    if (input == NULL) return 0;
    for (int i = 0; input[i] != '\0'; i++) {
        if (input[i] < 32 || input[i] > 126) {
            return 0; // invalid character
        }
    }
    return 1;
}",c,0
Command Injection,"import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class CommandInjectionExample {
    public static void main(String[] args) throws IOException {
        BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));
        
        System.out.print(""Enter a command to execute: "");
        String command = reader.readLine();
        
        // Vulnerability: User input is directly concatenated into the command without proper validation or sanitization
        Process process = Runtime.getRuntime().exec(""ping "" + command);
        
        BufferedReader inputStream = new BufferedReader(new InputStreamReader(process.getInputStream()));
        String output = null;
        
        while ((output = inputStream.readLine()) != null) {
            System.out.println(output);
        }
    }
}","import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class CommandInjectionExample { public static void main(String[] args) throws IOException { BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a command to execute: ""); String command = reader.readLine(); // Vulnerability: User input is directly concatenated into the command without proper validation or sanitization Process process = Runtime.getRuntime().exec(""ping "" + command); BufferedReader inputStream = new BufferedReader(new InputStreamReader(process.getInputStream())); String output = null; while ((output = inputStream.readLine()) != null) { System.out.println(output); } } }",java,1
SQL Injection,"app.get('/user/:id', (req, res) => {
    const query = `SELECT * FROM users WHERE id = ${req.params.id}`; // SQL Injection
    db.query(query, (err, result) => {
        res.json(result);
    });
});
","app.get('/user/:id', (req, res) => {
    const query = `SELECT * FROM users WHERE id = ${req.params.id}`; // SQL Injection
    db.query(query, (err, result) => {
        res.json(result);
    });
});
",javascript,1
Out-of-Bounds,"#include <iostream>

class UnsafeClass {
    int data[10];
public:
    int get_data(int index) {
        return data[index]; // no bounds checking
    }
};","#include <iostream>

class UnsafeClass {
    int data[10];
public:
    int get_data(int index) {
        return data[index]; // no bounds checking
    }
};",cpp,1
Hardcoded Secrets,"localStorage.setItem('token', 'hardcoded-secret-token-123'); // Hardcoded secret
","localStorage.setItem('token', 'hardcoded-secret-token-123'); // Hardcoded secret
",javascript,1
Clear,"#include <iostream>
#include <string>
#include <vector>

void safe_string_handling(const std::string& input) {
    std::string safe_copy = input;
    std::cout << safe_copy << std::endl;
}","#include <iostream>
#include <string>
#include <vector>

void safe_string_handling(const std::string& input) {
    std::string safe_copy = input;
    std::cout << safe_copy << std::endl;
}",cpp,0
Clear,"#include <iostream>
#include <fstream>
#include <string>

void safe_file_reading(const std::string& filename) {
    std::ifstream file(filename);
    if (file.is_open()) {
        std::string line;
        while (std::getline(file, line)) {
            std::cout << line << std::endl;
        }
    }
}","#include <iostream>
#include <fstream>
#include <string>

void safe_file_reading(const std::string& filename) {
    std::ifstream file(filename);
    if (file.is_open()) {
        std::string line;
        while (std::getline(file, line)) {
            std::cout << line << std::endl;
        }
    }
}",cpp,0
Clear,"#include <iostream>
#include <memory>

void safe_memory_management() {
    auto ptr = std::make_unique<int>(42);
    std::cout << *ptr << std::endl;
}","#include <iostream>
#include <memory>

void safe_memory_management() {
    auto ptr = std::make_unique<int>(42);
    std::cout << *ptr << std::endl;
}",cpp,0
Clear,"import java.io.*;
import javax.servlet.*;
import javax.servlet.http.*;
import org.owasp.encoder.Encode;

public class XSSFixedServlet extends HttpServlet {
    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        String userInput = request.getParameter(""input"");
        
        // Properly escaping user input before outputting it to the response
        PrintWriter out = response.getWriter();
        out.println(""<html>"");
        out.println(""<body>"");
        out.println(""<h1>User Input: "" + Encode.forHtml(userInput) + ""</h1>"");
        out.println(""</body>"");
        out.println(""</html>"");
    }
}","import java.io.*; import javax.servlet.*; import javax.servlet.http.*; import org.owasp.encoder.Encode; public class XSSFixedServlet extends HttpServlet { protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { String userInput = request.getParameter(""input""); // Properly escaping user input before outputting it to the response PrintWriter out = response.getWriter(); out.println(""<html>""); out.println(""<body>""); out.println(""<h1>User Input: "" + Encode.forHtml(userInput) + ""</h1>""); out.println(""</body>""); out.println(""</html>""); } }",java,0
Buffer Overflow,"#include <iostream>
#include <cstdio>

void unsafe_c_input() {
    char buffer[50];
    scanf(""%s"", buffer); // no length limit
    std::cout << buffer << std::endl;
}","#include <iostream>
#include <cstdio>

void unsafe_c_input() {
    char buffer[50];
    scanf(""%s"", buffer); // no length limit
    std::cout << buffer << std::endl;
}",cpp,1
Clear,"import java.sql.*;

public class SecureSQLInjectionExample {

    public static void main(String[] args) {
        String userInput = ""admin'; DROP TABLE users; --""; // Malicious input

        try {
            Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");
            
            String query = ""SELECT * FROM users WHERE username=?"";
            PreparedStatement pstmt = conn.prepareStatement(query);
            pstmt.setString(1, userInput);
            
            ResultSet rs = pstmt.executeQuery();

            while (rs.next()) {
                System.out.println(""Username: "" + rs.getString(""username""));
                System.out.println(""Password: "" + rs.getString(""password""));
            }

            conn.close();
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.*; public class SecureSQLInjectionExample { public static void main(String[] args) { String userInput = ""admin'; DROP TABLE users; --""; // Malicious input try { Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); String query = ""SELECT * FROM users WHERE username=?""; PreparedStatement pstmt = conn.prepareStatement(query); pstmt.setString(1, userInput); ResultSet rs = pstmt.executeQuery(); while (rs.next()) { System.out.println(""Username: "" + rs.getString(""username"")); System.out.println(""Password: "" + rs.getString(""password"")); } conn.close(); } catch (SQLException e) { e.printStackTrace(); } } }",java,0
Command Injection,"import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class CommandInjectionExample {

    public static void main(String[] args) {
        try {
            // Taking user input for the command to be executed
            System.out.print(""Enter a command to execute: "");
            BufferedReader br = new BufferedReader(new InputStreamReader(System.in));
            String command = br.readLine();

            // Executing the user input as a command using Runtime.getRuntime().exec()
            Process process = Runtime.getRuntime().exec(command);

            // Reading and printing the output of the executed command
            BufferedReader reader = new BufferedReader(new InputStreamReader(process.getInputStream()));
            String line;
            while ((line = reader.readLine()) != null) {
                System.out.println(line);
            }

        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}","import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class CommandInjectionExample { public static void main(String[] args) { try { // Taking user input for the command to be executed System.out.print(""Enter a command to execute: ""); BufferedReader br = new BufferedReader(new InputStreamReader(System.in)); String command = br.readLine(); // Executing the user input as a command using Runtime.getRuntime().exec() Process process = Runtime.getRuntime().exec(command); // Reading and printing the output of the executed command BufferedReader reader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = reader.readLine()) != null) { System.out.println(line); } } catch (IOException e) { e.printStackTrace(); } } }",java,1
Clear,"const shell = require('child_process');
const safeInput = userInput.replace(/[^a-zA-Z0-9.]/g, '');
shell.execFile('ping', [safeInput]); // Safe command execution
","const shell = require('child_process');
const safeInput = userInput.replace(/[^a-zA-Z0-9.]/g, '');
shell.execFile('ping', [safeInput]); // Safe command execution
",javascript,0
Clear,import org.owasp.encoder.Encode;,import org.owasp.encoder.Encode;,python,0
Clear,"#include <iostream>
#include <string>
#include <vector>

void safe_string_handling(const std::string& input) {
    std::string safe_copy = input;
    std::cout << safe_copy << std::endl;
}","#include <iostream>
#include <string>
#include <vector>

void safe_string_handling(const std::string& input) {
    std::string safe_copy = input;
    std::cout << safe_copy << std::endl;
}",cpp,0
Clear,"import java.io.IOException;
import java.io.PrintWriter;
import org.owasp.encoder.Encode;

public class XSSFixedCode {

    public static void main(String[] args) {
        String userInput = ""<script>alert('XSS Attack!')</script>"";

        // Properly handling user input by escaping and sanitizing it
        try {
            PrintWriter out = new PrintWriter(""output.html"");
            out.println(""<html>"");
            out.println(""<body>"");
            out.println(""<h1>Welcome, "" + Encode.forHtml(userInput) + ""</h1>"");
            out.println(""</body>"");
            out.println(""</html>"");
            out.close();
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}","import java.io.IOException; import java.io.PrintWriter; import org.owasp.encoder.Encode; public class XSSFixedCode { public static void main(String[] args) { String userInput = ""<script>alert('XSS Attack!')</script>""; // Properly handling user input by escaping and sanitizing it try { PrintWriter out = new PrintWriter(""output.html""); out.println(""<html>""); out.println(""<body>""); out.println(""<h1>Welcome, "" + Encode.forHtml(userInput) + ""</h1>""); out.println(""</body>""); out.println(""</html>""); out.close(); } catch (IOException e) { e.printStackTrace(); } } }",java,0
Clear,"<?php
$input = json_decode($_POST['data'], true); // Safe JSON parsing
if (json_last_error() === JSON_ERROR_NONE) {
    process_data($input);
}
?>","<?php
$input = json_decode($_POST['data'], true); // Safe JSON parsing
if (json_last_error() === JSON_ERROR_NONE) {
    process_data($input);
}
?>",php,0
SQL Injection,"import mysql.connector
def search_products(category):
    db = mysql.connector.connect(host=""localhost"", user=""user"", password=""pass"", database=""shop"")
    cursor = db.cursor()
    cursor.execute(""SELECT * FROM products WHERE category = '%s'"" % category)
    return cursor.fetchall()","import mysql.connector
def search_products(category):
    db = mysql.connector.connect(host=""localhost"", user=""user"", password=""pass"", database=""shop"")
    cursor = db.cursor()
    cursor.execute(""SELECT * FROM products WHERE category = '%s'"" % category)
    return cursor.fetchall()",python,1
SQL Injection,"app.get('/user/:id', (req, res) => {
    const query = `SELECT * FROM users WHERE id = ${req.params.id}`; // SQL Injection
    db.query(query, (err, result) => {
        res.json(result);
    });
});
","app.get('/user/:id', (req, res) => {
    const query = `SELECT * FROM users WHERE id = ${req.params.id}`; // SQL Injection
    db.query(query, (err, result) => {
        res.json(result);
    });
});
",javascript,1
SQL Injection,"import sqlite3
def get_user_data(username):
    conn = sqlite3.connect('database.db')
    cursor = conn.cursor()
    query = ""SELECT * FROM users WHERE username = '"" + username + ""'""
    cursor.execute(query)
    return cursor.fetchall()","import sqlite3
def get_user_data(username):
    conn = sqlite3.connect('database.db')
    cursor = conn.cursor()
    query = ""SELECT * FROM users WHERE username = '"" + username + ""'""
    cursor.execute(query)
    return cursor.fetchall()",python,1
Clear,"To fix the Command Injection vulnerability in the provided Java code snippet, you should sanitize and validate the user input to prevent malicious commands from being executed. One way to address this issue is by using a safer approach such as ProcessBuilder with explicit command and arguments instead of directly concatenating user input with the command.

Here is an updated version of the code that implements proper security measures:

```java
import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class CommandInjectionSecure {

    public static void main(String[] args) {
        try {
            // Taking user input for the command to execute
            BufferedReader br = new BufferedReader(new InputStreamReader(System.in));
            System.out.print(""Enter a command to execute: "");
            String userInput = br.readLine();

            // Sanitize and validate the user input
            if (!isValidCommand(userInput)) {
                System.out.println(""Invalid command. Please try again."");
                return;
            }

            // Execute the validated command using ProcessBuilder
            ProcessBuilder processBuilder = new ProcessBuilder(""ls"", userInput);
            Process process = processBuilder.start();

            // Reading the output of the executed command
            BufferedReader reader = new BufferedReader(new InputStreamReader(process.getInputStream()));
            String line;
            while ((line","To fix the Command Injection vulnerability in the provided Java code snippet, you should sanitize and validate the user input to prevent malicious commands from being executed. One way to address this issue is by using a safer approach such as ProcessBuilder with explicit command and arguments instead of directly concatenating user input with the command. Here is an updated version of the code that implements proper security measures: ```java import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class CommandInjectionSecure { public static void main(String[] args) { try { // Taking user input for the command to execute BufferedReader br = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a command to execute: ""); String userInput = br.readLine(); // Sanitize and validate the user input if (!isValidCommand(userInput)) { System.out.println(""Invalid command. Please try again.""); return; } // Execute the validated command using ProcessBuilder ProcessBuilder processBuilder = new ProcessBuilder(""ls"", userInput); Process process = processBuilder.start(); // Reading the output of the executed command BufferedReader reader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line",java,0
Buffer Overflow,"import java.util.Scanner;

public class BufferOverflowVulnerability {

    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        
        System.out.print(""Enter a string: "");
        String userInput = scanner.nextLine();
        
        // Creating a fixed-size buffer
        char[] buffer = new char[10];
        
        // Copying user input into the buffer without proper bounds checking
        userInput.getChars(0, userInput.length(), buffer, 0);
        
        System.out.println(""Buffer contents: "" + new String(buffer));
    }
}","import java.util.Scanner; public class BufferOverflowVulnerability { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter a string: ""); String userInput = scanner.nextLine(); // Creating a fixed-size buffer char[] buffer = new char[10]; // Copying user input into the buffer without proper bounds checking userInput.getChars(0, userInput.length(), buffer, 0); System.out.println(""Buffer contents: "" + new String(buffer)); } }",java,1
Cross-Site Scripting (XSS),"import java.io.*;

public class XSSVulnerabilityExample {
    public static void main(String[] args) throws IOException {
        BufferedReader br = new BufferedReader(new InputStreamReader(System.in));

        System.out.print(""Enter your name: "");
        String userName = br.readLine();

        // Improperly handling user input by directly outputting it to the webpage
        System.out.println(""<h1>Welcome, "" + userName + ""!</h1>"");
    }
}","import java.io.*; public class XSSVulnerabilityExample { public static void main(String[] args) throws IOException { BufferedReader br = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter your name: ""); String userName = br.readLine(); // Improperly handling user input by directly outputting it to the webpage System.out.println(""<h1>Welcome, "" + userName + ""!</h1>""); } }",java,1
Clear,"#include <iostream>
#include <sstream>

int safe_string_to_int(const std::string& str) {
    std::stringstream ss(str);
    int value;
    if (ss >> value) {
        return value;
    }
    throw std::invalid_argument(""Invalid integer"");
}","#include <iostream>
#include <sstream>

int safe_string_to_int(const std::string& str) {
    std::stringstream ss(str);
    int value;
    if (ss >> value) {
        return value;
    }
    throw std::invalid_argument(""Invalid integer"");
}",cpp,0
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Clear,"import yaml
def safe_yaml_load(config_str):
    return yaml.safe_load(config_str)","import yaml
def safe_yaml_load(config_str):
    return yaml.safe_load(config_str)",python,0
Clear,"import java.sql.*;

public class SecureSQLInjectionExample {

    public static void main(String[] args) {
        String userInput = ""'; DROP TABLE users; --""; // Malicious input

        try {
            Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");

            String query = ""SELECT * FROM users WHERE username = ?"";
            PreparedStatement stmt = conn.prepareStatement(query);
            stmt.setString(1, userInput);

            ResultSet rs = stmt.executeQuery();

            while (rs.next()) {
                System.out.println(rs.getString(""username""));
            }

            conn.close();
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.*; public class SecureSQLInjectionExample { public static void main(String[] args) { String userInput = ""'; DROP TABLE users; --""; // Malicious input try { Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); String query = ""SELECT * FROM users WHERE username = ?""; PreparedStatement stmt = conn.prepareStatement(query); stmt.setString(1, userInput); ResultSet rs = stmt.executeQuery(); while (rs.next()) { System.out.println(rs.getString(""username"")); } conn.close(); } catch (SQLException e) { e.printStackTrace(); } } }",java,0
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Memory Corruption,"#include <iostream>

void unsafe_virtual_call() {
    // Potential vtable corruption vulnerability
    class Base {
    public:
        virtual void func() { std::cout << ""Base"" << std::endl; }
    };
    
    class Derived : public Base {
    public:
        void func() override { std::cout << ""Derived"" << std::endl; }
    };
}","#include <iostream>

void unsafe_virtual_call() {
    // Potential vtable corruption vulnerability
    class Base {
    public:
        virtual void func() { std::cout << ""Base"" << std::endl; }
    };
    
    class Derived : public Base {
    public:
        void func() override { std::cout << ""Derived"" << std::endl; }
    };
}",cpp,1
Cross-Site Scripting (XSS),"import java.io.IOException;
import java.io.PrintWriter;
import javax.servlet.ServletException;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

public class XSSVulnerableServlet extends HttpServlet {
    
    @Override
    protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        String userInput = request.getParameter(""input"");
        
        // Improperly handling user input without any validation or sanitization
        String output = ""<p>User input: "" + userInput + ""</p>"";
        
        response.setContentType(""text/html"");
        PrintWriter out = response.getWriter();
        out.println(""<html><body>"");
        out.println(output);
        out.println(""</body></html>"");
    }
}","import java.io.IOException; import java.io.PrintWriter; import javax.servlet.ServletException; import javax.servlet.http.HttpServlet; import javax.servlet.http.HttpServletRequest; import javax.servlet.http.HttpServletResponse; public class XSSVulnerableServlet extends HttpServlet { @Override protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { String userInput = request.getParameter(""input""); // Improperly handling user input without any validation or sanitization String output = ""<p>User input: "" + userInput + ""</p>""; response.setContentType(""text/html""); PrintWriter out = response.getWriter(); out.println(""<html><body>""); out.println(output); out.println(""</body></html>""); } }",java,1
Clear,"To fix the Command Injection vulnerability in the provided Java code snippet, you should avoid directly executing user input as a command. Instead, you should validate and sanitize the input to ensure that it does not contain any malicious commands. One approach to achieve this is by using a whitelist approach where you only allow specific inputs.

Here is an improved version of the code with security measures implemented:

```java
import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class SecureCommandExecution {

    public static void main(String[] args) {
        try {
            BufferedReader br = new BufferedReader(new InputStreamReader(System.in));
            System.out.print(""Enter a file name: "");
            String fileName = br.readLine();

            // Validate and sanitize the input
            if (isValidFileName(fileName)) {
                // Safe code: executing a predefined command safely
                Process process = Runtime.getRuntime().exec(""cat "" + fileName);

                BufferedReader reader = new BufferedReader(new InputStreamReader(process.getInputStream()));
                String line;
                while ((line = reader.readLine()) != null) {
                    System.out.println(line);
                }
            } else {
                System.out.println(""Invalid file name. Please try again."");
            }
        } catch (IOException e) {
            e.printStackTrace();
        }","To fix the Command Injection vulnerability in the provided Java code snippet, you should avoid directly executing user input as a command. Instead, you should validate and sanitize the input to ensure that it does not contain any malicious commands. One approach to achieve this is by using a whitelist approach where you only allow specific inputs. Here is an improved version of the code with security measures implemented: ```java import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class SecureCommandExecution { public static void main(String[] args) { try { BufferedReader br = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a file name: ""); String fileName = br.readLine(); // Validate and sanitize the input if (isValidFileName(fileName)) { // Safe code: executing a predefined command safely Process process = Runtime.getRuntime().exec(""cat "" + fileName); BufferedReader reader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = reader.readLine()) != null) { System.out.println(line); } } else { System.out.println(""Invalid file name. Please try again.""); } } catch (IOException e) { e.printStackTrace(); }",java,0
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Command Injection,"import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class CommandInjectionExample {

    public static void main(String[] args) {
        try {
            BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));
            System.out.print(""Enter a command to execute: "");
            String command = reader.readLine();

            // Vulnerable code where user input is directly passed to the system shell
            Process process = Runtime.getRuntime().exec(""ping "" + command);

            BufferedReader inputReader = new BufferedReader(new InputStreamReader(process.getInputStream()));
            String line;
            while ((line = inputReader.readLine()) != null) {
                System.out.println(line);
            }

        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}","import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class CommandInjectionExample { public static void main(String[] args) { try { BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a command to execute: ""); String command = reader.readLine(); // Vulnerable code where user input is directly passed to the system shell Process process = Runtime.getRuntime().exec(""ping "" + command); BufferedReader inputReader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = inputReader.readLine()) != null) { System.out.println(line); } } catch (IOException e) { e.printStackTrace(); } } }",java,1
Clear,"#include <iostream>
#include <string>
#include <vector>

void safe_string_handling(const std::string& input) {
    std::string safe_copy = input;
    std::cout << safe_copy << std::endl;
}","#include <iostream>
#include <string>
#include <vector>

void safe_string_handling(const std::string& input) {
    std::string safe_copy = input;
    std::cout << safe_copy << std::endl;
}",cpp,0
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Path Traversal,"def get_user_file(username, filepath):
    import os
    base_path = f""/home/{username}/files/""
    full_path = base_path + filepath
    with open(full_path, 'r') as f:
        return f.read()","def get_user_file(username, filepath):
    import os
    base_path = f""/home/{username}/files/""
    full_path = base_path + filepath
    with open(full_path, 'r') as f:
        return f.read()",python,1
Clear,"<?php
$username = $_POST['username'];
$stmt = $pdo->prepare(""SELECT * FROM users WHERE username = ?"");
$stmt->execute([$username]); // Parameterized query
?>","<?php
$username = $_POST['username'];
$stmt = $pdo->prepare(""SELECT * FROM users WHERE username = ?"");
$stmt->execute([$username]); // Parameterized query
?>",php,0
Clear,"To fix the Command Injection vulnerability in the provided Java code snippet, you should sanitize the user input and use proper mechanisms to securely execute commands. Here's an improved version of the code that addresses these security concerns:

```java
import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class SecureCommandExecution {

    public static void main(String[] args) {
        try {
            BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));
            System.out.print(""Enter a command to execute: "");
            String userInput = reader.readLine();

            // Sanitize user input to prevent command injection
            if (!isValidInput(userInput)) {
                System.out.println(""Invalid input. Please enter a valid command."");
                return;
            }

            // Execute the command securely using ProcessBuilder
            ProcessBuilder processBuilder = new ProcessBuilder();
            processBuilder.command(""ping"", userInput);
            Process process = processBuilder.start();

            BufferedReader inputReader = new BufferedReader(new InputStreamReader(process.getInputStream()));
            String inputLine;
            while ((inputLine = inputReader.readLine()) != null) {
                System.out.println(inputLine);
            }

        } catch (IOException e) {
            e.printStackTrace();
        }
    }

    private static boolean isValidInput(String userInput)","To fix the Command Injection vulnerability in the provided Java code snippet, you should sanitize the user input and use proper mechanisms to securely execute commands. Here's an improved version of the code that addresses these security concerns: ```java import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class SecureCommandExecution { public static void main(String[] args) { try { BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a command to execute: ""); String userInput = reader.readLine(); // Sanitize user input to prevent command injection if (!isValidInput(userInput)) { System.out.println(""Invalid input. Please enter a valid command.""); return; } // Execute the command securely using ProcessBuilder ProcessBuilder processBuilder = new ProcessBuilder(); processBuilder.command(""ping"", userInput); Process process = processBuilder.start(); BufferedReader inputReader = new BufferedReader(new InputStreamReader(process.getInputStream())); String inputLine; while ((inputLine = inputReader.readLine()) != null) { System.out.println(inputLine); } } catch (IOException e) { e.printStackTrace(); } } private static boolean isValidInput(String userInput)",java,0
Clear,"import java.util.Scanner;

public class SecureBuffer {
    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        
        System.out.print(""Enter a string: "");
        String userInput = scanner.nextLine();
        
        // Define a safe buffer size to prevent buffer overflow
        int bufferSize = 10;
        
        char[] buffer = new char[bufferSize];
        
        // Copy user input into the buffer with bounds checking
        for (int i = 0; i < userInput.length() && i < bufferSize; i++) {
            buffer[i] = userInput.charAt(i);
        }
        
        System.out.println(""Buffer contents: "" + new String(buffer));
    }
}","import java.util.Scanner; public class SecureBuffer { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter a string: ""); String userInput = scanner.nextLine(); // Define a safe buffer size to prevent buffer overflow int bufferSize = 10; char[] buffer = new char[bufferSize]; // Copy user input into the buffer with bounds checking for (int i = 0; i < userInput.length() && i < bufferSize; i++) { buffer[i] = userInput.charAt(i); } System.out.println(""Buffer contents: "" + new String(buffer)); } }",java,0
SQL Injection,"import mysql.connector
def search_products(category):
    db = mysql.connector.connect(host=""localhost"", user=""user"", password=""pass"", database=""shop"")
    cursor = db.cursor()
    cursor.execute(""SELECT * FROM products WHERE category = '%s'"" % category)
    return cursor.fetchall()","import mysql.connector
def search_products(category):
    db = mysql.connector.connect(host=""localhost"", user=""user"", password=""pass"", database=""shop"")
    cursor = db.cursor()
    cursor.execute(""SELECT * FROM products WHERE category = '%s'"" % category)
    return cursor.fetchall()",python,1
SQL Injection,"import sqlite3
def get_user_data(username):
    conn = sqlite3.connect('database.db')
    cursor = conn.cursor()
    query = ""SELECT * FROM users WHERE username = '"" + username + ""'""
    cursor.execute(query)
    return cursor.fetchall()","import sqlite3
def get_user_data(username):
    conn = sqlite3.connect('database.db')
    cursor = conn.cursor()
    query = ""SELECT * FROM users WHERE username = '"" + username + ""'""
    cursor.execute(query)
    return cursor.fetchall()",python,1
SQL Injection,"import java.sql.*;

public class SQLInjectionVulnerableCode {

    public static void main(String[] args) {
        String userInput = ""'; DROP TABLE users; --""; // Malicious input that simulates a SQL Injection attack

        try {
            Connection connection = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");
            Statement statement = connection.createStatement();

            // Vulnerable code - concatenating user input directly into the SQL query
            String query = ""SELECT * FROM users WHERE username = '"" + userInput + ""'"";
            ResultSet resultSet = statement.executeQuery(query);

            while (resultSet.next()) {
                System.out.println(resultSet.getString(""username""));
            }

        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.*; public class SQLInjectionVulnerableCode { public static void main(String[] args) { String userInput = ""'; DROP TABLE users; --""; // Malicious input that simulates a SQL Injection attack try { Connection connection = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); Statement statement = connection.createStatement(); // Vulnerable code - concatenating user input directly into the SQL query String query = ""SELECT * FROM users WHERE username = '"" + userInput + ""'""; ResultSet resultSet = statement.executeQuery(query); while (resultSet.next()) { System.out.println(resultSet.getString(""username"")); } } catch (SQLException e) { e.printStackTrace(); } } }",java,1
Clear,"const token = process.env.API_TOKEN; // Environment variable
fetch('/api/data', {
    headers: { 'Authorization': `Bearer ${token}` }
});
","const token = process.env.API_TOKEN; // Environment variable
fetch('/api/data', {
    headers: { 'Authorization': `Bearer ${token}` }
});
",javascript,0
Clear,"#include <stdio.h>
#include <string.h>

int validate_input(const char *input) {
    if (input == NULL) return 0;
    for (int i = 0; input[i] != '\0'; i++) {
        if (input[i] < 32 || input[i] > 126) {
            return 0; // invalid character
        }
    }
    return 1;
}","#include <stdio.h>
#include <string.h>

int validate_input(const char *input) {
    if (input == NULL) return 0;
    for (int i = 0; input[i] != '\0'; i++) {
        if (input[i] < 32 || input[i] > 126) {
            return 0; // invalid character
        }
    }
    return 1;
}",c,0
Clear,"#include <stdio.h>
#include <string.h>

int validate_input(const char *input) {
    if (input == NULL) return 0;
    for (int i = 0; input[i] != '\0'; i++) {
        if (input[i] < 32 || input[i] > 126) {
            return 0; // invalid character
        }
    }
    return 1;
}","#include <stdio.h>
#include <string.h>

int validate_input(const char *input) {
    if (input == NULL) return 0;
    for (int i = 0; input[i] != '\0'; i++) {
        if (input[i] < 32 || input[i] > 126) {
            return 0; // invalid character
        }
    }
    return 1;
}",c,0
Buffer Overflow,"import java.util.Scanner;

public class BufferOverflowVulnerability {

    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        
        System.out.print(""Enter a string: "");
        String userInput = scanner.next();
        
        char[] buffer = new char[10];
        
        // Copy the user input into the buffer without proper bounds checking
        userInput.getChars(0, userInput.length(), buffer, 0);
        
        System.out.println(""Buffer content: "" + new String(buffer));
    }
}","import java.util.Scanner; public class BufferOverflowVulnerability { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter a string: ""); String userInput = scanner.next(); char[] buffer = new char[10]; // Copy the user input into the buffer without proper bounds checking userInput.getChars(0, userInput.length(), buffer, 0); System.out.println(""Buffer content: "" + new String(buffer)); } }",java,1
Hardcoded Secrets,"import requests
def call_api():
    api_key = ""sk_live_1234567890abcdef""
    headers = {'Authorization': f'Bearer {api_key}'}
    return requests.get('https://api.example.com/data', headers=headers)","import requests
def call_api():
    api_key = ""sk_live_1234567890abcdef""
    headers = {'Authorization': f'Bearer {api_key}'}
    return requests.get('https://api.example.com/data', headers=headers)",python,1
File Inclusion,"<?php
$file = $_GET['file'];
include($file); // File Inclusion
?>","<?php
$file = $_GET['file'];
include($file); // File Inclusion
?>",php,1
Clear,"To fix the Path Traversal vulnerability in the provided Java code snippet, you should ensure that the user input does not allow for directory traversal attacks. Here's an improved version of the code that sanitizes the user input and prevents path traversal:

```java
import java.io.File;
import java.io.FileInputStream;
import java.io.IOException;

public class SecurePathTraversal {

    public static void main(String[] args) {
        if (args.length < 1) {
            System.out.println(""Please provide a file name."");
            return;
        }

        String userInput = args[0]; // Simulating user input

        // Sanitize the user input to prevent path traversal
        if (!isValidFileName(userInput)) {
            System.out.println(""Invalid file name."");
            return;
        }

        String directory = ""/path/to/directory/"";
        String filePath = directory + userInput; // User input is concatenated with the directory path

        try {
            File file = new File(filePath);
            if (!file.getCanonicalPath().startsWith(directory)) {
                System.out.println(""Access to files outside the specified directory is not allowed."");
                return;
            }

            FileInputStream fis = new FileInputStream(file);

            int content;
            while ((content = fis.read()) !=","To fix the Path Traversal vulnerability in the provided Java code snippet, you should ensure that the user input does not allow for directory traversal attacks. Here's an improved version of the code that sanitizes the user input and prevents path traversal: ```java import java.io.File; import java.io.FileInputStream; import java.io.IOException; public class SecurePathTraversal { public static void main(String[] args) { if (args.length < 1) { System.out.println(""Please provide a file name.""); return; } String userInput = args[0]; // Simulating user input // Sanitize the user input to prevent path traversal if (!isValidFileName(userInput)) { System.out.println(""Invalid file name.""); return; } String directory = ""/path/to/directory/""; String filePath = directory + userInput; // User input is concatenated with the directory path try { File file = new File(filePath); if (!file.getCanonicalPath().startsWith(directory)) { System.out.println(""Access to files outside the specified directory is not allowed.""); return; } FileInputStream fis = new FileInputStream(file); int content; while ((content = fis.read()) !=",java,0
Command Injection,"import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class CommandInjectionExample {

    public static void main(String[] args) {
        try {
            BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));
            System.out.print(""Enter the IP address to ping: "");
            String ipAddress = reader.readLine();

            // Vulnerable code - User input directly concatenated into the command
            String command = ""ping "" + ipAddress;

            Process process = Runtime.getRuntime().exec(command);
            BufferedReader inputReader = new BufferedReader(new InputStreamReader(process.getInputStream()));
            
            String inputLine;
            while ((inputLine = inputReader.readLine()) != null) {
                System.out.println(inputLine);
            }

        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}","import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class CommandInjectionExample { public static void main(String[] args) { try { BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter the IP address to ping: ""); String ipAddress = reader.readLine(); // Vulnerable code - User input directly concatenated into the command String command = ""ping "" + ipAddress; Process process = Runtime.getRuntime().exec(command); BufferedReader inputReader = new BufferedReader(new InputStreamReader(process.getInputStream())); String inputLine; while ((inputLine = inputReader.readLine()) != null) { System.out.println(inputLine); } } catch (IOException e) { e.printStackTrace(); } } }",java,1
Command Injection,"<?php
$cmd = $_GET['cmd'];
system($cmd); // Command Injection
?>","<?php
$cmd = $_GET['cmd'];
system($cmd); // Command Injection
?>",php,1
Command Injection,"import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class CommandInjectionVulnerable {

    public static void main(String[] args) {
        try {
            BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));
            System.out.print(""Enter a command to execute: "");
            String command = reader.readLine();

            // This is the vulnerable part where user input is directly used in executing a command
            Process process = Runtime.getRuntime().exec(command);

            BufferedReader outputReader = new BufferedReader(new InputStreamReader(process.getInputStream()));
            String line;
            while ((line = outputReader.readLine()) != null) {
                System.out.println(line);
            }

        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}","import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class CommandInjectionVulnerable { public static void main(String[] args) { try { BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a command to execute: ""); String command = reader.readLine(); // This is the vulnerable part where user input is directly used in executing a command Process process = Runtime.getRuntime().exec(command); BufferedReader outputReader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = outputReader.readLine()) != null) { System.out.println(line); } } catch (IOException e) { e.printStackTrace(); } } }",java,1
Clear,"#include <iostream>
#include <vector>
#include <stdexcept>

int safe_vector_access(const std::vector<int>& vec, size_t index) {
    if (index >= vec.size()) {
        throw std::out_of_range(""Index out of range"");
    }
    return vec[index];
}","#include <iostream>
#include <vector>
#include <stdexcept>

int safe_vector_access(const std::vector<int>& vec, size_t index) {
    if (index >= vec.size()) {
        throw std::out_of_range(""Index out of range"");
    }
    return vec[index];
}",cpp,0
Clear,"#include <stdio.h>
#include <string.h>

int validate_input(const char *input) {
    if (input == NULL) return 0;
    for (int i = 0; input[i] != '\0'; i++) {
        if (input[i] < 32 || input[i] > 126) {
            return 0; // invalid character
        }
    }
    return 1;
}","#include <stdio.h>
#include <string.h>

int validate_input(const char *input) {
    if (input == NULL) return 0;
    for (int i = 0; input[i] != '\0'; i++) {
        if (input[i] < 32 || input[i] > 126) {
            return 0; // invalid character
        }
    }
    return 1;
}",c,0
Cross-Site Scripting (XSS),"import java.io.IOException;
import java.io.PrintWriter;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

public class VulnerableServlet extends HttpServlet {
    
    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws IOException {
        String userInput = request.getParameter(""input"");
        
        // Improperly handling user input by directly outputting it to the response
        PrintWriter out = response.getWriter();
        out.println(""<html>"");
        out.println(""<head><title>XSS Vulnerability</title></head>"");
        out.println(""<body>"");
        out.println(""<h1>User Input: "" + userInput + ""</h1>"");
        out.println(""</body>"");
        out.println(""</html>"");
    }
}","import java.io.IOException; import java.io.PrintWriter; import javax.servlet.http.HttpServlet; import javax.servlet.http.HttpServletRequest; import javax.servlet.http.HttpServletResponse; public class VulnerableServlet extends HttpServlet { protected void doGet(HttpServletRequest request, HttpServletResponse response) throws IOException { String userInput = request.getParameter(""input""); // Improperly handling user input by directly outputting it to the response PrintWriter out = response.getWriter(); out.println(""<html>""); out.println(""<head><title>XSS Vulnerability</title></head>""); out.println(""<body>""); out.println(""<h1>User Input: "" + userInput + ""</h1>""); out.println(""</body>""); out.println(""</html>""); } }",java,1
XSS,"<?php
echo $_GET['message']; // XSS
?>","<?php
echo $_GET['message']; // XSS
?>",php,1
Cross-Site Scripting (XSS),"import java.io.IOException;
import java.io.PrintWriter;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

public class XSSVulnerableServlet extends HttpServlet {

    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws IOException {
        String userInput = request.getParameter(""input"");
        
        // Improper handling of user input without proper encoding
        PrintWriter out = response.getWriter();
        out.println(""<html>"");
        out.println(""<body>"");
        out.println(""<h1>User Input: "" + userInput + ""</h1>""); // User input directly embedded in the HTML response
        out.println(""</body>"");
        out.println(""</html>"");
    }
}","import java.io.IOException; import java.io.PrintWriter; import javax.servlet.http.HttpServlet; import javax.servlet.http.HttpServletRequest; import javax.servlet.http.HttpServletResponse; public class XSSVulnerableServlet extends HttpServlet { protected void doGet(HttpServletRequest request, HttpServletResponse response) throws IOException { String userInput = request.getParameter(""input""); // Improper handling of user input without proper encoding PrintWriter out = response.getWriter(); out.println(""<html>""); out.println(""<body>""); out.println(""<h1>User Input: "" + userInput + ""</h1>""); // User input directly embedded in the HTML response out.println(""</body>""); out.println(""</html>""); } }",java,1
Command Injection,"import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class CommandInjectionExample {

    public static void main(String[] args) {
        try {
            BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));
            System.out.print(""Enter a command to execute: "");
            String command = reader.readLine();

            Process process = Runtime.getRuntime().exec(""ls "" + command);

            BufferedReader inputReader = new BufferedReader(new InputStreamReader(process.getInputStream()));
            String line;
            while ((line = inputReader.readLine()) != null) {
                System.out.println(line);
            }

        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}","import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class CommandInjectionExample { public static void main(String[] args) { try { BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a command to execute: ""); String command = reader.readLine(); Process process = Runtime.getRuntime().exec(""ls "" + command); BufferedReader inputReader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = inputReader.readLine()) != null) { System.out.println(line); } } catch (IOException e) { e.printStackTrace(); } } }",java,1
Buffer Overflow,"import java.util.Scanner;

public class BufferOverflowExample {
    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        
        System.out.print(""Enter your name: "");
        String name = scanner.nextLine();
        
        // Vulnerability: Improperly handling user input may lead to buffer overflow
        char[] buffer = new char[10];
        name.getChars(0, name.length(), buffer, 0);
        
        System.out.println(""Hello, "" + new String(buffer));
    }
}","import java.util.Scanner; public class BufferOverflowExample { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter your name: ""); String name = scanner.nextLine(); // Vulnerability: Improperly handling user input may lead to buffer overflow char[] buffer = new char[10]; name.getChars(0, name.length(), buffer, 0); System.out.println(""Hello, "" + new String(buffer)); } }",java,1
Command Injection,"<?php
$cmd = $_GET['cmd'];
system($cmd); // Command Injection
?>","<?php
$cmd = $_GET['cmd'];
system($cmd); // Command Injection
?>",php,1
Hardcoded Secrets,"localStorage.setItem('token', 'hardcoded-secret-token-123'); // Hardcoded secret
","localStorage.setItem('token', 'hardcoded-secret-token-123'); // Hardcoded secret
",javascript,1
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Command Injection,"import os
def ping_host(host):
    os.system(""ping -c 4 "" + host)","import os
def ping_host(host):
    os.system(""ping -c 4 "" + host)",python,1
Buffer Overflow,"import java.util.Scanner;

public class BufferOverflowExample {
    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        
        System.out.print(""Enter your name: "");
        String name = scanner.nextLine();
        
        // Vulnerability: Not checking the length of user input before using it in the buffer
        char[] buffer = new char[10];
        name.getChars(0, name.length(), buffer, 0);
        
        System.out.println(""Hello, "" + new String(buffer));
    }
}","import java.util.Scanner; public class BufferOverflowExample { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter your name: ""); String name = scanner.nextLine(); // Vulnerability: Not checking the length of user input before using it in the buffer char[] buffer = new char[10]; name.getChars(0, name.length(), buffer, 0); System.out.println(""Hello, "" + new String(buffer)); } }",java,1
Command Injection,"import subprocess
def list_directory(path):
    result = subprocess.run(f""ls {path}"", shell=True, capture_output=True, text=True)
    return result.stdout","import subprocess
def list_directory(path):
    result = subprocess.run(f""ls {path}"", shell=True, capture_output=True, text=True)
    return result.stdout",python,1
Command Injection,"import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class CommandInjectionExample {

    public static void main(String[] args) {
        try {
            Process process = Runtime.getRuntime().exec(""ping "" + getUserInput());
            BufferedReader reader = new BufferedReader(new InputStreamReader(process.getInputStream()));

            String line;
            while ((line = reader.readLine()) != null) {
                System.out.println(line);
            }
        } catch (IOException e) {
            e.printStackTrace();
        }
    }

    private static String getUserInput() throws IOException {
        BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));
        System.out.print(""Enter the IP address to ping: "");
        return reader.readLine();
    }
}","import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class CommandInjectionExample { public static void main(String[] args) { try { Process process = Runtime.getRuntime().exec(""ping "" + getUserInput()); BufferedReader reader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = reader.readLine()) != null) { System.out.println(line); } } catch (IOException e) { e.printStackTrace(); } } private static String getUserInput() throws IOException { BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter the IP address to ping: ""); return reader.readLine(); } }",java,1
XSS,"const userInput = document.location.search.split('=')[1];
document.write(userInput); // XSS
","const userInput = document.location.search.split('=')[1];
document.write(userInput); // XSS
",javascript,1
Clear,"#include <iostream>
#include <sstream>

int safe_string_to_int(const std::string& str) {
    std::stringstream ss(str);
    int value;
    if (ss >> value) {
        return value;
    }
    throw std::invalid_argument(""Invalid integer"");
}","#include <iostream>
#include <sstream>

int safe_string_to_int(const std::string& str) {
    std::stringstream ss(str);
    int value;
    if (ss >> value) {
        return value;
    }
    throw std::invalid_argument(""Invalid integer"");
}",cpp,0
Clear,"const userInput = new URLSearchParams(window.location.search).get('input');
const safeOutput = document.createElement('div');
safeOutput.textContent = userInput; // Safe DOM manipulation
document.body.appendChild(safeOutput);
","const userInput = new URLSearchParams(window.location.search).get('input');
const safeOutput = document.createElement('div');
safeOutput.textContent = userInput; // Safe DOM manipulation
document.body.appendChild(safeOutput);
",javascript,0
SQL Injection,"app.get('/user/:id', (req, res) => {
    const query = `SELECT * FROM users WHERE id = ${req.params.id}`; // SQL Injection
    db.query(query, (err, result) => {
        res.json(result);
    });
});
","app.get('/user/:id', (req, res) => {
    const query = `SELECT * FROM users WHERE id = ${req.params.id}`; // SQL Injection
    db.query(query, (err, result) => {
        res.json(result);
    });
});
",javascript,1
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Clear,"To fix the Command Injection vulnerability in the provided Java code snippet, you should avoid directly executing user input as a command. Instead, you can use ProcessBuilder to safely execute commands. Here is the updated code snippet with proper security measures implemented:

```java
import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;
import java.util.ArrayList;
import java.util.List;

public class SecureCommandExecutionExample {

    public static void main(String[] args) throws IOException, InterruptedException {
        BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));
        System.out.print(""Enter a command to execute: "");
        String command = reader.readLine();

        List<String> commandList = new ArrayList<>();
        commandList.add(""/bin/sh"");
        commandList.add(""-c"");
        commandList.add(command);

        ProcessBuilder processBuilder = new ProcessBuilder(commandList);
        Process process = processBuilder.start();

        BufferedReader outputReader = new BufferedReader(new InputStreamReader(process.getInputStream()));

        String line;
        while ((line = outputReader.readLine()) != null) {
            System.out.println(line);
        }

        int exitCode = process.waitFor();
        
        if (exitCode == 0) {
            System.out.println(""Command executed successfully."");
        } else {
            System.out","To fix the Command Injection vulnerability in the provided Java code snippet, you should avoid directly executing user input as a command. Instead, you can use ProcessBuilder to safely execute commands. Here is the updated code snippet with proper security measures implemented: ```java import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; import java.util.ArrayList; import java.util.List; public class SecureCommandExecutionExample { public static void main(String[] args) throws IOException, InterruptedException { BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a command to execute: ""); String command = reader.readLine(); List<String> commandList = new ArrayList<>(); commandList.add(""/bin/sh""); commandList.add(""-c""); commandList.add(command); ProcessBuilder processBuilder = new ProcessBuilder(commandList); Process process = processBuilder.start(); BufferedReader outputReader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = outputReader.readLine()) != null) { System.out.println(line); } int exitCode = process.waitFor(); if (exitCode == 0) { System.out.println(""Command executed successfully.""); } else { System.out",java,0
Clear,"<?php
$message = htmlspecialchars($_GET['message'], ENT_QUOTES, 'UTF-8');
echo $message; // Sanitized output
?>","<?php
$message = htmlspecialchars($_GET['message'], ENT_QUOTES, 'UTF-8');
echo $message; // Sanitized output
?>",php,0
Clear,"#include <stdio.h>
#include <string.h>

int validate_input(const char *input) {
    if (input == NULL) return 0;
    for (int i = 0; input[i] != '\0'; i++) {
        if (input[i] < 32 || input[i] > 126) {
            return 0; // invalid character
        }
    }
    return 1;
}","#include <stdio.h>
#include <string.h>

int validate_input(const char *input) {
    if (input == NULL) return 0;
    for (int i = 0; input[i] != '\0'; i++) {
        if (input[i] < 32 || input[i] > 126) {
            return 0; // invalid character
        }
    }
    return 1;
}",c,0
Clear,"const token = process.env.API_TOKEN; // Environment variable
fetch('/api/data', {
    headers: { 'Authorization': `Bearer ${token}` }
});
","const token = process.env.API_TOKEN; // Environment variable
fetch('/api/data', {
    headers: { 'Authorization': `Bearer ${token}` }
});
",javascript,0
Command Injection,"import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class CommandInjectionExample {

    public static void main(String[] args) throws IOException {
        BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));

        System.out.print(""Enter a file name: "");
        String fileName = reader.readLine();

        // Vulnerability: User input is directly passed to the command without proper validation
        String command = ""ls -l "" + fileName;

        // Execute the command
        Process process = Runtime.getRuntime().exec(command);

        BufferedReader outputReader = new BufferedReader(new InputStreamReader(process.getInputStream()));
        String line;
        while ((line = outputReader.readLine()) != null) {
            System.out.println(line);
        }
    }
}","import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class CommandInjectionExample { public static void main(String[] args) throws IOException { BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a file name: ""); String fileName = reader.readLine(); // Vulnerability: User input is directly passed to the command without proper validation String command = ""ls -l "" + fileName; // Execute the command Process process = Runtime.getRuntime().exec(command); BufferedReader outputReader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = outputReader.readLine()) != null) { System.out.println(line); } } }",java,1
XSS,"const userInput = document.location.search.split('=')[1];
document.write(userInput); // XSS
","const userInput = document.location.search.split('=')[1];
document.write(userInput); // XSS
",javascript,1
Clear,"#include <stdio.h>
#include <string.h>

int safe_buffer_operation(char *input) {
    char buffer[100];
    if (strlen(input) < sizeof(buffer)) {
        strcpy(buffer, input);
        return 0;
    }
    return -1; // buffer too small
}","#include <stdio.h>
#include <string.h>

int safe_buffer_operation(char *input) {
    char buffer[100];
    if (strlen(input) < sizeof(buffer)) {
        strcpy(buffer, input);
        return 0;
    }
    return -1; // buffer too small
}",c,0
Clear,"import requests
def safe_fetch_url(url):
    allowed_domains = ['example.com', 'api.trusted.com']
    from urllib.parse import urlparse
    domain = urlparse(url).netloc
    if domain not in allowed_domains:
        raise ValueError(""Domain not allowed"")
    return requests.get(url).text","import requests
def safe_fetch_url(url):
    allowed_domains = ['example.com', 'api.trusted.com']
    from urllib.parse import urlparse
    domain = urlparse(url).netloc
    if domain not in allowed_domains:
        raise ValueError(""Domain not allowed"")
    return requests.get(url).text",python,0
Clear,"<?php
$cmd = escapeshellarg($_GET['cmd']);
system(""ls "" . $cmd); // Escaped command
?>","<?php
$cmd = escapeshellarg($_GET['cmd']);
system(""ls "" . $cmd); // Escaped command
?>",php,0
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Clear,"import java.sql.*;

public class SecureCode {
    public static void main(String[] args) {
        String userInput = ""admin'; DROP TABLE users; --"";

        try {
            Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");
            
            String query = ""SELECT * FROM users WHERE username = ?"";
            PreparedStatement stmt = conn.prepareStatement(query);
            stmt.setString(1, userInput);
            
            ResultSet rs = stmt.executeQuery();
            
            while (rs.next()) {
                System.out.println(rs.getString(""username""));
            }
            
            conn.close();
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.*; public class SecureCode { public static void main(String[] args) { String userInput = ""admin'; DROP TABLE users; --""; try { Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); String query = ""SELECT * FROM users WHERE username = ?""; PreparedStatement stmt = conn.prepareStatement(query); stmt.setString(1, userInput); ResultSet rs = stmt.executeQuery(); while (rs.next()) { System.out.println(rs.getString(""username"")); } conn.close(); } catch (SQLException e) { e.printStackTrace(); } } }",java,0
Clear,"#include <iostream>
#include <vector>
#include <stdexcept>

int safe_vector_access(const std::vector<int>& vec, size_t index) {
    if (index >= vec.size()) {
        throw std::out_of_range(""Index out of range"");
    }
    return vec[index];
}","#include <iostream>
#include <vector>
#include <stdexcept>

int safe_vector_access(const std::vector<int>& vec, size_t index) {
    if (index >= vec.size()) {
        throw std::out_of_range(""Index out of range"");
    }
    return vec[index];
}",cpp,0
Clear,"app.get('/user/:id', (req, res) => {
    const userId = parseInt(req.params.id);
    db.query('SELECT * FROM users WHERE id = ?', [userId], (err, result) => {
        res.json(result);
    });
});
","app.get('/user/:id', (req, res) => {
    const userId = parseInt(req.params.id);
    db.query('SELECT * FROM users WHERE id = ?', [userId], (err, result) => {
        res.json(result);
    });
});
",javascript,0
Clear,"import os
def secure_file_access(username, filepath):
    base_dir = f""/home/{username}/files/""
    full_path = os.path.join(base_dir, filepath)
    full_path = os.path.normpath(full_path)
    if not full_path.startswith(base_dir):
        raise PermissionError(""Access denied"")
    with open(full_path, 'r') as f:
        return f.read()","import os
def secure_file_access(username, filepath):
    base_dir = f""/home/{username}/files/""
    full_path = os.path.join(base_dir, filepath)
    full_path = os.path.normpath(full_path)
    if not full_path.startswith(base_dir):
        raise PermissionError(""Access denied"")
    with open(full_path, 'r') as f:
        return f.read()",python,0
Clear,"#include <iostream>
#include <sstream>

int safe_string_to_int(const std::string& str) {
    std::stringstream ss(str);
    int value;
    if (ss >> value) {
        return value;
    }
    throw std::invalid_argument(""Invalid integer"");
}","#include <iostream>
#include <sstream>

int safe_string_to_int(const std::string& str) {
    std::stringstream ss(str);
    int value;
    if (ss >> value) {
        return value;
    }
    throw std::invalid_argument(""Invalid integer"");
}",cpp,0
Clear,"import com.google.gson.Gson;
import com.google.gson.JsonSyntaxException;

import java.io.*;

public class SecureDeserialization {

    public static void main(String[] args) {
        String serializedData = ""YOUR_SERIALIZED_DATA_HERE""; // Replace this with your serialized data

        try {
            Object deserializedObject = deserializeData(serializedData);
            System.out.println(""Deserialization successful: "" + deserializedObject.toString());
        } catch (Exception e) {
            System.err.println(""Error during deserialization: "" + e.getMessage());
        }
    }

    private static Object deserializeData(String serializedData) throws IOException, ClassNotFoundException {
        Gson gson = new Gson();
        return gson.fromJson(serializedData, Object.class);
    }
}","import com.google.gson.Gson; import com.google.gson.JsonSyntaxException; import java.io.*; public class SecureDeserialization { public static void main(String[] args) { String serializedData = ""YOUR_SERIALIZED_DATA_HERE""; // Replace this with your serialized data try { Object deserializedObject = deserializeData(serializedData); System.out.println(""Deserialization successful: "" + deserializedObject.toString()); } catch (Exception e) { System.err.println(""Error during deserialization: "" + e.getMessage()); } } private static Object deserializeData(String serializedData) throws IOException, ClassNotFoundException { Gson gson = new Gson(); return gson.fromJson(serializedData, Object.class); } }",java,0
Clear,"#include <stdio.h>
#include <string.h>

int safe_buffer_operation(char *input) {
    char buffer[100];
    if (strlen(input) < sizeof(buffer)) {
        strcpy(buffer, input);
        return 0;
    }
    return -1; // buffer too small
}","#include <stdio.h>
#include <string.h>

int safe_buffer_operation(char *input) {
    char buffer[100];
    if (strlen(input) < sizeof(buffer)) {
        strcpy(buffer, input);
        return 0;
    }
    return -1; // buffer too small
}",c,0
Clear,"#include <iostream>
#include <vector>
#include <stdexcept>

int safe_vector_access(const std::vector<int>& vec, size_t index) {
    if (index >= vec.size()) {
        throw std::out_of_range(""Index out of range"");
    }
    return vec[index];
}","#include <iostream>
#include <vector>
#include <stdexcept>

int safe_vector_access(const std::vector<int>& vec, size_t index) {
    if (index >= vec.size()) {
        throw std::out_of_range(""Index out of range"");
    }
    return vec[index];
}",cpp,0
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Insecure Deserialization,"import yaml
def load_config(config_str):
    return yaml.load(config_str, Loader=yaml.Loader)","import yaml
def load_config(config_str):
    return yaml.load(config_str, Loader=yaml.Loader)",python,1
Clear,"#include <stdio.h>
#include <stdlib.h>

int safe_string_to_int(const char *str) {
    char *endptr;
    long value = strtol(str, &endptr, 10);
    if (*endptr != '\0' || str == endptr) {
        return -1; // error
    }
    return (int)value;
}","#include <stdio.h>
#include <stdlib.h>

int safe_string_to_int(const char *str) {
    char *endptr;
    long value = strtol(str, &endptr, 10);
    if (*endptr != '\0' || str == endptr) {
        return -1; // error
    }
    return (int)value;
}",c,0
Memory Corruption,"#include <iostream>

void unsafe_virtual_call() {
    // Potential vtable corruption vulnerability
    class Base {
    public:
        virtual void func() { std::cout << ""Base"" << std::endl; }
    };
    
    class Derived : public Base {
    public:
        void func() override { std::cout << ""Derived"" << std::endl; }
    };
}","#include <iostream>

void unsafe_virtual_call() {
    // Potential vtable corruption vulnerability
    class Base {
    public:
        virtual void func() { std::cout << ""Base"" << std::endl; }
    };
    
    class Derived : public Base {
    public:
        void func() override { std::cout << ""Derived"" << std::endl; }
    };
}",cpp,1
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Clear,"import json
def parse_safe_json(json_str):
    try:
        return json.loads(json_str)
    except json.JSONDecodeError:
        raise ValueError(""Invalid JSON"")","import json
def parse_safe_json(json_str):
    try:
        return json.loads(json_str)
    except json.JSONDecodeError:
        raise ValueError(""Invalid JSON"")",python,0
Memory Corruption,"#include <iostream>

void unsafe_pointer_arithmetic(int* array, int size) {
    for (int i = 0; i <= size; i++) {
        std::cout << *(array + i) << std::endl; // potential out-of-bounds
    }
}","#include <iostream>

void unsafe_pointer_arithmetic(int* array, int size) {
    for (int i = 0; i <= size; i++) {
        std::cout << *(array + i) << std::endl; // potential out-of-bounds
    }
}",cpp,1
SQL Injection,"import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Statement;

public class SQLInjectionVulnerableCode {

    public static void main(String[] args) {
        String userInput = ""'; DROP TABLE users; --"";
        
        try {
            Connection connection = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");
            Statement statement = connection.createStatement();
            
            String query = ""SELECT * FROM users WHERE username = '"" + userInput + ""'"";
            ResultSet resultSet = statement.executeQuery(query);
            
            while (resultSet.next()) {
                System.out.println(""User ID: "" + resultSet.getInt(""id"") + "", Username: "" + resultSet.getString(""username""));
            }
            
            resultSet.close();
            statement.close();
            connection.close();
            
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.Connection; import java.sql.DriverManager; import java.sql.ResultSet; import java.sql.SQLException; import java.sql.Statement; public class SQLInjectionVulnerableCode { public static void main(String[] args) { String userInput = ""'; DROP TABLE users; --""; try { Connection connection = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); Statement statement = connection.createStatement(); String query = ""SELECT * FROM users WHERE username = '"" + userInput + ""'""; ResultSet resultSet = statement.executeQuery(query); while (resultSet.next()) { System.out.println(""User ID: "" + resultSet.getInt(""id"") + "", Username: "" + resultSet.getString(""username"")); } resultSet.close(); statement.close(); connection.close(); } catch (SQLException e) { e.printStackTrace(); } } }",java,1
Path Traversal,"import os
def read_file(filename):
    with open('/var/www/uploads/' + filename, 'r') as f:
        return f.read()","import os
def read_file(filename):
    with open('/var/www/uploads/' + filename, 'r') as f:
        return f.read()",python,1
Clear,"#include <stdio.h>
#include <stdlib.h>

void safe_file_operation(const char *filename) {
    FILE *file = fopen(filename, ""r"");
    if (file != NULL) {
        char buffer[256];
        while (fgets(buffer, sizeof(buffer), file)) {
            printf(""%s"", buffer);
        }
        fclose(file);
    }
}","#include <stdio.h>
#include <stdlib.h>

void safe_file_operation(const char *filename) {
    FILE *file = fopen(filename, ""r"");
    if (file != NULL) {
        char buffer[256];
        while (fgets(buffer, sizeof(buffer), file)) {
            printf(""%s"", buffer);
        }
        fclose(file);
    }
}",c,0
Clear,"import re
def validate_email(email):
    pattern = r'^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$'
    return bool(re.match(pattern, email))","import re
def validate_email(email):
    pattern = r'^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$'
    return bool(re.match(pattern, email))",python,0
Cross-Site Scripting (XSS),"import java.io.*;
import javax.servlet.*;
import javax.servlet.http.*;

public class XSSVulnerableServlet extends HttpServlet {
    
    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        String userInput = request.getParameter(""input"");
        
        String responseHtml = ""<html><body>User input: "" + userInput + ""</body></html>"";
        
        PrintWriter out = response.getWriter();
        out.println(responseHtml);
    }
}","import java.io.*; import javax.servlet.*; import javax.servlet.http.*; public class XSSVulnerableServlet extends HttpServlet { protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { String userInput = request.getParameter(""input""); String responseHtml = ""<html><body>User input: "" + userInput + ""</body></html>""; PrintWriter out = response.getWriter(); out.println(responseHtml); } }",java,1
Code Injection,"const userData = eval('(' + userInput + ')'); // eval injection
","const userData = eval('(' + userInput + ')'); // eval injection
",javascript,1
Memory Corruption,"#include <iostream>

void unsafe_pointer_arithmetic(int* array, int size) {
    for (int i = 0; i <= size; i++) {
        std::cout << *(array + i) << std::endl; // potential out-of-bounds
    }
}","#include <iostream>

void unsafe_pointer_arithmetic(int* array, int size) {
    for (int i = 0; i <= size; i++) {
        std::cout << *(array + i) << std::endl; // potential out-of-bounds
    }
}",cpp,1
Clear,"import yaml
def safe_yaml_load(config_str):
    return yaml.safe_load(config_str)","import yaml
def safe_yaml_load(config_str):
    return yaml.safe_load(config_str)",python,0
Clear,"const userData = JSON.parse(userInput); // Safe JSON parsing
if (userData && typeof userData === 'object') {
    processUserData(userData);
}
","const userData = JSON.parse(userInput); // Safe JSON parsing
if (userData && typeof userData === 'object') {
    processUserData(userData);
}
",javascript,0
SQL Injection,"import java.sql.*;

public class SQLInjectionVulnerableCode {
    public static void main(String[] args) {
        String userInput = ""'; DROP TABLE users; --"";
        
        try {
            Connection connection = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");
            Statement statement = connection.createStatement();
            
            // Vulnerable query construction
            String query = ""SELECT * FROM users WHERE username='"" + userInput + ""'"";
            
            ResultSet resultSet = statement.executeQuery(query);
            
            while(resultSet.next()) {
                System.out.println(resultSet.getString(""username""));
            }
            
            connection.close();
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.*; public class SQLInjectionVulnerableCode { public static void main(String[] args) { String userInput = ""'; DROP TABLE users; --""; try { Connection connection = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); Statement statement = connection.createStatement(); // Vulnerable query construction String query = ""SELECT * FROM users WHERE username='"" + userInput + ""'""; ResultSet resultSet = statement.executeQuery(query); while(resultSet.next()) { System.out.println(resultSet.getString(""username"")); } connection.close(); } catch (SQLException e) { e.printStackTrace(); } } }",java,1
SQL Injection,"import java.sql.*;

public class SQLInjectionVulnerability {
    public static void main(String[] args) {
        String userInput = ""'; DROP TABLE users; --"";
        
        try {
            Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");
            
            Statement stmt = conn.createStatement();
            
            String query = ""SELECT * FROM users WHERE username='"" + userInput + ""'"";
            
            ResultSet rs = stmt.executeQuery(query);
            
            while (rs.next()) {
                System.out.println(rs.getString(""username""));
            }
            
            conn.close();
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.*; public class SQLInjectionVulnerability { public static void main(String[] args) { String userInput = ""'; DROP TABLE users; --""; try { Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); Statement stmt = conn.createStatement(); String query = ""SELECT * FROM users WHERE username='"" + userInput + ""'""; ResultSet rs = stmt.executeQuery(query); while (rs.next()) { System.out.println(rs.getString(""username"")); } conn.close(); } catch (SQLException e) { e.printStackTrace(); } } }",java,1
Clear,"const token = process.env.API_TOKEN; // Environment variable
fetch('/api/data', {
    headers: { 'Authorization': `Bearer ${token}` }
});
","const token = process.env.API_TOKEN; // Environment variable
fetch('/api/data', {
    headers: { 'Authorization': `Bearer ${token}` }
});
",javascript,0
SQL Injection,"import psycopg2
def admin_login(admin_id):
    conn = psycopg2.connect(""dbname=test user=postgres"")
    cur = conn.cursor()
    cur.execute(f""SELECT * FROM admins WHERE id = {admin_id}"")
    return cur.fetchone()","import psycopg2
def admin_login(admin_id):
    conn = psycopg2.connect(""dbname=test user=postgres"")
    cur = conn.cursor()
    cur.execute(f""SELECT * FROM admins WHERE id = {admin_id}"")
    return cur.fetchone()",python,1
Path Traversal,"import os
def read_file(filename):
    with open('/var/www/uploads/' + filename, 'r') as f:
        return f.read()","import os
def read_file(filename):
    with open('/var/www/uploads/' + filename, 'r') as f:
        return f.read()",python,1
Clear,"#include <iostream>
#include <vector>
#include <stdexcept>

int safe_vector_access(const std::vector<int>& vec, size_t index) {
    if (index >= vec.size()) {
        throw std::out_of_range(""Index out of range"");
    }
    return vec[index];
}","#include <iostream>
#include <vector>
#include <stdexcept>

int safe_vector_access(const std::vector<int>& vec, size_t index) {
    if (index >= vec.size()) {
        throw std::out_of_range(""Index out of range"");
    }
    return vec[index];
}",cpp,0
Command Injection,"import os
def ping_host(host):
    os.system(""ping -c 4 "" + host)","import os
def ping_host(host):
    os.system(""ping -c 4 "" + host)",python,1
Path Traversal,"import os
def read_file(filename):
    with open('/var/www/uploads/' + filename, 'r') as f:
        return f.read()","import os
def read_file(filename):
    with open('/var/www/uploads/' + filename, 'r') as f:
        return f.read()",python,1
Clear,"from flask import Flask, request
import html
app = Flask(__name__)

@app.route('/search_safe')
def search_safe():
    query = request.args.get('q', '')
    safe_query = html.escape(query)
    return f'<h1>Search results for: {safe_query}</h1>'","from flask import Flask, request
import html
app = Flask(__name__)

@app.route('/search_safe')
def search_safe():
    query = request.args.get('q', '')
    safe_query = html.escape(query)
    return f'<h1>Search results for: {safe_query}</h1>'",python,0
Cross-Site Scripting (XSS),"import java.io.IOException;
import java.io.PrintWriter;
import javax.servlet.ServletException;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

public class VulnerableServlet extends HttpServlet {
    protected void doGet(HttpServletRequest request, HttpServletResponse response)
            throws ServletException, IOException {
        String userInput = request.getParameter(""input"");
        
        response.setContentType(""text/html"");
        PrintWriter out = response.getWriter();
        
        out.println(""<html>"");
        out.println(""<head><title>XSS Vulnerability Example</title></head>"");
        out.println(""<body>"");
        
        // This line is vulnerable to XSS
        out.println(""<p>User Input: "" + userInput + ""</p>"");
        
        out.println(""</body>"");
        out.println(""</html>"");
    }
}","import java.io.IOException; import java.io.PrintWriter; import javax.servlet.ServletException; import javax.servlet.http.HttpServlet; import javax.servlet.http.HttpServletRequest; import javax.servlet.http.HttpServletResponse; public class VulnerableServlet extends HttpServlet { protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { String userInput = request.getParameter(""input""); response.setContentType(""text/html""); PrintWriter out = response.getWriter(); out.println(""<html>""); out.println(""<head><title>XSS Vulnerability Example</title></head>""); out.println(""<body>""); // This line is vulnerable to XSS out.println(""<p>User Input: "" + userInput + ""</p>""); out.println(""</body>""); out.println(""</html>""); } }",java,1
Clear,"const shell = require('child_process');
const safeInput = userInput.replace(/[^a-zA-Z0-9.]/g, '');
shell.execFile('ping', [safeInput]); // Safe command execution
","const shell = require('child_process');
const safeInput = userInput.replace(/[^a-zA-Z0-9.]/g, '');
shell.execFile('ping', [safeInput]); // Safe command execution
",javascript,0
Cross-Site Scripting (XSS),"import java.io.*;

public class XSSVulnerableCode {

    public static void main(String[] args) {
        String userInput = ""<script>alert('XSS Vulnerability!')</script>"";
        
        // Improperly handling user input by directly outputting it to a webpage
        System.out.println(""<div>"" + userInput + ""</div>"");
    }
}","import java.io.*; public class XSSVulnerableCode { public static void main(String[] args) { String userInput = ""<script>alert('XSS Vulnerability!')</script>""; // Improperly handling user input by directly outputting it to a webpage System.out.println(""<div>"" + userInput + ""</div>""); } }",java,1
Clear,"#include <iostream>
#include <sstream>

int safe_string_to_int(const std::string& str) {
    std::stringstream ss(str);
    int value;
    if (ss >> value) {
        return value;
    }
    throw std::invalid_argument(""Invalid integer"");
}","#include <iostream>
#include <sstream>

int safe_string_to_int(const std::string& str) {
    std::stringstream ss(str);
    int value;
    if (ss >> value) {
        return value;
    }
    throw std::invalid_argument(""Invalid integer"");
}",cpp,0
Clear,"#include <stdio.h>
#include <string.h>

int validate_input(const char *input) {
    if (input == NULL) return 0;
    for (int i = 0; input[i] != '\0'; i++) {
        if (input[i] < 32 || input[i] > 126) {
            return 0; // invalid character
        }
    }
    return 1;
}","#include <stdio.h>
#include <string.h>

int validate_input(const char *input) {
    if (input == NULL) return 0;
    for (int i = 0; input[i] != '\0'; i++) {
        if (input[i] < 32 || input[i] > 126) {
            return 0; // invalid character
        }
    }
    return 1;
}",c,0
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Clear,"import re
def validate_email(email):
    pattern = r'^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$'
    return bool(re.match(pattern, email))","import re
def validate_email(email):
    pattern = r'^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$'
    return bool(re.match(pattern, email))",python,0
Out-of-Bounds,"#include <iostream>

class UnsafeClass {
    int data[10];
public:
    int get_data(int index) {
        return data[index]; // no bounds checking
    }
};","#include <iostream>

class UnsafeClass {
    int data[10];
public:
    int get_data(int index) {
        return data[index]; // no bounds checking
    }
};",cpp,1
Clear,"<?php
$file = basename($_GET['file']);
$allowed = ['page1.php', 'page2.php'];
if (in_array($file, $allowed)) {
    include($file);
}
?>","<?php
$file = basename($_GET['file']);
$allowed = ['page1.php', 'page2.php'];
if (in_array($file, $allowed)) {
    include($file);
}
?>",php,0
Clear,"const userInput = new URLSearchParams(window.location.search).get('input');
const safeOutput = document.createElement('div');
safeOutput.textContent = userInput; // Safe DOM manipulation
document.body.appendChild(safeOutput);
","const userInput = new URLSearchParams(window.location.search).get('input');
const safeOutput = document.createElement('div');
safeOutput.textContent = userInput; // Safe DOM manipulation
document.body.appendChild(safeOutput);
",javascript,0
Clear,"import java.io.IOException;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

import org.owasp.encoder.Encode;

public class XSSFixedCode {

    public void processInput(HttpServletRequest request, HttpServletResponse response) throws IOException {
        String userInput = request.getParameter(""input"");
        
        // Sanitize user input to prevent XSS
        String sanitizedUserInput = Encode.forHtml(userInput);
        
        String output = ""<p>User input: "" + sanitizedUserInput + ""</p>"";
        
        response.getWriter().write(output);
    }
}","import java.io.IOException; import javax.servlet.http.HttpServletRequest; import javax.servlet.http.HttpServletResponse; import org.owasp.encoder.Encode; public class XSSFixedCode { public void processInput(HttpServletRequest request, HttpServletResponse response) throws IOException { String userInput = request.getParameter(""input""); // Sanitize user input to prevent XSS String sanitizedUserInput = Encode.forHtml(userInput); String output = ""<p>User input: "" + sanitizedUserInput + ""</p>""; response.getWriter().write(output); } }",java,0
Clear,"import mysql.connector
def safe_product_search(category):
    db = mysql.connector.connect(host=""localhost"", user=""user"", password=""pass"", database=""shop"")
    cursor = db.cursor()
    cursor.execute(""SELECT * FROM products WHERE category = %s"", (category,))
    return cursor.fetchall()","import mysql.connector
def safe_product_search(category):
    db = mysql.connector.connect(host=""localhost"", user=""user"", password=""pass"", database=""shop"")
    cursor = db.cursor()
    cursor.execute(""SELECT * FROM products WHERE category = %s"", (category,))
    return cursor.fetchall()",python,0
SSRF,"import requests
def fetch_url(url):
    return requests.get(url).text","import requests
def fetch_url(url):
    return requests.get(url).text",python,1
XSS,"const userInput = document.location.search.split('=')[1];
document.write(userInput); // XSS
","const userInput = document.location.search.split('=')[1];
document.write(userInput); // XSS
",javascript,1
Hardcoded Secrets,"localStorage.setItem('token', 'hardcoded-secret-token-123'); // Hardcoded secret
","localStorage.setItem('token', 'hardcoded-secret-token-123'); // Hardcoded secret
",javascript,1
Clear,"import java.sql.*;

public class SQLInjectionFixedExample {
    public static void main(String[] args) {
        String userInput = ""admin'; DROP TABLE users; --""; // User input with malicious SQL Injection query

        try {
            Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");

            String query = ""SELECT * FROM users WHERE username = ?"";
            
            PreparedStatement pstmt = conn.prepareStatement(query);
            pstmt.setString(1, userInput);

            ResultSet rs = pstmt.executeQuery();

            while (rs.next()) {
                System.out.println(""Username: "" + rs.getString(""username""));
            }

            conn.close();
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.*; public class SQLInjectionFixedExample { public static void main(String[] args) { String userInput = ""admin'; DROP TABLE users; --""; // User input with malicious SQL Injection query try { Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); String query = ""SELECT * FROM users WHERE username = ?""; PreparedStatement pstmt = conn.prepareStatement(query); pstmt.setString(1, userInput); ResultSet rs = pstmt.executeQuery(); while (rs.next()) { System.out.println(""Username: "" + rs.getString(""username"")); } conn.close(); } catch (SQLException e) { e.printStackTrace(); } } }",java,0
Clear,"import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class CommandInjectionFixed {
    public static void main(String[] args) throws IOException {
        BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));

        System.out.print(""Enter a command to execute: "");
        String command = reader.readLine();

        // Sanitize the command input
        String[] commandParts = command.split(""\\s+"");

        ProcessBuilder processBuilder = new ProcessBuilder(commandParts);
        
        // Redirect error stream to output stream
        processBuilder.redirectErrorStream(true);

        Process process = processBuilder.start();

        BufferedReader processOutputReader = new BufferedReader(new InputStreamReader(process.getInputStream()));
        String line;
        while ((line = processOutputReader.readLine()) != null) {
            System.out.println(line);
        }
    }
}","import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class CommandInjectionFixed { public static void main(String[] args) throws IOException { BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a command to execute: ""); String command = reader.readLine(); // Sanitize the command input String[] commandParts = command.split(""\\s+""); ProcessBuilder processBuilder = new ProcessBuilder(commandParts); // Redirect error stream to output stream processBuilder.redirectErrorStream(true); Process process = processBuilder.start(); BufferedReader processOutputReader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = processOutputReader.readLine()) != null) { System.out.println(line); } } }",java,0
Clear,"import java.io.IOException;
import java.io.PrintWriter;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import org.owasp.esapi.ESAPI;

public class XSSSafeServlet extends HttpServlet {
    
    @Override
    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws IOException {
        String userInput = request.getParameter(""input"");
        String sanitizedInput = ESAPI.encoder().encodeForHTML(userInput);
        
        response.setContentType(""text/html"");
        PrintWriter out = response.getWriter();
        
        out.println(""<html>"");
        out.println(""<head><title>XSS Safe Page</title></head>"");
        out.println(""<body>"");
        out.println(""<h1>User Input:</h1>"");
        out.println(""<p>"" + sanitizedInput + ""</p>"");  // Safe usage of user input
        out.println(""</body>"");
        out.println(""</html>"");
    }
}","import java.io.IOException; import java.io.PrintWriter; import javax.servlet.http.HttpServlet; import javax.servlet.http.HttpServletRequest; import javax.servlet.http.HttpServletResponse; import org.owasp.esapi.ESAPI; public class XSSSafeServlet extends HttpServlet { @Override protected void doGet(HttpServletRequest request, HttpServletResponse response) throws IOException { String userInput = request.getParameter(""input""); String sanitizedInput = ESAPI.encoder().encodeForHTML(userInput); response.setContentType(""text/html""); PrintWriter out = response.getWriter(); out.println(""<html>""); out.println(""<head><title>XSS Safe Page</title></head>""); out.println(""<body>""); out.println(""<h1>User Input:</h1>""); out.println(""<p>"" + sanitizedInput + ""</p>""); // Safe usage of user input out.println(""</body>""); out.println(""</html>""); } }",java,0
Clear,"#include <stdio.h>
#include <stdlib.h>

int safe_string_to_int(const char *str) {
    char *endptr;
    long value = strtol(str, &endptr, 10);
    if (*endptr != '\0' || str == endptr) {
        return -1; // error
    }
    return (int)value;
}","#include <stdio.h>
#include <stdlib.h>

int safe_string_to_int(const char *str) {
    char *endptr;
    long value = strtol(str, &endptr, 10);
    if (*endptr != '\0' || str == endptr) {
        return -1; // error
    }
    return (int)value;
}",c,0
Clear,"const userInput = new URLSearchParams(window.location.search).get('input');
const safeOutput = document.createElement('div');
safeOutput.textContent = userInput; // Safe DOM manipulation
document.body.appendChild(safeOutput);
","const userInput = new URLSearchParams(window.location.search).get('input');
const safeOutput = document.createElement('div');
safeOutput.textContent = userInput; // Safe DOM manipulation
document.body.appendChild(safeOutput);
",javascript,0
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Clear,"#include <stdio.h>
#include <stdlib.h>

void safe_file_operation(const char *filename) {
    FILE *file = fopen(filename, ""r"");
    if (file != NULL) {
        char buffer[256];
        while (fgets(buffer, sizeof(buffer), file)) {
            printf(""%s"", buffer);
        }
        fclose(file);
    }
}","#include <stdio.h>
#include <stdlib.h>

void safe_file_operation(const char *filename) {
    FILE *file = fopen(filename, ""r"");
    if (file != NULL) {
        char buffer[256];
        while (fgets(buffer, sizeof(buffer), file)) {
            printf(""%s"", buffer);
        }
        fclose(file);
    }
}",c,0
Clear,"const userData = JSON.parse(userInput); // Safe JSON parsing
if (userData && typeof userData === 'object') {
    processUserData(userData);
}
","const userData = JSON.parse(userInput); // Safe JSON parsing
if (userData && typeof userData === 'object') {
    processUserData(userData);
}
",javascript,0
Clear,"#include <stdio.h>
#include <string.h>

int safe_buffer_operation(char *input) {
    char buffer[100];
    if (strlen(input) < sizeof(buffer)) {
        strcpy(buffer, input);
        return 0;
    }
    return -1; // buffer too small
}","#include <stdio.h>
#include <string.h>

int safe_buffer_operation(char *input) {
    char buffer[100];
    if (strlen(input) < sizeof(buffer)) {
        strcpy(buffer, input);
        return 0;
    }
    return -1; // buffer too small
}",c,0
Clear,"#include <stdio.h>
#include <string.h>

int safe_buffer_operation(char *input) {
    char buffer[100];
    if (strlen(input) < sizeof(buffer)) {
        strcpy(buffer, input);
        return 0;
    }
    return -1; // buffer too small
}","#include <stdio.h>
#include <string.h>

int safe_buffer_operation(char *input) {
    char buffer[100];
    if (strlen(input) < sizeof(buffer)) {
        strcpy(buffer, input);
        return 0;
    }
    return -1; // buffer too small
}",c,0
SQL Injection,"import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Statement;
import java.util.Scanner;

public class SQLInjectionVulnerability {
    public static void main(String[] args) {
        try {
            Scanner scanner = new Scanner(System.in);
            
            System.out.print(""Enter username: "");
            String username = scanner.nextLine();
            
            // Vulnerable code: User input is directly concatenated into the SQL query
            String query = ""SELECT * FROM users WHERE username='"" + username + ""'"";
            
            Connection connection = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");
            Statement statement = connection.createStatement();
            
            ResultSet resultSet = statement.executeQuery(query);
            
            while(resultSet.next()) {
                System.out.println(""User found: "" + resultSet.getString(""username""));
            }
            
            connection.close();
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.Connection; import java.sql.DriverManager; import java.sql.ResultSet; import java.sql.SQLException; import java.sql.Statement; import java.util.Scanner; public class SQLInjectionVulnerability { public static void main(String[] args) { try { Scanner scanner = new Scanner(System.in); System.out.print(""Enter username: ""); String username = scanner.nextLine(); // Vulnerable code: User input is directly concatenated into the SQL query String query = ""SELECT * FROM users WHERE username='"" + username + ""'""; Connection connection = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); Statement statement = connection.createStatement(); ResultSet resultSet = statement.executeQuery(query); while(resultSet.next()) { System.out.println(""User found: "" + resultSet.getString(""username"")); } connection.close(); } catch (SQLException e) { e.printStackTrace(); } } }",java,1
Hardcoded Secrets,"localStorage.setItem('token', 'hardcoded-secret-token-123'); // Hardcoded secret
","localStorage.setItem('token', 'hardcoded-secret-token-123'); // Hardcoded secret
",javascript,1
Clear,"const token = process.env.API_TOKEN; // Environment variable
fetch('/api/data', {
    headers: { 'Authorization': `Bearer ${token}` }
});
","const token = process.env.API_TOKEN; // Environment variable
fetch('/api/data', {
    headers: { 'Authorization': `Bearer ${token}` }
});
",javascript,0
Hardcoded Secrets,"localStorage.setItem('token', 'hardcoded-secret-token-123'); // Hardcoded secret
","localStorage.setItem('token', 'hardcoded-secret-token-123'); // Hardcoded secret
",javascript,1
SSRF,"import urllib.request
def download_file(file_url):
    return urllib.request.urlopen(file_url).read()","import urllib.request
def download_file(file_url):
    return urllib.request.urlopen(file_url).read()",python,1
Hardcoded Secrets,"import requests
def call_api():
    api_key = ""sk_live_1234567890abcdef""
    headers = {'Authorization': f'Bearer {api_key}'}
    return requests.get('https://api.example.com/data', headers=headers)","import requests
def call_api():
    api_key = ""sk_live_1234567890abcdef""
    headers = {'Authorization': f'Bearer {api_key}'}
    return requests.get('https://api.example.com/data', headers=headers)",python,1
Clear,"<?php
$message = htmlspecialchars($_GET['message'], ENT_QUOTES, 'UTF-8');
echo $message; // Sanitized output
?>","<?php
$message = htmlspecialchars($_GET['message'], ENT_QUOTES, 'UTF-8');
echo $message; // Sanitized output
?>",php,0
Clear,"To fix the Path Traversal vulnerability in the provided Java code snippet, you should ensure that the file path provided by the user is sanitized and limited to a specific directory. Here's an example of how you can implement proper security measures to prevent Path Traversal attacks:

```java
import java.io.BufferedReader;
import java.io.File;
import java.io.FileReader;
import java.io.IOException;

public class SecurePathTraversalExample {

    private static final String BASE_DIRECTORY = ""/path/to/some/directory/"";

    public static void main(String[] args) {
        String userInput = ""../../../../../etc/passwd""; // Example user input
        String filePath = getSecureFilePath(userInput);

        if (filePath != null) {
            try {
                File file = new File(filePath);
                BufferedReader br = new BufferedReader(new FileReader(file));

                String line;
                while ((line = br.readLine()) != null) {
                    System.out.println(line);
                }

                br.close();
            } catch (IOException e) {
                System.out.println(""Error reading file: "" + e.getMessage());
            }
        } else {
            System.out.println(""Invalid file path"");
        }
    }

    private static String getSecureFilePath(String userInput) {
        // Check if the userInput contains","To fix the Path Traversal vulnerability in the provided Java code snippet, you should ensure that the file path provided by the user is sanitized and limited to a specific directory. Here's an example of how you can implement proper security measures to prevent Path Traversal attacks: ```java import java.io.BufferedReader; import java.io.File; import java.io.FileReader; import java.io.IOException; public class SecurePathTraversalExample { private static final String BASE_DIRECTORY = ""/path/to/some/directory/""; public static void main(String[] args) { String userInput = ""../../../../../etc/passwd""; // Example user input String filePath = getSecureFilePath(userInput); if (filePath != null) { try { File file = new File(filePath); BufferedReader br = new BufferedReader(new FileReader(file)); String line; while ((line = br.readLine()) != null) { System.out.println(line); } br.close(); } catch (IOException e) { System.out.println(""Error reading file: "" + e.getMessage()); } } else { System.out.println(""Invalid file path""); } } private static String getSecureFilePath(String userInput) { // Check if the userInput contains",java,0
Cross-Site Scripting (XSS),"import java.util.Scanner;

public class XssVulnerableCode {
    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        
        System.out.print(""Enter your name: "");
        String userName = scanner.nextLine();
        
        // Improperly handling user input by directly printing it to the output
        System.out.println(""Hello, "" + userName + ""! Welcome to our website!"");
    }
}","import java.util.Scanner; public class XssVulnerableCode { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter your name: ""); String userName = scanner.nextLine(); // Improperly handling user input by directly printing it to the output System.out.println(""Hello, "" + userName + ""! Welcome to our website!""); } }",java,1
Clear,"import subprocess
def safe_database_backup(db_name):
    result = subprocess.run(['pg_dump', db_name], capture_output=True, text=True)
    with open('backup.sql', 'w') as f:
        f.write(result.stdout)","import subprocess
def safe_database_backup(db_name):
    result = subprocess.run(['pg_dump', db_name], capture_output=True, text=True)
    with open('backup.sql', 'w') as f:
        f.write(result.stdout)",python,0
SQL Injection,"import psycopg2
def admin_login(admin_id):
    conn = psycopg2.connect(""dbname=test user=postgres"")
    cur = conn.cursor()
    cur.execute(f""SELECT * FROM admins WHERE id = {admin_id}"")
    return cur.fetchone()","import psycopg2
def admin_login(admin_id):
    conn = psycopg2.connect(""dbname=test user=postgres"")
    cur = conn.cursor()
    cur.execute(f""SELECT * FROM admins WHERE id = {admin_id}"")
    return cur.fetchone()",python,1
Cross-Site Scripting (XSS),"from flask import Flask, request
app = Flask(__name__)

@app.route('/search')
def search():
    query = request.args.get('q', '')
    return f'<h1>Search results for: {query}</h1>'","from flask import Flask, request
app = Flask(__name__)

@app.route('/search')
def search():
    query = request.args.get('q', '')
    return f'<h1>Search results for: {query}</h1>'",python,1
SQL Injection,"app.get('/user/:id', (req, res) => {
    const query = `SELECT * FROM users WHERE id = ${req.params.id}`; // SQL Injection
    db.query(query, (err, result) => {
        res.json(result);
    });
});
","app.get('/user/:id', (req, res) => {
    const query = `SELECT * FROM users WHERE id = ${req.params.id}`; // SQL Injection
    db.query(query, (err, result) => {
        res.json(result);
    });
});
",javascript,1
Insecure Deserialization,"import java.io.*;

public class InsecureDeserializationExample {
    public static void main(String[] args) {
        try {
            String userInput = ""serialized_object_here""; // Assume this input is provided by the user

            // Deserialize the user-provided input
            ByteArrayInputStream bis = new ByteArrayInputStream(userInput.getBytes());
            ObjectInput in = new ObjectInputStream(bis);
            Object obj = in.readObject();

            // Do something with the deserialized object (e.g., cast to a known class and call a method)
            if (obj instanceof SomeClass) {
                SomeClass sc = (SomeClass) obj;
                sc.doSomething();
            }
        } catch (IOException | ClassNotFoundException e) {
            e.printStackTrace();
        }
    }
}

class SomeClass implements Serializable {
    public void doSomething() {
        System.out.println(""Doing something..."");
    }
}","import java.io.*; public class InsecureDeserializationExample { public static void main(String[] args) { try { String userInput = ""serialized_object_here""; // Assume this input is provided by the user // Deserialize the user-provided input ByteArrayInputStream bis = new ByteArrayInputStream(userInput.getBytes()); ObjectInput in = new ObjectInputStream(bis); Object obj = in.readObject(); // Do something with the deserialized object (e.g., cast to a known class and call a method) if (obj instanceof SomeClass) { SomeClass sc = (SomeClass) obj; sc.doSomething(); } } catch (IOException | ClassNotFoundException e) { e.printStackTrace(); } } } class SomeClass implements Serializable { public void doSomething() { System.out.println(""Doing something...""); } }",java,1
Clear,"#include <iostream>
#include <vector>
#include <stdexcept>

int safe_vector_access(const std::vector<int>& vec, size_t index) {
    if (index >= vec.size()) {
        throw std::out_of_range(""Index out of range"");
    }
    return vec[index];
}","#include <iostream>
#include <vector>
#include <stdexcept>

int safe_vector_access(const std::vector<int>& vec, size_t index) {
    if (index >= vec.size()) {
        throw std::out_of_range(""Index out of range"");
    }
    return vec[index];
}",cpp,0
Memory Corruption,"#include <iostream>

void unsafe_pointer_arithmetic(int* array, int size) {
    for (int i = 0; i <= size; i++) {
        std::cout << *(array + i) << std::endl; // potential out-of-bounds
    }
}","#include <iostream>

void unsafe_pointer_arithmetic(int* array, int size) {
    for (int i = 0; i <= size; i++) {
        std::cout << *(array + i) << std::endl; // potential out-of-bounds
    }
}",cpp,1
Command Injection,"import os
def backup_database(db_name):
    os.system(f""pg_dump {db_name} > backup.sql"")","import os
def backup_database(db_name):
    os.system(f""pg_dump {db_name} > backup.sql"")",python,1
Clear,"#include <stdio.h>
#include <string.h>

void safe_string_copy(char *dest, const char *src, size_t dest_size) {
    if (dest_size > 0) {
        strncpy(dest, src, dest_size - 1);
        dest[dest_size - 1] = '\0';
    }
}","#include <stdio.h>
#include <string.h>

void safe_string_copy(char *dest, const char *src, size_t dest_size) {
    if (dest_size > 0) {
        strncpy(dest, src, dest_size - 1);
        dest[dest_size - 1] = '\0';
    }
}",c,0
Out-of-Bounds,"#include <iostream>

class UnsafeClass {
    int data[10];
public:
    int get_data(int index) {
        return data[index]; // no bounds checking
    }
};","#include <iostream>

class UnsafeClass {
    int data[10];
public:
    int get_data(int index) {
        return data[index]; // no bounds checking
    }
};",cpp,1
Hardcoded Secrets,"localStorage.setItem('token', 'hardcoded-secret-token-123'); // Hardcoded secret
","localStorage.setItem('token', 'hardcoded-secret-token-123'); // Hardcoded secret
",javascript,1
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Clear,"To fix the Command Injection vulnerability in the given Java code snippet, we should not directly execute the user input as a command. Instead, we should validate and sanitize the input to prevent malicious commands from being executed. One way to achieve this is by using a ProcessBuilder with a predefined list of allowed commands.

Here is an updated and more secure version of the code snippet:

```java
import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class SecureCommandExecution {

    public static void main(String[] args) throws IOException {
        BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));

        System.out.print(""Enter a command to execute: "");
        String userInput = reader.readLine();

        // Define a list of allowed commands
        String[] allowedCommands = {""ls"", ""pwd"", ""echo""};

        if (isValidCommand(userInput, allowedCommands)) {
            // Execute the command using ProcessBuilder
            ProcessBuilder processBuilder = new ProcessBuilder(userInput.split("" ""));
            Process process = processBuilder.start();

            BufferedReader processOutputReader = new BufferedReader(new InputStreamReader(process.getInputStream()));
            String line;

            while ((line = processOutputReader.readLine()) != null) {
                System.out.println(line);
            }
        } else {","To fix the Command Injection vulnerability in the given Java code snippet, we should not directly execute the user input as a command. Instead, we should validate and sanitize the input to prevent malicious commands from being executed. One way to achieve this is by using a ProcessBuilder with a predefined list of allowed commands. Here is an updated and more secure version of the code snippet: ```java import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class SecureCommandExecution { public static void main(String[] args) throws IOException { BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a command to execute: ""); String userInput = reader.readLine(); // Define a list of allowed commands String[] allowedCommands = {""ls"", ""pwd"", ""echo""}; if (isValidCommand(userInput, allowedCommands)) { // Execute the command using ProcessBuilder ProcessBuilder processBuilder = new ProcessBuilder(userInput.split("" "")); Process process = processBuilder.start(); BufferedReader processOutputReader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = processOutputReader.readLine()) != null) { System.out.println(line); } } else {",java,0
Clear,"import java.util.Scanner;
import org.apache.commons.text.StringEscapeUtils;

public class SecureXSSExample {

    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);

        System.out.print(""Enter your name: "");
        String userName = scanner.nextLine();

        String sanitizedUserName = StringEscapeUtils.escapeHtml4(userName); // Sanitize user input

        System.out.println(""Hello, "" + sanitizedUserName + ""!""); // Display sanitized user input

        scanner.close();
    }
}","import java.util.Scanner; import org.apache.commons.text.StringEscapeUtils; public class SecureXSSExample { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter your name: ""); String userName = scanner.nextLine(); String sanitizedUserName = StringEscapeUtils.escapeHtml4(userName); // Sanitize user input System.out.println(""Hello, "" + sanitizedUserName + ""!""); // Display sanitized user input scanner.close(); } }",java,0
Clear,"import os
def secure_file_access(username, filepath):
    base_dir = f""/home/{username}/files/""
    full_path = os.path.join(base_dir, filepath)
    full_path = os.path.normpath(full_path)
    if not full_path.startswith(base_dir):
        raise PermissionError(""Access denied"")
    with open(full_path, 'r') as f:
        return f.read()","import os
def secure_file_access(username, filepath):
    base_dir = f""/home/{username}/files/""
    full_path = os.path.join(base_dir, filepath)
    full_path = os.path.normpath(full_path)
    if not full_path.startswith(base_dir):
        raise PermissionError(""Access denied"")
    with open(full_path, 'r') as f:
        return f.read()",python,0
Clear,"app.get('/user/:id', (req, res) => {
    const userId = parseInt(req.params.id);
    db.query('SELECT * FROM users WHERE id = ?', [userId], (err, result) => {
        res.json(result);
    });
});
","app.get('/user/:id', (req, res) => {
    const userId = parseInt(req.params.id);
    db.query('SELECT * FROM users WHERE id = ?', [userId], (err, result) => {
        res.json(result);
    });
});
",javascript,0
Insecure Deserialization,"import java.io.*;

public class InsecureDeserializationExample {
    public static void main(String[] args) {
        try {
            String userInput = ""rO0ABXNyACpvcmcuZGFzaGJvYXJkLmludGVybmFsLlRlc3Q="";
            byte[] serializedData = javax.xml.bind.DatatypeConverter.parseBase64Binary(userInput);
            
            ByteArrayInputStream bis = new ByteArrayInputStream(serializedData);
            ObjectInputStream ois = new ObjectInputStream(bis);
            
            Object obj = ois.readObject();
            System.out.println(obj.toString());
            
        } catch (IOException | ClassNotFoundException e) {
            e.printStackTrace();
        }
    }
}","import java.io.*; public class InsecureDeserializationExample { public static void main(String[] args) { try { String userInput = ""rO0ABXNyACpvcmcuZGFzaGJvYXJkLmludGVybmFsLlRlc3Q=""; byte[] serializedData = javax.xml.bind.DatatypeConverter.parseBase64Binary(userInput); ByteArrayInputStream bis = new ByteArrayInputStream(serializedData); ObjectInputStream ois = new ObjectInputStream(bis); Object obj = ois.readObject(); System.out.println(obj.toString()); } catch (IOException | ClassNotFoundException e) { e.printStackTrace(); } } }",java,1
Code Injection,"const userData = eval('(' + userInput + ')'); // eval injection
","const userData = eval('(' + userInput + ')'); // eval injection
",javascript,1
Command Injection,"<?php
$cmd = $_GET['cmd'];
system($cmd); // Command Injection
?>","<?php
$cmd = $_GET['cmd'];
system($cmd); // Command Injection
?>",php,1
SSRF,"import requests
def fetch_url(url):
    return requests.get(url).text","import requests
def fetch_url(url):
    return requests.get(url).text",python,1
Clear,"To fix the Path Traversal vulnerability in the provided Java code snippet, you need to ensure that the user input for the file name does not allow directory traversal attacks. Here's an improved version of the code with proper security measures:

```java
import java.io.File;
import java.io.IOException;
import java.nio.file.Files;
import java.util.Scanner;

public class SecurePathTraversal {

    public static void main(String[] args) throws IOException {
        Scanner scanner = new Scanner(System.in);
        System.out.print(""Enter a file name: "");
        String fileName = scanner.nextLine();

        // Prevent directory traversal by validating the input file name
        if (!isValidFileName(fileName)) {
            System.out.println(""Invalid file name"");
            return;
        }

        File file = new File(""/path/to/directory/"" + fileName);

        if (file.exists()) {
            byte[] fileContent = Files.readAllBytes(file.toPath());
            System.out.println(""File content: "" + new String(fileContent));
        } else {
            System.out.println(""File not found"");
        }
    }

    private static boolean isValidFileName(String fileName) {
        // Implement your validation logic here
        // For example, allow only alphanumeric characters and certain special characters","To fix the Path Traversal vulnerability in the provided Java code snippet, you need to ensure that the user input for the file name does not allow directory traversal attacks. Here's an improved version of the code with proper security measures: ```java import java.io.File; import java.io.IOException; import java.nio.file.Files; import java.util.Scanner; public class SecurePathTraversal { public static void main(String[] args) throws IOException { Scanner scanner = new Scanner(System.in); System.out.print(""Enter a file name: ""); String fileName = scanner.nextLine(); // Prevent directory traversal by validating the input file name if (!isValidFileName(fileName)) { System.out.println(""Invalid file name""); return; } File file = new File(""/path/to/directory/"" + fileName); if (file.exists()) { byte[] fileContent = Files.readAllBytes(file.toPath()); System.out.println(""File content: "" + new String(fileContent)); } else { System.out.println(""File not found""); } } private static boolean isValidFileName(String fileName) { // Implement your validation logic here // For example, allow only alphanumeric characters and certain special characters",java,0
Clear,"#include <iostream>
#include <fstream>
#include <string>

void safe_file_reading(const std::string& filename) {
    std::ifstream file(filename);
    if (file.is_open()) {
        std::string line;
        while (std::getline(file, line)) {
            std::cout << line << std::endl;
        }
    }
}","#include <iostream>
#include <fstream>
#include <string>

void safe_file_reading(const std::string& filename) {
    std::ifstream file(filename);
    if (file.is_open()) {
        std::string line;
        while (std::getline(file, line)) {
            std::cout << line << std::endl;
        }
    }
}",cpp,0
Buffer Overflow,"#include <iostream>
#include <cstring>

void unsafe_c_string(char* input) {
    char buffer[100];
    strcpy(buffer, input); // potential buffer overflow
    std::cout << buffer << std::endl;
}","#include <iostream>
#include <cstring>

void unsafe_c_string(char* input) {
    char buffer[100];
    strcpy(buffer, input); // potential buffer overflow
    std::cout << buffer << std::endl;
}",cpp,1
SQL Injection,"import java.sql.*;

public class SQLInjectionVulnerable {

    public static void main(String[] args) {
        String userInput = args[0]; // Simulating user input

        try {
            Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");
            Statement stmt = conn.createStatement();

            String query = ""SELECT * FROM users WHERE username='"" + userInput + ""'"";
            ResultSet rs = stmt.executeQuery(query);

            while (rs.next()) {
                System.out.println(""User ID: "" + rs.getInt(""id"") + "", Username: "" + rs.getString(""username""));
            }

            rs.close();
            stmt.close();
            conn.close();
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.*; public class SQLInjectionVulnerable { public static void main(String[] args) { String userInput = args[0]; // Simulating user input try { Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); Statement stmt = conn.createStatement(); String query = ""SELECT * FROM users WHERE username='"" + userInput + ""'""; ResultSet rs = stmt.executeQuery(query); while (rs.next()) { System.out.println(""User ID: "" + rs.getInt(""id"") + "", Username: "" + rs.getString(""username"")); } rs.close(); stmt.close(); conn.close(); } catch (SQLException e) { e.printStackTrace(); } } }",java,1
SQL Injection,"import mysql.connector
def search_products(category):
    db = mysql.connector.connect(host=""localhost"", user=""user"", password=""pass"", database=""shop"")
    cursor = db.cursor()
    cursor.execute(""SELECT * FROM products WHERE category = '%s'"" % category)
    return cursor.fetchall()","import mysql.connector
def search_products(category):
    db = mysql.connector.connect(host=""localhost"", user=""user"", password=""pass"", database=""shop"")
    cursor = db.cursor()
    cursor.execute(""SELECT * FROM products WHERE category = '%s'"" % category)
    return cursor.fetchall()",python,1
Path Traversal,"import java.io.File;
import java.io.IOException;
import java.util.Scanner;

public class PathTraversalVulnerability {

    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        System.out.print(""Enter file name: "");
        String fileName = scanner.nextLine();

        File file = new File(""/path/to/directory/"" + fileName);

        try {
            if (file.exists()) {
                System.out.println(""Reading file contents:"");
                Scanner fileScanner = new Scanner(file);
                while (fileScanner.hasNextLine()) {
                    System.out.println(fileScanner.nextLine());
                }
            } else {
                System.out.println(""File not found."");
            }
        } catch (IOException e) {
            System.out.println(""Error reading file: "" + e.getMessage());
        }
    }
}","import java.io.File; import java.io.IOException; import java.util.Scanner; public class PathTraversalVulnerability { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter file name: ""); String fileName = scanner.nextLine(); File file = new File(""/path/to/directory/"" + fileName); try { if (file.exists()) { System.out.println(""Reading file contents:""); Scanner fileScanner = new Scanner(file); while (fileScanner.hasNextLine()) { System.out.println(fileScanner.nextLine()); } } else { System.out.println(""File not found.""); } } catch (IOException e) { System.out.println(""Error reading file: "" + e.getMessage()); } } }",java,1
Clear,"import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class SafeCommandExecutionExample {

    public static void main(String[] args) throws IOException {
        BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));
        
        System.out.print(""Enter the IP address to ping: "");
        String ip = reader.readLine();
        
        // Safely execute the ping command using ProcessBuilder
        ProcessBuilder processBuilder = new ProcessBuilder(""ping"", ip);
        
        Process process = processBuilder.start();
        
        BufferedReader processOutputReader = new BufferedReader(new InputStreamReader(process.getInputStream()));
        String outputLine;
        
        System.out.println(""Ping results:"");
        while ((outputLine = processOutputReader.readLine()) != null) {
            System.out.println(outputLine);
        }
    }
}","import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class SafeCommandExecutionExample { public static void main(String[] args) throws IOException { BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter the IP address to ping: ""); String ip = reader.readLine(); // Safely execute the ping command using ProcessBuilder ProcessBuilder processBuilder = new ProcessBuilder(""ping"", ip); Process process = processBuilder.start(); BufferedReader processOutputReader = new BufferedReader(new InputStreamReader(process.getInputStream())); String outputLine; System.out.println(""Ping results:""); while ((outputLine = processOutputReader.readLine()) != null) { System.out.println(outputLine); } } }",java,0
Clear,"#include <iostream>
#include <sstream>

int safe_string_to_int(const std::string& str) {
    std::stringstream ss(str);
    int value;
    if (ss >> value) {
        return value;
    }
    throw std::invalid_argument(""Invalid integer"");
}","#include <iostream>
#include <sstream>

int safe_string_to_int(const std::string& str) {
    std::stringstream ss(str);
    int value;
    if (ss >> value) {
        return value;
    }
    throw std::invalid_argument(""Invalid integer"");
}",cpp,0
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Command Injection,"import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class CommandInjectionExample {

    public static void main(String[] args) {
        try {
            BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));
            System.out.print(""Enter the IP address to ping: "");
            String ip = reader.readLine();

            String command = ""ping "" + ip;
            Process process = Runtime.getRuntime().exec(command);

            BufferedReader inputStream = new BufferedReader(new InputStreamReader(process.getInputStream()));
            String output = """";
            
            while ((output = inputStream.readLine()) != null) {
                System.out.println(output);
            }
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}","import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class CommandInjectionExample { public static void main(String[] args) { try { BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter the IP address to ping: ""); String ip = reader.readLine(); String command = ""ping "" + ip; Process process = Runtime.getRuntime().exec(command); BufferedReader inputStream = new BufferedReader(new InputStreamReader(process.getInputStream())); String output = """"; while ((output = inputStream.readLine()) != null) { System.out.println(output); } } catch (IOException e) { e.printStackTrace(); } } }",java,1
Out-of-Bounds,"#include <iostream>

class UnsafeClass {
    int data[10];
public:
    int get_data(int index) {
        return data[index]; // no bounds checking
    }
};","#include <iostream>

class UnsafeClass {
    int data[10];
public:
    int get_data(int index) {
        return data[index]; // no bounds checking
    }
};",cpp,1
SQL Injection,"import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;

public class SQLInjectionVulnerable {

    public static void main(String[] args) {
        String userInput = ""'; DROP TABLE users; --""; // Malicious input simulating SQL Injection

        try {
            Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");
            String query = ""SELECT * FROM users WHERE username = '"" + userInput + ""'"";

            PreparedStatement statement = conn.prepareStatement(query);
            ResultSet resultSet = statement.executeQuery();

            while (resultSet.next()) {
                System.out.println(resultSet.getString(""username""));
            }

            conn.close();
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.Connection; import java.sql.DriverManager; import java.sql.PreparedStatement; import java.sql.ResultSet; import java.sql.SQLException; public class SQLInjectionVulnerable { public static void main(String[] args) { String userInput = ""'; DROP TABLE users; --""; // Malicious input simulating SQL Injection try { Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); String query = ""SELECT * FROM users WHERE username = '"" + userInput + ""'""; PreparedStatement statement = conn.prepareStatement(query); ResultSet resultSet = statement.executeQuery(); while (resultSet.next()) { System.out.println(resultSet.getString(""username"")); } conn.close(); } catch (SQLException e) { e.printStackTrace(); } } }",java,1
Clear,"#include <stdio.h>
#include <string.h>

int safe_buffer_operation(char *input) {
    char buffer[100];
    if (strlen(input) < sizeof(buffer)) {
        strcpy(buffer, input);
        return 0;
    }
    return -1; // buffer too small
}","#include <stdio.h>
#include <string.h>

int safe_buffer_operation(char *input) {
    char buffer[100];
    if (strlen(input) < sizeof(buffer)) {
        strcpy(buffer, input);
        return 0;
    }
    return -1; // buffer too small
}",c,0
Cross-Site Scripting (XSS),"def display_comment(comment_text):
    return f""<div class='comment'>{comment_text}</div>"" ","def display_comment(comment_text):
    return f""<div class='comment'>{comment_text}</div>"" ",python,1
Hardcoded Secrets,"DATABASE_PASSWORD = ""my_super_secret_password_123""
def db_connect():
    import psycopg2
    return psycopg2.connect(f""dbname=test user=admin password={DATABASE_PASSWORD}"")","DATABASE_PASSWORD = ""my_super_secret_password_123""
def db_connect():
    import psycopg2
    return psycopg2.connect(f""dbname=test user=admin password={DATABASE_PASSWORD}"")",python,1
Out-of-Bounds,"#include <iostream>

class UnsafeClass {
    int data[10];
public:
    int get_data(int index) {
        return data[index]; // no bounds checking
    }
};","#include <iostream>

class UnsafeClass {
    int data[10];
public:
    int get_data(int index) {
        return data[index]; // no bounds checking
    }
};",cpp,1
SQL Injection,"import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Statement;

public class SQLInjectionVulnerableCode {

    public static void main(String[] args) {
        String userInput = ""'; DROP TABLE users; --"";
        
        try {
            Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");
            
            Statement stmt = conn.createStatement();
            String query = ""SELECT * FROM users WHERE username = '"" + userInput + ""'"";
            
            ResultSet rs = stmt.executeQuery(query);
            
            while(rs.next()) {
                System.out.println(""User: "" + rs.getString(""username""));
            }
            
            conn.close();
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.Connection; import java.sql.DriverManager; import java.sql.ResultSet; import java.sql.SQLException; import java.sql.Statement; public class SQLInjectionVulnerableCode { public static void main(String[] args) { String userInput = ""'; DROP TABLE users; --""; try { Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); Statement stmt = conn.createStatement(); String query = ""SELECT * FROM users WHERE username = '"" + userInput + ""'""; ResultSet rs = stmt.executeQuery(query); while(rs.next()) { System.out.println(""User: "" + rs.getString(""username"")); } conn.close(); } catch (SQLException e) { e.printStackTrace(); } } }",java,1
Path Traversal,"import java.io.File;
import java.io.IOException;
import java.nio.file.Files;
import java.util.Scanner;

public class PathTraversalVulnerability {

    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        System.out.println(""Enter a file name:"");
        String fileName = scanner.nextLine();

        String directory = ""/var/www/html/files/"";
        File file = new File(directory + fileName);

        try {
            byte[] content = Files.readAllBytes(file.toPath());
            System.out.println(new String(content));
        } catch (IOException e) {
            System.out.println(""Error reading file: "" + e.getMessage());
        }

        scanner.close();
    }
}","import java.io.File; import java.io.IOException; import java.nio.file.Files; import java.util.Scanner; public class PathTraversalVulnerability { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.println(""Enter a file name:""); String fileName = scanner.nextLine(); String directory = ""/var/www/html/files/""; File file = new File(directory + fileName); try { byte[] content = Files.readAllBytes(file.toPath()); System.out.println(new String(content)); } catch (IOException e) { System.out.println(""Error reading file: "" + e.getMessage()); } scanner.close(); } }",java,1
Clear,"To fix the XSS vulnerability in the provided Java code snippet, you need to ensure that user input is properly sanitized and encoded before being embedded into the HTML response. Here is an improved version of the code that mitigates the XSS vulnerability:

```java
import java.io.*;
import javax.servlet.*;
import javax.servlet.http.*;

public class XSSFixedServlet extends HttpServlet {
    @Override
    protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        String userInput = request.getParameter(""input"");
        PrintWriter out = response.getWriter();
        
        // Sanitize and encode user input before embedding it into the HTML response
        String sanitizedInput = sanitizeUserInput(userInput);
        
        out.println(""<html>"");
        out.println(""<head><title>Fixed XSS Example</title></head>"");
        out.println(""<body>"");
        out.println(""<h1>User Input: "" + sanitizedInput + ""</h1>"");
        out.println(""</body>"");
        out.println(""</html>"");
    }
    
    // Method to sanitize and encode user input to prevent XSS attacks
    private String sanitizeUserInput(String userInput) {
        // Replace special characters that may be used in XSS attacks with their HTML entity equivalents
        userInput = userInput.replaceAll(""&"", ""&amp;"")
                             .","To fix the XSS vulnerability in the provided Java code snippet, you need to ensure that user input is properly sanitized and encoded before being embedded into the HTML response. Here is an improved version of the code that mitigates the XSS vulnerability: ```java import java.io.*; import javax.servlet.*; import javax.servlet.http.*; public class XSSFixedServlet extends HttpServlet { @Override protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { String userInput = request.getParameter(""input""); PrintWriter out = response.getWriter(); // Sanitize and encode user input before embedding it into the HTML response String sanitizedInput = sanitizeUserInput(userInput); out.println(""<html>""); out.println(""<head><title>Fixed XSS Example</title></head>""); out.println(""<body>""); out.println(""<h1>User Input: "" + sanitizedInput + ""</h1>""); out.println(""</body>""); out.println(""</html>""); } // Method to sanitize and encode user input to prevent XSS attacks private String sanitizeUserInput(String userInput) { // Replace special characters that may be used in XSS attacks with their HTML entity equivalents userInput = userInput.replaceAll(""&"", ""&amp;"") .",java,0
Clear,"#include <stdio.h>
#include <string.h>

int safe_buffer_operation(char *input) {
    char buffer[100];
    if (strlen(input) < sizeof(buffer)) {
        strcpy(buffer, input);
        return 0;
    }
    return -1; // buffer too small
}","#include <stdio.h>
#include <string.h>

int safe_buffer_operation(char *input) {
    char buffer[100];
    if (strlen(input) < sizeof(buffer)) {
        strcpy(buffer, input);
        return 0;
    }
    return -1; // buffer too small
}",c,0
Clear,"from django.http import HttpResponse
from django.utils.html import escape

def safe_user_profile(request, username):
    safe_username = escape(username)
    return HttpResponse(f""Welcome, {safe_username}!"")","from django.http import HttpResponse
from django.utils.html import escape

def safe_user_profile(request, username):
    safe_username = escape(username)
    return HttpResponse(f""Welcome, {safe_username}!"")",python,0
Command Injection,"import java.io.*;

public class CommandInjectionExample {
    public static void main(String[] args) {
        try {
            BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));
            System.out.print(""Enter a command to execute: "");
            String command = reader.readLine();
            
            // Improperly handling user input
            Process process = Runtime.getRuntime().exec(""ping "" + command);
            
            BufferedReader inputReader = new BufferedReader(new InputStreamReader(process.getInputStream()));
            String line;
            
            while ((line = inputReader.readLine()) != null) {
                System.out.println(line);
            }
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}","import java.io.*; public class CommandInjectionExample { public static void main(String[] args) { try { BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a command to execute: ""); String command = reader.readLine(); // Improperly handling user input Process process = Runtime.getRuntime().exec(""ping "" + command); BufferedReader inputReader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = inputReader.readLine()) != null) { System.out.println(line); } } catch (IOException e) { e.printStackTrace(); } } }",java,1
Clear,"<?php
$file = basename($_GET['file']);
$allowed = ['page1.php', 'page2.php'];
if (in_array($file, $allowed)) {
    include($file);
}
?>","<?php
$file = basename($_GET['file']);
$allowed = ['page1.php', 'page2.php'];
if (in_array($file, $allowed)) {
    include($file);
}
?>",php,0
Clear,"#include <iostream>
#include <vector>
#include <stdexcept>

int safe_vector_access(const std::vector<int>& vec, size_t index) {
    if (index >= vec.size()) {
        throw std::out_of_range(""Index out of range"");
    }
    return vec[index];
}","#include <iostream>
#include <vector>
#include <stdexcept>

int safe_vector_access(const std::vector<int>& vec, size_t index) {
    if (index >= vec.size()) {
        throw std::out_of_range(""Index out of range"");
    }
    return vec[index];
}",cpp,0
SQL Injection,"import mysql.connector
def search_products(category):
    db = mysql.connector.connect(host=""localhost"", user=""user"", password=""pass"", database=""shop"")
    cursor = db.cursor()
    cursor.execute(""SELECT * FROM products WHERE category = '%s'"" % category)
    return cursor.fetchall()","import mysql.connector
def search_products(category):
    db = mysql.connector.connect(host=""localhost"", user=""user"", password=""pass"", database=""shop"")
    cursor = db.cursor()
    cursor.execute(""SELECT * FROM products WHERE category = '%s'"" % category)
    return cursor.fetchall()",python,1
Clear,"To fix the insecure code and prevent Path Traversal attacks, you should ensure that the file path provided by the user is safe and restrict access to only allowed directories. Here is an improved version of the code using secure coding practices:

```java
import java.io.File;
import java.io.FileReader;
import java.io.IOException;
import java.util.Scanner;

public class SecurePathTraversalExample {

    private static final String BASE_DIRECTORY = ""/path/to/allowed/directory/"";

    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        System.out.println(""Enter the file name:"");
        String fileName = scanner.nextLine();

        if (isFilenameSafe(fileName)) {
            File file = new File(BASE_DIRECTORY + fileName);

            try {
                FileReader fileReader = new FileReader(file);
                int data;
                while ((data = fileReader.read()) != -1) {
                    System.out.print((char) data);
                }
                fileReader.close();
            } catch (IOException e) {
                System.out.println(""File not found or error reading the file."");
            }
        } else {
            System.out.println(""Invalid file name."");
        }
    }

    private static boolean isFilenameSafe(String fileName) {
        // Implement your","To fix the insecure code and prevent Path Traversal attacks, you should ensure that the file path provided by the user is safe and restrict access to only allowed directories. Here is an improved version of the code using secure coding practices: ```java import java.io.File; import java.io.FileReader; import java.io.IOException; import java.util.Scanner; public class SecurePathTraversalExample { private static final String BASE_DIRECTORY = ""/path/to/allowed/directory/""; public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.println(""Enter the file name:""); String fileName = scanner.nextLine(); if (isFilenameSafe(fileName)) { File file = new File(BASE_DIRECTORY + fileName); try { FileReader fileReader = new FileReader(file); int data; while ((data = fileReader.read()) != -1) { System.out.print((char) data); } fileReader.close(); } catch (IOException e) { System.out.println(""File not found or error reading the file.""); } } else { System.out.println(""Invalid file name.""); } } private static boolean isFilenameSafe(String fileName) { // Implement your",java,0
Clear,"#include <stdio.h>
#include <string.h>

int validate_input(const char *input) {
    if (input == NULL) return 0;
    for (int i = 0; input[i] != '\0'; i++) {
        if (input[i] < 32 || input[i] > 126) {
            return 0; // invalid character
        }
    }
    return 1;
}","#include <stdio.h>
#include <string.h>

int validate_input(const char *input) {
    if (input == NULL) return 0;
    for (int i = 0; input[i] != '\0'; i++) {
        if (input[i] < 32 || input[i] > 126) {
            return 0; // invalid character
        }
    }
    return 1;
}",c,0
Clear,"const userInput = new URLSearchParams(window.location.search).get('input');
const safeOutput = document.createElement('div');
safeOutput.textContent = userInput; // Safe DOM manipulation
document.body.appendChild(safeOutput);
","const userInput = new URLSearchParams(window.location.search).get('input');
const safeOutput = document.createElement('div');
safeOutput.textContent = userInput; // Safe DOM manipulation
document.body.appendChild(safeOutput);
",javascript,0
Memory Corruption,"#include <iostream>

void unsafe_virtual_call() {
    // Potential vtable corruption vulnerability
    class Base {
    public:
        virtual void func() { std::cout << ""Base"" << std::endl; }
    };
    
    class Derived : public Base {
    public:
        void func() override { std::cout << ""Derived"" << std::endl; }
    };
}","#include <iostream>

void unsafe_virtual_call() {
    // Potential vtable corruption vulnerability
    class Base {
    public:
        virtual void func() { std::cout << ""Base"" << std::endl; }
    };
    
    class Derived : public Base {
    public:
        void func() override { std::cout << ""Derived"" << std::endl; }
    };
}",cpp,1
Command Injection,"import os
def ping_host(host):
    os.system(""ping -c 4 "" + host)","import os
def ping_host(host):
    os.system(""ping -c 4 "" + host)",python,1
Cross-Site Scripting (XSS),"def display_comment(comment_text):
    return f""<div class='comment'>{comment_text}</div>"" ","def display_comment(comment_text):
    return f""<div class='comment'>{comment_text}</div>"" ",python,1
Clear,"#include <stdio.h>
#include <stdlib.h>

int safe_string_to_int(const char *str) {
    char *endptr;
    long value = strtol(str, &endptr, 10);
    if (*endptr != '\0' || str == endptr) {
        return -1; // error
    }
    return (int)value;
}","#include <stdio.h>
#include <stdlib.h>

int safe_string_to_int(const char *str) {
    char *endptr;
    long value = strtol(str, &endptr, 10);
    if (*endptr != '\0' || str == endptr) {
        return -1; // error
    }
    return (int)value;
}",c,0
Cross-Site Scripting (XSS),"import java.io.IOException;
import javax.servlet.*;
import javax.servlet.http.*;

public class XSSVulnerableServlet extends HttpServlet {
    protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        String userInput = request.getParameter(""input"");
        
        String htmlResponse = ""<html><body><h1>User Input: "" + userInput + ""</h1></body></html>"";
        
        response.setContentType(""text/html"");
        response.getWriter().write(htmlResponse);
    }
}","import java.io.IOException; import javax.servlet.*; import javax.servlet.http.*; public class XSSVulnerableServlet extends HttpServlet { protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { String userInput = request.getParameter(""input""); String htmlResponse = ""<html><body><h1>User Input: "" + userInput + ""</h1></body></html>""; response.setContentType(""text/html""); response.getWriter().write(htmlResponse); } }",java,1
Clear,"import tempfile
import os

def create_secure_temp(data):
    with tempfile.NamedTemporaryFile(mode='w', delete=True, suffix='.tmp') as temp:
        temp.write(data)
        temp.flush()
        return temp.name","import tempfile
import os

def create_secure_temp(data):
    with tempfile.NamedTemporaryFile(mode='w', delete=True, suffix='.tmp') as temp:
        temp.write(data)
        temp.flush()
        return temp.name",python,0
Memory Corruption,"#include <iostream>

void unsafe_pointer_arithmetic(int* array, int size) {
    for (int i = 0; i <= size; i++) {
        std::cout << *(array + i) << std::endl; // potential out-of-bounds
    }
}","#include <iostream>

void unsafe_pointer_arithmetic(int* array, int size) {
    for (int i = 0; i <= size; i++) {
        std::cout << *(array + i) << std::endl; // potential out-of-bounds
    }
}",cpp,1
Clear,"#include <iostream>
#include <sstream>

int safe_string_to_int(const std::string& str) {
    std::stringstream ss(str);
    int value;
    if (ss >> value) {
        return value;
    }
    throw std::invalid_argument(""Invalid integer"");
}","#include <iostream>
#include <sstream>

int safe_string_to_int(const std::string& str) {
    std::stringstream ss(str);
    int value;
    if (ss >> value) {
        return value;
    }
    throw std::invalid_argument(""Invalid integer"");
}",cpp,0
Cross-Site Scripting (XSS),"import java.io.*;
import javax.servlet.*;
import javax.servlet.http.*;

public class XSSVulnerableServlet extends HttpServlet {
    
    protected void doGet(HttpServletRequest request, HttpServletResponse response)
            throws ServletException, IOException {
        
        String userInput = request.getParameter(""input"");
        String output = ""<html><body>Hello, "" + userInput + ""</body></html>"";
        
        PrintWriter out = response.getWriter();
        out.println(output);
    }
}","import java.io.*; import javax.servlet.*; import javax.servlet.http.*; public class XSSVulnerableServlet extends HttpServlet { protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { String userInput = request.getParameter(""input""); String output = ""<html><body>Hello, "" + userInput + ""</body></html>""; PrintWriter out = response.getWriter(); out.println(output); } }",java,1
Clear,"To fix this insecure deserialization code snippet, we need to implement proper security measures to prevent potential attacks like remote code execution or object manipulation. Here are some steps to enhance the security of the deserialization process:

1. Implement input validation:
   - Validate the serialized data format before deserialization. Ensure that it is a valid serialized object and not tampered with.
   
2. Use a safe deserialization library:
   - Instead of using the default `ObjectInputStream`, consider using a safe deserialization library like `Jackson` with its `ObjectMapper` class or `Gson` library. These libraries provide more control over the deserialization process and offer features to prevent common deserialization vulnerabilities.
   
3. Restrict classes for deserialization:
   - Whitelist specific classes that can be deserialized by configuring the deserialization library to only allow known and trusted classes.
   
4. Enable security manager:
   - Consider using a Security Manager to restrict the permissions granted during deserialization, preventing potentially harmful operations like file I/O or network access.
   
5. Validate and sanitize input data:
   - If user input is required for providing serialized data, ensure that it is properly validated and sanitized before proceeding with deserialization to prevent injection attacks.

Here's","To fix this insecure deserialization code snippet, we need to implement proper security measures to prevent potential attacks like remote code execution or object manipulation. Here are some steps to enhance the security of the deserialization process: 1. Implement input validation: - Validate the serialized data format before deserialization. Ensure that it is a valid serialized object and not tampered with. 2. Use a safe deserialization library: - Instead of using the default `ObjectInputStream`, consider using a safe deserialization library like `Jackson` with its `ObjectMapper` class or `Gson` library. These libraries provide more control over the deserialization process and offer features to prevent common deserialization vulnerabilities. 3. Restrict classes for deserialization: - Whitelist specific classes that can be deserialized by configuring the deserialization library to only allow known and trusted classes. 4. Enable security manager: - Consider using a Security Manager to restrict the permissions granted during deserialization, preventing potentially harmful operations like file I/O or network access. 5. Validate and sanitize input data: - If user input is required for providing serialized data, ensure that it is properly validated and sanitized before proceeding with deserialization to prevent injection attacks. Here's",php,0
Memory Corruption,"#include <iostream>

void unsafe_virtual_call() {
    // Potential vtable corruption vulnerability
    class Base {
    public:
        virtual void func() { std::cout << ""Base"" << std::endl; }
    };
    
    class Derived : public Base {
    public:
        void func() override { std::cout << ""Derived"" << std::endl; }
    };
}","#include <iostream>

void unsafe_virtual_call() {
    // Potential vtable corruption vulnerability
    class Base {
    public:
        virtual void func() { std::cout << ""Base"" << std::endl; }
    };
    
    class Derived : public Base {
    public:
        void func() override { std::cout << ""Derived"" << std::endl; }
    };
}",cpp,1
Memory Corruption,"#include <iostream>

void unsafe_pointer_arithmetic(int* array, int size) {
    for (int i = 0; i <= size; i++) {
        std::cout << *(array + i) << std::endl; // potential out-of-bounds
    }
}","#include <iostream>

void unsafe_pointer_arithmetic(int* array, int size) {
    for (int i = 0; i <= size; i++) {
        std::cout << *(array + i) << std::endl; // potential out-of-bounds
    }
}",cpp,1
Clear,"import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;
import java.util.ArrayList;
import java.util.List;

public class SecureCommandExecutionExample {
    public static void main(String[] args) {
        try {
            BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));
            System.out.print(""Enter a directory to list its contents: "");
            String directory = reader.readLine();

            List<String> command = new ArrayList<>();
            command.add(""ls"");
            command.add(directory);

            ProcessBuilder processBuilder = new ProcessBuilder(command);
            Process process = processBuilder.start();

            BufferedReader processOutputReader = new BufferedReader(new InputStreamReader(process.getInputStream()));

            String line;
            while ((line = processOutputReader.readLine()) != null) {
                System.out.println(line);
            }

        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}","import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; import java.util.ArrayList; import java.util.List; public class SecureCommandExecutionExample { public static void main(String[] args) { try { BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a directory to list its contents: ""); String directory = reader.readLine(); List<String> command = new ArrayList<>(); command.add(""ls""); command.add(directory); ProcessBuilder processBuilder = new ProcessBuilder(command); Process process = processBuilder.start(); BufferedReader processOutputReader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = processOutputReader.readLine()) != null) { System.out.println(line); } } catch (IOException e) { e.printStackTrace(); } } }",java,0
Command Injection,"import subprocess
def list_directory(path):
    result = subprocess.run(f""ls {path}"", shell=True, capture_output=True, text=True)
    return result.stdout","import subprocess
def list_directory(path):
    result = subprocess.run(f""ls {path}"", shell=True, capture_output=True, text=True)
    return result.stdout",python,1
Clear,"#include <iostream>
#include <vector>
#include <stdexcept>

int safe_vector_access(const std::vector<int>& vec, size_t index) {
    if (index >= vec.size()) {
        throw std::out_of_range(""Index out of range"");
    }
    return vec[index];
}","#include <iostream>
#include <vector>
#include <stdexcept>

int safe_vector_access(const std::vector<int>& vec, size_t index) {
    if (index >= vec.size()) {
        throw std::out_of_range(""Index out of range"");
    }
    return vec[index];
}",cpp,0
Buffer Overflow,"#include <iostream>
#include <cstdio>

void unsafe_c_input() {
    char buffer[50];
    scanf(""%s"", buffer); // no length limit
    std::cout << buffer << std::endl;
}","#include <iostream>
#include <cstdio>

void unsafe_c_input() {
    char buffer[50];
    scanf(""%s"", buffer); // no length limit
    std::cout << buffer << std::endl;
}",cpp,1
Insecure Deserialization,"import yaml
def load_config(config_str):
    return yaml.load(config_str, Loader=yaml.Loader)","import yaml
def load_config(config_str):
    return yaml.load(config_str, Loader=yaml.Loader)",python,1
SQL Injection,"app.get('/user/:id', (req, res) => {
    const query = `SELECT * FROM users WHERE id = ${req.params.id}`; // SQL Injection
    db.query(query, (err, result) => {
        res.json(result);
    });
});
","app.get('/user/:id', (req, res) => {
    const query = `SELECT * FROM users WHERE id = ${req.params.id}`; // SQL Injection
    db.query(query, (err, result) => {
        res.json(result);
    });
});
",javascript,1
Command Injection,"const shell = require('child_process');
shell.exec('ping ' + userInput); // Command Injection
","const shell = require('child_process');
shell.exec('ping ' + userInput); // Command Injection
",javascript,1
Insecure Deserialization,"import java.io.*;

public class InsecureDeserializationExample {

    public static void main(String[] args) {
        try {
            String userInput = ""serialized_object_here""; // User input containing serialized object

            ByteArrayInputStream bis = new ByteArrayInputStream(userInput.getBytes());
            ObjectInput in = new ObjectInputStream(bis);

            Object obj = in.readObject(); // Deserializing the user input

            // Perform operations with the deserialized object
            // This is where the vulnerability lies as an attacker can provide a malicious payload in the serialized object

        } catch (Exception e) {
            e.printStackTrace();
        }
    }
}","import java.io.*; public class InsecureDeserializationExample { public static void main(String[] args) { try { String userInput = ""serialized_object_here""; // User input containing serialized object ByteArrayInputStream bis = new ByteArrayInputStream(userInput.getBytes()); ObjectInput in = new ObjectInputStream(bis); Object obj = in.readObject(); // Deserializing the user input // Perform operations with the deserialized object // This is where the vulnerability lies as an attacker can provide a malicious payload in the serialized object } catch (Exception e) { e.printStackTrace(); } } }",java,1
Path Traversal,"import java.io.BufferedReader;
import java.io.FileReader;
import java.io.IOException;

public class PathTraversalVulnerability {

    public static void main(String[] args) {
        String userInput = ""../../../../../etc/passwd"";
        String filePath = ""files/"" + userInput; // User-supplied input concatenated with a fixed file path

        try {
            FileReader fileReader = new FileReader(filePath);
            BufferedReader bufferedReader = new BufferedReader(fileReader);

            String line;
            while ((line = bufferedReader.readLine()) != null) {
                System.out.println(line);
            }

            bufferedReader.close();
        } catch (IOException e) {
            System.err.println(""Error reading file: "" + e.getMessage());
        }
    }
}","import java.io.BufferedReader; import java.io.FileReader; import java.io.IOException; public class PathTraversalVulnerability { public static void main(String[] args) { String userInput = ""../../../../../etc/passwd""; String filePath = ""files/"" + userInput; // User-supplied input concatenated with a fixed file path try { FileReader fileReader = new FileReader(filePath); BufferedReader bufferedReader = new BufferedReader(fileReader); String line; while ((line = bufferedReader.readLine()) != null) { System.out.println(line); } bufferedReader.close(); } catch (IOException e) { System.err.println(""Error reading file: "" + e.getMessage()); } } }",java,1
SQL Injection,"import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Statement;

public class SQLInjectionVulnerability {

    public static void main(String[] args) {
        String userInput = ""'; DROP TABLE users; --""; // Simulated user input with malicious SQL injection

        try {
            Connection connection = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");
            Statement statement = connection.createStatement();

            String query = ""SELECT * FROM users WHERE username = '"" + userInput + ""'"";
            ResultSet resultSet = statement.executeQuery(query);

            while (resultSet.next()) {
                System.out.println(resultSet.getString(""username""));
            }

            resultSet.close();
            statement.close();
            connection.close();
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.Connection; import java.sql.DriverManager; import java.sql.ResultSet; import java.sql.SQLException; import java.sql.Statement; public class SQLInjectionVulnerability { public static void main(String[] args) { String userInput = ""'; DROP TABLE users; --""; // Simulated user input with malicious SQL injection try { Connection connection = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); Statement statement = connection.createStatement(); String query = ""SELECT * FROM users WHERE username = '"" + userInput + ""'""; ResultSet resultSet = statement.executeQuery(query); while (resultSet.next()) { System.out.println(resultSet.getString(""username"")); } resultSet.close(); statement.close(); connection.close(); } catch (SQLException e) { e.printStackTrace(); } } }",java,1
Clear,"import java.sql.*;

public class SecureSQLInjection {
    public static void main(String[] args) {
        String userInput = ""'; DROP TABLE users; --""; // Malicious input

        try {
            Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");

            String query = ""SELECT * FROM users WHERE username = ?"";
            PreparedStatement stmt = conn.prepareStatement(query);
            stmt.setString(1, userInput);

            ResultSet rs = stmt.executeQuery();

            while (rs.next()) {
                System.out.println(""Username: "" + rs.getString(""username""));
                System.out.println(""Email: "" + rs.getString(""email""));
            }

            conn.close();
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.*; public class SecureSQLInjection { public static void main(String[] args) { String userInput = ""'; DROP TABLE users; --""; // Malicious input try { Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); String query = ""SELECT * FROM users WHERE username = ?""; PreparedStatement stmt = conn.prepareStatement(query); stmt.setString(1, userInput); ResultSet rs = stmt.executeQuery(); while (rs.next()) { System.out.println(""Username: "" + rs.getString(""username"")); System.out.println(""Email: "" + rs.getString(""email"")); } conn.close(); } catch (SQLException e) { e.printStackTrace(); } } }",java,0
Clear,"The vulnerability in the provided code snippet is related to Insecure Deserialization, which can be exploited by an attacker to execute arbitrary code. To fix this issue, you should implement proper security measures to prevent malicious input from being deserialized and executed.

Here are some steps you can take to secure the deserialization process:

1. **Validate Input**: Ensure that only trusted serialized data is deserialized. Do not accept serialized data from untrusted sources.

2. **Use a Secure Deserialization Mechanism**: Instead of using standard Java deserialization, consider using safer alternatives like JSON or XML parsing libraries that do not execute arbitrary code during deserialization.

3. **Implement Whitelisting/Blacklisting**: Maintain a whitelist of allowed classes for deserialization and reject any attempts to deserialize classes that are not explicitly whitelisted.

4. **Implement Input Sanitization**: Validate and sanitize the input data before deserializing it to prevent injection attacks.

5. **Apply Secure Coding Practices**: Follow secure coding practices such as input validation, output encoding, and proper exception handling to mitigate vulnerabilities.

6. **Monitor and Log Deserialization Activities**: Keep track of deserialization activities in your application logs and monitor for any suspicious behavior.

Here is an example of how you","The vulnerability in the provided code snippet is related to Insecure Deserialization, which can be exploited by an attacker to execute arbitrary code. To fix this issue, you should implement proper security measures to prevent malicious input from being deserialized and executed. Here are some steps you can take to secure the deserialization process: 1. **Validate Input**: Ensure that only trusted serialized data is deserialized. Do not accept serialized data from untrusted sources. 2. **Use a Secure Deserialization Mechanism**: Instead of using standard Java deserialization, consider using safer alternatives like JSON or XML parsing libraries that do not execute arbitrary code during deserialization. 3. **Implement Whitelisting/Blacklisting**: Maintain a whitelist of allowed classes for deserialization and reject any attempts to deserialize classes that are not explicitly whitelisted. 4. **Implement Input Sanitization**: Validate and sanitize the input data before deserializing it to prevent injection attacks. 5. **Apply Secure Coding Practices**: Follow secure coding practices such as input validation, output encoding, and proper exception handling to mitigate vulnerabilities. 6. **Monitor and Log Deserialization Activities**: Keep track of deserialization activities in your application logs and monitor for any suspicious behavior. Here is an example of how you",php,0
Command Injection,"import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class CommandInjectionVulnerable {
    public static void main(String[] args) throws IOException {
        BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));
        
        System.out.print(""Enter a command to execute: "");
        String command = reader.readLine();
        
        // Vulnerability: User input 'command' is directly passed to Runtime.getRuntime().exec()
        Process process = Runtime.getRuntime().exec(command);
        
        BufferedReader inputReader = new BufferedReader(new InputStreamReader(process.getInputStream()));
        String line;
        
        while ((line = inputReader.readLine()) != null) {
            System.out.println(line);
        }
    }
}","import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class CommandInjectionVulnerable { public static void main(String[] args) throws IOException { BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a command to execute: ""); String command = reader.readLine(); // Vulnerability: User input 'command' is directly passed to Runtime.getRuntime().exec() Process process = Runtime.getRuntime().exec(command); BufferedReader inputReader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = inputReader.readLine()) != null) { System.out.println(line); } } }",java,1
Clear,"#include <iostream>
#include <sstream>

int safe_string_to_int(const std::string& str) {
    std::stringstream ss(str);
    int value;
    if (ss >> value) {
        return value;
    }
    throw std::invalid_argument(""Invalid integer"");
}","#include <iostream>
#include <sstream>

int safe_string_to_int(const std::string& str) {
    std::stringstream ss(str);
    int value;
    if (ss >> value) {
        return value;
    }
    throw std::invalid_argument(""Invalid integer"");
}",cpp,0
Clear,"import psycopg2
def safe_admin_query(admin_id):
    conn = psycopg2.connect(""dbname=test user=postgres"")
    cur = conn.cursor()
    cur.execute(""SELECT * FROM admins WHERE id = %s"", (admin_id,))
    return cur.fetchone()","import psycopg2
def safe_admin_query(admin_id):
    conn = psycopg2.connect(""dbname=test user=postgres"")
    cur = conn.cursor()
    cur.execute(""SELECT * FROM admins WHERE id = %s"", (admin_id,))
    return cur.fetchone()",python,0
SQL Injection,"import java.sql.*;

public class SQLInjectionVulnerable {

    public static void main(String[] args) {
        String userInput = ""admin'; DROP TABLE users; --"";

        try {
            Connection connection = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");
            Statement statement = connection.createStatement();

            // Vulnerable code - directly concatenating user input into the SQL query
            String query = ""SELECT * FROM users WHERE username = '"" + userInput + ""'"";
            ResultSet resultSet = statement.executeQuery(query);

            while (resultSet.next()) {
                System.out.println(resultSet.getString(""username""));
            }

            connection.close();
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.*; public class SQLInjectionVulnerable { public static void main(String[] args) { String userInput = ""admin'; DROP TABLE users; --""; try { Connection connection = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); Statement statement = connection.createStatement(); // Vulnerable code - directly concatenating user input into the SQL query String query = ""SELECT * FROM users WHERE username = '"" + userInput + ""'""; ResultSet resultSet = statement.executeQuery(query); while (resultSet.next()) { System.out.println(resultSet.getString(""username"")); } connection.close(); } catch (SQLException e) { e.printStackTrace(); } } }",java,1
SQL Injection,"import java.sql.*;

public class SQLInjectionVulnerable {

    public static void main(String[] args) {
        String userInput = ""'; DROP TABLE users; --""; // Malicious user input

        try {
            Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");
            Statement stmt = conn.createStatement();

            String query = ""SELECT * FROM users WHERE username = '"" + userInput + ""'"";
            ResultSet rs = stmt.executeQuery(query);

            while (rs.next()) {
                System.out.println(rs.getString(""username""));
            }

        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.*; public class SQLInjectionVulnerable { public static void main(String[] args) { String userInput = ""'; DROP TABLE users; --""; // Malicious user input try { Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); Statement stmt = conn.createStatement(); String query = ""SELECT * FROM users WHERE username = '"" + userInput + ""'""; ResultSet rs = stmt.executeQuery(query); while (rs.next()) { System.out.println(rs.getString(""username"")); } } catch (SQLException e) { e.printStackTrace(); } } }",java,1
Command Injection,"import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class CommandInjectionVulnerable {

    public static void main(String[] args) {
        try {
            BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));
            System.out.print(""Enter a directory name: "");
            String directoryName = reader.readLine();

            String command = ""ls "" + directoryName; // Vulnerable code, user input directly used in command

            Process process = Runtime.getRuntime().exec(command);

            BufferedReader resultReader = new BufferedReader(new InputStreamReader(process.getInputStream()));
            String line;
            while ((line = resultReader.readLine()) != null) {
                System.out.println(line);
            }
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}","import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class CommandInjectionVulnerable { public static void main(String[] args) { try { BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a directory name: ""); String directoryName = reader.readLine(); String command = ""ls "" + directoryName; // Vulnerable code, user input directly used in command Process process = Runtime.getRuntime().exec(command); BufferedReader resultReader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = resultReader.readLine()) != null) { System.out.println(line); } } catch (IOException e) { e.printStackTrace(); } } }",java,1
Hardcoded Secrets,"import requests
def call_api():
    api_key = ""sk_live_1234567890abcdef""
    headers = {'Authorization': f'Bearer {api_key}'}
    return requests.get('https://api.example.com/data', headers=headers)","import requests
def call_api():
    api_key = ""sk_live_1234567890abcdef""
    headers = {'Authorization': f'Bearer {api_key}'}
    return requests.get('https://api.example.com/data', headers=headers)",python,1
Path Traversal,"import java.io.BufferedReader;
import java.io.FileReader;
import java.io.IOException;

public class PathTraversalVulnerability {

    public static void main(String[] args) {
        String fileName = args[0]; // User input - filename provided as command line argument

        try {
            FileReader fileReader = new FileReader(""data/"" + fileName); // Vulnerability: User input directly used to construct file path
            BufferedReader bufferedReader = new BufferedReader(fileReader);

            String line;
            while ((line = bufferedReader.readLine()) != null) {
                System.out.println(line);
            }

            bufferedReader.close();
        } catch (IOException e) {
            System.out.println(""Error reading file: "" + e.getMessage());
        }
    }
}","import java.io.BufferedReader; import java.io.FileReader; import java.io.IOException; public class PathTraversalVulnerability { public static void main(String[] args) { String fileName = args[0]; // User input - filename provided as command line argument try { FileReader fileReader = new FileReader(""data/"" + fileName); // Vulnerability: User input directly used to construct file path BufferedReader bufferedReader = new BufferedReader(fileReader); String line; while ((line = bufferedReader.readLine()) != null) { System.out.println(line); } bufferedReader.close(); } catch (IOException e) { System.out.println(""Error reading file: "" + e.getMessage()); } } }",java,1
Cross-Site Scripting (XSS),"from flask import Flask, request
app = Flask(__name__)

@app.route('/search')
def search():
    query = request.args.get('q', '')
    return f'<h1>Search results for: {query}</h1>'","from flask import Flask, request
app = Flask(__name__)

@app.route('/search')
def search():
    query = request.args.get('q', '')
    return f'<h1>Search results for: {query}</h1>'",python,1
Cross-Site Scripting (XSS),"import java.io.*;

public class XSSVulnerableCode {

    public static void main(String[] args) {
        String userInput = ""<script>alert('XSS Attack!')</script>"";
        
        System.out.println(""User input: "" + userInput);
        
        // Improperly handling user input by directly printing it to HTML output
        System.out.println(""<div>"" + userInput + ""</div>"");
    }
}","import java.io.*; public class XSSVulnerableCode { public static void main(String[] args) { String userInput = ""<script>alert('XSS Attack!')</script>""; System.out.println(""User input: "" + userInput); // Improperly handling user input by directly printing it to HTML output System.out.println(""<div>"" + userInput + ""</div>""); } }",java,1
Clear,"#include <stdio.h>
#include <stdlib.h>

int safe_string_to_int(const char *str) {
    char *endptr;
    long value = strtol(str, &endptr, 10);
    if (*endptr != '\0' || str == endptr) {
        return -1; // error
    }
    return (int)value;
}","#include <stdio.h>
#include <stdlib.h>

int safe_string_to_int(const char *str) {
    char *endptr;
    long value = strtol(str, &endptr, 10);
    if (*endptr != '\0' || str == endptr) {
        return -1; // error
    }
    return (int)value;
}",c,0
Clear,"To fix the SQL Injection vulnerability in the provided Java code snippet, you should use PreparedStatement instead of Statement to safely handle user input in SQL queries. PreparedStatements are precompiled SQL statements that can be parameterized and help prevent SQL Injection attacks by automatically escaping special characters in input parameters.

Here's the updated code with the security measures implemented using PreparedStatement:

```java
import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;

public class SQLInjectionSecureApp {

    public static void main(String[] args) {
        String userInput = ""1 OR 1=1""; // Simulated user input for SQL Injection

        String url = ""jdbc:mysql://localhost:3306/mydatabase"";
        String username = ""root"";
        String password = ""password"";

        try {
            Connection connection = DriverManager.getConnection(url, username, password);

            // Using PreparedStatement to safely handle user input
            String query = ""SELECT * FROM users WHERE id=?"";
            PreparedStatement preparedStatement = connection.prepareStatement(query);
            preparedStatement.setString(1, userInput);

            ResultSet resultSet = preparedStatement.executeQuery();

            while (resultSet.next()) {
                System.out.println(""User ID: "" + resultSet.getInt(""id"") + "", Username:","To fix the SQL Injection vulnerability in the provided Java code snippet, you should use PreparedStatement instead of Statement to safely handle user input in SQL queries. PreparedStatements are precompiled SQL statements that can be parameterized and help prevent SQL Injection attacks by automatically escaping special characters in input parameters. Here's the updated code with the security measures implemented using PreparedStatement: ```java import java.sql.Connection; import java.sql.DriverManager; import java.sql.PreparedStatement; import java.sql.ResultSet; import java.sql.SQLException; public class SQLInjectionSecureApp { public static void main(String[] args) { String userInput = ""1 OR 1=1""; // Simulated user input for SQL Injection String url = ""jdbc:mysql://localhost:3306/mydatabase""; String username = ""root""; String password = ""password""; try { Connection connection = DriverManager.getConnection(url, username, password); // Using PreparedStatement to safely handle user input String query = ""SELECT * FROM users WHERE id=?""; PreparedStatement preparedStatement = connection.prepareStatement(query); preparedStatement.setString(1, userInput); ResultSet resultSet = preparedStatement.executeQuery(); while (resultSet.next()) { System.out.println(""User ID: "" + resultSet.getInt(""id"") + "", Username:",java,0
Clear,"import pickle
def safe_deserialize(data):
    allowed_classes = {'SafeClass', 'AnotherSafeClass'}
    return pickle.loads(data)","import pickle
def safe_deserialize(data):
    allowed_classes = {'SafeClass', 'AnotherSafeClass'}
    return pickle.loads(data)",python,0
Path Traversal,"import java.io.File;
import java.io.IOException;
import java.nio.file.Files;
import java.util.Scanner;

public class PathTraversalVulnerable {

    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        
        System.out.println(""Enter file name:"");
        String fileName = scanner.nextLine();
        
        File file = new File(fileName);
        
        if (file.exists()) {
            try {
                byte[] fileContent = Files.readAllBytes(file.toPath());
                System.out.println(""File content: "" + new String(fileContent));
            } catch (IOException e) {
                System.err.println(""Error reading file."");
            }
        } else {
            System.err.println(""File not found."");
        }
        
        scanner.close();
    }
}","import java.io.File; import java.io.IOException; import java.nio.file.Files; import java.util.Scanner; public class PathTraversalVulnerable { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.println(""Enter file name:""); String fileName = scanner.nextLine(); File file = new File(fileName); if (file.exists()) { try { byte[] fileContent = Files.readAllBytes(file.toPath()); System.out.println(""File content: "" + new String(fileContent)); } catch (IOException e) { System.err.println(""Error reading file.""); } } else { System.err.println(""File not found.""); } scanner.close(); } }",java,1
Hardcoded Secrets,"localStorage.setItem('token', 'hardcoded-secret-token-123'); // Hardcoded secret
","localStorage.setItem('token', 'hardcoded-secret-token-123'); // Hardcoded secret
",javascript,1
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Cross-Site Scripting (XSS),"import java.io.*;

public class XSSVulnerableCode {

    public static void main(String[] args) throws IOException {
        BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));
        
        System.out.print(""Enter your name: "");
        String userName = reader.readLine();
        
        System.out.println(""Hello, "" + userName + ""!""); // This line is vulnerable to XSS
    }
}","import java.io.*; public class XSSVulnerableCode { public static void main(String[] args) throws IOException { BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter your name: ""); String userName = reader.readLine(); System.out.println(""Hello, "" + userName + ""!""); // This line is vulnerable to XSS } }",java,1
XSS,"<?php
echo $_GET['message']; // XSS
?>","<?php
echo $_GET['message']; // XSS
?>",php,1
Insecure Deserialization,"import pickle
def load_user_data(filename):
    with open(filename, 'rb') as f:
        data = pickle.load(f)
    return data","import pickle
def load_user_data(filename):
    with open(filename, 'rb') as f:
        data = pickle.load(f)
    return data",python,1
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Path Traversal,"import os
def read_file(filename):
    with open('/var/www/uploads/' + filename, 'r') as f:
        return f.read()","import os
def read_file(filename):
    with open('/var/www/uploads/' + filename, 'r') as f:
        return f.read()",python,1
Clear,"To fix the Path Traversal vulnerability in the provided Java code snippet, you should ensure that user input is properly validated and sanitized before using it to construct the file path. Here's an improved version of the code that includes proper security measures:

```java
import java.io.File;
import java.io.FileInputStream;
import java.io.IOException;

public class SecureFileRead {

    public static void main(String[] args) {
        if (args.length < 1) {
            System.out.println(""Please provide a file name as an argument."");
            return;
        }

        String fileName = args[0]; // User input for file name

        // Validate and sanitize user input to prevent Path Traversal
        if (!isValidFileName(fileName)) {
            System.out.println(""Invalid file name provided."");
            return;
        }

        try {
            File file = new File(""data/"" + fileName);
            
            // Check if the file exists and is not a directory
            if (file.exists() && !file.isDirectory()) {
                FileInputStream fis = new FileInputStream(file);
                int content;
                while ((content = fis.read()) != -1) {
                    System.out.print((char) content);
                }
                fis.close();
            } else {
                System.out","To fix the Path Traversal vulnerability in the provided Java code snippet, you should ensure that user input is properly validated and sanitized before using it to construct the file path. Here's an improved version of the code that includes proper security measures: ```java import java.io.File; import java.io.FileInputStream; import java.io.IOException; public class SecureFileRead { public static void main(String[] args) { if (args.length < 1) { System.out.println(""Please provide a file name as an argument.""); return; } String fileName = args[0]; // User input for file name // Validate and sanitize user input to prevent Path Traversal if (!isValidFileName(fileName)) { System.out.println(""Invalid file name provided.""); return; } try { File file = new File(""data/"" + fileName); // Check if the file exists and is not a directory if (file.exists() && !file.isDirectory()) { FileInputStream fis = new FileInputStream(file); int content; while ((content = fis.read()) != -1) { System.out.print((char) content); } fis.close(); } else { System.out",java,0
Clear,"#include <iostream>
#include <string>
#include <vector>

void safe_string_handling(const std::string& input) {
    std::string safe_copy = input;
    std::cout << safe_copy << std::endl;
}","#include <iostream>
#include <string>
#include <vector>

void safe_string_handling(const std::string& input) {
    std::string safe_copy = input;
    std::cout << safe_copy << std::endl;
}",cpp,0
XSS,"<?php
echo $_GET['message']; // XSS
?>","<?php
echo $_GET['message']; // XSS
?>",php,1
Clear,"#include <iostream>
#include <string>
#include <vector>

void safe_string_handling(const std::string& input) {
    std::string safe_copy = input;
    std::cout << safe_copy << std::endl;
}","#include <iostream>
#include <string>
#include <vector>

void safe_string_handling(const std::string& input) {
    std::string safe_copy = input;
    std::cout << safe_copy << std::endl;
}",cpp,0
SQL Injection,"import java.sql.*;

public class VulnerableCode {
    public static void main(String[] args) {
        String userInput = args[0]; // Simulating user input
        
        String url = ""jdbc:mysql://localhost:3306/mydatabase"";
        String username = ""root"";
        String password = ""password"";
        
        try {
            Connection conn = DriverManager.getConnection(url, username, password);
            Statement stmt = conn.createStatement();
            
            // Vulnerable SQL query where user input is concatenated directly into the query
            String query = ""SELECT * FROM users WHERE username='"" + userInput + ""'"";
            
            ResultSet rs = stmt.executeQuery(query);
            
            while (rs.next()) {
                System.out.println(""User ID: "" + rs.getInt(""id"") + "", Username: "" + rs.getString(""username""));
            }
            
            conn.close();
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.*; public class VulnerableCode { public static void main(String[] args) { String userInput = args[0]; // Simulating user input String url = ""jdbc:mysql://localhost:3306/mydatabase""; String username = ""root""; String password = ""password""; try { Connection conn = DriverManager.getConnection(url, username, password); Statement stmt = conn.createStatement(); // Vulnerable SQL query where user input is concatenated directly into the query String query = ""SELECT * FROM users WHERE username='"" + userInput + ""'""; ResultSet rs = stmt.executeQuery(query); while (rs.next()) { System.out.println(""User ID: "" + rs.getInt(""id"") + "", Username: "" + rs.getString(""username"")); } conn.close(); } catch (SQLException e) { e.printStackTrace(); } } }",java,1
Buffer Overflow,"#include <iostream>
#include <cstdio>

void unsafe_c_input() {
    char buffer[50];
    scanf(""%s"", buffer); // no length limit
    std::cout << buffer << std::endl;
}","#include <iostream>
#include <cstdio>

void unsafe_c_input() {
    char buffer[50];
    scanf(""%s"", buffer); // no length limit
    std::cout << buffer << std::endl;
}",cpp,1
Clear,"import java.io.*;
import javax.servlet.*;
import javax.servlet.http.*;
import org.owasp.encoder.Encode;

public class InputHandlerServlet extends HttpServlet {
    protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        String userInput = request.getParameter(""input"");
        PrintWriter out = response.getWriter();
        
        out.println(""You entered: "" + Encode.forHtml(userInput)); // Properly encode user input before printing
        
        // Other processing logic
    }
}","import java.io.*; import javax.servlet.*; import javax.servlet.http.*; import org.owasp.encoder.Encode; public class InputHandlerServlet extends HttpServlet { protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { String userInput = request.getParameter(""input""); PrintWriter out = response.getWriter(); out.println(""You entered: "" + Encode.forHtml(userInput)); // Properly encode user input before printing // Other processing logic } }",java,0
Hardcoded Secrets,"localStorage.setItem('token', 'hardcoded-secret-token-123'); // Hardcoded secret
","localStorage.setItem('token', 'hardcoded-secret-token-123'); // Hardcoded secret
",javascript,1
Path Traversal,"import java.io.File;
import java.io.IOException;
import java.nio.file.Files;
import java.util.Scanner;

public class PathTraversalVulnerability {

    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        System.out.print(""Enter file name: "");
        String fileName = scanner.nextLine();

        File file = new File(""C:/data/"" + fileName); // Vulnerable code

        try {
            byte[] fileContent = Files.readAllBytes(file.toPath());
            System.out.println(new String(fileContent));
        } catch (IOException e) {
            System.out.println(""File not found or could not be read."");
        }
    }
}","import java.io.File; import java.io.IOException; import java.nio.file.Files; import java.util.Scanner; public class PathTraversalVulnerability { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter file name: ""); String fileName = scanner.nextLine(); File file = new File(""C:/data/"" + fileName); // Vulnerable code try { byte[] fileContent = Files.readAllBytes(file.toPath()); System.out.println(new String(fileContent)); } catch (IOException e) { System.out.println(""File not found or could not be read.""); } } }",java,1
File Inclusion,"<?php
$file = $_GET['file'];
include($file); // File Inclusion
?>","<?php
$file = $_GET['file'];
include($file); // File Inclusion
?>",php,1
Path Traversal,"import java.io.File;
import java.io.FileInputStream;
import java.io.IOException;
import java.util.Scanner;

public class PathTraversalVulnerability {
    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        System.out.print(""Enter file name: "");
        String fileName = scanner.nextLine();

        try {
            File file = new File(""resources/"" + fileName);
            FileInputStream fis = new FileInputStream(file);

            int data;
            while ((data = fis.read()) != -1) {
                System.out.print((char) data);
            }

            fis.close();
        } catch (IOException e) {
            System.out.println(""Error reading file: "" + e.getMessage());
        }
    }
}","import java.io.File; import java.io.FileInputStream; import java.io.IOException; import java.util.Scanner; public class PathTraversalVulnerability { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter file name: ""); String fileName = scanner.nextLine(); try { File file = new File(""resources/"" + fileName); FileInputStream fis = new FileInputStream(file); int data; while ((data = fis.read()) != -1) { System.out.print((char) data); } fis.close(); } catch (IOException e) { System.out.println(""Error reading file: "" + e.getMessage()); } } }",java,1
Clear,"#include <stdio.h>
#include <stdlib.h>

void safe_file_operation(const char *filename) {
    FILE *file = fopen(filename, ""r"");
    if (file != NULL) {
        char buffer[256];
        while (fgets(buffer, sizeof(buffer), file)) {
            printf(""%s"", buffer);
        }
        fclose(file);
    }
}","#include <stdio.h>
#include <stdlib.h>

void safe_file_operation(const char *filename) {
    FILE *file = fopen(filename, ""r"");
    if (file != NULL) {
        char buffer[256];
        while (fgets(buffer, sizeof(buffer), file)) {
            printf(""%s"", buffer);
        }
        fclose(file);
    }
}",c,0
Memory Corruption,"#include <iostream>

void unsafe_pointer_arithmetic(int* array, int size) {
    for (int i = 0; i <= size; i++) {
        std::cout << *(array + i) << std::endl; // potential out-of-bounds
    }
}","#include <iostream>

void unsafe_pointer_arithmetic(int* array, int size) {
    for (int i = 0; i <= size; i++) {
        std::cout << *(array + i) << std::endl; // potential out-of-bounds
    }
}",cpp,1
Clear,"#include <iostream>
#include <sstream>

int safe_string_to_int(const std::string& str) {
    std::stringstream ss(str);
    int value;
    if (ss >> value) {
        return value;
    }
    throw std::invalid_argument(""Invalid integer"");
}","#include <iostream>
#include <sstream>

int safe_string_to_int(const std::string& str) {
    std::stringstream ss(str);
    int value;
    if (ss >> value) {
        return value;
    }
    throw std::invalid_argument(""Invalid integer"");
}",cpp,0
Clear,"#include <iostream>
#include <string>
#include <vector>

void safe_string_handling(const std::string& input) {
    std::string safe_copy = input;
    std::cout << safe_copy << std::endl;
}","#include <iostream>
#include <string>
#include <vector>

void safe_string_handling(const std::string& input) {
    std::string safe_copy = input;
    std::cout << safe_copy << std::endl;
}",cpp,0
Insecure Deserialization,"<?php
$data = $_POST['data'];
unserialize($data); // Insecure Deserialization
?>","<?php
$data = $_POST['data'];
unserialize($data); // Insecure Deserialization
?>",php,1
Command Injection,"const shell = require('child_process');
shell.exec('ping ' + userInput); // Command Injection
","const shell = require('child_process');
shell.exec('ping ' + userInput); // Command Injection
",javascript,1
Clear,"To fix the Path Traversal vulnerability in the given Java code snippet, we need to ensure that the user input for the file name cannot be used to traverse outside of the intended directory (""/path/to/directory/""). One way to achieve this is by validating and sanitizing the user input before constructing the file path. Here's an updated version of the code with proper security measures:

```java
import java.io.File;
import java.io.IOException;
import java.nio.file.Files;
import java.util.Scanner;

public class SecurePathTraversal {
    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);

        System.out.println(""Enter file name:"");
        String fileName = scanner.nextLine();

        // Validate and sanitize the file name input
        if (!isValidFileName(fileName)) {
            System.out.println(""Invalid file name."");
            return;
        }

        String directory = ""/path/to/directory/"";
        String filePath = directory + fileName;

        File file = new File(filePath);

        try {
            // Check if the constructed file path is within the intended directory
            if (file.getCanonicalPath().startsWith(new File(directory).getCanonicalPath())) {
                byte[] fileContent = Files.readAllBytes(file.toPath());
                System","To fix the Path Traversal vulnerability in the given Java code snippet, we need to ensure that the user input for the file name cannot be used to traverse outside of the intended directory (""/path/to/directory/""). One way to achieve this is by validating and sanitizing the user input before constructing the file path. Here's an updated version of the code with proper security measures: ```java import java.io.File; import java.io.IOException; import java.nio.file.Files; import java.util.Scanner; public class SecurePathTraversal { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.println(""Enter file name:""); String fileName = scanner.nextLine(); // Validate and sanitize the file name input if (!isValidFileName(fileName)) { System.out.println(""Invalid file name.""); return; } String directory = ""/path/to/directory/""; String filePath = directory + fileName; File file = new File(filePath); try { // Check if the constructed file path is within the intended directory if (file.getCanonicalPath().startsWith(new File(directory).getCanonicalPath())) { byte[] fileContent = Files.readAllBytes(file.toPath()); System",java,0
Buffer Overflow,"import java.util.Scanner;

public class BufferOverflowExample {
    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        System.out.print(""Enter your name: "");
        String name = scanner.nextLine();
        
        // Vulnerability: No validation or length check on user input
        byte[] buffer = new byte[10];
        System.arraycopy(name.getBytes(), 0, buffer, 0, name.length());
        
        System.out.println(""Hello, "" + new String(buffer));
    }
}","import java.util.Scanner; public class BufferOverflowExample { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter your name: ""); String name = scanner.nextLine(); // Vulnerability: No validation or length check on user input byte[] buffer = new byte[10]; System.arraycopy(name.getBytes(), 0, buffer, 0, name.length()); System.out.println(""Hello, "" + new String(buffer)); } }",java,1
Clear,"To fix the Path Traversal vulnerability in the given Java code snippet, you need to ensure that the file being accessed is within a specific directory and not allowing access to files outside of that directory. One way to do this is by validating and sanitizing the input file path provided by the user.

Here's an example of how you can modify the code to ensure secure file access:

```java
import java.io.File;
import java.io.FileReader;
import java.io.IOException;
import java.util.Scanner;

public class SecurePathTraversal {

    private static final String BASE_PATH = ""/path/to/secure/directory/"";

    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        System.out.print(""Enter file name: "");
        String fileName = scanner.nextLine();

        // Check if the input file path is within the secure directory
        if (isWithinSecureDirectory(fileName)) {
            try {
                File file = new File(BASE_PATH + fileName);
                FileReader fileReader = new FileReader(file);

                int character;
                while ((character = fileReader.read()) != -1) {
                    System.out.print((char) character);
                }

                fileReader.close();
            } catch (IOException e) {
                System.out.println","To fix the Path Traversal vulnerability in the given Java code snippet, you need to ensure that the file being accessed is within a specific directory and not allowing access to files outside of that directory. One way to do this is by validating and sanitizing the input file path provided by the user. Here's an example of how you can modify the code to ensure secure file access: ```java import java.io.File; import java.io.FileReader; import java.io.IOException; import java.util.Scanner; public class SecurePathTraversal { private static final String BASE_PATH = ""/path/to/secure/directory/""; public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter file name: ""); String fileName = scanner.nextLine(); // Check if the input file path is within the secure directory if (isWithinSecureDirectory(fileName)) { try { File file = new File(BASE_PATH + fileName); FileReader fileReader = new FileReader(file); int character; while ((character = fileReader.read()) != -1) { System.out.print((char) character); } fileReader.close(); } catch (IOException e) { System.out.println",java,0
File Inclusion,"<?php
$file = $_GET['file'];
include($file); // File Inclusion
?>","<?php
$file = $_GET['file'];
include($file); // File Inclusion
?>",php,1
Clear,"#include <iostream>
#include <sstream>

int safe_string_to_int(const std::string& str) {
    std::stringstream ss(str);
    int value;
    if (ss >> value) {
        return value;
    }
    throw std::invalid_argument(""Invalid integer"");
}","#include <iostream>
#include <sstream>

int safe_string_to_int(const std::string& str) {
    std::stringstream ss(str);
    int value;
    if (ss >> value) {
        return value;
    }
    throw std::invalid_argument(""Invalid integer"");
}",cpp,0
Clear,"To prevent Path Traversal vulnerabilities in the code, you should validate user input and ensure that the file being accessed is within an allowed directory. Here's an updated version of the code with security measures implemented:

```java
import java.io.File;
import java.io.FileReader;
import java.io.IOException;
import java.nio.file.Paths;
import java.util.Scanner;

public class SecurePathTraversal {

    private static final String BASE_DIRECTORY = ""/path/to/safe/directory/"";

    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        System.out.print(""Enter file name: "");
        String fileName = scanner.next();

        // Validate file name to prevent path traversal
        if (!isValidFileName(fileName)) {
            System.out.println(""Invalid file name."");
            return;
        }

        try {
            File file = new File(BASE_DIRECTORY + fileName);
            if (!file.exists() || !file.isFile()) {
                System.out.println(""File not found."");
                return;
            }

            FileReader fileReader = new FileReader(file);
            int character;
            while ((character = fileReader.read()) != -1) {
                System.out.print((char) character);
            }
            fileReader.close();
        } catch (IOException e)","To prevent Path Traversal vulnerabilities in the code, you should validate user input and ensure that the file being accessed is within an allowed directory. Here's an updated version of the code with security measures implemented: ```java import java.io.File; import java.io.FileReader; import java.io.IOException; import java.nio.file.Paths; import java.util.Scanner; public class SecurePathTraversal { private static final String BASE_DIRECTORY = ""/path/to/safe/directory/""; public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter file name: ""); String fileName = scanner.next(); // Validate file name to prevent path traversal if (!isValidFileName(fileName)) { System.out.println(""Invalid file name.""); return; } try { File file = new File(BASE_DIRECTORY + fileName); if (!file.exists() || !file.isFile()) { System.out.println(""File not found.""); return; } FileReader fileReader = new FileReader(file); int character; while ((character = fileReader.read()) != -1) { System.out.print((char) character); } fileReader.close(); } catch (IOException e)",java,0
Cross-Site Scripting (XSS),"import java.io.*;

public class XSSVulnerableCode {
    public static void main(String[] args) {
        // Simulating user input from a web form
        String userInput = ""<script>alert('XSS Vulnerability')</script>"";

        // Improperly handling user input by directly outputting it to HTML
        System.out.println(""<div>"" + userInput + ""</div>"");
    }
}","import java.io.*; public class XSSVulnerableCode { public static void main(String[] args) { // Simulating user input from a web form String userInput = ""<script>alert('XSS Vulnerability')</script>""; // Improperly handling user input by directly outputting it to HTML System.out.println(""<div>"" + userInput + ""</div>""); } }",java,1
Cross-Site Scripting (XSS),"import java.io.IOException;
import java.io.PrintWriter;

import javax.servlet.ServletException;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

public class VulnerableServlet extends HttpServlet {
    
    protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        String userInput = request.getParameter(""input"");
        
        // Improper handling of user input without proper sanitization
        String output = ""<h1>Welcome "" + userInput + ""</h1>"";
        
        response.setContentType(""text/html"");
        PrintWriter out = response.getWriter();
        out.println(output);
    }
}","import java.io.IOException; import java.io.PrintWriter; import javax.servlet.ServletException; import javax.servlet.http.HttpServlet; import javax.servlet.http.HttpServletRequest; import javax.servlet.http.HttpServletResponse; public class VulnerableServlet extends HttpServlet { protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { String userInput = request.getParameter(""input""); // Improper handling of user input without proper sanitization String output = ""<h1>Welcome "" + userInput + ""</h1>""; response.setContentType(""text/html""); PrintWriter out = response.getWriter(); out.println(output); } }",java,1
Clear,"import os
def get_database_config():
    return {
        'host': os.environ.get('DB_HOST'),
        'user': os.environ.get('DB_USER'),
        'password': os.environ.get('DB_PASSWORD')
    }","import os
def get_database_config():
    return {
        'host': os.environ.get('DB_HOST'),
        'user': os.environ.get('DB_USER'),
        'password': os.environ.get('DB_PASSWORD')
    }",python,0
Buffer Overflow,"#include <iostream>
#include <cstdio>

void unsafe_c_input() {
    char buffer[50];
    scanf(""%s"", buffer); // no length limit
    std::cout << buffer << std::endl;
}","#include <iostream>
#include <cstdio>

void unsafe_c_input() {
    char buffer[50];
    scanf(""%s"", buffer); // no length limit
    std::cout << buffer << std::endl;
}",cpp,1
Cross-Site Scripting (XSS),"from flask import Flask, request
app = Flask(__name__)

@app.route('/search')
def search():
    query = request.args.get('q', '')
    return f'<h1>Search results for: {query}</h1>'","from flask import Flask, request
app = Flask(__name__)

@app.route('/search')
def search():
    query = request.args.get('q', '')
    return f'<h1>Search results for: {query}</h1>'",python,1
Clear,"#include <iostream>
#include <fstream>
#include <string>

void safe_file_reading(const std::string& filename) {
    std::ifstream file(filename);
    if (file.is_open()) {
        std::string line;
        while (std::getline(file, line)) {
            std::cout << line << std::endl;
        }
    }
}","#include <iostream>
#include <fstream>
#include <string>

void safe_file_reading(const std::string& filename) {
    std::ifstream file(filename);
    if (file.is_open()) {
        std::string line;
        while (std::getline(file, line)) {
            std::cout << line << std::endl;
        }
    }
}",cpp,0
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Clear,"#include <iostream>
#include <memory>

void safe_memory_management() {
    auto ptr = std::make_unique<int>(42);
    std::cout << *ptr << std::endl;
}","#include <iostream>
#include <memory>

void safe_memory_management() {
    auto ptr = std::make_unique<int>(42);
    std::cout << *ptr << std::endl;
}",cpp,0
Clear,"#include <stdio.h>
#include <stdlib.h>

int safe_string_to_int(const char *str) {
    char *endptr;
    long value = strtol(str, &endptr, 10);
    if (*endptr != '\0' || str == endptr) {
        return -1; // error
    }
    return (int)value;
}","#include <stdio.h>
#include <stdlib.h>

int safe_string_to_int(const char *str) {
    char *endptr;
    long value = strtol(str, &endptr, 10);
    if (*endptr != '\0' || str == endptr) {
        return -1; // error
    }
    return (int)value;
}",c,0
Clear,"import java.sql.*;

public class SecureCode {

    public static void main(String[] args) {
        try {
            String userInput = ""'; DROP TABLE users; --"";

            String query = ""SELECT * FROM users WHERE username = ?"";
            
            Connection connection = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");
            PreparedStatement preparedStatement = connection.prepareStatement(query);
            preparedStatement.setString(1, userInput);

            ResultSet resultSet = preparedStatement.executeQuery();

            while (resultSet.next()) {
                System.out.println(resultSet.getString(""username""));
            }

        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.*; public class SecureCode { public static void main(String[] args) { try { String userInput = ""'; DROP TABLE users; --""; String query = ""SELECT * FROM users WHERE username = ?""; Connection connection = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); PreparedStatement preparedStatement = connection.prepareStatement(query); preparedStatement.setString(1, userInput); ResultSet resultSet = preparedStatement.executeQuery(); while (resultSet.next()) { System.out.println(resultSet.getString(""username"")); } } catch (SQLException e) { e.printStackTrace(); } } }",java,0
Clear,"import java.io.*;
import org.owasp.encoder.Encode;

public class XSSFixedCode {
    public static void main(String[] args) throws IOException {
        BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));
        
        System.out.print(""Enter your name: "");
        String name = reader.readLine();
        
        String sanitizedName = Encode.forHtml(name); // HTML encode the user input
        
        System.out.println(""Hello, "" + sanitizedName + ""!""); // Output sanitized user input
    }
}","import java.io.*; import org.owasp.encoder.Encode; public class XSSFixedCode { public static void main(String[] args) throws IOException { BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter your name: ""); String name = reader.readLine(); String sanitizedName = Encode.forHtml(name); // HTML encode the user input System.out.println(""Hello, "" + sanitizedName + ""!""); // Output sanitized user input } }",java,0
Memory Corruption,"#include <iostream>

void unsafe_pointer_arithmetic(int* array, int size) {
    for (int i = 0; i <= size; i++) {
        std::cout << *(array + i) << std::endl; // potential out-of-bounds
    }
}","#include <iostream>

void unsafe_pointer_arithmetic(int* array, int size) {
    for (int i = 0; i <= size; i++) {
        std::cout << *(array + i) << std::endl; // potential out-of-bounds
    }
}",cpp,1
Clear,"const userData = JSON.parse(userInput); // Safe JSON parsing
if (userData && typeof userData === 'object') {
    processUserData(userData);
}
","const userData = JSON.parse(userInput); // Safe JSON parsing
if (userData && typeof userData === 'object') {
    processUserData(userData);
}
",javascript,0
Clear,"import pickle
def safe_deserialize(data):
    allowed_classes = {'SafeClass', 'AnotherSafeClass'}
    return pickle.loads(data)","import pickle
def safe_deserialize(data):
    allowed_classes = {'SafeClass', 'AnotherSafeClass'}
    return pickle.loads(data)",python,0
Clear,"#include <iostream>
#include <sstream>

int safe_string_to_int(const std::string& str) {
    std::stringstream ss(str);
    int value;
    if (ss >> value) {
        return value;
    }
    throw std::invalid_argument(""Invalid integer"");
}","#include <iostream>
#include <sstream>

int safe_string_to_int(const std::string& str) {
    std::stringstream ss(str);
    int value;
    if (ss >> value) {
        return value;
    }
    throw std::invalid_argument(""Invalid integer"");
}",cpp,0
Clear,"def validate_input(input_str):
    if not isinstance(input_str, str):
        raise TypeError(""Input must be string"")
    if len(input_str) > 100:
        raise ValueError(""Input too long"")
    if '<script>' in input_str.lower():
        raise ValueError(""Invalid input"")
    return input_str.strip()","def validate_input(input_str):
    if not isinstance(input_str, str):
        raise TypeError(""Input must be string"")
    if len(input_str) > 100:
        raise ValueError(""Input too long"")
    if '<script>' in input_str.lower():
        raise ValueError(""Invalid input"")
    return input_str.strip()",python,0
Path Traversal,"def get_user_file(username, filepath):
    import os
    base_path = f""/home/{username}/files/""
    full_path = base_path + filepath
    with open(full_path, 'r') as f:
        return f.read()","def get_user_file(username, filepath):
    import os
    base_path = f""/home/{username}/files/""
    full_path = base_path + filepath
    with open(full_path, 'r') as f:
        return f.read()",python,1
Clear,"import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class SecureCommandExecutionDemo {
    public static void main(String[] args) {
        try {
            BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));
            System.out.print(""Enter a command to execute: "");
            String command = reader.readLine();

            // Securely execute the command using ProcessBuilder
            ProcessBuilder processBuilder = new ProcessBuilder(command.split("" ""));
            Process process = processBuilder.start();

            BufferedReader processOutputReader = new BufferedReader(new InputStreamReader(process.getInputStream()));
            String outputLine;

            while ((outputLine = processOutputReader.readLine()) != null) {
                System.out.println(outputLine);
            }

        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}","import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class SecureCommandExecutionDemo { public static void main(String[] args) { try { BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a command to execute: ""); String command = reader.readLine(); // Securely execute the command using ProcessBuilder ProcessBuilder processBuilder = new ProcessBuilder(command.split("" "")); Process process = processBuilder.start(); BufferedReader processOutputReader = new BufferedReader(new InputStreamReader(process.getInputStream())); String outputLine; while ((outputLine = processOutputReader.readLine()) != null) { System.out.println(outputLine); } } catch (IOException e) { e.printStackTrace(); } } }",java,0
Command Injection,"<?php
$cmd = $_GET['cmd'];
system($cmd); // Command Injection
?>","<?php
$cmd = $_GET['cmd'];
system($cmd); // Command Injection
?>",php,1
Command Injection,"const shell = require('child_process');
shell.exec('ping ' + userInput); // Command Injection
","const shell = require('child_process');
shell.exec('ping ' + userInput); // Command Injection
",javascript,1
Clear,"#include <iostream>
#include <vector>
#include <stdexcept>

int safe_vector_access(const std::vector<int>& vec, size_t index) {
    if (index >= vec.size()) {
        throw std::out_of_range(""Index out of range"");
    }
    return vec[index];
}","#include <iostream>
#include <vector>
#include <stdexcept>

int safe_vector_access(const std::vector<int>& vec, size_t index) {
    if (index >= vec.size()) {
        throw std::out_of_range(""Index out of range"");
    }
    return vec[index];
}",cpp,0
Clear,"const userInput = new URLSearchParams(window.location.search).get('input');
const safeOutput = document.createElement('div');
safeOutput.textContent = userInput; // Safe DOM manipulation
document.body.appendChild(safeOutput);
","const userInput = new URLSearchParams(window.location.search).get('input');
const safeOutput = document.createElement('div');
safeOutput.textContent = userInput; // Safe DOM manipulation
document.body.appendChild(safeOutput);
",javascript,0
Clear,"import java.util.Scanner;

public class SecureBufferExample {
    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        
        System.out.print(""Enter your name: "");
        String name = scanner.nextLine();
        
        // Dynamically allocate a byte array based on the length of the input string
        byte[] buffer = new byte[name.length()];
        System.arraycopy(name.getBytes(), 0, buffer, 0, name.length());
        
        System.out.println(""Hello, "" + new String(buffer));
    }
}","import java.util.Scanner; public class SecureBufferExample { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter your name: ""); String name = scanner.nextLine(); // Dynamically allocate a byte array based on the length of the input string byte[] buffer = new byte[name.length()]; System.arraycopy(name.getBytes(), 0, buffer, 0, name.length()); System.out.println(""Hello, "" + new String(buffer)); } }",java,0
Memory Corruption,"#include <iostream>

void unsafe_pointer_arithmetic(int* array, int size) {
    for (int i = 0; i <= size; i++) {
        std::cout << *(array + i) << std::endl; // potential out-of-bounds
    }
}","#include <iostream>

void unsafe_pointer_arithmetic(int* array, int size) {
    for (int i = 0; i <= size; i++) {
        std::cout << *(array + i) << std::endl; // potential out-of-bounds
    }
}",cpp,1
Clear,"#include <iostream>
#include <memory>

void safe_memory_management() {
    auto ptr = std::make_unique<int>(42);
    std::cout << *ptr << std::endl;
}","#include <iostream>
#include <memory>

void safe_memory_management() {
    auto ptr = std::make_unique<int>(42);
    std::cout << *ptr << std::endl;
}",cpp,0
Memory Corruption,"#include <iostream>

void unsafe_virtual_call() {
    // Potential vtable corruption vulnerability
    class Base {
    public:
        virtual void func() { std::cout << ""Base"" << std::endl; }
    };
    
    class Derived : public Base {
    public:
        void func() override { std::cout << ""Derived"" << std::endl; }
    };
}","#include <iostream>

void unsafe_virtual_call() {
    // Potential vtable corruption vulnerability
    class Base {
    public:
        virtual void func() { std::cout << ""Base"" << std::endl; }
    };
    
    class Derived : public Base {
    public:
        void func() override { std::cout << ""Derived"" << std::endl; }
    };
}",cpp,1
Clear,"String userInput = ""admin'; DROP TABLE users; --"";

// Use a prepared statement with placeholders for user input
String query = ""SELECT * FROM users WHERE username = ?"";
PreparedStatement preparedStatement = connection.prepareStatement(query);
preparedStatement.setString(1, userInput);

// Execute the prepared statement
ResultSet resultSet = preparedStatement.executeQuery();","String userInput = ""admin'; DROP TABLE users; --""; // Use a prepared statement with placeholders for user input String query = ""SELECT * FROM users WHERE username = ?""; PreparedStatement preparedStatement = connection.prepareStatement(query); preparedStatement.setString(1, userInput); // Execute the prepared statement ResultSet resultSet = preparedStatement.executeQuery();",php,0
Command Injection,"import subprocess
def list_directory(path):
    result = subprocess.run(f""ls {path}"", shell=True, capture_output=True, text=True)
    return result.stdout","import subprocess
def list_directory(path):
    result = subprocess.run(f""ls {path}"", shell=True, capture_output=True, text=True)
    return result.stdout",python,1
Clear,"import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;

public class SecureSQLCode {

    public static void main(String[] args) {
        String userInput = ""'; DROP TABLE users; --"";

        try {
            Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");

            String query = ""SELECT * FROM users WHERE username=?"";
            PreparedStatement stmt = conn.prepareStatement(query);
            stmt.setString(1, userInput);

            ResultSet rs = stmt.executeQuery();

            while (rs.next()) {
                System.out.println(""User ID: "" + rs.getInt(""id"") + "", Username: "" + rs.getString(""username""));
            }

            conn.close();
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.Connection; import java.sql.DriverManager; import java.sql.PreparedStatement; import java.sql.ResultSet; import java.sql.SQLException; public class SecureSQLCode { public static void main(String[] args) { String userInput = ""'; DROP TABLE users; --""; try { Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); String query = ""SELECT * FROM users WHERE username=?""; PreparedStatement stmt = conn.prepareStatement(query); stmt.setString(1, userInput); ResultSet rs = stmt.executeQuery(); while (rs.next()) { System.out.println(""User ID: "" + rs.getInt(""id"") + "", Username: "" + rs.getString(""username"")); } conn.close(); } catch (SQLException e) { e.printStackTrace(); } } }",java,0
Clear,"#include <iostream>
#include <sstream>

int safe_string_to_int(const std::string& str) {
    std::stringstream ss(str);
    int value;
    if (ss >> value) {
        return value;
    }
    throw std::invalid_argument(""Invalid integer"");
}","#include <iostream>
#include <sstream>

int safe_string_to_int(const std::string& str) {
    std::stringstream ss(str);
    int value;
    if (ss >> value) {
        return value;
    }
    throw std::invalid_argument(""Invalid integer"");
}",cpp,0
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Out-of-Bounds,"#include <iostream>

class UnsafeClass {
    int data[10];
public:
    int get_data(int index) {
        return data[index]; // no bounds checking
    }
};","#include <iostream>

class UnsafeClass {
    int data[10];
public:
    int get_data(int index) {
        return data[index]; // no bounds checking
    }
};",cpp,1
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Clear,"To fix the Path Traversal vulnerability in the provided Java code snippet, you should validate the user input and ensure that the file being accessed is within an allowed directory. One common approach to mitigate Path Traversal vulnerabilities is to use a whitelist approach where you restrict the file access to a specific directory.

Here is an improved version of the code with proper security measures:

```java
import java.io.File;
import java.io.FileInputStream;
import java.io.IOException;
import java.util.Scanner;

public class SecurePathTraversal {

    private static final String BASE_PATH = ""/path/to/directory/"";

    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        System.out.println(""Enter the file name:"");
        String fileName = scanner.nextLine();

        if (isValidFileName(fileName)) {
            try {
                File file = new File(BASE_PATH + fileName);
                if (file.exists() && file.isFile()) {
                    FileInputStream fis = new FileInputStream(file);

                    int content;
                    while ((content = fis.read()) != -1) {
                        System.out.print((char) content);
                    }

                    fis.close();
                } else {
                    System.out.println(""File not found."");
                }
            } catch (IOException e) {
                e.printStackTrace","To fix the Path Traversal vulnerability in the provided Java code snippet, you should validate the user input and ensure that the file being accessed is within an allowed directory. One common approach to mitigate Path Traversal vulnerabilities is to use a whitelist approach where you restrict the file access to a specific directory. Here is an improved version of the code with proper security measures: ```java import java.io.File; import java.io.FileInputStream; import java.io.IOException; import java.util.Scanner; public class SecurePathTraversal { private static final String BASE_PATH = ""/path/to/directory/""; public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.println(""Enter the file name:""); String fileName = scanner.nextLine(); if (isValidFileName(fileName)) { try { File file = new File(BASE_PATH + fileName); if (file.exists() && file.isFile()) { FileInputStream fis = new FileInputStream(file); int content; while ((content = fis.read()) != -1) { System.out.print((char) content); } fis.close(); } else { System.out.println(""File not found.""); } } catch (IOException e) { e.printStackTrace",java,0
Clear,"import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;

public class SQLInjectionSecure {

    public static void main(String[] args) {
        String userInput = ""'; DROP TABLE users; --"";

        try {
            Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");

            String query = ""SELECT * FROM users WHERE username=?"";
            PreparedStatement pstmt = conn.prepareStatement(query);
            pstmt.setString(1, userInput);

            ResultSet rs = pstmt.executeQuery();

            while (rs.next()) {
                System.out.println(""Username: "" + rs.getString(""username""));
            }

            conn.close();
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.Connection; import java.sql.DriverManager; import java.sql.PreparedStatement; import java.sql.ResultSet; import java.sql.SQLException; public class SQLInjectionSecure { public static void main(String[] args) { String userInput = ""'; DROP TABLE users; --""; try { Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); String query = ""SELECT * FROM users WHERE username=?""; PreparedStatement pstmt = conn.prepareStatement(query); pstmt.setString(1, userInput); ResultSet rs = pstmt.executeQuery(); while (rs.next()) { System.out.println(""Username: "" + rs.getString(""username"")); } conn.close(); } catch (SQLException e) { e.printStackTrace(); } } }",java,0
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Clear,import org.owasp.encoder.Encode;,import org.owasp.encoder.Encode;,python,0
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Clear,"#include <iostream>
#include <sstream>

int safe_string_to_int(const std::string& str) {
    std::stringstream ss(str);
    int value;
    if (ss >> value) {
        return value;
    }
    throw std::invalid_argument(""Invalid integer"");
}","#include <iostream>
#include <sstream>

int safe_string_to_int(const std::string& str) {
    std::stringstream ss(str);
    int value;
    if (ss >> value) {
        return value;
    }
    throw std::invalid_argument(""Invalid integer"");
}",cpp,0
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Insecure Deserialization,"import pickle
def load_user_data(filename):
    with open(filename, 'rb') as f:
        data = pickle.load(f)
    return data","import pickle
def load_user_data(filename):
    with open(filename, 'rb') as f:
        data = pickle.load(f)
    return data",python,1
Hardcoded Secrets,"DATABASE_PASSWORD = ""my_super_secret_password_123""
def db_connect():
    import psycopg2
    return psycopg2.connect(f""dbname=test user=admin password={DATABASE_PASSWORD}"")","DATABASE_PASSWORD = ""my_super_secret_password_123""
def db_connect():
    import psycopg2
    return psycopg2.connect(f""dbname=test user=admin password={DATABASE_PASSWORD}"")",python,1
Clear,"import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;
import java.util.ArrayList;
import java.util.List;

public class SecureCommandExecution {

    public static void main(String[] args) {
        try {
            // Taking user input
            BufferedReader br = new BufferedReader(new InputStreamReader(System.in));
            System.out.print(""Enter a command to execute: "");
            String userInput = br.readLine();

            // Securely executing the user input as a command
            List<String> command = new ArrayList<>();
            command.add(""ping"");
            command.add(userInput);

            ProcessBuilder processBuilder = new ProcessBuilder(command);
            Process process = processBuilder.start();

            // Reading the output of the command
            BufferedReader reader = new BufferedReader(new InputStreamReader(process.getInputStream()));
            String line;
            while ((line = reader.readLine()) != null) {
                System.out.println(line);
            }

        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}","import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; import java.util.ArrayList; import java.util.List; public class SecureCommandExecution { public static void main(String[] args) { try { // Taking user input BufferedReader br = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a command to execute: ""); String userInput = br.readLine(); // Securely executing the user input as a command List<String> command = new ArrayList<>(); command.add(""ping""); command.add(userInput); ProcessBuilder processBuilder = new ProcessBuilder(command); Process process = processBuilder.start(); // Reading the output of the command BufferedReader reader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = reader.readLine()) != null) { System.out.println(line); } } catch (IOException e) { e.printStackTrace(); } } }",java,0
Clear,"import java.util.Scanner;
import java.nio.charset.StandardCharsets;
import java.nio.ByteBuffer;

public class SecureBufferHandling {
    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);

        System.out.print(""Enter your name: "");
        String input = scanner.nextLine();

        // Encode the input string using UTF-8 charset
        byte[] encodedBytes = input.getBytes(StandardCharsets.UTF_8);

        // Limit buffer size to prevent buffer overflow
        int bufferSize = Math.min(encodedBytes.length, 10);
        byte[] buffer = new byte[bufferSize];

        // Copy the encoded bytes to the buffer
        System.arraycopy(encodedBytes, 0, buffer, 0, bufferSize);

        // Decode and print the contents of the buffer
        String output = new String(buffer, StandardCharsets.UTF_8);
        System.out.println(""Hello, "" + output);
    }
}","import java.util.Scanner; import java.nio.charset.StandardCharsets; import java.nio.ByteBuffer; public class SecureBufferHandling { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter your name: ""); String input = scanner.nextLine(); // Encode the input string using UTF-8 charset byte[] encodedBytes = input.getBytes(StandardCharsets.UTF_8); // Limit buffer size to prevent buffer overflow int bufferSize = Math.min(encodedBytes.length, 10); byte[] buffer = new byte[bufferSize]; // Copy the encoded bytes to the buffer System.arraycopy(encodedBytes, 0, buffer, 0, bufferSize); // Decode and print the contents of the buffer String output = new String(buffer, StandardCharsets.UTF_8); System.out.println(""Hello, "" + output); } }",java,0
Clear,"#include <iostream>
#include <fstream>
#include <string>

void safe_file_reading(const std::string& filename) {
    std::ifstream file(filename);
    if (file.is_open()) {
        std::string line;
        while (std::getline(file, line)) {
            std::cout << line << std::endl;
        }
    }
}","#include <iostream>
#include <fstream>
#include <string>

void safe_file_reading(const std::string& filename) {
    std::ifstream file(filename);
    if (file.is_open()) {
        std::string line;
        while (std::getline(file, line)) {
            std::cout << line << std::endl;
        }
    }
}",cpp,0
XSS,"const userInput = document.location.search.split('=')[1];
document.write(userInput); // XSS
","const userInput = document.location.search.split('=')[1];
document.write(userInput); // XSS
",javascript,1
Memory Corruption,"#include <iostream>

void unsafe_virtual_call() {
    // Potential vtable corruption vulnerability
    class Base {
    public:
        virtual void func() { std::cout << ""Base"" << std::endl; }
    };
    
    class Derived : public Base {
    public:
        void func() override { std::cout << ""Derived"" << std::endl; }
    };
}","#include <iostream>

void unsafe_virtual_call() {
    // Potential vtable corruption vulnerability
    class Base {
    public:
        virtual void func() { std::cout << ""Base"" << std::endl; }
    };
    
    class Derived : public Base {
    public:
        void func() override { std::cout << ""Derived"" << std::endl; }
    };
}",cpp,1
SQL Injection,"import java.sql.*;

public class VulnerableCodeSnippet {

    public static void main(String[] args) {
        String userInput = ""'; DROP TABLE users; --""; // Malicious input simulating a SQL Injection attack

        try {
            Connection connection = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");
            Statement statement = connection.createStatement();

            String query = ""SELECT * FROM users WHERE username = '"" + userInput + ""'"";
            ResultSet resultSet = statement.executeQuery(query);

            while (resultSet.next()) {
                System.out.println(resultSet.getString(""username""));
            }

            resultSet.close();
            statement.close();
            connection.close();
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.*; public class VulnerableCodeSnippet { public static void main(String[] args) { String userInput = ""'; DROP TABLE users; --""; // Malicious input simulating a SQL Injection attack try { Connection connection = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); Statement statement = connection.createStatement(); String query = ""SELECT * FROM users WHERE username = '"" + userInput + ""'""; ResultSet resultSet = statement.executeQuery(query); while (resultSet.next()) { System.out.println(resultSet.getString(""username"")); } resultSet.close(); statement.close(); connection.close(); } catch (SQLException e) { e.printStackTrace(); } } }",java,1
Command Injection,"import subprocess
def list_directory(path):
    result = subprocess.run(f""ls {path}"", shell=True, capture_output=True, text=True)
    return result.stdout","import subprocess
def list_directory(path):
    result = subprocess.run(f""ls {path}"", shell=True, capture_output=True, text=True)
    return result.stdout",python,1
File Inclusion,"<?php
$file = $_GET['file'];
include($file); // File Inclusion
?>","<?php
$file = $_GET['file'];
include($file); // File Inclusion
?>",php,1
Buffer Overflow,"#include <iostream>
#include <cstdio>

void unsafe_c_input() {
    char buffer[50];
    scanf(""%s"", buffer); // no length limit
    std::cout << buffer << std::endl;
}","#include <iostream>
#include <cstdio>

void unsafe_c_input() {
    char buffer[50];
    scanf(""%s"", buffer); // no length limit
    std::cout << buffer << std::endl;
}",cpp,1
Clear,"import java.io.*;
import javax.servlet.*;
import javax.servlet.http.*;
import org.owasp.encoder.Encode;

public class XSSSecureServlet extends HttpServlet {
    protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        String userInput = request.getParameter(""input"");
        String sanitizedInput = Encode.forHtml(userInput);
        
        String output = ""<p>User input: "" + sanitizedInput + ""</p>"";

        response.setContentType(""text/html"");
        PrintWriter out = response.getWriter();
        out.println(output);
    }
}","import java.io.*; import javax.servlet.*; import javax.servlet.http.*; import org.owasp.encoder.Encode; public class XSSSecureServlet extends HttpServlet { protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { String userInput = request.getParameter(""input""); String sanitizedInput = Encode.forHtml(userInput); String output = ""<p>User input: "" + sanitizedInput + ""</p>""; response.setContentType(""text/html""); PrintWriter out = response.getWriter(); out.println(output); } }",java,0
SQL Injection,"import psycopg2
def admin_login(admin_id):
    conn = psycopg2.connect(""dbname=test user=postgres"")
    cur = conn.cursor()
    cur.execute(f""SELECT * FROM admins WHERE id = {admin_id}"")
    return cur.fetchone()","import psycopg2
def admin_login(admin_id):
    conn = psycopg2.connect(""dbname=test user=postgres"")
    cur = conn.cursor()
    cur.execute(f""SELECT * FROM admins WHERE id = {admin_id}"")
    return cur.fetchone()",python,1
Clear,"<?php
$file = basename($_GET['file']);
$allowed = ['page1.php', 'page2.php'];
if (in_array($file, $allowed)) {
    include($file);
}
?>","<?php
$file = basename($_GET['file']);
$allowed = ['page1.php', 'page2.php'];
if (in_array($file, $allowed)) {
    include($file);
}
?>",php,0
SQL Injection,"app.get('/user/:id', (req, res) => {
    const query = `SELECT * FROM users WHERE id = ${req.params.id}`; // SQL Injection
    db.query(query, (err, result) => {
        res.json(result);
    });
});
","app.get('/user/:id', (req, res) => {
    const query = `SELECT * FROM users WHERE id = ${req.params.id}`; // SQL Injection
    db.query(query, (err, result) => {
        res.json(result);
    });
});
",javascript,1
Code Injection,"const userData = eval('(' + userInput + ')'); // eval injection
","const userData = eval('(' + userInput + ')'); // eval injection
",javascript,1
Clear,"import logging
def safe_log_user_action(user_id, action):
    logging.info(f""User {user_id} performed action: {action}"")","import logging
def safe_log_user_action(user_id, action):
    logging.info(f""User {user_id} performed action: {action}"")",python,0
Command Injection,"import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class CommandInjectionExample {

    public static void main(String[] args) {
        try {
            BufferedReader br = new BufferedReader(new InputStreamReader(System.in));
            System.out.print(""Enter a command to execute: "");
            String command = br.readLine();

            // This is where the vulnerability lies
            Runtime rt = Runtime.getRuntime();
            Process proc = rt.exec(command);

            BufferedReader reader = new BufferedReader(new InputStreamReader(proc.getInputStream()));
            String line;
            while ((line = reader.readLine()) != null) {
                System.out.println(line);
            }

        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}","import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class CommandInjectionExample { public static void main(String[] args) { try { BufferedReader br = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a command to execute: ""); String command = br.readLine(); // This is where the vulnerability lies Runtime rt = Runtime.getRuntime(); Process proc = rt.exec(command); BufferedReader reader = new BufferedReader(new InputStreamReader(proc.getInputStream())); String line; while ((line = reader.readLine()) != null) { System.out.println(line); } } catch (IOException e) { e.printStackTrace(); } } }",java,1
Clear,"<?php
$username = $_POST['username'];
$stmt = $pdo->prepare(""SELECT * FROM users WHERE username = ?"");
$stmt->execute([$username]); // Parameterized query
?>","<?php
$username = $_POST['username'];
$stmt = $pdo->prepare(""SELECT * FROM users WHERE username = ?"");
$stmt->execute([$username]); // Parameterized query
?>",php,0
Insecure Deserialization,"<?php
$data = $_POST['data'];
unserialize($data); // Insecure Deserialization
?>","<?php
$data = $_POST['data'];
unserialize($data); // Insecure Deserialization
?>",php,1
Memory Corruption,"#include <iostream>

void unsafe_pointer_arithmetic(int* array, int size) {
    for (int i = 0; i <= size; i++) {
        std::cout << *(array + i) << std::endl; // potential out-of-bounds
    }
}","#include <iostream>

void unsafe_pointer_arithmetic(int* array, int size) {
    for (int i = 0; i <= size; i++) {
        std::cout << *(array + i) << std::endl; // potential out-of-bounds
    }
}",cpp,1
SQL Injection,"import mysql.connector
def search_products(category):
    db = mysql.connector.connect(host=""localhost"", user=""user"", password=""pass"", database=""shop"")
    cursor = db.cursor()
    cursor.execute(""SELECT * FROM products WHERE category = '%s'"" % category)
    return cursor.fetchall()","import mysql.connector
def search_products(category):
    db = mysql.connector.connect(host=""localhost"", user=""user"", password=""pass"", database=""shop"")
    cursor = db.cursor()
    cursor.execute(""SELECT * FROM products WHERE category = '%s'"" % category)
    return cursor.fetchall()",python,1
File Inclusion,"<?php
$file = $_GET['file'];
include($file); // File Inclusion
?>","<?php
$file = $_GET['file'];
include($file); // File Inclusion
?>",php,1
Command Injection,"import java.io.IOException;

public class CommandInjectionExample {

    public static void main(String[] args) {
        String userInput = ""example.txt"";

        try {
            Runtime.getRuntime().exec(""cat "" + userInput);
        } catch (IOException e) {
            System.out.println(""An error occurred: "" + e.getMessage());
        }
    }
}","import java.io.IOException; public class CommandInjectionExample { public static void main(String[] args) { String userInput = ""example.txt""; try { Runtime.getRuntime().exec(""cat "" + userInput); } catch (IOException e) { System.out.println(""An error occurred: "" + e.getMessage()); } } }",java,1
Path Traversal,"import java.io.File;
import java.io.FileInputStream;
import java.io.IOException;
import java.util.Scanner;

public class PathTraversalVulnerability {

    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        System.out.println(""Enter file path: "");
        String filePath = scanner.nextLine();

        try {
            File file = new File(filePath);
            FileInputStream fis = new FileInputStream(file);
            int content;
            while ((content = fis.read()) != -1) {
                System.out.print((char) content);
            }
            fis.close();
        } catch (IOException e) {
            System.out.println(""Error reading file: "" + e.getMessage());
        }
    }
}","import java.io.File; import java.io.FileInputStream; import java.io.IOException; import java.util.Scanner; public class PathTraversalVulnerability { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.println(""Enter file path: ""); String filePath = scanner.nextLine(); try { File file = new File(filePath); FileInputStream fis = new FileInputStream(file); int content; while ((content = fis.read()) != -1) { System.out.print((char) content); } fis.close(); } catch (IOException e) { System.out.println(""Error reading file: "" + e.getMessage()); } } }",java,1
Cross-Site Scripting (XSS),"from flask import Flask, request
app = Flask(__name__)

@app.route('/search')
def search():
    query = request.args.get('q', '')
    return f'<h1>Search results for: {query}</h1>'","from flask import Flask, request
app = Flask(__name__)

@app.route('/search')
def search():
    query = request.args.get('q', '')
    return f'<h1>Search results for: {query}</h1>'",python,1
Clear,"<?php
$cmd = escapeshellarg($_GET['cmd']);
system(""ls "" . $cmd); // Escaped command
?>","<?php
$cmd = escapeshellarg($_GET['cmd']);
system(""ls "" . $cmd); // Escaped command
?>",php,0
Buffer Overflow,"#include <iostream>
#include <cstdio>

void unsafe_c_input() {
    char buffer[50];
    scanf(""%s"", buffer); // no length limit
    std::cout << buffer << std::endl;
}","#include <iostream>
#include <cstdio>

void unsafe_c_input() {
    char buffer[50];
    scanf(""%s"", buffer); // no length limit
    std::cout << buffer << std::endl;
}",cpp,1
Clear,"#include <iostream>
#include <string>
#include <vector>

void safe_string_handling(const std::string& input) {
    std::string safe_copy = input;
    std::cout << safe_copy << std::endl;
}","#include <iostream>
#include <string>
#include <vector>

void safe_string_handling(const std::string& input) {
    std::string safe_copy = input;
    std::cout << safe_copy << std::endl;
}",cpp,0
SSRF,"import urllib.request
def download_file(file_url):
    return urllib.request.urlopen(file_url).read()","import urllib.request
def download_file(file_url):
    return urllib.request.urlopen(file_url).read()",python,1
Clear,"import subprocess
def safe_directory_listing(path):
    result = subprocess.run(['ls', path], capture_output=True, text=True)
    return result.stdout","import subprocess
def safe_directory_listing(path):
    result = subprocess.run(['ls', path], capture_output=True, text=True)
    return result.stdout",python,0
File Inclusion,"<?php
$file = $_GET['file'];
include($file); // File Inclusion
?>","<?php
$file = $_GET['file'];
include($file); // File Inclusion
?>",php,1
Clear,"#include <stdio.h>
#include <stdlib.h>

void safe_file_operation(const char *filename) {
    FILE *file = fopen(filename, ""r"");
    if (file != NULL) {
        char buffer[256];
        while (fgets(buffer, sizeof(buffer), file)) {
            printf(""%s"", buffer);
        }
        fclose(file);
    }
}","#include <stdio.h>
#include <stdlib.h>

void safe_file_operation(const char *filename) {
    FILE *file = fopen(filename, ""r"");
    if (file != NULL) {
        char buffer[256];
        while (fgets(buffer, sizeof(buffer), file)) {
            printf(""%s"", buffer);
        }
        fclose(file);
    }
}",c,0
Cross-Site Scripting (XSS),"import java.io.IOException;
import java.io.PrintWriter;
import javax.servlet.ServletException;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

public class VulnerableServlet extends HttpServlet {
    
    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        String userInput = request.getParameter(""input"");
        
        response.setContentType(""text/html"");
        PrintWriter out = response.getWriter();
        
        out.println(""<html>"");
        out.println(""<head><title>XSS Vulnerable Page</title></head>"");
        out.println(""<body>"");
        
        // Improper handling of user input - directly outputting user input without proper encoding
        out.println(""<h1>User Input: "" + userInput + ""</h1>"");
        
        out.println(""</body>"");
        out.println(""</html>"");
    }
}","import java.io.IOException; import java.io.PrintWriter; import javax.servlet.ServletException; import javax.servlet.http.HttpServlet; import javax.servlet.http.HttpServletRequest; import javax.servlet.http.HttpServletResponse; public class VulnerableServlet extends HttpServlet { protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { String userInput = request.getParameter(""input""); response.setContentType(""text/html""); PrintWriter out = response.getWriter(); out.println(""<html>""); out.println(""<head><title>XSS Vulnerable Page</title></head>""); out.println(""<body>""); // Improper handling of user input - directly outputting user input without proper encoding out.println(""<h1>User Input: "" + userInput + ""</h1>""); out.println(""</body>""); out.println(""</html>""); } }",java,1
Clear,"import subprocess
def safe_ping(host):
    import re
    if not re.match(r'^[a-zA-Z0-9.-]+$', host):
        raise ValueError(""Invalid host"")
    result = subprocess.run(['ping', '-c', '4', host], capture_output=True, text=True)
    return result.stdout","import subprocess
def safe_ping(host):
    import re
    if not re.match(r'^[a-zA-Z0-9.-]+$', host):
        raise ValueError(""Invalid host"")
    result = subprocess.run(['ping', '-c', '4', host], capture_output=True, text=True)
    return result.stdout",python,0
Clear,"import requests
def safe_fetch_url(url):
    allowed_domains = ['example.com', 'api.trusted.com']
    from urllib.parse import urlparse
    domain = urlparse(url).netloc
    if domain not in allowed_domains:
        raise ValueError(""Domain not allowed"")
    return requests.get(url).text","import requests
def safe_fetch_url(url):
    allowed_domains = ['example.com', 'api.trusted.com']
    from urllib.parse import urlparse
    domain = urlparse(url).netloc
    if domain not in allowed_domains:
        raise ValueError(""Domain not allowed"")
    return requests.get(url).text",python,0
File Inclusion,"<?php
$file = $_GET['file'];
include($file); // File Inclusion
?>","<?php
$file = $_GET['file'];
include($file); // File Inclusion
?>",php,1
Buffer Overflow,"#include <iostream>
#include <cstdio>

void unsafe_c_input() {
    char buffer[50];
    scanf(""%s"", buffer); // no length limit
    std::cout << buffer << std::endl;
}","#include <iostream>
#include <cstdio>

void unsafe_c_input() {
    char buffer[50];
    scanf(""%s"", buffer); // no length limit
    std::cout << buffer << std::endl;
}",cpp,1
Clear,"const shell = require('child_process');
const safeInput = userInput.replace(/[^a-zA-Z0-9.]/g, '');
shell.execFile('ping', [safeInput]); // Safe command execution
","const shell = require('child_process');
const safeInput = userInput.replace(/[^a-zA-Z0-9.]/g, '');
shell.execFile('ping', [safeInput]); // Safe command execution
",javascript,0
Clear,"To fix the Path Traversal vulnerability in the provided Java code snippet, you need to sanitize and validate the user input to ensure that it does not allow directory traversal attacks. Here is an improved version of the code with proper security measures implemented:

```java
import java.io.File;
import java.io.IOException;
import java.nio.file.Files;
import java.util.Scanner;

public class SecurePathTraversal {

    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        System.out.print(""Enter file name: "");
        String fileName = scanner.nextLine();

        // Validate the input file name to prevent directory traversal attacks
        if (!isValidFileName(fileName)) {
            System.out.println(""Invalid file name."");
            return;
        }

        File file = new File(""C:/files/"" + fileName);

        try {
            byte[] fileContent = Files.readAllBytes(file.toPath());
            System.out.println(new String(fileContent));
        } catch (IOException e) {
            System.out.println(""Error reading file: "" + e.getMessage());
        }
    }

    // Method to validate the input file name to prevent directory traversal attacks
    private static boolean isValidFileName(String fileName) {
        // Implement your validation logic here
        //","To fix the Path Traversal vulnerability in the provided Java code snippet, you need to sanitize and validate the user input to ensure that it does not allow directory traversal attacks. Here is an improved version of the code with proper security measures implemented: ```java import java.io.File; import java.io.IOException; import java.nio.file.Files; import java.util.Scanner; public class SecurePathTraversal { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter file name: ""); String fileName = scanner.nextLine(); // Validate the input file name to prevent directory traversal attacks if (!isValidFileName(fileName)) { System.out.println(""Invalid file name.""); return; } File file = new File(""C:/files/"" + fileName); try { byte[] fileContent = Files.readAllBytes(file.toPath()); System.out.println(new String(fileContent)); } catch (IOException e) { System.out.println(""Error reading file: "" + e.getMessage()); } } // Method to validate the input file name to prevent directory traversal attacks private static boolean isValidFileName(String fileName) { // Implement your validation logic here //",java,0
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Buffer Overflow,"#include <iostream>
#include <cstring>

void unsafe_c_string(char* input) {
    char buffer[100];
    strcpy(buffer, input); // potential buffer overflow
    std::cout << buffer << std::endl;
}","#include <iostream>
#include <cstring>

void unsafe_c_string(char* input) {
    char buffer[100];
    strcpy(buffer, input); // potential buffer overflow
    std::cout << buffer << std::endl;
}",cpp,1
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Path Traversal,"import java.io.File;
import java.io.FileInputStream;
import java.io.IOException;
import java.util.Scanner;

public class PathTraversalExample {
    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        System.out.print(""Enter the file name: "");
        String fileName = scanner.nextLine();

        try {
            File file = new File(""/path/to/directory/"" + fileName);
            FileInputStream fis = new FileInputStream(file);

            byte[] data = new byte[(int) file.length()];
            fis.read(data);
            fis.close();

            System.out.println(""File content: "" + new String(data));
        } catch (IOException e) {
            System.out.println(""Error reading file: "" + e.getMessage());
        }
    }
}","import java.io.File; import java.io.FileInputStream; import java.io.IOException; import java.util.Scanner; public class PathTraversalExample { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter the file name: ""); String fileName = scanner.nextLine(); try { File file = new File(""/path/to/directory/"" + fileName); FileInputStream fis = new FileInputStream(file); byte[] data = new byte[(int) file.length()]; fis.read(data); fis.close(); System.out.println(""File content: "" + new String(data)); } catch (IOException e) { System.out.println(""Error reading file: "" + e.getMessage()); } } }",java,1
Clear,"import java.util.Scanner;

public class SecureBufferExample {

    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        
        System.out.print(""Enter your name: "");
        String input = scanner.nextLine();
        
        // Truncate input to fit within buffer size
        int length = Math.min(input.length(), 10);
        char[] buffer = new char[10];
        input.getChars(0, length, buffer, 0);
        
        System.out.println(""Hello, "" + new String(buffer));
    }
}","import java.util.Scanner; public class SecureBufferExample { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter your name: ""); String input = scanner.nextLine(); // Truncate input to fit within buffer size int length = Math.min(input.length(), 10); char[] buffer = new char[10]; input.getChars(0, length, buffer, 0); System.out.println(""Hello, "" + new String(buffer)); } }",java,0
Clear,"#include <iostream>
#include <sstream>

int safe_string_to_int(const std::string& str) {
    std::stringstream ss(str);
    int value;
    if (ss >> value) {
        return value;
    }
    throw std::invalid_argument(""Invalid integer"");
}","#include <iostream>
#include <sstream>

int safe_string_to_int(const std::string& str) {
    std::stringstream ss(str);
    int value;
    if (ss >> value) {
        return value;
    }
    throw std::invalid_argument(""Invalid integer"");
}",cpp,0
Clear,"import java.io.IOException;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import org.owasp.encoder.Encode;

public class XSSSafeServlet extends HttpServlet {

    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws IOException {
        String userInput = request.getParameter(""input"");

        // Safe code - Encode user input to prevent XSS
        String encodedInput = Encode.forHtml(userInput);
        
        response.getWriter().println(""<h1>User Input: "" + encodedInput + ""</h1>"");
    }
}","import java.io.IOException; import javax.servlet.http.HttpServlet; import javax.servlet.http.HttpServletRequest; import javax.servlet.http.HttpServletResponse; import org.owasp.encoder.Encode; public class XSSSafeServlet extends HttpServlet { protected void doGet(HttpServletRequest request, HttpServletResponse response) throws IOException { String userInput = request.getParameter(""input""); // Safe code - Encode user input to prevent XSS String encodedInput = Encode.forHtml(userInput); response.getWriter().println(""<h1>User Input: "" + encodedInput + ""</h1>""); } }",java,0
Clear,"const userInput = new URLSearchParams(window.location.search).get('input');
const safeOutput = document.createElement('div');
safeOutput.textContent = userInput; // Safe DOM manipulation
document.body.appendChild(safeOutput);
","const userInput = new URLSearchParams(window.location.search).get('input');
const safeOutput = document.createElement('div');
safeOutput.textContent = userInput; // Safe DOM manipulation
document.body.appendChild(safeOutput);
",javascript,0
Command Injection,"import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class CommandInjectionVulnerable {

    public static void main(String[] args) throws IOException {
        BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));
        
        System.out.print(""Enter a command to execute: "");
        String command = reader.readLine();
        
        Process process = Runtime.getRuntime().exec(command);
        
        BufferedReader processOutputReader = new BufferedReader(new InputStreamReader(process.getInputStream()));
        String line;
        while ((line = processOutputReader.readLine()) != null) {
            System.out.println(line);
        }
    }
}","import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class CommandInjectionVulnerable { public static void main(String[] args) throws IOException { BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a command to execute: ""); String command = reader.readLine(); Process process = Runtime.getRuntime().exec(command); BufferedReader processOutputReader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = processOutputReader.readLine()) != null) { System.out.println(line); } } }",java,1
Memory Corruption,"#include <iostream>

void unsafe_pointer_arithmetic(int* array, int size) {
    for (int i = 0; i <= size; i++) {
        std::cout << *(array + i) << std::endl; // potential out-of-bounds
    }
}","#include <iostream>

void unsafe_pointer_arithmetic(int* array, int size) {
    for (int i = 0; i <= size; i++) {
        std::cout << *(array + i) << std::endl; // potential out-of-bounds
    }
}",cpp,1
File Inclusion,"<?php
$file = $_GET['file'];
include($file); // File Inclusion
?>","<?php
$file = $_GET['file'];
include($file); // File Inclusion
?>",php,1
Clear,"const userData = JSON.parse(userInput); // Safe JSON parsing
if (userData && typeof userData === 'object') {
    processUserData(userData);
}
","const userData = JSON.parse(userInput); // Safe JSON parsing
if (userData && typeof userData === 'object') {
    processUserData(userData);
}
",javascript,0
Memory Corruption,"#include <iostream>

void unsafe_pointer_arithmetic(int* array, int size) {
    for (int i = 0; i <= size; i++) {
        std::cout << *(array + i) << std::endl; // potential out-of-bounds
    }
}","#include <iostream>

void unsafe_pointer_arithmetic(int* array, int size) {
    for (int i = 0; i <= size; i++) {
        std::cout << *(array + i) << std::endl; // potential out-of-bounds
    }
}",cpp,1
Clear,"To fix this code and prevent Command Injection vulnerabilities, you should not directly pass user input to the command execution. Instead, you should validate and sanitize the user input before using it in the command. Here's a secure version of the code using `ProcessBuilder` and proper input validation:

```java
import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class CommandInjectionSecure {

    public static void main(String[] args) {
        try {
            BufferedReader br = new BufferedReader(new InputStreamReader(System.in));
            System.out.print(""Enter a file name to display: "");
            String fileName = br.readLine();

            // Sanitize input by allowing only alphanumeric characters and '.'
            if (!fileName.matches(""[a-zA-Z0-9\\.]+"")) {
                System.out.println(""Invalid file name"");
                return;
            }

            // Secure code - use ProcessBuilder to execute the command safely
            ProcessBuilder processBuilder = new ProcessBuilder(""cat"", fileName);
            Process process = processBuilder.start();

            BufferedReader reader = new BufferedReader(new InputStreamReader(process.getInputStream()));
            String line;
            while ((line = reader.readLine()) != null) {
                System.out.println(line);
            }
        } catch (IOException e) {
            e.printStackTrace","To fix this code and prevent Command Injection vulnerabilities, you should not directly pass user input to the command execution. Instead, you should validate and sanitize the user input before using it in the command. Here's a secure version of the code using `ProcessBuilder` and proper input validation: ```java import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class CommandInjectionSecure { public static void main(String[] args) { try { BufferedReader br = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a file name to display: ""); String fileName = br.readLine(); // Sanitize input by allowing only alphanumeric characters and '.' if (!fileName.matches(""[a-zA-Z0-9\\.]+"")) { System.out.println(""Invalid file name""); return; } // Secure code - use ProcessBuilder to execute the command safely ProcessBuilder processBuilder = new ProcessBuilder(""cat"", fileName); Process process = processBuilder.start(); BufferedReader reader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = reader.readLine()) != null) { System.out.println(line); } } catch (IOException e) { e.printStackTrace",java,0
Cross-Site Scripting (XSS),"import java.io.IOException;
import java.io.PrintWriter;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

public class VulnerableServlet extends HttpServlet {
    
    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws IOException {
        String userInput = request.getParameter(""input"");
        
        PrintWriter out = response.getWriter();
        out.println(""<html>"");
        out.println(""<head><title>XSS Vulnerable Page</title></head>"");
        out.println(""<body>"");
        out.println(""<h1>Hello, "" + userInput + ""</h1>""); // User input is directly output without any validation or sanitization
        out.println(""</body>"");
        out.println(""</html>"");
    }
}","import java.io.IOException; import java.io.PrintWriter; import javax.servlet.http.HttpServlet; import javax.servlet.http.HttpServletRequest; import javax.servlet.http.HttpServletResponse; public class VulnerableServlet extends HttpServlet { protected void doGet(HttpServletRequest request, HttpServletResponse response) throws IOException { String userInput = request.getParameter(""input""); PrintWriter out = response.getWriter(); out.println(""<html>""); out.println(""<head><title>XSS Vulnerable Page</title></head>""); out.println(""<body>""); out.println(""<h1>Hello, "" + userInput + ""</h1>""); // User input is directly output without any validation or sanitization out.println(""</body>""); out.println(""</html>""); } }",java,1
Path Traversal,"import java.io.File;
import java.io.IOException;
import java.nio.file.Files;
import java.util.Scanner;

public class PathTraversalExample {

    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        System.out.print(""Enter file name: "");
        String fileName = scanner.nextLine();

        File file = new File(""/path/to/files/"" + fileName); // Vulnerable code here

        if (file.exists()) {
            try {
                byte[] fileContent = Files.readAllBytes(file.toPath());
                System.out.println(""File content: "" + new String(fileContent));
            } catch (IOException e) {
                e.printStackTrace();
            }
        } else {
            System.out.println(""File not found."");
        }

        scanner.close();
    }
}","import java.io.File; import java.io.IOException; import java.nio.file.Files; import java.util.Scanner; public class PathTraversalExample { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter file name: ""); String fileName = scanner.nextLine(); File file = new File(""/path/to/files/"" + fileName); // Vulnerable code here if (file.exists()) { try { byte[] fileContent = Files.readAllBytes(file.toPath()); System.out.println(""File content: "" + new String(fileContent)); } catch (IOException e) { e.printStackTrace(); } } else { System.out.println(""File not found.""); } scanner.close(); } }",java,1
Cross-Site Scripting (XSS),"import java.io.IOException;
import java.io.PrintWriter;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

public class XSSVulnerableServlet extends HttpServlet {
    
    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws IOException {
        String userInput = request.getParameter(""input"");
        
        // Vulnerability: User input is directly output to the response without proper sanitization
        PrintWriter out = response.getWriter();
        out.println(""<html>"");
        out.println(""<body>"");
        out.println(""<h1>User Input:</h1>"");
        out.println(""<p>"" + userInput + ""</p>""); // User input is not sanitized and can contain malicious scripts
        out.println(""</body>"");
        out.println(""</html>"");
    }
}","import java.io.IOException; import java.io.PrintWriter; import javax.servlet.http.HttpServlet; import javax.servlet.http.HttpServletRequest; import javax.servlet.http.HttpServletResponse; public class XSSVulnerableServlet extends HttpServlet { protected void doGet(HttpServletRequest request, HttpServletResponse response) throws IOException { String userInput = request.getParameter(""input""); // Vulnerability: User input is directly output to the response without proper sanitization PrintWriter out = response.getWriter(); out.println(""<html>""); out.println(""<body>""); out.println(""<h1>User Input:</h1>""); out.println(""<p>"" + userInput + ""</p>""); // User input is not sanitized and can contain malicious scripts out.println(""</body>""); out.println(""</html>""); } }",java,1
Command Injection,"const shell = require('child_process');
shell.exec('ping ' + userInput); // Command Injection
","const shell = require('child_process');
shell.exec('ping ' + userInput); // Command Injection
",javascript,1
SQL Injection,"import sqlite3
def get_user_data(username):
    conn = sqlite3.connect('database.db')
    cursor = conn.cursor()
    query = ""SELECT * FROM users WHERE username = '"" + username + ""'""
    cursor.execute(query)
    return cursor.fetchall()","import sqlite3
def get_user_data(username):
    conn = sqlite3.connect('database.db')
    cursor = conn.cursor()
    query = ""SELECT * FROM users WHERE username = '"" + username + ""'""
    cursor.execute(query)
    return cursor.fetchall()",python,1
Clear,"To fix the insecure Java code snippet for Path Traversal vulnerability, you need to ensure that the file path is properly sanitized and validated before accessing it. Here's an improved version of the code with security measures implemented:

```java
import java.io.File;
import java.io.IOException;
import java.nio.file.Files;
import java.nio.file.Path;
import java.nio.file.Paths;

public class FileDownloader {

    public static void downloadFile(String fileName) {
        String downloadDirectory = ""/var/www/downloads/"";
        
        // Validate and sanitize the file name to prevent path traversal
        String sanitizedFileName = fileName.replaceAll(""[^a-zA-Z0-9.-]"", """");
        
        // Construct the full file path using Paths to handle platform-specific separators
        Path filePath = Paths.get(downloadDirectory, sanitizedFileName).normalize();

        // Check if the normalized file path is within the download directory
        if (!filePath.startsWith(Paths.get(downloadDirectory))) {
            System.out.println(""Invalid file path."");
            return;
        }

        try {
            File fileToDownload = filePath.toFile();
            if (fileToDownload.exists()) {
                byte[] fileContent = Files.readAllBytes(filePath);
                // Code to download the file content
                System.out.println(""File","To fix the insecure Java code snippet for Path Traversal vulnerability, you need to ensure that the file path is properly sanitized and validated before accessing it. Here's an improved version of the code with security measures implemented: ```java import java.io.File; import java.io.IOException; import java.nio.file.Files; import java.nio.file.Path; import java.nio.file.Paths; public class FileDownloader { public static void downloadFile(String fileName) { String downloadDirectory = ""/var/www/downloads/""; // Validate and sanitize the file name to prevent path traversal String sanitizedFileName = fileName.replaceAll(""[^a-zA-Z0-9.-]"", """"); // Construct the full file path using Paths to handle platform-specific separators Path filePath = Paths.get(downloadDirectory, sanitizedFileName).normalize(); // Check if the normalized file path is within the download directory if (!filePath.startsWith(Paths.get(downloadDirectory))) { System.out.println(""Invalid file path.""); return; } try { File fileToDownload = filePath.toFile(); if (fileToDownload.exists()) { byte[] fileContent = Files.readAllBytes(filePath); // Code to download the file content System.out.println(""File",java,0
Clear,"def safe_division(a, b):
    if b == 0:
        raise ValueError(""Division by zero"")
    return a / b","def safe_division(a, b):
    if b == 0:
        raise ValueError(""Division by zero"")
    return a / b",python,0
SQL Injection,"import java.sql.*;

public class VulnerableCode {
    public static void main(String[] args) {
        String userInput = args[0]; // Assume user input is passed as a command line argument

        try {
            Connection connection = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");
            Statement statement = connection.createStatement();
            
            String query = ""SELECT * FROM users WHERE username='"" + userInput + ""'"";
            ResultSet resultSet = statement.executeQuery(query);
            
            while (resultSet.next()) {
                System.out.println(""User ID: "" + resultSet.getInt(""id"") + "", Username: "" + resultSet.getString(""username""));
            }
            
            connection.close();
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.*; public class VulnerableCode { public static void main(String[] args) { String userInput = args[0]; // Assume user input is passed as a command line argument try { Connection connection = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); Statement statement = connection.createStatement(); String query = ""SELECT * FROM users WHERE username='"" + userInput + ""'""; ResultSet resultSet = statement.executeQuery(query); while (resultSet.next()) { System.out.println(""User ID: "" + resultSet.getInt(""id"") + "", Username: "" + resultSet.getString(""username"")); } connection.close(); } catch (SQLException e) { e.printStackTrace(); } } }",java,1
Command Injection,"const shell = require('child_process');
shell.exec('ping ' + userInput); // Command Injection
","const shell = require('child_process');
shell.exec('ping ' + userInput); // Command Injection
",javascript,1
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Buffer Overflow,"#include <iostream>
#include <cstdio>

void unsafe_c_input() {
    char buffer[50];
    scanf(""%s"", buffer); // no length limit
    std::cout << buffer << std::endl;
}","#include <iostream>
#include <cstdio>

void unsafe_c_input() {
    char buffer[50];
    scanf(""%s"", buffer); // no length limit
    std::cout << buffer << std::endl;
}",cpp,1
Clear,"#include <stdio.h>
#include <string.h>

int validate_input(const char *input) {
    if (input == NULL) return 0;
    for (int i = 0; input[i] != '\0'; i++) {
        if (input[i] < 32 || input[i] > 126) {
            return 0; // invalid character
        }
    }
    return 1;
}","#include <stdio.h>
#include <string.h>

int validate_input(const char *input) {
    if (input == NULL) return 0;
    for (int i = 0; input[i] != '\0'; i++) {
        if (input[i] < 32 || input[i] > 126) {
            return 0; // invalid character
        }
    }
    return 1;
}",c,0
Clear,"import java.util.Scanner;

public class SecureBufferExample {

    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);

        System.out.print(""Enter a string: "");
        String userInput = scanner.next();

        // Secure copy with length check to prevent buffer overflow
        byte[] buffer = new byte[Math.min(userInput.length(), 10)];
        System.arraycopy(userInput.getBytes(), 0, buffer, 0, buffer.length);

        System.out.println(""User input: "" + new String(buffer));
    }
}","import java.util.Scanner; public class SecureBufferExample { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter a string: ""); String userInput = scanner.next(); // Secure copy with length check to prevent buffer overflow byte[] buffer = new byte[Math.min(userInput.length(), 10)]; System.arraycopy(userInput.getBytes(), 0, buffer, 0, buffer.length); System.out.println(""User input: "" + new String(buffer)); } }",java,0
Clear,"#include <iostream>
#include <sstream>

int safe_string_to_int(const std::string& str) {
    std::stringstream ss(str);
    int value;
    if (ss >> value) {
        return value;
    }
    throw std::invalid_argument(""Invalid integer"");
}","#include <iostream>
#include <sstream>

int safe_string_to_int(const std::string& str) {
    std::stringstream ss(str);
    int value;
    if (ss >> value) {
        return value;
    }
    throw std::invalid_argument(""Invalid integer"");
}",cpp,0
Memory Corruption,"#include <iostream>

void unsafe_pointer_arithmetic(int* array, int size) {
    for (int i = 0; i <= size; i++) {
        std::cout << *(array + i) << std::endl; // potential out-of-bounds
    }
}","#include <iostream>

void unsafe_pointer_arithmetic(int* array, int size) {
    for (int i = 0; i <= size; i++) {
        std::cout << *(array + i) << std::endl; // potential out-of-bounds
    }
}",cpp,1
Clear,"import java.util.Scanner;
import org.apache.commons.text.StringEscapeUtils;

public class XssSafeCode {

    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);

        System.out.print(""Enter your name: "");
        String userInput = scanner.nextLine();

        System.out.println(""Hello, "" + userInput + ""!"");

        // Sanitize user input to prevent XSS
        String escapedUserInput = StringEscapeUtils.escapeHtml4(userInput);
        
        // Embed sanitized user input into the HTML response
        System.out.println(""<script>alert('XSS Safe: Hello, "" + escapedUserInput + ""!')</script>"");
    }
}","import java.util.Scanner; import org.apache.commons.text.StringEscapeUtils; public class XssSafeCode { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter your name: ""); String userInput = scanner.nextLine(); System.out.println(""Hello, "" + userInput + ""!""); // Sanitize user input to prevent XSS String escapedUserInput = StringEscapeUtils.escapeHtml4(userInput); // Embed sanitized user input into the HTML response System.out.println(""<script>alert('XSS Safe: Hello, "" + escapedUserInput + ""!')</script>""); } }",java,0
Clear,"import logging
def safe_log_user_action(user_id, action):
    logging.info(f""User {user_id} performed action: {action}"")","import logging
def safe_log_user_action(user_id, action):
    logging.info(f""User {user_id} performed action: {action}"")",python,0
Buffer Overflow,"import java.util.Scanner;

public class BufferOverflowVulnerability {
    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        
        System.out.print(""Enter a string: "");
        String input = scanner.nextLine();
        
        char[] buffer = new char[10];
        input.getChars(0, input.length(), buffer, 0); // Copy user input into buffer
        
        // Vulnerable code: Attempting to print the contents of the buffer without proper bounds checking
        System.out.println(""Buffer contents: "" + new String(buffer));
    }
}","import java.util.Scanner; public class BufferOverflowVulnerability { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter a string: ""); String input = scanner.nextLine(); char[] buffer = new char[10]; input.getChars(0, input.length(), buffer, 0); // Copy user input into buffer // Vulnerable code: Attempting to print the contents of the buffer without proper bounds checking System.out.println(""Buffer contents: "" + new String(buffer)); } }",java,1
Insecure Deserialization,"import java.io.*;

public class InsecureDeserializationExample {

    public static void main(String[] args) {
        try {
            String userInput = ""filename.ser""; // User input for serialized file
            FileInputStream fis = new FileInputStream(userInput);
            ObjectInputStream ois = new ObjectInputStream(fis);
            Object obj = ois.readObject();
            
            // Unsafe casting of deserialized object
            String data = (String) obj;
            
            System.out.println(""Deserialized data: "" + data);
            
        } catch (Exception e) {
            e.printStackTrace();
        }
    }
}","import java.io.*; public class InsecureDeserializationExample { public static void main(String[] args) { try { String userInput = ""filename.ser""; // User input for serialized file FileInputStream fis = new FileInputStream(userInput); ObjectInputStream ois = new ObjectInputStream(fis); Object obj = ois.readObject(); // Unsafe casting of deserialized object String data = (String) obj; System.out.println(""Deserialized data: "" + data); } catch (Exception e) { e.printStackTrace(); } } }",java,1
Cross-Site Scripting (XSS),"from flask import Flask, request
app = Flask(__name__)

@app.route('/search')
def search():
    query = request.args.get('q', '')
    return f'<h1>Search results for: {query}</h1>'","from flask import Flask, request
app = Flask(__name__)

@app.route('/search')
def search():
    query = request.args.get('q', '')
    return f'<h1>Search results for: {query}</h1>'",python,1
Clear,"const shell = require('child_process');
const safeInput = userInput.replace(/[^a-zA-Z0-9.]/g, '');
shell.execFile('ping', [safeInput]); // Safe command execution
","const shell = require('child_process');
const safeInput = userInput.replace(/[^a-zA-Z0-9.]/g, '');
shell.execFile('ping', [safeInput]); // Safe command execution
",javascript,0
XSS,"<?php
echo $_GET['message']; // XSS
?>","<?php
echo $_GET['message']; // XSS
?>",php,1
SQL Injection,"<?php
$username = $_POST['username'];
$query = ""SELECT * FROM users WHERE username = '$username'"";
$result = mysql_query($query); // SQL Injection
?>","<?php
$username = $_POST['username'];
$query = ""SELECT * FROM users WHERE username = '$username'"";
$result = mysql_query($query); // SQL Injection
?>",php,1
SSRF,"import requests
def fetch_url(url):
    return requests.get(url).text","import requests
def fetch_url(url):
    return requests.get(url).text",python,1
Clear,"To fix the Command Injection vulnerability in the provided Java code snippet, you should properly handle user input to prevent malicious commands from being executed. One common approach is to use ProcessBuilder class instead of directly invoking Runtime.getRuntime().exec().

Here's an updated version of the code with proper security measures implemented:

```java
import java.io.IOException;
import java.util.Scanner;

public class SecureCommandInjectionExample {

    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        
        System.out.print(""Enter a file name to delete: "");
        String fileName = scanner.nextLine();
        
        try {
            // Safely execute the command using ProcessBuilder
            ProcessBuilder processBuilder = new ProcessBuilder(""rm"", fileName);
            Process process = processBuilder.start();
            
            int exitCode = process.waitFor(); // Wait for the process to finish
            
            if (exitCode == 0) {
                System.out.println(""File deleted successfully."");
            } else {
                System.err.println(""Failed to delete file. Exit code: "" + exitCode);
            }
            
        } catch (IOException | InterruptedException e) {
            System.err.println(""An error occurred: "" + e.getMessage());
        }
        
        scanner.close();","To fix the Command Injection vulnerability in the provided Java code snippet, you should properly handle user input to prevent malicious commands from being executed. One common approach is to use ProcessBuilder class instead of directly invoking Runtime.getRuntime().exec(). Here's an updated version of the code with proper security measures implemented: ```java import java.io.IOException; import java.util.Scanner; public class SecureCommandInjectionExample { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter a file name to delete: ""); String fileName = scanner.nextLine(); try { // Safely execute the command using ProcessBuilder ProcessBuilder processBuilder = new ProcessBuilder(""rm"", fileName); Process process = processBuilder.start(); int exitCode = process.waitFor(); // Wait for the process to finish if (exitCode == 0) { System.out.println(""File deleted successfully.""); } else { System.err.println(""Failed to delete file. Exit code: "" + exitCode); } } catch (IOException | InterruptedException e) { System.err.println(""An error occurred: "" + e.getMessage()); } scanner.close();",java,0
Cross-Site Scripting (XSS),"import java.io.*;
import javax.servlet.*;
import javax.servlet.http.*;

public class XSSVulnerableServlet extends HttpServlet {
    protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        String userInput = request.getParameter(""input"");
        PrintWriter out = response.getWriter();
        
        out.println(""<html>"");
        out.println(""<body>"");
        out.println(""<p>User input: "" + userInput + ""</p>""); // Improperly handling user input here
        out.println(""</body>"");
        out.println(""</html>"");
    }
}","import java.io.*; import javax.servlet.*; import javax.servlet.http.*; public class XSSVulnerableServlet extends HttpServlet { protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { String userInput = request.getParameter(""input""); PrintWriter out = response.getWriter(); out.println(""<html>""); out.println(""<body>""); out.println(""<p>User input: "" + userInput + ""</p>""); // Improperly handling user input here out.println(""</body>""); out.println(""</html>""); } }",java,1
Clear,"#include <stdio.h>
#include <stdlib.h>

void safe_file_operation(const char *filename) {
    FILE *file = fopen(filename, ""r"");
    if (file != NULL) {
        char buffer[256];
        while (fgets(buffer, sizeof(buffer), file)) {
            printf(""%s"", buffer);
        }
        fclose(file);
    }
}","#include <stdio.h>
#include <stdlib.h>

void safe_file_operation(const char *filename) {
    FILE *file = fopen(filename, ""r"");
    if (file != NULL) {
        char buffer[256];
        while (fgets(buffer, sizeof(buffer), file)) {
            printf(""%s"", buffer);
        }
        fclose(file);
    }
}",c,0
Insecure Deserialization,"<?php
$data = $_POST['data'];
unserialize($data); // Insecure Deserialization
?>","<?php
$data = $_POST['data'];
unserialize($data); // Insecure Deserialization
?>",php,1
Clear,"#include <iostream>
#include <memory>

void safe_memory_management() {
    auto ptr = std::make_unique<int>(42);
    std::cout << *ptr << std::endl;
}","#include <iostream>
#include <memory>

void safe_memory_management() {
    auto ptr = std::make_unique<int>(42);
    std::cout << *ptr << std::endl;
}",cpp,0
Command Injection,"<?php
$cmd = $_GET['cmd'];
system($cmd); // Command Injection
?>","<?php
$cmd = $_GET['cmd'];
system($cmd); // Command Injection
?>",php,1
Clear,"import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class CommandInjectionFixed {

    public static void main(String[] args) throws IOException {
        BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));

        System.out.print(""Enter a command to execute: "");
        String command = reader.readLine();

        // Sanitize and validate user input
        if (!command.matches(""[a-zA-Z0-9.-]+"")) {
            System.out.println(""Invalid command"");
            return;
        }

        // Use ProcessBuilder to execute the command safely
        ProcessBuilder processBuilder = new ProcessBuilder(command);
        Process process = processBuilder.start();

        BufferedReader outputReader = new BufferedReader(new InputStreamReader(process.getInputStream()));
        String outputLine;

        while ((outputLine = outputReader.readLine()) != null) {
            System.out.println(outputLine);
        }

        process.destroy();
    }
}","import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class CommandInjectionFixed { public static void main(String[] args) throws IOException { BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a command to execute: ""); String command = reader.readLine(); // Sanitize and validate user input if (!command.matches(""[a-zA-Z0-9.-]+"")) { System.out.println(""Invalid command""); return; } // Use ProcessBuilder to execute the command safely ProcessBuilder processBuilder = new ProcessBuilder(command); Process process = processBuilder.start(); BufferedReader outputReader = new BufferedReader(new InputStreamReader(process.getInputStream())); String outputLine; while ((outputLine = outputReader.readLine()) != null) { System.out.println(outputLine); } process.destroy(); } }",java,0
Insecure Deserialization,"import yaml
def load_config(config_str):
    return yaml.load(config_str, Loader=yaml.Loader)","import yaml
def load_config(config_str):
    return yaml.load(config_str, Loader=yaml.Loader)",python,1
Clear,"String userInput = ""'; DROP TABLE users; --"";

// Assume conn is your database connection
Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/database"", ""username"", ""password"");

// Use a PreparedStatement with parameterized query
String query = ""SELECT * FROM users WHERE username = ?"";
PreparedStatement pstmt = conn.prepareStatement(query);
pstmt.setString(1, userInput);

ResultSet rs = pstmt.executeQuery();

// Process the ResultSet as needed

// Close resources
rs.close();
pstmt.close();
conn.close();","String userInput = ""'; DROP TABLE users; --""; // Assume conn is your database connection Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/database"", ""username"", ""password""); // Use a PreparedStatement with parameterized query String query = ""SELECT * FROM users WHERE username = ?""; PreparedStatement pstmt = conn.prepareStatement(query); pstmt.setString(1, userInput); ResultSet rs = pstmt.executeQuery(); // Process the ResultSet as needed // Close resources rs.close(); pstmt.close(); conn.close();",php,0
Clear,"#include <iostream>
#include <fstream>
#include <string>

void safe_file_reading(const std::string& filename) {
    std::ifstream file(filename);
    if (file.is_open()) {
        std::string line;
        while (std::getline(file, line)) {
            std::cout << line << std::endl;
        }
    }
}","#include <iostream>
#include <fstream>
#include <string>

void safe_file_reading(const std::string& filename) {
    std::ifstream file(filename);
    if (file.is_open()) {
        std::string line;
        while (std::getline(file, line)) {
            std::cout << line << std::endl;
        }
    }
}",cpp,0
SQL Injection,"import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.ResultSet;
import java.sql.Statement;

public class VulnerableCode {

    public static void main(String[] args) {
        String userInput = args[0]; // User input passed as a command line argument
        
        try {
            Connection connection = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""root"", ""password"");
            Statement statement = connection.createStatement();
            
            String query = ""SELECT * FROM users WHERE username='"" + userInput + ""'"";
            ResultSet resultSet = statement.executeQuery(query);
            
            while (resultSet.next()) {
                System.out.println(resultSet.getString(""username""));
            }
            
            connection.close();
        } catch (Exception e) {
            e.printStackTrace();
        }
    }
}","import java.sql.Connection; import java.sql.DriverManager; import java.sql.ResultSet; import java.sql.Statement; public class VulnerableCode { public static void main(String[] args) { String userInput = args[0]; // User input passed as a command line argument try { Connection connection = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""root"", ""password""); Statement statement = connection.createStatement(); String query = ""SELECT * FROM users WHERE username='"" + userInput + ""'""; ResultSet resultSet = statement.executeQuery(query); while (resultSet.next()) { System.out.println(resultSet.getString(""username"")); } connection.close(); } catch (Exception e) { e.printStackTrace(); } } }",java,1
Clear,"To secure the code against Path Traversal attacks, you should sanitize the user input to prevent malicious input that could navigate outside of the intended directory. Here's a modified version of your code with added security measures:

```java
import java.io.File;
import java.io.IOException;
import java.util.Scanner;

public class SecurePathTraversal {

    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        System.out.print(""Enter a file name: "");
        String fileName = scanner.nextLine();

        // Sanitize the input to remove any path traversal characters
        fileName = fileName.replaceAll(""[^a-zA-Z0-9\\.\\-]"", """");

        // Define the base directory where files are allowed to be accessed
        String baseDirectory = ""/path/to/directory/"";

        File file = new File(baseDirectory + fileName);

        try {
            if (file.getCanonicalPath().startsWith(baseDirectory) && file.exists()) {
                System.out.println(""File content:"");
                Scanner fileScanner = new Scanner(file);
                while (fileScanner.hasNextLine()) {
                    System.out.println(fileScanner.nextLine());
                }
                fileScanner.close();
            } else {
                System.out.println(""File not found or access denied."");
            }","To secure the code against Path Traversal attacks, you should sanitize the user input to prevent malicious input that could navigate outside of the intended directory. Here's a modified version of your code with added security measures: ```java import java.io.File; import java.io.IOException; import java.util.Scanner; public class SecurePathTraversal { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter a file name: ""); String fileName = scanner.nextLine(); // Sanitize the input to remove any path traversal characters fileName = fileName.replaceAll(""[^a-zA-Z0-9\\.\\-]"", """"); // Define the base directory where files are allowed to be accessed String baseDirectory = ""/path/to/directory/""; File file = new File(baseDirectory + fileName); try { if (file.getCanonicalPath().startsWith(baseDirectory) && file.exists()) { System.out.println(""File content:""); Scanner fileScanner = new Scanner(file); while (fileScanner.hasNextLine()) { System.out.println(fileScanner.nextLine()); } fileScanner.close(); } else { System.out.println(""File not found or access denied.""); }",java,0
Clear,"#include <stdio.h>
#include <stdlib.h>

void safe_file_operation(const char *filename) {
    FILE *file = fopen(filename, ""r"");
    if (file != NULL) {
        char buffer[256];
        while (fgets(buffer, sizeof(buffer), file)) {
            printf(""%s"", buffer);
        }
        fclose(file);
    }
}","#include <stdio.h>
#include <stdlib.h>

void safe_file_operation(const char *filename) {
    FILE *file = fopen(filename, ""r"");
    if (file != NULL) {
        char buffer[256];
        while (fgets(buffer, sizeof(buffer), file)) {
            printf(""%s"", buffer);
        }
        fclose(file);
    }
}",c,0
File Inclusion,"<?php
$file = $_GET['file'];
include($file); // File Inclusion
?>","<?php
$file = $_GET['file'];
include($file); // File Inclusion
?>",php,1
Clear,"const userInput = new URLSearchParams(window.location.search).get('input');
const safeOutput = document.createElement('div');
safeOutput.textContent = userInput; // Safe DOM manipulation
document.body.appendChild(safeOutput);
","const userInput = new URLSearchParams(window.location.search).get('input');
const safeOutput = document.createElement('div');
safeOutput.textContent = userInput; // Safe DOM manipulation
document.body.appendChild(safeOutput);
",javascript,0
SQL Injection,"import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.ResultSet;
import java.sql.Statement;
import java.util.Scanner;

public class SQLInjectionVulnerable {

    public static void main(String[] args) {
        try {
            // Get user input
            Scanner scanner = new Scanner(System.in);
            System.out.print(""Enter username: "");
            String username = scanner.nextLine();

            // Vulnerable code where user input is concatenated directly into the SQL query
            String sql = ""SELECT * FROM users WHERE username = '"" + username + ""'"";
            
            // Connect to database
            Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydb"", ""username"", ""password"");
            
            // Execute SQL query
            Statement stmt = conn.createStatement();
            ResultSet rs = stmt.executeQuery(sql);
            
            while (rs.next()) {
                System.out.println(""User found: "" + rs.getString(""username""));
            }

        } catch (Exception e) {
            e.printStackTrace();
        }
    }
}","import java.sql.Connection; import java.sql.DriverManager; import java.sql.ResultSet; import java.sql.Statement; import java.util.Scanner; public class SQLInjectionVulnerable { public static void main(String[] args) { try { // Get user input Scanner scanner = new Scanner(System.in); System.out.print(""Enter username: ""); String username = scanner.nextLine(); // Vulnerable code where user input is concatenated directly into the SQL query String sql = ""SELECT * FROM users WHERE username = '"" + username + ""'""; // Connect to database Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydb"", ""username"", ""password""); // Execute SQL query Statement stmt = conn.createStatement(); ResultSet rs = stmt.executeQuery(sql); while (rs.next()) { System.out.println(""User found: "" + rs.getString(""username"")); } } catch (Exception e) { e.printStackTrace(); } } }",java,1
XSS,"const userInput = document.location.search.split('=')[1];
document.write(userInput); // XSS
","const userInput = document.location.search.split('=')[1];
document.write(userInput); // XSS
",javascript,1
Out-of-Bounds,"#include <iostream>

class UnsafeClass {
    int data[10];
public:
    int get_data(int index) {
        return data[index]; // no bounds checking
    }
};","#include <iostream>

class UnsafeClass {
    int data[10];
public:
    int get_data(int index) {
        return data[index]; // no bounds checking
    }
};",cpp,1
Clear,"#include <stdio.h>
#include <string.h>

int safe_buffer_operation(char *input) {
    char buffer[100];
    if (strlen(input) < sizeof(buffer)) {
        strcpy(buffer, input);
        return 0;
    }
    return -1; // buffer too small
}","#include <stdio.h>
#include <string.h>

int safe_buffer_operation(char *input) {
    char buffer[100];
    if (strlen(input) < sizeof(buffer)) {
        strcpy(buffer, input);
        return 0;
    }
    return -1; // buffer too small
}",c,0
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Command Injection,"import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class CommandInjectionExample {
    public static void main(String[] args) {
        try {
            BufferedReader br = new BufferedReader(new InputStreamReader(System.in));
            System.out.print(""Enter a command to execute: "");
            String command = br.readLine();

            Runtime runtime = Runtime.getRuntime();
            Process process = runtime.exec(command);

            BufferedReader outputReader = new BufferedReader(new InputStreamReader(process.getInputStream()));
            String line;
            while ((line = outputReader.readLine()) != null) {
                System.out.println(line);
            }

        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}","import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class CommandInjectionExample { public static void main(String[] args) { try { BufferedReader br = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a command to execute: ""); String command = br.readLine(); Runtime runtime = Runtime.getRuntime(); Process process = runtime.exec(command); BufferedReader outputReader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = outputReader.readLine()) != null) { System.out.println(line); } } catch (IOException e) { e.printStackTrace(); } } }",java,1
Clear,"const userData = JSON.parse(userInput); // Safe JSON parsing
if (userData && typeof userData === 'object') {
    processUserData(userData);
}
","const userData = JSON.parse(userInput); // Safe JSON parsing
if (userData && typeof userData === 'object') {
    processUserData(userData);
}
",javascript,0
Clear,"#include <stdio.h>
#include <string.h>

int validate_input(const char *input) {
    if (input == NULL) return 0;
    for (int i = 0; input[i] != '\0'; i++) {
        if (input[i] < 32 || input[i] > 126) {
            return 0; // invalid character
        }
    }
    return 1;
}","#include <stdio.h>
#include <string.h>

int validate_input(const char *input) {
    if (input == NULL) return 0;
    for (int i = 0; input[i] != '\0'; i++) {
        if (input[i] < 32 || input[i] > 126) {
            return 0; // invalid character
        }
    }
    return 1;
}",c,0
Path Traversal,"import os
def read_file(filename):
    with open('/var/www/uploads/' + filename, 'r') as f:
        return f.read()","import os
def read_file(filename):
    with open('/var/www/uploads/' + filename, 'r') as f:
        return f.read()",python,1
Clear,"#include <stdio.h>
#include <string.h>

void safe_string_copy(char *dest, const char *src, size_t dest_size) {
    if (dest_size > 0) {
        strncpy(dest, src, dest_size - 1);
        dest[dest_size - 1] = '\0';
    }
}","#include <stdio.h>
#include <string.h>

void safe_string_copy(char *dest, const char *src, size_t dest_size) {
    if (dest_size > 0) {
        strncpy(dest, src, dest_size - 1);
        dest[dest_size - 1] = '\0';
    }
}",c,0
Hardcoded Secrets,"localStorage.setItem('token', 'hardcoded-secret-token-123'); // Hardcoded secret
","localStorage.setItem('token', 'hardcoded-secret-token-123'); // Hardcoded secret
",javascript,1
Path Traversal,"import os
def read_file(filename):
    with open('/var/www/uploads/' + filename, 'r') as f:
        return f.read()","import os
def read_file(filename):
    with open('/var/www/uploads/' + filename, 'r') as f:
        return f.read()",python,1
Buffer Overflow,"#include <iostream>
#include <cstring>

void unsafe_c_string(char* input) {
    char buffer[100];
    strcpy(buffer, input); // potential buffer overflow
    std::cout << buffer << std::endl;
}","#include <iostream>
#include <cstring>

void unsafe_c_string(char* input) {
    char buffer[100];
    strcpy(buffer, input); // potential buffer overflow
    std::cout << buffer << std::endl;
}",cpp,1
Cross-Site Scripting (XSS),"import java.io.*;
import javax.servlet.*;
import javax.servlet.http.*;

public class XSSDemo extends HttpServlet {
    public void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        String userInput = request.getParameter(""input"");
        PrintWriter out = response.getWriter();
        
        // Improper handling of user input without any sanitization
        out.println(""<p>User Input: "" + userInput + ""</p>"");
    }
}","import java.io.*; import javax.servlet.*; import javax.servlet.http.*; public class XSSDemo extends HttpServlet { public void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { String userInput = request.getParameter(""input""); PrintWriter out = response.getWriter(); // Improper handling of user input without any sanitization out.println(""<p>User Input: "" + userInput + ""</p>""); } }",java,1
Clear,"<?php
$file = basename($_GET['file']);
$allowed = ['page1.php', 'page2.php'];
if (in_array($file, $allowed)) {
    include($file);
}
?>","<?php
$file = basename($_GET['file']);
$allowed = ['page1.php', 'page2.php'];
if (in_array($file, $allowed)) {
    include($file);
}
?>",php,0
Clear,"To fix the Path Traversal vulnerability in the provided Java code snippet, you need to ensure that the user input is properly validated and sanitized before constructing the file path. Here is an example of a more secure version of the code that prevents Path Traversal attacks:

```java
import java.io.File;
import java.io.FileInputStream;
import java.io.IOException;
import java.util.Scanner;

public class PathTraversalSecure {
    private static final String BASE_PATH = ""C:/data/"";

    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        System.out.print(""Enter file name: "");
        String fileName = scanner.next();

        if (!isValidFileName(fileName)) {
            System.out.println(""Invalid file name."");
            return;
        }

        String filePath = BASE_PATH + fileName;

        try {
            File file = new File(filePath);
            if (!file.exists() || !file.isFile()) {
                System.out.println(""File not found or could not be accessed."");
                return;
            }

            FileInputStream fis = new FileInputStream(file);

            int content;
            while ((content = fis.read()) != -1) {
                System.out.print((char) content);
            }

            fis.close();
        } catch (IOException e)","To fix the Path Traversal vulnerability in the provided Java code snippet, you need to ensure that the user input is properly validated and sanitized before constructing the file path. Here is an example of a more secure version of the code that prevents Path Traversal attacks: ```java import java.io.File; import java.io.FileInputStream; import java.io.IOException; import java.util.Scanner; public class PathTraversalSecure { private static final String BASE_PATH = ""C:/data/""; public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter file name: ""); String fileName = scanner.next(); if (!isValidFileName(fileName)) { System.out.println(""Invalid file name.""); return; } String filePath = BASE_PATH + fileName; try { File file = new File(filePath); if (!file.exists() || !file.isFile()) { System.out.println(""File not found or could not be accessed.""); return; } FileInputStream fis = new FileInputStream(file); int content; while ((content = fis.read()) != -1) { System.out.print((char) content); } fis.close(); } catch (IOException e)",java,0
Hardcoded Secrets,"localStorage.setItem('token', 'hardcoded-secret-token-123'); // Hardcoded secret
","localStorage.setItem('token', 'hardcoded-secret-token-123'); // Hardcoded secret
",javascript,1
Cross-Site Scripting (XSS),"import java.io.*;

public class XSSExample {
    public static void main(String[] args) {
        BufferedReader br = new BufferedReader(new InputStreamReader(System.in));
        
        System.out.println(""Enter your name:"");
        String name = br.readLine();
        
        System.out.println(""Hello, "" + name + ""!""); // Vulnerable code
        
    }
}","import java.io.*; public class XSSExample { public static void main(String[] args) { BufferedReader br = new BufferedReader(new InputStreamReader(System.in)); System.out.println(""Enter your name:""); String name = br.readLine(); System.out.println(""Hello, "" + name + ""!""); // Vulnerable code } }",java,1
Clear,"To fix the Path Traversal vulnerability in the given Java code snippet, you should ensure that the input file path provided by the user is properly validated and restricted to a specific directory or file location. Here is an improved version of the code with proper security measures:

```java
import java.io.File;
import java.io.FileInputStream;
import java.io.IOException;
import java.util.Scanner;

public class SecurePathTraversal {
    private static final String BASE_PATH = ""/path/to/secure/directory/"";

    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);

        System.out.print(""Enter file name to read: "");
        String fileName = scanner.nextLine();

        if (isValidFileName(fileName)) {
            try {
                File file = new File(BASE_PATH + fileName);
                FileInputStream fis = new FileInputStream(file);
                int content;

                while ((content = fis.read()) != -1) {
                    System.out.print((char) content);
                }

                fis.close();
            } catch (IOException e) {
                System.out.println(""Error reading file: "" + e.getMessage());
            }
        } else {
            System.out.println(""Invalid file name provided."");
        }
    }

    private static boolean isValidFileName(String fileName) {","To fix the Path Traversal vulnerability in the given Java code snippet, you should ensure that the input file path provided by the user is properly validated and restricted to a specific directory or file location. Here is an improved version of the code with proper security measures: ```java import java.io.File; import java.io.FileInputStream; import java.io.IOException; import java.util.Scanner; public class SecurePathTraversal { private static final String BASE_PATH = ""/path/to/secure/directory/""; public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter file name to read: ""); String fileName = scanner.nextLine(); if (isValidFileName(fileName)) { try { File file = new File(BASE_PATH + fileName); FileInputStream fis = new FileInputStream(file); int content; while ((content = fis.read()) != -1) { System.out.print((char) content); } fis.close(); } catch (IOException e) { System.out.println(""Error reading file: "" + e.getMessage()); } } else { System.out.println(""Invalid file name provided.""); } } private static boolean isValidFileName(String fileName) {",java,0
Clear,"To fix this code and prevent Command Injection vulnerabilities, you should validate and sanitize user input before using it in a command execution. Here's an improved version of the code that utilizes ProcessBuilder to securely execute the ping command:

```java
import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class CommandInjectionExample {

    public static void main(String[] args) {
        try {
            BufferedReader br = new BufferedReader(new InputStreamReader(System.in));
            System.out.print(""Enter a website to ping: "");
            String userInput = br.readLine();

            // Validate user input to ensure it is a valid hostname or IP address
            if (isValidInput(userInput)) {
                ProcessBuilder processBuilder = new ProcessBuilder(""ping"", userInput);
                Process p = processBuilder.start();

                BufferedReader inputStream = new BufferedReader(new InputStreamReader(p.getInputStream()));
                String output;
                while ((output = inputStream.readLine()) != null) {
                    System.out.println(output);
                }
            } else {
                System.out.println(""Invalid input. Please provide a valid hostname or IP address."");
            }

        } catch (IOException e) {
            e.printStackTrace();
        }
    }

    private static boolean isValidInput(String userInput) {
        // Implement your validation logic here,","To fix this code and prevent Command Injection vulnerabilities, you should validate and sanitize user input before using it in a command execution. Here's an improved version of the code that utilizes ProcessBuilder to securely execute the ping command: ```java import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class CommandInjectionExample { public static void main(String[] args) { try { BufferedReader br = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a website to ping: ""); String userInput = br.readLine(); // Validate user input to ensure it is a valid hostname or IP address if (isValidInput(userInput)) { ProcessBuilder processBuilder = new ProcessBuilder(""ping"", userInput); Process p = processBuilder.start(); BufferedReader inputStream = new BufferedReader(new InputStreamReader(p.getInputStream())); String output; while ((output = inputStream.readLine()) != null) { System.out.println(output); } } else { System.out.println(""Invalid input. Please provide a valid hostname or IP address.""); } } catch (IOException e) { e.printStackTrace(); } } private static boolean isValidInput(String userInput) { // Implement your validation logic here,",java,0
Memory Corruption,"#include <iostream>

void unsafe_pointer_arithmetic(int* array, int size) {
    for (int i = 0; i <= size; i++) {
        std::cout << *(array + i) << std::endl; // potential out-of-bounds
    }
}","#include <iostream>

void unsafe_pointer_arithmetic(int* array, int size) {
    for (int i = 0; i <= size; i++) {
        std::cout << *(array + i) << std::endl; // potential out-of-bounds
    }
}",cpp,1
Clear,"To fix the Path Traversal vulnerability in the given Java code snippet, you need to ensure that the file path provided by the user is sanitized and validated to prevent directory traversal attacks. Here's an improved version of the code that addresses this security issue:

```java
import java.io.File;
import java.io.FileInputStream;
import java.io.IOException;
import java.util.Scanner;

public class SecurePathTraversalExample {

    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        System.out.print(""Enter file name: "");
        String fileName = scanner.next();

        // Validate and sanitize the user input file name
        if (!isValidFileName(fileName)) {
            System.out.println(""Invalid file name"");
            return;
        }

        try {
            File file = new File(""/path/to/directory/"", fileName);
            
            // Check if the requested file is within the allowed directory
            if (!file.getCanonicalPath().startsWith(""/path/to/directory/"")) {
                System.out.println(""Access to this file is not allowed"");
                return;
            }
            
            FileInputStream fis = new FileInputStream(file);

            int data;
            while ((data = fis.read()) != -1) {
                System.out.print((char) data);","To fix the Path Traversal vulnerability in the given Java code snippet, you need to ensure that the file path provided by the user is sanitized and validated to prevent directory traversal attacks. Here's an improved version of the code that addresses this security issue: ```java import java.io.File; import java.io.FileInputStream; import java.io.IOException; import java.util.Scanner; public class SecurePathTraversalExample { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter file name: ""); String fileName = scanner.next(); // Validate and sanitize the user input file name if (!isValidFileName(fileName)) { System.out.println(""Invalid file name""); return; } try { File file = new File(""/path/to/directory/"", fileName); // Check if the requested file is within the allowed directory if (!file.getCanonicalPath().startsWith(""/path/to/directory/"")) { System.out.println(""Access to this file is not allowed""); return; } FileInputStream fis = new FileInputStream(file); int data; while ((data = fis.read()) != -1) { System.out.print((char) data);",java,0
Clear,"<?php
$message = htmlspecialchars($_GET['message'], ENT_QUOTES, 'UTF-8');
echo $message; // Sanitized output
?>","<?php
$message = htmlspecialchars($_GET['message'], ENT_QUOTES, 'UTF-8');
echo $message; // Sanitized output
?>",php,0
Clear,"#include <stdio.h>
#include <string.h>

int safe_buffer_operation(char *input) {
    char buffer[100];
    if (strlen(input) < sizeof(buffer)) {
        strcpy(buffer, input);
        return 0;
    }
    return -1; // buffer too small
}","#include <stdio.h>
#include <string.h>

int safe_buffer_operation(char *input) {
    char buffer[100];
    if (strlen(input) < sizeof(buffer)) {
        strcpy(buffer, input);
        return 0;
    }
    return -1; // buffer too small
}",c,0
Clear,"import sqlite3
def get_user_data_safe(username):
    conn = sqlite3.connect('database.db')
    cursor = conn.cursor()
    query = ""SELECT * FROM users WHERE username = ?""
    cursor.execute(query, (username,))
    return cursor.fetchall()","import sqlite3
def get_user_data_safe(username):
    conn = sqlite3.connect('database.db')
    cursor = conn.cursor()
    query = ""SELECT * FROM users WHERE username = ?""
    cursor.execute(query, (username,))
    return cursor.fetchall()",python,0
XSS,"const userInput = document.location.search.split('=')[1];
document.write(userInput); // XSS
","const userInput = document.location.search.split('=')[1];
document.write(userInput); // XSS
",javascript,1
Clear,"const userData = JSON.parse(userInput); // Safe JSON parsing
if (userData && typeof userData === 'object') {
    processUserData(userData);
}
","const userData = JSON.parse(userInput); // Safe JSON parsing
if (userData && typeof userData === 'object') {
    processUserData(userData);
}
",javascript,0
Clear,"#include <stdio.h>
#include <stdlib.h>

int safe_string_to_int(const char *str) {
    char *endptr;
    long value = strtol(str, &endptr, 10);
    if (*endptr != '\0' || str == endptr) {
        return -1; // error
    }
    return (int)value;
}","#include <stdio.h>
#include <stdlib.h>

int safe_string_to_int(const char *str) {
    char *endptr;
    long value = strtol(str, &endptr, 10);
    if (*endptr != '\0' || str == endptr) {
        return -1; // error
    }
    return (int)value;
}",c,0
Clear,"import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class CommandInjectionSecure {

    public static void main(String[] args) throws IOException {
        BufferedReader br = new BufferedReader(new InputStreamReader(System.in));

        System.out.print(""Enter the IP address to ping: "");
        String ipAddress = br.readLine();

        // Secure code using ProcessBuilder
        ProcessBuilder processBuilder = new ProcessBuilder(""ping"", ipAddress);
        
        Process process = processBuilder.start();

        BufferedReader reader = new BufferedReader(new InputStreamReader(process.getInputStream()));
        String line;
        while ((line = reader.readLine()) != null) {
            System.out.println(line);
        }
    }
}","import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class CommandInjectionSecure { public static void main(String[] args) throws IOException { BufferedReader br = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter the IP address to ping: ""); String ipAddress = br.readLine(); // Secure code using ProcessBuilder ProcessBuilder processBuilder = new ProcessBuilder(""ping"", ipAddress); Process process = processBuilder.start(); BufferedReader reader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = reader.readLine()) != null) { System.out.println(line); } } }",java,0
SQL Injection,"<?php
$username = $_POST['username'];
$query = ""SELECT * FROM users WHERE username = '$username'"";
$result = mysql_query($query); // SQL Injection
?>","<?php
$username = $_POST['username'];
$query = ""SELECT * FROM users WHERE username = '$username'"";
$result = mysql_query($query); // SQL Injection
?>",php,1
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Clear,"#include <iostream>
#include <fstream>
#include <string>

void safe_file_reading(const std::string& filename) {
    std::ifstream file(filename);
    if (file.is_open()) {
        std::string line;
        while (std::getline(file, line)) {
            std::cout << line << std::endl;
        }
    }
}","#include <iostream>
#include <fstream>
#include <string>

void safe_file_reading(const std::string& filename) {
    std::ifstream file(filename);
    if (file.is_open()) {
        std::string line;
        while (std::getline(file, line)) {
            std::cout << line << std::endl;
        }
    }
}",cpp,0
Clear,"#include <stdio.h>
#include <stdlib.h>

int safe_string_to_int(const char *str) {
    char *endptr;
    long value = strtol(str, &endptr, 10);
    if (*endptr != '\0' || str == endptr) {
        return -1; // error
    }
    return (int)value;
}","#include <stdio.h>
#include <stdlib.h>

int safe_string_to_int(const char *str) {
    char *endptr;
    long value = strtol(str, &endptr, 10);
    if (*endptr != '\0' || str == endptr) {
        return -1; // error
    }
    return (int)value;
}",c,0
Clear,"#include <stdio.h>
#include <string.h>

int validate_input(const char *input) {
    if (input == NULL) return 0;
    for (int i = 0; input[i] != '\0'; i++) {
        if (input[i] < 32 || input[i] > 126) {
            return 0; // invalid character
        }
    }
    return 1;
}","#include <stdio.h>
#include <string.h>

int validate_input(const char *input) {
    if (input == NULL) return 0;
    for (int i = 0; input[i] != '\0'; i++) {
        if (input[i] < 32 || input[i] > 126) {
            return 0; // invalid character
        }
    }
    return 1;
}",c,0
Clear,"#include <stdio.h>
#include <stdlib.h>

void safe_file_operation(const char *filename) {
    FILE *file = fopen(filename, ""r"");
    if (file != NULL) {
        char buffer[256];
        while (fgets(buffer, sizeof(buffer), file)) {
            printf(""%s"", buffer);
        }
        fclose(file);
    }
}","#include <stdio.h>
#include <stdlib.h>

void safe_file_operation(const char *filename) {
    FILE *file = fopen(filename, ""r"");
    if (file != NULL) {
        char buffer[256];
        while (fgets(buffer, sizeof(buffer), file)) {
            printf(""%s"", buffer);
        }
        fclose(file);
    }
}",c,0
Command Injection,"import os
def ping_host(host):
    os.system(""ping -c 4 "" + host)","import os
def ping_host(host):
    os.system(""ping -c 4 "" + host)",python,1
Clear,"const shell = require('child_process');
const safeInput = userInput.replace(/[^a-zA-Z0-9.]/g, '');
shell.execFile('ping', [safeInput]); // Safe command execution
","const shell = require('child_process');
const safeInput = userInput.replace(/[^a-zA-Z0-9.]/g, '');
shell.execFile('ping', [safeInput]); // Safe command execution
",javascript,0
Clear,"const userInput = new URLSearchParams(window.location.search).get('input');
const safeOutput = document.createElement('div');
safeOutput.textContent = userInput; // Safe DOM manipulation
document.body.appendChild(safeOutput);
","const userInput = new URLSearchParams(window.location.search).get('input');
const safeOutput = document.createElement('div');
safeOutput.textContent = userInput; // Safe DOM manipulation
document.body.appendChild(safeOutput);
",javascript,0
Clear,"#include <iostream>
#include <fstream>
#include <string>

void safe_file_reading(const std::string& filename) {
    std::ifstream file(filename);
    if (file.is_open()) {
        std::string line;
        while (std::getline(file, line)) {
            std::cout << line << std::endl;
        }
    }
}","#include <iostream>
#include <fstream>
#include <string>

void safe_file_reading(const std::string& filename) {
    std::ifstream file(filename);
    if (file.is_open()) {
        std::string line;
        while (std::getline(file, line)) {
            std::cout << line << std::endl;
        }
    }
}",cpp,0
Code Injection,"const userData = eval('(' + userInput + ')'); // eval injection
","const userData = eval('(' + userInput + ')'); // eval injection
",javascript,1
Clear,"To fix the Path Traversal vulnerability in the provided Java code, you can follow these secure coding practices:

1. **Use Path Resolution Methods:** Instead of directly concatenating user input with a fixed path, use proper path resolution methods to ensure that the file is being read from the intended location.

2. **Validate User Input:** Validate the user input to ensure it only contains allowed characters and does not include any directory traversal characters like "".."".

3. **Sanitize File Paths:** Use methods like `Paths.get()` to sanitize and resolve file paths safely.

Here is an improved version of the code that addresses these issues:

```java
import java.io.File;
import java.io.FileInputStream;
import java.io.IOException;
import java.nio.file.Paths;
import java.util.Scanner;

public class SecurePathTraversal {

    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        System.out.print(""Enter file name: "");
        String fileName = scanner.nextLine();

        try {
            // Sanitize and resolve file path using Paths.get()
            File file = Paths.get(""C:\\data"", fileName).toFile();

            if (file.getAbsolutePath().startsWith(""C:\\data\\"")) {
                FileInputStream fis = new FileInputStream(file);
                int","To fix the Path Traversal vulnerability in the provided Java code, you can follow these secure coding practices: 1. **Use Path Resolution Methods:** Instead of directly concatenating user input with a fixed path, use proper path resolution methods to ensure that the file is being read from the intended location. 2. **Validate User Input:** Validate the user input to ensure it only contains allowed characters and does not include any directory traversal characters like "".."". 3. **Sanitize File Paths:** Use methods like `Paths.get()` to sanitize and resolve file paths safely. Here is an improved version of the code that addresses these issues: ```java import java.io.File; import java.io.FileInputStream; import java.io.IOException; import java.nio.file.Paths; import java.util.Scanner; public class SecurePathTraversal { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter file name: ""); String fileName = scanner.nextLine(); try { // Sanitize and resolve file path using Paths.get() File file = Paths.get(""C:\\data"", fileName).toFile(); if (file.getAbsolutePath().startsWith(""C:\\data\\"")) { FileInputStream fis = new FileInputStream(file); int",java,0
Clear,"#include <iostream>
#include <fstream>
#include <string>

void safe_file_reading(const std::string& filename) {
    std::ifstream file(filename);
    if (file.is_open()) {
        std::string line;
        while (std::getline(file, line)) {
            std::cout << line << std::endl;
        }
    }
}","#include <iostream>
#include <fstream>
#include <string>

void safe_file_reading(const std::string& filename) {
    std::ifstream file(filename);
    if (file.is_open()) {
        std::string line;
        while (std::getline(file, line)) {
            std::cout << line << std::endl;
        }
    }
}",cpp,0
Clear,"import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class SafeCommandExecution {
    public static void main(String[] args) throws IOException {
        BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));

        System.out.print(""Enter a command to execute: "");
        String command = reader.readLine();

        // Separate the command and arguments using ProcessBuilder
        ProcessBuilder processBuilder = new ProcessBuilder(command.split("" ""));
        
        Process process = processBuilder.start();

        BufferedReader processOutputReader = new BufferedReader(new InputStreamReader(process.getInputStream()));
        String line;

        while ((line = processOutputReader.readLine()) != null) {
            System.out.println(line);
        }
    }
}","import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class SafeCommandExecution { public static void main(String[] args) throws IOException { BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a command to execute: ""); String command = reader.readLine(); // Separate the command and arguments using ProcessBuilder ProcessBuilder processBuilder = new ProcessBuilder(command.split("" "")); Process process = processBuilder.start(); BufferedReader processOutputReader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = processOutputReader.readLine()) != null) { System.out.println(line); } } }",java,0
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Clear,"#include <stdio.h>
#include <stdlib.h>

int safe_string_to_int(const char *str) {
    char *endptr;
    long value = strtol(str, &endptr, 10);
    if (*endptr != '\0' || str == endptr) {
        return -1; // error
    }
    return (int)value;
}","#include <stdio.h>
#include <stdlib.h>

int safe_string_to_int(const char *str) {
    char *endptr;
    long value = strtol(str, &endptr, 10);
    if (*endptr != '\0' || str == endptr) {
        return -1; // error
    }
    return (int)value;
}",c,0
SQL Injection,"import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.ResultSet;
import java.sql.Statement;

public class SQLInjectionExample {

    public static void main(String[] args) {
        String userInput = ""'; DROP TABLE users; --""; // Malicious input simulating SQL Injection
        
        try {
            Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");
            Statement stmt = conn.createStatement();
            
            String query = ""SELECT * FROM users WHERE username = '"" + userInput + ""'"";
            ResultSet rs = stmt.executeQuery(query);
            
            while (rs.next()) {
                System.out.println(""User ID: "" + rs.getInt(""id"") + "", Username: "" + rs.getString(""username""));
            }
            
            conn.close();
        } catch (Exception e) {
            e.printStackTrace();
        }
    }
}","import java.sql.Connection; import java.sql.DriverManager; import java.sql.ResultSet; import java.sql.Statement; public class SQLInjectionExample { public static void main(String[] args) { String userInput = ""'; DROP TABLE users; --""; // Malicious input simulating SQL Injection try { Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); Statement stmt = conn.createStatement(); String query = ""SELECT * FROM users WHERE username = '"" + userInput + ""'""; ResultSet rs = stmt.executeQuery(query); while (rs.next()) { System.out.println(""User ID: "" + rs.getInt(""id"") + "", Username: "" + rs.getString(""username"")); } conn.close(); } catch (Exception e) { e.printStackTrace(); } } }",java,1
Clear,"#include <iostream>
#include <vector>
#include <stdexcept>

int safe_vector_access(const std::vector<int>& vec, size_t index) {
    if (index >= vec.size()) {
        throw std::out_of_range(""Index out of range"");
    }
    return vec[index];
}","#include <iostream>
#include <vector>
#include <stdexcept>

int safe_vector_access(const std::vector<int>& vec, size_t index) {
    if (index >= vec.size()) {
        throw std::out_of_range(""Index out of range"");
    }
    return vec[index];
}",cpp,0
Clear,"<?php
$file = basename($_GET['file']);
$allowed = ['page1.php', 'page2.php'];
if (in_array($file, $allowed)) {
    include($file);
}
?>","<?php
$file = basename($_GET['file']);
$allowed = ['page1.php', 'page2.php'];
if (in_array($file, $allowed)) {
    include($file);
}
?>",php,0
Clear,"import java.io.*;
import javax.servlet.*;
import javax.servlet.http.*;
import org.owasp.encoder.Encode;

public class SecureXSSDemo extends HttpServlet {
    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        String userInput = request.getParameter(""input"");
        
        PrintWriter out = response.getWriter();
        out.println(""<html>"");
        out.println(""<body>"");
        out.println(""<h1>User Input: "" + Encode.forHtml(userInput) + ""</h1>""); // Properly encode user input
        out.println(""</body>"");
        out.println(""</html>"");
    }
}","import java.io.*; import javax.servlet.*; import javax.servlet.http.*; import org.owasp.encoder.Encode; public class SecureXSSDemo extends HttpServlet { protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { String userInput = request.getParameter(""input""); PrintWriter out = response.getWriter(); out.println(""<html>""); out.println(""<body>""); out.println(""<h1>User Input: "" + Encode.forHtml(userInput) + ""</h1>""); // Properly encode user input out.println(""</body>""); out.println(""</html>""); } }",java,0
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
SQL Injection,"app.get('/user/:id', (req, res) => {
    const query = `SELECT * FROM users WHERE id = ${req.params.id}`; // SQL Injection
    db.query(query, (err, result) => {
        res.json(result);
    });
});
","app.get('/user/:id', (req, res) => {
    const query = `SELECT * FROM users WHERE id = ${req.params.id}`; // SQL Injection
    db.query(query, (err, result) => {
        res.json(result);
    });
});
",javascript,1
Clear,"#include <stdio.h>
#include <string.h>

int safe_buffer_operation(char *input) {
    char buffer[100];
    if (strlen(input) < sizeof(buffer)) {
        strcpy(buffer, input);
        return 0;
    }
    return -1; // buffer too small
}","#include <stdio.h>
#include <string.h>

int safe_buffer_operation(char *input) {
    char buffer[100];
    if (strlen(input) < sizeof(buffer)) {
        strcpy(buffer, input);
        return 0;
    }
    return -1; // buffer too small
}",c,0
Hardcoded Secrets,"DATABASE_PASSWORD = ""my_super_secret_password_123""
def db_connect():
    import psycopg2
    return psycopg2.connect(f""dbname=test user=admin password={DATABASE_PASSWORD}"")","DATABASE_PASSWORD = ""my_super_secret_password_123""
def db_connect():
    import psycopg2
    return psycopg2.connect(f""dbname=test user=admin password={DATABASE_PASSWORD}"")",python,1
Clear,"import java.util.Scanner;

public class SecureBufferExample {
    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        System.out.print(""Enter a string: "");
        String userInput = scanner.nextLine();

        int bufferSize = 10;
        char[] buffer = new char[bufferSize];

        // Copy user input into the buffer with boundary checking
        for (int i = 0; i < Math.min(userInput.length(), bufferSize); i++) {
            buffer[i] = userInput.charAt(i);
        }

        System.out.println(""Buffer contents: "" + new String(buffer));
    }
}","import java.util.Scanner; public class SecureBufferExample { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter a string: ""); String userInput = scanner.nextLine(); int bufferSize = 10; char[] buffer = new char[bufferSize]; // Copy user input into the buffer with boundary checking for (int i = 0; i < Math.min(userInput.length(), bufferSize); i++) { buffer[i] = userInput.charAt(i); } System.out.println(""Buffer contents: "" + new String(buffer)); } }",java,0
Clear,"#include <stdio.h>
#include <string.h>

void safe_string_copy(char *dest, const char *src, size_t dest_size) {
    if (dest_size > 0) {
        strncpy(dest, src, dest_size - 1);
        dest[dest_size - 1] = '\0';
    }
}","#include <stdio.h>
#include <string.h>

void safe_string_copy(char *dest, const char *src, size_t dest_size) {
    if (dest_size > 0) {
        strncpy(dest, src, dest_size - 1);
        dest[dest_size - 1] = '\0';
    }
}",c,0
Clear,"import subprocess
def safe_database_backup(db_name):
    result = subprocess.run(['pg_dump', db_name], capture_output=True, text=True)
    with open('backup.sql', 'w') as f:
        f.write(result.stdout)","import subprocess
def safe_database_backup(db_name):
    result = subprocess.run(['pg_dump', db_name], capture_output=True, text=True)
    with open('backup.sql', 'w') as f:
        f.write(result.stdout)",python,0
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Clear,"#include <iostream>
#include <vector>
#include <stdexcept>

int safe_vector_access(const std::vector<int>& vec, size_t index) {
    if (index >= vec.size()) {
        throw std::out_of_range(""Index out of range"");
    }
    return vec[index];
}","#include <iostream>
#include <vector>
#include <stdexcept>

int safe_vector_access(const std::vector<int>& vec, size_t index) {
    if (index >= vec.size()) {
        throw std::out_of_range(""Index out of range"");
    }
    return vec[index];
}",cpp,0
Cross-Site Scripting (XSS),"import java.io.IOException;
import javax.servlet.ServletException;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

public class VulnerableServlet extends HttpServlet {

    @Override
    protected void doGet(HttpServletRequest request, HttpServletResponse response)
            throws ServletException, IOException {

        String userInput = request.getParameter(""input"");
        String output = ""<p>User input: "" + userInput + ""</p>"";

        response.setContentType(""text/html"");
        response.getWriter().write(output);
    }
}","import java.io.IOException; import javax.servlet.ServletException; import javax.servlet.http.HttpServlet; import javax.servlet.http.HttpServletRequest; import javax.servlet.http.HttpServletResponse; public class VulnerableServlet extends HttpServlet { @Override protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { String userInput = request.getParameter(""input""); String output = ""<p>User input: "" + userInput + ""</p>""; response.setContentType(""text/html""); response.getWriter().write(output); } }",java,1
Command Injection,"<?php
$cmd = $_GET['cmd'];
system($cmd); // Command Injection
?>","<?php
$cmd = $_GET['cmd'];
system($cmd); // Command Injection
?>",php,1
Command Injection,"import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class CommandInjectionVulnerable {

    public static void main(String[] args) {
        try {
            BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));
            System.out.print(""Enter a command to execute: "");
            String command = reader.readLine();

            Process process = Runtime.getRuntime().exec(command);

            BufferedReader inputReader = new BufferedReader(new InputStreamReader(process.getInputStream()));
            String line;
            while ((line = inputReader.readLine()) != null) {
                System.out.println(line);
            }

        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}","import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class CommandInjectionVulnerable { public static void main(String[] args) { try { BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a command to execute: ""); String command = reader.readLine(); Process process = Runtime.getRuntime().exec(command); BufferedReader inputReader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = inputReader.readLine()) != null) { System.out.println(line); } } catch (IOException e) { e.printStackTrace(); } } }",java,1
Clear,"const token = process.env.API_TOKEN; // Environment variable
fetch('/api/data', {
    headers: { 'Authorization': `Bearer ${token}` }
});
","const token = process.env.API_TOKEN; // Environment variable
fetch('/api/data', {
    headers: { 'Authorization': `Bearer ${token}` }
});
",javascript,0
Buffer Overflow,"import java.util.Scanner;

public class BufferOverflowExample {
    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        
        System.out.print(""Enter a string: "");
        String userInput = scanner.nextLine();
        
        char[] buffer = new char[10]; // Buffer of size 10
        
        // Copy user input into buffer without proper bounds checking
        for (int i = 0; i < userInput.length(); i++) {
            buffer[i] = userInput.charAt(i);
        }
        
        System.out.println(""Buffer content: "" + new String(buffer));
    }
}","import java.util.Scanner; public class BufferOverflowExample { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter a string: ""); String userInput = scanner.nextLine(); char[] buffer = new char[10]; // Buffer of size 10 // Copy user input into buffer without proper bounds checking for (int i = 0; i < userInput.length(); i++) { buffer[i] = userInput.charAt(i); } System.out.println(""Buffer content: "" + new String(buffer)); } }",java,1
Memory Corruption,"#include <iostream>

void unsafe_pointer_arithmetic(int* array, int size) {
    for (int i = 0; i <= size; i++) {
        std::cout << *(array + i) << std::endl; // potential out-of-bounds
    }
}","#include <iostream>

void unsafe_pointer_arithmetic(int* array, int size) {
    for (int i = 0; i <= size; i++) {
        std::cout << *(array + i) << std::endl; // potential out-of-bounds
    }
}",cpp,1
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Code Injection,"const userData = eval('(' + userInput + ')'); // eval injection
","const userData = eval('(' + userInput + ')'); // eval injection
",javascript,1
Code Injection,"const userData = eval('(' + userInput + ')'); // eval injection
","const userData = eval('(' + userInput + ')'); // eval injection
",javascript,1
SSRF,"import requests
def fetch_url(url):
    return requests.get(url).text","import requests
def fetch_url(url):
    return requests.get(url).text",python,1
Hardcoded Secrets,"localStorage.setItem('token', 'hardcoded-secret-token-123'); // Hardcoded secret
","localStorage.setItem('token', 'hardcoded-secret-token-123'); // Hardcoded secret
",javascript,1
Clear,"<?php
$message = htmlspecialchars($_GET['message'], ENT_QUOTES, 'UTF-8');
echo $message; // Sanitized output
?>","<?php
$message = htmlspecialchars($_GET['message'], ENT_QUOTES, 'UTF-8');
echo $message; // Sanitized output
?>",php,0
Clear,"import java.io.*;
import org.apache.commons.text.StringEscapeUtils;

public class XSSFixedCode {

    public static void main(String[] args) {
        // Simulating user input
        String userInput = ""<script>alert('XSS Attack!')</script>"";

        // Properly handling user input in an output stream
        try {
            FileWriter fileWriter = new FileWriter(""output.html"");
            BufferedWriter bufferedWriter = new BufferedWriter(fileWriter);
            bufferedWriter.write(""<html><body>"");
            bufferedWriter.write(""User Input: "" + StringEscapeUtils.escapeHtml4(userInput));  // Properly escaped user input
            bufferedWriter.write(""</body></html>"");
            bufferedWriter.close();
            System.out.println(""Output file 'output.html' created successfully."");
        } catch (IOException e) {
            System.err.println(""Error writing to file: "" + e.getMessage());
        }
    }
}","import java.io.*; import org.apache.commons.text.StringEscapeUtils; public class XSSFixedCode { public static void main(String[] args) { // Simulating user input String userInput = ""<script>alert('XSS Attack!')</script>""; // Properly handling user input in an output stream try { FileWriter fileWriter = new FileWriter(""output.html""); BufferedWriter bufferedWriter = new BufferedWriter(fileWriter); bufferedWriter.write(""<html><body>""); bufferedWriter.write(""User Input: "" + StringEscapeUtils.escapeHtml4(userInput)); // Properly escaped user input bufferedWriter.write(""</body></html>""); bufferedWriter.close(); System.out.println(""Output file 'output.html' created successfully.""); } catch (IOException e) { System.err.println(""Error writing to file: "" + e.getMessage()); } } }",java,0
Cross-Site Scripting (XSS),"import java.io.IOException;
import java.io.PrintWriter;

public class XSSVulnerableCode {
    public static void main(String[] args) throws IOException {
        String userInput = ""<script>alert('XSS Attack!')</script>"";
        
        // Improperly handling user input by directly outputting it to a web page
        PrintWriter out = new PrintWriter(""output.html"");
        out.println(""<html>"");
        out.println(""<body>"");
        out.println(""<h1>Welcome, "" + userInput + ""</h1>"");
        out.println(""</body>"");
        out.println(""</html>"");
        
        out.close();
    }
}","import java.io.IOException; import java.io.PrintWriter; public class XSSVulnerableCode { public static void main(String[] args) throws IOException { String userInput = ""<script>alert('XSS Attack!')</script>""; // Improperly handling user input by directly outputting it to a web page PrintWriter out = new PrintWriter(""output.html""); out.println(""<html>""); out.println(""<body>""); out.println(""<h1>Welcome, "" + userInput + ""</h1>""); out.println(""</body>""); out.println(""</html>""); out.close(); } }",java,1
Clear,"#include <iostream>
#include <string>
#include <vector>

void safe_string_handling(const std::string& input) {
    std::string safe_copy = input;
    std::cout << safe_copy << std::endl;
}","#include <iostream>
#include <string>
#include <vector>

void safe_string_handling(const std::string& input) {
    std::string safe_copy = input;
    std::cout << safe_copy << std::endl;
}",cpp,0
Clear,"import java.util.Scanner;

public class SecureBufferExample {
    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        
        System.out.print(""Enter your name: "");
        String name = scanner.nextLine();
        
        if (name.length() > 10) {
            System.out.println(""Input exceeds buffer size."");
            return;
        }
        
        char[] buffer = new char[10];
        name.toCharArray(buffer, 0, 0, Math.min(name.length(), 10));
        
        System.out.println(""Buffer contents: "" + new String(buffer).trim());
    }
}","import java.util.Scanner; public class SecureBufferExample { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter your name: ""); String name = scanner.nextLine(); if (name.length() > 10) { System.out.println(""Input exceeds buffer size.""); return; } char[] buffer = new char[10]; name.toCharArray(buffer, 0, 0, Math.min(name.length(), 10)); System.out.println(""Buffer contents: "" + new String(buffer).trim()); } }",java,0
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Clear,"import java.sql.*;

public class SecureSQLQuery {
    public static void main(String[] args) {
        String userInput = ""'; DROP TABLE users; --""; // Malicious input simulating SQL Injection

        try {
            Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");

            // Use a prepared statement with parameter placeholders
            String query = ""SELECT * FROM users WHERE username = ?"";
            PreparedStatement pstmt = conn.prepareStatement(query);
            pstmt.setString(1, userInput);

            ResultSet rs = pstmt.executeQuery();

            while (rs.next()) {
                System.out.println(""User ID: "" + rs.getInt(""id"") + "", Username: "" + rs.getString(""username""));
            }

            conn.close();
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.*; public class SecureSQLQuery { public static void main(String[] args) { String userInput = ""'; DROP TABLE users; --""; // Malicious input simulating SQL Injection try { Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); // Use a prepared statement with parameter placeholders String query = ""SELECT * FROM users WHERE username = ?""; PreparedStatement pstmt = conn.prepareStatement(query); pstmt.setString(1, userInput); ResultSet rs = pstmt.executeQuery(); while (rs.next()) { System.out.println(""User ID: "" + rs.getInt(""id"") + "", Username: "" + rs.getString(""username"")); } conn.close(); } catch (SQLException e) { e.printStackTrace(); } } }",java,0
Command Injection,"import subprocess
def list_directory(path):
    result = subprocess.run(f""ls {path}"", shell=True, capture_output=True, text=True)
    return result.stdout","import subprocess
def list_directory(path):
    result = subprocess.run(f""ls {path}"", shell=True, capture_output=True, text=True)
    return result.stdout",python,1
Clear,"import logging
def safe_log_user_action(user_id, action):
    logging.info(f""User {user_id} performed action: {action}"")","import logging
def safe_log_user_action(user_id, action):
    logging.info(f""User {user_id} performed action: {action}"")",python,0
Command Injection,"const shell = require('child_process');
shell.exec('ping ' + userInput); // Command Injection
","const shell = require('child_process');
shell.exec('ping ' + userInput); // Command Injection
",javascript,1
Clear,"#include <stdio.h>
#include <string.h>

void safe_string_copy(char *dest, const char *src, size_t dest_size) {
    if (dest_size > 0) {
        strncpy(dest, src, dest_size - 1);
        dest[dest_size - 1] = '\0';
    }
}","#include <stdio.h>
#include <string.h>

void safe_string_copy(char *dest, const char *src, size_t dest_size) {
    if (dest_size > 0) {
        strncpy(dest, src, dest_size - 1);
        dest[dest_size - 1] = '\0';
    }
}",c,0
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Clear,"import requests
def safe_api_call():
    api_key = os.environ.get('API_KEY')
    headers = {'Authorization': f'Bearer {api_key}'}
    return requests.get('https://api.example.com/data', headers=headers)","import requests
def safe_api_call():
    api_key = os.environ.get('API_KEY')
    headers = {'Authorization': f'Bearer {api_key}'}
    return requests.get('https://api.example.com/data', headers=headers)",python,0
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Clear,"#include <stdio.h>
#include <stdlib.h>

void safe_file_operation(const char *filename) {
    FILE *file = fopen(filename, ""r"");
    if (file != NULL) {
        char buffer[256];
        while (fgets(buffer, sizeof(buffer), file)) {
            printf(""%s"", buffer);
        }
        fclose(file);
    }
}","#include <stdio.h>
#include <stdlib.h>

void safe_file_operation(const char *filename) {
    FILE *file = fopen(filename, ""r"");
    if (file != NULL) {
        char buffer[256];
        while (fgets(buffer, sizeof(buffer), file)) {
            printf(""%s"", buffer);
        }
        fclose(file);
    }
}",c,0
Clear,"<?php
$file = basename($_GET['file']);
$allowed = ['page1.php', 'page2.php'];
if (in_array($file, $allowed)) {
    include($file);
}
?>","<?php
$file = basename($_GET['file']);
$allowed = ['page1.php', 'page2.php'];
if (in_array($file, $allowed)) {
    include($file);
}
?>",php,0
Insecure Deserialization,"<?php
$data = $_POST['data'];
unserialize($data); // Insecure Deserialization
?>","<?php
$data = $_POST['data'];
unserialize($data); // Insecure Deserialization
?>",php,1
Clear,"Certainly! Insecure Deserialization is a vulnerability that can lead to serious security issues. To fix the code snippet and implement proper security measures, we can use libraries like `Gson` or `Jackson` for serialization and deserialization. These libraries provide built-in mechanisms for secure serialization/deserialization.

Here's an updated version of the code snippet using `Gson` library for serialization and deserialization:

```java
import com.google.gson.Gson;

public class SecureDeserializationDemo {
    
    public static void main(String[] args) {
        // Serialize the object
        User user = new User(""John"", ""Doe"");
        String json = new Gson().toJson(user);
        
        // Deserialize the object
        User deserializedUser = new Gson().fromJson(json, User.class);
        
        // Print the deserialized object
        System.out.println(""Deserialized user: "" + deserializedUser.getFirstName() + "" "" + deserializedUser.getLastName());
    }
    
    static class User {
        private String firstName;
        private String lastName;
        
        public User(String firstName, String lastName) {
            this.firstName = firstName;
            this.lastName = lastName;
        }
        
        public String getFirstName() {
            return firstName;","Certainly! Insecure Deserialization is a vulnerability that can lead to serious security issues. To fix the code snippet and implement proper security measures, we can use libraries like `Gson` or `Jackson` for serialization and deserialization. These libraries provide built-in mechanisms for secure serialization/deserialization. Here's an updated version of the code snippet using `Gson` library for serialization and deserialization: ```java import com.google.gson.Gson; public class SecureDeserializationDemo { public static void main(String[] args) { // Serialize the object User user = new User(""John"", ""Doe""); String json = new Gson().toJson(user); // Deserialize the object User deserializedUser = new Gson().fromJson(json, User.class); // Print the deserialized object System.out.println(""Deserialized user: "" + deserializedUser.getFirstName() + "" "" + deserializedUser.getLastName()); } static class User { private String firstName; private String lastName; public User(String firstName, String lastName) { this.firstName = firstName; this.lastName = lastName; } public String getFirstName() { return firstName;",java,0
Clear,"To fix the SQL Injection vulnerability in the provided Java code snippet, you need to use parameterized queries instead of directly concatenating user input into the SQL query string. Parameterized queries help prevent SQL Injection attacks by separating SQL code from user input.

Here's an updated version of the code with a secure implementation using PreparedStatement:

```java
import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.util.Scanner;

public class SecureSQLQuery {

    public static void main(String[] args) {
        try {
            // Establishing a connection to the database
            Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");

            // Taking user input for the username
            Scanner scanner = new Scanner(System.in);
            System.out.print(""Enter username: "");
            String userInput = scanner.nextLine();

            // Constructing a parameterized SQL query
            String sqlQuery = ""SELECT * FROM users WHERE username=?"";
            
            // Creating a PreparedStatement with the parameterized query
            PreparedStatement pstmt = conn.prepareStatement(sqlQuery);
            
            // Setting the parameter value using userInput
            pstmt.setString(1, userInput);

            // Executing the","To fix the SQL Injection vulnerability in the provided Java code snippet, you need to use parameterized queries instead of directly concatenating user input into the SQL query string. Parameterized queries help prevent SQL Injection attacks by separating SQL code from user input. Here's an updated version of the code with a secure implementation using PreparedStatement: ```java import java.sql.Connection; import java.sql.DriverManager; import java.sql.PreparedStatement; import java.sql.ResultSet; import java.sql.SQLException; import java.util.Scanner; public class SecureSQLQuery { public static void main(String[] args) { try { // Establishing a connection to the database Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); // Taking user input for the username Scanner scanner = new Scanner(System.in); System.out.print(""Enter username: ""); String userInput = scanner.nextLine(); // Constructing a parameterized SQL query String sqlQuery = ""SELECT * FROM users WHERE username=?""; // Creating a PreparedStatement with the parameterized query PreparedStatement pstmt = conn.prepareStatement(sqlQuery); // Setting the parameter value using userInput pstmt.setString(1, userInput); // Executing the",java,0
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
SSRF,"import urllib.request
def download_file(file_url):
    return urllib.request.urlopen(file_url).read()","import urllib.request
def download_file(file_url):
    return urllib.request.urlopen(file_url).read()",python,1
Clear,"#include <stdio.h>
#include <string.h>

void safe_string_copy(char *dest, const char *src, size_t dest_size) {
    if (dest_size > 0) {
        strncpy(dest, src, dest_size - 1);
        dest[dest_size - 1] = '\0';
    }
}","#include <stdio.h>
#include <string.h>

void safe_string_copy(char *dest, const char *src, size_t dest_size) {
    if (dest_size > 0) {
        strncpy(dest, src, dest_size - 1);
        dest[dest_size - 1] = '\0';
    }
}",c,0
XSS,"const userInput = document.location.search.split('=')[1];
document.write(userInput); // XSS
","const userInput = document.location.search.split('=')[1];
document.write(userInput); // XSS
",javascript,1
Clear,"from flask import Flask, request
import html
app = Flask(__name__)

@app.route('/search_safe')
def search_safe():
    query = request.args.get('q', '')
    safe_query = html.escape(query)
    return f'<h1>Search results for: {safe_query}</h1>'","from flask import Flask, request
import html
app = Flask(__name__)

@app.route('/search_safe')
def search_safe():
    query = request.args.get('q', '')
    safe_query = html.escape(query)
    return f'<h1>Search results for: {safe_query}</h1>'",python,0
Clear,"#include <stdio.h>
#include <stdlib.h>

void safe_file_operation(const char *filename) {
    FILE *file = fopen(filename, ""r"");
    if (file != NULL) {
        char buffer[256];
        while (fgets(buffer, sizeof(buffer), file)) {
            printf(""%s"", buffer);
        }
        fclose(file);
    }
}","#include <stdio.h>
#include <stdlib.h>

void safe_file_operation(const char *filename) {
    FILE *file = fopen(filename, ""r"");
    if (file != NULL) {
        char buffer[256];
        while (fgets(buffer, sizeof(buffer), file)) {
            printf(""%s"", buffer);
        }
        fclose(file);
    }
}",c,0
Clear,"To fix the SQL Injection vulnerability in the provided Java code, you should use PreparedStatement with parameterized queries instead of concatenating user input directly into the SQL query. Parameterized queries prevent SQL Injection by separating the SQL query logic from the user input data.

Here is the fixed version of the code using PreparedStatement:

```java
import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;

public class SQLInjectionSecureCode {

    public static void main(String[] args) {
        String userInput = args[0]; // Simulating user input from command line

        try {
            Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");

            // Using PreparedStatement with parameterized query
            String query = ""SELECT * FROM users WHERE username=?"";
            PreparedStatement pstmt = conn.prepareStatement(query);
            pstmt.setString(1, userInput); // Set parameter value

            ResultSet rs = pstmt.executeQuery();

            while (rs.next()) {
                System.out.println(""User found: "" + rs.getString(""username""));
            }

            rs.close();
            pstmt.close();
            conn.close();
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }","To fix the SQL Injection vulnerability in the provided Java code, you should use PreparedStatement with parameterized queries instead of concatenating user input directly into the SQL query. Parameterized queries prevent SQL Injection by separating the SQL query logic from the user input data. Here is the fixed version of the code using PreparedStatement: ```java import java.sql.Connection; import java.sql.DriverManager; import java.sql.PreparedStatement; import java.sql.ResultSet; import java.sql.SQLException; public class SQLInjectionSecureCode { public static void main(String[] args) { String userInput = args[0]; // Simulating user input from command line try { Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); // Using PreparedStatement with parameterized query String query = ""SELECT * FROM users WHERE username=?""; PreparedStatement pstmt = conn.prepareStatement(query); pstmt.setString(1, userInput); // Set parameter value ResultSet rs = pstmt.executeQuery(); while (rs.next()) { System.out.println(""User found: "" + rs.getString(""username"")); } rs.close(); pstmt.close(); conn.close(); } catch (SQLException e) { e.printStackTrace(); } }",java,0
Insecure Deserialization,"import pickle
def load_user_data(filename):
    with open(filename, 'rb') as f:
        data = pickle.load(f)
    return data","import pickle
def load_user_data(filename):
    with open(filename, 'rb') as f:
        data = pickle.load(f)
    return data",python,1
Command Injection,"const shell = require('child_process');
shell.exec('ping ' + userInput); // Command Injection
","const shell = require('child_process');
shell.exec('ping ' + userInput); // Command Injection
",javascript,1
Clear,"#include <iostream>
#include <fstream>
#include <string>

void safe_file_reading(const std::string& filename) {
    std::ifstream file(filename);
    if (file.is_open()) {
        std::string line;
        while (std::getline(file, line)) {
            std::cout << line << std::endl;
        }
    }
}","#include <iostream>
#include <fstream>
#include <string>

void safe_file_reading(const std::string& filename) {
    std::ifstream file(filename);
    if (file.is_open()) {
        std::string line;
        while (std::getline(file, line)) {
            std::cout << line << std::endl;
        }
    }
}",cpp,0
Clear,"import java.io.*;
import java.util.*;
import org.owasp.encoder.Encode;

public class XSSFixedCode {

    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        
        System.out.print(""Enter your name: "");
        String name = scanner.nextLine();
        
        // Properly encoding user input to prevent XSS
        String safeName = Encode.forHtml(name);
        
        System.out.println(""Welcome, "" + safeName + ""!"");
    }
}","import java.io.*; import java.util.*; import org.owasp.encoder.Encode; public class XSSFixedCode { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter your name: ""); String name = scanner.nextLine(); // Properly encoding user input to prevent XSS String safeName = Encode.forHtml(name); System.out.println(""Welcome, "" + safeName + ""!""); } }",java,0
SQL Injection,"import sqlite3
def get_user_data(username):
    conn = sqlite3.connect('database.db')
    cursor = conn.cursor()
    query = ""SELECT * FROM users WHERE username = '"" + username + ""'""
    cursor.execute(query)
    return cursor.fetchall()","import sqlite3
def get_user_data(username):
    conn = sqlite3.connect('database.db')
    cursor = conn.cursor()
    query = ""SELECT * FROM users WHERE username = '"" + username + ""'""
    cursor.execute(query)
    return cursor.fetchall()",python,1
Clear,"To fix the Path Traversal vulnerability in the provided Java code snippet, you should ensure that the file path provided by the user is properly validated and sanitized before accessing it. Here's an improved version of the code with security measures implemented:

```java
import java.io.File;
import java.io.FileInputStream;
import java.io.IOException;

public class PathTraversalSecure {

    public static void main(String[] args) {
        if (args.length != 1) {
            System.out.println(""Usage: java PathTraversalSecure <filename>"");
            return;
        }

        String fileName = args[0];
        String basePath = ""/path/to/files/"";

        // Validate the fileName to prevent path traversal
        if (!isValidFileName(fileName)) {
            System.out.println(""Invalid file name"");
            return;
        }

        try {
            File file = new File(basePath + fileName);
            if (!file.exists() || !file.isFile()) {
                System.out.println(""File not found or is not a regular file"");
                return;
            }

            FileInputStream fis = new FileInputStream(file);

            int data;
            while ((data = fis.read()) != -1) {
                System.out.print((char) data);
            }

            fis.close();
        } catch (IOException","To fix the Path Traversal vulnerability in the provided Java code snippet, you should ensure that the file path provided by the user is properly validated and sanitized before accessing it. Here's an improved version of the code with security measures implemented: ```java import java.io.File; import java.io.FileInputStream; import java.io.IOException; public class PathTraversalSecure { public static void main(String[] args) { if (args.length != 1) { System.out.println(""Usage: java PathTraversalSecure <filename>""); return; } String fileName = args[0]; String basePath = ""/path/to/files/""; // Validate the fileName to prevent path traversal if (!isValidFileName(fileName)) { System.out.println(""Invalid file name""); return; } try { File file = new File(basePath + fileName); if (!file.exists() || !file.isFile()) { System.out.println(""File not found or is not a regular file""); return; } FileInputStream fis = new FileInputStream(file); int data; while ((data = fis.read()) != -1) { System.out.print((char) data); } fis.close(); } catch (IOException",java,0
SQL Injection,"app.get('/user/:id', (req, res) => {
    const query = `SELECT * FROM users WHERE id = ${req.params.id}`; // SQL Injection
    db.query(query, (err, result) => {
        res.json(result);
    });
});
","app.get('/user/:id', (req, res) => {
    const query = `SELECT * FROM users WHERE id = ${req.params.id}`; // SQL Injection
    db.query(query, (err, result) => {
        res.json(result);
    });
});
",javascript,1
Clear,"const userInput = new URLSearchParams(window.location.search).get('input');
const safeOutput = document.createElement('div');
safeOutput.textContent = userInput; // Safe DOM manipulation
document.body.appendChild(safeOutput);
","const userInput = new URLSearchParams(window.location.search).get('input');
const safeOutput = document.createElement('div');
safeOutput.textContent = userInput; // Safe DOM manipulation
document.body.appendChild(safeOutput);
",javascript,0
Clear,"import java.util.Scanner;

public class SecureBufferExample {
    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        
        System.out.print(""Enter a string: "");
        String input = scanner.nextLine();
        
        // Check if input length exceeds buffer size
        if (input.length() > 10) {
            System.out.println(""Input length exceeds buffer size. Please enter a shorter string."");
            return;
        }
        
        char[] buffer = new char[10];
        input.getChars(0, Math.min(input.length(), 10), buffer, 0); // Copy up to 10 characters
        
        System.out.println(""Input: "" + new String(buffer).trim()); // Trim any extra null characters
    }
}","import java.util.Scanner; public class SecureBufferExample { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter a string: ""); String input = scanner.nextLine(); // Check if input length exceeds buffer size if (input.length() > 10) { System.out.println(""Input length exceeds buffer size. Please enter a shorter string.""); return; } char[] buffer = new char[10]; input.getChars(0, Math.min(input.length(), 10), buffer, 0); // Copy up to 10 characters System.out.println(""Input: "" + new String(buffer).trim()); // Trim any extra null characters } }",java,0
Hardcoded Secrets,"DATABASE_PASSWORD = ""my_super_secret_password_123""
def db_connect():
    import psycopg2
    return psycopg2.connect(f""dbname=test user=admin password={DATABASE_PASSWORD}"")","DATABASE_PASSWORD = ""my_super_secret_password_123""
def db_connect():
    import psycopg2
    return psycopg2.connect(f""dbname=test user=admin password={DATABASE_PASSWORD}"")",python,1
Path Traversal,"import java.io.File;
import java.io.FileReader;
import java.io.IOException;
import java.util.Scanner;

public class PathTraversalExample {

    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        
        System.out.print(""Enter file name: "");
        String fileName = scanner.nextLine();
        
        File file = new File(fileName);
        
        try (FileReader fileReader = new FileReader(file)) {
            int data;
            while ((data = fileReader.read()) != -1) {
                System.out.print((char) data);
            }
        } catch (IOException e) {
            System.out.println(""Error reading file: "" + e.getMessage());
        }
    }
}","import java.io.File; import java.io.FileReader; import java.io.IOException; import java.util.Scanner; public class PathTraversalExample { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter file name: ""); String fileName = scanner.nextLine(); File file = new File(fileName); try (FileReader fileReader = new FileReader(file)) { int data; while ((data = fileReader.read()) != -1) { System.out.print((char) data); } } catch (IOException e) { System.out.println(""Error reading file: "" + e.getMessage()); } } }",java,1
Clear,"<?php
$username = $_POST['username'];
$stmt = $pdo->prepare(""SELECT * FROM users WHERE username = ?"");
$stmt->execute([$username]); // Parameterized query
?>","<?php
$username = $_POST['username'];
$stmt = $pdo->prepare(""SELECT * FROM users WHERE username = ?"");
$stmt->execute([$username]); // Parameterized query
?>",php,0
Clear,"#include <stdio.h>
#include <string.h>

int validate_input(const char *input) {
    if (input == NULL) return 0;
    for (int i = 0; input[i] != '\0'; i++) {
        if (input[i] < 32 || input[i] > 126) {
            return 0; // invalid character
        }
    }
    return 1;
}","#include <stdio.h>
#include <string.h>

int validate_input(const char *input) {
    if (input == NULL) return 0;
    for (int i = 0; input[i] != '\0'; i++) {
        if (input[i] < 32 || input[i] > 126) {
            return 0; // invalid character
        }
    }
    return 1;
}",c,0
Path Traversal,"import java.io.File;
import java.io.IOException;
import java.nio.file.Files;
import java.util.Scanner;

public class PathTraversalVulnerability {

    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        System.out.print(""Enter file name: "");
        String fileName = scanner.nextLine();

        String basePath = ""/var/www/files/"";
        File file = new File(basePath + fileName);

        try {
            byte[] fileContent = Files.readAllBytes(file.toPath());
            System.out.println(""File content: "" + new String(fileContent));
        } catch (IOException e) {
            System.out.println(""Error reading file: "" + e.getMessage());
        }
    }
}","import java.io.File; import java.io.IOException; import java.nio.file.Files; import java.util.Scanner; public class PathTraversalVulnerability { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter file name: ""); String fileName = scanner.nextLine(); String basePath = ""/var/www/files/""; File file = new File(basePath + fileName); try { byte[] fileContent = Files.readAllBytes(file.toPath()); System.out.println(""File content: "" + new String(fileContent)); } catch (IOException e) { System.out.println(""Error reading file: "" + e.getMessage()); } } }",java,1
Memory Corruption,"#include <iostream>

void unsafe_virtual_call() {
    // Potential vtable corruption vulnerability
    class Base {
    public:
        virtual void func() { std::cout << ""Base"" << std::endl; }
    };
    
    class Derived : public Base {
    public:
        void func() override { std::cout << ""Derived"" << std::endl; }
    };
}","#include <iostream>

void unsafe_virtual_call() {
    // Potential vtable corruption vulnerability
    class Base {
    public:
        virtual void func() { std::cout << ""Base"" << std::endl; }
    };
    
    class Derived : public Base {
    public:
        void func() override { std::cout << ""Derived"" << std::endl; }
    };
}",cpp,1
Clear,"#include <iostream>
#include <fstream>
#include <string>

void safe_file_reading(const std::string& filename) {
    std::ifstream file(filename);
    if (file.is_open()) {
        std::string line;
        while (std::getline(file, line)) {
            std::cout << line << std::endl;
        }
    }
}","#include <iostream>
#include <fstream>
#include <string>

void safe_file_reading(const std::string& filename) {
    std::ifstream file(filename);
    if (file.is_open()) {
        std::string line;
        while (std::getline(file, line)) {
            std::cout << line << std::endl;
        }
    }
}",cpp,0
SQL Injection,"import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.ResultSet;
import java.sql.Statement;

public class SQLInjectionExample {

    public static void main(String[] args) {
        String userInput = ""'; DROP TABLE users; --"";

        try {
            Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");
            Statement stmt = conn.createStatement();

            String query = ""SELECT * FROM users WHERE username='"" + userInput + ""'"";
            ResultSet rs = stmt.executeQuery(query);

            while (rs.next()) {
                System.out.println(""Username: "" + rs.getString(""username""));
                System.out.println(""Password: "" + rs.getString(""password""));
            }

            conn.close();
        } catch (Exception e) {
            e.printStackTrace();
        }
    }
}","import java.sql.Connection; import java.sql.DriverManager; import java.sql.ResultSet; import java.sql.Statement; public class SQLInjectionExample { public static void main(String[] args) { String userInput = ""'; DROP TABLE users; --""; try { Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); Statement stmt = conn.createStatement(); String query = ""SELECT * FROM users WHERE username='"" + userInput + ""'""; ResultSet rs = stmt.executeQuery(query); while (rs.next()) { System.out.println(""Username: "" + rs.getString(""username"")); System.out.println(""Password: "" + rs.getString(""password"")); } conn.close(); } catch (Exception e) { e.printStackTrace(); } } }",java,1
SQL Injection,"import java.sql.*;

public class SQLInjectionExample {

    public static void main(String[] args) {
        try {
            // Vulnerable code that concatenates user input directly into the SQL query
            String userInput = ""'; DROP TABLE users; --"";
            String query = ""SELECT * FROM users WHERE username = '"" + userInput + ""'"";

            Connection connection = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");
            Statement statement = connection.createStatement();
            ResultSet resultSet = statement.executeQuery(query);

            // Process the results
            while (resultSet.next()) {
                System.out.println(""User: "" + resultSet.getString(""username""));
                System.out.println(""Password: "" + resultSet.getString(""password""));
            }

        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.*; public class SQLInjectionExample { public static void main(String[] args) { try { // Vulnerable code that concatenates user input directly into the SQL query String userInput = ""'; DROP TABLE users; --""; String query = ""SELECT * FROM users WHERE username = '"" + userInput + ""'""; Connection connection = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); Statement statement = connection.createStatement(); ResultSet resultSet = statement.executeQuery(query); // Process the results while (resultSet.next()) { System.out.println(""User: "" + resultSet.getString(""username"")); System.out.println(""Password: "" + resultSet.getString(""password"")); } } catch (SQLException e) { e.printStackTrace(); } } }",java,1
Clear,"app.get('/user/:id', (req, res) => {
    const userId = parseInt(req.params.id);
    db.query('SELECT * FROM users WHERE id = ?', [userId], (err, result) => {
        res.json(result);
    });
});
","app.get('/user/:id', (req, res) => {
    const userId = parseInt(req.params.id);
    db.query('SELECT * FROM users WHERE id = ?', [userId], (err, result) => {
        res.json(result);
    });
});
",javascript,0
Clear,"#include <stdio.h>
#include <stdlib.h>

int safe_string_to_int(const char *str) {
    char *endptr;
    long value = strtol(str, &endptr, 10);
    if (*endptr != '\0' || str == endptr) {
        return -1; // error
    }
    return (int)value;
}","#include <stdio.h>
#include <stdlib.h>

int safe_string_to_int(const char *str) {
    char *endptr;
    long value = strtol(str, &endptr, 10);
    if (*endptr != '\0' || str == endptr) {
        return -1; // error
    }
    return (int)value;
}",c,0
Path Traversal,"import java.io.File;
import java.io.FileInputStream;
import java.io.IOException;

public class PathTraversalVulnerability {

    public static void main(String[] args) {
        String userInput = ""../../../../../etc/passwd"";
        String directory = ""/var/data/"";

        try {
            File file = new File(directory + userInput);
            FileInputStream fis = new FileInputStream(file);
            int content;
            while ((content = fis.read()) != -1) {
                System.out.print((char) content);
            }
            fis.close();
        } catch (IOException e) {
            System.out.println(""Error accessing file: "" + e.getMessage());
        }
    }
}","import java.io.File; import java.io.FileInputStream; import java.io.IOException; public class PathTraversalVulnerability { public static void main(String[] args) { String userInput = ""../../../../../etc/passwd""; String directory = ""/var/data/""; try { File file = new File(directory + userInput); FileInputStream fis = new FileInputStream(file); int content; while ((content = fis.read()) != -1) { System.out.print((char) content); } fis.close(); } catch (IOException e) { System.out.println(""Error accessing file: "" + e.getMessage()); } } }",java,1
Clear,"#include <iostream>
#include <sstream>

int safe_string_to_int(const std::string& str) {
    std::stringstream ss(str);
    int value;
    if (ss >> value) {
        return value;
    }
    throw std::invalid_argument(""Invalid integer"");
}","#include <iostream>
#include <sstream>

int safe_string_to_int(const std::string& str) {
    std::stringstream ss(str);
    int value;
    if (ss >> value) {
        return value;
    }
    throw std::invalid_argument(""Invalid integer"");
}",cpp,0
Clear,"import java.io.*;
import javax.servlet.*;
import javax.servlet.http.*;

public class XSSFixedServlet extends HttpServlet {
    protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        String userInput = request.getParameter(""input"");
        
        // Sanitize user input to prevent XSS
        String sanitizedInput = sanitizeInput(userInput);
        
        String output = ""<html><body>User input: "" + sanitizedInput + ""</body></html>"";
        
        PrintWriter out = response.getWriter();
        out.println(output);
    }
    
    private String sanitizeInput(String userInput) {
        // Implement proper input sanitization here
        // For example, you can use OWASP Java HTML Sanitizer library
        
        // Sample sanitization using Apache Commons Text library to escape HTML special characters
        return org.apache.commons.text.StringEscapeUtils.escapeHtml4(userInput);
    }
}","import java.io.*; import javax.servlet.*; import javax.servlet.http.*; public class XSSFixedServlet extends HttpServlet { protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { String userInput = request.getParameter(""input""); // Sanitize user input to prevent XSS String sanitizedInput = sanitizeInput(userInput); String output = ""<html><body>User input: "" + sanitizedInput + ""</body></html>""; PrintWriter out = response.getWriter(); out.println(output); } private String sanitizeInput(String userInput) { // Implement proper input sanitization here // For example, you can use OWASP Java HTML Sanitizer library // Sample sanitization using Apache Commons Text library to escape HTML special characters return org.apache.commons.text.StringEscapeUtils.escapeHtml4(userInput); } }",java,0
Command Injection,"const shell = require('child_process');
shell.exec('ping ' + userInput); // Command Injection
","const shell = require('child_process');
shell.exec('ping ' + userInput); // Command Injection
",javascript,1
Clear,"import os
def safe_read_file(filename):
    base_path = '/var/www/uploads/'
    full_path = os.path.join(base_path, filename)
    full_path = os.path.normpath(full_path)
    if not full_path.startswith(base_path):
        raise ValueError(""Path traversal detected"")
    with open(full_path, 'r') as f:
        return f.read()","import os
def safe_read_file(filename):
    base_path = '/var/www/uploads/'
    full_path = os.path.join(base_path, filename)
    full_path = os.path.normpath(full_path)
    if not full_path.startswith(base_path):
        raise ValueError(""Path traversal detected"")
    with open(full_path, 'r') as f:
        return f.read()",python,0
Path Traversal,"import os
def read_file(filename):
    with open('/var/www/uploads/' + filename, 'r') as f:
        return f.read()","import os
def read_file(filename):
    with open('/var/www/uploads/' + filename, 'r') as f:
        return f.read()",python,1
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Clear,"To fix the insecure deserialization vulnerability in the provided Java code snippet, you need to implement proper security measures to prevent potential remote code execution. Here are some steps you can take:

1. Use a Safe Deserialization Mechanism: Replace the `ObjectInputStream` with a safer deserialization mechanism that restricts which classes can be deserialized. One approach is to use a library like `Jackson` or `Gson` for JSON serialization/deserialization, which allows you to whitelist specific classes for deserialization.

2. Implement Class Whitelisting: Limit the classes that can be deserialized by maintaining a whitelist of allowed classes. Only deserialize objects of classes that are explicitly allowed in the whitelist.

3. Validate Input Data: Before deserializing any input data, validate it to ensure it comes from a trusted source and has not been tampered with. You can use digital signatures or checksums to verify the integrity of the serialized data.

4. Use Secure Communication Channels: If possible, ensure that serialized data is transmitted over secure channels (e.g., HTTPS) to prevent interception and modification by attackers.

5. Avoid Deserializing Untrusted Data: Whenever possible, avoid deserializing untrusted data altogether. If deserialization is necessary, consider","To fix the insecure deserialization vulnerability in the provided Java code snippet, you need to implement proper security measures to prevent potential remote code execution. Here are some steps you can take: 1. Use a Safe Deserialization Mechanism: Replace the `ObjectInputStream` with a safer deserialization mechanism that restricts which classes can be deserialized. One approach is to use a library like `Jackson` or `Gson` for JSON serialization/deserialization, which allows you to whitelist specific classes for deserialization. 2. Implement Class Whitelisting: Limit the classes that can be deserialized by maintaining a whitelist of allowed classes. Only deserialize objects of classes that are explicitly allowed in the whitelist. 3. Validate Input Data: Before deserializing any input data, validate it to ensure it comes from a trusted source and has not been tampered with. You can use digital signatures or checksums to verify the integrity of the serialized data. 4. Use Secure Communication Channels: If possible, ensure that serialized data is transmitted over secure channels (e.g., HTTPS) to prevent interception and modification by attackers. 5. Avoid Deserializing Untrusted Data: Whenever possible, avoid deserializing untrusted data altogether. If deserialization is necessary, consider",php,0
Insecure Deserialization,"<?php
$data = $_POST['data'];
unserialize($data); // Insecure Deserialization
?>","<?php
$data = $_POST['data'];
unserialize($data); // Insecure Deserialization
?>",php,1
Clear,"import json
def parse_safe_json(json_str):
    try:
        return json.loads(json_str)
    except json.JSONDecodeError:
        raise ValueError(""Invalid JSON"")","import json
def parse_safe_json(json_str):
    try:
        return json.loads(json_str)
    except json.JSONDecodeError:
        raise ValueError(""Invalid JSON"")",python,0
Clear,"const token = process.env.API_TOKEN; // Environment variable
fetch('/api/data', {
    headers: { 'Authorization': `Bearer ${token}` }
});
","const token = process.env.API_TOKEN; // Environment variable
fetch('/api/data', {
    headers: { 'Authorization': `Bearer ${token}` }
});
",javascript,0
Path Traversal,"import java.io.File;
import java.io.FileReader;
import java.io.IOException;
import java.util.Scanner;

public class PathTraversalVulnerability {

    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        
        System.out.print(""Enter file name: "");
        String fileName = scanner.nextLine();
        
        File file = new File(fileName);
        
        try (FileReader reader = new FileReader(file)) {
            int data;
            while ((data = reader.read()) != -1) {
                System.out.print((char) data);
            }
        } catch (IOException e) {
            System.err.println(""Error reading file: "" + e.getMessage());
        }
        
        scanner.close();
    }
}","import java.io.File; import java.io.FileReader; import java.io.IOException; import java.util.Scanner; public class PathTraversalVulnerability { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter file name: ""); String fileName = scanner.nextLine(); File file = new File(fileName); try (FileReader reader = new FileReader(file)) { int data; while ((data = reader.read()) != -1) { System.out.print((char) data); } } catch (IOException e) { System.err.println(""Error reading file: "" + e.getMessage()); } scanner.close(); } }",java,1
Clear,"import java.util.Scanner;

public class SecureBufferExample {

    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        
        System.out.print(""Enter a string (max 10 characters): "");
        String input = scanner.nextLine();
        
        // Ensure that input length does not exceed buffer size
        if (input.length() > 10) {
            System.out.println(""Input string exceeds maximum allowed length."");
            scanner.close();
            return;
        }
        
        char[] buffer = new char[10];
        input.getChars(0, Math.min(input.length(), 10), buffer, 0);
        
        System.out.println(""Buffer contents: "" + new String(buffer));
        
        scanner.close();
    }
}","import java.util.Scanner; public class SecureBufferExample { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter a string (max 10 characters): ""); String input = scanner.nextLine(); // Ensure that input length does not exceed buffer size if (input.length() > 10) { System.out.println(""Input string exceeds maximum allowed length.""); scanner.close(); return; } char[] buffer = new char[10]; input.getChars(0, Math.min(input.length(), 10), buffer, 0); System.out.println(""Buffer contents: "" + new String(buffer)); scanner.close(); } }",java,0
Clear,"To secure the code against Path Traversal attacks, you need to ensure that the input file name provided by the user is sanitized and validated before constructing the file path. Here's an updated version of the code with security measures:

```java
import java.io.File;
import java.io.FileInputStream;
import java.io.IOException;
import java.util.Scanner;

public class PathTraversalSecure {
    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        System.out.print(""Enter file name: "");
        String fileName = scanner.next();

        // Validate input file name to prevent path traversal
        if (!isValidFileName(fileName)) {
            System.out.println(""Invalid file name"");
            return;
        }

        try {
            File file = new File(""C:\\data\\"" + fileName);
            FileInputStream fis = new FileInputStream(file);
            int content;
            while ((content = fis.read()) != -1) {
                System.out.print((char) content);
            }
            fis.close();
        } catch (IOException e) {
            System.out.println(""Error reading file: "" + e.getMessage());
        }
    }

    // Validate input file name to prevent path traversal
    private static boolean isValidFileName(String fileName) {
        // Implement","To secure the code against Path Traversal attacks, you need to ensure that the input file name provided by the user is sanitized and validated before constructing the file path. Here's an updated version of the code with security measures: ```java import java.io.File; import java.io.FileInputStream; import java.io.IOException; import java.util.Scanner; public class PathTraversalSecure { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter file name: ""); String fileName = scanner.next(); // Validate input file name to prevent path traversal if (!isValidFileName(fileName)) { System.out.println(""Invalid file name""); return; } try { File file = new File(""C:\\data\\"" + fileName); FileInputStream fis = new FileInputStream(file); int content; while ((content = fis.read()) != -1) { System.out.print((char) content); } fis.close(); } catch (IOException e) { System.out.println(""Error reading file: "" + e.getMessage()); } } // Validate input file name to prevent path traversal private static boolean isValidFileName(String fileName) { // Implement",java,0
SQL Injection,"import java.sql.*;

public class VulnerableCode {
    public static void main(String[] args) {
        try {
            String userInput = ""admin'; DROP TABLE users; --""; // Malicious user input

            Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");
            Statement stmt = conn.createStatement();

            String query = ""SELECT * FROM users WHERE username='"" + userInput + ""'"";
            ResultSet rs = stmt.executeQuery(query);

            while (rs.next()) {
                System.out.println(rs.getString(""username""));
            }

            conn.close();
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.*; public class VulnerableCode { public static void main(String[] args) { try { String userInput = ""admin'; DROP TABLE users; --""; // Malicious user input Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); Statement stmt = conn.createStatement(); String query = ""SELECT * FROM users WHERE username='"" + userInput + ""'""; ResultSet rs = stmt.executeQuery(query); while (rs.next()) { System.out.println(rs.getString(""username"")); } conn.close(); } catch (SQLException e) { e.printStackTrace(); } } }",java,1
Clear,"#include <stdio.h>
#include <stdlib.h>

void safe_file_operation(const char *filename) {
    FILE *file = fopen(filename, ""r"");
    if (file != NULL) {
        char buffer[256];
        while (fgets(buffer, sizeof(buffer), file)) {
            printf(""%s"", buffer);
        }
        fclose(file);
    }
}","#include <stdio.h>
#include <stdlib.h>

void safe_file_operation(const char *filename) {
    FILE *file = fopen(filename, ""r"");
    if (file != NULL) {
        char buffer[256];
        while (fgets(buffer, sizeof(buffer), file)) {
            printf(""%s"", buffer);
        }
        fclose(file);
    }
}",c,0
Clear,"const shell = require('child_process');
const safeInput = userInput.replace(/[^a-zA-Z0-9.]/g, '');
shell.execFile('ping', [safeInput]); // Safe command execution
","const shell = require('child_process');
const safeInput = userInput.replace(/[^a-zA-Z0-9.]/g, '');
shell.execFile('ping', [safeInput]); // Safe command execution
",javascript,0
Path Traversal,"import java.io.File;
import java.io.FileInputStream;
import java.io.IOException;

public class FileReadExample {

    public static void main(String[] args) {
        String fileName = args[0]; // User input for the file name
        
        try {
            File file = new File(fileName);
            FileInputStream fis = new FileInputStream(file);
            
            int data;
            while ((data = fis.read()) != -1) {
                System.out.print((char) data);
            }
            
            fis.close();
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}",import java.io.File; import java.io.FileInputStream; import java.io.IOException; public class FileReadExample { public static void main(String[] args) { String fileName = args[0]; // User input for the file name try { File file = new File(fileName); FileInputStream fis = new FileInputStream(file); int data; while ((data = fis.read()) != -1) { System.out.print((char) data); } fis.close(); } catch (IOException e) { e.printStackTrace(); } } },java,1
Clear,"To fix the insecure deserialization vulnerability in the provided Java code snippet, you should implement proper security measures to prevent malicious code execution. Here are some steps you can take to improve the security of deserialization:

1. Implement a whitelist approach: Instead of deserializing any arbitrary object, create a whitelist of allowed classes that can be deserialized. This restricts the types of objects that can be deserialized and helps prevent arbitrary code execution.

2. Use a secure serialization library: Consider using a secure serialization library like Google's Protocol Buffers or Apache Avro, which provide more control over the serialization and deserialization process.

3. Validate input data: Before deserializing any input data, validate it to ensure it comes from a trusted and authenticated source. Do not deserialize user-provided data directly.

4. Implement input validation: Validate the input data format before attempting deserialization to prevent potential injection attacks.

5. Sanitize input: If you must deserialize untrusted data, consider implementing input sanitization techniques such as input validation and filtering to remove potentially dangerous content.

6. Implement a custom SecurityManager: You can implement a custom SecurityManager to restrict certain actions during deserialization, such as preventing reflection or dynamic class loading.

Here is an updated","To fix the insecure deserialization vulnerability in the provided Java code snippet, you should implement proper security measures to prevent malicious code execution. Here are some steps you can take to improve the security of deserialization: 1. Implement a whitelist approach: Instead of deserializing any arbitrary object, create a whitelist of allowed classes that can be deserialized. This restricts the types of objects that can be deserialized and helps prevent arbitrary code execution. 2. Use a secure serialization library: Consider using a secure serialization library like Google's Protocol Buffers or Apache Avro, which provide more control over the serialization and deserialization process. 3. Validate input data: Before deserializing any input data, validate it to ensure it comes from a trusted and authenticated source. Do not deserialize user-provided data directly. 4. Implement input validation: Validate the input data format before attempting deserialization to prevent potential injection attacks. 5. Sanitize input: If you must deserialize untrusted data, consider implementing input sanitization techniques such as input validation and filtering to remove potentially dangerous content. 6. Implement a custom SecurityManager: You can implement a custom SecurityManager to restrict certain actions during deserialization, such as preventing reflection or dynamic class loading. Here is an updated",php,0
Clear,"import java.io.IOException;
import java.io.PrintWriter;
import org.owasp.encoder.Encode;

public class XSSFixedCode {

    public static void main(String[] args) throws IOException {
        // Simulating user input from a form
        String userInput = ""<script>alert('XSS Vulnerability!')</script>"";

        // Sanitize user input to prevent XSS attacks
        String sanitizedInput = Encode.forHtml(userInput);

        // Properly handle user input with sanitization
        String output = ""<p>Welcome, "" + sanitizedInput + ""</p>"";

        // Printing the output to an HTML page
        PrintWriter out = new PrintWriter(""output.html"");
        out.println(output);
        out.close();
    }
}","import java.io.IOException; import java.io.PrintWriter; import org.owasp.encoder.Encode; public class XSSFixedCode { public static void main(String[] args) throws IOException { // Simulating user input from a form String userInput = ""<script>alert('XSS Vulnerability!')</script>""; // Sanitize user input to prevent XSS attacks String sanitizedInput = Encode.forHtml(userInput); // Properly handle user input with sanitization String output = ""<p>Welcome, "" + sanitizedInput + ""</p>""; // Printing the output to an HTML page PrintWriter out = new PrintWriter(""output.html""); out.println(output); out.close(); } }",java,0
XSS,"const userInput = document.location.search.split('=')[1];
document.write(userInput); // XSS
","const userInput = document.location.search.split('=')[1];
document.write(userInput); // XSS
",javascript,1
Clear,"import os
def get_api_key():
    return os.environ.get('API_KEY')","import os
def get_api_key():
    return os.environ.get('API_KEY')",python,0
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Clear,"<?php
$username = $_POST['username'];
$stmt = $pdo->prepare(""SELECT * FROM users WHERE username = ?"");
$stmt->execute([$username]); // Parameterized query
?>","<?php
$username = $_POST['username'];
$stmt = $pdo->prepare(""SELECT * FROM users WHERE username = ?"");
$stmt->execute([$username]); // Parameterized query
?>",php,0
Clear,"import logging
def safe_log_user_action(user_id, action):
    logging.info(f""User {user_id} performed action: {action}"")","import logging
def safe_log_user_action(user_id, action):
    logging.info(f""User {user_id} performed action: {action}"")",python,0
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
SQL Injection,"app.get('/user/:id', (req, res) => {
    const query = `SELECT * FROM users WHERE id = ${req.params.id}`; // SQL Injection
    db.query(query, (err, result) => {
        res.json(result);
    });
});
","app.get('/user/:id', (req, res) => {
    const query = `SELECT * FROM users WHERE id = ${req.params.id}`; // SQL Injection
    db.query(query, (err, result) => {
        res.json(result);
    });
});
",javascript,1
Buffer Overflow,"import java.util.Scanner;

public class BufferOverflowVulnerability {
    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        
        System.out.print(""Enter a string: "");
        String userInput = scanner.next();
        
        // Create a fixed size char array with a capacity of 10 characters
        char[] buffer = new char[10];
        
        // Copy user input into the buffer
        userInput.getChars(0, userInput.length(), buffer, 0);
        
        System.out.println(""Buffer contents: "" + new String(buffer));
    }
}","import java.util.Scanner; public class BufferOverflowVulnerability { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter a string: ""); String userInput = scanner.next(); // Create a fixed size char array with a capacity of 10 characters char[] buffer = new char[10]; // Copy user input into the buffer userInput.getChars(0, userInput.length(), buffer, 0); System.out.println(""Buffer contents: "" + new String(buffer)); } }",java,1
Command Injection,"import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class CommandInjectionVulnerability {

    public static void main(String[] args) {
        try {
            BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));
            System.out.print(""Enter a command to execute: "");
            String userInput = reader.readLine();

            // Vulnerable code - directly executing user input as a command
            Process process = Runtime.getRuntime().exec(userInput);

            BufferedReader processOutputReader = new BufferedReader(new InputStreamReader(process.getInputStream()));
            String line;
            while ((line = processOutputReader.readLine()) != null) {
                System.out.println(line);
            }
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}","import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class CommandInjectionVulnerability { public static void main(String[] args) { try { BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a command to execute: ""); String userInput = reader.readLine(); // Vulnerable code - directly executing user input as a command Process process = Runtime.getRuntime().exec(userInput); BufferedReader processOutputReader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = processOutputReader.readLine()) != null) { System.out.println(line); } } catch (IOException e) { e.printStackTrace(); } } }",java,1
Command Injection,"import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class CommandInjectionExample {
    public static void main(String[] args) throws IOException {
        BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));
        
        System.out.print(""Enter the IP address to ping: "");
        String ipAddress = reader.readLine();
        
        String command = ""ping -c 4 "" + ipAddress; // Vulnerable code
        
        Process process = Runtime.getRuntime().exec(command);
        
        BufferedReader inputReader = new BufferedReader(new InputStreamReader(process.getInputStream()));
        String inputLine;
        
        while ((inputLine = inputReader.readLine()) != null) {
            System.out.println(inputLine);
        }
    }
}","import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class CommandInjectionExample { public static void main(String[] args) throws IOException { BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter the IP address to ping: ""); String ipAddress = reader.readLine(); String command = ""ping -c 4 "" + ipAddress; // Vulnerable code Process process = Runtime.getRuntime().exec(command); BufferedReader inputReader = new BufferedReader(new InputStreamReader(process.getInputStream())); String inputLine; while ((inputLine = inputReader.readLine()) != null) { System.out.println(inputLine); } } }",java,1
Clear,"#include <iostream>
#include <vector>
#include <stdexcept>

int safe_vector_access(const std::vector<int>& vec, size_t index) {
    if (index >= vec.size()) {
        throw std::out_of_range(""Index out of range"");
    }
    return vec[index];
}","#include <iostream>
#include <vector>
#include <stdexcept>

int safe_vector_access(const std::vector<int>& vec, size_t index) {
    if (index >= vec.size()) {
        throw std::out_of_range(""Index out of range"");
    }
    return vec[index];
}",cpp,0
Clear,"To fix the Buffer Overflow vulnerability in the given Java code snippet, you can implement the following secure coding practices:

1. Use `Scanner.nextLine()` instead of `Scanner.next()`: 
   - The `next()` method of Scanner reads only until the next space, which may not read the entire user input. Using `nextLine()` reads the entire line of input.
   
2. Validate user input length before copying into buffer:
   - Check the length of user input before copying it into the buffer to prevent buffer overflow. You can use `if` statement to ensure that the input length does not exceed the buffer size.

3. Use `Arrays.copyOf` or `String.substring` for safe copying:
   - Instead of directly copying characters from user input to a fixed-size array, consider using methods like `Arrays.copyOf` or `String.substring` to safely copy a portion of the input.

Here is an updated version of your code with these security measures implemented:

```java
import java.util.Scanner;
import java.util.Arrays;

public class SecureBufferExample {

    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        
        System.out.print(""Enter a string: "");
        String userInput = scanner.nextLine();","To fix the Buffer Overflow vulnerability in the given Java code snippet, you can implement the following secure coding practices: 1. Use `Scanner.nextLine()` instead of `Scanner.next()`: - The `next()` method of Scanner reads only until the next space, which may not read the entire user input. Using `nextLine()` reads the entire line of input. 2. Validate user input length before copying into buffer: - Check the length of user input before copying it into the buffer to prevent buffer overflow. You can use `if` statement to ensure that the input length does not exceed the buffer size. 3. Use `Arrays.copyOf` or `String.substring` for safe copying: - Instead of directly copying characters from user input to a fixed-size array, consider using methods like `Arrays.copyOf` or `String.substring` to safely copy a portion of the input. Here is an updated version of your code with these security measures implemented: ```java import java.util.Scanner; import java.util.Arrays; public class SecureBufferExample { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter a string: ""); String userInput = scanner.nextLine();",java,0
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Cross-Site Scripting (XSS),"import java.io.*;
import javax.servlet.*;
import javax.servlet.http.*;

public class XSSVulnerableServlet extends HttpServlet {
    
    protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        String userInput = request.getParameter(""input"");
        
        // Improper handling of user input - directly embedding it in the response
        PrintWriter out = response.getWriter();
        out.println(""<html>"");
        out.println(""<body>"");
        out.println(""<h1>Hello, "" + userInput + ""!</h1>""); // Vulnerable point
        out.println(""</body>"");
        out.println(""</html>"");
    }
}","import java.io.*; import javax.servlet.*; import javax.servlet.http.*; public class XSSVulnerableServlet extends HttpServlet { protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { String userInput = request.getParameter(""input""); // Improper handling of user input - directly embedding it in the response PrintWriter out = response.getWriter(); out.println(""<html>""); out.println(""<body>""); out.println(""<h1>Hello, "" + userInput + ""!</h1>""); // Vulnerable point out.println(""</body>""); out.println(""</html>""); } }",java,1
Insecure Deserialization,"<?php
$data = $_POST['data'];
unserialize($data); // Insecure Deserialization
?>","<?php
$data = $_POST['data'];
unserialize($data); // Insecure Deserialization
?>",php,1
SQL Injection,"<?php
$username = $_POST['username'];
$query = ""SELECT * FROM users WHERE username = '$username'"";
$result = mysql_query($query); // SQL Injection
?>","<?php
$username = $_POST['username'];
$query = ""SELECT * FROM users WHERE username = '$username'"";
$result = mysql_query($query); // SQL Injection
?>",php,1
Hardcoded Secrets,"localStorage.setItem('token', 'hardcoded-secret-token-123'); // Hardcoded secret
","localStorage.setItem('token', 'hardcoded-secret-token-123'); // Hardcoded secret
",javascript,1
Clear,"#include <stdio.h>
#include <string.h>

int safe_buffer_operation(char *input) {
    char buffer[100];
    if (strlen(input) < sizeof(buffer)) {
        strcpy(buffer, input);
        return 0;
    }
    return -1; // buffer too small
}","#include <stdio.h>
#include <string.h>

int safe_buffer_operation(char *input) {
    char buffer[100];
    if (strlen(input) < sizeof(buffer)) {
        strcpy(buffer, input);
        return 0;
    }
    return -1; // buffer too small
}",c,0
Out-of-Bounds,"#include <iostream>

class UnsafeClass {
    int data[10];
public:
    int get_data(int index) {
        return data[index]; // no bounds checking
    }
};","#include <iostream>

class UnsafeClass {
    int data[10];
public:
    int get_data(int index) {
        return data[index]; // no bounds checking
    }
};",cpp,1
Clear,"const token = process.env.API_TOKEN; // Environment variable
fetch('/api/data', {
    headers: { 'Authorization': `Bearer ${token}` }
});
","const token = process.env.API_TOKEN; // Environment variable
fetch('/api/data', {
    headers: { 'Authorization': `Bearer ${token}` }
});
",javascript,0
Clear,"#include <stdio.h>
#include <string.h>

int safe_buffer_operation(char *input) {
    char buffer[100];
    if (strlen(input) < sizeof(buffer)) {
        strcpy(buffer, input);
        return 0;
    }
    return -1; // buffer too small
}","#include <stdio.h>
#include <string.h>

int safe_buffer_operation(char *input) {
    char buffer[100];
    if (strlen(input) < sizeof(buffer)) {
        strcpy(buffer, input);
        return 0;
    }
    return -1; // buffer too small
}",c,0
Cross-Site Scripting (XSS),"import java.io.*;
import javax.servlet.*;
import javax.servlet.http.*;

public class VulnerableServlet extends HttpServlet {
    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        String userInput = request.getParameter(""input"");
        String output = ""<h1>Welcome, "" + userInput + ""!</h1>"";

        PrintWriter out = response.getWriter();
        out.println(output);
    }
}","import java.io.*; import javax.servlet.*; import javax.servlet.http.*; public class VulnerableServlet extends HttpServlet { protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { String userInput = request.getParameter(""input""); String output = ""<h1>Welcome, "" + userInput + ""!</h1>""; PrintWriter out = response.getWriter(); out.println(output); } }",java,1
Clear,"import os
def get_database_config():
    return {
        'host': os.environ.get('DB_HOST'),
        'user': os.environ.get('DB_USER'),
        'password': os.environ.get('DB_PASSWORD')
    }","import os
def get_database_config():
    return {
        'host': os.environ.get('DB_HOST'),
        'user': os.environ.get('DB_USER'),
        'password': os.environ.get('DB_PASSWORD')
    }",python,0
Cross-Site Scripting (XSS),"import java.io.*;
import javax.servlet.*;
import javax.servlet.http.*;

public class VulnerableServlet extends HttpServlet {
    
    protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        String userInput = request.getParameter(""input"");
        
        String responseHtml = ""<html><body>Welcome, "" + userInput + ""</body></html>"";
        
        PrintWriter out = response.getWriter();
        out.println(responseHtml);
    }
}","import java.io.*; import javax.servlet.*; import javax.servlet.http.*; public class VulnerableServlet extends HttpServlet { protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { String userInput = request.getParameter(""input""); String responseHtml = ""<html><body>Welcome, "" + userInput + ""</body></html>""; PrintWriter out = response.getWriter(); out.println(responseHtml); } }",java,1
Clear,"import java.io.IOException;
import java.io.PrintWriter;
import org.apache.commons.text.StringEscapeUtils;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

public class SecureServlet extends HttpServlet {
    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws IOException {
        String userInput = request.getParameter(""input"");
        
        response.setContentType(""text/html"");
        PrintWriter out = response.getWriter();
        
        out.println(""<html><body>"");
        out.println(""<h1>Hello, "" + StringEscapeUtils.escapeHtml4(userInput) + ""</h1>"");
        out.println(""</body></html>"");
    }
}","import java.io.IOException; import java.io.PrintWriter; import org.apache.commons.text.StringEscapeUtils; import javax.servlet.http.HttpServlet; import javax.servlet.http.HttpServletRequest; import javax.servlet.http.HttpServletResponse; public class SecureServlet extends HttpServlet { protected void doGet(HttpServletRequest request, HttpServletResponse response) throws IOException { String userInput = request.getParameter(""input""); response.setContentType(""text/html""); PrintWriter out = response.getWriter(); out.println(""<html><body>""); out.println(""<h1>Hello, "" + StringEscapeUtils.escapeHtml4(userInput) + ""</h1>""); out.println(""</body></html>""); } }",java,0
Clear,"import java.sql.*;

public class SQLInjectionFixed {

    public static void main(String[] args) {
        String userInput = ""'; DROP TABLE users; --""; // Malicious input

        try {
            Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");
            
            // Use a PreparedStatement with parameterized query
            String query = ""SELECT * FROM users WHERE username=?"";
            PreparedStatement pstmt = conn.prepareStatement(query);
            pstmt.setString(1, userInput);
            
            ResultSet rs = pstmt.executeQuery();

            while (rs.next()) {
                System.out.println(rs.getString(""username""));
            }

            conn.close();
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.*; public class SQLInjectionFixed { public static void main(String[] args) { String userInput = ""'; DROP TABLE users; --""; // Malicious input try { Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); // Use a PreparedStatement with parameterized query String query = ""SELECT * FROM users WHERE username=?""; PreparedStatement pstmt = conn.prepareStatement(query); pstmt.setString(1, userInput); ResultSet rs = pstmt.executeQuery(); while (rs.next()) { System.out.println(rs.getString(""username"")); } conn.close(); } catch (SQLException e) { e.printStackTrace(); } } }",java,0
Command Injection,"const shell = require('child_process');
shell.exec('ping ' + userInput); // Command Injection
","const shell = require('child_process');
shell.exec('ping ' + userInput); // Command Injection
",javascript,1
Clear,"To fix the XSS vulnerability in the provided Java servlet code, you need to properly escape user input before rendering it back to the client. One common approach to prevent XSS attacks is to use output encoding to ensure that any user-controlled data is treated as plain text rather than HTML or JavaScript code.

Here's an updated version of the code that uses proper output encoding to mitigate the XSS vulnerability:

```java
import java.io.*;
import javax.servlet.*;
import javax.servlet.http.*;

public class InputHandlerServlet extends HttpServlet {
    protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        String userInput = request.getParameter(""input"");
        String safeUserInput = encodeHtml(userInput);
        
        response.getWriter().println(""You entered: "" + safeUserInput);
    }
    
    private String encodeHtml(String input) {
        if (input == null) {
            return """";
        }
        
        StringBuilder encodedString = new StringBuilder();
        
        for (char c : input.toCharArray()) {
            switch (c) {
                case '<':
                    encodedString.append(""&lt;"");
                    break;
                case '>':
                    encodedString.append(""&gt;"");
                    break;
                case '&':
                    encodedString.append(""&amp;"");
                    break;
                case '""':","To fix the XSS vulnerability in the provided Java servlet code, you need to properly escape user input before rendering it back to the client. One common approach to prevent XSS attacks is to use output encoding to ensure that any user-controlled data is treated as plain text rather than HTML or JavaScript code. Here's an updated version of the code that uses proper output encoding to mitigate the XSS vulnerability: ```java import java.io.*; import javax.servlet.*; import javax.servlet.http.*; public class InputHandlerServlet extends HttpServlet { protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { String userInput = request.getParameter(""input""); String safeUserInput = encodeHtml(userInput); response.getWriter().println(""You entered: "" + safeUserInput); } private String encodeHtml(String input) { if (input == null) { return """"; } StringBuilder encodedString = new StringBuilder(); for (char c : input.toCharArray()) { switch (c) { case '<': encodedString.append(""&lt;""); break; case '>': encodedString.append(""&gt;""); break; case '&': encodedString.append(""&amp;""); break; case '""':",java,0
Memory Corruption,"#include <iostream>

void unsafe_virtual_call() {
    // Potential vtable corruption vulnerability
    class Base {
    public:
        virtual void func() { std::cout << ""Base"" << std::endl; }
    };
    
    class Derived : public Base {
    public:
        void func() override { std::cout << ""Derived"" << std::endl; }
    };
}","#include <iostream>

void unsafe_virtual_call() {
    // Potential vtable corruption vulnerability
    class Base {
    public:
        virtual void func() { std::cout << ""Base"" << std::endl; }
    };
    
    class Derived : public Base {
    public:
        void func() override { std::cout << ""Derived"" << std::endl; }
    };
}",cpp,1
XSS,"const userInput = document.location.search.split('=')[1];
document.write(userInput); // XSS
","const userInput = document.location.search.split('=')[1];
document.write(userInput); // XSS
",javascript,1
Command Injection,"const shell = require('child_process');
shell.exec('ping ' + userInput); // Command Injection
","const shell = require('child_process');
shell.exec('ping ' + userInput); // Command Injection
",javascript,1
Clear,"app.get('/user/:id', (req, res) => {
    const userId = parseInt(req.params.id);
    db.query('SELECT * FROM users WHERE id = ?', [userId], (err, result) => {
        res.json(result);
    });
});
","app.get('/user/:id', (req, res) => {
    const userId = parseInt(req.params.id);
    db.query('SELECT * FROM users WHERE id = ?', [userId], (err, result) => {
        res.json(result);
    });
});
",javascript,0
Clear,"import os
def get_database_config():
    return {
        'host': os.environ.get('DB_HOST'),
        'user': os.environ.get('DB_USER'),
        'password': os.environ.get('DB_PASSWORD')
    }","import os
def get_database_config():
    return {
        'host': os.environ.get('DB_HOST'),
        'user': os.environ.get('DB_USER'),
        'password': os.environ.get('DB_PASSWORD')
    }",python,0
Out-of-Bounds,"#include <iostream>

class UnsafeClass {
    int data[10];
public:
    int get_data(int index) {
        return data[index]; // no bounds checking
    }
};","#include <iostream>

class UnsafeClass {
    int data[10];
public:
    int get_data(int index) {
        return data[index]; // no bounds checking
    }
};",cpp,1
SQL Injection,"import java.sql.*;

public class SQLInjectionVulnerable {

    public static void main(String[] args) {
        String username = args[0];
        String password = args[1];

        try {
            Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""root"", ""password"");
            Statement stmt = conn.createStatement();

            String query = ""SELECT * FROM users WHERE username='"" + username + ""' AND password='"" + password + ""'"";
            ResultSet rs = stmt.executeQuery(query);

            while (rs.next()) {
                System.out.println(""Welcome, "" + rs.getString(""username""));
            }

            conn.close();
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.*; public class SQLInjectionVulnerable { public static void main(String[] args) { String username = args[0]; String password = args[1]; try { Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""root"", ""password""); Statement stmt = conn.createStatement(); String query = ""SELECT * FROM users WHERE username='"" + username + ""' AND password='"" + password + ""'""; ResultSet rs = stmt.executeQuery(query); while (rs.next()) { System.out.println(""Welcome, "" + rs.getString(""username"")); } conn.close(); } catch (SQLException e) { e.printStackTrace(); } } }",java,1
SQL Injection,"import mysql.connector
def search_products(category):
    db = mysql.connector.connect(host=""localhost"", user=""user"", password=""pass"", database=""shop"")
    cursor = db.cursor()
    cursor.execute(""SELECT * FROM products WHERE category = '%s'"" % category)
    return cursor.fetchall()","import mysql.connector
def search_products(category):
    db = mysql.connector.connect(host=""localhost"", user=""user"", password=""pass"", database=""shop"")
    cursor = db.cursor()
    cursor.execute(""SELECT * FROM products WHERE category = '%s'"" % category)
    return cursor.fetchall()",python,1
SQL Injection,"<?php
$username = $_POST['username'];
$query = ""SELECT * FROM users WHERE username = '$username'"";
$result = mysql_query($query); // SQL Injection
?>","<?php
$username = $_POST['username'];
$query = ""SELECT * FROM users WHERE username = '$username'"";
$result = mysql_query($query); // SQL Injection
?>",php,1
Clear,"<?php
$input = json_decode($_POST['data'], true); // Safe JSON parsing
if (json_last_error() === JSON_ERROR_NONE) {
    process_data($input);
}
?>","<?php
$input = json_decode($_POST['data'], true); // Safe JSON parsing
if (json_last_error() === JSON_ERROR_NONE) {
    process_data($input);
}
?>",php,0
Cross-Site Scripting (XSS),"import java.io.*;

public class XSSVulnerableCode {

    public static void main(String[] args) throws IOException {
        BufferedReader br = new BufferedReader(new InputStreamReader(System.in));

        System.out.print(""Enter your name: "");
        String userInput = br.readLine();

        System.out.println(""Hello, "" + userInput + ""!"");

        // Vulnerability: User input is directly concatenated into the HTML output
        System.out.println(""<h1>Welcome, "" + userInput + ""!</h1>"");
    }
}","import java.io.*; public class XSSVulnerableCode { public static void main(String[] args) throws IOException { BufferedReader br = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter your name: ""); String userInput = br.readLine(); System.out.println(""Hello, "" + userInput + ""!""); // Vulnerability: User input is directly concatenated into the HTML output System.out.println(""<h1>Welcome, "" + userInput + ""!</h1>""); } }",java,1
Insecure Deserialization,"import yaml
def load_config(config_str):
    return yaml.load(config_str, Loader=yaml.Loader)","import yaml
def load_config(config_str):
    return yaml.load(config_str, Loader=yaml.Loader)",python,1
Clear,"#include <iostream>
#include <fstream>
#include <string>

void safe_file_reading(const std::string& filename) {
    std::ifstream file(filename);
    if (file.is_open()) {
        std::string line;
        while (std::getline(file, line)) {
            std::cout << line << std::endl;
        }
    }
}","#include <iostream>
#include <fstream>
#include <string>

void safe_file_reading(const std::string& filename) {
    std::ifstream file(filename);
    if (file.is_open()) {
        std::string line;
        while (std::getline(file, line)) {
            std::cout << line << std::endl;
        }
    }
}",cpp,0
Code Injection,"const userData = eval('(' + userInput + ')'); // eval injection
","const userData = eval('(' + userInput + ')'); // eval injection
",javascript,1
SQL Injection,"import java.sql.*;

public class SQLInjectionVulnerable {

    public static void main(String[] args) {
        String userInput = ""'; DROP TABLE users; --"";

        try {
            Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");
            Statement stmt = conn.createStatement();

            // Vulnerable query construction
            String query = ""SELECT * FROM users WHERE username = '"" + userInput + ""'"";
            ResultSet rs = stmt.executeQuery(query);

            while (rs.next()) {
                System.out.println(""User found: "" + rs.getString(""username""));
            }

            conn.close();
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.*; public class SQLInjectionVulnerable { public static void main(String[] args) { String userInput = ""'; DROP TABLE users; --""; try { Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); Statement stmt = conn.createStatement(); // Vulnerable query construction String query = ""SELECT * FROM users WHERE username = '"" + userInput + ""'""; ResultSet rs = stmt.executeQuery(query); while (rs.next()) { System.out.println(""User found: "" + rs.getString(""username"")); } conn.close(); } catch (SQLException e) { e.printStackTrace(); } } }",java,1
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Cross-Site Scripting (XSS),"import java.io.IOException;
import javax.servlet.ServletException;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

public class VulnerableServlet extends HttpServlet {
    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        String userInput = request.getParameter(""input"");
        String output = ""Hello, "" + userInput + ""!"";

        response.setContentType(""text/html"");
        response.getWriter().println(""<html><body>"");
        response.getWriter().println(""<h1>"" + output + ""</h1>"");
        response.getWriter().println(""</body></html>"");
    }
}","import java.io.IOException; import javax.servlet.ServletException; import javax.servlet.http.HttpServlet; import javax.servlet.http.HttpServletRequest; import javax.servlet.http.HttpServletResponse; public class VulnerableServlet extends HttpServlet { protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { String userInput = request.getParameter(""input""); String output = ""Hello, "" + userInput + ""!""; response.setContentType(""text/html""); response.getWriter().println(""<html><body>""); response.getWriter().println(""<h1>"" + output + ""</h1>""); response.getWriter().println(""</body></html>""); } }",java,1
Cross-Site Scripting (XSS),"import java.io.*;
import javax.servlet.*;
import javax.servlet.http.*;

public class XSSVulnerableServlet extends HttpServlet {

    protected void doPost(HttpServletRequest request, HttpServletResponse response)
            throws ServletException, IOException {

        String userInput = request.getParameter(""input"");
        
        // Improper handling of user input
        String output = ""<p>User input: "" + userInput + ""</p>"";

        response.setContentType(""text/html"");
        PrintWriter out = response.getWriter();
        out.println(output);
    }
}","import java.io.*; import javax.servlet.*; import javax.servlet.http.*; public class XSSVulnerableServlet extends HttpServlet { protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { String userInput = request.getParameter(""input""); // Improper handling of user input String output = ""<p>User input: "" + userInput + ""</p>""; response.setContentType(""text/html""); PrintWriter out = response.getWriter(); out.println(output); } }",java,1
Clear,"import org.apache.commons.text.StringEscapeUtils;

public class XSSFixedCode {
    public static void main(String[] args) {
        // Simulating user input
        String userInput = ""<script>alert('XSS Vulnerability!')</script>"";

        // Sanitize user input before outputting it to the web page
        String sanitizedInput = StringEscapeUtils.escapeHtml4(userInput);

        // Output sanitized input within a div element
        System.out.println(""<div>"" + sanitizedInput + ""</div>"");
    }
}","import org.apache.commons.text.StringEscapeUtils; public class XSSFixedCode { public static void main(String[] args) { // Simulating user input String userInput = ""<script>alert('XSS Vulnerability!')</script>""; // Sanitize user input before outputting it to the web page String sanitizedInput = StringEscapeUtils.escapeHtml4(userInput); // Output sanitized input within a div element System.out.println(""<div>"" + sanitizedInput + ""</div>""); } }",java,0
Hardcoded Secrets,"localStorage.setItem('token', 'hardcoded-secret-token-123'); // Hardcoded secret
","localStorage.setItem('token', 'hardcoded-secret-token-123'); // Hardcoded secret
",javascript,1
Buffer Overflow,"#include <iostream>
#include <cstring>

void unsafe_c_string(char* input) {
    char buffer[100];
    strcpy(buffer, input); // potential buffer overflow
    std::cout << buffer << std::endl;
}","#include <iostream>
#include <cstring>

void unsafe_c_string(char* input) {
    char buffer[100];
    strcpy(buffer, input); // potential buffer overflow
    std::cout << buffer << std::endl;
}",cpp,1
SQL Injection,"import java.sql.*;

public class VulnerableSQLInjection {
    public static void main(String[] args) {
        String userInput = args[0]; // Simulating user input

        try {
            Connection connection = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");
            Statement statement = connection.createStatement();

            // Vulnerable SQL query
            String query = ""SELECT * FROM users WHERE username = '"" + userInput + ""'"";
            ResultSet resultSet = statement.executeQuery(query);

            while (resultSet.next()) {
                System.out.println(resultSet.getString(""username"") + "" : "" + resultSet.getString(""email""));
            }

            connection.close();
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.*; public class VulnerableSQLInjection { public static void main(String[] args) { String userInput = args[0]; // Simulating user input try { Connection connection = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); Statement statement = connection.createStatement(); // Vulnerable SQL query String query = ""SELECT * FROM users WHERE username = '"" + userInput + ""'""; ResultSet resultSet = statement.executeQuery(query); while (resultSet.next()) { System.out.println(resultSet.getString(""username"") + "" : "" + resultSet.getString(""email"")); } connection.close(); } catch (SQLException e) { e.printStackTrace(); } } }",java,1
Clear,"<?php
$input = json_decode($_POST['data'], true); // Safe JSON parsing
if (json_last_error() === JSON_ERROR_NONE) {
    process_data($input);
}
?>","<?php
$input = json_decode($_POST['data'], true); // Safe JSON parsing
if (json_last_error() === JSON_ERROR_NONE) {
    process_data($input);
}
?>",php,0
Clear,"#include <iostream>
#include <vector>
#include <stdexcept>

int safe_vector_access(const std::vector<int>& vec, size_t index) {
    if (index >= vec.size()) {
        throw std::out_of_range(""Index out of range"");
    }
    return vec[index];
}","#include <iostream>
#include <vector>
#include <stdexcept>

int safe_vector_access(const std::vector<int>& vec, size_t index) {
    if (index >= vec.size()) {
        throw std::out_of_range(""Index out of range"");
    }
    return vec[index];
}",cpp,0
Clear,"<?php
$file = basename($_GET['file']);
$allowed = ['page1.php', 'page2.php'];
if (in_array($file, $allowed)) {
    include($file);
}
?>","<?php
$file = basename($_GET['file']);
$allowed = ['page1.php', 'page2.php'];
if (in_array($file, $allowed)) {
    include($file);
}
?>",php,0
Buffer Overflow,"import java.util.Scanner;

public class BufferOverflowExample {
    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        
        System.out.print(""Enter a string: "");
        String input = scanner.next();
        
        char[] buffer = new char[10];
        input.getChars(0, input.length(), buffer, 0);
        
        System.out.println(""Buffer content: "" + new String(buffer));
    }
}","import java.util.Scanner; public class BufferOverflowExample { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter a string: ""); String input = scanner.next(); char[] buffer = new char[10]; input.getChars(0, input.length(), buffer, 0); System.out.println(""Buffer content: "" + new String(buffer)); } }",java,1
Insecure Deserialization,"import yaml
def load_config(config_str):
    return yaml.load(config_str, Loader=yaml.Loader)","import yaml
def load_config(config_str):
    return yaml.load(config_str, Loader=yaml.Loader)",python,1
Clear,"import java.util.Scanner;

public class SecureBufferCopy {
    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        System.out.print(""Enter a string: "");
        String userInput = scanner.nextLine();
        
        int maxLength = Math.min(userInput.length(), 10); // Maximum allowed length for buffer
        
        char[] buffer = new char[maxLength]; // Fixed buffer size
        
        // Copy user input into the buffer with proper bounds checking
        for (int i = 0; i < maxLength; i++) {
            buffer[i] = userInput.charAt(i);
        }
        
        System.out.println(""Buffer content: "" + new String(buffer));
    }
}","import java.util.Scanner; public class SecureBufferCopy { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter a string: ""); String userInput = scanner.nextLine(); int maxLength = Math.min(userInput.length(), 10); // Maximum allowed length for buffer char[] buffer = new char[maxLength]; // Fixed buffer size // Copy user input into the buffer with proper bounds checking for (int i = 0; i < maxLength; i++) { buffer[i] = userInput.charAt(i); } System.out.println(""Buffer content: "" + new String(buffer)); } }",java,0
XSS,"const userInput = document.location.search.split('=')[1];
document.write(userInput); // XSS
","const userInput = document.location.search.split('=')[1];
document.write(userInput); // XSS
",javascript,1
Command Injection,"import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class CommandInjectionVulnerable {

    public static void main(String[] args) {
        try {
            BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));
            System.out.print(""Enter a command to execute: "");
            String command = reader.readLine();

            // This is vulnerable to command injection
            Process process = Runtime.getRuntime().exec(command);

            BufferedReader inputReader = new BufferedReader(new InputStreamReader(process.getInputStream()));
            String line;
            while ((line = inputReader.readLine()) != null) {
                System.out.println(line);
            }
            
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}","import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class CommandInjectionVulnerable { public static void main(String[] args) { try { BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a command to execute: ""); String command = reader.readLine(); // This is vulnerable to command injection Process process = Runtime.getRuntime().exec(command); BufferedReader inputReader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = inputReader.readLine()) != null) { System.out.println(line); } } catch (IOException e) { e.printStackTrace(); } } }",java,1
Clear,"#include <stdio.h>
#include <string.h>

int safe_buffer_operation(char *input) {
    char buffer[100];
    if (strlen(input) < sizeof(buffer)) {
        strcpy(buffer, input);
        return 0;
    }
    return -1; // buffer too small
}","#include <stdio.h>
#include <string.h>

int safe_buffer_operation(char *input) {
    char buffer[100];
    if (strlen(input) < sizeof(buffer)) {
        strcpy(buffer, input);
        return 0;
    }
    return -1; // buffer too small
}",c,0
Clear,"#include <stdio.h>
#include <string.h>

int validate_input(const char *input) {
    if (input == NULL) return 0;
    for (int i = 0; input[i] != '\0'; i++) {
        if (input[i] < 32 || input[i] > 126) {
            return 0; // invalid character
        }
    }
    return 1;
}","#include <stdio.h>
#include <string.h>

int validate_input(const char *input) {
    if (input == NULL) return 0;
    for (int i = 0; input[i] != '\0'; i++) {
        if (input[i] < 32 || input[i] > 126) {
            return 0; // invalid character
        }
    }
    return 1;
}",c,0
Path Traversal,"import java.io.File;
import java.io.FileInputStream;
import java.io.IOException;
import java.util.Scanner;

public class PathTraversalVulnerability {
    
    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        System.out.print(""Enter a file name: "");
        String fileName = scanner.next();

        try {
            File file = new File(""C:\\Users\\Public\\"" + fileName);
            FileInputStream fis = new FileInputStream(file);
            
            int content;
            while ((content = fis.read()) != -1) {
                System.out.print((char) content);
            }
            
            fis.close();
        } catch (IOException e) {
            System.out.println(""Error reading file: "" + e.getMessage());
        }
    }
}","import java.io.File; import java.io.FileInputStream; import java.io.IOException; import java.util.Scanner; public class PathTraversalVulnerability { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter a file name: ""); String fileName = scanner.next(); try { File file = new File(""C:\\Users\\Public\\"" + fileName); FileInputStream fis = new FileInputStream(file); int content; while ((content = fis.read()) != -1) { System.out.print((char) content); } fis.close(); } catch (IOException e) { System.out.println(""Error reading file: "" + e.getMessage()); } } }",java,1
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Code Injection,"const userData = eval('(' + userInput + ')'); // eval injection
","const userData = eval('(' + userInput + ')'); // eval injection
",javascript,1
Clear,"<?php
$message = htmlspecialchars($_GET['message'], ENT_QUOTES, 'UTF-8');
echo $message; // Sanitized output
?>","<?php
$message = htmlspecialchars($_GET['message'], ENT_QUOTES, 'UTF-8');
echo $message; // Sanitized output
?>",php,0
Buffer Overflow,"import java.util.Scanner;

public class BufferOverflowExample {
    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        
        System.out.print(""Enter your name: "");
        String name = scanner.nextLine();
        
        char[] buffer = new char[10];
        
        // Copy user input into buffer without checking the length
        for (int i = 0; i < name.length(); i++) {
            buffer[i] = name.charAt(i);
        }
        
        System.out.println(""Hello, "" + String.valueOf(buffer));
    }
}","import java.util.Scanner; public class BufferOverflowExample { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter your name: ""); String name = scanner.nextLine(); char[] buffer = new char[10]; // Copy user input into buffer without checking the length for (int i = 0; i < name.length(); i++) { buffer[i] = name.charAt(i); } System.out.println(""Hello, "" + String.valueOf(buffer)); } }",java,1
Cross-Site Scripting (XSS),"import java.io.*;

public class XSSVulnerabilityExample {
    public static void main(String[] args) {
        String userInput = ""<script>alert('XSS Vulnerability')</script>"";
        
        // Improperly handling user input by directly printing it to HTML output
        System.out.println(""<div>"" + userInput + ""</div>"");
    }
}","import java.io.*; public class XSSVulnerabilityExample { public static void main(String[] args) { String userInput = ""<script>alert('XSS Vulnerability')</script>""; // Improperly handling user input by directly printing it to HTML output System.out.println(""<div>"" + userInput + ""</div>""); } }",java,1
Clear,"#include <iostream>
#include <memory>

void safe_memory_management() {
    auto ptr = std::make_unique<int>(42);
    std::cout << *ptr << std::endl;
}","#include <iostream>
#include <memory>

void safe_memory_management() {
    auto ptr = std::make_unique<int>(42);
    std::cout << *ptr << std::endl;
}",cpp,0
Clear,"<?php
$file = basename($_GET['file']);
$allowed = ['page1.php', 'page2.php'];
if (in_array($file, $allowed)) {
    include($file);
}
?>","<?php
$file = basename($_GET['file']);
$allowed = ['page1.php', 'page2.php'];
if (in_array($file, $allowed)) {
    include($file);
}
?>",php,0
Cross-Site Scripting (XSS),"import java.io.IOException;
import java.io.PrintWriter;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

public class XSSVulnerableServlet extends HttpServlet {

    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws IOException {
        String userInput = request.getParameter(""input"");
        
        response.setContentType(""text/html"");
        PrintWriter out = response.getWriter();
        
        out.println(""<html>"");
        out.println(""<body>"");
        out.println(""<h1>User Input: "" + userInput + ""</h1>""); // Improperly handling user input here
        out.println(""</body>"");
        out.println(""</html>"");
    }
}","import java.io.IOException; import java.io.PrintWriter; import javax.servlet.http.HttpServlet; import javax.servlet.http.HttpServletRequest; import javax.servlet.http.HttpServletResponse; public class XSSVulnerableServlet extends HttpServlet { protected void doGet(HttpServletRequest request, HttpServletResponse response) throws IOException { String userInput = request.getParameter(""input""); response.setContentType(""text/html""); PrintWriter out = response.getWriter(); out.println(""<html>""); out.println(""<body>""); out.println(""<h1>User Input: "" + userInput + ""</h1>""); // Improperly handling user input here out.println(""</body>""); out.println(""</html>""); } }",java,1
Command Injection,"import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class CommandInjectionVulnerable {

    public static void main(String[] args) throws IOException {
        BufferedReader br = new BufferedReader(new InputStreamReader(System.in));
        System.out.print(""Enter the IP address to ping: "");
        String ipAddress = br.readLine();

        // Vulnerable code - directly concatenating user input into command
        String command = ""ping "" + ipAddress;

        Process process = Runtime.getRuntime().exec(command);

        BufferedReader reader = new BufferedReader(new InputStreamReader(process.getInputStream()));
        String line;
        while ((line = reader.readLine()) != null) {
            System.out.println(line);
        }
    }
}","import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class CommandInjectionVulnerable { public static void main(String[] args) throws IOException { BufferedReader br = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter the IP address to ping: ""); String ipAddress = br.readLine(); // Vulnerable code - directly concatenating user input into command String command = ""ping "" + ipAddress; Process process = Runtime.getRuntime().exec(command); BufferedReader reader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = reader.readLine()) != null) { System.out.println(line); } } }",java,1
Clear,"import logging
def safe_log_user_action(user_id, action):
    logging.info(f""User {user_id} performed action: {action}"")","import logging
def safe_log_user_action(user_id, action):
    logging.info(f""User {user_id} performed action: {action}"")",python,0
Buffer Overflow,"import java.util.Scanner;

public class BufferOverflowExample {
    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        
        System.out.print(""Enter a string: "");
        String input = scanner.nextLine();
        
        char[] buffer = new char[10];
        input.getChars(0, input.length(), buffer, 0); // This line can lead to buffer overflow
        
        System.out.println(""Buffer content: "" + new String(buffer));
    }
}","import java.util.Scanner; public class BufferOverflowExample { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter a string: ""); String input = scanner.nextLine(); char[] buffer = new char[10]; input.getChars(0, input.length(), buffer, 0); // This line can lead to buffer overflow System.out.println(""Buffer content: "" + new String(buffer)); } }",java,1
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Clear,"To fix the Path Traversal vulnerability in the given Java code snippet, you should ensure that the user input for the file name is properly validated to prevent malicious input that can lead to accessing files outside of the intended directory. Here is an improved version of the code with proper security measures:

```java
import java.io.File;
import java.io.FileInputStream;
import java.io.IOException;
import java.util.Scanner;

public class SecurePathTraversal {

    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        System.out.print(""Enter the file name: "");
        String fileName = scanner.nextLine();

        // Validate the file name to prevent path traversal
        if (!isValidFileName(fileName)) {
            System.out.println(""Invalid file name. Please try again."");
            return;
        }

        try {
            File file = new File(""/path/to/files/"" + fileName);
            if (!file.exists() || !file.isFile()) {
                System.out.println(""File not found or is not a regular file."");
                return;
            }

            FileInputStream fis = new FileInputStream(file);

            int content;
            while ((content = fis.read()) != -1) {
                System.out.print((char) content);
            }

            fis.close();","To fix the Path Traversal vulnerability in the given Java code snippet, you should ensure that the user input for the file name is properly validated to prevent malicious input that can lead to accessing files outside of the intended directory. Here is an improved version of the code with proper security measures: ```java import java.io.File; import java.io.FileInputStream; import java.io.IOException; import java.util.Scanner; public class SecurePathTraversal { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter the file name: ""); String fileName = scanner.nextLine(); // Validate the file name to prevent path traversal if (!isValidFileName(fileName)) { System.out.println(""Invalid file name. Please try again.""); return; } try { File file = new File(""/path/to/files/"" + fileName); if (!file.exists() || !file.isFile()) { System.out.println(""File not found or is not a regular file.""); return; } FileInputStream fis = new FileInputStream(file); int content; while ((content = fis.read()) != -1) { System.out.print((char) content); } fis.close();",java,0
Clear,"const token = process.env.API_TOKEN; // Environment variable
fetch('/api/data', {
    headers: { 'Authorization': `Bearer ${token}` }
});
","const token = process.env.API_TOKEN; // Environment variable
fetch('/api/data', {
    headers: { 'Authorization': `Bearer ${token}` }
});
",javascript,0
Command Injection,"import subprocess
def list_directory(path):
    result = subprocess.run(f""ls {path}"", shell=True, capture_output=True, text=True)
    return result.stdout","import subprocess
def list_directory(path):
    result = subprocess.run(f""ls {path}"", shell=True, capture_output=True, text=True)
    return result.stdout",python,1
Clear,"import java.sql.*;

public class SQLInjectionSecureExample {

    public static void main(String[] args) {
        try {
            String userInput = ""'; DROP TABLE users; --""; // Malicious user input

            Connection connection = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");

            // Use PreparedStatement to safely handle user input
            String query = ""SELECT * FROM users WHERE username = ?"";
            PreparedStatement preparedStatement = connection.prepareStatement(query);
            preparedStatement.setString(1, userInput);

            ResultSet resultSet = preparedStatement.executeQuery();

            while (resultSet.next()) {
                System.out.println(resultSet.getString(""username""));
            }

            connection.close();
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.*; public class SQLInjectionSecureExample { public static void main(String[] args) { try { String userInput = ""'; DROP TABLE users; --""; // Malicious user input Connection connection = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); // Use PreparedStatement to safely handle user input String query = ""SELECT * FROM users WHERE username = ?""; PreparedStatement preparedStatement = connection.prepareStatement(query); preparedStatement.setString(1, userInput); ResultSet resultSet = preparedStatement.executeQuery(); while (resultSet.next()) { System.out.println(resultSet.getString(""username"")); } connection.close(); } catch (SQLException e) { e.printStackTrace(); } } }",java,0
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Clear,"import java.sql.*;

public class SecureCode {
    public static void main(String[] args) {
        String userInput = args[0]; // Assume user input is directly taken as input
        
        try {
            Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");
            
            // Use PreparedStatement to safely handle user input
            String query = ""SELECT * FROM users WHERE username=?"";
            PreparedStatement pstmt = conn.prepareStatement(query);
            pstmt.setString(1, userInput);
            
            ResultSet rs = pstmt.executeQuery();
            
            while(rs.next()) {
                System.out.println(""User ID: "" + rs.getInt(""id"") + "", Username: "" + rs.getString(""username""));
            }
            
            conn.close();
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.*; public class SecureCode { public static void main(String[] args) { String userInput = args[0]; // Assume user input is directly taken as input try { Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); // Use PreparedStatement to safely handle user input String query = ""SELECT * FROM users WHERE username=?""; PreparedStatement pstmt = conn.prepareStatement(query); pstmt.setString(1, userInput); ResultSet rs = pstmt.executeQuery(); while(rs.next()) { System.out.println(""User ID: "" + rs.getInt(""id"") + "", Username: "" + rs.getString(""username"")); } conn.close(); } catch (SQLException e) { e.printStackTrace(); } } }",java,0
Clear,"To fix the XSS vulnerability in the provided Java servlet code, you need to properly encode the user input before including it in the response output. Here's an improved version of the code that uses encoding to prevent XSS attacks:

```java
import java.io.IOException;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

public class XSSFixedServlet extends HttpServlet {
    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws IOException {
        String userInput = request.getParameter(""input"");
        String safeUserInput = encodeHTML(userInput);
        String output = ""<h1>Hello, "" + safeUserInput + ""!</h1>"";
        response.getWriter().write(output);
    }

    private String encodeHTML(String input) {
        if (input == null) {
            return """";
        }
        StringBuilder sb = new StringBuilder(input.length());
        for (char c : input.toCharArray()) {
            switch (c) {
                case '<':
                    sb.append(""&lt;"");
                    break;
                case '>':
                    sb.append(""&gt;"");
                    break;
                case '&':
                    sb.append(""&amp;"");
                    break;
                case '""':
                    sb.append(""&quot;"");
                    break;
                default:
                    sb.append(c);
            }","To fix the XSS vulnerability in the provided Java servlet code, you need to properly encode the user input before including it in the response output. Here's an improved version of the code that uses encoding to prevent XSS attacks: ```java import java.io.IOException; import javax.servlet.http.HttpServlet; import javax.servlet.http.HttpServletRequest; import javax.servlet.http.HttpServletResponse; public class XSSFixedServlet extends HttpServlet { protected void doGet(HttpServletRequest request, HttpServletResponse response) throws IOException { String userInput = request.getParameter(""input""); String safeUserInput = encodeHTML(userInput); String output = ""<h1>Hello, "" + safeUserInput + ""!</h1>""; response.getWriter().write(output); } private String encodeHTML(String input) { if (input == null) { return """"; } StringBuilder sb = new StringBuilder(input.length()); for (char c : input.toCharArray()) { switch (c) { case '<': sb.append(""&lt;""); break; case '>': sb.append(""&gt;""); break; case '&': sb.append(""&amp;""); break; case '""': sb.append(""&quot;""); break; default: sb.append(c); }",java,0
Clear,"import java.sql.*;

public class SecureSQLQuery {
    public static void main(String[] args) {
        String userInput = ""'; DROP TABLE users; --"";
        
        try {
            Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");
            
            // Use prepared statement with parameterized query
            String query = ""SELECT * FROM users WHERE username=?"";
            PreparedStatement pstmt = conn.prepareStatement(query);
            pstmt.setString(1, userInput);
            
            ResultSet rs = pstmt.executeQuery();
            
            while (rs.next()) {
                System.out.println(rs.getString(""username""));
            }
            
            conn.close();
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.*; public class SecureSQLQuery { public static void main(String[] args) { String userInput = ""'; DROP TABLE users; --""; try { Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); // Use prepared statement with parameterized query String query = ""SELECT * FROM users WHERE username=?""; PreparedStatement pstmt = conn.prepareStatement(query); pstmt.setString(1, userInput); ResultSet rs = pstmt.executeQuery(); while (rs.next()) { System.out.println(rs.getString(""username"")); } conn.close(); } catch (SQLException e) { e.printStackTrace(); } } }",java,0
Clear,"To prevent Path Traversal vulnerabilities in the given Java code snippet, you can apply the following secure coding practices:

1. Validate User Input:
   - Ensure that the user input is validated to only allow safe characters and prevent directory traversal attempts.
   - Consider restricting the input to alphanumeric characters or a specific format if applicable.

2. Use Paths API:
   - Utilize the Paths API to safely construct file paths instead of concatenating strings directly.
   - Use `Paths.get()` method to create a Path object from the base directory and file name provided by the user.

3. Check Path Validity:
   - Verify that the constructed path points to a valid location within the expected directory structure.
   - You can use `Files.isRegularFile()` or other methods from `Files` class to check if the file exists and is a regular file.

4. Handle Exceptions Appropriately:
   - Catch specific exceptions such as InvalidPathException, SecurityException, etc., along with IOException for better error handling.
   
5. Provide Feedback Carefully:
   - Avoid disclosing detailed error messages that may reveal sensitive information about the system's internal structure.
   - Provide generic error messages to users without exposing system paths or configurations.

Here's an improved version of the","To prevent Path Traversal vulnerabilities in the given Java code snippet, you can apply the following secure coding practices: 1. Validate User Input: - Ensure that the user input is validated to only allow safe characters and prevent directory traversal attempts. - Consider restricting the input to alphanumeric characters or a specific format if applicable. 2. Use Paths API: - Utilize the Paths API to safely construct file paths instead of concatenating strings directly. - Use `Paths.get()` method to create a Path object from the base directory and file name provided by the user. 3. Check Path Validity: - Verify that the constructed path points to a valid location within the expected directory structure. - You can use `Files.isRegularFile()` or other methods from `Files` class to check if the file exists and is a regular file. 4. Handle Exceptions Appropriately: - Catch specific exceptions such as InvalidPathException, SecurityException, etc., along with IOException for better error handling. 5. Provide Feedback Carefully: - Avoid disclosing detailed error messages that may reveal sensitive information about the system's internal structure. - Provide generic error messages to users without exposing system paths or configurations. Here's an improved version of the",php,0
Clear,"#include <stdio.h>
#include <string.h>

int validate_input(const char *input) {
    if (input == NULL) return 0;
    for (int i = 0; input[i] != '\0'; i++) {
        if (input[i] < 32 || input[i] > 126) {
            return 0; // invalid character
        }
    }
    return 1;
}","#include <stdio.h>
#include <string.h>

int validate_input(const char *input) {
    if (input == NULL) return 0;
    for (int i = 0; input[i] != '\0'; i++) {
        if (input[i] < 32 || input[i] > 126) {
            return 0; // invalid character
        }
    }
    return 1;
}",c,0
Insecure Deserialization,"import pickle
def load_user_data(filename):
    with open(filename, 'rb') as f:
        data = pickle.load(f)
    return data","import pickle
def load_user_data(filename):
    with open(filename, 'rb') as f:
        data = pickle.load(f)
    return data",python,1
Cross-Site Scripting (XSS),"import java.io.*;

public class XSSVulnerableCode {

    public static void main(String[] args) {
        // Simulating user input
        String userInput = ""<script>alert('XSS Vulnerability!')</script>"";

        // Improperly handling user input by directly outputting it to the response
        System.out.println(""Welcome, "" + userInput);
    }
}","import java.io.*; public class XSSVulnerableCode { public static void main(String[] args) { // Simulating user input String userInput = ""<script>alert('XSS Vulnerability!')</script>""; // Improperly handling user input by directly outputting it to the response System.out.println(""Welcome, "" + userInput); } }",java,1
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Path Traversal,"import java.io.BufferedReader;
import java.io.FileReader;
import java.io.IOException;

public class FileReadExample {
    public static void main(String[] args) {
        String filename = args[0]; // User input for file to read

        try {
            FileReader fileReader = new FileReader(filename);
            BufferedReader bufferedReader = new BufferedReader(fileReader);

            String line;
            while ((line = bufferedReader.readLine()) != null) {
                System.out.println(line);
            }

            bufferedReader.close();
        } catch (IOException e) {
            System.err.println(""Error reading file: "" + e.getMessage());
        }
    }
}","import java.io.BufferedReader; import java.io.FileReader; import java.io.IOException; public class FileReadExample { public static void main(String[] args) { String filename = args[0]; // User input for file to read try { FileReader fileReader = new FileReader(filename); BufferedReader bufferedReader = new BufferedReader(fileReader); String line; while ((line = bufferedReader.readLine()) != null) { System.out.println(line); } bufferedReader.close(); } catch (IOException e) { System.err.println(""Error reading file: "" + e.getMessage()); } } }",java,1
SQL Injection,"<?php
$username = $_POST['username'];
$query = ""SELECT * FROM users WHERE username = '$username'"";
$result = mysql_query($query); // SQL Injection
?>","<?php
$username = $_POST['username'];
$query = ""SELECT * FROM users WHERE username = '$username'"";
$result = mysql_query($query); // SQL Injection
?>",php,1
Clear,"import org.owasp.encoder.Encode;

public class XSSFixedCode {
    public static void main(String[] args) {
        // Simulating user input, but in reality, this could come from a user form input
        String userInput = ""<script>alert('XSS Vulnerability!')</script>"";

        // Properly encoding user input before outputting it to the response
        System.out.println(""<html>"");
        System.out.println(""<body>"");
        System.out.println(""<h1>Welcome, "" + Encode.forHtml(userInput) + ""</h1>"");
        System.out.println(""</body>"");
        System.out.println(""</html>"");
    }
}","import org.owasp.encoder.Encode; public class XSSFixedCode { public static void main(String[] args) { // Simulating user input, but in reality, this could come from a user form input String userInput = ""<script>alert('XSS Vulnerability!')</script>""; // Properly encoding user input before outputting it to the response System.out.println(""<html>""); System.out.println(""<body>""); System.out.println(""<h1>Welcome, "" + Encode.forHtml(userInput) + ""</h1>""); System.out.println(""</body>""); System.out.println(""</html>""); } }",java,0
File Inclusion,"<?php
$file = $_GET['file'];
include($file); // File Inclusion
?>","<?php
$file = $_GET['file'];
include($file); // File Inclusion
?>",php,1
Clear,"import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;

public class SecureCode {

    public static void main(String[] args) {
        String userInput = ""'; DROP TABLE users; --"";
        
        try {
            Connection connection = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");
            
            String query = ""SELECT * FROM users WHERE username = ?"";
            PreparedStatement preparedStatement = connection.prepareStatement(query);
            
            preparedStatement.setString(1, userInput);
            
            ResultSet resultSet = preparedStatement.executeQuery();
            
            while(resultSet.next()) {
                System.out.println(""User found: "" + resultSet.getString(""username""));
            }
            
            connection.close();
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.Connection; import java.sql.DriverManager; import java.sql.PreparedStatement; import java.sql.ResultSet; import java.sql.SQLException; public class SecureCode { public static void main(String[] args) { String userInput = ""'; DROP TABLE users; --""; try { Connection connection = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); String query = ""SELECT * FROM users WHERE username = ?""; PreparedStatement preparedStatement = connection.prepareStatement(query); preparedStatement.setString(1, userInput); ResultSet resultSet = preparedStatement.executeQuery(); while(resultSet.next()) { System.out.println(""User found: "" + resultSet.getString(""username"")); } connection.close(); } catch (SQLException e) { e.printStackTrace(); } } }",java,0
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Hardcoded Secrets,"DATABASE_PASSWORD = ""my_super_secret_password_123""
def db_connect():
    import psycopg2
    return psycopg2.connect(f""dbname=test user=admin password={DATABASE_PASSWORD}"")","DATABASE_PASSWORD = ""my_super_secret_password_123""
def db_connect():
    import psycopg2
    return psycopg2.connect(f""dbname=test user=admin password={DATABASE_PASSWORD}"")",python,1
Clear,"<?php
$username = $_POST['username'];
$stmt = $pdo->prepare(""SELECT * FROM users WHERE username = ?"");
$stmt->execute([$username]); // Parameterized query
?>","<?php
$username = $_POST['username'];
$stmt = $pdo->prepare(""SELECT * FROM users WHERE username = ?"");
$stmt->execute([$username]); // Parameterized query
?>",php,0
Command Injection,"import subprocess
def list_directory(path):
    result = subprocess.run(f""ls {path}"", shell=True, capture_output=True, text=True)
    return result.stdout","import subprocess
def list_directory(path):
    result = subprocess.run(f""ls {path}"", shell=True, capture_output=True, text=True)
    return result.stdout",python,1
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Clear,"import jwt
import os
from datetime import datetime, timedelta

def create_safe_token(user_id):
    payload = {
        'user_id': user_id,
        'exp': datetime.utcnow() + timedelta(hours=1)
    }
    secret = os.environ.get('JWT_SECRET')
    return jwt.encode(payload, secret, algorithm='HS256')","import jwt
import os
from datetime import datetime, timedelta

def create_safe_token(user_id):
    payload = {
        'user_id': user_id,
        'exp': datetime.utcnow() + timedelta(hours=1)
    }
    secret = os.environ.get('JWT_SECRET')
    return jwt.encode(payload, secret, algorithm='HS256')",python,0
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Clear,"import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;

public class SecureSQLInjectionFixed {
    
    public static void main(String[] args) {
        String userInput = ""'; DROP TABLE users; --""; // Malicious input simulating a SQL Injection attack
        
        String query = ""SELECT * FROM users WHERE username = ?"";
        
        try {
            Connection connection = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");
            PreparedStatement statement = connection.prepareStatement(query);
            statement.setString(1, userInput); // Set parameter value
            
            ResultSet resultSet = statement.executeQuery();
            
            while(resultSet.next()) {
                System.out.println(""Username: "" + resultSet.getString(""username""));
                System.out.println(""Email: "" + resultSet.getString(""email""));
            }
            
            connection.close();
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.Connection; import java.sql.DriverManager; import java.sql.PreparedStatement; import java.sql.ResultSet; import java.sql.SQLException; public class SecureSQLInjectionFixed { public static void main(String[] args) { String userInput = ""'; DROP TABLE users; --""; // Malicious input simulating a SQL Injection attack String query = ""SELECT * FROM users WHERE username = ?""; try { Connection connection = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); PreparedStatement statement = connection.prepareStatement(query); statement.setString(1, userInput); // Set parameter value ResultSet resultSet = statement.executeQuery(); while(resultSet.next()) { System.out.println(""Username: "" + resultSet.getString(""username"")); System.out.println(""Email: "" + resultSet.getString(""email"")); } connection.close(); } catch (SQLException e) { e.printStackTrace(); } } }",java,0
Clear,"#include <iostream>
#include <sstream>

int safe_string_to_int(const std::string& str) {
    std::stringstream ss(str);
    int value;
    if (ss >> value) {
        return value;
    }
    throw std::invalid_argument(""Invalid integer"");
}","#include <iostream>
#include <sstream>

int safe_string_to_int(const std::string& str) {
    std::stringstream ss(str);
    int value;
    if (ss >> value) {
        return value;
    }
    throw std::invalid_argument(""Invalid integer"");
}",cpp,0
Command Injection,"const shell = require('child_process');
shell.exec('ping ' + userInput); // Command Injection
","const shell = require('child_process');
shell.exec('ping ' + userInput); // Command Injection
",javascript,1
XSS,"const userInput = document.location.search.split('=')[1];
document.write(userInput); // XSS
","const userInput = document.location.search.split('=')[1];
document.write(userInput); // XSS
",javascript,1
Clear,"app.get('/user/:id', (req, res) => {
    const userId = parseInt(req.params.id);
    db.query('SELECT * FROM users WHERE id = ?', [userId], (err, result) => {
        res.json(result);
    });
});
","app.get('/user/:id', (req, res) => {
    const userId = parseInt(req.params.id);
    db.query('SELECT * FROM users WHERE id = ?', [userId], (err, result) => {
        res.json(result);
    });
});
",javascript,0
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
SQL Injection,"app.get('/user/:id', (req, res) => {
    const query = `SELECT * FROM users WHERE id = ${req.params.id}`; // SQL Injection
    db.query(query, (err, result) => {
        res.json(result);
    });
});
","app.get('/user/:id', (req, res) => {
    const query = `SELECT * FROM users WHERE id = ${req.params.id}`; // SQL Injection
    db.query(query, (err, result) => {
        res.json(result);
    });
});
",javascript,1
Clear,"app.get('/user/:id', (req, res) => {
    const userId = parseInt(req.params.id);
    db.query('SELECT * FROM users WHERE id = ?', [userId], (err, result) => {
        res.json(result);
    });
});
","app.get('/user/:id', (req, res) => {
    const userId = parseInt(req.params.id);
    db.query('SELECT * FROM users WHERE id = ?', [userId], (err, result) => {
        res.json(result);
    });
});
",javascript,0
Buffer Overflow,"#include <iostream>
#include <cstring>

void unsafe_c_string(char* input) {
    char buffer[100];
    strcpy(buffer, input); // potential buffer overflow
    std::cout << buffer << std::endl;
}","#include <iostream>
#include <cstring>

void unsafe_c_string(char* input) {
    char buffer[100];
    strcpy(buffer, input); // potential buffer overflow
    std::cout << buffer << std::endl;
}",cpp,1
Cross-Site Scripting (XSS),"import java.io.IOException;
import java.io.PrintWriter;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

public class VulnerableServlet extends HttpServlet {

    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws IOException {
        String userInput = request.getParameter(""input"");
        
        // Improperly handling user input by directly outputting it to the response
        PrintWriter out = response.getWriter();
        out.println(""<html>"");
        out.println(""<body>"");
        out.println(""<h1>User Input: "" + userInput + ""</h1>"");
        out.println(""</body>"");
        out.println(""</html>"");
    }
}","import java.io.IOException; import java.io.PrintWriter; import javax.servlet.http.HttpServlet; import javax.servlet.http.HttpServletRequest; import javax.servlet.http.HttpServletResponse; public class VulnerableServlet extends HttpServlet { protected void doGet(HttpServletRequest request, HttpServletResponse response) throws IOException { String userInput = request.getParameter(""input""); // Improperly handling user input by directly outputting it to the response PrintWriter out = response.getWriter(); out.println(""<html>""); out.println(""<body>""); out.println(""<h1>User Input: "" + userInput + ""</h1>""); out.println(""</body>""); out.println(""</html>""); } }",java,1
Out-of-Bounds,"#include <iostream>

class UnsafeClass {
    int data[10];
public:
    int get_data(int index) {
        return data[index]; // no bounds checking
    }
};","#include <iostream>

class UnsafeClass {
    int data[10];
public:
    int get_data(int index) {
        return data[index]; // no bounds checking
    }
};",cpp,1
Clear,"#include <stdio.h>
#include <string.h>

int validate_input(const char *input) {
    if (input == NULL) return 0;
    for (int i = 0; input[i] != '\0'; i++) {
        if (input[i] < 32 || input[i] > 126) {
            return 0; // invalid character
        }
    }
    return 1;
}","#include <stdio.h>
#include <string.h>

int validate_input(const char *input) {
    if (input == NULL) return 0;
    for (int i = 0; input[i] != '\0'; i++) {
        if (input[i] < 32 || input[i] > 126) {
            return 0; // invalid character
        }
    }
    return 1;
}",c,0
Path Traversal,"def get_user_file(username, filepath):
    import os
    base_path = f""/home/{username}/files/""
    full_path = base_path + filepath
    with open(full_path, 'r') as f:
        return f.read()","def get_user_file(username, filepath):
    import os
    base_path = f""/home/{username}/files/""
    full_path = base_path + filepath
    with open(full_path, 'r') as f:
        return f.read()",python,1
Out-of-Bounds,"#include <iostream>

class UnsafeClass {
    int data[10];
public:
    int get_data(int index) {
        return data[index]; // no bounds checking
    }
};","#include <iostream>

class UnsafeClass {
    int data[10];
public:
    int get_data(int index) {
        return data[index]; // no bounds checking
    }
};",cpp,1
Clear,"import os
def secure_file_access(username, filepath):
    base_dir = f""/home/{username}/files/""
    full_path = os.path.join(base_dir, filepath)
    full_path = os.path.normpath(full_path)
    if not full_path.startswith(base_dir):
        raise PermissionError(""Access denied"")
    with open(full_path, 'r') as f:
        return f.read()","import os
def secure_file_access(username, filepath):
    base_dir = f""/home/{username}/files/""
    full_path = os.path.join(base_dir, filepath)
    full_path = os.path.normpath(full_path)
    if not full_path.startswith(base_dir):
        raise PermissionError(""Access denied"")
    with open(full_path, 'r') as f:
        return f.read()",python,0
Clear,"#include <stdio.h>
#include <stdlib.h>

int safe_string_to_int(const char *str) {
    char *endptr;
    long value = strtol(str, &endptr, 10);
    if (*endptr != '\0' || str == endptr) {
        return -1; // error
    }
    return (int)value;
}","#include <stdio.h>
#include <stdlib.h>

int safe_string_to_int(const char *str) {
    char *endptr;
    long value = strtol(str, &endptr, 10);
    if (*endptr != '\0' || str == endptr) {
        return -1; // error
    }
    return (int)value;
}",c,0
Clear,"<?php
$username = $_POST['username'];
$stmt = $pdo->prepare(""SELECT * FROM users WHERE username = ?"");
$stmt->execute([$username]); // Parameterized query
?>","<?php
$username = $_POST['username'];
$stmt = $pdo->prepare(""SELECT * FROM users WHERE username = ?"");
$stmt->execute([$username]); // Parameterized query
?>",php,0
Clear,"const token = process.env.API_TOKEN; // Environment variable
fetch('/api/data', {
    headers: { 'Authorization': `Bearer ${token}` }
});
","const token = process.env.API_TOKEN; // Environment variable
fetch('/api/data', {
    headers: { 'Authorization': `Bearer ${token}` }
});
",javascript,0
Clear,"To prevent Command Injection vulnerabilities in the given Java code, you should sanitize and validate user input before constructing and executing the command. Here's an example of how you can improve the code by implementing proper security measures:

```java
import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class SecureCommandInjectionExample {
    public static void main(String[] args) throws IOException {
        BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));
        
        System.out.print(""Enter the IP address to ping: "");
        String ipAddress = reader.readLine();
        
        // Validate user input to ensure it is a valid IP address
        if (!isValidIpAddress(ipAddress)) {
            System.out.println(""Invalid IP address provided."");
            return;
        }
        
        // Construct the command using ProcessBuilder with sanitized arguments
        ProcessBuilder processBuilder = new ProcessBuilder(""ping"", ""-c"", ""3"", ipAddress);
        
        Process process = processBuilder.start();
        
        BufferedReader inputStreamReader = new BufferedReader(new InputStreamReader(process.getInputStream()));
        String line;
        
        while ((line = inputStreamReader.readLine()) != null) {
            System.out.println(line);
        }
    }
    
    // Method to validate if the input is a valid IP address
    private","To prevent Command Injection vulnerabilities in the given Java code, you should sanitize and validate user input before constructing and executing the command. Here's an example of how you can improve the code by implementing proper security measures: ```java import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class SecureCommandInjectionExample { public static void main(String[] args) throws IOException { BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter the IP address to ping: ""); String ipAddress = reader.readLine(); // Validate user input to ensure it is a valid IP address if (!isValidIpAddress(ipAddress)) { System.out.println(""Invalid IP address provided.""); return; } // Construct the command using ProcessBuilder with sanitized arguments ProcessBuilder processBuilder = new ProcessBuilder(""ping"", ""-c"", ""3"", ipAddress); Process process = processBuilder.start(); BufferedReader inputStreamReader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = inputStreamReader.readLine()) != null) { System.out.println(line); } } // Method to validate if the input is a valid IP address private",java,0
Cross-Site Scripting (XSS),"import java.io.*;

public class XSSVulnerableCode {

    public static void main(String[] args) {
        // Simulating user input
        String userInput = ""<script>alert('XSS Vulnerability')</script>"";

        // Improperly handling user input by directly outputting it to a webpage
        System.out.println(""<div>"" + userInput + ""</div>"");
    }
}","import java.io.*; public class XSSVulnerableCode { public static void main(String[] args) { // Simulating user input String userInput = ""<script>alert('XSS Vulnerability')</script>""; // Improperly handling user input by directly outputting it to a webpage System.out.println(""<div>"" + userInput + ""</div>""); } }",java,1
Clear,"import java.sql.*;

public class SecureCode {
    public static void main(String[] args) {
        String userInput = args[0];

        try {
            Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");

            // Use a PreparedStatement with parameterized query
            String query = ""SELECT * FROM users WHERE username=?"";
            PreparedStatement pstmt = conn.prepareStatement(query);
            pstmt.setString(1, userInput);

            ResultSet rs = pstmt.executeQuery();

            while (rs.next()) {
                System.out.println(rs.getString(""username""));
            }

            conn.close();
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.*; public class SecureCode { public static void main(String[] args) { String userInput = args[0]; try { Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); // Use a PreparedStatement with parameterized query String query = ""SELECT * FROM users WHERE username=?""; PreparedStatement pstmt = conn.prepareStatement(query); pstmt.setString(1, userInput); ResultSet rs = pstmt.executeQuery(); while (rs.next()) { System.out.println(rs.getString(""username"")); } conn.close(); } catch (SQLException e) { e.printStackTrace(); } } }",java,0
Path Traversal,"import os
def read_file(filename):
    with open('/var/www/uploads/' + filename, 'r') as f:
        return f.read()","import os
def read_file(filename):
    with open('/var/www/uploads/' + filename, 'r') as f:
        return f.read()",python,1
Hardcoded Secrets,"import requests
def call_api():
    api_key = ""sk_live_1234567890abcdef""
    headers = {'Authorization': f'Bearer {api_key}'}
    return requests.get('https://api.example.com/data', headers=headers)","import requests
def call_api():
    api_key = ""sk_live_1234567890abcdef""
    headers = {'Authorization': f'Bearer {api_key}'}
    return requests.get('https://api.example.com/data', headers=headers)",python,1
Command Injection,"import os
def backup_database(db_name):
    os.system(f""pg_dump {db_name} > backup.sql"")","import os
def backup_database(db_name):
    os.system(f""pg_dump {db_name} > backup.sql"")",python,1
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Clear,"app.get('/user/:id', (req, res) => {
    const userId = parseInt(req.params.id);
    db.query('SELECT * FROM users WHERE id = ?', [userId], (err, result) => {
        res.json(result);
    });
});
","app.get('/user/:id', (req, res) => {
    const userId = parseInt(req.params.id);
    db.query('SELECT * FROM users WHERE id = ?', [userId], (err, result) => {
        res.json(result);
    });
});
",javascript,0
Clear,"import json
def parse_safe_json(json_str):
    try:
        return json.loads(json_str)
    except json.JSONDecodeError:
        raise ValueError(""Invalid JSON"")","import json
def parse_safe_json(json_str):
    try:
        return json.loads(json_str)
    except json.JSONDecodeError:
        raise ValueError(""Invalid JSON"")",python,0
Buffer Overflow,"#include <iostream>
#include <cstdio>

void unsafe_c_input() {
    char buffer[50];
    scanf(""%s"", buffer); // no length limit
    std::cout << buffer << std::endl;
}","#include <iostream>
#include <cstdio>

void unsafe_c_input() {
    char buffer[50];
    scanf(""%s"", buffer); // no length limit
    std::cout << buffer << std::endl;
}",cpp,1
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Clear,"#include <iostream>
#include <fstream>
#include <string>

void safe_file_reading(const std::string& filename) {
    std::ifstream file(filename);
    if (file.is_open()) {
        std::string line;
        while (std::getline(file, line)) {
            std::cout << line << std::endl;
        }
    }
}","#include <iostream>
#include <fstream>
#include <string>

void safe_file_reading(const std::string& filename) {
    std::ifstream file(filename);
    if (file.is_open()) {
        std::string line;
        while (std::getline(file, line)) {
            std::cout << line << std::endl;
        }
    }
}",cpp,0
Clear,"app.get('/user/:id', (req, res) => {
    const userId = parseInt(req.params.id);
    db.query('SELECT * FROM users WHERE id = ?', [userId], (err, result) => {
        res.json(result);
    });
});
","app.get('/user/:id', (req, res) => {
    const userId = parseInt(req.params.id);
    db.query('SELECT * FROM users WHERE id = ?', [userId], (err, result) => {
        res.json(result);
    });
});
",javascript,0
Clear,"To fix the SQL Injection vulnerability in the given Java code snippet, you should use PreparedStatements instead of directly concatenating user input into the SQL query. PreparedStatements provide a way to create parameterized queries and automatically handle escaping of user input, thus preventing SQL Injection attacks.

Here is the modified code with the necessary security measures in place:

```java
import java.sql.*;

public class SecureSQLInjectionPrevention {
    public static void main(String[] args) {
        try {
            // Simulating user input (which should never be concatenated directly into the query)
            String userInput = ""'; DROP TABLE users; --"";

            String url = ""jdbc:mysql://localhost:3306/mydatabase"";
            String username = ""root"";
            String password = ""password"";

            Connection connection = DriverManager.getConnection(url, username, password);

            // Use PreparedStatement to prevent SQL Injection
            String query = ""SELECT * FROM users WHERE username=?"";
            PreparedStatement preparedStatement = connection.prepareStatement(query);
            
            // Set parameter for the PreparedStatement
            preparedStatement.setString(1, userInput);

            ResultSet resultSet = preparedStatement.executeQuery();

            while(resultSet.next()) {
                System.out.println(resultSet.getString(""username""));
            }

        } catch (SQLException e) {
            e.printStackTrace();
        }","To fix the SQL Injection vulnerability in the given Java code snippet, you should use PreparedStatements instead of directly concatenating user input into the SQL query. PreparedStatements provide a way to create parameterized queries and automatically handle escaping of user input, thus preventing SQL Injection attacks. Here is the modified code with the necessary security measures in place: ```java import java.sql.*; public class SecureSQLInjectionPrevention { public static void main(String[] args) { try { // Simulating user input (which should never be concatenated directly into the query) String userInput = ""'; DROP TABLE users; --""; String url = ""jdbc:mysql://localhost:3306/mydatabase""; String username = ""root""; String password = ""password""; Connection connection = DriverManager.getConnection(url, username, password); // Use PreparedStatement to prevent SQL Injection String query = ""SELECT * FROM users WHERE username=?""; PreparedStatement preparedStatement = connection.prepareStatement(query); // Set parameter for the PreparedStatement preparedStatement.setString(1, userInput); ResultSet resultSet = preparedStatement.executeQuery(); while(resultSet.next()) { System.out.println(resultSet.getString(""username"")); } } catch (SQLException e) { e.printStackTrace(); }",java,0
SSRF,"import urllib.request
def download_file(file_url):
    return urllib.request.urlopen(file_url).read()","import urllib.request
def download_file(file_url):
    return urllib.request.urlopen(file_url).read()",python,1
Clear,"app.get('/user/:id', (req, res) => {
    const userId = parseInt(req.params.id);
    db.query('SELECT * FROM users WHERE id = ?', [userId], (err, result) => {
        res.json(result);
    });
});
","app.get('/user/:id', (req, res) => {
    const userId = parseInt(req.params.id);
    db.query('SELECT * FROM users WHERE id = ?', [userId], (err, result) => {
        res.json(result);
    });
});
",javascript,0
Clear,"#include <stdio.h>
#include <stdlib.h>

int safe_string_to_int(const char *str) {
    char *endptr;
    long value = strtol(str, &endptr, 10);
    if (*endptr != '\0' || str == endptr) {
        return -1; // error
    }
    return (int)value;
}","#include <stdio.h>
#include <stdlib.h>

int safe_string_to_int(const char *str) {
    char *endptr;
    long value = strtol(str, &endptr, 10);
    if (*endptr != '\0' || str == endptr) {
        return -1; // error
    }
    return (int)value;
}",c,0
Buffer Overflow,"import java.util.Scanner;

public class BufferOverflowVulnerability {
    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        
        System.out.print(""Enter a string: "");
        String input = scanner.nextLine();
        
        char[] buffer = new char[10];
        input.getChars(0, input.length(), buffer, 0);
        
        System.out.println(""Buffer content: "" + new String(buffer));
    }
}","import java.util.Scanner; public class BufferOverflowVulnerability { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter a string: ""); String input = scanner.nextLine(); char[] buffer = new char[10]; input.getChars(0, input.length(), buffer, 0); System.out.println(""Buffer content: "" + new String(buffer)); } }",java,1
Clear,"#include <iostream>
#include <fstream>
#include <string>

void safe_file_reading(const std::string& filename) {
    std::ifstream file(filename);
    if (file.is_open()) {
        std::string line;
        while (std::getline(file, line)) {
            std::cout << line << std::endl;
        }
    }
}","#include <iostream>
#include <fstream>
#include <string>

void safe_file_reading(const std::string& filename) {
    std::ifstream file(filename);
    if (file.is_open()) {
        std::string line;
        while (std::getline(file, line)) {
            std::cout << line << std::endl;
        }
    }
}",cpp,0
Clear,"import java.util.Scanner;

public class SecureBufferCopy {
    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        
        System.out.print(""Enter your name: "");
        String name = scanner.nextLine();
        
        int maxLength = Math.min(name.length(), 10); // Limit input to 10 characters
        char[] buffer = new char[maxLength];
        
        for (int i = 0; i < maxLength; i++) {
            buffer[i] = name.charAt(i);
        }
        
        System.out.println(""Buffer overflow vulnerability fixed!"");
    }
}","import java.util.Scanner; public class SecureBufferCopy { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter your name: ""); String name = scanner.nextLine(); int maxLength = Math.min(name.length(), 10); // Limit input to 10 characters char[] buffer = new char[maxLength]; for (int i = 0; i < maxLength; i++) { buffer[i] = name.charAt(i); } System.out.println(""Buffer overflow vulnerability fixed!""); } }",java,0
Clear,"import subprocess
def safe_directory_listing(path):
    result = subprocess.run(['ls', path], capture_output=True, text=True)
    return result.stdout","import subprocess
def safe_directory_listing(path):
    result = subprocess.run(['ls', path], capture_output=True, text=True)
    return result.stdout",python,0
Clear,"#include <stdio.h>
#include <string.h>

int safe_buffer_operation(char *input) {
    char buffer[100];
    if (strlen(input) < sizeof(buffer)) {
        strcpy(buffer, input);
        return 0;
    }
    return -1; // buffer too small
}","#include <stdio.h>
#include <string.h>

int safe_buffer_operation(char *input) {
    char buffer[100];
    if (strlen(input) < sizeof(buffer)) {
        strcpy(buffer, input);
        return 0;
    }
    return -1; // buffer too small
}",c,0
Clear,"import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;

public class SecureSQLInjectionCode {

    public static void main(String[] args) {
        String userInput = ""'; DROP TABLE users; --"";

        try (Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"")) {
            String query = ""SELECT * FROM users WHERE username = ?"";
            try (PreparedStatement stmt = conn.prepareStatement(query)) {
                stmt.setString(1, userInput);
                try (ResultSet rs = stmt.executeQuery()) {
                    while (rs.next()) {
                        System.out.println(""User found: "" + rs.getString(""username""));
                    }
                }
            }
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.Connection; import java.sql.DriverManager; import java.sql.PreparedStatement; import java.sql.ResultSet; import java.sql.SQLException; public class SecureSQLInjectionCode { public static void main(String[] args) { String userInput = ""'; DROP TABLE users; --""; try (Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"")) { String query = ""SELECT * FROM users WHERE username = ?""; try (PreparedStatement stmt = conn.prepareStatement(query)) { stmt.setString(1, userInput); try (ResultSet rs = stmt.executeQuery()) { while (rs.next()) { System.out.println(""User found: "" + rs.getString(""username"")); } } } } catch (SQLException e) { e.printStackTrace(); } } }",java,0
SQL Injection,"app.get('/user/:id', (req, res) => {
    const query = `SELECT * FROM users WHERE id = ${req.params.id}`; // SQL Injection
    db.query(query, (err, result) => {
        res.json(result);
    });
});
","app.get('/user/:id', (req, res) => {
    const query = `SELECT * FROM users WHERE id = ${req.params.id}`; // SQL Injection
    db.query(query, (err, result) => {
        res.json(result);
    });
});
",javascript,1
File Inclusion,"<?php
$file = $_GET['file'];
include($file); // File Inclusion
?>","<?php
$file = $_GET['file'];
include($file); // File Inclusion
?>",php,1
Clear,"To fix the insecure deserialization vulnerability in the provided code snippet, you can implement proper security measures to prevent malicious code execution. Here are some recommendations for secure deserialization in Java:

1. **Use a Secure Deserialization Framework**: Consider using a secure deserialization framework like Apache Commons Collections (versions 4.x) or Google's GSON library. These frameworks provide mechanisms to prevent common deserialization vulnerabilities.

2. **Implement Input Validation**: Validate the deserialized data before using it to prevent unexpected behavior. Check data integrity, size limits, and enforce strict input validation rules.

3. **Whitelist Classes**: Restrict the classes that can be deserialized by using a whitelist approach instead of allowing all classes to be deserialized. This helps prevent the instantiation of malicious classes.

4. **Implement Serialization Filters**: Use serialization filters (e.g., `ObjectInputFilter` in Java 9 and later) to define constraints on which classes can be deserialized and limit object graph depth.

5. **Use Signed Serialized Objects**: Sign serialized objects with digital signatures to ensure their authenticity and integrity during deserialization.

6. **Avoid using Serializable Interface**: Prefer using alternative serialization mechanisms like JSON or XML serialization over Java's default serialization mechanism whenever possible.

Here is","To fix the insecure deserialization vulnerability in the provided code snippet, you can implement proper security measures to prevent malicious code execution. Here are some recommendations for secure deserialization in Java: 1. **Use a Secure Deserialization Framework**: Consider using a secure deserialization framework like Apache Commons Collections (versions 4.x) or Google's GSON library. These frameworks provide mechanisms to prevent common deserialization vulnerabilities. 2. **Implement Input Validation**: Validate the deserialized data before using it to prevent unexpected behavior. Check data integrity, size limits, and enforce strict input validation rules. 3. **Whitelist Classes**: Restrict the classes that can be deserialized by using a whitelist approach instead of allowing all classes to be deserialized. This helps prevent the instantiation of malicious classes. 4. **Implement Serialization Filters**: Use serialization filters (e.g., `ObjectInputFilter` in Java 9 and later) to define constraints on which classes can be deserialized and limit object graph depth. 5. **Use Signed Serialized Objects**: Sign serialized objects with digital signatures to ensure their authenticity and integrity during deserialization. 6. **Avoid using Serializable Interface**: Prefer using alternative serialization mechanisms like JSON or XML serialization over Java's default serialization mechanism whenever possible. Here is",php,0
Clear,"import java.io.*;
import javax.servlet.*;
import javax.servlet.http.*;
import org.owasp.encoder.Encode;

public class XSSFixedServlet extends HttpServlet {
    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        String userInput = request.getParameter(""input"");
        PrintWriter out = response.getWriter();
        
        // Properly encoding user input to prevent XSS
        out.println(""<html>"");
        out.println(""<body>"");
        out.println(""<h1>Hello, "" + Encode.forHtml(userInput) + ""</h1>""); // Encoding user input before embedding in HTML
        out.println(""</body>"");
        out.println(""</html>"");
    }
}","import java.io.*; import javax.servlet.*; import javax.servlet.http.*; import org.owasp.encoder.Encode; public class XSSFixedServlet extends HttpServlet { protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { String userInput = request.getParameter(""input""); PrintWriter out = response.getWriter(); // Properly encoding user input to prevent XSS out.println(""<html>""); out.println(""<body>""); out.println(""<h1>Hello, "" + Encode.forHtml(userInput) + ""</h1>""); // Encoding user input before embedding in HTML out.println(""</body>""); out.println(""</html>""); } }",java,0
Clear,"#include <iostream>
#include <vector>
#include <stdexcept>

int safe_vector_access(const std::vector<int>& vec, size_t index) {
    if (index >= vec.size()) {
        throw std::out_of_range(""Index out of range"");
    }
    return vec[index];
}","#include <iostream>
#include <vector>
#include <stdexcept>

int safe_vector_access(const std::vector<int>& vec, size_t index) {
    if (index >= vec.size()) {
        throw std::out_of_range(""Index out of range"");
    }
    return vec[index];
}",cpp,0
Clear,"#include <stdio.h>
#include <stdlib.h>

int safe_string_to_int(const char *str) {
    char *endptr;
    long value = strtol(str, &endptr, 10);
    if (*endptr != '\0' || str == endptr) {
        return -1; // error
    }
    return (int)value;
}","#include <stdio.h>
#include <stdlib.h>

int safe_string_to_int(const char *str) {
    char *endptr;
    long value = strtol(str, &endptr, 10);
    if (*endptr != '\0' || str == endptr) {
        return -1; // error
    }
    return (int)value;
}",c,0
Clear,"#include <iostream>
#include <fstream>
#include <string>

void safe_file_reading(const std::string& filename) {
    std::ifstream file(filename);
    if (file.is_open()) {
        std::string line;
        while (std::getline(file, line)) {
            std::cout << line << std::endl;
        }
    }
}","#include <iostream>
#include <fstream>
#include <string>

void safe_file_reading(const std::string& filename) {
    std::ifstream file(filename);
    if (file.is_open()) {
        std::string line;
        while (std::getline(file, line)) {
            std::cout << line << std::endl;
        }
    }
}",cpp,0
Clear,"const token = process.env.API_TOKEN; // Environment variable
fetch('/api/data', {
    headers: { 'Authorization': `Bearer ${token}` }
});
","const token = process.env.API_TOKEN; // Environment variable
fetch('/api/data', {
    headers: { 'Authorization': `Bearer ${token}` }
});
",javascript,0
Clear,"import hashlib
import os

def hash_password(password):
    salt = os.urandom(32)
    key = hashlib.pbkdf2_hmac('sha256', password.encode(), salt, 100000)
    return salt + key","import hashlib
import os

def hash_password(password):
    salt = os.urandom(32)
    key = hashlib.pbkdf2_hmac('sha256', password.encode(), salt, 100000)
    return salt + key",python,0
Clear,"import java.util.Scanner;

public class SecureBufferExample {
    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);

        System.out.println(""Enter a string:"");
        String input = scanner.nextLine();

        if (input.length() > 10) {
            System.out.println(""Input string is too long."");
            return;
        }

        char[] buffer = new char[10];
        input.getChars(0, Math.min(input.length(), 10), buffer, 0);

        System.out.println(""Buffer contents: "" + new String(buffer));
    }
}","import java.util.Scanner; public class SecureBufferExample { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.println(""Enter a string:""); String input = scanner.nextLine(); if (input.length() > 10) { System.out.println(""Input string is too long.""); return; } char[] buffer = new char[10]; input.getChars(0, Math.min(input.length(), 10), buffer, 0); System.out.println(""Buffer contents: "" + new String(buffer)); } }",java,0
Clear,"To fix this code and make it more secure against Insecure Deserialization vulnerabilities, you should implement proper input validation, use safe deserialization techniques, and apply other security best practices. Here's an improved version of the code:

```java
import java.io.*;
import java.util.Base64;

public class SecureDeserializationExample {

    public static void main(String[] args) {
        try {
            // Assume userInput is provided by the user (e.g., from a network or file)
            String userInput = ""cGF5bG9hZA==""; // Base64 encoded serialized object

            // Validate and decode user input
            byte[] decodedInput = Base64.getDecoder().decode(userInput);
            
            // Use a safer deserialization mechanism (e.g., using JSON or XML instead of Java serialization)
            String deserializedString = deserializeString(decodedInput);

            if (deserializedString != null) {
                System.out.println(""Deserialized string: "" + deserializedString);
                // Perform safe operations with the deserialized object here
            } else {
                System.out.println(""Invalid or unsupported input format"");
            }

        } catch (Exception e) {
            System.out.println(""Error occurred during deserialization: "" +","To fix this code and make it more secure against Insecure Deserialization vulnerabilities, you should implement proper input validation, use safe deserialization techniques, and apply other security best practices. Here's an improved version of the code: ```java import java.io.*; import java.util.Base64; public class SecureDeserializationExample { public static void main(String[] args) { try { // Assume userInput is provided by the user (e.g., from a network or file) String userInput = ""cGF5bG9hZA==""; // Base64 encoded serialized object // Validate and decode user input byte[] decodedInput = Base64.getDecoder().decode(userInput); // Use a safer deserialization mechanism (e.g., using JSON or XML instead of Java serialization) String deserializedString = deserializeString(decodedInput); if (deserializedString != null) { System.out.println(""Deserialized string: "" + deserializedString); // Perform safe operations with the deserialized object here } else { System.out.println(""Invalid or unsupported input format""); } } catch (Exception e) { System.out.println(""Error occurred during deserialization: "" +",java,0
Buffer Overflow,"import java.util.Scanner;

public class BufferOverflowVulnerability {
    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        
        System.out.print(""Enter your name: "");
        String name = scanner.next();
        
        // Simulating a buffer overflow vulnerability by creating a fixed-size array
        char[] buffer = new char[10];
        for (int i = 0; i < name.length(); i++) {
            buffer[i] = name.charAt(i);
        }
        
        System.out.println(""Hello, "" + new String(buffer));
    }
}","import java.util.Scanner; public class BufferOverflowVulnerability { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter your name: ""); String name = scanner.next(); // Simulating a buffer overflow vulnerability by creating a fixed-size array char[] buffer = new char[10]; for (int i = 0; i < name.length(); i++) { buffer[i] = name.charAt(i); } System.out.println(""Hello, "" + new String(buffer)); } }",java,1
Cross-Site Scripting (XSS),"import java.io.IOException;
import java.io.PrintWriter;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

public class XSSVulnerableServlet extends HttpServlet {
    
    @Override
    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws IOException {
        String userInput = request.getParameter(""input"");
        
        response.setContentType(""text/html"");
        PrintWriter out = response.getWriter();
        
        out.println(""<html>"");
        out.println(""<head><title>XSS Vulnerable Page</title></head>"");
        out.println(""<body>"");
        
        // Vulnerability: User input is directly embedded in the HTML response without proper encoding
        out.println(""<h1>Welcome "" + userInput + ""</h1>"");
        
        out.println(""</body>"");
        out.println(""</html>"");
    }
}","import java.io.IOException; import java.io.PrintWriter; import javax.servlet.http.HttpServlet; import javax.servlet.http.HttpServletRequest; import javax.servlet.http.HttpServletResponse; public class XSSVulnerableServlet extends HttpServlet { @Override protected void doGet(HttpServletRequest request, HttpServletResponse response) throws IOException { String userInput = request.getParameter(""input""); response.setContentType(""text/html""); PrintWriter out = response.getWriter(); out.println(""<html>""); out.println(""<head><title>XSS Vulnerable Page</title></head>""); out.println(""<body>""); // Vulnerability: User input is directly embedded in the HTML response without proper encoding out.println(""<h1>Welcome "" + userInput + ""</h1>""); out.println(""</body>""); out.println(""</html>""); } }",java,1
Clear,"#include <iostream>
#include <string>
#include <vector>

void safe_string_handling(const std::string& input) {
    std::string safe_copy = input;
    std::cout << safe_copy << std::endl;
}","#include <iostream>
#include <string>
#include <vector>

void safe_string_handling(const std::string& input) {
    std::string safe_copy = input;
    std::cout << safe_copy << std::endl;
}",cpp,0
SQL Injection,"String userInput = ""Alice'; DROP TABLE Users; --""; // Malicious input simulating SQL Injection

String sqlQuery = ""SELECT * FROM Users WHERE username = '"" + userInput + ""'"";

// Execute the SQL query using JDBC or any other database interaction method
// This code is vulnerable to SQL Injection because the userInput is directly concatenated into the query","String userInput = ""Alice'; DROP TABLE Users; --""; // Malicious input simulating SQL Injection String sqlQuery = ""SELECT * FROM Users WHERE username = '"" + userInput + ""'""; // Execute the SQL query using JDBC or any other database interaction method // This code is vulnerable to SQL Injection because the userInput is directly concatenated into the query",php,1
Command Injection,"import os
def ping_host(host):
    os.system(""ping -c 4 "" + host)","import os
def ping_host(host):
    os.system(""ping -c 4 "" + host)",python,1
Clear,"import yaml
def safe_yaml_load(config_str):
    return yaml.safe_load(config_str)","import yaml
def safe_yaml_load(config_str):
    return yaml.safe_load(config_str)",python,0
Buffer Overflow,"#include <iostream>
#include <cstring>

void unsafe_c_string(char* input) {
    char buffer[100];
    strcpy(buffer, input); // potential buffer overflow
    std::cout << buffer << std::endl;
}","#include <iostream>
#include <cstring>

void unsafe_c_string(char* input) {
    char buffer[100];
    strcpy(buffer, input); // potential buffer overflow
    std::cout << buffer << std::endl;
}",cpp,1
SSRF,"import requests
def fetch_url(url):
    return requests.get(url).text","import requests
def fetch_url(url):
    return requests.get(url).text",python,1
Clear,"import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class SecureCommandExecution {
    public static void main(String[] args) {
        try {
            BufferedReader br = new BufferedReader(new InputStreamReader(System.in));
            System.out.print(""Enter a file name to display its content: "");
            String fileName = br.readLine();

            // Use ProcessBuilder for command execution
            ProcessBuilder processBuilder = new ProcessBuilder(""cat"", fileName);
            Process process = processBuilder.start();

            BufferedReader reader = new BufferedReader(new InputStreamReader(process.getInputStream()));
            String line;
            while ((line = reader.readLine()) != null) {
                System.out.println(line);
            }

        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}","import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class SecureCommandExecution { public static void main(String[] args) { try { BufferedReader br = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a file name to display its content: ""); String fileName = br.readLine(); // Use ProcessBuilder for command execution ProcessBuilder processBuilder = new ProcessBuilder(""cat"", fileName); Process process = processBuilder.start(); BufferedReader reader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = reader.readLine()) != null) { System.out.println(line); } } catch (IOException e) { e.printStackTrace(); } } }",java,0
XSS,"<?php
echo $_GET['message']; // XSS
?>","<?php
echo $_GET['message']; // XSS
?>",php,1
Clear,"import java.io.*;
import javax.servlet.*;
import javax.servlet.http.*;
import org.owasp.encoder.Encode;

public class WelcomeServlet extends HttpServlet {
    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        response.setContentType(""text/html"");
        PrintWriter out = response.getWriter();

        String username = request.getParameter(""username"");
        String sanitizedUsername = Encode.forHtml(username); // Sanitize user input

        out.println(""<h2>Welcome, "" + sanitizedUsername + ""!</h2>"");
    }
}","import java.io.*; import javax.servlet.*; import javax.servlet.http.*; import org.owasp.encoder.Encode; public class WelcomeServlet extends HttpServlet { protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { response.setContentType(""text/html""); PrintWriter out = response.getWriter(); String username = request.getParameter(""username""); String sanitizedUsername = Encode.forHtml(username); // Sanitize user input out.println(""<h2>Welcome, "" + sanitizedUsername + ""!</h2>""); } }",java,0
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Clear,"<?php
$username = $_POST['username'];
$stmt = $pdo->prepare(""SELECT * FROM users WHERE username = ?"");
$stmt->execute([$username]); // Parameterized query
?>","<?php
$username = $_POST['username'];
$stmt = $pdo->prepare(""SELECT * FROM users WHERE username = ?"");
$stmt->execute([$username]); // Parameterized query
?>",php,0
Code Injection,"const userData = eval('(' + userInput + ')'); // eval injection
","const userData = eval('(' + userInput + ')'); // eval injection
",javascript,1
Clear,"#include <stdio.h>
#include <string.h>

int validate_input(const char *input) {
    if (input == NULL) return 0;
    for (int i = 0; input[i] != '\0'; i++) {
        if (input[i] < 32 || input[i] > 126) {
            return 0; // invalid character
        }
    }
    return 1;
}","#include <stdio.h>
#include <string.h>

int validate_input(const char *input) {
    if (input == NULL) return 0;
    for (int i = 0; input[i] != '\0'; i++) {
        if (input[i] < 32 || input[i] > 126) {
            return 0; // invalid character
        }
    }
    return 1;
}",c,0
Memory Corruption,"#include <iostream>

void unsafe_pointer_arithmetic(int* array, int size) {
    for (int i = 0; i <= size; i++) {
        std::cout << *(array + i) << std::endl; // potential out-of-bounds
    }
}","#include <iostream>

void unsafe_pointer_arithmetic(int* array, int size) {
    for (int i = 0; i <= size; i++) {
        std::cout << *(array + i) << std::endl; // potential out-of-bounds
    }
}",cpp,1
Clear,"import java.io.IOException;
import java.io.PrintWriter;
import org.owasp.encoder.Encode;

public class XSSFixedCode {

    public static void main(String[] args) {
        // Simulating user input from a form field
        String userInput = ""<script>alert('XSS Vulnerability!')</script>"";

        // Properly handling user input by escaping it before outputting to the response
        try {
            PrintWriter out = new PrintWriter(""output.html"");
            out.println(""<html>"");
            out.println(""<body>"");
            out.println(""<h1>Welcome "" + Encode.forHtml(userInput) + ""</h1>"");
            out.println(""</body>"");
            out.println(""</html>"");
            out.close();
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}","import java.io.IOException; import java.io.PrintWriter; import org.owasp.encoder.Encode; public class XSSFixedCode { public static void main(String[] args) { // Simulating user input from a form field String userInput = ""<script>alert('XSS Vulnerability!')</script>""; // Properly handling user input by escaping it before outputting to the response try { PrintWriter out = new PrintWriter(""output.html""); out.println(""<html>""); out.println(""<body>""); out.println(""<h1>Welcome "" + Encode.forHtml(userInput) + ""</h1>""); out.println(""</body>""); out.println(""</html>""); out.close(); } catch (IOException e) { e.printStackTrace(); } } }",java,0
Clear,"app.get('/user/:id', (req, res) => {
    const userId = parseInt(req.params.id);
    db.query('SELECT * FROM users WHERE id = ?', [userId], (err, result) => {
        res.json(result);
    });
});
","app.get('/user/:id', (req, res) => {
    const userId = parseInt(req.params.id);
    db.query('SELECT * FROM users WHERE id = ?', [userId], (err, result) => {
        res.json(result);
    });
});
",javascript,0
Insecure Deserialization,"<?php
$data = $_POST['data'];
unserialize($data); // Insecure Deserialization
?>","<?php
$data = $_POST['data'];
unserialize($data); // Insecure Deserialization
?>",php,1
Command Injection,"<?php
$cmd = $_GET['cmd'];
system($cmd); // Command Injection
?>","<?php
$cmd = $_GET['cmd'];
system($cmd); // Command Injection
?>",php,1
Clear,"import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;

public class SecureSQLCode {

    public static void main(String[] args) {
        String userInput = ""'; DROP TABLE users; --"";

        try {
            Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");

            String query = ""SELECT * FROM users WHERE username=?"";
            PreparedStatement pstmt = conn.prepareStatement(query);
            pstmt.setString(1, userInput);

            ResultSet rs = pstmt.executeQuery();

            while (rs.next()) {
                System.out.println(""Username: "" + rs.getString(""username""));
            }

            rs.close();
            pstmt.close();
            conn.close();

        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.Connection; import java.sql.DriverManager; import java.sql.PreparedStatement; import java.sql.ResultSet; import java.sql.SQLException; public class SecureSQLCode { public static void main(String[] args) { String userInput = ""'; DROP TABLE users; --""; try { Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); String query = ""SELECT * FROM users WHERE username=?""; PreparedStatement pstmt = conn.prepareStatement(query); pstmt.setString(1, userInput); ResultSet rs = pstmt.executeQuery(); while (rs.next()) { System.out.println(""Username: "" + rs.getString(""username"")); } rs.close(); pstmt.close(); conn.close(); } catch (SQLException e) { e.printStackTrace(); } } }",java,0
Memory Corruption,"#include <iostream>

void unsafe_pointer_arithmetic(int* array, int size) {
    for (int i = 0; i <= size; i++) {
        std::cout << *(array + i) << std::endl; // potential out-of-bounds
    }
}","#include <iostream>

void unsafe_pointer_arithmetic(int* array, int size) {
    for (int i = 0; i <= size; i++) {
        std::cout << *(array + i) << std::endl; // potential out-of-bounds
    }
}",cpp,1
Clear,"const shell = require('child_process');
const safeInput = userInput.replace(/[^a-zA-Z0-9.]/g, '');
shell.execFile('ping', [safeInput]); // Safe command execution
","const shell = require('child_process');
const safeInput = userInput.replace(/[^a-zA-Z0-9.]/g, '');
shell.execFile('ping', [safeInput]); // Safe command execution
",javascript,0
Buffer Overflow,"import java.util.Scanner;

public class BufferOverflowExample {

    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        
        System.out.print(""Enter your name: "");
        String name = scanner.nextLine();
        
        // Creating a buffer of fixed size
        char[] buffer = new char[10];
        
        // Copying the user input into the buffer without proper bounds checking
        for (int i = 0; i < name.length(); i++) {
            buffer[i] = name.charAt(i);
        }
        
        System.out.println(""Buffer overflow example completed."");
    }
}","import java.util.Scanner; public class BufferOverflowExample { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter your name: ""); String name = scanner.nextLine(); // Creating a buffer of fixed size char[] buffer = new char[10]; // Copying the user input into the buffer without proper bounds checking for (int i = 0; i < name.length(); i++) { buffer[i] = name.charAt(i); } System.out.println(""Buffer overflow example completed.""); } }",java,1
Buffer Overflow,"import java.util.Scanner;

public class BufferOverflowVulnerability {
    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        System.out.print(""Enter a string: "");
        String input = scanner.nextLine();

        // Vulnerable code - not checking input length before copying to buffer
        char[] buffer = new char[10];
        input.getChars(0, input.length(), buffer, 0);

        System.out.println(""Input successfully copied to buffer."");
    }
}","import java.util.Scanner; public class BufferOverflowVulnerability { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter a string: ""); String input = scanner.nextLine(); // Vulnerable code - not checking input length before copying to buffer char[] buffer = new char[10]; input.getChars(0, input.length(), buffer, 0); System.out.println(""Input successfully copied to buffer.""); } }",java,1
Cross-Site Scripting (XSS),"import java.io.*;
import javax.servlet.*;
import javax.servlet.http.*;

public class XSSExample extends HttpServlet {
    protected void doGet(HttpServletRequest request, HttpServletResponse response)
            throws ServletException, IOException {
        String userInput = request.getParameter(""input"");
        
        String htmlResponse = ""<html><body>User Input: "" + userInput + ""</body></html>"";
        
        PrintWriter out = response.getWriter();
        out.println(htmlResponse);
    }
}","import java.io.*; import javax.servlet.*; import javax.servlet.http.*; public class XSSExample extends HttpServlet { protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { String userInput = request.getParameter(""input""); String htmlResponse = ""<html><body>User Input: "" + userInput + ""</body></html>""; PrintWriter out = response.getWriter(); out.println(htmlResponse); } }",java,1
SQL Injection,"import mysql.connector
def search_products(category):
    db = mysql.connector.connect(host=""localhost"", user=""user"", password=""pass"", database=""shop"")
    cursor = db.cursor()
    cursor.execute(""SELECT * FROM products WHERE category = '%s'"" % category)
    return cursor.fetchall()","import mysql.connector
def search_products(category):
    db = mysql.connector.connect(host=""localhost"", user=""user"", password=""pass"", database=""shop"")
    cursor = db.cursor()
    cursor.execute(""SELECT * FROM products WHERE category = '%s'"" % category)
    return cursor.fetchall()",python,1
Hardcoded Secrets,"DATABASE_PASSWORD = ""my_super_secret_password_123""
def db_connect():
    import psycopg2
    return psycopg2.connect(f""dbname=test user=admin password={DATABASE_PASSWORD}"")","DATABASE_PASSWORD = ""my_super_secret_password_123""
def db_connect():
    import psycopg2
    return psycopg2.connect(f""dbname=test user=admin password={DATABASE_PASSWORD}"")",python,1
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Clear,"#include <stdio.h>
#include <string.h>

void safe_string_copy(char *dest, const char *src, size_t dest_size) {
    if (dest_size > 0) {
        strncpy(dest, src, dest_size - 1);
        dest[dest_size - 1] = '\0';
    }
}","#include <stdio.h>
#include <string.h>

void safe_string_copy(char *dest, const char *src, size_t dest_size) {
    if (dest_size > 0) {
        strncpy(dest, src, dest_size - 1);
        dest[dest_size - 1] = '\0';
    }
}",c,0
Clear,"from django.http import HttpResponse
from django.utils.html import escape

def safe_user_profile(request, username):
    safe_username = escape(username)
    return HttpResponse(f""Welcome, {safe_username}!"")","from django.http import HttpResponse
from django.utils.html import escape

def safe_user_profile(request, username):
    safe_username = escape(username)
    return HttpResponse(f""Welcome, {safe_username}!"")",python,0
Cross-Site Scripting (XSS),"def display_comment(comment_text):
    return f""<div class='comment'>{comment_text}</div>"" ","def display_comment(comment_text):
    return f""<div class='comment'>{comment_text}</div>"" ",python,1
File Inclusion,"<?php
$file = $_GET['file'];
include($file); // File Inclusion
?>","<?php
$file = $_GET['file'];
include($file); // File Inclusion
?>",php,1
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Clear,"#include <iostream>
#include <vector>
#include <stdexcept>

int safe_vector_access(const std::vector<int>& vec, size_t index) {
    if (index >= vec.size()) {
        throw std::out_of_range(""Index out of range"");
    }
    return vec[index];
}","#include <iostream>
#include <vector>
#include <stdexcept>

int safe_vector_access(const std::vector<int>& vec, size_t index) {
    if (index >= vec.size()) {
        throw std::out_of_range(""Index out of range"");
    }
    return vec[index];
}",cpp,0
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Clear,"import java.sql.*;

public class SecureSQLInjectionExample {
    public static void main(String[] args) {
        try {
            String userInput = ""admin' OR '1'='1"";

            Connection connection = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");

            String query = ""SELECT * FROM users WHERE username=?"";
            PreparedStatement preparedStatement = connection.prepareStatement(query);
            preparedStatement.setString(1, userInput);

            ResultSet resultSet = preparedStatement.executeQuery();

            while (resultSet.next()) {
                System.out.println(""User found: "" + resultSet.getString(""username""));
            }

            connection.close();
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.*; public class SecureSQLInjectionExample { public static void main(String[] args) { try { String userInput = ""admin' OR '1'='1""; Connection connection = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); String query = ""SELECT * FROM users WHERE username=?""; PreparedStatement preparedStatement = connection.prepareStatement(query); preparedStatement.setString(1, userInput); ResultSet resultSet = preparedStatement.executeQuery(); while (resultSet.next()) { System.out.println(""User found: "" + resultSet.getString(""username"")); } connection.close(); } catch (SQLException e) { e.printStackTrace(); } } }",java,0
Memory Corruption,"#include <iostream>

void unsafe_pointer_arithmetic(int* array, int size) {
    for (int i = 0; i <= size; i++) {
        std::cout << *(array + i) << std::endl; // potential out-of-bounds
    }
}","#include <iostream>

void unsafe_pointer_arithmetic(int* array, int size) {
    for (int i = 0; i <= size; i++) {
        std::cout << *(array + i) << std::endl; // potential out-of-bounds
    }
}",cpp,1
Clear,"#include <stdio.h>
#include <stdlib.h>

int safe_string_to_int(const char *str) {
    char *endptr;
    long value = strtol(str, &endptr, 10);
    if (*endptr != '\0' || str == endptr) {
        return -1; // error
    }
    return (int)value;
}","#include <stdio.h>
#include <stdlib.h>

int safe_string_to_int(const char *str) {
    char *endptr;
    long value = strtol(str, &endptr, 10);
    if (*endptr != '\0' || str == endptr) {
        return -1; // error
    }
    return (int)value;
}",c,0
Command Injection,"import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class CommandInjectionVulnerable {
    public static void main(String[] args) throws IOException {
        BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));
        System.out.print(""Enter a command to execute: "");
        String userInput = reader.readLine();
        
        // Vulnerable code - directly executing user input as a command
        Process process = Runtime.getRuntime().exec(userInput);
        
        BufferedReader outputReader = new BufferedReader(new InputStreamReader(process.getInputStream()));
        String line;
        while ((line = outputReader.readLine()) != null) {
            System.out.println(line);
        }
    }
}","import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class CommandInjectionVulnerable { public static void main(String[] args) throws IOException { BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a command to execute: ""); String userInput = reader.readLine(); // Vulnerable code - directly executing user input as a command Process process = Runtime.getRuntime().exec(userInput); BufferedReader outputReader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = outputReader.readLine()) != null) { System.out.println(line); } } }",java,1
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Buffer Overflow,"#include <iostream>
#include <cstdio>

void unsafe_c_input() {
    char buffer[50];
    scanf(""%s"", buffer); // no length limit
    std::cout << buffer << std::endl;
}","#include <iostream>
#include <cstdio>

void unsafe_c_input() {
    char buffer[50];
    scanf(""%s"", buffer); // no length limit
    std::cout << buffer << std::endl;
}",cpp,1
Cross-Site Scripting (XSS),"import java.io.IOException;
import java.io.PrintWriter;
import javax.servlet.ServletException;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

public class VulnerableServlet extends HttpServlet {
    protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        String userInput = request.getParameter(""input"");
        
        // Vulnerable code: directly outputting user input without proper sanitization
        response.setContentType(""text/html"");
        PrintWriter out = response.getWriter();
        out.println(""<html>"");
        out.println(""<head><title>XSS Vulnerability</title></head>"");
        out.println(""<body>"");
        out.println(""<h1>User Input:</h1>"");
        out.println(""<p>"" + userInput + ""</p>""); // User input is reflected back without sanitization
        out.println(""</body>"");
        out.println(""</html>"");
    }
}","import java.io.IOException; import java.io.PrintWriter; import javax.servlet.ServletException; import javax.servlet.http.HttpServlet; import javax.servlet.http.HttpServletRequest; import javax.servlet.http.HttpServletResponse; public class VulnerableServlet extends HttpServlet { protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { String userInput = request.getParameter(""input""); // Vulnerable code: directly outputting user input without proper sanitization response.setContentType(""text/html""); PrintWriter out = response.getWriter(); out.println(""<html>""); out.println(""<head><title>XSS Vulnerability</title></head>""); out.println(""<body>""); out.println(""<h1>User Input:</h1>""); out.println(""<p>"" + userInput + ""</p>""); // User input is reflected back without sanitization out.println(""</body>""); out.println(""</html>""); } }",java,1
Clear,"#include <stdio.h>
#include <string.h>

void safe_string_copy(char *dest, const char *src, size_t dest_size) {
    if (dest_size > 0) {
        strncpy(dest, src, dest_size - 1);
        dest[dest_size - 1] = '\0';
    }
}","#include <stdio.h>
#include <string.h>

void safe_string_copy(char *dest, const char *src, size_t dest_size) {
    if (dest_size > 0) {
        strncpy(dest, src, dest_size - 1);
        dest[dest_size - 1] = '\0';
    }
}",c,0
Clear,"To fix the vulnerability related to Insecure Deserialization in the provided Java code snippet, you can implement proper security measures. Here are some recommendations to make the code more secure:

1. Use a Safe Deserialization Approach: Instead of using default Java serialization, consider using a safer alternative like JSON or XML serialization libraries which are less prone to security risks.

2. Validate Input: Always validate input data before deserializing it to ensure that it comes from a trusted and authenticated source.

3. Implement Whitelisting: Maintain a whitelist of allowed classes that can be deserialized and reject any attempts to deserialize unauthorized classes.

4. Use Serialization Filters: If you must stick with Java serialization, use serialization filters (available from Java 9 onwards) to control and restrict the deserialization process based on defined criteria.

5. Secure Object Instantiation: Avoid directly executing commands based on deserialized data. If you need to perform actions based on deserialized objects, ensure that these actions are safe and do not introduce security vulnerabilities.

6. Avoid Runtime.exec(): Instead of directly invoking system commands using `Runtime.getRuntime().exec()`, consider using safer alternatives like ProcessBuilder with proper input validation and sanitization.

7. Implement Secure Coding Practices: Follow secure coding practices such","To fix the vulnerability related to Insecure Deserialization in the provided Java code snippet, you can implement proper security measures. Here are some recommendations to make the code more secure: 1. Use a Safe Deserialization Approach: Instead of using default Java serialization, consider using a safer alternative like JSON or XML serialization libraries which are less prone to security risks. 2. Validate Input: Always validate input data before deserializing it to ensure that it comes from a trusted and authenticated source. 3. Implement Whitelisting: Maintain a whitelist of allowed classes that can be deserialized and reject any attempts to deserialize unauthorized classes. 4. Use Serialization Filters: If you must stick with Java serialization, use serialization filters (available from Java 9 onwards) to control and restrict the deserialization process based on defined criteria. 5. Secure Object Instantiation: Avoid directly executing commands based on deserialized data. If you need to perform actions based on deserialized objects, ensure that these actions are safe and do not introduce security vulnerabilities. 6. Avoid Runtime.exec(): Instead of directly invoking system commands using `Runtime.getRuntime().exec()`, consider using safer alternatives like ProcessBuilder with proper input validation and sanitization. 7. Implement Secure Coding Practices: Follow secure coding practices such",php,0
Clear,"To fix the Path Traversal vulnerability in the provided Java code snippet, you need to ensure that the user input for the file name is properly validated to prevent directory traversal attacks. One way to do this is by using a whitelist approach where you restrict the file name input to a specific directory or set of allowed files.

Here's an updated version of the code with proper security measures implemented:

```java
import java.io.File;
import java.io.IOException;
import java.nio.file.Files;
import java.util.Scanner;

public class SecurePathTraversal {

    private static final String BASE_DIRECTORY = ""/path/to/directory/"";

    public static void main(String[] args) throws IOException {
        Scanner scanner = new Scanner(System.in);

        System.out.print(""Enter file name: "");
        String fileName = scanner.nextLine();

        // Check if the file name contains only alphanumeric characters and periods
        if (!fileName.matches(""[a-zA-Z0-9\\.]+"")) {
            System.out.println(""Invalid file name"");
            scanner.close();
            return;
        }

        File file = new File(BASE_DIRECTORY + fileName);

        // Check if the requested file is within the allowed directory
        if (file.getCanonicalPath().startsWith(new File(BASE_DIRECTORY).getCanonicalPath())) {","To fix the Path Traversal vulnerability in the provided Java code snippet, you need to ensure that the user input for the file name is properly validated to prevent directory traversal attacks. One way to do this is by using a whitelist approach where you restrict the file name input to a specific directory or set of allowed files. Here's an updated version of the code with proper security measures implemented: ```java import java.io.File; import java.io.IOException; import java.nio.file.Files; import java.util.Scanner; public class SecurePathTraversal { private static final String BASE_DIRECTORY = ""/path/to/directory/""; public static void main(String[] args) throws IOException { Scanner scanner = new Scanner(System.in); System.out.print(""Enter file name: ""); String fileName = scanner.nextLine(); // Check if the file name contains only alphanumeric characters and periods if (!fileName.matches(""[a-zA-Z0-9\\.]+"")) { System.out.println(""Invalid file name""); scanner.close(); return; } File file = new File(BASE_DIRECTORY + fileName); // Check if the requested file is within the allowed directory if (file.getCanonicalPath().startsWith(new File(BASE_DIRECTORY).getCanonicalPath())) {",java,0
Clear,"<?php
$input = json_decode($_POST['data'], true); // Safe JSON parsing
if (json_last_error() === JSON_ERROR_NONE) {
    process_data($input);
}
?>","<?php
$input = json_decode($_POST['data'], true); // Safe JSON parsing
if (json_last_error() === JSON_ERROR_NONE) {
    process_data($input);
}
?>",php,0
Clear,"#include <iostream>
#include <fstream>
#include <string>

void safe_file_reading(const std::string& filename) {
    std::ifstream file(filename);
    if (file.is_open()) {
        std::string line;
        while (std::getline(file, line)) {
            std::cout << line << std::endl;
        }
    }
}","#include <iostream>
#include <fstream>
#include <string>

void safe_file_reading(const std::string& filename) {
    std::ifstream file(filename);
    if (file.is_open()) {
        std::string line;
        while (std::getline(file, line)) {
            std::cout << line << std::endl;
        }
    }
}",cpp,0
Clear,"#include <stdio.h>
#include <string.h>

int validate_input(const char *input) {
    if (input == NULL) return 0;
    for (int i = 0; input[i] != '\0'; i++) {
        if (input[i] < 32 || input[i] > 126) {
            return 0; // invalid character
        }
    }
    return 1;
}","#include <stdio.h>
#include <string.h>

int validate_input(const char *input) {
    if (input == NULL) return 0;
    for (int i = 0; input[i] != '\0'; i++) {
        if (input[i] < 32 || input[i] > 126) {
            return 0; // invalid character
        }
    }
    return 1;
}",c,0
Clear,"import java.sql.*;

public class SecureCode {

    public static void main(String[] args) {
        String userInput = ""'; DROP TABLE users; --""; // Malicious input

        try {
            Connection connection = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");
            
            // Use a PreparedStatement with parameterized query
            String query = ""SELECT * FROM users WHERE username = ?"";
            PreparedStatement preparedStatement = connection.prepareStatement(query);
            preparedStatement.setString(1, userInput);

            ResultSet resultSet = preparedStatement.executeQuery();

            while (resultSet.next()) {
                System.out.println(resultSet.getString(""username""));
            }

            connection.close();
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.*; public class SecureCode { public static void main(String[] args) { String userInput = ""'; DROP TABLE users; --""; // Malicious input try { Connection connection = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); // Use a PreparedStatement with parameterized query String query = ""SELECT * FROM users WHERE username = ?""; PreparedStatement preparedStatement = connection.prepareStatement(query); preparedStatement.setString(1, userInput); ResultSet resultSet = preparedStatement.executeQuery(); while (resultSet.next()) { System.out.println(resultSet.getString(""username"")); } connection.close(); } catch (SQLException e) { e.printStackTrace(); } } }",java,0
Cross-Site Scripting (XSS),"import java.io.*;
import javax.servlet.*;
import javax.servlet.http.*;

public class VulnerableServlet extends HttpServlet {
    protected void doGet(HttpServletRequest request, HttpServletResponse response)
            throws ServletException, IOException {
        String userInput = request.getParameter(""input"");
        
        // Vulnerability: User input is directly embedded into the response without proper validation or encoding
        String output = ""<h1>Welcome "" + userInput + ""</h1>"";
        
        response.setContentType(""text/html"");
        PrintWriter out = response.getWriter();
        out.println(output);
    }
}","import java.io.*; import javax.servlet.*; import javax.servlet.http.*; public class VulnerableServlet extends HttpServlet { protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { String userInput = request.getParameter(""input""); // Vulnerability: User input is directly embedded into the response without proper validation or encoding String output = ""<h1>Welcome "" + userInput + ""</h1>""; response.setContentType(""text/html""); PrintWriter out = response.getWriter(); out.println(output); } }",java,1
Clear,"const userData = JSON.parse(userInput); // Safe JSON parsing
if (userData && typeof userData === 'object') {
    processUserData(userData);
}
","const userData = JSON.parse(userInput); // Safe JSON parsing
if (userData && typeof userData === 'object') {
    processUserData(userData);
}
",javascript,0
Clear,"#include <iostream>
#include <string>
#include <vector>

void safe_string_handling(const std::string& input) {
    std::string safe_copy = input;
    std::cout << safe_copy << std::endl;
}","#include <iostream>
#include <string>
#include <vector>

void safe_string_handling(const std::string& input) {
    std::string safe_copy = input;
    std::cout << safe_copy << std::endl;
}",cpp,0
Clear,"import java.io.IOException;
import java.io.PrintWriter;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import org.owasp.encoder.Encode;

public class SecureServlet extends HttpServlet {
    
    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws IOException {
        String userInput = request.getParameter(""input"");
        
        PrintWriter out = response.getWriter();
        out.println(""<html>"");
        out.println(""<body>"");
        out.println(""<h1>Hello, "" + Encode.forHtml(userInput) + ""!</h1>""); // Encoding user input for HTML context
        out.println(""</body>"");
        out.println(""</html>"");
    }
}","import java.io.IOException; import java.io.PrintWriter; import javax.servlet.http.HttpServlet; import javax.servlet.http.HttpServletRequest; import javax.servlet.http.HttpServletResponse; import org.owasp.encoder.Encode; public class SecureServlet extends HttpServlet { protected void doGet(HttpServletRequest request, HttpServletResponse response) throws IOException { String userInput = request.getParameter(""input""); PrintWriter out = response.getWriter(); out.println(""<html>""); out.println(""<body>""); out.println(""<h1>Hello, "" + Encode.forHtml(userInput) + ""!</h1>""); // Encoding user input for HTML context out.println(""</body>""); out.println(""</html>""); } }",java,0
Hardcoded Secrets,"DATABASE_PASSWORD = ""my_super_secret_password_123""
def db_connect():
    import psycopg2
    return psycopg2.connect(f""dbname=test user=admin password={DATABASE_PASSWORD}"")","DATABASE_PASSWORD = ""my_super_secret_password_123""
def db_connect():
    import psycopg2
    return psycopg2.connect(f""dbname=test user=admin password={DATABASE_PASSWORD}"")",python,1
SQL Injection,"app.get('/user/:id', (req, res) => {
    const query = `SELECT * FROM users WHERE id = ${req.params.id}`; // SQL Injection
    db.query(query, (err, result) => {
        res.json(result);
    });
});
","app.get('/user/:id', (req, res) => {
    const query = `SELECT * FROM users WHERE id = ${req.params.id}`; // SQL Injection
    db.query(query, (err, result) => {
        res.json(result);
    });
});
",javascript,1
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Clear,"#include <iostream>
#include <vector>
#include <stdexcept>

int safe_vector_access(const std::vector<int>& vec, size_t index) {
    if (index >= vec.size()) {
        throw std::out_of_range(""Index out of range"");
    }
    return vec[index];
}","#include <iostream>
#include <vector>
#include <stdexcept>

int safe_vector_access(const std::vector<int>& vec, size_t index) {
    if (index >= vec.size()) {
        throw std::out_of_range(""Index out of range"");
    }
    return vec[index];
}",cpp,0
Clear,"import os
def secure_file_access(username, filepath):
    base_dir = f""/home/{username}/files/""
    full_path = os.path.join(base_dir, filepath)
    full_path = os.path.normpath(full_path)
    if not full_path.startswith(base_dir):
        raise PermissionError(""Access denied"")
    with open(full_path, 'r') as f:
        return f.read()","import os
def secure_file_access(username, filepath):
    base_dir = f""/home/{username}/files/""
    full_path = os.path.join(base_dir, filepath)
    full_path = os.path.normpath(full_path)
    if not full_path.startswith(base_dir):
        raise PermissionError(""Access denied"")
    with open(full_path, 'r') as f:
        return f.read()",python,0
Command Injection,"<?php
$cmd = $_GET['cmd'];
system($cmd); // Command Injection
?>","<?php
$cmd = $_GET['cmd'];
system($cmd); // Command Injection
?>",php,1
SQL Injection,"import psycopg2
def admin_login(admin_id):
    conn = psycopg2.connect(""dbname=test user=postgres"")
    cur = conn.cursor()
    cur.execute(f""SELECT * FROM admins WHERE id = {admin_id}"")
    return cur.fetchone()","import psycopg2
def admin_login(admin_id):
    conn = psycopg2.connect(""dbname=test user=postgres"")
    cur = conn.cursor()
    cur.execute(f""SELECT * FROM admins WHERE id = {admin_id}"")
    return cur.fetchone()",python,1
Clear,"#include <stdio.h>
#include <stdlib.h>

int safe_string_to_int(const char *str) {
    char *endptr;
    long value = strtol(str, &endptr, 10);
    if (*endptr != '\0' || str == endptr) {
        return -1; // error
    }
    return (int)value;
}","#include <stdio.h>
#include <stdlib.h>

int safe_string_to_int(const char *str) {
    char *endptr;
    long value = strtol(str, &endptr, 10);
    if (*endptr != '\0' || str == endptr) {
        return -1; // error
    }
    return (int)value;
}",c,0
Hardcoded Secrets,"import requests
def call_api():
    api_key = ""sk_live_1234567890abcdef""
    headers = {'Authorization': f'Bearer {api_key}'}
    return requests.get('https://api.example.com/data', headers=headers)","import requests
def call_api():
    api_key = ""sk_live_1234567890abcdef""
    headers = {'Authorization': f'Bearer {api_key}'}
    return requests.get('https://api.example.com/data', headers=headers)",python,1
Cross-Site Scripting (XSS),"import java.io.*;

public class XSSVulnerableCode {

    public static void main(String[] args) {
        // Simulating user input
        String userInput = ""<script>alert('XSS Vulnerability!')</script>"";

        // Improperly handling user input without proper encoding
        String output = ""<div>"" + userInput + ""</div>"";

        // Output the vulnerable code
        System.out.println(output);
    }
}","import java.io.*; public class XSSVulnerableCode { public static void main(String[] args) { // Simulating user input String userInput = ""<script>alert('XSS Vulnerability!')</script>""; // Improperly handling user input without proper encoding String output = ""<div>"" + userInput + ""</div>""; // Output the vulnerable code System.out.println(output); } }",java,1
Clear,"import java.sql.*;

public class SecureSQLInjectionProtection {

    public static void main(String[] args) {
        String userInput = ""admin'; DROP TABLE users; --"";
        
        try {
            Connection connection = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""root"", ""password"");
            
            String query = ""SELECT * FROM users WHERE username=?"";
            PreparedStatement statement = connection.prepareStatement(query);
            statement.setString(1, userInput);
            
            ResultSet resultSet = statement.executeQuery();
            
            while (resultSet.next()) {
                System.out.println(resultSet.getString(""username""));
                System.out.println(resultSet.getString(""password""));
            }
            
            connection.close();
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.*; public class SecureSQLInjectionProtection { public static void main(String[] args) { String userInput = ""admin'; DROP TABLE users; --""; try { Connection connection = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""root"", ""password""); String query = ""SELECT * FROM users WHERE username=?""; PreparedStatement statement = connection.prepareStatement(query); statement.setString(1, userInput); ResultSet resultSet = statement.executeQuery(); while (resultSet.next()) { System.out.println(resultSet.getString(""username"")); System.out.println(resultSet.getString(""password"")); } connection.close(); } catch (SQLException e) { e.printStackTrace(); } } }",java,0
Buffer Overflow,"#include <iostream>
#include <cstdio>

void unsafe_c_input() {
    char buffer[50];
    scanf(""%s"", buffer); // no length limit
    std::cout << buffer << std::endl;
}","#include <iostream>
#include <cstdio>

void unsafe_c_input() {
    char buffer[50];
    scanf(""%s"", buffer); // no length limit
    std::cout << buffer << std::endl;
}",cpp,1
Command Injection,"import os
def backup_database(db_name):
    os.system(f""pg_dump {db_name} > backup.sql"")","import os
def backup_database(db_name):
    os.system(f""pg_dump {db_name} > backup.sql"")",python,1
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Clear,"const userData = JSON.parse(userInput); // Safe JSON parsing
if (userData && typeof userData === 'object') {
    processUserData(userData);
}
","const userData = JSON.parse(userInput); // Safe JSON parsing
if (userData && typeof userData === 'object') {
    processUserData(userData);
}
",javascript,0
Path Traversal,"import java.io.File;
import java.io.FileReader;
import java.io.IOException;
import java.util.Scanner;

public class PathTraversalVulnerability {

    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        System.out.print(""Enter file name: "");
        String fileName = scanner.next();

        File file = new File(""/path/to/some/directory/"" + fileName);

        try (FileReader fileReader = new FileReader(file)) {
            int data;
            while ((data = fileReader.read()) != -1) {
                System.out.print((char) data);
            }
        } catch (IOException e) {
            System.out.println(""Error reading file: "" + e.getMessage());
        }
    }
}","import java.io.File; import java.io.FileReader; import java.io.IOException; import java.util.Scanner; public class PathTraversalVulnerability { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter file name: ""); String fileName = scanner.next(); File file = new File(""/path/to/some/directory/"" + fileName); try (FileReader fileReader = new FileReader(file)) { int data; while ((data = fileReader.read()) != -1) { System.out.print((char) data); } } catch (IOException e) { System.out.println(""Error reading file: "" + e.getMessage()); } } }",java,1
Clear,"#include <stdio.h>
#include <string.h>

void safe_string_copy(char *dest, const char *src, size_t dest_size) {
    if (dest_size > 0) {
        strncpy(dest, src, dest_size - 1);
        dest[dest_size - 1] = '\0';
    }
}","#include <stdio.h>
#include <string.h>

void safe_string_copy(char *dest, const char *src, size_t dest_size) {
    if (dest_size > 0) {
        strncpy(dest, src, dest_size - 1);
        dest[dest_size - 1] = '\0';
    }
}",c,0
SQL Injection,"app.get('/user/:id', (req, res) => {
    const query = `SELECT * FROM users WHERE id = ${req.params.id}`; // SQL Injection
    db.query(query, (err, result) => {
        res.json(result);
    });
});
","app.get('/user/:id', (req, res) => {
    const query = `SELECT * FROM users WHERE id = ${req.params.id}`; // SQL Injection
    db.query(query, (err, result) => {
        res.json(result);
    });
});
",javascript,1
XSS,"<?php
echo $_GET['message']; // XSS
?>","<?php
echo $_GET['message']; // XSS
?>",php,1
SQL Injection,"import psycopg2
def admin_login(admin_id):
    conn = psycopg2.connect(""dbname=test user=postgres"")
    cur = conn.cursor()
    cur.execute(f""SELECT * FROM admins WHERE id = {admin_id}"")
    return cur.fetchone()","import psycopg2
def admin_login(admin_id):
    conn = psycopg2.connect(""dbname=test user=postgres"")
    cur = conn.cursor()
    cur.execute(f""SELECT * FROM admins WHERE id = {admin_id}"")
    return cur.fetchone()",python,1
Clear,"To fix the security vulnerability in the provided code snippet and prevent Path Traversal attacks, you can implement the following secure coding practices:

1. Sanitize User Input:
   Instead of directly using user input to construct a file path, you should validate and sanitize the input to ensure that it does not contain any path traversal characters (such as '..', '/', etc.). One way to achieve this is by checking if the user input contains only allowed characters or restricting it to a specific format.

2. Use Absolute File Paths:
   Instead of using relative file paths, always use absolute file paths when dealing with file operations. This ensures that the file being accessed is located in a specific and known directory.

3. Limit Access to Specific Directory:
   Restrict access to only specific directories where files should be located. This can be done by setting a base directory for file operations and not allowing access outside of this directory.

4. Avoid Hardcoding File Names:
   Avoid hardcoding file names in the code and dynamically generate or retrieve file names based on user input or other parameters.

5. Check File Existence:
   Before attempting to read from a file, always check if the file actually exists at the specified path to prevent errors or potential security issues.

Here is an","To fix the security vulnerability in the provided code snippet and prevent Path Traversal attacks, you can implement the following secure coding practices: 1. Sanitize User Input: Instead of directly using user input to construct a file path, you should validate and sanitize the input to ensure that it does not contain any path traversal characters (such as '..', '/', etc.). One way to achieve this is by checking if the user input contains only allowed characters or restricting it to a specific format. 2. Use Absolute File Paths: Instead of using relative file paths, always use absolute file paths when dealing with file operations. This ensures that the file being accessed is located in a specific and known directory. 3. Limit Access to Specific Directory: Restrict access to only specific directories where files should be located. This can be done by setting a base directory for file operations and not allowing access outside of this directory. 4. Avoid Hardcoding File Names: Avoid hardcoding file names in the code and dynamically generate or retrieve file names based on user input or other parameters. 5. Check File Existence: Before attempting to read from a file, always check if the file actually exists at the specified path to prevent errors or potential security issues. Here is an",php,0
Clear,"To fix the Path Traversal vulnerability in the provided Java code snippet, you can implement the following security measures:

1. Validate User Input: 
   Before constructing the file path using user input, ensure that the input is validated to prevent directory traversal attacks. You can check if the fileName contains any path separators (""/"" or ""\"") and reject such inputs.

2. Use Absolute Paths:
   Instead of constructing file paths based on user input, it is safer to use absolute paths to avoid any unintended directory traversal. In this case, you can specify the base directory explicitly.

3. Security Manager:
   Consider using a Security Manager to restrict file system access based on permissions and policies.

Here is an updated version of the code with these security measures implemented:

```java
import java.io.File;
import java.util.Scanner;

public class SecurePathTraversal {
    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        
        System.out.print(""Enter file name: "");
        String fileName = scanner.next();
        
        // Validate user input for path traversal
        if (fileName.contains(""/"") || fileName.contains(""\\"")) {
            System.out.println(""Invalid file name."");
            return;
        }
        
        // Specify base directory","To fix the Path Traversal vulnerability in the provided Java code snippet, you can implement the following security measures: 1. Validate User Input: Before constructing the file path using user input, ensure that the input is validated to prevent directory traversal attacks. You can check if the fileName contains any path separators (""/"" or ""\"") and reject such inputs. 2. Use Absolute Paths: Instead of constructing file paths based on user input, it is safer to use absolute paths to avoid any unintended directory traversal. In this case, you can specify the base directory explicitly. 3. Security Manager: Consider using a Security Manager to restrict file system access based on permissions and policies. Here is an updated version of the code with these security measures implemented: ```java import java.io.File; import java.util.Scanner; public class SecurePathTraversal { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter file name: ""); String fileName = scanner.next(); // Validate user input for path traversal if (fileName.contains(""/"") || fileName.contains(""\\"")) { System.out.println(""Invalid file name.""); return; } // Specify base directory",java,0
Command Injection,"import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class CommandInjectionExample {

    public static void main(String[] args) throws IOException {
        BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));
        
        System.out.print(""Enter a command to run: "");
        String command = reader.readLine();
        
        // This is where the vulnerability lies
        Process process = Runtime.getRuntime().exec(command);
        
        BufferedReader processOutputReader = new BufferedReader(new InputStreamReader(process.getInputStream()));
        String line;
        while ((line = processOutputReader.readLine()) != null) {
            System.out.println(line);
        }
        
        processOutputReader.close();
    }
}","import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class CommandInjectionExample { public static void main(String[] args) throws IOException { BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a command to run: ""); String command = reader.readLine(); // This is where the vulnerability lies Process process = Runtime.getRuntime().exec(command); BufferedReader processOutputReader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = processOutputReader.readLine()) != null) { System.out.println(line); } processOutputReader.close(); } }",java,1
Clear,"from flask import Flask, request
import html
app = Flask(__name__)

@app.route('/search_safe')
def search_safe():
    query = request.args.get('q', '')
    safe_query = html.escape(query)
    return f'<h1>Search results for: {safe_query}</h1>'","from flask import Flask, request
import html
app = Flask(__name__)

@app.route('/search_safe')
def search_safe():
    query = request.args.get('q', '')
    safe_query = html.escape(query)
    return f'<h1>Search results for: {safe_query}</h1>'",python,0
Cross-Site Scripting (XSS),"import java.io.*;
import java.util.*;

public class XSSVulnerableCode {
    public static void main(String[] args) {
        // Simulating user input received from a form submission
        String userInput = ""<script>alert('XSS Vulnerability!')</script>"";

        // Displaying user input on a web page without proper sanitization
        System.out.println(""<div>"" + userInput + ""</div>"");
    }
}","import java.io.*; import java.util.*; public class XSSVulnerableCode { public static void main(String[] args) { // Simulating user input received from a form submission String userInput = ""<script>alert('XSS Vulnerability!')</script>""; // Displaying user input on a web page without proper sanitization System.out.println(""<div>"" + userInput + ""</div>""); } }",java,1
XSS,"<?php
echo $_GET['message']; // XSS
?>","<?php
echo $_GET['message']; // XSS
?>",php,1
Out-of-Bounds,"#include <iostream>

class UnsafeClass {
    int data[10];
public:
    int get_data(int index) {
        return data[index]; // no bounds checking
    }
};","#include <iostream>

class UnsafeClass {
    int data[10];
public:
    int get_data(int index) {
        return data[index]; // no bounds checking
    }
};",cpp,1
Cross-Site Scripting (XSS),"import java.io.*;
import javax.servlet.*;
import javax.servlet.http.*;

public class VulnerableServlet extends HttpServlet {
    protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        String userInput = request.getParameter(""input"");
        
        // Improper handling of user input
        String output = ""<p>User input: "" + userInput + ""</p>"";
        
        PrintWriter out = response.getWriter();
        out.println(output);
    }
}","import java.io.*; import javax.servlet.*; import javax.servlet.http.*; public class VulnerableServlet extends HttpServlet { protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { String userInput = request.getParameter(""input""); // Improper handling of user input String output = ""<p>User input: "" + userInput + ""</p>""; PrintWriter out = response.getWriter(); out.println(output); } }",java,1
Clear,"import json
def parse_safe_json(json_str):
    try:
        return json.loads(json_str)
    except json.JSONDecodeError:
        raise ValueError(""Invalid JSON"")","import json
def parse_safe_json(json_str):
    try:
        return json.loads(json_str)
    except json.JSONDecodeError:
        raise ValueError(""Invalid JSON"")",python,0
Command Injection,"<?php
$cmd = $_GET['cmd'];
system($cmd); // Command Injection
?>","<?php
$cmd = $_GET['cmd'];
system($cmd); // Command Injection
?>",php,1
Memory Corruption,"#include <iostream>

void unsafe_virtual_call() {
    // Potential vtable corruption vulnerability
    class Base {
    public:
        virtual void func() { std::cout << ""Base"" << std::endl; }
    };
    
    class Derived : public Base {
    public:
        void func() override { std::cout << ""Derived"" << std::endl; }
    };
}","#include <iostream>

void unsafe_virtual_call() {
    // Potential vtable corruption vulnerability
    class Base {
    public:
        virtual void func() { std::cout << ""Base"" << std::endl; }
    };
    
    class Derived : public Base {
    public:
        void func() override { std::cout << ""Derived"" << std::endl; }
    };
}",cpp,1
Command Injection,"import os
def backup_database(db_name):
    os.system(f""pg_dump {db_name} > backup.sql"")","import os
def backup_database(db_name):
    os.system(f""pg_dump {db_name} > backup.sql"")",python,1
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
SQL Injection,"<?php
$username = $_POST['username'];
$query = ""SELECT * FROM users WHERE username = '$username'"";
$result = mysql_query($query); // SQL Injection
?>","<?php
$username = $_POST['username'];
$query = ""SELECT * FROM users WHERE username = '$username'"";
$result = mysql_query($query); // SQL Injection
?>",php,1
Clear,"To prevent Path Traversal vulnerability in the provided Java code snippet, you can enforce restrictions on the file paths that can be accessed. One common approach is to use a whitelist of allowed file paths and verify that the requested file path falls within this whitelist.

Here is an updated version of the code with security measures implemented:

```java
import java.io.File;
import java.io.FileInputStream;
import java.io.IOException;

public class FileRead {

    private static final String BASE_PATH = ""C:/data/"";

    private static boolean isValidFilePath(String fileName) {
        File requestedFile = new File(BASE_PATH + fileName).getAbsoluteFile();
        File baseDir = new File(BASE_PATH).getAbsoluteFile();
        
        return requestedFile.getPath().startsWith(baseDir.getPath());
    }

    public static void main(String[] args) {
        if (args.length != 1) {
            System.out.println(""Please provide a file name as argument"");
            return;
        }

        String fileName = args[0];

        if (!isValidFilePath(fileName)) {
            System.out.println(""Invalid file path"");
            return;
        }

        try {
            File file = new File(BASE_PATH + fileName);
            FileInputStream fis = new FileInputStream(file);
            int data;
            while ((","To prevent Path Traversal vulnerability in the provided Java code snippet, you can enforce restrictions on the file paths that can be accessed. One common approach is to use a whitelist of allowed file paths and verify that the requested file path falls within this whitelist. Here is an updated version of the code with security measures implemented: ```java import java.io.File; import java.io.FileInputStream; import java.io.IOException; public class FileRead { private static final String BASE_PATH = ""C:/data/""; private static boolean isValidFilePath(String fileName) { File requestedFile = new File(BASE_PATH + fileName).getAbsoluteFile(); File baseDir = new File(BASE_PATH).getAbsoluteFile(); return requestedFile.getPath().startsWith(baseDir.getPath()); } public static void main(String[] args) { if (args.length != 1) { System.out.println(""Please provide a file name as argument""); return; } String fileName = args[0]; if (!isValidFilePath(fileName)) { System.out.println(""Invalid file path""); return; } try { File file = new File(BASE_PATH + fileName); FileInputStream fis = new FileInputStream(file); int data; while ((",java,0
Clear,"<?php
$input = json_decode($_POST['data'], true); // Safe JSON parsing
if (json_last_error() === JSON_ERROR_NONE) {
    process_data($input);
}
?>","<?php
$input = json_decode($_POST['data'], true); // Safe JSON parsing
if (json_last_error() === JSON_ERROR_NONE) {
    process_data($input);
}
?>",php,0
Clear,"const shell = require('child_process');
const safeInput = userInput.replace(/[^a-zA-Z0-9.]/g, '');
shell.execFile('ping', [safeInput]); // Safe command execution
","const shell = require('child_process');
const safeInput = userInput.replace(/[^a-zA-Z0-9.]/g, '');
shell.execFile('ping', [safeInput]); // Safe command execution
",javascript,0
Clear,"To fix the Command Injection vulnerability in the provided Java code snippet, you should properly sanitize and validate user input before executing any external commands. Here is an improved version of the code that uses `ProcessBuilder` to safely execute commands:

```java
import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class CommandInjectionExample {

    public static void main(String[] args) {
        try {
            BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));
            System.out.print(""Enter a command to execute: "");
            String command = reader.readLine();

            // Sanitize and validate user input before executing the command
            if (!isValidCommand(command)) {
                System.out.println(""Invalid command."");
                return;
            }

            // Safely execute the command using ProcessBuilder
            ProcessBuilder processBuilder = new ProcessBuilder(command.split("" ""));
            Process process = processBuilder.start();

            BufferedReader inputStream = new BufferedReader(new InputStreamReader(process.getInputStream()));
            String line;
            while ((line = inputStream.readLine()) != null) {
                System.out.println(line);
            }

        } catch (IOException e) {
            e.printStackTrace();
        }
    }

    private static boolean isValidCommand(String command) {
        // Add your validation logic here, such as","To fix the Command Injection vulnerability in the provided Java code snippet, you should properly sanitize and validate user input before executing any external commands. Here is an improved version of the code that uses `ProcessBuilder` to safely execute commands: ```java import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class CommandInjectionExample { public static void main(String[] args) { try { BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a command to execute: ""); String command = reader.readLine(); // Sanitize and validate user input before executing the command if (!isValidCommand(command)) { System.out.println(""Invalid command.""); return; } // Safely execute the command using ProcessBuilder ProcessBuilder processBuilder = new ProcessBuilder(command.split("" "")); Process process = processBuilder.start(); BufferedReader inputStream = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = inputStream.readLine()) != null) { System.out.println(line); } } catch (IOException e) { e.printStackTrace(); } } private static boolean isValidCommand(String command) { // Add your validation logic here, such as",java,0
Buffer Overflow,"#include <iostream>
#include <cstdio>

void unsafe_c_input() {
    char buffer[50];
    scanf(""%s"", buffer); // no length limit
    std::cout << buffer << std::endl;
}","#include <iostream>
#include <cstdio>

void unsafe_c_input() {
    char buffer[50];
    scanf(""%s"", buffer); // no length limit
    std::cout << buffer << std::endl;
}",cpp,1
Clear,"import requests
def safe_api_call():
    api_key = os.environ.get('API_KEY')
    headers = {'Authorization': f'Bearer {api_key}'}
    return requests.get('https://api.example.com/data', headers=headers)","import requests
def safe_api_call():
    api_key = os.environ.get('API_KEY')
    headers = {'Authorization': f'Bearer {api_key}'}
    return requests.get('https://api.example.com/data', headers=headers)",python,0
Clear,"#include <stdio.h>
#include <string.h>

void safe_string_copy(char *dest, const char *src, size_t dest_size) {
    if (dest_size > 0) {
        strncpy(dest, src, dest_size - 1);
        dest[dest_size - 1] = '\0';
    }
}","#include <stdio.h>
#include <string.h>

void safe_string_copy(char *dest, const char *src, size_t dest_size) {
    if (dest_size > 0) {
        strncpy(dest, src, dest_size - 1);
        dest[dest_size - 1] = '\0';
    }
}",c,0
Clear,"To fix the Command Injection vulnerability in the provided Java code snippet, you should sanitize and validate user input to prevent malicious commands from being executed. Here's an improved version of the code that uses ProcessBuilder to execute the command securely:

```java
import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class CommandInjectionSecure {

    public static void main(String[] args) {
        try {
            BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));
            System.out.print(""Enter a command to execute: "");
            String userInput = reader.readLine();

            // Sanitize and validate user input before constructing the command
            if (!isValidCommand(userInput)) {
                System.out.println(""Invalid command. Please try again."");
                return;
            }

            // Construct the command using ProcessBuilder to avoid injection
            ProcessBuilder processBuilder = new ProcessBuilder(""ping"", userInput);
            Process process = processBuilder.start();
            
            BufferedReader processOutputReader = new BufferedReader(new InputStreamReader(process.getInputStream()));

            String line;
            while ((line = processOutputReader.readLine()) != null) {
                System.out.println(line);
            }

        } catch (IOException e) {
            e.printStackTrace();
        }
    }

    private static boolean isValidCommand(String userInput","To fix the Command Injection vulnerability in the provided Java code snippet, you should sanitize and validate user input to prevent malicious commands from being executed. Here's an improved version of the code that uses ProcessBuilder to execute the command securely: ```java import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class CommandInjectionSecure { public static void main(String[] args) { try { BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a command to execute: ""); String userInput = reader.readLine(); // Sanitize and validate user input before constructing the command if (!isValidCommand(userInput)) { System.out.println(""Invalid command. Please try again.""); return; } // Construct the command using ProcessBuilder to avoid injection ProcessBuilder processBuilder = new ProcessBuilder(""ping"", userInput); Process process = processBuilder.start(); BufferedReader processOutputReader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = processOutputReader.readLine()) != null) { System.out.println(line); } } catch (IOException e) { e.printStackTrace(); } } private static boolean isValidCommand(String userInput",java,0
Clear,"app.get('/user/:id', (req, res) => {
    const userId = parseInt(req.params.id);
    db.query('SELECT * FROM users WHERE id = ?', [userId], (err, result) => {
        res.json(result);
    });
});
","app.get('/user/:id', (req, res) => {
    const userId = parseInt(req.params.id);
    db.query('SELECT * FROM users WHERE id = ?', [userId], (err, result) => {
        res.json(result);
    });
});
",javascript,0
Clear,"#include <iostream>
#include <memory>

void safe_memory_management() {
    auto ptr = std::make_unique<int>(42);
    std::cout << *ptr << std::endl;
}","#include <iostream>
#include <memory>

void safe_memory_management() {
    auto ptr = std::make_unique<int>(42);
    std::cout << *ptr << std::endl;
}",cpp,0
Clear,"import java.io.*;
import java.util.Scanner;

import org.apache.commons.text.StringEscapeUtils;

public class SecureXSSExample {
    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);

        System.out.print(""Enter your name: "");
        String userName = scanner.nextLine();

        System.out.println(""Hello, "" + StringEscapeUtils.escapeHtml4(userName) + ""!"");

        // The user input is now properly sanitized and escaped before being included in the HTML response
        // This prevents XSS attacks by converting special characters to their HTML entity equivalents
        System.out.println(""<script>alert('XSS Attack!')</script>"");
    }
}","import java.io.*; import java.util.Scanner; import org.apache.commons.text.StringEscapeUtils; public class SecureXSSExample { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter your name: ""); String userName = scanner.nextLine(); System.out.println(""Hello, "" + StringEscapeUtils.escapeHtml4(userName) + ""!""); // The user input is now properly sanitized and escaped before being included in the HTML response // This prevents XSS attacks by converting special characters to their HTML entity equivalents System.out.println(""<script>alert('XSS Attack!')</script>""); } }",java,0
Clear,"import psycopg2
def safe_admin_query(admin_id):
    conn = psycopg2.connect(""dbname=test user=postgres"")
    cur = conn.cursor()
    cur.execute(""SELECT * FROM admins WHERE id = %s"", (admin_id,))
    return cur.fetchone()","import psycopg2
def safe_admin_query(admin_id):
    conn = psycopg2.connect(""dbname=test user=postgres"")
    cur = conn.cursor()
    cur.execute(""SELECT * FROM admins WHERE id = %s"", (admin_id,))
    return cur.fetchone()",python,0
Path Traversal,"import java.io.File;
import java.io.FileInputStream;
import java.io.IOException;
import java.util.Scanner;

public class PathTraversalVulnerability {

    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        System.out.print(""Enter file name: "");
        String fileName = scanner.nextLine();

        try {
            File file = new File(""/path/to/files/"" + fileName);
            FileInputStream fis = new FileInputStream(file);

            int data;
            while ((data = fis.read()) != -1) {
                System.out.print((char) data);
            }

            fis.close();
        } catch (IOException e) {
            System.out.println(""Error reading file: "" + e.getMessage());
        }
    }
}","import java.io.File; import java.io.FileInputStream; import java.io.IOException; import java.util.Scanner; public class PathTraversalVulnerability { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter file name: ""); String fileName = scanner.nextLine(); try { File file = new File(""/path/to/files/"" + fileName); FileInputStream fis = new FileInputStream(file); int data; while ((data = fis.read()) != -1) { System.out.print((char) data); } fis.close(); } catch (IOException e) { System.out.println(""Error reading file: "" + e.getMessage()); } } }",java,1
Clear,"To fix the Command Injection vulnerability in the given Java code, you should avoid directly executing user input as a command. Instead, you should validate and sanitize the input before executing any command. Here is an example of how to fix the code using a ProcessBuilder and ensuring proper validation:

```java
import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class SecureCommandExecution {

    public static void main(String[] args) {
        try {
            BufferedReader br = new BufferedReader(new InputStreamReader(System.in));
            System.out.print(""Enter a command to execute: "");
            String command = br.readLine();

            // Validate and sanitize the input
            if (!isValidCommand(command)) {
                System.out.println(""Invalid command"");
                return;
            }

            // Use ProcessBuilder to execute the command securely
            ProcessBuilder processBuilder = new ProcessBuilder(""ping"", command);
            Process process = processBuilder.start();

            BufferedReader inputReader = new BufferedReader(new InputStreamReader(process.getInputStream()));
            String line;
            while ((line = inputReader.readLine()) != null) {
                System.out.println(line);
            }
        } catch (IOException e) {
            e.printStackTrace();
        }
    }

    private static boolean isValidCommand(String command) {
        //","To fix the Command Injection vulnerability in the given Java code, you should avoid directly executing user input as a command. Instead, you should validate and sanitize the input before executing any command. Here is an example of how to fix the code using a ProcessBuilder and ensuring proper validation: ```java import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class SecureCommandExecution { public static void main(String[] args) { try { BufferedReader br = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a command to execute: ""); String command = br.readLine(); // Validate and sanitize the input if (!isValidCommand(command)) { System.out.println(""Invalid command""); return; } // Use ProcessBuilder to execute the command securely ProcessBuilder processBuilder = new ProcessBuilder(""ping"", command); Process process = processBuilder.start(); BufferedReader inputReader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = inputReader.readLine()) != null) { System.out.println(line); } } catch (IOException e) { e.printStackTrace(); } } private static boolean isValidCommand(String command) { //",java,0
Hardcoded Secrets,"localStorage.setItem('token', 'hardcoded-secret-token-123'); // Hardcoded secret
","localStorage.setItem('token', 'hardcoded-secret-token-123'); // Hardcoded secret
",javascript,1
Code Injection,"const userData = eval('(' + userInput + ')'); // eval injection
","const userData = eval('(' + userInput + ')'); // eval injection
",javascript,1
Clear,"To fix the code snippet and prevent Cross-Site Scripting (XSS) vulnerabilities, you need to properly sanitize user input before including it in the output HTML. Here's an example of how you can modify the code to mitigate XSS attacks:

```java
import java.io.IOException;
import java.io.PrintWriter;
import javax.servlet.ServletException;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

public class SecureServlet extends HttpServlet {

    protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        String userInput = request.getParameter(""input"");
        
        // Sanitize user input to prevent XSS
        String safeUserInput = sanitizeInput(userInput);
        
        String output = ""<p>User input: "" + safeUserInput + ""</p>"";
        
        PrintWriter out = response.getWriter();
        out.println(output);
    }
    
    // Method to sanitize user input
    private String sanitizeInput(String input) {
        // Implement your sanitization logic here
        // For example, you can use OWASP Java Encoder library or a custom sanitizer function
        // Here is a simple example using Apache Commons Text library for HTML escaping:
        return org.apache.commons.text.StringEscapeUtils.escapeHtml4(input);
    }","To fix the code snippet and prevent Cross-Site Scripting (XSS) vulnerabilities, you need to properly sanitize user input before including it in the output HTML. Here's an example of how you can modify the code to mitigate XSS attacks: ```java import java.io.IOException; import java.io.PrintWriter; import javax.servlet.ServletException; import javax.servlet.http.HttpServlet; import javax.servlet.http.HttpServletRequest; import javax.servlet.http.HttpServletResponse; public class SecureServlet extends HttpServlet { protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { String userInput = request.getParameter(""input""); // Sanitize user input to prevent XSS String safeUserInput = sanitizeInput(userInput); String output = ""<p>User input: "" + safeUserInput + ""</p>""; PrintWriter out = response.getWriter(); out.println(output); } // Method to sanitize user input private String sanitizeInput(String input) { // Implement your sanitization logic here // For example, you can use OWASP Java Encoder library or a custom sanitizer function // Here is a simple example using Apache Commons Text library for HTML escaping: return org.apache.commons.text.StringEscapeUtils.escapeHtml4(input); }",java,0
Memory Corruption,"#include <iostream>

void unsafe_virtual_call() {
    // Potential vtable corruption vulnerability
    class Base {
    public:
        virtual void func() { std::cout << ""Base"" << std::endl; }
    };
    
    class Derived : public Base {
    public:
        void func() override { std::cout << ""Derived"" << std::endl; }
    };
}","#include <iostream>

void unsafe_virtual_call() {
    // Potential vtable corruption vulnerability
    class Base {
    public:
        virtual void func() { std::cout << ""Base"" << std::endl; }
    };
    
    class Derived : public Base {
    public:
        void func() override { std::cout << ""Derived"" << std::endl; }
    };
}",cpp,1
File Inclusion,"<?php
$file = $_GET['file'];
include($file); // File Inclusion
?>","<?php
$file = $_GET['file'];
include($file); // File Inclusion
?>",php,1
Hardcoded Secrets,"import requests
def call_api():
    api_key = ""sk_live_1234567890abcdef""
    headers = {'Authorization': f'Bearer {api_key}'}
    return requests.get('https://api.example.com/data', headers=headers)","import requests
def call_api():
    api_key = ""sk_live_1234567890abcdef""
    headers = {'Authorization': f'Bearer {api_key}'}
    return requests.get('https://api.example.com/data', headers=headers)",python,1
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Command Injection,"import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class CommandInjectionVulnerable {

    public static void main(String[] args) {
        try {
            BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));
            System.out.print(""Enter a command to execute: "");
            String command = reader.readLine();

            Process process = Runtime.getRuntime().exec(command);
            BufferedReader inputReader = new BufferedReader(new InputStreamReader(process.getInputStream()));

            String line;
            while ((line = inputReader.readLine()) != null) {
                System.out.println(line);
            }
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}","import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class CommandInjectionVulnerable { public static void main(String[] args) { try { BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a command to execute: ""); String command = reader.readLine(); Process process = Runtime.getRuntime().exec(command); BufferedReader inputReader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = inputReader.readLine()) != null) { System.out.println(line); } } catch (IOException e) { e.printStackTrace(); } } }",java,1
Command Injection,"const shell = require('child_process');
shell.exec('ping ' + userInput); // Command Injection
","const shell = require('child_process');
shell.exec('ping ' + userInput); // Command Injection
",javascript,1
SQL Injection,"import psycopg2
def admin_login(admin_id):
    conn = psycopg2.connect(""dbname=test user=postgres"")
    cur = conn.cursor()
    cur.execute(f""SELECT * FROM admins WHERE id = {admin_id}"")
    return cur.fetchone()","import psycopg2
def admin_login(admin_id):
    conn = psycopg2.connect(""dbname=test user=postgres"")
    cur = conn.cursor()
    cur.execute(f""SELECT * FROM admins WHERE id = {admin_id}"")
    return cur.fetchone()",python,1
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Clear,"import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;

public class SecureSQLInjection {

    public static void main(String[] args) {
        String userInput = ""'; DROP TABLE users; --""; // Malicious input simulating SQL Injection
        
        try {
            Connection connection = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");
            
            String query = ""SELECT * FROM users WHERE username=?"";
            PreparedStatement preparedStatement = connection.prepareStatement(query);
            preparedStatement.setString(1, userInput); // Set user input as parameter
            
            ResultSet resultSet = preparedStatement.executeQuery();
            
            while (resultSet.next()) {
                System.out.println(""Username: "" + resultSet.getString(""username""));
            }
            
            connection.close();
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.Connection; import java.sql.DriverManager; import java.sql.PreparedStatement; import java.sql.ResultSet; import java.sql.SQLException; public class SecureSQLInjection { public static void main(String[] args) { String userInput = ""'; DROP TABLE users; --""; // Malicious input simulating SQL Injection try { Connection connection = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); String query = ""SELECT * FROM users WHERE username=?""; PreparedStatement preparedStatement = connection.prepareStatement(query); preparedStatement.setString(1, userInput); // Set user input as parameter ResultSet resultSet = preparedStatement.executeQuery(); while (resultSet.next()) { System.out.println(""Username: "" + resultSet.getString(""username"")); } connection.close(); } catch (SQLException e) { e.printStackTrace(); } } }",java,0
Clear,"import java.sql.*;

public class SecureSQLInjection {

    public static void main(String[] args) {
        String userInput = ""'; DROP TABLE users; --""; // Malicious input

        try {
            Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");
            
            // Use prepared statement with placeholders for user input
            String query = ""SELECT * FROM users WHERE username = ?"";
            PreparedStatement pstmt = conn.prepareStatement(query);
            
            // Set the parameter value for the placeholder
            pstmt.setString(1, userInput);

            ResultSet rs = pstmt.executeQuery();

            while (rs.next()) {
                System.out.println(""User found: "" + rs.getString(""username""));
            }

            conn.close();
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.*; public class SecureSQLInjection { public static void main(String[] args) { String userInput = ""'; DROP TABLE users; --""; // Malicious input try { Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); // Use prepared statement with placeholders for user input String query = ""SELECT * FROM users WHERE username = ?""; PreparedStatement pstmt = conn.prepareStatement(query); // Set the parameter value for the placeholder pstmt.setString(1, userInput); ResultSet rs = pstmt.executeQuery(); while (rs.next()) { System.out.println(""User found: "" + rs.getString(""username"")); } conn.close(); } catch (SQLException e) { e.printStackTrace(); } } }",java,0
Command Injection,"import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class CommandInjectionExample {

    public static void main(String[] args) throws IOException {
        BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));
        
        System.out.print(""Enter a command to execute: "");
        String userInput = reader.readLine();
        
        // Vulnerable code that directly executes user input as a command
        Runtime.getRuntime().exec(userInput);
    }
}","import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class CommandInjectionExample { public static void main(String[] args) throws IOException { BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a command to execute: ""); String userInput = reader.readLine(); // Vulnerable code that directly executes user input as a command Runtime.getRuntime().exec(userInput); } }",java,1
Clear,"const shell = require('child_process');
const safeInput = userInput.replace(/[^a-zA-Z0-9.]/g, '');
shell.execFile('ping', [safeInput]); // Safe command execution
","const shell = require('child_process');
const safeInput = userInput.replace(/[^a-zA-Z0-9.]/g, '');
shell.execFile('ping', [safeInput]); // Safe command execution
",javascript,0
SQL Injection,"import java.sql.*;

public class VulnerableCode {

    public static void main(String[] args) {
        String userInput = ""'; DROP TABLE users; --"";
        String query = ""SELECT * FROM users WHERE username = '"" + userInput + ""'"";

        try {
            Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""root"", ""password"");
            Statement stmt = conn.createStatement();
            ResultSet rs = stmt.executeQuery(query);

            while (rs.next()) {
                System.out.println(""User found: "" + rs.getString(""username""));
            }

            conn.close();
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.*; public class VulnerableCode { public static void main(String[] args) { String userInput = ""'; DROP TABLE users; --""; String query = ""SELECT * FROM users WHERE username = '"" + userInput + ""'""; try { Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""root"", ""password""); Statement stmt = conn.createStatement(); ResultSet rs = stmt.executeQuery(query); while (rs.next()) { System.out.println(""User found: "" + rs.getString(""username"")); } conn.close(); } catch (SQLException e) { e.printStackTrace(); } } }",java,1
Clear,"To prevent Cross-Site Scripting (XSS) attacks, you need to properly sanitize and encode the user input before including it in the HTML response. One way to do this is by using OWASP's ESAPI library for Java, which provides security encoding functions.

Here's how you can fix the insecure code snippet using ESAPI:

1. Add the OWASP ESAPI dependency to your project. You can download the jar file from https://owasp.org/www-project-esapi/.

2. Modify the doPost method to properly sanitize and encode the user input:

```java
import org.owasp.esapi.ESAPI;
import org.owasp.esapi.Encoder;

protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
    String userInput = request.getParameter(""input"");

    Encoder encoder = ESAPI.encoder();
    String sanitizedInput = encoder.encodeForHTML(userInput);

    PrintWriter out = response.getWriter();
    out.println(""<html>"");
    out.println(""<body>"");
    out.println(""<h2>User Input:</h2>"");
    out.println(""<p>"" + sanitizedInput + ""</p>""); // Sanitized input is now printed to the HTML
    out.println(""</body>"");
    out.println(""</html>"");
}
``","To prevent Cross-Site Scripting (XSS) attacks, you need to properly sanitize and encode the user input before including it in the HTML response. One way to do this is by using OWASP's ESAPI library for Java, which provides security encoding functions. Here's how you can fix the insecure code snippet using ESAPI: 1. Add the OWASP ESAPI dependency to your project. You can download the jar file from https://owasp.org/www-project-esapi/. 2. Modify the doPost method to properly sanitize and encode the user input: ```java import org.owasp.esapi.ESAPI; import org.owasp.esapi.Encoder; protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { String userInput = request.getParameter(""input""); Encoder encoder = ESAPI.encoder(); String sanitizedInput = encoder.encodeForHTML(userInput); PrintWriter out = response.getWriter(); out.println(""<html>""); out.println(""<body>""); out.println(""<h2>User Input:</h2>""); out.println(""<p>"" + sanitizedInput + ""</p>""); // Sanitized input is now printed to the HTML out.println(""</body>""); out.println(""</html>""); } ``",python,0
Clear,"#include <iostream>
#include <string>
#include <vector>

void safe_string_handling(const std::string& input) {
    std::string safe_copy = input;
    std::cout << safe_copy << std::endl;
}","#include <iostream>
#include <string>
#include <vector>

void safe_string_handling(const std::string& input) {
    std::string safe_copy = input;
    std::cout << safe_copy << std::endl;
}",cpp,0
SQL Injection,"<?php
$username = $_POST['username'];
$query = ""SELECT * FROM users WHERE username = '$username'"";
$result = mysql_query($query); // SQL Injection
?>","<?php
$username = $_POST['username'];
$query = ""SELECT * FROM users WHERE username = '$username'"";
$result = mysql_query($query); // SQL Injection
?>",php,1
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Clear,"import yaml
def safe_yaml_load(config_str):
    return yaml.safe_load(config_str)","import yaml
def safe_yaml_load(config_str):
    return yaml.safe_load(config_str)",python,0
Path Traversal,"import os
def read_file(filename):
    with open('/var/www/uploads/' + filename, 'r') as f:
        return f.read()","import os
def read_file(filename):
    with open('/var/www/uploads/' + filename, 'r') as f:
        return f.read()",python,1
Clear,"<?php
$username = $_POST['username'];
$stmt = $pdo->prepare(""SELECT * FROM users WHERE username = ?"");
$stmt->execute([$username]); // Parameterized query
?>","<?php
$username = $_POST['username'];
$stmt = $pdo->prepare(""SELECT * FROM users WHERE username = ?"");
$stmt->execute([$username]); // Parameterized query
?>",php,0
Cross-Site Scripting (XSS),"import java.io.IOException;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

public class VulnerableServlet extends HttpServlet {
    
    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws IOException {
        
        String userInput = request.getParameter(""input"");
        String output = ""Hello, "" + userInput + ""!""; // Improperly handling user input
        
        response.getWriter().write(""<html><body>"");
        response.getWriter().write(""<h1>"" + output + ""</h1>""); // Vulnerable to XSS
        response.getWriter().write(""</body></html>"");
    }
}","import java.io.IOException; import javax.servlet.http.HttpServlet; import javax.servlet.http.HttpServletRequest; import javax.servlet.http.HttpServletResponse; public class VulnerableServlet extends HttpServlet { protected void doGet(HttpServletRequest request, HttpServletResponse response) throws IOException { String userInput = request.getParameter(""input""); String output = ""Hello, "" + userInput + ""!""; // Improperly handling user input response.getWriter().write(""<html><body>""); response.getWriter().write(""<h1>"" + output + ""</h1>""); // Vulnerable to XSS response.getWriter().write(""</body></html>""); } }",java,1
XSS,"const userInput = document.location.search.split('=')[1];
document.write(userInput); // XSS
","const userInput = document.location.search.split('=')[1];
document.write(userInput); // XSS
",javascript,1
Path Traversal,"import os
def read_file(filename):
    with open('/var/www/uploads/' + filename, 'r') as f:
        return f.read()","import os
def read_file(filename):
    with open('/var/www/uploads/' + filename, 'r') as f:
        return f.read()",python,1
Clear,"import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class SafeCommandExecutionExample {

    public static void main(String[] args) {
        try {
            BufferedReader br = new BufferedReader(new InputStreamReader(System.in));
            System.out.print(""Enter a command to execute: "");
            String command = br.readLine();

            // Use ProcessBuilder to safely execute the command
            ProcessBuilder processBuilder = new ProcessBuilder(command.split(""\\s+""));
            Process process = processBuilder.start();

            BufferedReader reader = new BufferedReader(new InputStreamReader(process.getInputStream()));
            String line;
            while ((line = reader.readLine()) != null) {
                System.out.println(line);
            }

        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}","import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class SafeCommandExecutionExample { public static void main(String[] args) { try { BufferedReader br = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a command to execute: ""); String command = br.readLine(); // Use ProcessBuilder to safely execute the command ProcessBuilder processBuilder = new ProcessBuilder(command.split(""\\s+"")); Process process = processBuilder.start(); BufferedReader reader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = reader.readLine()) != null) { System.out.println(line); } } catch (IOException e) { e.printStackTrace(); } } }",java,0
File Inclusion,"<?php
$file = $_GET['file'];
include($file); // File Inclusion
?>","<?php
$file = $_GET['file'];
include($file); // File Inclusion
?>",php,1
Clear,"const userInput = new URLSearchParams(window.location.search).get('input');
const safeOutput = document.createElement('div');
safeOutput.textContent = userInput; // Safe DOM manipulation
document.body.appendChild(safeOutput);
","const userInput = new URLSearchParams(window.location.search).get('input');
const safeOutput = document.createElement('div');
safeOutput.textContent = userInput; // Safe DOM manipulation
document.body.appendChild(safeOutput);
",javascript,0
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Insecure Deserialization,"import yaml
def load_config(config_str):
    return yaml.load(config_str, Loader=yaml.Loader)","import yaml
def load_config(config_str):
    return yaml.load(config_str, Loader=yaml.Loader)",python,1
Clear,"<?php
$username = $_POST['username'];
$stmt = $pdo->prepare(""SELECT * FROM users WHERE username = ?"");
$stmt->execute([$username]); // Parameterized query
?>","<?php
$username = $_POST['username'];
$stmt = $pdo->prepare(""SELECT * FROM users WHERE username = ?"");
$stmt->execute([$username]); // Parameterized query
?>",php,0
Clear,"<?php
$input = json_decode($_POST['data'], true); // Safe JSON parsing
if (json_last_error() === JSON_ERROR_NONE) {
    process_data($input);
}
?>","<?php
$input = json_decode($_POST['data'], true); // Safe JSON parsing
if (json_last_error() === JSON_ERROR_NONE) {
    process_data($input);
}
?>",php,0
Buffer Overflow,"#include <iostream>
#include <cstring>

void unsafe_c_string(char* input) {
    char buffer[100];
    strcpy(buffer, input); // potential buffer overflow
    std::cout << buffer << std::endl;
}","#include <iostream>
#include <cstring>

void unsafe_c_string(char* input) {
    char buffer[100];
    strcpy(buffer, input); // potential buffer overflow
    std::cout << buffer << std::endl;
}",cpp,1
Clear,"#include <stdio.h>
#include <string.h>

int validate_input(const char *input) {
    if (input == NULL) return 0;
    for (int i = 0; input[i] != '\0'; i++) {
        if (input[i] < 32 || input[i] > 126) {
            return 0; // invalid character
        }
    }
    return 1;
}","#include <stdio.h>
#include <string.h>

int validate_input(const char *input) {
    if (input == NULL) return 0;
    for (int i = 0; input[i] != '\0'; i++) {
        if (input[i] < 32 || input[i] > 126) {
            return 0; // invalid character
        }
    }
    return 1;
}",c,0
Clear,"#include <stdio.h>
#include <stdlib.h>

int safe_string_to_int(const char *str) {
    char *endptr;
    long value = strtol(str, &endptr, 10);
    if (*endptr != '\0' || str == endptr) {
        return -1; // error
    }
    return (int)value;
}","#include <stdio.h>
#include <stdlib.h>

int safe_string_to_int(const char *str) {
    char *endptr;
    long value = strtol(str, &endptr, 10);
    if (*endptr != '\0' || str == endptr) {
        return -1; // error
    }
    return (int)value;
}",c,0
Clear,"import jwt
import os
from datetime import datetime, timedelta

def create_safe_token(user_id):
    payload = {
        'user_id': user_id,
        'exp': datetime.utcnow() + timedelta(hours=1)
    }
    secret = os.environ.get('JWT_SECRET')
    return jwt.encode(payload, secret, algorithm='HS256')","import jwt
import os
from datetime import datetime, timedelta

def create_safe_token(user_id):
    payload = {
        'user_id': user_id,
        'exp': datetime.utcnow() + timedelta(hours=1)
    }
    secret = os.environ.get('JWT_SECRET')
    return jwt.encode(payload, secret, algorithm='HS256')",python,0
Clear,"#include <stdio.h>
#include <stdlib.h>

void safe_file_operation(const char *filename) {
    FILE *file = fopen(filename, ""r"");
    if (file != NULL) {
        char buffer[256];
        while (fgets(buffer, sizeof(buffer), file)) {
            printf(""%s"", buffer);
        }
        fclose(file);
    }
}","#include <stdio.h>
#include <stdlib.h>

void safe_file_operation(const char *filename) {
    FILE *file = fopen(filename, ""r"");
    if (file != NULL) {
        char buffer[256];
        while (fgets(buffer, sizeof(buffer), file)) {
            printf(""%s"", buffer);
        }
        fclose(file);
    }
}",c,0
Clear,"import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.util.Scanner;

public class SecureCode {
    public static void main(String[] args) {
        try {
            // Get user input
            Scanner scanner = new Scanner(System.in);
            System.out.print(""Enter username: "");
            String username = scanner.nextLine();

            // Establish database connection
            Connection connection = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");

            // Use a prepared statement to avoid SQL Injection
            String query = ""SELECT * FROM users WHERE username=?"";
            PreparedStatement preparedStatement = connection.prepareStatement(query);
            preparedStatement.setString(1, username);

            // Execute the prepared statement
            ResultSet resultSet = preparedStatement.executeQuery();

            // Display the results
            while (resultSet.next()) {
                System.out.println(""User found: "" + resultSet.getString(""username""));
            }

        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.Connection; import java.sql.DriverManager; import java.sql.PreparedStatement; import java.sql.ResultSet; import java.sql.SQLException; import java.util.Scanner; public class SecureCode { public static void main(String[] args) { try { // Get user input Scanner scanner = new Scanner(System.in); System.out.print(""Enter username: ""); String username = scanner.nextLine(); // Establish database connection Connection connection = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); // Use a prepared statement to avoid SQL Injection String query = ""SELECT * FROM users WHERE username=?""; PreparedStatement preparedStatement = connection.prepareStatement(query); preparedStatement.setString(1, username); // Execute the prepared statement ResultSet resultSet = preparedStatement.executeQuery(); // Display the results while (resultSet.next()) { System.out.println(""User found: "" + resultSet.getString(""username"")); } } catch (SQLException e) { e.printStackTrace(); } } }",java,0
Clear,"import java.sql.*;

public class SQLInjectionSecure {

    public static void main(String[] args) {
        try {
            String userInput = ""1'; DROP TABLE users; --"";

            // Connecting to a sample database
            Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/sample_db"", ""username"", ""password"");
            
            // Use PreparedStatement to prevent SQL Injection
            String query = ""SELECT * FROM users WHERE id = ?"";
            PreparedStatement pstmt = conn.prepareStatement(query);
            pstmt.setString(1, userInput);

            ResultSet rs = pstmt.executeQuery();

            while (rs.next()) {
                System.out.println(""User ID: "" + rs.getInt(""id"") + "", Name: "" + rs.getString(""name""));
            }

        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.*; public class SQLInjectionSecure { public static void main(String[] args) { try { String userInput = ""1'; DROP TABLE users; --""; // Connecting to a sample database Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/sample_db"", ""username"", ""password""); // Use PreparedStatement to prevent SQL Injection String query = ""SELECT * FROM users WHERE id = ?""; PreparedStatement pstmt = conn.prepareStatement(query); pstmt.setString(1, userInput); ResultSet rs = pstmt.executeQuery(); while (rs.next()) { System.out.println(""User ID: "" + rs.getInt(""id"") + "", Name: "" + rs.getString(""name"")); } } catch (SQLException e) { e.printStackTrace(); } } }",java,0
Path Traversal,"import java.io.BufferedReader;
import java.io.File;
import java.io.FileReader;
import java.io.IOException;

public class PathTraversalVulnerability {

    public static void main(String[] args) {
        String fileName = args[0]; // User input for file name
        readFile(fileName);
    }

    public static void readFile(String fileName) {
        try {
            File file = new File(""/path/to/safe/directory/"" + fileName);
            BufferedReader br = new BufferedReader(new FileReader(file));
            String line;
            while ((line = br.readLine()) != null) {
                System.out.println(line);
            }
            br.close();
        } catch (IOException e) {
            System.out.println(""Error reading file: "" + e.getMessage());
        }
    }
}","import java.io.BufferedReader; import java.io.File; import java.io.FileReader; import java.io.IOException; public class PathTraversalVulnerability { public static void main(String[] args) { String fileName = args[0]; // User input for file name readFile(fileName); } public static void readFile(String fileName) { try { File file = new File(""/path/to/safe/directory/"" + fileName); BufferedReader br = new BufferedReader(new FileReader(file)); String line; while ((line = br.readLine()) != null) { System.out.println(line); } br.close(); } catch (IOException e) { System.out.println(""Error reading file: "" + e.getMessage()); } } }",java,1
Clear,"<?php
$cmd = escapeshellarg($_GET['cmd']);
system(""ls "" . $cmd); // Escaped command
?>","<?php
$cmd = escapeshellarg($_GET['cmd']);
system(""ls "" . $cmd); // Escaped command
?>",php,0
Command Injection,"import os
def backup_database(db_name):
    os.system(f""pg_dump {db_name} > backup.sql"")","import os
def backup_database(db_name):
    os.system(f""pg_dump {db_name} > backup.sql"")",python,1
Clear,"const userInput = new URLSearchParams(window.location.search).get('input');
const safeOutput = document.createElement('div');
safeOutput.textContent = userInput; // Safe DOM manipulation
document.body.appendChild(safeOutput);
","const userInput = new URLSearchParams(window.location.search).get('input');
const safeOutput = document.createElement('div');
safeOutput.textContent = userInput; // Safe DOM manipulation
document.body.appendChild(safeOutput);
",javascript,0
Clear,"import org.owasp.esapi.ESAPI;
import org.owasp.esapi.errors.EncodingException;

protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {

    String userInput = request.getParameter(""input"");

    String sanitizedInput = ESAPI.encoder().canonicalize(userInput);
    String safeOutput = """";

    try {
        safeOutput = ""<p>User input: "" + ESAPI.encoder().encodeForHTML(sanitizedInput) + ""</p>"";
    } catch (EncodingException e) {
        // Handle encoding exception
        e.printStackTrace();
    }

    response.getWriter().println(safeOutput);
}","import org.owasp.esapi.ESAPI; import org.owasp.esapi.errors.EncodingException; protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { String userInput = request.getParameter(""input""); String sanitizedInput = ESAPI.encoder().canonicalize(userInput); String safeOutput = """"; try { safeOutput = ""<p>User input: "" + ESAPI.encoder().encodeForHTML(sanitizedInput) + ""</p>""; } catch (EncodingException e) { // Handle encoding exception e.printStackTrace(); } response.getWriter().println(safeOutput); }",python,0
Command Injection,"const shell = require('child_process');
shell.exec('ping ' + userInput); // Command Injection
","const shell = require('child_process');
shell.exec('ping ' + userInput); // Command Injection
",javascript,1
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Clear,"import os
def get_database_config():
    return {
        'host': os.environ.get('DB_HOST'),
        'user': os.environ.get('DB_USER'),
        'password': os.environ.get('DB_PASSWORD')
    }","import os
def get_database_config():
    return {
        'host': os.environ.get('DB_HOST'),
        'user': os.environ.get('DB_USER'),
        'password': os.environ.get('DB_PASSWORD')
    }",python,0
Clear,"#include <stdio.h>
#include <string.h>

void safe_string_copy(char *dest, const char *src, size_t dest_size) {
    if (dest_size > 0) {
        strncpy(dest, src, dest_size - 1);
        dest[dest_size - 1] = '\0';
    }
}","#include <stdio.h>
#include <string.h>

void safe_string_copy(char *dest, const char *src, size_t dest_size) {
    if (dest_size > 0) {
        strncpy(dest, src, dest_size - 1);
        dest[dest_size - 1] = '\0';
    }
}",c,0
Clear,"<?php
$message = htmlspecialchars($_GET['message'], ENT_QUOTES, 'UTF-8');
echo $message; // Sanitized output
?>","<?php
$message = htmlspecialchars($_GET['message'], ENT_QUOTES, 'UTF-8');
echo $message; // Sanitized output
?>",php,0
Clear,"#include <iostream>
#include <vector>
#include <stdexcept>

int safe_vector_access(const std::vector<int>& vec, size_t index) {
    if (index >= vec.size()) {
        throw std::out_of_range(""Index out of range"");
    }
    return vec[index];
}","#include <iostream>
#include <vector>
#include <stdexcept>

int safe_vector_access(const std::vector<int>& vec, size_t index) {
    if (index >= vec.size()) {
        throw std::out_of_range(""Index out of range"");
    }
    return vec[index];
}",cpp,0
SQL Injection,"import java.sql.*;

public class SQLInjectionExample {
    public static void main(String[] args) {
        String userInput = ""'; DROP TABLE users; --"";
        
        try {
            Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");
            Statement stmt = conn.createStatement();
            
            String query = ""SELECT * FROM users WHERE username = '"" + userInput + ""'"";
            ResultSet rs = stmt.executeQuery(query);
            
            while (rs.next()) {
                System.out.println(""User: "" + rs.getString(""username""));
            }
            
            conn.close();
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.*; public class SQLInjectionExample { public static void main(String[] args) { String userInput = ""'; DROP TABLE users; --""; try { Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); Statement stmt = conn.createStatement(); String query = ""SELECT * FROM users WHERE username = '"" + userInput + ""'""; ResultSet rs = stmt.executeQuery(query); while (rs.next()) { System.out.println(""User: "" + rs.getString(""username"")); } conn.close(); } catch (SQLException e) { e.printStackTrace(); } } }",java,1
XSS,"<?php
echo $_GET['message']; // XSS
?>","<?php
echo $_GET['message']; // XSS
?>",php,1
Clear,"#include <iostream>
#include <fstream>
#include <string>

void safe_file_reading(const std::string& filename) {
    std::ifstream file(filename);
    if (file.is_open()) {
        std::string line;
        while (std::getline(file, line)) {
            std::cout << line << std::endl;
        }
    }
}","#include <iostream>
#include <fstream>
#include <string>

void safe_file_reading(const std::string& filename) {
    std::ifstream file(filename);
    if (file.is_open()) {
        std::string line;
        while (std::getline(file, line)) {
            std::cout << line << std::endl;
        }
    }
}",cpp,0
Memory Corruption,"#include <iostream>

void unsafe_virtual_call() {
    // Potential vtable corruption vulnerability
    class Base {
    public:
        virtual void func() { std::cout << ""Base"" << std::endl; }
    };
    
    class Derived : public Base {
    public:
        void func() override { std::cout << ""Derived"" << std::endl; }
    };
}","#include <iostream>

void unsafe_virtual_call() {
    // Potential vtable corruption vulnerability
    class Base {
    public:
        virtual void func() { std::cout << ""Base"" << std::endl; }
    };
    
    class Derived : public Base {
    public:
        void func() override { std::cout << ""Derived"" << std::endl; }
    };
}",cpp,1
Command Injection,"import os
def ping_host(host):
    os.system(""ping -c 4 "" + host)","import os
def ping_host(host):
    os.system(""ping -c 4 "" + host)",python,1
Clear,"import os
def get_api_key():
    return os.environ.get('API_KEY')","import os
def get_api_key():
    return os.environ.get('API_KEY')",python,0
Command Injection,"import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class CommandInjectionVulnerable {

    public static void main(String[] args) {
        try {
            BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));
            System.out.print(""Enter a command to execute: "");
            String command = reader.readLine();
            
            Process process = Runtime.getRuntime().exec(command);
            BufferedReader outputReader = new BufferedReader(new InputStreamReader(process.getInputStream()));
            String line;
            
            while ((line = outputReader.readLine()) != null) {
                System.out.println(line);
            }
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}","import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class CommandInjectionVulnerable { public static void main(String[] args) { try { BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a command to execute: ""); String command = reader.readLine(); Process process = Runtime.getRuntime().exec(command); BufferedReader outputReader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = outputReader.readLine()) != null) { System.out.println(line); } } catch (IOException e) { e.printStackTrace(); } } }",java,1
SQL Injection,"import java.sql.*;

public class SQLInjectionVulnerableCode {

    public static void main(String[] args) {
        try {
            String userInput = ""'; DROP TABLE users; --""; // Malicious input simulating SQL Injection
            String query = ""SELECT * FROM users WHERE username = '"" + userInput + ""'"";
            
            Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");
            Statement stmt = conn.createStatement();
            ResultSet rs = stmt.executeQuery(query);

            while (rs.next()) {
                System.out.println(""Username: "" + rs.getString(""username"") + "", Password: "" + rs.getString(""password""));
            }

            conn.close();
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.*; public class SQLInjectionVulnerableCode { public static void main(String[] args) { try { String userInput = ""'; DROP TABLE users; --""; // Malicious input simulating SQL Injection String query = ""SELECT * FROM users WHERE username = '"" + userInput + ""'""; Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); Statement stmt = conn.createStatement(); ResultSet rs = stmt.executeQuery(query); while (rs.next()) { System.out.println(""Username: "" + rs.getString(""username"") + "", Password: "" + rs.getString(""password"")); } conn.close(); } catch (SQLException e) { e.printStackTrace(); } } }",java,1
Clear,"#include <iostream>
#include <memory>

void safe_memory_management() {
    auto ptr = std::make_unique<int>(42);
    std::cout << *ptr << std::endl;
}","#include <iostream>
#include <memory>

void safe_memory_management() {
    auto ptr = std::make_unique<int>(42);
    std::cout << *ptr << std::endl;
}",cpp,0
Clear,"import java.io.IOException;
import javax.servlet.ServletException;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import org.owasp.encoder.Encode;

public class SecureServlet extends HttpServlet {

    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        String userInput = request.getParameter(""input"");
        String encodedUserInput = Encode.forHtml(userInput);
        String output = ""Hello, "" + encodedUserInput + ""!"";

        response.getWriter().println(""<html><body>"");
        response.getWriter().println(""<h1>"" + output + ""</h1>"");
        response.getWriter().println(""</body></html>"");
    }
}","import java.io.IOException; import javax.servlet.ServletException; import javax.servlet.http.HttpServlet; import javax.servlet.http.HttpServletRequest; import javax.servlet.http.HttpServletResponse; import org.owasp.encoder.Encode; public class SecureServlet extends HttpServlet { protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { String userInput = request.getParameter(""input""); String encodedUserInput = Encode.forHtml(userInput); String output = ""Hello, "" + encodedUserInput + ""!""; response.getWriter().println(""<html><body>""); response.getWriter().println(""<h1>"" + output + ""</h1>""); response.getWriter().println(""</body></html>""); } }",java,0
Cross-Site Scripting (XSS),"import java.io.*;
import javax.servlet.*;
import javax.servlet.http.*;

public class XSSVulnerableServlet extends HttpServlet {
    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        String userInput = request.getParameter(""input"");
        
        String output = ""<html><body>User Input: "" + userInput + ""</body></html>"";
        
        PrintWriter out = response.getWriter();
        out.println(output);
    }
}","import java.io.*; import javax.servlet.*; import javax.servlet.http.*; public class XSSVulnerableServlet extends HttpServlet { protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { String userInput = request.getParameter(""input""); String output = ""<html><body>User Input: "" + userInput + ""</body></html>""; PrintWriter out = response.getWriter(); out.println(output); } }",java,1
SSRF,"import urllib.request
def download_file(file_url):
    return urllib.request.urlopen(file_url).read()","import urllib.request
def download_file(file_url):
    return urllib.request.urlopen(file_url).read()",python,1
Clear,"#include <iostream>
#include <vector>
#include <stdexcept>

int safe_vector_access(const std::vector<int>& vec, size_t index) {
    if (index >= vec.size()) {
        throw std::out_of_range(""Index out of range"");
    }
    return vec[index];
}","#include <iostream>
#include <vector>
#include <stdexcept>

int safe_vector_access(const std::vector<int>& vec, size_t index) {
    if (index >= vec.size()) {
        throw std::out_of_range(""Index out of range"");
    }
    return vec[index];
}",cpp,0
Clear,"#include <iostream>
#include <fstream>
#include <string>

void safe_file_reading(const std::string& filename) {
    std::ifstream file(filename);
    if (file.is_open()) {
        std::string line;
        while (std::getline(file, line)) {
            std::cout << line << std::endl;
        }
    }
}","#include <iostream>
#include <fstream>
#include <string>

void safe_file_reading(const std::string& filename) {
    std::ifstream file(filename);
    if (file.is_open()) {
        std::string line;
        while (std::getline(file, line)) {
            std::cout << line << std::endl;
        }
    }
}",cpp,0
Clear,"import mysql.connector
def safe_product_search(category):
    db = mysql.connector.connect(host=""localhost"", user=""user"", password=""pass"", database=""shop"")
    cursor = db.cursor()
    cursor.execute(""SELECT * FROM products WHERE category = %s"", (category,))
    return cursor.fetchall()","import mysql.connector
def safe_product_search(category):
    db = mysql.connector.connect(host=""localhost"", user=""user"", password=""pass"", database=""shop"")
    cursor = db.cursor()
    cursor.execute(""SELECT * FROM products WHERE category = %s"", (category,))
    return cursor.fetchall()",python,0
SQL Injection,"app.get('/user/:id', (req, res) => {
    const query = `SELECT * FROM users WHERE id = ${req.params.id}`; // SQL Injection
    db.query(query, (err, result) => {
        res.json(result);
    });
});
","app.get('/user/:id', (req, res) => {
    const query = `SELECT * FROM users WHERE id = ${req.params.id}`; // SQL Injection
    db.query(query, (err, result) => {
        res.json(result);
    });
});
",javascript,1
Clear,"#include <iostream>
#include <vector>
#include <stdexcept>

int safe_vector_access(const std::vector<int>& vec, size_t index) {
    if (index >= vec.size()) {
        throw std::out_of_range(""Index out of range"");
    }
    return vec[index];
}","#include <iostream>
#include <vector>
#include <stdexcept>

int safe_vector_access(const std::vector<int>& vec, size_t index) {
    if (index >= vec.size()) {
        throw std::out_of_range(""Index out of range"");
    }
    return vec[index];
}",cpp,0
Clear,"const userData = JSON.parse(userInput); // Safe JSON parsing
if (userData && typeof userData === 'object') {
    processUserData(userData);
}
","const userData = JSON.parse(userInput); // Safe JSON parsing
if (userData && typeof userData === 'object') {
    processUserData(userData);
}
",javascript,0
Clear,"import subprocess
def safe_database_backup(db_name):
    result = subprocess.run(['pg_dump', db_name], capture_output=True, text=True)
    with open('backup.sql', 'w') as f:
        f.write(result.stdout)","import subprocess
def safe_database_backup(db_name):
    result = subprocess.run(['pg_dump', db_name], capture_output=True, text=True)
    with open('backup.sql', 'w') as f:
        f.write(result.stdout)",python,0
Clear,"#include <iostream>
#include <string>
#include <vector>

void safe_string_handling(const std::string& input) {
    std::string safe_copy = input;
    std::cout << safe_copy << std::endl;
}","#include <iostream>
#include <string>
#include <vector>

void safe_string_handling(const std::string& input) {
    std::string safe_copy = input;
    std::cout << safe_copy << std::endl;
}",cpp,0
Insecure Deserialization,"import yaml
def load_config(config_str):
    return yaml.load(config_str, Loader=yaml.Loader)","import yaml
def load_config(config_str):
    return yaml.load(config_str, Loader=yaml.Loader)",python,1
Clear,"app.get('/user/:id', (req, res) => {
    const userId = parseInt(req.params.id);
    db.query('SELECT * FROM users WHERE id = ?', [userId], (err, result) => {
        res.json(result);
    });
});
","app.get('/user/:id', (req, res) => {
    const userId = parseInt(req.params.id);
    db.query('SELECT * FROM users WHERE id = ?', [userId], (err, result) => {
        res.json(result);
    });
});
",javascript,0
Clear,"import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.ResultSet;

public class SQLInjectionSecure {

    public static void main(String[] args) {
        String userInput = ""'; DROP TABLE users; --""; // Malicious input simulating a SQL Injection attack

        try {
            Connection connection = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");

            String query = ""SELECT * FROM users WHERE username = ?"";
            PreparedStatement statement = connection.prepareStatement(query);
            statement.setString(1, userInput);

            ResultSet resultSet = statement.executeQuery();

            while (resultSet.next()) {
                System.out.println(resultSet.getString(""username""));
            }

            resultSet.close();
            statement.close();
            connection.close();
        } catch (Exception e) {
            e.printStackTrace();
        }
    }
}","import java.sql.Connection; import java.sql.DriverManager; import java.sql.PreparedStatement; import java.sql.ResultSet; public class SQLInjectionSecure { public static void main(String[] args) { String userInput = ""'; DROP TABLE users; --""; // Malicious input simulating a SQL Injection attack try { Connection connection = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); String query = ""SELECT * FROM users WHERE username = ?""; PreparedStatement statement = connection.prepareStatement(query); statement.setString(1, userInput); ResultSet resultSet = statement.executeQuery(); while (resultSet.next()) { System.out.println(resultSet.getString(""username"")); } resultSet.close(); statement.close(); connection.close(); } catch (Exception e) { e.printStackTrace(); } } }",java,0
Clear,"app.get('/user/:id', (req, res) => {
    const userId = parseInt(req.params.id);
    db.query('SELECT * FROM users WHERE id = ?', [userId], (err, result) => {
        res.json(result);
    });
});
","app.get('/user/:id', (req, res) => {
    const userId = parseInt(req.params.id);
    db.query('SELECT * FROM users WHERE id = ?', [userId], (err, result) => {
        res.json(result);
    });
});
",javascript,0
XSS,"<?php
echo $_GET['message']; // XSS
?>","<?php
echo $_GET['message']; // XSS
?>",php,1
Clear,"import java.sql.*;

public class SecureSQLInjection {
    public static void main(String[] args) {
        String userInput = ""'; DROP TABLE users; --"";

        try {
            Connection connection = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");

            String query = ""SELECT * FROM users WHERE username = ?"";
            PreparedStatement preparedStatement = connection.prepareStatement(query);
            preparedStatement.setString(1, userInput);

            ResultSet resultSet = preparedStatement.executeQuery();

            while (resultSet.next()) {
                System.out.println(resultSet.getString(""username""));
            }

            connection.close();
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.*; public class SecureSQLInjection { public static void main(String[] args) { String userInput = ""'; DROP TABLE users; --""; try { Connection connection = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); String query = ""SELECT * FROM users WHERE username = ?""; PreparedStatement preparedStatement = connection.prepareStatement(query); preparedStatement.setString(1, userInput); ResultSet resultSet = preparedStatement.executeQuery(); while (resultSet.next()) { System.out.println(resultSet.getString(""username"")); } connection.close(); } catch (SQLException e) { e.printStackTrace(); } } }",java,0
Path Traversal,"import java.io.File;
import java.io.FileReader;
import java.io.IOException;
import java.util.Scanner;

public class PathTraversalVulnerability {

    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        System.out.print(""Enter a file name: "");
        String fileName = scanner.next();

        try {
            File file = new File(""/path/to/files/"" + fileName);
            FileReader fileReader = new FileReader(file);
            int data;
            while ((data = fileReader.read()) != -1) {
                System.out.print((char) data);
            }
            fileReader.close();
        } catch (IOException e) {
            System.out.println(""Error reading file: "" + e.getMessage());
        }
    }
}","import java.io.File; import java.io.FileReader; import java.io.IOException; import java.util.Scanner; public class PathTraversalVulnerability { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter a file name: ""); String fileName = scanner.next(); try { File file = new File(""/path/to/files/"" + fileName); FileReader fileReader = new FileReader(file); int data; while ((data = fileReader.read()) != -1) { System.out.print((char) data); } fileReader.close(); } catch (IOException e) { System.out.println(""Error reading file: "" + e.getMessage()); } } }",java,1
SQL Injection,"import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Statement;

public class VulnerableCode {

    public static void main(String[] args) {
        String userInput = ""'; DROP TABLE users; --""; // Malicious input

        try {
            Connection connection = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");
            Statement statement = connection.createStatement();

            String query = ""SELECT * FROM users WHERE username='"" + userInput + ""'"";
            ResultSet resultSet = statement.executeQuery(query);

            while (resultSet.next()) {
                System.out.println(resultSet.getString(""username""));
            }

        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.Connection; import java.sql.DriverManager; import java.sql.ResultSet; import java.sql.SQLException; import java.sql.Statement; public class VulnerableCode { public static void main(String[] args) { String userInput = ""'; DROP TABLE users; --""; // Malicious input try { Connection connection = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); Statement statement = connection.createStatement(); String query = ""SELECT * FROM users WHERE username='"" + userInput + ""'""; ResultSet resultSet = statement.executeQuery(query); while (resultSet.next()) { System.out.println(resultSet.getString(""username"")); } } catch (SQLException e) { e.printStackTrace(); } } }",java,1
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
SQL Injection,"import sqlite3
def get_user_data(username):
    conn = sqlite3.connect('database.db')
    cursor = conn.cursor()
    query = ""SELECT * FROM users WHERE username = '"" + username + ""'""
    cursor.execute(query)
    return cursor.fetchall()","import sqlite3
def get_user_data(username):
    conn = sqlite3.connect('database.db')
    cursor = conn.cursor()
    query = ""SELECT * FROM users WHERE username = '"" + username + ""'""
    cursor.execute(query)
    return cursor.fetchall()",python,1
Hardcoded Secrets,"localStorage.setItem('token', 'hardcoded-secret-token-123'); // Hardcoded secret
","localStorage.setItem('token', 'hardcoded-secret-token-123'); // Hardcoded secret
",javascript,1
Buffer Overflow,"#include <iostream>
#include <cstring>

void unsafe_c_string(char* input) {
    char buffer[100];
    strcpy(buffer, input); // potential buffer overflow
    std::cout << buffer << std::endl;
}","#include <iostream>
#include <cstring>

void unsafe_c_string(char* input) {
    char buffer[100];
    strcpy(buffer, input); // potential buffer overflow
    std::cout << buffer << std::endl;
}",cpp,1
Clear,"import java.io.*;
import javax.servlet.*;
import javax.servlet.http.*;
import org.owasp.esapi.ESAPI;

public class SecureServlet extends HttpServlet {
    protected void doPost(HttpServletRequest request, HttpServletResponse response)
            throws ServletException, IOException {
        String userInput = request.getParameter(""input"");
        
        PrintWriter out = response.getWriter();
        out.println(""<html>"");
        out.println(""<body>"");
        out.println(""<h1>User Input: "" + ESAPI.encoder().encodeForHTML(userInput) + ""</h1>""); // Properly encode user input
        out.println(""</body>"");
        out.println(""</html>"");
    }
}","import java.io.*; import javax.servlet.*; import javax.servlet.http.*; import org.owasp.esapi.ESAPI; public class SecureServlet extends HttpServlet { protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { String userInput = request.getParameter(""input""); PrintWriter out = response.getWriter(); out.println(""<html>""); out.println(""<body>""); out.println(""<h1>User Input: "" + ESAPI.encoder().encodeForHTML(userInput) + ""</h1>""); // Properly encode user input out.println(""</body>""); out.println(""</html>""); } }",java,0
Clear,"#include <stdio.h>
#include <string.h>

void safe_string_copy(char *dest, const char *src, size_t dest_size) {
    if (dest_size > 0) {
        strncpy(dest, src, dest_size - 1);
        dest[dest_size - 1] = '\0';
    }
}","#include <stdio.h>
#include <string.h>

void safe_string_copy(char *dest, const char *src, size_t dest_size) {
    if (dest_size > 0) {
        strncpy(dest, src, dest_size - 1);
        dest[dest_size - 1] = '\0';
    }
}",c,0
Clear,"const userInput = new URLSearchParams(window.location.search).get('input');
const safeOutput = document.createElement('div');
safeOutput.textContent = userInput; // Safe DOM manipulation
document.body.appendChild(safeOutput);
","const userInput = new URLSearchParams(window.location.search).get('input');
const safeOutput = document.createElement('div');
safeOutput.textContent = userInput; // Safe DOM manipulation
document.body.appendChild(safeOutput);
",javascript,0
Code Injection,"const userData = eval('(' + userInput + ')'); // eval injection
","const userData = eval('(' + userInput + ')'); // eval injection
",javascript,1
Buffer Overflow,"#include <iostream>
#include <cstring>

void unsafe_c_string(char* input) {
    char buffer[100];
    strcpy(buffer, input); // potential buffer overflow
    std::cout << buffer << std::endl;
}","#include <iostream>
#include <cstring>

void unsafe_c_string(char* input) {
    char buffer[100];
    strcpy(buffer, input); // potential buffer overflow
    std::cout << buffer << std::endl;
}",cpp,1
Clear,"#include <stdio.h>
#include <string.h>

int safe_buffer_operation(char *input) {
    char buffer[100];
    if (strlen(input) < sizeof(buffer)) {
        strcpy(buffer, input);
        return 0;
    }
    return -1; // buffer too small
}","#include <stdio.h>
#include <string.h>

int safe_buffer_operation(char *input) {
    char buffer[100];
    if (strlen(input) < sizeof(buffer)) {
        strcpy(buffer, input);
        return 0;
    }
    return -1; // buffer too small
}",c,0
Clear,"import subprocess
def safe_ping(host):
    import re
    if not re.match(r'^[a-zA-Z0-9.-]+$', host):
        raise ValueError(""Invalid host"")
    result = subprocess.run(['ping', '-c', '4', host], capture_output=True, text=True)
    return result.stdout","import subprocess
def safe_ping(host):
    import re
    if not re.match(r'^[a-zA-Z0-9.-]+$', host):
        raise ValueError(""Invalid host"")
    result = subprocess.run(['ping', '-c', '4', host], capture_output=True, text=True)
    return result.stdout",python,0
Cross-Site Scripting (XSS),"import java.io.*;
import javax.servlet.*;
import javax.servlet.http.*;

public class VulnerableServlet extends HttpServlet {
    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        String userInput = request.getParameter(""input"");
        
        // Improper handling of user input
        String output = ""<p>User input: "" + userInput + ""</p>"";
        
        PrintWriter out = response.getWriter();
        out.println(""<html><body>"");
        out.println(output);
        out.println(""</body></html>"");
    }
}","import java.io.*; import javax.servlet.*; import javax.servlet.http.*; public class VulnerableServlet extends HttpServlet { protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { String userInput = request.getParameter(""input""); // Improper handling of user input String output = ""<p>User input: "" + userInput + ""</p>""; PrintWriter out = response.getWriter(); out.println(""<html><body>""); out.println(output); out.println(""</body></html>""); } }",java,1
Clear,"To fix the Command Injection vulnerability in the provided Java code snippet, you should sanitize and validate the user input before passing it to the command execution. Here is an improved version of the code with added security measures:

```java
import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class SecureCommandExecutionExample {

    public static void main(String[] args) throws IOException {
        BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));

        System.out.print(""Enter a command to execute: "");
        String userInput = reader.readLine();

        // Validate and sanitize user input to prevent command injection
        if (!isValidInput(userInput)) {
            System.out.println(""Invalid input. Please provide a valid command."");
            return;
        }

        // Execute the validated command
        Process process = Runtime.getRuntime().exec(userInput);

        BufferedReader outputReader = new BufferedReader(new InputStreamReader(process.getInputStream()));
        String line;

        while ((line = outputReader.readLine()) != null) {
            System.out.println(line);
        }
    }

    private static boolean isValidInput(String input) {
        // Add your validation logic here based on allowed characters or patterns
        // For example, you can restrict certain characters like semicolons, pipes, etc.","To fix the Command Injection vulnerability in the provided Java code snippet, you should sanitize and validate the user input before passing it to the command execution. Here is an improved version of the code with added security measures: ```java import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class SecureCommandExecutionExample { public static void main(String[] args) throws IOException { BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a command to execute: ""); String userInput = reader.readLine(); // Validate and sanitize user input to prevent command injection if (!isValidInput(userInput)) { System.out.println(""Invalid input. Please provide a valid command.""); return; } // Execute the validated command Process process = Runtime.getRuntime().exec(userInput); BufferedReader outputReader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = outputReader.readLine()) != null) { System.out.println(line); } } private static boolean isValidInput(String input) { // Add your validation logic here based on allowed characters or patterns // For example, you can restrict certain characters like semicolons, pipes, etc.",java,0
SQL Injection,"import psycopg2
def admin_login(admin_id):
    conn = psycopg2.connect(""dbname=test user=postgres"")
    cur = conn.cursor()
    cur.execute(f""SELECT * FROM admins WHERE id = {admin_id}"")
    return cur.fetchone()","import psycopg2
def admin_login(admin_id):
    conn = psycopg2.connect(""dbname=test user=postgres"")
    cur = conn.cursor()
    cur.execute(f""SELECT * FROM admins WHERE id = {admin_id}"")
    return cur.fetchone()",python,1
Clear,"#include <iostream>
#include <sstream>

int safe_string_to_int(const std::string& str) {
    std::stringstream ss(str);
    int value;
    if (ss >> value) {
        return value;
    }
    throw std::invalid_argument(""Invalid integer"");
}","#include <iostream>
#include <sstream>

int safe_string_to_int(const std::string& str) {
    std::stringstream ss(str);
    int value;
    if (ss >> value) {
        return value;
    }
    throw std::invalid_argument(""Invalid integer"");
}",cpp,0
XSS,"<?php
echo $_GET['message']; // XSS
?>","<?php
echo $_GET['message']; // XSS
?>",php,1
Code Injection,"const userData = eval('(' + userInput + ')'); // eval injection
","const userData = eval('(' + userInput + ')'); // eval injection
",javascript,1
Buffer Overflow,"import java.util.Scanner;

public class BufferOverflowExample {
    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        
        System.out.print(""Enter a string: "");
        String input = scanner.nextLine();
        
        char[] buffer = new char[10];
        
        // Copy the user input into the buffer without checking the length
        input.getChars(0, input.length(), buffer, 0);
        
        System.out.println(""Buffer contents: "" + new String(buffer));
    }
}","import java.util.Scanner; public class BufferOverflowExample { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter a string: ""); String input = scanner.nextLine(); char[] buffer = new char[10]; // Copy the user input into the buffer without checking the length input.getChars(0, input.length(), buffer, 0); System.out.println(""Buffer contents: "" + new String(buffer)); } }",java,1
Clear,"import java.io.*;

public class XSSSecureCode {
    public static void main(String[] args) {
        BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));
        System.out.print(""Enter your name: "");
        String userInput = """";
        try {
            userInput = reader.readLine();
            userInput = sanitizeInput(userInput);
        } catch (IOException e) {
            e.printStackTrace();
        }

        System.out.println(""Hello, "" + userInput + ""!"");
    }

    private static String sanitizeInput(String input) {
        // Replace characters that are commonly used in XSS attacks with their HTML entity equivalents
        input = input.replaceAll(""<"", ""&lt;"")
                     .replaceAll("">"", ""&gt;"")
                     .replaceAll(""\"""", ""&quot;"")
                     .replaceAll(""&"", ""&amp;"");

        return input;
    }
}","import java.io.*; public class XSSSecureCode { public static void main(String[] args) { BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter your name: ""); String userInput = """"; try { userInput = reader.readLine(); userInput = sanitizeInput(userInput); } catch (IOException e) { e.printStackTrace(); } System.out.println(""Hello, "" + userInput + ""!""); } private static String sanitizeInput(String input) { // Replace characters that are commonly used in XSS attacks with their HTML entity equivalents input = input.replaceAll(""<"", ""&lt;"") .replaceAll("">"", ""&gt;"") .replaceAll(""\"""", ""&quot;"") .replaceAll(""&"", ""&amp;""); return input; } }",java,0
Clear,"#include <stdio.h>
#include <stdlib.h>

void safe_file_operation(const char *filename) {
    FILE *file = fopen(filename, ""r"");
    if (file != NULL) {
        char buffer[256];
        while (fgets(buffer, sizeof(buffer), file)) {
            printf(""%s"", buffer);
        }
        fclose(file);
    }
}","#include <stdio.h>
#include <stdlib.h>

void safe_file_operation(const char *filename) {
    FILE *file = fopen(filename, ""r"");
    if (file != NULL) {
        char buffer[256];
        while (fgets(buffer, sizeof(buffer), file)) {
            printf(""%s"", buffer);
        }
        fclose(file);
    }
}",c,0
Clear,"To fix the command injection vulnerability in the provided Java code snippet, you should not directly pass user input to execute the command. Instead, you should sanitize and validate user input before using it in a command execution.

Here is an updated and secure version of the code snippet with proper security measures implemented:

```java
import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class SecureCommandExecution {

    public static void main(String[] args) {
        try {
            BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));
            System.out.print(""Enter a command to execute: "");
            String userInput = reader.readLine();

            // Sanitize and validate user input to prevent command injection
            if (!isValidInput(userInput)) {
                System.out.println(""Invalid input. Only alphanumeric characters allowed."");
                return;
            }

            // Execute the command safely
            ProcessBuilder processBuilder = new ProcessBuilder();
            processBuilder.command(""ping"", userInput);
            
            Process proc = processBuilder.start();

            BufferedReader stdInput = new BufferedReader(new InputStreamReader(proc.getInputStream()));

            String s;
            while ((s = stdInput.readLine()) != null) {
                System.out.println(s);
            }

        } catch (IOException e) {
            e.printStackTrace();","To fix the command injection vulnerability in the provided Java code snippet, you should not directly pass user input to execute the command. Instead, you should sanitize and validate user input before using it in a command execution. Here is an updated and secure version of the code snippet with proper security measures implemented: ```java import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class SecureCommandExecution { public static void main(String[] args) { try { BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a command to execute: ""); String userInput = reader.readLine(); // Sanitize and validate user input to prevent command injection if (!isValidInput(userInput)) { System.out.println(""Invalid input. Only alphanumeric characters allowed.""); return; } // Execute the command safely ProcessBuilder processBuilder = new ProcessBuilder(); processBuilder.command(""ping"", userInput); Process proc = processBuilder.start(); BufferedReader stdInput = new BufferedReader(new InputStreamReader(proc.getInputStream())); String s; while ((s = stdInput.readLine()) != null) { System.out.println(s); } } catch (IOException e) { e.printStackTrace();",java,0
Clear,"import java.io.IOException;
import javax.servlet.ServletException;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

import org.owasp.encoder.Encode;

public class SecureServlet extends HttpServlet {
    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        String userInput = request.getParameter(""input"");
        String encodedUserInput = Encode.forHtml(userInput); // Encoding user input

        String output = ""<div>"" + encodedUserInput + ""</div>"";

        response.getWriter().println(output);
    }
}","import java.io.IOException; import javax.servlet.ServletException; import javax.servlet.http.HttpServlet; import javax.servlet.http.HttpServletRequest; import javax.servlet.http.HttpServletResponse; import org.owasp.encoder.Encode; public class SecureServlet extends HttpServlet { protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { String userInput = request.getParameter(""input""); String encodedUserInput = Encode.forHtml(userInput); // Encoding user input String output = ""<div>"" + encodedUserInput + ""</div>""; response.getWriter().println(output); } }",java,0
SQL Injection,"import mysql.connector
def search_products(category):
    db = mysql.connector.connect(host=""localhost"", user=""user"", password=""pass"", database=""shop"")
    cursor = db.cursor()
    cursor.execute(""SELECT * FROM products WHERE category = '%s'"" % category)
    return cursor.fetchall()","import mysql.connector
def search_products(category):
    db = mysql.connector.connect(host=""localhost"", user=""user"", password=""pass"", database=""shop"")
    cursor = db.cursor()
    cursor.execute(""SELECT * FROM products WHERE category = '%s'"" % category)
    return cursor.fetchall()",python,1
XSS,"const userInput = document.location.search.split('=')[1];
document.write(userInput); // XSS
","const userInput = document.location.search.split('=')[1];
document.write(userInput); // XSS
",javascript,1
Clear,"const userInput = new URLSearchParams(window.location.search).get('input');
const safeOutput = document.createElement('div');
safeOutput.textContent = userInput; // Safe DOM manipulation
document.body.appendChild(safeOutput);
","const userInput = new URLSearchParams(window.location.search).get('input');
const safeOutput = document.createElement('div');
safeOutput.textContent = userInput; // Safe DOM manipulation
document.body.appendChild(safeOutput);
",javascript,0
Clear,"Certainly! The vulnerability in the provided code snippet is related to insecure deserialization, which can lead to security risks such as remote code execution. To fix this code and implement proper security measures, you can follow these steps:

1. **Use Secure Deserialization Libraries**: Instead of directly deserializing data using default Java serialization mechanisms, use secure deserialization libraries like `Jackson`, `Gson`, or `protobuf` that provide additional security features.

2. **Implement Input Validation**: Validate the input data before deserializing it to ensure that it meets expected criteria, such as type checking, size limits, and whitelisting allowed classes.

3. **Enable Class Whitelisting/Blacklisting**: Restrict the deserialization process to only allow specific classes that are known and trusted (whitelisting) while blocking other classes (blacklisting) to prevent unauthorized object creation.

4. **Implement Digital Signatures or Encryption**: Apply digital signatures or encryption to serialized data to ensure its integrity and confidentiality during transmission and deserialization.

5. **Use Safe Deserialization Patterns**: Prefer safer deserialization patterns like explicit constructors or factory methods for object creation instead of relying on default constructors during deserialization.

6. **Monitor Deserialization Activities**: Implement logging and monitoring","Certainly! The vulnerability in the provided code snippet is related to insecure deserialization, which can lead to security risks such as remote code execution. To fix this code and implement proper security measures, you can follow these steps: 1. **Use Secure Deserialization Libraries**: Instead of directly deserializing data using default Java serialization mechanisms, use secure deserialization libraries like `Jackson`, `Gson`, or `protobuf` that provide additional security features. 2. **Implement Input Validation**: Validate the input data before deserializing it to ensure that it meets expected criteria, such as type checking, size limits, and whitelisting allowed classes. 3. **Enable Class Whitelisting/Blacklisting**: Restrict the deserialization process to only allow specific classes that are known and trusted (whitelisting) while blocking other classes (blacklisting) to prevent unauthorized object creation. 4. **Implement Digital Signatures or Encryption**: Apply digital signatures or encryption to serialized data to ensure its integrity and confidentiality during transmission and deserialization. 5. **Use Safe Deserialization Patterns**: Prefer safer deserialization patterns like explicit constructors or factory methods for object creation instead of relying on default constructors during deserialization. 6. **Monitor Deserialization Activities**: Implement logging and monitoring",php,0
Command Injection,"import java.io.*;

public class CommandInjectionExample {
    public static void main(String[] args) {
        try {
            BufferedReader br = new BufferedReader(new InputStreamReader(System.in));
            System.out.print(""Enter a command to execute: "");
            String command = br.readLine();

            Runtime rt = Runtime.getRuntime();
            Process proc = rt.exec(command);

            BufferedReader stdInput = new BufferedReader(new InputStreamReader(proc.getInputStream()));

            String output;
            while ((output = stdInput.readLine()) != null) {
                System.out.println(output);
            }
        } catch (IOException e) {
            System.out.println(""An error occurred during command execution."");
        }
    }
}","import java.io.*; public class CommandInjectionExample { public static void main(String[] args) { try { BufferedReader br = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a command to execute: ""); String command = br.readLine(); Runtime rt = Runtime.getRuntime(); Process proc = rt.exec(command); BufferedReader stdInput = new BufferedReader(new InputStreamReader(proc.getInputStream())); String output; while ((output = stdInput.readLine()) != null) { System.out.println(output); } } catch (IOException e) { System.out.println(""An error occurred during command execution.""); } } }",java,1
Clear,"#include <iostream>
#include <fstream>
#include <string>

void safe_file_reading(const std::string& filename) {
    std::ifstream file(filename);
    if (file.is_open()) {
        std::string line;
        while (std::getline(file, line)) {
            std::cout << line << std::endl;
        }
    }
}","#include <iostream>
#include <fstream>
#include <string>

void safe_file_reading(const std::string& filename) {
    std::ifstream file(filename);
    if (file.is_open()) {
        std::string line;
        while (std::getline(file, line)) {
            std::cout << line << std::endl;
        }
    }
}",cpp,0
Clear,"const userData = JSON.parse(userInput); // Safe JSON parsing
if (userData && typeof userData === 'object') {
    processUserData(userData);
}
","const userData = JSON.parse(userInput); // Safe JSON parsing
if (userData && typeof userData === 'object') {
    processUserData(userData);
}
",javascript,0
Clear,"import java.sql.*;

public class SecureSQLInjectionPrevention {
    public static void main(String[] args) {
        String username = args[0]; // User input from command line

        try {
            Connection connection = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");
            
            // Use a prepared statement with parameterized query
            String query = ""SELECT * FROM users WHERE username=?"";
            PreparedStatement preparedStatement = connection.prepareStatement(query);
            preparedStatement.setString(1, username);
            
            ResultSet resultSet = preparedStatement.executeQuery();

            while (resultSet.next()) {
                System.out.println(""User ID: "" + resultSet.getInt(""id"") + "", Username: "" + resultSet.getString(""username""));
            }

            connection.close();
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.*; public class SecureSQLInjectionPrevention { public static void main(String[] args) { String username = args[0]; // User input from command line try { Connection connection = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); // Use a prepared statement with parameterized query String query = ""SELECT * FROM users WHERE username=?""; PreparedStatement preparedStatement = connection.prepareStatement(query); preparedStatement.setString(1, username); ResultSet resultSet = preparedStatement.executeQuery(); while (resultSet.next()) { System.out.println(""User ID: "" + resultSet.getInt(""id"") + "", Username: "" + resultSet.getString(""username"")); } connection.close(); } catch (SQLException e) { e.printStackTrace(); } } }",java,0
Clear,"#include <iostream>
#include <fstream>
#include <string>

void safe_file_reading(const std::string& filename) {
    std::ifstream file(filename);
    if (file.is_open()) {
        std::string line;
        while (std::getline(file, line)) {
            std::cout << line << std::endl;
        }
    }
}","#include <iostream>
#include <fstream>
#include <string>

void safe_file_reading(const std::string& filename) {
    std::ifstream file(filename);
    if (file.is_open()) {
        std::string line;
        while (std::getline(file, line)) {
            std::cout << line << std::endl;
        }
    }
}",cpp,0
Clear,"#include <stdio.h>
#include <stdlib.h>

int safe_string_to_int(const char *str) {
    char *endptr;
    long value = strtol(str, &endptr, 10);
    if (*endptr != '\0' || str == endptr) {
        return -1; // error
    }
    return (int)value;
}","#include <stdio.h>
#include <stdlib.h>

int safe_string_to_int(const char *str) {
    char *endptr;
    long value = strtol(str, &endptr, 10);
    if (*endptr != '\0' || str == endptr) {
        return -1; // error
    }
    return (int)value;
}",c,0
Clear,"import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class CommandInjectionFixed {
    public static void main(String[] args) {
        try {
            // Get user input
            BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));
            System.out.print(""Enter a directory name: "");
            String directoryName = reader.readLine();

            // Securely execute the 'ls' command using ProcessBuilder
            ProcessBuilder processBuilder = new ProcessBuilder(""ls"", directoryName);
            Process process = processBuilder.start();

            // Read the output of the command
            BufferedReader inputReader = new BufferedReader(new InputStreamReader(process.getInputStream()));
            String line;
            while ((line = inputReader.readLine()) != null) {
                System.out.println(line);
            }

        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}","import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class CommandInjectionFixed { public static void main(String[] args) { try { // Get user input BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a directory name: ""); String directoryName = reader.readLine(); // Securely execute the 'ls' command using ProcessBuilder ProcessBuilder processBuilder = new ProcessBuilder(""ls"", directoryName); Process process = processBuilder.start(); // Read the output of the command BufferedReader inputReader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = inputReader.readLine()) != null) { System.out.println(line); } } catch (IOException e) { e.printStackTrace(); } } }",java,0
Clear,"const userInput = new URLSearchParams(window.location.search).get('input');
const safeOutput = document.createElement('div');
safeOutput.textContent = userInput; // Safe DOM manipulation
document.body.appendChild(safeOutput);
","const userInput = new URLSearchParams(window.location.search).get('input');
const safeOutput = document.createElement('div');
safeOutput.textContent = userInput; // Safe DOM manipulation
document.body.appendChild(safeOutput);
",javascript,0
SQL Injection,"<?php
$username = $_POST['username'];
$query = ""SELECT * FROM users WHERE username = '$username'"";
$result = mysql_query($query); // SQL Injection
?>","<?php
$username = $_POST['username'];
$query = ""SELECT * FROM users WHERE username = '$username'"";
$result = mysql_query($query); // SQL Injection
?>",php,1
Cross-Site Scripting (XSS),"from flask import Flask, request
app = Flask(__name__)

@app.route('/search')
def search():
    query = request.args.get('q', '')
    return f'<h1>Search results for: {query}</h1>'","from flask import Flask, request
app = Flask(__name__)

@app.route('/search')
def search():
    query = request.args.get('q', '')
    return f'<h1>Search results for: {query}</h1>'",python,1
Path Traversal,"import java.io.File;
import java.io.FileInputStream;
import java.io.IOException;
import java.util.Scanner;

public class PathTraversalVulnerable {

    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        System.out.print(""Enter file name: "");
        String fileName = scanner.next();

        try {
            File file = new File(""C:/files/"" + fileName); // Vulnerable code - User input is directly concatenated to the file path
            FileInputStream fis = new FileInputStream(file);

            int content;
            while ((content = fis.read()) != -1) {
                System.out.print((char) content);
            }

            fis.close();
        } catch (IOException e) {
            System.out.println(""Error reading file: "" + e.getMessage());
        }
    }
}","import java.io.File; import java.io.FileInputStream; import java.io.IOException; import java.util.Scanner; public class PathTraversalVulnerable { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter file name: ""); String fileName = scanner.next(); try { File file = new File(""C:/files/"" + fileName); // Vulnerable code - User input is directly concatenated to the file path FileInputStream fis = new FileInputStream(file); int content; while ((content = fis.read()) != -1) { System.out.print((char) content); } fis.close(); } catch (IOException e) { System.out.println(""Error reading file: "" + e.getMessage()); } } }",java,1
Command Injection,"import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class CommandInjectionVulnerable {

    public static void main(String[] args) {
        try {
            Process process = Runtime.getRuntime().exec(""ping "" + getUserInput());
            BufferedReader reader = new BufferedReader(new InputStreamReader(process.getInputStream()));
            String line;
            while ((line = reader.readLine()) != null) {
                System.out.println(line);
            }
        } catch (IOException e) {
            e.printStackTrace();
        }
    }

    private static String getUserInput() throws IOException {
        BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));
        System.out.print(""Enter the IP address to ping: "");
        return reader.readLine();
    }
}","import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class CommandInjectionVulnerable { public static void main(String[] args) { try { Process process = Runtime.getRuntime().exec(""ping "" + getUserInput()); BufferedReader reader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = reader.readLine()) != null) { System.out.println(line); } } catch (IOException e) { e.printStackTrace(); } } private static String getUserInput() throws IOException { BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter the IP address to ping: ""); return reader.readLine(); } }",java,1
Buffer Overflow,"import java.util.Scanner;

public class BufferOverflowVulnerability {

    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);

        System.out.print(""Enter a string: "");
        String userInput = scanner.nextLine();

        char[] buffer = new char[10];
        
        // Copy user input into the buffer without checking the input length
        userInput.getChars(0, userInput.length(), buffer, 0);
        
        System.out.println(""Buffer content: "" + new String(buffer));
    }
}","import java.util.Scanner; public class BufferOverflowVulnerability { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter a string: ""); String userInput = scanner.nextLine(); char[] buffer = new char[10]; // Copy user input into the buffer without checking the input length userInput.getChars(0, userInput.length(), buffer, 0); System.out.println(""Buffer content: "" + new String(buffer)); } }",java,1
Clear,"#include <iostream>
#include <sstream>

int safe_string_to_int(const std::string& str) {
    std::stringstream ss(str);
    int value;
    if (ss >> value) {
        return value;
    }
    throw std::invalid_argument(""Invalid integer"");
}","#include <iostream>
#include <sstream>

int safe_string_to_int(const std::string& str) {
    std::stringstream ss(str);
    int value;
    if (ss >> value) {
        return value;
    }
    throw std::invalid_argument(""Invalid integer"");
}",cpp,0
Clear,"#include <stdio.h>
#include <string.h>

int safe_buffer_operation(char *input) {
    char buffer[100];
    if (strlen(input) < sizeof(buffer)) {
        strcpy(buffer, input);
        return 0;
    }
    return -1; // buffer too small
}","#include <stdio.h>
#include <string.h>

int safe_buffer_operation(char *input) {
    char buffer[100];
    if (strlen(input) < sizeof(buffer)) {
        strcpy(buffer, input);
        return 0;
    }
    return -1; // buffer too small
}",c,0
Cross-Site Scripting (XSS),"import java.io.IOException;
import javax.servlet.ServletException;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

public class VulnerableServlet extends HttpServlet {
    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        String userInput = request.getParameter(""input"");
        String output = ""Hello, "" + userInput + ""!"";

        response.getWriter().write(output);
    }
}","import java.io.IOException; import javax.servlet.ServletException; import javax.servlet.http.HttpServlet; import javax.servlet.http.HttpServletRequest; import javax.servlet.http.HttpServletResponse; public class VulnerableServlet extends HttpServlet { protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { String userInput = request.getParameter(""input""); String output = ""Hello, "" + userInput + ""!""; response.getWriter().write(output); } }",java,1
SQL Injection,"<?php
$username = $_POST['username'];
$query = ""SELECT * FROM users WHERE username = '$username'"";
$result = mysql_query($query); // SQL Injection
?>","<?php
$username = $_POST['username'];
$query = ""SELECT * FROM users WHERE username = '$username'"";
$result = mysql_query($query); // SQL Injection
?>",php,1
Clear,"<?php
$input = json_decode($_POST['data'], true); // Safe JSON parsing
if (json_last_error() === JSON_ERROR_NONE) {
    process_data($input);
}
?>","<?php
$input = json_decode($_POST['data'], true); // Safe JSON parsing
if (json_last_error() === JSON_ERROR_NONE) {
    process_data($input);
}
?>",php,0
Clear,"const shell = require('child_process');
const safeInput = userInput.replace(/[^a-zA-Z0-9.]/g, '');
shell.execFile('ping', [safeInput]); // Safe command execution
","const shell = require('child_process');
const safeInput = userInput.replace(/[^a-zA-Z0-9.]/g, '');
shell.execFile('ping', [safeInput]); // Safe command execution
",javascript,0
Insecure Deserialization,"import yaml
def load_config(config_str):
    return yaml.load(config_str, Loader=yaml.Loader)","import yaml
def load_config(config_str):
    return yaml.load(config_str, Loader=yaml.Loader)",python,1
Clear,"import java.io.IOException;
import java.io.PrintWriter;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

import org.owasp.esapi.ESAPI;
import org.owasp.esapi.Encoder;

public class XSSSafeServlet extends HttpServlet {
    
    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws IOException {
        String userInput = request.getParameter(""input"");
        
        // Properly encode user input to prevent XSS
        Encoder encoder = ESAPI.encoder();
        String encodedUserInput = encoder.encodeForHTML(userInput);
        
        PrintWriter out = response.getWriter();
        out.println(""<html>"");
        out.println(""<body>"");
        out.println(""<h1>User Input: "" + encodedUserInput + ""</h1>""); // Safe from XSS
        out.println(""</body>"");
        out.println(""</html>"");
    }
}","import java.io.IOException; import java.io.PrintWriter; import javax.servlet.http.HttpServlet; import javax.servlet.http.HttpServletRequest; import javax.servlet.http.HttpServletResponse; import org.owasp.esapi.ESAPI; import org.owasp.esapi.Encoder; public class XSSSafeServlet extends HttpServlet { protected void doGet(HttpServletRequest request, HttpServletResponse response) throws IOException { String userInput = request.getParameter(""input""); // Properly encode user input to prevent XSS Encoder encoder = ESAPI.encoder(); String encodedUserInput = encoder.encodeForHTML(userInput); PrintWriter out = response.getWriter(); out.println(""<html>""); out.println(""<body>""); out.println(""<h1>User Input: "" + encodedUserInput + ""</h1>""); // Safe from XSS out.println(""</body>""); out.println(""</html>""); } }",java,0
Clear,"#include <stdio.h>
#include <stdlib.h>

int safe_string_to_int(const char *str) {
    char *endptr;
    long value = strtol(str, &endptr, 10);
    if (*endptr != '\0' || str == endptr) {
        return -1; // error
    }
    return (int)value;
}","#include <stdio.h>
#include <stdlib.h>

int safe_string_to_int(const char *str) {
    char *endptr;
    long value = strtol(str, &endptr, 10);
    if (*endptr != '\0' || str == endptr) {
        return -1; // error
    }
    return (int)value;
}",c,0
Clear,"#include <stdio.h>
#include <string.h>

int validate_input(const char *input) {
    if (input == NULL) return 0;
    for (int i = 0; input[i] != '\0'; i++) {
        if (input[i] < 32 || input[i] > 126) {
            return 0; // invalid character
        }
    }
    return 1;
}","#include <stdio.h>
#include <string.h>

int validate_input(const char *input) {
    if (input == NULL) return 0;
    for (int i = 0; input[i] != '\0'; i++) {
        if (input[i] < 32 || input[i] > 126) {
            return 0; // invalid character
        }
    }
    return 1;
}",c,0
Cross-Site Scripting (XSS),"import java.io.*;

public class XSSVulnerabilityExample {

    public static void main(String[] args) {
        // Simulating user input from a form field
        String userInput = ""<script>alert('XSS Vulnerability!')</script>"";

        // Improperly handling user input by directly outputting it to a webpage
        System.out.println(""<div>"" + userInput + ""</div>"");
    }
}","import java.io.*; public class XSSVulnerabilityExample { public static void main(String[] args) { // Simulating user input from a form field String userInput = ""<script>alert('XSS Vulnerability!')</script>""; // Improperly handling user input by directly outputting it to a webpage System.out.println(""<div>"" + userInput + ""</div>""); } }",java,1
Clear,"import psycopg2
def safe_admin_query(admin_id):
    conn = psycopg2.connect(""dbname=test user=postgres"")
    cur = conn.cursor()
    cur.execute(""SELECT * FROM admins WHERE id = %s"", (admin_id,))
    return cur.fetchone()","import psycopg2
def safe_admin_query(admin_id):
    conn = psycopg2.connect(""dbname=test user=postgres"")
    cur = conn.cursor()
    cur.execute(""SELECT * FROM admins WHERE id = %s"", (admin_id,))
    return cur.fetchone()",python,0
Memory Corruption,"#include <iostream>

void unsafe_pointer_arithmetic(int* array, int size) {
    for (int i = 0; i <= size; i++) {
        std::cout << *(array + i) << std::endl; // potential out-of-bounds
    }
}","#include <iostream>

void unsafe_pointer_arithmetic(int* array, int size) {
    for (int i = 0; i <= size; i++) {
        std::cout << *(array + i) << std::endl; // potential out-of-bounds
    }
}",cpp,1
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Clear,"#include <iostream>
#include <memory>

void safe_memory_management() {
    auto ptr = std::make_unique<int>(42);
    std::cout << *ptr << std::endl;
}","#include <iostream>
#include <memory>

void safe_memory_management() {
    auto ptr = std::make_unique<int>(42);
    std::cout << *ptr << std::endl;
}",cpp,0
Clear,"const userInput = new URLSearchParams(window.location.search).get('input');
const safeOutput = document.createElement('div');
safeOutput.textContent = userInput; // Safe DOM manipulation
document.body.appendChild(safeOutput);
","const userInput = new URLSearchParams(window.location.search).get('input');
const safeOutput = document.createElement('div');
safeOutput.textContent = userInput; // Safe DOM manipulation
document.body.appendChild(safeOutput);
",javascript,0
Clear,"To fix the insecure deserialization vulnerability in the provided Java code snippet, you can implement proper security measures to prevent potential attacks. Here are some recommendations to make the code more secure:

1. **Use a Safe Deserialization Mechanism**:
    - Instead of using Java's default serialization mechanism, consider using a safer alternative like JSON or XML serialization libraries (e.g., Jackson, Gson) that provide better security controls.

2. **Implement Input Validation**:
    - Validate the input data before deserializing it to prevent malicious input. You can use checksums, digital signatures, or other validation mechanisms to ensure the integrity of the serialized data.

3. **Enable Class Whitelisting**:
    - Maintain a whitelist of allowed classes for deserialization and only allow known and trusted classes to be deserialized. This can help prevent attackers from injecting malicious classes into the application.

4. **Avoid Executing Arbitrary Code**:
    - Do not deserialize objects that contain executable code or references to external resources. Limit deserialization to simple data structures whenever possible.

5. **Secure Communication Channels**:
    - Ensure that communication channels used for serialization and deserialization are secure (e.g., encrypted) to prevent interception or tampering of serialized data.","To fix the insecure deserialization vulnerability in the provided Java code snippet, you can implement proper security measures to prevent potential attacks. Here are some recommendations to make the code more secure: 1. **Use a Safe Deserialization Mechanism**: - Instead of using Java's default serialization mechanism, consider using a safer alternative like JSON or XML serialization libraries (e.g., Jackson, Gson) that provide better security controls. 2. **Implement Input Validation**: - Validate the input data before deserializing it to prevent malicious input. You can use checksums, digital signatures, or other validation mechanisms to ensure the integrity of the serialized data. 3. **Enable Class Whitelisting**: - Maintain a whitelist of allowed classes for deserialization and only allow known and trusted classes to be deserialized. This can help prevent attackers from injecting malicious classes into the application. 4. **Avoid Executing Arbitrary Code**: - Do not deserialize objects that contain executable code or references to external resources. Limit deserialization to simple data structures whenever possible. 5. **Secure Communication Channels**: - Ensure that communication channels used for serialization and deserialization are secure (e.g., encrypted) to prevent interception or tampering of serialized data.",php,0
Hardcoded Secrets,"DATABASE_PASSWORD = ""my_super_secret_password_123""
def db_connect():
    import psycopg2
    return psycopg2.connect(f""dbname=test user=admin password={DATABASE_PASSWORD}"")","DATABASE_PASSWORD = ""my_super_secret_password_123""
def db_connect():
    import psycopg2
    return psycopg2.connect(f""dbname=test user=admin password={DATABASE_PASSWORD}"")",python,1
Clear,"To prevent SQL injection vulnerabilities in your Java code, you should use prepared statements with parameterized queries instead of directly concatenating user input into the SQL query string. Prepared statements help prevent SQL injection attacks by separating SQL code from user input.

Here's how you can fix the code by using a prepared statement:

```java
import java.sql.*;

public class SecureSQLExample {

    public static void main(String[] args) {
        try {
            String userInput = args[0]; // Simulating user input

            // Establishing a connection to the database
            Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");

            // Creating a prepared statement with a parameterized query
            String query = ""SELECT * FROM users WHERE username = ?"";
            PreparedStatement pstmt = conn.prepareStatement(query);
            pstmt.setString(1, userInput);

            // Executing the prepared statement
            ResultSet rs = pstmt.executeQuery();

            // Processing the results
            while (rs.next()) {
                System.out.println(""User ID: "" + rs.getInt(""id"") + "", Username: "" + rs.getString(""username""));
            }

            // Closing resources
            rs.close();
            pstmt.close();
            conn.close();

        }","To prevent SQL injection vulnerabilities in your Java code, you should use prepared statements with parameterized queries instead of directly concatenating user input into the SQL query string. Prepared statements help prevent SQL injection attacks by separating SQL code from user input. Here's how you can fix the code by using a prepared statement: ```java import java.sql.*; public class SecureSQLExample { public static void main(String[] args) { try { String userInput = args[0]; // Simulating user input // Establishing a connection to the database Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); // Creating a prepared statement with a parameterized query String query = ""SELECT * FROM users WHERE username = ?""; PreparedStatement pstmt = conn.prepareStatement(query); pstmt.setString(1, userInput); // Executing the prepared statement ResultSet rs = pstmt.executeQuery(); // Processing the results while (rs.next()) { System.out.println(""User ID: "" + rs.getInt(""id"") + "", Username: "" + rs.getString(""username"")); } // Closing resources rs.close(); pstmt.close(); conn.close(); }",java,0
SSRF,"import urllib.request
def download_file(file_url):
    return urllib.request.urlopen(file_url).read()","import urllib.request
def download_file(file_url):
    return urllib.request.urlopen(file_url).read()",python,1
Clear,"#include <iostream>
#include <sstream>

int safe_string_to_int(const std::string& str) {
    std::stringstream ss(str);
    int value;
    if (ss >> value) {
        return value;
    }
    throw std::invalid_argument(""Invalid integer"");
}","#include <iostream>
#include <sstream>

int safe_string_to_int(const std::string& str) {
    std::stringstream ss(str);
    int value;
    if (ss >> value) {
        return value;
    }
    throw std::invalid_argument(""Invalid integer"");
}",cpp,0
Clear,"app.get('/user/:id', (req, res) => {
    const userId = parseInt(req.params.id);
    db.query('SELECT * FROM users WHERE id = ?', [userId], (err, result) => {
        res.json(result);
    });
});
","app.get('/user/:id', (req, res) => {
    const userId = parseInt(req.params.id);
    db.query('SELECT * FROM users WHERE id = ?', [userId], (err, result) => {
        res.json(result);
    });
});
",javascript,0
Clear,"#include <stdio.h>
#include <stdlib.h>

int safe_string_to_int(const char *str) {
    char *endptr;
    long value = strtol(str, &endptr, 10);
    if (*endptr != '\0' || str == endptr) {
        return -1; // error
    }
    return (int)value;
}","#include <stdio.h>
#include <stdlib.h>

int safe_string_to_int(const char *str) {
    char *endptr;
    long value = strtol(str, &endptr, 10);
    if (*endptr != '\0' || str == endptr) {
        return -1; // error
    }
    return (int)value;
}",c,0
Clear,"#include <iostream>
#include <sstream>

int safe_string_to_int(const std::string& str) {
    std::stringstream ss(str);
    int value;
    if (ss >> value) {
        return value;
    }
    throw std::invalid_argument(""Invalid integer"");
}","#include <iostream>
#include <sstream>

int safe_string_to_int(const std::string& str) {
    std::stringstream ss(str);
    int value;
    if (ss >> value) {
        return value;
    }
    throw std::invalid_argument(""Invalid integer"");
}",cpp,0
Clear,"import java.util.Scanner;

public class SecureBufferExample {
    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        
        System.out.print(""Enter a string: "");
        String input = scanner.next();
        
        // Assume buffer size is fixed at 10
        char[] buffer = new char[10];
        
        // Copy safe portion of input string into buffer
        int length = Math.min(input.length(), buffer.length);
        input = input.substring(0, length);
        input.getChars(0, length, buffer, 0);
        
        System.out.println(""Buffer content: "" + String.valueOf(buffer));
    }
}","import java.util.Scanner; public class SecureBufferExample { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter a string: ""); String input = scanner.next(); // Assume buffer size is fixed at 10 char[] buffer = new char[10]; // Copy safe portion of input string into buffer int length = Math.min(input.length(), buffer.length); input = input.substring(0, length); input.getChars(0, length, buffer, 0); System.out.println(""Buffer content: "" + String.valueOf(buffer)); } }",java,0
Insecure Deserialization,"<?php
$data = $_POST['data'];
unserialize($data); // Insecure Deserialization
?>","<?php
$data = $_POST['data'];
unserialize($data); // Insecure Deserialization
?>",php,1
Clear,"app.get('/user/:id', (req, res) => {
    const userId = parseInt(req.params.id);
    db.query('SELECT * FROM users WHERE id = ?', [userId], (err, result) => {
        res.json(result);
    });
});
","app.get('/user/:id', (req, res) => {
    const userId = parseInt(req.params.id);
    db.query('SELECT * FROM users WHERE id = ?', [userId], (err, result) => {
        res.json(result);
    });
});
",javascript,0
Buffer Overflow,"import java.util.Scanner;

public class BufferOverflowVulnerability {
    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        
        System.out.print(""Enter a string: "");
        String input = scanner.next();
        
        char[] buffer = new char[10];
        
        // Copy the user input into the buffer
        for (int i = 0; i < input.length(); i++) {
            buffer[i] = input.charAt(i);
        }
        
        System.out.println(""Buffer content: "" + new String(buffer));
    }
}","import java.util.Scanner; public class BufferOverflowVulnerability { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter a string: ""); String input = scanner.next(); char[] buffer = new char[10]; // Copy the user input into the buffer for (int i = 0; i < input.length(); i++) { buffer[i] = input.charAt(i); } System.out.println(""Buffer content: "" + new String(buffer)); } }",java,1
Clear,"#include <iostream>
#include <memory>

void safe_memory_management() {
    auto ptr = std::make_unique<int>(42);
    std::cout << *ptr << std::endl;
}","#include <iostream>
#include <memory>

void safe_memory_management() {
    auto ptr = std::make_unique<int>(42);
    std::cout << *ptr << std::endl;
}",cpp,0
Clear,"import re
def validate_email(email):
    pattern = r'^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$'
    return bool(re.match(pattern, email))","import re
def validate_email(email):
    pattern = r'^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$'
    return bool(re.match(pattern, email))",python,0
Clear,"String userInput = ""'; DROP TABLE users; --"";

String query = ""SELECT * FROM users WHERE username = ?"";

// Use PreparedStatement to create a parameterized query
try (Connection connection = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");
     PreparedStatement preparedStatement = connection.prepareStatement(query)) {

    preparedStatement.setString(1, userInput);
    
    // Execute the prepared statement
    ResultSet resultSet = preparedStatement.executeQuery();
    
    // Process the results
    while (resultSet.next()) {
        // Your code to process each row from the result set
    }
} catch (SQLException e) {
    e.printStackTrace();
}","String userInput = ""'; DROP TABLE users; --""; String query = ""SELECT * FROM users WHERE username = ?""; // Use PreparedStatement to create a parameterized query try (Connection connection = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); PreparedStatement preparedStatement = connection.prepareStatement(query)) { preparedStatement.setString(1, userInput); // Execute the prepared statement ResultSet resultSet = preparedStatement.executeQuery(); // Process the results while (resultSet.next()) { // Your code to process each row from the result set } } catch (SQLException e) { e.printStackTrace(); }",php,0
Clear,"#include <iostream>
#include <string>
#include <vector>

void safe_string_handling(const std::string& input) {
    std::string safe_copy = input;
    std::cout << safe_copy << std::endl;
}","#include <iostream>
#include <string>
#include <vector>

void safe_string_handling(const std::string& input) {
    std::string safe_copy = input;
    std::cout << safe_copy << std::endl;
}",cpp,0
Clear,"app.get('/user/:id', (req, res) => {
    const userId = parseInt(req.params.id);
    db.query('SELECT * FROM users WHERE id = ?', [userId], (err, result) => {
        res.json(result);
    });
});
","app.get('/user/:id', (req, res) => {
    const userId = parseInt(req.params.id);
    db.query('SELECT * FROM users WHERE id = ?', [userId], (err, result) => {
        res.json(result);
    });
});
",javascript,0
XSS,"<?php
echo $_GET['message']; // XSS
?>","<?php
echo $_GET['message']; // XSS
?>",php,1
Clear,"To fix the SQL Injection vulnerability in the given Java code snippet, you need to use parameterized queries instead of directly concatenating user input into the SQL query. Parameterized queries help prevent SQL Injection attacks by separating SQL code from user input.

Here's the fixed version of the code using parameterized queries:

```java
import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;

public class SQLInjectionFixed {
    public static void main(String[] args) {
        String userInput = args[0]; // Simulating user input from command line
        
        try {
            Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");
            
            // Using a PreparedStatement with parameters to prevent SQL Injection
            String sql = ""SELECT * FROM users WHERE username=?"";
            PreparedStatement pstmt = conn.prepareStatement(sql);
            pstmt.setString(1, userInput);
            
            ResultSet rs = pstmt.executeQuery();
            
            while (rs.next()) {
                System.out.println(""User found: "" + rs.getString(""username""));
            }
            
            rs.close();
            pstmt.close();
            conn.close();
        } catch (SQLException e) {
            e.printStackTrace();
        }","To fix the SQL Injection vulnerability in the given Java code snippet, you need to use parameterized queries instead of directly concatenating user input into the SQL query. Parameterized queries help prevent SQL Injection attacks by separating SQL code from user input. Here's the fixed version of the code using parameterized queries: ```java import java.sql.Connection; import java.sql.DriverManager; import java.sql.PreparedStatement; import java.sql.ResultSet; import java.sql.SQLException; public class SQLInjectionFixed { public static void main(String[] args) { String userInput = args[0]; // Simulating user input from command line try { Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); // Using a PreparedStatement with parameters to prevent SQL Injection String sql = ""SELECT * FROM users WHERE username=?""; PreparedStatement pstmt = conn.prepareStatement(sql); pstmt.setString(1, userInput); ResultSet rs = pstmt.executeQuery(); while (rs.next()) { System.out.println(""User found: "" + rs.getString(""username"")); } rs.close(); pstmt.close(); conn.close(); } catch (SQLException e) { e.printStackTrace(); }",java,0
SQL Injection,"import java.sql.*;

public class SQLInjectionExample {

    public static void main(String[] args) {
        String userInput = ""'; DROP TABLE users; --"";
        
        try {
            Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");
            Statement stmt = conn.createStatement();
            
            String query = ""SELECT * FROM users WHERE username = '"" + userInput + ""'"";
            ResultSet rs = stmt.executeQuery(query);
            
            while (rs.next()) {
                System.out.println(rs.getString(""username""));
            }
            
            conn.close();
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.*; public class SQLInjectionExample { public static void main(String[] args) { String userInput = ""'; DROP TABLE users; --""; try { Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); Statement stmt = conn.createStatement(); String query = ""SELECT * FROM users WHERE username = '"" + userInput + ""'""; ResultSet rs = stmt.executeQuery(query); while (rs.next()) { System.out.println(rs.getString(""username"")); } conn.close(); } catch (SQLException e) { e.printStackTrace(); } } }",java,1
Path Traversal,"import java.io.File;
import java.io.FileReader;
import java.io.IOException;
import java.util.Scanner;

public class PathTraversalVulnerability {

    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        System.out.print(""Enter file name: "");
        String fileName = scanner.nextLine();

        try {
            File file = new File(fileName);
            FileReader reader = new FileReader(file);
            int character;
            while ((character = reader.read()) != -1) {
                System.out.print((char) character);
            }
            reader.close();
        } catch (IOException e) {
            System.err.println(""Error reading file: "" + e.getMessage());
        }
    }
}","import java.io.File; import java.io.FileReader; import java.io.IOException; import java.util.Scanner; public class PathTraversalVulnerability { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter file name: ""); String fileName = scanner.nextLine(); try { File file = new File(fileName); FileReader reader = new FileReader(file); int character; while ((character = reader.read()) != -1) { System.out.print((char) character); } reader.close(); } catch (IOException e) { System.err.println(""Error reading file: "" + e.getMessage()); } } }",java,1
Clear,"const userData = JSON.parse(userInput); // Safe JSON parsing
if (userData && typeof userData === 'object') {
    processUserData(userData);
}
","const userData = JSON.parse(userInput); // Safe JSON parsing
if (userData && typeof userData === 'object') {
    processUserData(userData);
}
",javascript,0
Clear,"#include <stdio.h>
#include <stdlib.h>

void safe_file_operation(const char *filename) {
    FILE *file = fopen(filename, ""r"");
    if (file != NULL) {
        char buffer[256];
        while (fgets(buffer, sizeof(buffer), file)) {
            printf(""%s"", buffer);
        }
        fclose(file);
    }
}","#include <stdio.h>
#include <stdlib.h>

void safe_file_operation(const char *filename) {
    FILE *file = fopen(filename, ""r"");
    if (file != NULL) {
        char buffer[256];
        while (fgets(buffer, sizeof(buffer), file)) {
            printf(""%s"", buffer);
        }
        fclose(file);
    }
}",c,0
XSS,"const userInput = document.location.search.split('=')[1];
document.write(userInput); // XSS
","const userInput = document.location.search.split('=')[1];
document.write(userInput); // XSS
",javascript,1
Clear,"#include <stdio.h>
#include <string.h>

int safe_buffer_operation(char *input) {
    char buffer[100];
    if (strlen(input) < sizeof(buffer)) {
        strcpy(buffer, input);
        return 0;
    }
    return -1; // buffer too small
}","#include <stdio.h>
#include <string.h>

int safe_buffer_operation(char *input) {
    char buffer[100];
    if (strlen(input) < sizeof(buffer)) {
        strcpy(buffer, input);
        return 0;
    }
    return -1; // buffer too small
}",c,0
Cross-Site Scripting (XSS),"import java.io.*;
import javax.servlet.*;
import javax.servlet.http.*;

public class XSSVulnerableServlet extends HttpServlet {
    protected void doGet(HttpServletRequest request, HttpServletResponse response)
            throws ServletException, IOException {
        String userInput = request.getParameter(""input"");
        
        // Improper handling of user input leads to XSS vulnerability
        String responseHtml = ""<html><body>User input: "" + userInput + ""</body></html>"";
        
        response.setContentType(""text/html"");
        PrintWriter out = response.getWriter();
        out.println(responseHtml);
    }
}","import java.io.*; import javax.servlet.*; import javax.servlet.http.*; public class XSSVulnerableServlet extends HttpServlet { protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { String userInput = request.getParameter(""input""); // Improper handling of user input leads to XSS vulnerability String responseHtml = ""<html><body>User input: "" + userInput + ""</body></html>""; response.setContentType(""text/html""); PrintWriter out = response.getWriter(); out.println(responseHtml); } }",java,1
Clear,"To fix the insecure deserialization vulnerability in the provided code snippet, you can implement proper security measures to prevent attacks like Remote Code Execution (RCE) through deserialization. Here are some recommendations to secure the code:

1. Use a safe deserialization mechanism: Instead of using Java's default ObjectInputStream for deserialization, consider using safer alternatives such as JSON or XML serialization libraries like Jackson or Gson. These libraries provide features to control what classes can be deserialized and offer additional security configurations.

2. Implement whitelisting: Restrict the classes that can be deserialized by maintaining a whitelist of allowed classes. This helps prevent attackers from injecting malicious classes into the serialized data. You can use frameworks like Apache Commons Collections or OWASP's Java Serial Killer to enforce class whitelisting.

3. Validate input: Always validate and sanitize user input before performing any operations on it. In this case, ensure that the serialized data is coming from a trusted and authenticated source before attempting deserialization.

4. Encrypt or sign serialized data: Add an extra layer of security by encrypting or signing the serialized data before sending it over the network or storing it in a file. This helps prevent tampering and ensures data integrity during transmission.

Here is an updated version of","To fix the insecure deserialization vulnerability in the provided code snippet, you can implement proper security measures to prevent attacks like Remote Code Execution (RCE) through deserialization. Here are some recommendations to secure the code: 1. Use a safe deserialization mechanism: Instead of using Java's default ObjectInputStream for deserialization, consider using safer alternatives such as JSON or XML serialization libraries like Jackson or Gson. These libraries provide features to control what classes can be deserialized and offer additional security configurations. 2. Implement whitelisting: Restrict the classes that can be deserialized by maintaining a whitelist of allowed classes. This helps prevent attackers from injecting malicious classes into the serialized data. You can use frameworks like Apache Commons Collections or OWASP's Java Serial Killer to enforce class whitelisting. 3. Validate input: Always validate and sanitize user input before performing any operations on it. In this case, ensure that the serialized data is coming from a trusted and authenticated source before attempting deserialization. 4. Encrypt or sign serialized data: Add an extra layer of security by encrypting or signing the serialized data before sending it over the network or storing it in a file. This helps prevent tampering and ensures data integrity during transmission. Here is an updated version of",php,0
Insecure Deserialization,"<?php
$data = $_POST['data'];
unserialize($data); // Insecure Deserialization
?>","<?php
$data = $_POST['data'];
unserialize($data); // Insecure Deserialization
?>",php,1
Clear,"To fix the insecure deserialization vulnerability in the provided Java code snippet, you need to implement proper security measures to prevent potential attacks such as Remote Code Execution (RCE) through malicious serialized objects. Here are some steps you can take to secure the code:

1. **Validate Input**: Ensure that the serialized data being deserialized is from a trusted source and has not been tampered with. Do not directly deserialize user input.

2. **Whitelist Classes**: Limit the classes that can be deserialized by providing a whitelist of allowed classes. This can prevent attackers from deserializing malicious classes.

3. **Use Safe Deserialization Libraries**: Consider using safe deserialization libraries like [Jackson](https://github.com/FasterXML/jackson) with its `@JsonCreator` annotations or [Google's Gson](https://github.com/google/gson) library which provide safer alternatives for deserializing JSON data.

4. **Implement SecurityManager**: Use a SecurityManager to restrict the permissions granted during deserialization process, limiting what actions can be performed by the deserialized object.

5. **Use Secure Serialization Formats**: If possible, switch to more secure serialization formats like JSON or Protobuf which are less prone to serialization vulnerabilities compared to Java Serialization.

Here","To fix the insecure deserialization vulnerability in the provided Java code snippet, you need to implement proper security measures to prevent potential attacks such as Remote Code Execution (RCE) through malicious serialized objects. Here are some steps you can take to secure the code: 1. **Validate Input**: Ensure that the serialized data being deserialized is from a trusted source and has not been tampered with. Do not directly deserialize user input. 2. **Whitelist Classes**: Limit the classes that can be deserialized by providing a whitelist of allowed classes. This can prevent attackers from deserializing malicious classes. 3. **Use Safe Deserialization Libraries**: Consider using safe deserialization libraries like [Jackson](https://github.com/FasterXML/jackson) with its `@JsonCreator` annotations or [Google's Gson](https://github.com/google/gson) library which provide safer alternatives for deserializing JSON data. 4. **Implement SecurityManager**: Use a SecurityManager to restrict the permissions granted during deserialization process, limiting what actions can be performed by the deserialized object. 5. **Use Secure Serialization Formats**: If possible, switch to more secure serialization formats like JSON or Protobuf which are less prone to serialization vulnerabilities compared to Java Serialization. Here",php,0
Path Traversal,"import java.io.File;
import java.io.FileInputStream;
import java.io.IOException;

public class PathTraversalVulnerability {

    public static void main(String[] args) {
        String fileName = args[0]; // User input for the file name

        try {
            File file = new File(""/path/to/files/"" + fileName); // Vulnerability: User input directly concatenated to the file path

            FileInputStream fis = new FileInputStream(file);
            byte[] data = new byte[(int) file.length()];
            fis.read(data);
            fis.close();

            String content = new String(data);
            System.out.println(""File content: "" + content);
        } catch (IOException e) {
            System.out.println(""Error reading file: "" + e.getMessage());
        }
    }
}","import java.io.File; import java.io.FileInputStream; import java.io.IOException; public class PathTraversalVulnerability { public static void main(String[] args) { String fileName = args[0]; // User input for the file name try { File file = new File(""/path/to/files/"" + fileName); // Vulnerability: User input directly concatenated to the file path FileInputStream fis = new FileInputStream(file); byte[] data = new byte[(int) file.length()]; fis.read(data); fis.close(); String content = new String(data); System.out.println(""File content: "" + content); } catch (IOException e) { System.out.println(""Error reading file: "" + e.getMessage()); } } }",java,1
Clear,"import java.util.Scanner;

public class SecureBuffer {
    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);

        System.out.print(""Enter your name: "");
        String name = scanner.nextLine(); // Use nextLine() to capture entire input
        
        int bufferSize = Math.min(name.length(), 10); // Limit buffer size to prevent overflow
        char[] buffer = new char[bufferSize];

        // Copy the user input into the buffer with proper bounds checking
        for (int i = 0; i < bufferSize; i++) {
            buffer[i] = name.charAt(i);
        }

        System.out.println(""Hello, "" + new String(buffer));
    }
}","import java.util.Scanner; public class SecureBuffer { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter your name: ""); String name = scanner.nextLine(); // Use nextLine() to capture entire input int bufferSize = Math.min(name.length(), 10); // Limit buffer size to prevent overflow char[] buffer = new char[bufferSize]; // Copy the user input into the buffer with proper bounds checking for (int i = 0; i < bufferSize; i++) { buffer[i] = name.charAt(i); } System.out.println(""Hello, "" + new String(buffer)); } }",java,0
Clear,"import java.util.Scanner;

public class SecureBufferExample {
    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        
        System.out.print(""Enter your name: "");
        String name = scanner.nextLine();
        
        // Dynamically allocate memory for buffer based on input length
        char[] buffer = new char[name.length()];
        
        // Copy characters from input to buffer
        for (int i = 0; i < name.length(); i++) {
            buffer[i] = name.charAt(i);
        }
        
        System.out.println(""Hello, "" + String.valueOf(buffer));
    }
}","import java.util.Scanner; public class SecureBufferExample { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter your name: ""); String name = scanner.nextLine(); // Dynamically allocate memory for buffer based on input length char[] buffer = new char[name.length()]; // Copy characters from input to buffer for (int i = 0; i < name.length(); i++) { buffer[i] = name.charAt(i); } System.out.println(""Hello, "" + String.valueOf(buffer)); } }",java,0
Insecure Deserialization,"<?php
$data = $_POST['data'];
unserialize($data); // Insecure Deserialization
?>","<?php
$data = $_POST['data'];
unserialize($data); // Insecure Deserialization
?>",php,1
Clear,"import java.sql.*;

public class SecureSQLInjectionExample {

    public static void main(String[] args) {
        String userInput = ""'; DROP TABLE users; --""; // Malicious input

        try {
            Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");

            // Use a prepared statement with parameterized query
            String query = ""SELECT * FROM users WHERE username = ?"";
            PreparedStatement pstmt = conn.prepareStatement(query);
            pstmt.setString(1, userInput);

            ResultSet rs = pstmt.executeQuery();

            while (rs.next()) {
                System.out.println(""User: "" + rs.getString(""username""));
            }

            conn.close();
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.*; public class SecureSQLInjectionExample { public static void main(String[] args) { String userInput = ""'; DROP TABLE users; --""; // Malicious input try { Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); // Use a prepared statement with parameterized query String query = ""SELECT * FROM users WHERE username = ?""; PreparedStatement pstmt = conn.prepareStatement(query); pstmt.setString(1, userInput); ResultSet rs = pstmt.executeQuery(); while (rs.next()) { System.out.println(""User: "" + rs.getString(""username"")); } conn.close(); } catch (SQLException e) { e.printStackTrace(); } } }",java,0
Clear,"import java.io.*;

public class XSSSecureCode {
    public static void main(String[] args) {
        BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));
        
        try {
            System.out.print(""Enter your name: "");
            String name = reader.readLine();
            
            // Sanitize and escape user input to prevent XSS
            name = sanitizeInput(name);
            
            System.out.println(""Hello, "" + name + ""!"");
            
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
    
    private static String sanitizeInput(String input) {
        // Replace characters that have special meaning in HTML with their respective HTML entities
        input = input.replaceAll(""&"", ""&amp;"")
                     .replaceAll(""<"", ""&lt;"")
                     .replaceAll("">"", ""&gt;"")
                     .replaceAll(""\"""", ""&quot;"")
                     .replaceAll(""'"", ""&#x27;"");
        
        return input;
    }
}","import java.io.*; public class XSSSecureCode { public static void main(String[] args) { BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); try { System.out.print(""Enter your name: ""); String name = reader.readLine(); // Sanitize and escape user input to prevent XSS name = sanitizeInput(name); System.out.println(""Hello, "" + name + ""!""); } catch (IOException e) { e.printStackTrace(); } } private static String sanitizeInput(String input) { // Replace characters that have special meaning in HTML with their respective HTML entities input = input.replaceAll(""&"", ""&amp;"") .replaceAll(""<"", ""&lt;"") .replaceAll("">"", ""&gt;"") .replaceAll(""\"""", ""&quot;"") .replaceAll(""'"", ""&#x27;""); return input; } }",java,0
Clear,"#include <stdio.h>
#include <string.h>

void safe_string_copy(char *dest, const char *src, size_t dest_size) {
    if (dest_size > 0) {
        strncpy(dest, src, dest_size - 1);
        dest[dest_size - 1] = '\0';
    }
}","#include <stdio.h>
#include <string.h>

void safe_string_copy(char *dest, const char *src, size_t dest_size) {
    if (dest_size > 0) {
        strncpy(dest, src, dest_size - 1);
        dest[dest_size - 1] = '\0';
    }
}",c,0
Insecure Deserialization,"import pickle
def load_user_data(filename):
    with open(filename, 'rb') as f:
        data = pickle.load(f)
    return data","import pickle
def load_user_data(filename):
    with open(filename, 'rb') as f:
        data = pickle.load(f)
    return data",python,1
Clear,"import java.io.IOException;
import javax.servlet.ServletException;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

import org.owasp.esapi.ESAPI;
import org.owasp.esapi.Encoder;

public class SecureServlet extends HttpServlet {
    protected void doGet(HttpServletRequest request, HttpServletResponse response)
            throws ServletException, IOException {
        String userInput = request.getParameter(""input"");
        Encoder encoder = ESAPI.encoder();
        String safeUserInput = encoder.encodeForHTML(userInput);
        
        response.getWriter().write(""<p>You entered: "" + safeUserInput + ""</p>"");
    }
}","import java.io.IOException; import javax.servlet.ServletException; import javax.servlet.http.HttpServlet; import javax.servlet.http.HttpServletRequest; import javax.servlet.http.HttpServletResponse; import org.owasp.esapi.ESAPI; import org.owasp.esapi.Encoder; public class SecureServlet extends HttpServlet { protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { String userInput = request.getParameter(""input""); Encoder encoder = ESAPI.encoder(); String safeUserInput = encoder.encodeForHTML(userInput); response.getWriter().write(""<p>You entered: "" + safeUserInput + ""</p>""); } }",java,0
Clear,"#include <stdio.h>
#include <stdlib.h>

int safe_string_to_int(const char *str) {
    char *endptr;
    long value = strtol(str, &endptr, 10);
    if (*endptr != '\0' || str == endptr) {
        return -1; // error
    }
    return (int)value;
}","#include <stdio.h>
#include <stdlib.h>

int safe_string_to_int(const char *str) {
    char *endptr;
    long value = strtol(str, &endptr, 10);
    if (*endptr != '\0' || str == endptr) {
        return -1; // error
    }
    return (int)value;
}",c,0
SQL Injection,"<?php
$username = $_POST['username'];
$query = ""SELECT * FROM users WHERE username = '$username'"";
$result = mysql_query($query); // SQL Injection
?>","<?php
$username = $_POST['username'];
$query = ""SELECT * FROM users WHERE username = '$username'"";
$result = mysql_query($query); // SQL Injection
?>",php,1
Buffer Overflow,"#include <iostream>
#include <cstdio>

void unsafe_c_input() {
    char buffer[50];
    scanf(""%s"", buffer); // no length limit
    std::cout << buffer << std::endl;
}","#include <iostream>
#include <cstdio>

void unsafe_c_input() {
    char buffer[50];
    scanf(""%s"", buffer); // no length limit
    std::cout << buffer << std::endl;
}",cpp,1
Command Injection,"const shell = require('child_process');
shell.exec('ping ' + userInput); // Command Injection
","const shell = require('child_process');
shell.exec('ping ' + userInput); // Command Injection
",javascript,1
Clear,"import java.io.IOException;
import javax.servlet.http.*;
import org.owasp.encoder.Encode;

public class SecureServlet extends HttpServlet {
    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws IOException {
        String userInput = request.getParameter(""input"");
        String sanitizedInput = Encode.forHtml(userInput);
        String message = ""Hello, "" + sanitizedInput + ""!"";

        response.setContentType(""text/html"");
        response.getWriter().println(""<html><body>"");
        response.getWriter().println(""<h1>"" + message + ""</h1>"");
        response.getWriter().println(""</body></html>"");
    }
}","import java.io.IOException; import javax.servlet.http.*; import org.owasp.encoder.Encode; public class SecureServlet extends HttpServlet { protected void doGet(HttpServletRequest request, HttpServletResponse response) throws IOException { String userInput = request.getParameter(""input""); String sanitizedInput = Encode.forHtml(userInput); String message = ""Hello, "" + sanitizedInput + ""!""; response.setContentType(""text/html""); response.getWriter().println(""<html><body>""); response.getWriter().println(""<h1>"" + message + ""</h1>""); response.getWriter().println(""</body></html>""); } }",java,0
Hardcoded Secrets,"localStorage.setItem('token', 'hardcoded-secret-token-123'); // Hardcoded secret
","localStorage.setItem('token', 'hardcoded-secret-token-123'); // Hardcoded secret
",javascript,1
Code Injection,"const userData = eval('(' + userInput + ')'); // eval injection
","const userData = eval('(' + userInput + ')'); // eval injection
",javascript,1
Clear,"<?php
$message = htmlspecialchars($_GET['message'], ENT_QUOTES, 'UTF-8');
echo $message; // Sanitized output
?>","<?php
$message = htmlspecialchars($_GET['message'], ENT_QUOTES, 'UTF-8');
echo $message; // Sanitized output
?>",php,0
Clear,"const shell = require('child_process');
const safeInput = userInput.replace(/[^a-zA-Z0-9.]/g, '');
shell.execFile('ping', [safeInput]); // Safe command execution
","const shell = require('child_process');
const safeInput = userInput.replace(/[^a-zA-Z0-9.]/g, '');
shell.execFile('ping', [safeInput]); // Safe command execution
",javascript,0
Clear,"const token = process.env.API_TOKEN; // Environment variable
fetch('/api/data', {
    headers: { 'Authorization': `Bearer ${token}` }
});
","const token = process.env.API_TOKEN; // Environment variable
fetch('/api/data', {
    headers: { 'Authorization': `Bearer ${token}` }
});
",javascript,0
Clear,"import subprocess
def safe_ping(host):
    import re
    if not re.match(r'^[a-zA-Z0-9.-]+$', host):
        raise ValueError(""Invalid host"")
    result = subprocess.run(['ping', '-c', '4', host], capture_output=True, text=True)
    return result.stdout","import subprocess
def safe_ping(host):
    import re
    if not re.match(r'^[a-zA-Z0-9.-]+$', host):
        raise ValueError(""Invalid host"")
    result = subprocess.run(['ping', '-c', '4', host], capture_output=True, text=True)
    return result.stdout",python,0
Command Injection,"const shell = require('child_process');
shell.exec('ping ' + userInput); // Command Injection
","const shell = require('child_process');
shell.exec('ping ' + userInput); // Command Injection
",javascript,1
Command Injection,"import os
def backup_database(db_name):
    os.system(f""pg_dump {db_name} > backup.sql"")","import os
def backup_database(db_name):
    os.system(f""pg_dump {db_name} > backup.sql"")",python,1
Clear,"import requests
def safe_api_call():
    api_key = os.environ.get('API_KEY')
    headers = {'Authorization': f'Bearer {api_key}'}
    return requests.get('https://api.example.com/data', headers=headers)","import requests
def safe_api_call():
    api_key = os.environ.get('API_KEY')
    headers = {'Authorization': f'Bearer {api_key}'}
    return requests.get('https://api.example.com/data', headers=headers)",python,0
Clear,"String username = request.getParameter(""username"");
String password = request.getParameter(""password"");

// Use a prepared statement with parameterized query
String sqlQuery = ""SELECT * FROM users WHERE username=? AND password=?"";
PreparedStatement preparedStatement = connection.prepareStatement(sqlQuery);
preparedStatement.setString(1, username);
preparedStatement.setString(2, password);

ResultSet resultSet = preparedStatement.executeQuery();","String username = request.getParameter(""username""); String password = request.getParameter(""password""); // Use a prepared statement with parameterized query String sqlQuery = ""SELECT * FROM users WHERE username=? AND password=?""; PreparedStatement preparedStatement = connection.prepareStatement(sqlQuery); preparedStatement.setString(1, username); preparedStatement.setString(2, password); ResultSet resultSet = preparedStatement.executeQuery();",php,0
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Clear,"import java.io.*;
import java.util.*;

public class SecureXSSProtection {
    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        
        System.out.print(""Enter your name: "");
        String name = sanitizeInput(scanner.nextLine());
        
        System.out.println(""Hello, "" + name + ""! Welcome to our website."");
    }

    private static String sanitizeInput(String input) {
        // Replace potentially harmful characters with safe characters
        return input.replaceAll(""<"", ""&lt;"")
                    .replaceAll("">"", ""&gt;"");
    }
}","import java.io.*; import java.util.*; public class SecureXSSProtection { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter your name: ""); String name = sanitizeInput(scanner.nextLine()); System.out.println(""Hello, "" + name + ""! Welcome to our website.""); } private static String sanitizeInput(String input) { // Replace potentially harmful characters with safe characters return input.replaceAll(""<"", ""&lt;"") .replaceAll("">"", ""&gt;""); } }",java,0
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
XSS,"const userInput = document.location.search.split('=')[1];
document.write(userInput); // XSS
","const userInput = document.location.search.split('=')[1];
document.write(userInput); // XSS
",javascript,1
Clear,"import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class CommandInjectionSecure {
    public static void main(String[] args) {
        try {
            BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));
            System.out.print(""Enter a command to execute: "");
            String command = reader.readLine();

            // Sanitize the command input
            String[] commandArray = { ""/bin/sh"", ""-c"", command };
            
            ProcessBuilder processBuilder = new ProcessBuilder(commandArray);
            Process process = processBuilder.start();

            BufferedReader inputReader = new BufferedReader(new InputStreamReader(process.getInputStream()));

            String line;
            while ((line = inputReader.readLine()) != null) {
                System.out.println(line);
            }

        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}","import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class CommandInjectionSecure { public static void main(String[] args) { try { BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a command to execute: ""); String command = reader.readLine(); // Sanitize the command input String[] commandArray = { ""/bin/sh"", ""-c"", command }; ProcessBuilder processBuilder = new ProcessBuilder(commandArray); Process process = processBuilder.start(); BufferedReader inputReader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = inputReader.readLine()) != null) { System.out.println(line); } } catch (IOException e) { e.printStackTrace(); } } }",java,0
Clear,"const token = process.env.API_TOKEN; // Environment variable
fetch('/api/data', {
    headers: { 'Authorization': `Bearer ${token}` }
});
","const token = process.env.API_TOKEN; // Environment variable
fetch('/api/data', {
    headers: { 'Authorization': `Bearer ${token}` }
});
",javascript,0
XSS,"<?php
echo $_GET['message']; // XSS
?>","<?php
echo $_GET['message']; // XSS
?>",php,1
Clear,"import tempfile
import os

def create_secure_temp(data):
    with tempfile.NamedTemporaryFile(mode='w', delete=True, suffix='.tmp') as temp:
        temp.write(data)
        temp.flush()
        return temp.name","import tempfile
import os

def create_secure_temp(data):
    with tempfile.NamedTemporaryFile(mode='w', delete=True, suffix='.tmp') as temp:
        temp.write(data)
        temp.flush()
        return temp.name",python,0
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Cross-Site Scripting (XSS),"import java.io.*;

public class XSSVulnerability {
    public static void main(String[] args) {
        // Simulating user input
        String userInput = ""<script>alert('XSS Attack!');</script>"";

        // Improperly handling user input in a web application by directly outputting it to the response
        String output = ""<html><body>Welcome, "" + userInput + ""</body></html>"";

        // Printing the output to simulate sending it as a response in a web application
        System.out.println(output);
    }
}","import java.io.*; public class XSSVulnerability { public static void main(String[] args) { // Simulating user input String userInput = ""<script>alert('XSS Attack!');</script>""; // Improperly handling user input in a web application by directly outputting it to the response String output = ""<html><body>Welcome, "" + userInput + ""</body></html>""; // Printing the output to simulate sending it as a response in a web application System.out.println(output); } }",java,1
Clear,"To secure the code against Insecure Deserialization vulnerabilities, you can implement the following measures:

1. Implement Input Validation: Ensure that the input data is validated and only accept serialized objects from trusted sources.

2. Use a Secure Deserialization Library: Replace the usage of `ObjectInputStream` with a more secure deserialization library like Jackson, Gson, or Protobuf, which provide safer deserialization mechanisms.

3. Enable Security Manager: Set up a Security Manager to restrict the permissions granted during deserialization to prevent potentially harmful actions.

4. Implement Whitelisting: Maintain a whitelist of allowed classes that can be deserialized to prevent arbitrary code execution by restricting the deserialization of certain classes.

5. Apply Encryption and Integrity Checks: Encrypt serialized data before transmission and implement integrity checks (e.g., digital signatures) to ensure that the data has not been tampered with during transit.

By implementing these security measures, you can significantly reduce the risks associated with Insecure Deserialization vulnerabilities in your Java code.","To secure the code against Insecure Deserialization vulnerabilities, you can implement the following measures: 1. Implement Input Validation: Ensure that the input data is validated and only accept serialized objects from trusted sources. 2. Use a Secure Deserialization Library: Replace the usage of `ObjectInputStream` with a more secure deserialization library like Jackson, Gson, or Protobuf, which provide safer deserialization mechanisms. 3. Enable Security Manager: Set up a Security Manager to restrict the permissions granted during deserialization to prevent potentially harmful actions. 4. Implement Whitelisting: Maintain a whitelist of allowed classes that can be deserialized to prevent arbitrary code execution by restricting the deserialization of certain classes. 5. Apply Encryption and Integrity Checks: Encrypt serialized data before transmission and implement integrity checks (e.g., digital signatures) to ensure that the data has not been tampered with during transit. By implementing these security measures, you can significantly reduce the risks associated with Insecure Deserialization vulnerabilities in your Java code.",php,0
Clear,"To fix the Path Traversal vulnerability in the given Java code, you need to ensure that the user input for the file name is properly validated to prevent directory traversal attacks. One way to address this issue is by restricting the file path to a specific directory.

Here's an updated version of the code with proper security measures:

```java
import java.io.File;
import java.io.FileInputStream;
import java.io.IOException;
import java.util.Scanner;

public class SecurePathTraversal {

    private static final String BASE_PATH = ""/path/to/files/""; // Specify the base directory

    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        System.out.print(""Enter file name: "");
        String fileName = scanner.nextLine();

        if (!isValidFileName(fileName)) {
            System.out.println(""Invalid file name."");
            return;
        }

        try {
            File file = new File(BASE_PATH + fileName);
            FileInputStream fis = new FileInputStream(file);

            int content;
            while ((content = fis.read()) != -1) {
                System.out.print((char) content);
            }

            fis.close();
        } catch (IOException e) {
            System.out.println(""Error reading file: "" + e.getMessage());
        }","To fix the Path Traversal vulnerability in the given Java code, you need to ensure that the user input for the file name is properly validated to prevent directory traversal attacks. One way to address this issue is by restricting the file path to a specific directory. Here's an updated version of the code with proper security measures: ```java import java.io.File; import java.io.FileInputStream; import java.io.IOException; import java.util.Scanner; public class SecurePathTraversal { private static final String BASE_PATH = ""/path/to/files/""; // Specify the base directory public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter file name: ""); String fileName = scanner.nextLine(); if (!isValidFileName(fileName)) { System.out.println(""Invalid file name.""); return; } try { File file = new File(BASE_PATH + fileName); FileInputStream fis = new FileInputStream(file); int content; while ((content = fis.read()) != -1) { System.out.print((char) content); } fis.close(); } catch (IOException e) { System.out.println(""Error reading file: "" + e.getMessage()); }",java,0
Buffer Overflow,"#include <iostream>
#include <cstdio>

void unsafe_c_input() {
    char buffer[50];
    scanf(""%s"", buffer); // no length limit
    std::cout << buffer << std::endl;
}","#include <iostream>
#include <cstdio>

void unsafe_c_input() {
    char buffer[50];
    scanf(""%s"", buffer); // no length limit
    std::cout << buffer << std::endl;
}",cpp,1
Buffer Overflow,"import java.util.Scanner;

public class BufferOverflowVulnerability {

    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        System.out.print(""Enter a string: "");
        String input = scanner.nextLine();
        
        char[] buffer = new char[10];
        
        // Vulnerable code - copying user input into buffer without proper bounds checking
        input.getChars(0, input.length(), buffer, 0);
        
        System.out.println(""Buffer content: "" + new String(buffer));
    }
}","import java.util.Scanner; public class BufferOverflowVulnerability { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter a string: ""); String input = scanner.nextLine(); char[] buffer = new char[10]; // Vulnerable code - copying user input into buffer without proper bounds checking input.getChars(0, input.length(), buffer, 0); System.out.println(""Buffer content: "" + new String(buffer)); } }",java,1
Clear,"import requests
def safe_fetch_url(url):
    allowed_domains = ['example.com', 'api.trusted.com']
    from urllib.parse import urlparse
    domain = urlparse(url).netloc
    if domain not in allowed_domains:
        raise ValueError(""Domain not allowed"")
    return requests.get(url).text","import requests
def safe_fetch_url(url):
    allowed_domains = ['example.com', 'api.trusted.com']
    from urllib.parse import urlparse
    domain = urlparse(url).netloc
    if domain not in allowed_domains:
        raise ValueError(""Domain not allowed"")
    return requests.get(url).text",python,0
Clear,"#include <iostream>
#include <sstream>

int safe_string_to_int(const std::string& str) {
    std::stringstream ss(str);
    int value;
    if (ss >> value) {
        return value;
    }
    throw std::invalid_argument(""Invalid integer"");
}","#include <iostream>
#include <sstream>

int safe_string_to_int(const std::string& str) {
    std::stringstream ss(str);
    int value;
    if (ss >> value) {
        return value;
    }
    throw std::invalid_argument(""Invalid integer"");
}",cpp,0
Clear,"#include <stdio.h>
#include <string.h>

void safe_string_copy(char *dest, const char *src, size_t dest_size) {
    if (dest_size > 0) {
        strncpy(dest, src, dest_size - 1);
        dest[dest_size - 1] = '\0';
    }
}","#include <stdio.h>
#include <string.h>

void safe_string_copy(char *dest, const char *src, size_t dest_size) {
    if (dest_size > 0) {
        strncpy(dest, src, dest_size - 1);
        dest[dest_size - 1] = '\0';
    }
}",c,0
Buffer Overflow,"import java.util.Scanner;

public class BufferOverflowExample {
    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        
        System.out.print(""Enter your name: "");
        String name = scanner.nextLine();
        
        char[] buffer = new char[10];
        // Vulnerability: No input validation or bounds checking
        for (int i = 0; i < name.length(); i++) {
            buffer[i] = name.charAt(i);
        }
        
        System.out.println(""Your name is: "" + new String(buffer));
    }
}","import java.util.Scanner; public class BufferOverflowExample { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter your name: ""); String name = scanner.nextLine(); char[] buffer = new char[10]; // Vulnerability: No input validation or bounds checking for (int i = 0; i < name.length(); i++) { buffer[i] = name.charAt(i); } System.out.println(""Your name is: "" + new String(buffer)); } }",java,1
Clear,"import hashlib
import os

def hash_password(password):
    salt = os.urandom(32)
    key = hashlib.pbkdf2_hmac('sha256', password.encode(), salt, 100000)
    return salt + key","import hashlib
import os

def hash_password(password):
    salt = os.urandom(32)
    key = hashlib.pbkdf2_hmac('sha256', password.encode(), salt, 100000)
    return salt + key",python,0
Clear,"To fix the Path Traversal vulnerability in the given Java code snippet, you can apply the following security measures:

1. Validate User Input:
   - Sanitize and validate the user input to prevent malicious characters or sequences that could lead to path traversal attacks.
   - Ensure that the file name provided by the user does not contain any directory traversal sequences like ""../"" or ""..\\"".

2. Use Absolute Paths:
   - Instead of concatenating the user-provided file name directly to a fixed base directory path (""/path/to/directory/""), use an absolute path to avoid path manipulation.
   - Ensure that the final constructed path is within the intended directory and does not allow access to files outside of it.

3. Canonicalize Paths:
   - Use Java's `File.getCanonicalPath()` method to convert any relative paths to canonical paths, which will resolve symbolic links and eliminate any redundant elements in the path.
   - Compare the canonicalized path with a whitelist of allowed directories if necessary.

4. Restrict File Access:
   - Implement proper file access controls based on user roles and permissions to restrict access only to authorized files and directories.
   - Use appropriate file permission settings to limit read/write/delete operations on files based on user privileges.

Here is","To fix the Path Traversal vulnerability in the given Java code snippet, you can apply the following security measures: 1. Validate User Input: - Sanitize and validate the user input to prevent malicious characters or sequences that could lead to path traversal attacks. - Ensure that the file name provided by the user does not contain any directory traversal sequences like ""../"" or ""..\\"". 2. Use Absolute Paths: - Instead of concatenating the user-provided file name directly to a fixed base directory path (""/path/to/directory/""), use an absolute path to avoid path manipulation. - Ensure that the final constructed path is within the intended directory and does not allow access to files outside of it. 3. Canonicalize Paths: - Use Java's `File.getCanonicalPath()` method to convert any relative paths to canonical paths, which will resolve symbolic links and eliminate any redundant elements in the path. - Compare the canonicalized path with a whitelist of allowed directories if necessary. 4. Restrict File Access: - Implement proper file access controls based on user roles and permissions to restrict access only to authorized files and directories. - Use appropriate file permission settings to limit read/write/delete operations on files based on user privileges. Here is",php,0
Clear,"const userData = JSON.parse(userInput); // Safe JSON parsing
if (userData && typeof userData === 'object') {
    processUserData(userData);
}
","const userData = JSON.parse(userInput); // Safe JSON parsing
if (userData && typeof userData === 'object') {
    processUserData(userData);
}
",javascript,0
SQL Injection,"import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Statement;

public class VulnerableCodeSnippet {

    public static void main(String[] args) {
        String userInput = ""'; DROP TABLE users; --"";

        try {
            Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");
            Statement stmt = conn.createStatement();

            String query = ""SELECT * FROM users WHERE username = '"" + userInput + ""'"";
            ResultSet rs = stmt.executeQuery(query);

            while (rs.next()) {
                System.out.println(rs.getString(""username""));
            }

            conn.close();
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.Connection; import java.sql.DriverManager; import java.sql.ResultSet; import java.sql.SQLException; import java.sql.Statement; public class VulnerableCodeSnippet { public static void main(String[] args) { String userInput = ""'; DROP TABLE users; --""; try { Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); Statement stmt = conn.createStatement(); String query = ""SELECT * FROM users WHERE username = '"" + userInput + ""'""; ResultSet rs = stmt.executeQuery(query); while (rs.next()) { System.out.println(rs.getString(""username"")); } conn.close(); } catch (SQLException e) { e.printStackTrace(); } } }",java,1
Buffer Overflow,"#include <iostream>
#include <cstdio>

void unsafe_c_input() {
    char buffer[50];
    scanf(""%s"", buffer); // no length limit
    std::cout << buffer << std::endl;
}","#include <iostream>
#include <cstdio>

void unsafe_c_input() {
    char buffer[50];
    scanf(""%s"", buffer); // no length limit
    std::cout << buffer << std::endl;
}",cpp,1
SSRF,"import requests
def fetch_url(url):
    return requests.get(url).text","import requests
def fetch_url(url):
    return requests.get(url).text",python,1
File Inclusion,"<?php
$file = $_GET['file'];
include($file); // File Inclusion
?>","<?php
$file = $_GET['file'];
include($file); // File Inclusion
?>",php,1
SQL Injection,"import java.sql.*;

public class VulnerableCode {
    public static void main(String[] args) {
        try {
            String userInput = ""'; DROP TABLE users; --"";
            String query = ""SELECT * FROM users WHERE username = '"" + userInput + ""'"";

            Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");
            Statement stmt = conn.createStatement();
            ResultSet rs = stmt.executeQuery(query);

            while (rs.next()) {
                System.out.println(rs.getString(""username""));
            }

        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.*; public class VulnerableCode { public static void main(String[] args) { try { String userInput = ""'; DROP TABLE users; --""; String query = ""SELECT * FROM users WHERE username = '"" + userInput + ""'""; Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); Statement stmt = conn.createStatement(); ResultSet rs = stmt.executeQuery(query); while (rs.next()) { System.out.println(rs.getString(""username"")); } } catch (SQLException e) { e.printStackTrace(); } } }",java,1
Clear,"#include <stdio.h>
#include <string.h>

void safe_string_copy(char *dest, const char *src, size_t dest_size) {
    if (dest_size > 0) {
        strncpy(dest, src, dest_size - 1);
        dest[dest_size - 1] = '\0';
    }
}","#include <stdio.h>
#include <string.h>

void safe_string_copy(char *dest, const char *src, size_t dest_size) {
    if (dest_size > 0) {
        strncpy(dest, src, dest_size - 1);
        dest[dest_size - 1] = '\0';
    }
}",c,0
Clear,"import os
def secure_file_access(username, filepath):
    base_dir = f""/home/{username}/files/""
    full_path = os.path.join(base_dir, filepath)
    full_path = os.path.normpath(full_path)
    if not full_path.startswith(base_dir):
        raise PermissionError(""Access denied"")
    with open(full_path, 'r') as f:
        return f.read()","import os
def secure_file_access(username, filepath):
    base_dir = f""/home/{username}/files/""
    full_path = os.path.join(base_dir, filepath)
    full_path = os.path.normpath(full_path)
    if not full_path.startswith(base_dir):
        raise PermissionError(""Access denied"")
    with open(full_path, 'r') as f:
        return f.read()",python,0
Clear,"import requests
def safe_api_call():
    api_key = os.environ.get('API_KEY')
    headers = {'Authorization': f'Bearer {api_key}'}
    return requests.get('https://api.example.com/data', headers=headers)","import requests
def safe_api_call():
    api_key = os.environ.get('API_KEY')
    headers = {'Authorization': f'Bearer {api_key}'}
    return requests.get('https://api.example.com/data', headers=headers)",python,0
Clear,"To address the security vulnerability related to Insecure Deserialization in the provided Java code snippet, you can implement the following secure coding practices:

1. **Validate and Sanitize Input**:
   - Before deserializing any object, validate and sanitize the input data to ensure it comes from a trusted source and is not tampered with or maliciously crafted.

2. **Implement Whitelisting**:
   - Use a whitelist approach to restrict the allowed classes for deserialization. Only permit known and trusted classes to be deserialized by maintaining a list of permitted classes.

3. **Disable Object Creation**:
   - Disable object creation during deserialization by using techniques like readResolve() method in Serializable classes or implementing Externalizable interface for custom serialization logic.

4. **Use Secure Deserialization Libraries**:
   - Consider using secure deserialization libraries such as Apache Commons Collections (versions 4.x), which provide protections against common deserialization vulnerabilities.

5. **Enable Security Manager**:
   - Utilize Java Security Manager to restrict the permissions granted during deserialization, preventing potentially harmful actions like accessing system resources.

6. **Implement Digital Signatures or Authentication**:
   - Apply digital signatures or authentication mechanisms to verify the integrity and authenticity of serialized data before","To address the security vulnerability related to Insecure Deserialization in the provided Java code snippet, you can implement the following secure coding practices: 1. **Validate and Sanitize Input**: - Before deserializing any object, validate and sanitize the input data to ensure it comes from a trusted source and is not tampered with or maliciously crafted. 2. **Implement Whitelisting**: - Use a whitelist approach to restrict the allowed classes for deserialization. Only permit known and trusted classes to be deserialized by maintaining a list of permitted classes. 3. **Disable Object Creation**: - Disable object creation during deserialization by using techniques like readResolve() method in Serializable classes or implementing Externalizable interface for custom serialization logic. 4. **Use Secure Deserialization Libraries**: - Consider using secure deserialization libraries such as Apache Commons Collections (versions 4.x), which provide protections against common deserialization vulnerabilities. 5. **Enable Security Manager**: - Utilize Java Security Manager to restrict the permissions granted during deserialization, preventing potentially harmful actions like accessing system resources. 6. **Implement Digital Signatures or Authentication**: - Apply digital signatures or authentication mechanisms to verify the integrity and authenticity of serialized data before",php,0
Clear,"<?php
$input = json_decode($_POST['data'], true); // Safe JSON parsing
if (json_last_error() === JSON_ERROR_NONE) {
    process_data($input);
}
?>","<?php
$input = json_decode($_POST['data'], true); // Safe JSON parsing
if (json_last_error() === JSON_ERROR_NONE) {
    process_data($input);
}
?>",php,0
Buffer Overflow,"#include <iostream>
#include <cstdio>

void unsafe_c_input() {
    char buffer[50];
    scanf(""%s"", buffer); // no length limit
    std::cout << buffer << std::endl;
}","#include <iostream>
#include <cstdio>

void unsafe_c_input() {
    char buffer[50];
    scanf(""%s"", buffer); // no length limit
    std::cout << buffer << std::endl;
}",cpp,1
Clear,"import java.util.Scanner;

public class SecureBufferUsage {

    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        System.out.print(""Enter a string: "");
        String input = scanner.nextLine();
        
        char[] buffer = new char[10];
        
        // Truncate input if it exceeds buffer size
        if (input.length() > buffer.length) {
            input = input.substring(0, buffer.length);
        }
        
        input.getChars(0, input.length(), buffer, 0); // Safe usage of buffer
        
        System.out.println(""Buffer contents: "" + new String(buffer));
    }
}","import java.util.Scanner; public class SecureBufferUsage { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter a string: ""); String input = scanner.nextLine(); char[] buffer = new char[10]; // Truncate input if it exceeds buffer size if (input.length() > buffer.length) { input = input.substring(0, buffer.length); } input.getChars(0, input.length(), buffer, 0); // Safe usage of buffer System.out.println(""Buffer contents: "" + new String(buffer)); } }",java,0
Clear,"To fix the Command Injection vulnerability in the provided Java code, you should sanitize and validate user input before executing any commands. Here is an improved version of the code that mitigates Command Injection:

```java
import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class CommandInjectionFixed {

    public static void main(String[] args) {
        try {
            BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));
            System.out.print(""Enter a command to execute: "");
            String command = reader.readLine();

            // Sanitize user input to prevent command injection
            if (isValidCommand(command)) {
                Runtime runtime = Runtime.getRuntime();
                Process process = runtime.exec(command);

                BufferedReader outputReader = new BufferedReader(new InputStreamReader(process.getInputStream()));
                String line;
                while ((line = outputReader.readLine()) != null) {
                    System.out.println(line);
                }
            } else {
                System.out.println(""Invalid command."");
            }

        } catch (IOException e) {
            e.printStackTrace();
        }
    }

    private static boolean isValidCommand(String command) {
        // Implement your validation logic here
        // Example: Only allow certain predefined commands
        return command.matches(""^(ls|ps|echo).*"");
    }
}","To fix the Command Injection vulnerability in the provided Java code, you should sanitize and validate user input before executing any commands. Here is an improved version of the code that mitigates Command Injection: ```java import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class CommandInjectionFixed { public static void main(String[] args) { try { BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a command to execute: ""); String command = reader.readLine(); // Sanitize user input to prevent command injection if (isValidCommand(command)) { Runtime runtime = Runtime.getRuntime(); Process process = runtime.exec(command); BufferedReader outputReader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = outputReader.readLine()) != null) { System.out.println(line); } } else { System.out.println(""Invalid command.""); } } catch (IOException e) { e.printStackTrace(); } } private static boolean isValidCommand(String command) { // Implement your validation logic here // Example: Only allow certain predefined commands return command.matches(""^(ls|ps|echo).*""); } }",java,0
Clear,"app.get('/user/:id', (req, res) => {
    const userId = parseInt(req.params.id);
    db.query('SELECT * FROM users WHERE id = ?', [userId], (err, result) => {
        res.json(result);
    });
});
","app.get('/user/:id', (req, res) => {
    const userId = parseInt(req.params.id);
    db.query('SELECT * FROM users WHERE id = ?', [userId], (err, result) => {
        res.json(result);
    });
});
",javascript,0
Clear,"import os
def get_api_key():
    return os.environ.get('API_KEY')","import os
def get_api_key():
    return os.environ.get('API_KEY')",python,0
Clear,"To fix the Path Traversal vulnerability in the provided Java code snippet, you need to ensure that the input file path provided by the user is properly sanitized and validated before accessing it. Here's an improved version of the code with security measures:

```java
import java.io.File;
import java.io.FileInputStream;
import java.io.IOException;
import java.util.Scanner;

public class SecurePathTraversal {

    private static final String BASE_PATH = ""C:\\data\\"";

    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);

        System.out.print(""Enter file name: "");
        String fileName = scanner.nextLine();

        if (isValidFileName(fileName)) {
            try {
                File file = new File(BASE_PATH + fileName);
                if (file.exists() && file.isFile()) {
                    FileInputStream fis = new FileInputStream(file);
                    int data;

                    while ((data = fis.read()) != -1) {
                        System.out.print((char) data);
                    }

                    fis.close();
                } else {
                    System.out.println(""File does not exist or is not a regular file."");
                }
            } catch (IOException e) {
                System.out.println(""Error reading file: "" + e.getMessage());
            }
        } else {","To fix the Path Traversal vulnerability in the provided Java code snippet, you need to ensure that the input file path provided by the user is properly sanitized and validated before accessing it. Here's an improved version of the code with security measures: ```java import java.io.File; import java.io.FileInputStream; import java.io.IOException; import java.util.Scanner; public class SecurePathTraversal { private static final String BASE_PATH = ""C:\\data\\""; public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter file name: ""); String fileName = scanner.nextLine(); if (isValidFileName(fileName)) { try { File file = new File(BASE_PATH + fileName); if (file.exists() && file.isFile()) { FileInputStream fis = new FileInputStream(file); int data; while ((data = fis.read()) != -1) { System.out.print((char) data); } fis.close(); } else { System.out.println(""File does not exist or is not a regular file.""); } } catch (IOException e) { System.out.println(""Error reading file: "" + e.getMessage()); } } else {",java,0
Command Injection,"import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class CommandInjectionExample {

    public static void main(String[] args) {
        try {
            BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));
            System.out.print(""Enter the IP address to ping: "");
            String ip = reader.readLine();

            // Vulnerable code - user input directly used in command
            String command = ""ping "" + ip;
            Process process = Runtime.getRuntime().exec(command);

            BufferedReader inputReader = new BufferedReader(new InputStreamReader(process.getInputStream()));
            String line;
            while ((line = inputReader.readLine()) != null) {
                System.out.println(line);
            }

        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}","import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class CommandInjectionExample { public static void main(String[] args) { try { BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter the IP address to ping: ""); String ip = reader.readLine(); // Vulnerable code - user input directly used in command String command = ""ping "" + ip; Process process = Runtime.getRuntime().exec(command); BufferedReader inputReader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = inputReader.readLine()) != null) { System.out.println(line); } } catch (IOException e) { e.printStackTrace(); } } }",java,1
Command Injection,"import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class CommandInjectionExample {
    public static void main(String[] args) {
        try {
            BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));
            System.out.print(""Enter a command to execute: "");
            String command = reader.readLine();

            // WARNING: Vulnerable code - User input is directly concatenated into the command string
            Process process = Runtime.getRuntime().exec(""ping "" + command);

            BufferedReader inputReader = new BufferedReader(new InputStreamReader(process.getInputStream()));
            String line;
            while ((line = inputReader.readLine()) != null) {
                System.out.println(line);
            }

        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}","import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class CommandInjectionExample { public static void main(String[] args) { try { BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a command to execute: ""); String command = reader.readLine(); // WARNING: Vulnerable code - User input is directly concatenated into the command string Process process = Runtime.getRuntime().exec(""ping "" + command); BufferedReader inputReader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = inputReader.readLine()) != null) { System.out.println(line); } } catch (IOException e) { e.printStackTrace(); } } }",java,1
Path Traversal,"import java.io.File;
import java.io.FileInputStream;
import java.io.IOException;
import java.util.Scanner;

public class PathTraversalExample {
    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        
        System.out.print(""Enter the file name: "");
        String fileName = scanner.nextLine();
        
        File file = new File(""C:/data/"" + fileName);
        
        try {
            FileInputStream fis = new FileInputStream(file);
            int content;
            
            while ((content = fis.read()) != -1) {
                System.out.print((char) content);
            }
            
            fis.close();
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}","import java.io.File; import java.io.FileInputStream; import java.io.IOException; import java.util.Scanner; public class PathTraversalExample { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter the file name: ""); String fileName = scanner.nextLine(); File file = new File(""C:/data/"" + fileName); try { FileInputStream fis = new FileInputStream(file); int content; while ((content = fis.read()) != -1) { System.out.print((char) content); } fis.close(); } catch (IOException e) { e.printStackTrace(); } } }",java,1
Hardcoded Secrets,"localStorage.setItem('token', 'hardcoded-secret-token-123'); // Hardcoded secret
","localStorage.setItem('token', 'hardcoded-secret-token-123'); // Hardcoded secret
",javascript,1
Command Injection,"import os
def backup_database(db_name):
    os.system(f""pg_dump {db_name} > backup.sql"")","import os
def backup_database(db_name):
    os.system(f""pg_dump {db_name} > backup.sql"")",python,1
Cross-Site Scripting (XSS),"import java.io.*;
import javax.servlet.*;
import javax.servlet.http.*;

public class VulnerableServlet extends HttpServlet {
    
    protected void doGet(HttpServletRequest request, HttpServletResponse response)
            throws ServletException, IOException {
        
        String userInput = request.getParameter(""input"");
        
        PrintWriter out = response.getWriter();
        out.println(""<html><body>"");
        out.println(""User Input: "" + userInput); // Vulnerability: User input is directly outputted to the HTML response
        out.println(""</body></html>"");
    }
}","import java.io.*; import javax.servlet.*; import javax.servlet.http.*; public class VulnerableServlet extends HttpServlet { protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { String userInput = request.getParameter(""input""); PrintWriter out = response.getWriter(); out.println(""<html><body>""); out.println(""User Input: "" + userInput); // Vulnerability: User input is directly outputted to the HTML response out.println(""</body></html>""); } }",java,1
Buffer Overflow,"#include <iostream>
#include <cstring>

void unsafe_c_string(char* input) {
    char buffer[100];
    strcpy(buffer, input); // potential buffer overflow
    std::cout << buffer << std::endl;
}","#include <iostream>
#include <cstring>

void unsafe_c_string(char* input) {
    char buffer[100];
    strcpy(buffer, input); // potential buffer overflow
    std::cout << buffer << std::endl;
}",cpp,1
Clear,"app.get('/user/:id', (req, res) => {
    const userId = parseInt(req.params.id);
    db.query('SELECT * FROM users WHERE id = ?', [userId], (err, result) => {
        res.json(result);
    });
});
","app.get('/user/:id', (req, res) => {
    const userId = parseInt(req.params.id);
    db.query('SELECT * FROM users WHERE id = ?', [userId], (err, result) => {
        res.json(result);
    });
});
",javascript,0
Cross-Site Scripting (XSS),"def display_comment(comment_text):
    return f""<div class='comment'>{comment_text}</div>"" ","def display_comment(comment_text):
    return f""<div class='comment'>{comment_text}</div>"" ",python,1
Out-of-Bounds,"#include <iostream>

class UnsafeClass {
    int data[10];
public:
    int get_data(int index) {
        return data[index]; // no bounds checking
    }
};","#include <iostream>

class UnsafeClass {
    int data[10];
public:
    int get_data(int index) {
        return data[index]; // no bounds checking
    }
};",cpp,1
Clear,"#include <stdio.h>
#include <string.h>

void safe_string_copy(char *dest, const char *src, size_t dest_size) {
    if (dest_size > 0) {
        strncpy(dest, src, dest_size - 1);
        dest[dest_size - 1] = '\0';
    }
}","#include <stdio.h>
#include <string.h>

void safe_string_copy(char *dest, const char *src, size_t dest_size) {
    if (dest_size > 0) {
        strncpy(dest, src, dest_size - 1);
        dest[dest_size - 1] = '\0';
    }
}",c,0
Cross-Site Scripting (XSS),"def display_comment(comment_text):
    return f""<div class='comment'>{comment_text}</div>"" ","def display_comment(comment_text):
    return f""<div class='comment'>{comment_text}</div>"" ",python,1
Hardcoded Secrets,"localStorage.setItem('token', 'hardcoded-secret-token-123'); // Hardcoded secret
","localStorage.setItem('token', 'hardcoded-secret-token-123'); // Hardcoded secret
",javascript,1
Clear,"import java.io.*;
import javax.servlet.*;
import javax.servlet.http.*;
import org.owasp.encoder.Encode;

public class XSSSafeServlet extends HttpServlet {
    protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        String userInput = request.getParameter(""input"");
        String encodedUserInput = Encode.forHtml(userInput);
        String htmlResponse = ""<html><body><h1>Welcome "" + encodedUserInput + ""</h1></body></html>"";
        
        response.setContentType(""text/html"");
        PrintWriter out = response.getWriter();
        out.println(htmlResponse);
    }
}","import java.io.*; import javax.servlet.*; import javax.servlet.http.*; import org.owasp.encoder.Encode; public class XSSSafeServlet extends HttpServlet { protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { String userInput = request.getParameter(""input""); String encodedUserInput = Encode.forHtml(userInput); String htmlResponse = ""<html><body><h1>Welcome "" + encodedUserInput + ""</h1></body></html>""; response.setContentType(""text/html""); PrintWriter out = response.getWriter(); out.println(htmlResponse); } }",java,0
Clear,"<?php
$file = basename($_GET['file']);
$allowed = ['page1.php', 'page2.php'];
if (in_array($file, $allowed)) {
    include($file);
}
?>","<?php
$file = basename($_GET['file']);
$allowed = ['page1.php', 'page2.php'];
if (in_array($file, $allowed)) {
    include($file);
}
?>",php,0
Clear,"import org.owasp.encoder.Encode;

public class XSSSecureCode {
    public static void main(String[] args) {
        String userInput = ""<script>alert('XSS Vulnerability')</script>"";
        
        String output = ""<div>"" + Encode.forHtml(userInput) + ""</div>"";
        
        System.out.println(output);
    }
}","import org.owasp.encoder.Encode; public class XSSSecureCode { public static void main(String[] args) { String userInput = ""<script>alert('XSS Vulnerability')</script>""; String output = ""<div>"" + Encode.forHtml(userInput) + ""</div>""; System.out.println(output); } }",java,0
Buffer Overflow,"#include <iostream>
#include <cstdio>

void unsafe_c_input() {
    char buffer[50];
    scanf(""%s"", buffer); // no length limit
    std::cout << buffer << std::endl;
}","#include <iostream>
#include <cstdio>

void unsafe_c_input() {
    char buffer[50];
    scanf(""%s"", buffer); // no length limit
    std::cout << buffer << std::endl;
}",cpp,1
Clear,"#include <stdio.h>
#include <stdlib.h>

void safe_file_operation(const char *filename) {
    FILE *file = fopen(filename, ""r"");
    if (file != NULL) {
        char buffer[256];
        while (fgets(buffer, sizeof(buffer), file)) {
            printf(""%s"", buffer);
        }
        fclose(file);
    }
}","#include <stdio.h>
#include <stdlib.h>

void safe_file_operation(const char *filename) {
    FILE *file = fopen(filename, ""r"");
    if (file != NULL) {
        char buffer[256];
        while (fgets(buffer, sizeof(buffer), file)) {
            printf(""%s"", buffer);
        }
        fclose(file);
    }
}",c,0
Clear,"#include <stdio.h>
#include <string.h>

int safe_buffer_operation(char *input) {
    char buffer[100];
    if (strlen(input) < sizeof(buffer)) {
        strcpy(buffer, input);
        return 0;
    }
    return -1; // buffer too small
}","#include <stdio.h>
#include <string.h>

int safe_buffer_operation(char *input) {
    char buffer[100];
    if (strlen(input) < sizeof(buffer)) {
        strcpy(buffer, input);
        return 0;
    }
    return -1; // buffer too small
}",c,0
SQL Injection,"import java.sql.*;

public class SQLInjectionVulnerableExample {
    public static void main(String[] args) {
        try {
            // Simulating user input (vulnerable)
            String userInput = ""1 OR 1=1"";
            
            // Constructing the SQL query using user input (vulnerable)
            String query = ""SELECT * FROM users WHERE id = "" + userInput;
            
            // Establishing a connection to the database
            Connection connection = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");
            
            // Executing the SQL query
            Statement statement = connection.createStatement();
            ResultSet resultSet = statement.executeQuery(query);
            
            // Processing the query results
            while(resultSet.next()) {
                System.out.println(""User ID: "" + resultSet.getInt(""id""));
                System.out.println(""Username: "" + resultSet.getString(""username""));
                System.out.println(""--------------------"");
            }
            
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.*; public class SQLInjectionVulnerableExample { public static void main(String[] args) { try { // Simulating user input (vulnerable) String userInput = ""1 OR 1=1""; // Constructing the SQL query using user input (vulnerable) String query = ""SELECT * FROM users WHERE id = "" + userInput; // Establishing a connection to the database Connection connection = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); // Executing the SQL query Statement statement = connection.createStatement(); ResultSet resultSet = statement.executeQuery(query); // Processing the query results while(resultSet.next()) { System.out.println(""User ID: "" + resultSet.getInt(""id"")); System.out.println(""Username: "" + resultSet.getString(""username"")); System.out.println(""--------------------""); } } catch (SQLException e) { e.printStackTrace(); } } }",java,1
Path Traversal,"import os
def read_file(filename):
    with open('/var/www/uploads/' + filename, 'r') as f:
        return f.read()","import os
def read_file(filename):
    with open('/var/www/uploads/' + filename, 'r') as f:
        return f.read()",python,1
SQL Injection,"<?php
$username = $_POST['username'];
$query = ""SELECT * FROM users WHERE username = '$username'"";
$result = mysql_query($query); // SQL Injection
?>","<?php
$username = $_POST['username'];
$query = ""SELECT * FROM users WHERE username = '$username'"";
$result = mysql_query($query); // SQL Injection
?>",php,1
Clear,"To fix the Path Traversal vulnerability in the given Java code snippet, you need to ensure that the input file path is properly validated and restricted to prevent directory traversal attacks. Here's an updated version of the code with proper security measures:

```java
import java.io.File;
import java.io.FileReader;
import java.io.IOException;
import java.util.Scanner;

public class SecurePathTraversal {

    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        System.out.print(""Enter a file name: "");
        String fileName = scanner.nextLine();

        // Validate the file name to prevent directory traversal
        if (!isValidFileName(fileName)) {
            System.out.println(""Invalid file name."");
            return;
        }

        File file = new File(""C:\\data\\"" + fileName); // Assuming files are stored in C:\data\ directory

        try {
            if (file.exists()) { // Check if the file exists before reading
                FileReader reader = new FileReader(file);
                int data;
                while ((data = reader.read()) != -1) {
                    System.out.print((char) data);
                }
                reader.close();
            } else {
                System.out.println(""File does not exist."");
            }
        } catch","To fix the Path Traversal vulnerability in the given Java code snippet, you need to ensure that the input file path is properly validated and restricted to prevent directory traversal attacks. Here's an updated version of the code with proper security measures: ```java import java.io.File; import java.io.FileReader; import java.io.IOException; import java.util.Scanner; public class SecurePathTraversal { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter a file name: ""); String fileName = scanner.nextLine(); // Validate the file name to prevent directory traversal if (!isValidFileName(fileName)) { System.out.println(""Invalid file name.""); return; } File file = new File(""C:\\data\\"" + fileName); // Assuming files are stored in C:\data\ directory try { if (file.exists()) { // Check if the file exists before reading FileReader reader = new FileReader(file); int data; while ((data = reader.read()) != -1) { System.out.print((char) data); } reader.close(); } else { System.out.println(""File does not exist.""); } } catch",java,0
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Clear,"#include <iostream>
#include <memory>

void safe_memory_management() {
    auto ptr = std::make_unique<int>(42);
    std::cout << *ptr << std::endl;
}","#include <iostream>
#include <memory>

void safe_memory_management() {
    auto ptr = std::make_unique<int>(42);
    std::cout << *ptr << std::endl;
}",cpp,0
Clear,"#include <iostream>
#include <vector>
#include <stdexcept>

int safe_vector_access(const std::vector<int>& vec, size_t index) {
    if (index >= vec.size()) {
        throw std::out_of_range(""Index out of range"");
    }
    return vec[index];
}","#include <iostream>
#include <vector>
#include <stdexcept>

int safe_vector_access(const std::vector<int>& vec, size_t index) {
    if (index >= vec.size()) {
        throw std::out_of_range(""Index out of range"");
    }
    return vec[index];
}",cpp,0
Clear,"import java.sql.*;

public class SecureSQLQuery {

    public static void main(String[] args) {
        String userInput = ""'; DROP TABLE users; --""; // Malicious user input

        try {
            Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");
            
            // Use PreparedStatement to create a parameterized query
            String query = ""SELECT * FROM users WHERE username = ?"";
            PreparedStatement pstmt = conn.prepareStatement(query);
            pstmt.setString(1, userInput); // Set the user input as a parameter
            
            ResultSet rs = pstmt.executeQuery();

            while (rs.next()) {
                System.out.println(""User: "" + rs.getString(""username""));
            }

        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.*; public class SecureSQLQuery { public static void main(String[] args) { String userInput = ""'; DROP TABLE users; --""; // Malicious user input try { Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); // Use PreparedStatement to create a parameterized query String query = ""SELECT * FROM users WHERE username = ?""; PreparedStatement pstmt = conn.prepareStatement(query); pstmt.setString(1, userInput); // Set the user input as a parameter ResultSet rs = pstmt.executeQuery(); while (rs.next()) { System.out.println(""User: "" + rs.getString(""username"")); } } catch (SQLException e) { e.printStackTrace(); } } }",java,0
Clear,"To prevent Cross-Site Scripting (XSS) attacks in the Java code snippet provided, you can encode the user input before including it in the HTML response. This will ensure that any malicious scripts entered by the user will be treated as plain text and not executed as HTML or JavaScript.

Here's an updated version of the code with proper security measures:

```java
import java.io.*;
import javax.servlet.*;
import javax.servlet.http.*;

public class SecureServlet extends HttpServlet {
    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        String userInput = request.getParameter(""input"");
        
        // Encode user input to prevent XSS attacks
        String safeUserInput = encodeHtml(userInput);
        
        String htmlResponse = ""<html><body>Welcome, "" + safeUserInput + ""!</body></html>"";
        
        response.setContentType(""text/html"");
        PrintWriter out = response.getWriter();
        out.println(htmlResponse);
    }
    
    // Function to encode special characters in user input
    private String encodeHtml(String input) {
        return input.replace(""&"", ""&amp;"")
                    .replace(""<"", ""&lt;"")
                    .replace("">"", ""&gt;"")
                    .replace(""\"""", ""&quot;"")
                    .replace(""'"", ""&#39;"");
    }","To prevent Cross-Site Scripting (XSS) attacks in the Java code snippet provided, you can encode the user input before including it in the HTML response. This will ensure that any malicious scripts entered by the user will be treated as plain text and not executed as HTML or JavaScript. Here's an updated version of the code with proper security measures: ```java import java.io.*; import javax.servlet.*; import javax.servlet.http.*; public class SecureServlet extends HttpServlet { protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { String userInput = request.getParameter(""input""); // Encode user input to prevent XSS attacks String safeUserInput = encodeHtml(userInput); String htmlResponse = ""<html><body>Welcome, "" + safeUserInput + ""!</body></html>""; response.setContentType(""text/html""); PrintWriter out = response.getWriter(); out.println(htmlResponse); } // Function to encode special characters in user input private String encodeHtml(String input) { return input.replace(""&"", ""&amp;"") .replace(""<"", ""&lt;"") .replace("">"", ""&gt;"") .replace(""\"""", ""&quot;"") .replace(""'"", ""&#39;""); }",java,0
Clear,"To address the insecure deserialization vulnerability in the provided code snippet, you can implement proper security measures to prevent malicious code execution. One common approach to secure deserialization is to use a whitelist of allowed classes during deserialization. This helps restrict the types of objects that can be deserialized and prevents the execution of arbitrary code.

Here is an improved version of the code snippet with secure deserialization using a whitelist approach:

```java
import java.io.*;
import java.util.ArrayList;
import java.util.List;

public class SecureDeserializationDemo {

    // Define a whitelist of allowed classes for deserialization
    private static List<Class<?>> allowedClasses = new ArrayList<>();

    static {
        // Add the classes that are safe for deserialization to the whitelist
        allowedClasses.add(String.class);
    }

    public static void main(String[] args) {
        try {
            // User input - Serialized object with potentially malicious code
            String userInput = ""rO0ABXNyAChjb20uZXhhbXBsZS5JbnNlY3VyaXR5UHJvZmlsZU1hY2hpbmVNYW5hZ2VyDAAAAAABAgAJTAAEbW","To address the insecure deserialization vulnerability in the provided code snippet, you can implement proper security measures to prevent malicious code execution. One common approach to secure deserialization is to use a whitelist of allowed classes during deserialization. This helps restrict the types of objects that can be deserialized and prevents the execution of arbitrary code. Here is an improved version of the code snippet with secure deserialization using a whitelist approach: ```java import java.io.*; import java.util.ArrayList; import java.util.List; public class SecureDeserializationDemo { // Define a whitelist of allowed classes for deserialization private static List<Class<?>> allowedClasses = new ArrayList<>(); static { // Add the classes that are safe for deserialization to the whitelist allowedClasses.add(String.class); } public static void main(String[] args) { try { // User input - Serialized object with potentially malicious code String userInput = ""rO0ABXNyAChjb20uZXhhbXBsZS5JbnNlY3VyaXR5UHJvZmlsZU1hY2hpbmVNYW5hZ2VyDAAAAAABAgAJTAAEbW",java,0
XSS,"<?php
echo $_GET['message']; // XSS
?>","<?php
echo $_GET['message']; // XSS
?>",php,1
Clear,"import org.owasp.encoder.Encode;

import java.util.Scanner;

public class XSSSecureCode {
    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);

        System.out.print(""Enter your name: "");
        String userInput = scanner.nextLine();

        String encodedInput = Encode.forHtml(userInput); // Encoding user input

        System.out.println(""Hello, "" + encodedInput + ""!""); // Safe output

        scanner.close();
    }
}","import org.owasp.encoder.Encode; import java.util.Scanner; public class XSSSecureCode { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter your name: ""); String userInput = scanner.nextLine(); String encodedInput = Encode.forHtml(userInput); // Encoding user input System.out.println(""Hello, "" + encodedInput + ""!""); // Safe output scanner.close(); } }",java,0
Cross-Site Scripting (XSS),"import java.io.IOException;
import java.io.PrintWriter;

public class XSSVulnerableCode {

    public static void main(String[] args) {
        String userInput = ""<script>alert('XSS Vulnerability')</script>"";
        
        // Improperly handling user input without proper sanitization
        String output = ""<p>Welcome, "" + userInput + ""</p>"";

        try {
            PrintWriter out = new PrintWriter(""output.html"");
            out.println(output);
            out.close();
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}","import java.io.IOException; import java.io.PrintWriter; public class XSSVulnerableCode { public static void main(String[] args) { String userInput = ""<script>alert('XSS Vulnerability')</script>""; // Improperly handling user input without proper sanitization String output = ""<p>Welcome, "" + userInput + ""</p>""; try { PrintWriter out = new PrintWriter(""output.html""); out.println(output); out.close(); } catch (IOException e) { e.printStackTrace(); } } }",java,1
Clear,"#include <iostream>
#include <string>
#include <vector>

void safe_string_handling(const std::string& input) {
    std::string safe_copy = input;
    std::cout << safe_copy << std::endl;
}","#include <iostream>
#include <string>
#include <vector>

void safe_string_handling(const std::string& input) {
    std::string safe_copy = input;
    std::cout << safe_copy << std::endl;
}",cpp,0
Clear,"const shell = require('child_process');
const safeInput = userInput.replace(/[^a-zA-Z0-9.]/g, '');
shell.execFile('ping', [safeInput]); // Safe command execution
","const shell = require('child_process');
const safeInput = userInput.replace(/[^a-zA-Z0-9.]/g, '');
shell.execFile('ping', [safeInput]); // Safe command execution
",javascript,0
Buffer Overflow,"import java.util.Scanner;

public class BufferOverflowExample {

    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        
        System.out.print(""Enter a string: "");
        String userInput = scanner.next();
        
        char[] buffer = new char[10];
        userInput.getChars(0, userInput.length(), buffer, 0);
        
        System.out.println(""Buffer content: "" + new String(buffer));
    }
}","import java.util.Scanner; public class BufferOverflowExample { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter a string: ""); String userInput = scanner.next(); char[] buffer = new char[10]; userInput.getChars(0, userInput.length(), buffer, 0); System.out.println(""Buffer content: "" + new String(buffer)); } }",java,1
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Buffer Overflow,"#include <iostream>
#include <cstdio>

void unsafe_c_input() {
    char buffer[50];
    scanf(""%s"", buffer); // no length limit
    std::cout << buffer << std::endl;
}","#include <iostream>
#include <cstdio>

void unsafe_c_input() {
    char buffer[50];
    scanf(""%s"", buffer); // no length limit
    std::cout << buffer << std::endl;
}",cpp,1
File Inclusion,"<?php
$file = $_GET['file'];
include($file); // File Inclusion
?>","<?php
$file = $_GET['file'];
include($file); // File Inclusion
?>",php,1
Code Injection,"const userData = eval('(' + userInput + ')'); // eval injection
","const userData = eval('(' + userInput + ')'); // eval injection
",javascript,1
Command Injection,"<?php
$cmd = $_GET['cmd'];
system($cmd); // Command Injection
?>","<?php
$cmd = $_GET['cmd'];
system($cmd); // Command Injection
?>",php,1
Insecure Deserialization,"<?php
$data = $_POST['data'];
unserialize($data); // Insecure Deserialization
?>","<?php
$data = $_POST['data'];
unserialize($data); // Insecure Deserialization
?>",php,1
Clear,"#include <stdio.h>
#include <stdlib.h>

void safe_file_operation(const char *filename) {
    FILE *file = fopen(filename, ""r"");
    if (file != NULL) {
        char buffer[256];
        while (fgets(buffer, sizeof(buffer), file)) {
            printf(""%s"", buffer);
        }
        fclose(file);
    }
}","#include <stdio.h>
#include <stdlib.h>

void safe_file_operation(const char *filename) {
    FILE *file = fopen(filename, ""r"");
    if (file != NULL) {
        char buffer[256];
        while (fgets(buffer, sizeof(buffer), file)) {
            printf(""%s"", buffer);
        }
        fclose(file);
    }
}",c,0
Clear,"<?php
$message = htmlspecialchars($_GET['message'], ENT_QUOTES, 'UTF-8');
echo $message; // Sanitized output
?>","<?php
$message = htmlspecialchars($_GET['message'], ENT_QUOTES, 'UTF-8');
echo $message; // Sanitized output
?>",php,0
Clear,"import json
def parse_safe_json(json_str):
    try:
        return json.loads(json_str)
    except json.JSONDecodeError:
        raise ValueError(""Invalid JSON"")","import json
def parse_safe_json(json_str):
    try:
        return json.loads(json_str)
    except json.JSONDecodeError:
        raise ValueError(""Invalid JSON"")",python,0
Buffer Overflow,"import java.util.Scanner;

public class BufferOverflowVulnerability {

    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        System.out.print(""Enter your name: "");
        String name = scanner.nextLine();
        
        // Vulnerable code - Buffer Overflow can occur if the user enters a long string
        char[] buffer = new char[10];
        name.getChars(0, name.length(), buffer, 0);
        
        System.out.println(""Hello, "" + new String(buffer));
    }
}","import java.util.Scanner; public class BufferOverflowVulnerability { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter your name: ""); String name = scanner.nextLine(); // Vulnerable code - Buffer Overflow can occur if the user enters a long string char[] buffer = new char[10]; name.getChars(0, name.length(), buffer, 0); System.out.println(""Hello, "" + new String(buffer)); } }",java,1
Clear,"#include <iostream>
#include <memory>

void safe_memory_management() {
    auto ptr = std::make_unique<int>(42);
    std::cout << *ptr << std::endl;
}","#include <iostream>
#include <memory>

void safe_memory_management() {
    auto ptr = std::make_unique<int>(42);
    std::cout << *ptr << std::endl;
}",cpp,0
Clear,"<?php
$cmd = escapeshellarg($_GET['cmd']);
system(""ls "" . $cmd); // Escaped command
?>","<?php
$cmd = escapeshellarg($_GET['cmd']);
system(""ls "" . $cmd); // Escaped command
?>",php,0
Clear,"const token = process.env.API_TOKEN; // Environment variable
fetch('/api/data', {
    headers: { 'Authorization': `Bearer ${token}` }
});
","const token = process.env.API_TOKEN; // Environment variable
fetch('/api/data', {
    headers: { 'Authorization': `Bearer ${token}` }
});
",javascript,0
Clear,"#include <stdio.h>
#include <string.h>

void safe_string_copy(char *dest, const char *src, size_t dest_size) {
    if (dest_size > 0) {
        strncpy(dest, src, dest_size - 1);
        dest[dest_size - 1] = '\0';
    }
}","#include <stdio.h>
#include <string.h>

void safe_string_copy(char *dest, const char *src, size_t dest_size) {
    if (dest_size > 0) {
        strncpy(dest, src, dest_size - 1);
        dest[dest_size - 1] = '\0';
    }
}",c,0
Clear,"const userData = JSON.parse(userInput); // Safe JSON parsing
if (userData && typeof userData === 'object') {
    processUserData(userData);
}
","const userData = JSON.parse(userInput); // Safe JSON parsing
if (userData && typeof userData === 'object') {
    processUserData(userData);
}
",javascript,0
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Clear,"const shell = require('child_process');
const safeInput = userInput.replace(/[^a-zA-Z0-9.]/g, '');
shell.execFile('ping', [safeInput]); // Safe command execution
","const shell = require('child_process');
const safeInput = userInput.replace(/[^a-zA-Z0-9.]/g, '');
shell.execFile('ping', [safeInput]); // Safe command execution
",javascript,0
Memory Corruption,"#include <iostream>

void unsafe_virtual_call() {
    // Potential vtable corruption vulnerability
    class Base {
    public:
        virtual void func() { std::cout << ""Base"" << std::endl; }
    };
    
    class Derived : public Base {
    public:
        void func() override { std::cout << ""Derived"" << std::endl; }
    };
}","#include <iostream>

void unsafe_virtual_call() {
    // Potential vtable corruption vulnerability
    class Base {
    public:
        virtual void func() { std::cout << ""Base"" << std::endl; }
    };
    
    class Derived : public Base {
    public:
        void func() override { std::cout << ""Derived"" << std::endl; }
    };
}",cpp,1
Hardcoded Secrets,"localStorage.setItem('token', 'hardcoded-secret-token-123'); // Hardcoded secret
","localStorage.setItem('token', 'hardcoded-secret-token-123'); // Hardcoded secret
",javascript,1
Clear,"const userData = JSON.parse(userInput); // Safe JSON parsing
if (userData && typeof userData === 'object') {
    processUserData(userData);
}
","const userData = JSON.parse(userInput); // Safe JSON parsing
if (userData && typeof userData === 'object') {
    processUserData(userData);
}
",javascript,0
Cross-Site Scripting (XSS),"from flask import Flask, request
app = Flask(__name__)

@app.route('/search')
def search():
    query = request.args.get('q', '')
    return f'<h1>Search results for: {query}</h1>'","from flask import Flask, request
app = Flask(__name__)

@app.route('/search')
def search():
    query = request.args.get('q', '')
    return f'<h1>Search results for: {query}</h1>'",python,1
Clear,"app.get('/user/:id', (req, res) => {
    const userId = parseInt(req.params.id);
    db.query('SELECT * FROM users WHERE id = ?', [userId], (err, result) => {
        res.json(result);
    });
});
","app.get('/user/:id', (req, res) => {
    const userId = parseInt(req.params.id);
    db.query('SELECT * FROM users WHERE id = ?', [userId], (err, result) => {
        res.json(result);
    });
});
",javascript,0
Clear,"app.get('/user/:id', (req, res) => {
    const userId = parseInt(req.params.id);
    db.query('SELECT * FROM users WHERE id = ?', [userId], (err, result) => {
        res.json(result);
    });
});
","app.get('/user/:id', (req, res) => {
    const userId = parseInt(req.params.id);
    db.query('SELECT * FROM users WHERE id = ?', [userId], (err, result) => {
        res.json(result);
    });
});
",javascript,0
Clear,"#include <stdio.h>
#include <string.h>

void safe_string_copy(char *dest, const char *src, size_t dest_size) {
    if (dest_size > 0) {
        strncpy(dest, src, dest_size - 1);
        dest[dest_size - 1] = '\0';
    }
}","#include <stdio.h>
#include <string.h>

void safe_string_copy(char *dest, const char *src, size_t dest_size) {
    if (dest_size > 0) {
        strncpy(dest, src, dest_size - 1);
        dest[dest_size - 1] = '\0';
    }
}",c,0
Path Traversal,"def get_user_file(username, filepath):
    import os
    base_path = f""/home/{username}/files/""
    full_path = base_path + filepath
    with open(full_path, 'r') as f:
        return f.read()","def get_user_file(username, filepath):
    import os
    base_path = f""/home/{username}/files/""
    full_path = base_path + filepath
    with open(full_path, 'r') as f:
        return f.read()",python,1
Clear,"import subprocess
def safe_database_backup(db_name):
    result = subprocess.run(['pg_dump', db_name], capture_output=True, text=True)
    with open('backup.sql', 'w') as f:
        f.write(result.stdout)","import subprocess
def safe_database_backup(db_name):
    result = subprocess.run(['pg_dump', db_name], capture_output=True, text=True)
    with open('backup.sql', 'w') as f:
        f.write(result.stdout)",python,0
Buffer Overflow,"import java.util.Scanner;

public class BufferOverflowExample {
    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        
        System.out.print(""Enter a string: "");
        String input = scanner.nextLine();
        
        char[] buffer = new char[10];
        
        // Copy input into buffer without proper bounds checking
        for (int i = 0; i < input.length(); i++) {
            buffer[i] = input.charAt(i);
        }
        
        System.out.println(""Buffer contents: "" + new String(buffer));
    }
}","import java.util.Scanner; public class BufferOverflowExample { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter a string: ""); String input = scanner.nextLine(); char[] buffer = new char[10]; // Copy input into buffer without proper bounds checking for (int i = 0; i < input.length(); i++) { buffer[i] = input.charAt(i); } System.out.println(""Buffer contents: "" + new String(buffer)); } }",java,1
Clear,"<?php
$cmd = escapeshellarg($_GET['cmd']);
system(""ls "" . $cmd); // Escaped command
?>","<?php
$cmd = escapeshellarg($_GET['cmd']);
system(""ls "" . $cmd); // Escaped command
?>",php,0
Command Injection,"<?php
$cmd = $_GET['cmd'];
system($cmd); // Command Injection
?>","<?php
$cmd = $_GET['cmd'];
system($cmd); // Command Injection
?>",php,1
Clear,"import mysql.connector
def safe_product_search(category):
    db = mysql.connector.connect(host=""localhost"", user=""user"", password=""pass"", database=""shop"")
    cursor = db.cursor()
    cursor.execute(""SELECT * FROM products WHERE category = %s"", (category,))
    return cursor.fetchall()","import mysql.connector
def safe_product_search(category):
    db = mysql.connector.connect(host=""localhost"", user=""user"", password=""pass"", database=""shop"")
    cursor = db.cursor()
    cursor.execute(""SELECT * FROM products WHERE category = %s"", (category,))
    return cursor.fetchall()",python,0
Command Injection,"import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class CommandInjectionExample {
    public static void main(String[] args) throws IOException {
        BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));
        
        System.out.print(""Enter a command to execute: "");
        String command = reader.readLine();
        
        Runtime runtime = Runtime.getRuntime();
        Process process = runtime.exec(""ping "" + command);
        
        BufferedReader processOutputReader = new BufferedReader(new InputStreamReader(process.getInputStream()));
        String line;
        
        while ((line = processOutputReader.readLine()) != null) {
            System.out.println(line);
        }
    }
}","import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class CommandInjectionExample { public static void main(String[] args) throws IOException { BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a command to execute: ""); String command = reader.readLine(); Runtime runtime = Runtime.getRuntime(); Process process = runtime.exec(""ping "" + command); BufferedReader processOutputReader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = processOutputReader.readLine()) != null) { System.out.println(line); } } }",java,1
Insecure Deserialization,"import pickle
def load_user_data(filename):
    with open(filename, 'rb') as f:
        data = pickle.load(f)
    return data","import pickle
def load_user_data(filename):
    with open(filename, 'rb') as f:
        data = pickle.load(f)
    return data",python,1
Clear,"#include <stdio.h>
#include <stdlib.h>

void safe_file_operation(const char *filename) {
    FILE *file = fopen(filename, ""r"");
    if (file != NULL) {
        char buffer[256];
        while (fgets(buffer, sizeof(buffer), file)) {
            printf(""%s"", buffer);
        }
        fclose(file);
    }
}","#include <stdio.h>
#include <stdlib.h>

void safe_file_operation(const char *filename) {
    FILE *file = fopen(filename, ""r"");
    if (file != NULL) {
        char buffer[256];
        while (fgets(buffer, sizeof(buffer), file)) {
            printf(""%s"", buffer);
        }
        fclose(file);
    }
}",c,0
Clear,"Scanner scanner = new Scanner(System.in);
scanner.useDelimiter(""\\r\\n""); // Limit input to one line

System.out.print(""Enter a string (max 10 characters): "");
String userInput = scanner.next();","Scanner scanner = new Scanner(System.in); scanner.useDelimiter(""\\r\\n""); // Limit input to one line System.out.print(""Enter a string (max 10 characters): ""); String userInput = scanner.next();",python,0
XSS,"const userInput = document.location.search.split('=')[1];
document.write(userInput); // XSS
","const userInput = document.location.search.split('=')[1];
document.write(userInput); // XSS
",javascript,1
SQL Injection,"import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Statement;

public class SQLInjectionVulnerableExample {

    public static void main(String[] args) {
        String userInput = ""'; DROP TABLE users; --""; // User input containing SQL injection payload

        String url = ""jdbc:mysql://localhost:3306/mydatabase"";
        String username = ""root"";
        String password = ""password"";

        try {
            Connection connection = DriverManager.getConnection(url, username, password);
            Statement statement = connection.createStatement();

            // Vulnerable query construction without proper input sanitization
            String query = ""SELECT * FROM users WHERE username='"" + userInput + ""'"";

            ResultSet resultSet = statement.executeQuery(query);

            while (resultSet.next()) {
                System.out.println(""User found: "" + resultSet.getString(""username""));
            }

            resultSet.close();
            statement.close();
            connection.close();

        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.Connection; import java.sql.DriverManager; import java.sql.ResultSet; import java.sql.SQLException; import java.sql.Statement; public class SQLInjectionVulnerableExample { public static void main(String[] args) { String userInput = ""'; DROP TABLE users; --""; // User input containing SQL injection payload String url = ""jdbc:mysql://localhost:3306/mydatabase""; String username = ""root""; String password = ""password""; try { Connection connection = DriverManager.getConnection(url, username, password); Statement statement = connection.createStatement(); // Vulnerable query construction without proper input sanitization String query = ""SELECT * FROM users WHERE username='"" + userInput + ""'""; ResultSet resultSet = statement.executeQuery(query); while (resultSet.next()) { System.out.println(""User found: "" + resultSet.getString(""username"")); } resultSet.close(); statement.close(); connection.close(); } catch (SQLException e) { e.printStackTrace(); } } }",java,1
Clear,"To fix the SQL Injection vulnerability in the provided Java code, you should use prepared statements instead of concatenating user inputs directly into the query string. Prepared statements separate SQL code from user input, preventing malicious SQL injection attacks.

Here's the updated version of the code with proper security measures implemented:

```java
import java.sql.*;

public class SQLInjectionSecure {

    public static void main(String[] args) {
        try {
            String username = args[0]; // User input for username
            String password = args[1]; // User input for password

            // Connect to the database
            Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");

            // Use a prepared statement to prevent SQL injection
            String query = ""SELECT * FROM users WHERE username=? AND password=?"";
            PreparedStatement pstmt = conn.prepareStatement(query);
            pstmt.setString(1, username);
            pstmt.setString(2, password);

            ResultSet rs = pstmt.executeQuery();

            if (rs.next()) {
                System.out.println(""Login successful"");
            } else {
                System.out.println(""Login failed"");
            }

            conn.close();
        } catch (Exception e) {
            e.printStackTrace();
        }
    }
}
``","To fix the SQL Injection vulnerability in the provided Java code, you should use prepared statements instead of concatenating user inputs directly into the query string. Prepared statements separate SQL code from user input, preventing malicious SQL injection attacks. Here's the updated version of the code with proper security measures implemented: ```java import java.sql.*; public class SQLInjectionSecure { public static void main(String[] args) { try { String username = args[0]; // User input for username String password = args[1]; // User input for password // Connect to the database Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); // Use a prepared statement to prevent SQL injection String query = ""SELECT * FROM users WHERE username=? AND password=?""; PreparedStatement pstmt = conn.prepareStatement(query); pstmt.setString(1, username); pstmt.setString(2, password); ResultSet rs = pstmt.executeQuery(); if (rs.next()) { System.out.println(""Login successful""); } else { System.out.println(""Login failed""); } conn.close(); } catch (Exception e) { e.printStackTrace(); } } } ``",java,0
Clear,"To fix the Command Injection vulnerability in the given code snippet, you should avoid directly using user input to construct and execute commands. Instead, you should validate and sanitize user input to prevent any malicious commands from being executed.

Here is an improved version of the code snippet that implements proper security measures using ProcessBuilder to execute commands safely:

```java
import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class CommandInjectionExample {

    public static void main(String[] args) {
        try {
            BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));
            System.out.print(""Enter a file name to display its contents: "");
            String fileName = reader.readLine();

            // Validate and sanitize user input before constructing the command
            if (!fileName.matches(""[a-zA-Z0-9_\\-\\.]+"")) {
                System.err.println(""Invalid file name"");
                return;
            }

            // Use ProcessBuilder to execute the command safely
            ProcessBuilder builder = new ProcessBuilder(""cat"", fileName);
            Process process = builder.start();

            BufferedReader inputReader = new BufferedReader(new InputStreamReader(process.getInputStream()));
            String line;

            while ((line = inputReader.readLine()) != null) {
                System.out.println(line);
            }

        }","To fix the Command Injection vulnerability in the given code snippet, you should avoid directly using user input to construct and execute commands. Instead, you should validate and sanitize user input to prevent any malicious commands from being executed. Here is an improved version of the code snippet that implements proper security measures using ProcessBuilder to execute commands safely: ```java import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class CommandInjectionExample { public static void main(String[] args) { try { BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a file name to display its contents: ""); String fileName = reader.readLine(); // Validate and sanitize user input before constructing the command if (!fileName.matches(""[a-zA-Z0-9_\\-\\.]+"")) { System.err.println(""Invalid file name""); return; } // Use ProcessBuilder to execute the command safely ProcessBuilder builder = new ProcessBuilder(""cat"", fileName); Process process = builder.start(); BufferedReader inputReader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = inputReader.readLine()) != null) { System.out.println(line); } }",java,0
Clear,"import java.io.*;

public class CommandInjectionSecure {
    public static void main(String[] args) {
        try {
            BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));
            System.out.print(""Enter a command to execute: "");
            String[] command = {""/bin/sh"", ""-c"", reader.readLine()};

            ProcessBuilder processBuilder = new ProcessBuilder(command);
            Process process = processBuilder.start();

            BufferedReader inputReader = new BufferedReader(new InputStreamReader(process.getInputStream()));

            String line;
            while ((line = inputReader.readLine()) != null) {
                System.out.println(line);
            }

        } catch (IOException e) {
            System.out.println(""An error occurred: "" + e.getMessage());
        }
    }
}","import java.io.*; public class CommandInjectionSecure { public static void main(String[] args) { try { BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a command to execute: ""); String[] command = {""/bin/sh"", ""-c"", reader.readLine()}; ProcessBuilder processBuilder = new ProcessBuilder(command); Process process = processBuilder.start(); BufferedReader inputReader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = inputReader.readLine()) != null) { System.out.println(line); } } catch (IOException e) { System.out.println(""An error occurred: "" + e.getMessage()); } } }",java,0
Command Injection,"<?php
$cmd = $_GET['cmd'];
system($cmd); // Command Injection
?>","<?php
$cmd = $_GET['cmd'];
system($cmd); // Command Injection
?>",php,1
Clear,"import os
def safe_read_file(filename):
    base_path = '/var/www/uploads/'
    full_path = os.path.join(base_path, filename)
    full_path = os.path.normpath(full_path)
    if not full_path.startswith(base_path):
        raise ValueError(""Path traversal detected"")
    with open(full_path, 'r') as f:
        return f.read()","import os
def safe_read_file(filename):
    base_path = '/var/www/uploads/'
    full_path = os.path.join(base_path, filename)
    full_path = os.path.normpath(full_path)
    if not full_path.startswith(base_path):
        raise ValueError(""Path traversal detected"")
    with open(full_path, 'r') as f:
        return f.read()",python,0
Clear,"#include <iostream>
#include <sstream>

int safe_string_to_int(const std::string& str) {
    std::stringstream ss(str);
    int value;
    if (ss >> value) {
        return value;
    }
    throw std::invalid_argument(""Invalid integer"");
}","#include <iostream>
#include <sstream>

int safe_string_to_int(const std::string& str) {
    std::stringstream ss(str);
    int value;
    if (ss >> value) {
        return value;
    }
    throw std::invalid_argument(""Invalid integer"");
}",cpp,0
Clear,"import java.sql.*;

public class SecureSQLQuery {

    public static void main(String[] args) {
        try {
            String userInput = ""'; DROP TABLE users; --""; // User input with malicious SQL injection payload

            Connection connection = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");

            String query = ""SELECT * FROM users WHERE username = ?"";
            PreparedStatement statement = connection.prepareStatement(query);
            statement.setString(1, userInput);

            ResultSet resultSet = statement.executeQuery();

            while (resultSet.next()) {
                System.out.println(""User found: "" + resultSet.getString(""username""));
            }

            connection.close();
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.*; public class SecureSQLQuery { public static void main(String[] args) { try { String userInput = ""'; DROP TABLE users; --""; // User input with malicious SQL injection payload Connection connection = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); String query = ""SELECT * FROM users WHERE username = ?""; PreparedStatement statement = connection.prepareStatement(query); statement.setString(1, userInput); ResultSet resultSet = statement.executeQuery(); while (resultSet.next()) { System.out.println(""User found: "" + resultSet.getString(""username"")); } connection.close(); } catch (SQLException e) { e.printStackTrace(); } } }",java,0
Clear,"import java.io.*;
import java.util.*;

public class CommandInjectionSecure {

    public static void main(String[] args) {
        try {
            Scanner scanner = new Scanner(System.in);
            System.out.print(""Enter a file name: "");
            String fileName = scanner.nextLine();

            // Construct the command using ProcessBuilder
            List<String> command = new ArrayList<>();
            command.add(""ls"");
            command.add(fileName);

            ProcessBuilder processBuilder = new ProcessBuilder(command);
            
            // Redirect output to Java process
            processBuilder.redirectErrorStream(true);
            
            Process process = processBuilder.start();

            BufferedReader reader = new BufferedReader(new InputStreamReader(process.getInputStream()));
            String line;
            while ((line = reader.readLine()) != null) {
                System.out.println(line);
            }
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}","import java.io.*; import java.util.*; public class CommandInjectionSecure { public static void main(String[] args) { try { Scanner scanner = new Scanner(System.in); System.out.print(""Enter a file name: ""); String fileName = scanner.nextLine(); // Construct the command using ProcessBuilder List<String> command = new ArrayList<>(); command.add(""ls""); command.add(fileName); ProcessBuilder processBuilder = new ProcessBuilder(command); // Redirect output to Java process processBuilder.redirectErrorStream(true); Process process = processBuilder.start(); BufferedReader reader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = reader.readLine()) != null) { System.out.println(line); } } catch (IOException e) { e.printStackTrace(); } } }",java,0
SQL Injection,"import sqlite3
def get_user_data(username):
    conn = sqlite3.connect('database.db')
    cursor = conn.cursor()
    query = ""SELECT * FROM users WHERE username = '"" + username + ""'""
    cursor.execute(query)
    return cursor.fetchall()","import sqlite3
def get_user_data(username):
    conn = sqlite3.connect('database.db')
    cursor = conn.cursor()
    query = ""SELECT * FROM users WHERE username = '"" + username + ""'""
    cursor.execute(query)
    return cursor.fetchall()",python,1
Clear,"To fix the Command Injection vulnerability in the provided Java code snippet, you should avoid directly concatenating user input into the command to be executed by `Runtime.exec()`. Instead, you should use `ProcessBuilder` and provide a list of arguments to execute the command securely.

Here is an updated version of the code that addresses this vulnerability:

```java
import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;
import java.util.ArrayList;
import java.util.List;

public class SecureCommandExecution {

    public static void main(String[] args) {
        try {
            BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));
            System.out.print(""Enter a directory to list files: "");
            String directory = reader.readLine();

            // Secure code - using ProcessBuilder with a list of arguments
            List<String> command = new ArrayList<>();
            command.add(""ls"");
            command.add(directory);

            ProcessBuilder processBuilder = new ProcessBuilder(command);
            Process process = processBuilder.start();

            BufferedReader processOutputReader = new BufferedReader(new InputStreamReader(process.getInputStream()));
            String line;
            while ((line = processOutputReader.readLine()) != null) {
                System.out.println(line);
            }

        } catch (IOException e) {
            e.printStackTrace();","To fix the Command Injection vulnerability in the provided Java code snippet, you should avoid directly concatenating user input into the command to be executed by `Runtime.exec()`. Instead, you should use `ProcessBuilder` and provide a list of arguments to execute the command securely. Here is an updated version of the code that addresses this vulnerability: ```java import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; import java.util.ArrayList; import java.util.List; public class SecureCommandExecution { public static void main(String[] args) { try { BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a directory to list files: ""); String directory = reader.readLine(); // Secure code - using ProcessBuilder with a list of arguments List<String> command = new ArrayList<>(); command.add(""ls""); command.add(directory); ProcessBuilder processBuilder = new ProcessBuilder(command); Process process = processBuilder.start(); BufferedReader processOutputReader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = processOutputReader.readLine()) != null) { System.out.println(line); } } catch (IOException e) { e.printStackTrace();",java,0
Clear,"import java.sql.*;

public class SQLInjectionSecure {

    public static void main(String[] args) {
        String userInput = ""'; DROP TABLE users; --"";

        try {
            Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");
            
            // Use PreparedStatement to create a parameterized query
            String query = ""SELECT * FROM users WHERE username = ?"";
            PreparedStatement pstmt = conn.prepareStatement(query);
            pstmt.setString(1, userInput);
            
            ResultSet rs = pstmt.executeQuery();

            while (rs.next()) {
                System.out.println(""User found: "" + rs.getString(""username""));
            }

            conn.close();
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.*; public class SQLInjectionSecure { public static void main(String[] args) { String userInput = ""'; DROP TABLE users; --""; try { Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); // Use PreparedStatement to create a parameterized query String query = ""SELECT * FROM users WHERE username = ?""; PreparedStatement pstmt = conn.prepareStatement(query); pstmt.setString(1, userInput); ResultSet rs = pstmt.executeQuery(); while (rs.next()) { System.out.println(""User found: "" + rs.getString(""username"")); } conn.close(); } catch (SQLException e) { e.printStackTrace(); } } }",java,0
Command Injection,"import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class CommandInjectionExample {

    public static void main(String[] args) throws IOException {
        BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));
        
        System.out.print(""Enter a command to execute: "");
        String userInput = reader.readLine();
        
        // Vulnerable code - directly executing user input as a command
        Process process = Runtime.getRuntime().exec(""ping "" + userInput);
        
        BufferedReader inputReader = new BufferedReader(new InputStreamReader(process.getInputStream()));
        String line;
        
        while ((line = inputReader.readLine()) != null) {
            System.out.println(line);
        }
    }
}","import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class CommandInjectionExample { public static void main(String[] args) throws IOException { BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a command to execute: ""); String userInput = reader.readLine(); // Vulnerable code - directly executing user input as a command Process process = Runtime.getRuntime().exec(""ping "" + userInput); BufferedReader inputReader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = inputReader.readLine()) != null) { System.out.println(line); } } }",java,1
Buffer Overflow,"#include <iostream>
#include <cstdio>

void unsafe_c_input() {
    char buffer[50];
    scanf(""%s"", buffer); // no length limit
    std::cout << buffer << std::endl;
}","#include <iostream>
#include <cstdio>

void unsafe_c_input() {
    char buffer[50];
    scanf(""%s"", buffer); // no length limit
    std::cout << buffer << std::endl;
}",cpp,1
Cross-Site Scripting (XSS),"from flask import Flask, request
app = Flask(__name__)

@app.route('/search')
def search():
    query = request.args.get('q', '')
    return f'<h1>Search results for: {query}</h1>'","from flask import Flask, request
app = Flask(__name__)

@app.route('/search')
def search():
    query = request.args.get('q', '')
    return f'<h1>Search results for: {query}</h1>'",python,1
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Clear,"const token = process.env.API_TOKEN; // Environment variable
fetch('/api/data', {
    headers: { 'Authorization': `Bearer ${token}` }
});
","const token = process.env.API_TOKEN; // Environment variable
fetch('/api/data', {
    headers: { 'Authorization': `Bearer ${token}` }
});
",javascript,0
Cross-Site Scripting (XSS),"import java.io.*;
import javax.servlet.*;
import javax.servlet.http.*;

public class XSSVulnerableServlet extends HttpServlet {
    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        String userInput = request.getParameter(""input"");
        String output = ""<p>User input: "" + userInput + ""</p>"";

        response.setContentType(""text/html"");
        PrintWriter out = response.getWriter();
        out.println(output);
    }
}","import java.io.*; import javax.servlet.*; import javax.servlet.http.*; public class XSSVulnerableServlet extends HttpServlet { protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { String userInput = request.getParameter(""input""); String output = ""<p>User input: "" + userInput + ""</p>""; response.setContentType(""text/html""); PrintWriter out = response.getWriter(); out.println(output); } }",java,1
Clear,"#include <stdio.h>
#include <string.h>

int validate_input(const char *input) {
    if (input == NULL) return 0;
    for (int i = 0; input[i] != '\0'; i++) {
        if (input[i] < 32 || input[i] > 126) {
            return 0; // invalid character
        }
    }
    return 1;
}","#include <stdio.h>
#include <string.h>

int validate_input(const char *input) {
    if (input == NULL) return 0;
    for (int i = 0; input[i] != '\0'; i++) {
        if (input[i] < 32 || input[i] > 126) {
            return 0; // invalid character
        }
    }
    return 1;
}",c,0
Buffer Overflow,"#include <iostream>
#include <cstdio>

void unsafe_c_input() {
    char buffer[50];
    scanf(""%s"", buffer); // no length limit
    std::cout << buffer << std::endl;
}","#include <iostream>
#include <cstdio>

void unsafe_c_input() {
    char buffer[50];
    scanf(""%s"", buffer); // no length limit
    std::cout << buffer << std::endl;
}",cpp,1
Clear,"#include <iostream>
#include <string>
#include <vector>

void safe_string_handling(const std::string& input) {
    std::string safe_copy = input;
    std::cout << safe_copy << std::endl;
}","#include <iostream>
#include <string>
#include <vector>

void safe_string_handling(const std::string& input) {
    std::string safe_copy = input;
    std::cout << safe_copy << std::endl;
}",cpp,0
Clear,"<?php
$message = htmlspecialchars($_GET['message'], ENT_QUOTES, 'UTF-8');
echo $message; // Sanitized output
?>","<?php
$message = htmlspecialchars($_GET['message'], ENT_QUOTES, 'UTF-8');
echo $message; // Sanitized output
?>",php,0
Buffer Overflow,"#include <iostream>
#include <cstring>

void unsafe_c_string(char* input) {
    char buffer[100];
    strcpy(buffer, input); // potential buffer overflow
    std::cout << buffer << std::endl;
}","#include <iostream>
#include <cstring>

void unsafe_c_string(char* input) {
    char buffer[100];
    strcpy(buffer, input); // potential buffer overflow
    std::cout << buffer << std::endl;
}",cpp,1
Buffer Overflow,"import java.util.Scanner;

public class BufferOverflowExample {
    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        
        System.out.print(""Enter your name: "");
        String name = scanner.nextLine();
        
        char[] buffer = new char[10];
        
        for (int i = 0; i < name.length(); i++) {
            buffer[i] = name.charAt(i);
        }
        
        System.out.println(""Hello, "" + String.valueOf(buffer));
    }
}","import java.util.Scanner; public class BufferOverflowExample { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter your name: ""); String name = scanner.nextLine(); char[] buffer = new char[10]; for (int i = 0; i < name.length(); i++) { buffer[i] = name.charAt(i); } System.out.println(""Hello, "" + String.valueOf(buffer)); } }",java,1
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Clear,"const shell = require('child_process');
const safeInput = userInput.replace(/[^a-zA-Z0-9.]/g, '');
shell.execFile('ping', [safeInput]); // Safe command execution
","const shell = require('child_process');
const safeInput = userInput.replace(/[^a-zA-Z0-9.]/g, '');
shell.execFile('ping', [safeInput]); // Safe command execution
",javascript,0
Buffer Overflow,"#include <iostream>
#include <cstring>

void unsafe_c_string(char* input) {
    char buffer[100];
    strcpy(buffer, input); // potential buffer overflow
    std::cout << buffer << std::endl;
}","#include <iostream>
#include <cstring>

void unsafe_c_string(char* input) {
    char buffer[100];
    strcpy(buffer, input); // potential buffer overflow
    std::cout << buffer << std::endl;
}",cpp,1
Command Injection,"import os
def ping_host(host):
    os.system(""ping -c 4 "" + host)","import os
def ping_host(host):
    os.system(""ping -c 4 "" + host)",python,1
Memory Corruption,"#include <iostream>

void unsafe_pointer_arithmetic(int* array, int size) {
    for (int i = 0; i <= size; i++) {
        std::cout << *(array + i) << std::endl; // potential out-of-bounds
    }
}","#include <iostream>

void unsafe_pointer_arithmetic(int* array, int size) {
    for (int i = 0; i <= size; i++) {
        std::cout << *(array + i) << std::endl; // potential out-of-bounds
    }
}",cpp,1
File Inclusion,"<?php
$file = $_GET['file'];
include($file); // File Inclusion
?>","<?php
$file = $_GET['file'];
include($file); // File Inclusion
?>",php,1
Buffer Overflow,"import java.util.Scanner;

public class BufferOverflowExample {
    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        
        System.out.print(""Enter a string: "");
        String input = scanner.next();
        
        char[] buffer = new char[10];
        
        for (int i = 0; i < input.length(); i++) {
            buffer[i] = input.charAt(i);
        }
        
        System.out.println(""Buffer content: "" + new String(buffer));
    }
}","import java.util.Scanner; public class BufferOverflowExample { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter a string: ""); String input = scanner.next(); char[] buffer = new char[10]; for (int i = 0; i < input.length(); i++) { buffer[i] = input.charAt(i); } System.out.println(""Buffer content: "" + new String(buffer)); } }",java,1
Insecure Deserialization,"import yaml
def load_config(config_str):
    return yaml.load(config_str, Loader=yaml.Loader)","import yaml
def load_config(config_str):
    return yaml.load(config_str, Loader=yaml.Loader)",python,1
Clear,"#include <iostream>
#include <vector>
#include <stdexcept>

int safe_vector_access(const std::vector<int>& vec, size_t index) {
    if (index >= vec.size()) {
        throw std::out_of_range(""Index out of range"");
    }
    return vec[index];
}","#include <iostream>
#include <vector>
#include <stdexcept>

int safe_vector_access(const std::vector<int>& vec, size_t index) {
    if (index >= vec.size()) {
        throw std::out_of_range(""Index out of range"");
    }
    return vec[index];
}",cpp,0
Memory Corruption,"#include <iostream>

void unsafe_pointer_arithmetic(int* array, int size) {
    for (int i = 0; i <= size; i++) {
        std::cout << *(array + i) << std::endl; // potential out-of-bounds
    }
}","#include <iostream>

void unsafe_pointer_arithmetic(int* array, int size) {
    for (int i = 0; i <= size; i++) {
        std::cout << *(array + i) << std::endl; // potential out-of-bounds
    }
}",cpp,1
Clear,"<?php
$message = htmlspecialchars($_GET['message'], ENT_QUOTES, 'UTF-8');
echo $message; // Sanitized output
?>","<?php
$message = htmlspecialchars($_GET['message'], ENT_QUOTES, 'UTF-8');
echo $message; // Sanitized output
?>",php,0
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Command Injection,"import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class CommandInjectionVulnerability {

    public static void main(String[] args) {
        try {
            BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));
            System.out.print(""Enter a command to execute: "");
            String userInput = reader.readLine();

            Process process = Runtime.getRuntime().exec(""ping "" + userInput);

            BufferedReader inputReader = new BufferedReader(new InputStreamReader(process.getInputStream()));
            String line;
            while ((line = inputReader.readLine()) != null) {
                System.out.println(line);
            }

        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}","import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class CommandInjectionVulnerability { public static void main(String[] args) { try { BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a command to execute: ""); String userInput = reader.readLine(); Process process = Runtime.getRuntime().exec(""ping "" + userInput); BufferedReader inputReader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = inputReader.readLine()) != null) { System.out.println(line); } } catch (IOException e) { e.printStackTrace(); } } }",java,1
Clear,"def safe_division(a, b):
    if b == 0:
        raise ValueError(""Division by zero"")
    return a / b","def safe_division(a, b):
    if b == 0:
        raise ValueError(""Division by zero"")
    return a / b",python,0
Clear,"const token = process.env.API_TOKEN; // Environment variable
fetch('/api/data', {
    headers: { 'Authorization': `Bearer ${token}` }
});
","const token = process.env.API_TOKEN; // Environment variable
fetch('/api/data', {
    headers: { 'Authorization': `Bearer ${token}` }
});
",javascript,0
Clear,"#include <stdio.h>
#include <stdlib.h>

int safe_string_to_int(const char *str) {
    char *endptr;
    long value = strtol(str, &endptr, 10);
    if (*endptr != '\0' || str == endptr) {
        return -1; // error
    }
    return (int)value;
}","#include <stdio.h>
#include <stdlib.h>

int safe_string_to_int(const char *str) {
    char *endptr;
    long value = strtol(str, &endptr, 10);
    if (*endptr != '\0' || str == endptr) {
        return -1; // error
    }
    return (int)value;
}",c,0
XSS,"<?php
echo $_GET['message']; // XSS
?>","<?php
echo $_GET['message']; // XSS
?>",php,1
Clear,"#include <stdio.h>
#include <stdlib.h>

void safe_file_operation(const char *filename) {
    FILE *file = fopen(filename, ""r"");
    if (file != NULL) {
        char buffer[256];
        while (fgets(buffer, sizeof(buffer), file)) {
            printf(""%s"", buffer);
        }
        fclose(file);
    }
}","#include <stdio.h>
#include <stdlib.h>

void safe_file_operation(const char *filename) {
    FILE *file = fopen(filename, ""r"");
    if (file != NULL) {
        char buffer[256];
        while (fgets(buffer, sizeof(buffer), file)) {
            printf(""%s"", buffer);
        }
        fclose(file);
    }
}",c,0
Cross-Site Scripting (XSS),"def display_comment(comment_text):
    return f""<div class='comment'>{comment_text}</div>"" ","def display_comment(comment_text):
    return f""<div class='comment'>{comment_text}</div>"" ",python,1
Command Injection,"import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class CommandInjectionVulnerable {

    public static void main(String[] args) {
        try {
            BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));
            System.out.print(""Enter a command to execute: "");
            String userInput = reader.readLine();

            // Vulnerable code - directly executing user input as a command
            Runtime runtime = Runtime.getRuntime();
            Process process = runtime.exec(""ping "" + userInput);

            BufferedReader outputReader = new BufferedReader(new InputStreamReader(process.getInputStream()));
            String line;
            while ((line = outputReader.readLine()) != null) {
                System.out.println(line);
            }

        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}","import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class CommandInjectionVulnerable { public static void main(String[] args) { try { BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a command to execute: ""); String userInput = reader.readLine(); // Vulnerable code - directly executing user input as a command Runtime runtime = Runtime.getRuntime(); Process process = runtime.exec(""ping "" + userInput); BufferedReader outputReader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = outputReader.readLine()) != null) { System.out.println(line); } } catch (IOException e) { e.printStackTrace(); } } }",java,1
Clear,"#include <stdio.h>
#include <string.h>

void safe_string_copy(char *dest, const char *src, size_t dest_size) {
    if (dest_size > 0) {
        strncpy(dest, src, dest_size - 1);
        dest[dest_size - 1] = '\0';
    }
}","#include <stdio.h>
#include <string.h>

void safe_string_copy(char *dest, const char *src, size_t dest_size) {
    if (dest_size > 0) {
        strncpy(dest, src, dest_size - 1);
        dest[dest_size - 1] = '\0';
    }
}",c,0
Buffer Overflow,"import java.util.Scanner;

public class BufferOverflowVulnerability {

    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);

        System.out.print(""Enter a string: "");
        String userInput = scanner.nextLine();

        char[] buffer = new char[10];
        userInput.getChars(0, userInput.length(), buffer, 0);

        System.out.println(""Buffer contents: "" + new String(buffer));
    }
}","import java.util.Scanner; public class BufferOverflowVulnerability { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter a string: ""); String userInput = scanner.nextLine(); char[] buffer = new char[10]; userInput.getChars(0, userInput.length(), buffer, 0); System.out.println(""Buffer contents: "" + new String(buffer)); } }",java,1
Command Injection,"import subprocess
def list_directory(path):
    result = subprocess.run(f""ls {path}"", shell=True, capture_output=True, text=True)
    return result.stdout","import subprocess
def list_directory(path):
    result = subprocess.run(f""ls {path}"", shell=True, capture_output=True, text=True)
    return result.stdout",python,1
Clear,"const shell = require('child_process');
const safeInput = userInput.replace(/[^a-zA-Z0-9.]/g, '');
shell.execFile('ping', [safeInput]); // Safe command execution
","const shell = require('child_process');
const safeInput = userInput.replace(/[^a-zA-Z0-9.]/g, '');
shell.execFile('ping', [safeInput]); // Safe command execution
",javascript,0
Buffer Overflow,"#include <iostream>
#include <cstdio>

void unsafe_c_input() {
    char buffer[50];
    scanf(""%s"", buffer); // no length limit
    std::cout << buffer << std::endl;
}","#include <iostream>
#include <cstdio>

void unsafe_c_input() {
    char buffer[50];
    scanf(""%s"", buffer); // no length limit
    std::cout << buffer << std::endl;
}",cpp,1
Memory Corruption,"#include <iostream>

void unsafe_virtual_call() {
    // Potential vtable corruption vulnerability
    class Base {
    public:
        virtual void func() { std::cout << ""Base"" << std::endl; }
    };
    
    class Derived : public Base {
    public:
        void func() override { std::cout << ""Derived"" << std::endl; }
    };
}","#include <iostream>

void unsafe_virtual_call() {
    // Potential vtable corruption vulnerability
    class Base {
    public:
        virtual void func() { std::cout << ""Base"" << std::endl; }
    };
    
    class Derived : public Base {
    public:
        void func() override { std::cout << ""Derived"" << std::endl; }
    };
}",cpp,1
Clear,"import subprocess
def safe_directory_listing(path):
    result = subprocess.run(['ls', path], capture_output=True, text=True)
    return result.stdout","import subprocess
def safe_directory_listing(path):
    result = subprocess.run(['ls', path], capture_output=True, text=True)
    return result.stdout",python,0
Clear,"import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class CommandInjectionFixed {
    public static void main(String[] args) {
        try {
            BufferedReader br = new BufferedReader(new InputStreamReader(System.in));
            System.out.print(""Enter a command to execute: "");
            String command = br.readLine();

            ProcessBuilder processBuilder = new ProcessBuilder(""ping"", command);
            Process p = processBuilder.start();
            
            BufferedReader reader = new BufferedReader(new InputStreamReader(p.getInputStream()));
            
            String line;
            while ((line = reader.readLine()) != null) {
                System.out.println(line);
            }
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}","import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class CommandInjectionFixed { public static void main(String[] args) { try { BufferedReader br = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a command to execute: ""); String command = br.readLine(); ProcessBuilder processBuilder = new ProcessBuilder(""ping"", command); Process p = processBuilder.start(); BufferedReader reader = new BufferedReader(new InputStreamReader(p.getInputStream())); String line; while ((line = reader.readLine()) != null) { System.out.println(line); } } catch (IOException e) { e.printStackTrace(); } } }",java,0
SSRF,"import urllib.request
def download_file(file_url):
    return urllib.request.urlopen(file_url).read()","import urllib.request
def download_file(file_url):
    return urllib.request.urlopen(file_url).read()",python,1
Clear,"This code snippet demonstrates a vulnerability related to insecure deserialization, which can lead to serious security issues such as remote code execution. To secure the deserialization process in Java, you can implement the following measures:

1. Use a Secure Deserialization Framework: Consider using a secure deserialization framework like Jackson, Gson, or Apache Avro, which provide built-in protections against deserialization vulnerabilities.

2. Implement Input Validation: Validate the input data before deserializing it to prevent malicious input from being processed. Check the data type and structure of the serialized object before deserializing it.

3. Use a Whitelist Approach: Maintain a whitelist of allowed classes that can be deserialized to restrict the types of objects that can be instantiated during deserialization.

4. Enable Security Manager: Utilize Java Security Manager to restrict the permissions granted during deserialization, limiting potential security risks associated with executing arbitrary code.

5. Implement Digital Signatures or Encryption: Digitally sign or encrypt serialized data to ensure its integrity and authenticity before deserializing it.

6. Perform Data Sanitization: Sanitize the input data by removing any unexpected or malicious content before passing it for deserialization.

Here is an example of how you can enhance the security of your code snippet by","This code snippet demonstrates a vulnerability related to insecure deserialization, which can lead to serious security issues such as remote code execution. To secure the deserialization process in Java, you can implement the following measures: 1. Use a Secure Deserialization Framework: Consider using a secure deserialization framework like Jackson, Gson, or Apache Avro, which provide built-in protections against deserialization vulnerabilities. 2. Implement Input Validation: Validate the input data before deserializing it to prevent malicious input from being processed. Check the data type and structure of the serialized object before deserializing it. 3. Use a Whitelist Approach: Maintain a whitelist of allowed classes that can be deserialized to restrict the types of objects that can be instantiated during deserialization. 4. Enable Security Manager: Utilize Java Security Manager to restrict the permissions granted during deserialization, limiting potential security risks associated with executing arbitrary code. 5. Implement Digital Signatures or Encryption: Digitally sign or encrypt serialized data to ensure its integrity and authenticity before deserializing it. 6. Perform Data Sanitization: Sanitize the input data by removing any unexpected or malicious content before passing it for deserialization. Here is an example of how you can enhance the security of your code snippet by",php,0
Clear,"To fix the Path Traversal vulnerability in the provided Java code snippet, you need to ensure that the user input is properly validated and sanitized before constructing the file path. Here's an improved version of the code with security measures in place:

```java
import java.io.File;
import java.io.IOException;
import java.nio.file.Files;
import java.util.Scanner;

public class SecurePathTraversal {

    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        System.out.print(""Enter file name: "");
        String fileName = scanner.nextLine();

        // Validate and sanitize user input to prevent directory traversal attacks
        if (!isValidFileName(fileName)) {
            System.out.println(""Invalid file name."");
            return;
        }

        String filePath = ""/path/to/files/"" + fileName; // Properly construct file path

        try {
            File file = new File(filePath);
            if (file.exists() && !file.isDirectory()) { // Ensure the requested file is a regular file
                byte[] fileData = Files.readAllBytes(file.toPath());
                String content = new String(fileData);
                System.out.println(""File content: "" + content);
            } else {
                System.out.println(""File not found or is a","To fix the Path Traversal vulnerability in the provided Java code snippet, you need to ensure that the user input is properly validated and sanitized before constructing the file path. Here's an improved version of the code with security measures in place: ```java import java.io.File; import java.io.IOException; import java.nio.file.Files; import java.util.Scanner; public class SecurePathTraversal { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter file name: ""); String fileName = scanner.nextLine(); // Validate and sanitize user input to prevent directory traversal attacks if (!isValidFileName(fileName)) { System.out.println(""Invalid file name.""); return; } String filePath = ""/path/to/files/"" + fileName; // Properly construct file path try { File file = new File(filePath); if (file.exists() && !file.isDirectory()) { // Ensure the requested file is a regular file byte[] fileData = Files.readAllBytes(file.toPath()); String content = new String(fileData); System.out.println(""File content: "" + content); } else { System.out.println(""File not found or is a",java,0
Buffer Overflow,"import java.util.Scanner;

public class BufferOverflowVulnerability {
    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        System.out.print(""Enter your name: "");
        
        String input = scanner.nextLine();
        char[] buffer = new char[10];
        
        // Copy user input into buffer without proper bounds checking
        for (int i = 0; i < input.length(); i++) {
            buffer[i] = input.charAt(i);
        }
        
        System.out.println(""Your name is: "" + new String(buffer));
    }
}","import java.util.Scanner; public class BufferOverflowVulnerability { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter your name: ""); String input = scanner.nextLine(); char[] buffer = new char[10]; // Copy user input into buffer without proper bounds checking for (int i = 0; i < input.length(); i++) { buffer[i] = input.charAt(i); } System.out.println(""Your name is: "" + new String(buffer)); } }",java,1
Clear,"<?php
$cmd = escapeshellarg($_GET['cmd']);
system(""ls "" . $cmd); // Escaped command
?>","<?php
$cmd = escapeshellarg($_GET['cmd']);
system(""ls "" . $cmd); // Escaped command
?>",php,0
Clear,"To fix the Path Traversal vulnerability in the provided Java code, we need to ensure that the input file name is properly sanitized and restricted to prevent access to files outside of the intended directory. One way to achieve this is by validating and sanitizing the input file name before constructing the File object.

Here's an updated version of the code with proper security measures:

```java
import java.io.File;
import java.io.FileInputStream;
import java.io.IOException;
import java.util.Scanner;

public class SecurePathTraversal {

    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);

        System.out.print(""Enter file name: "");
        String fileName = scanner.nextLine();

        // Validate and sanitize input file name
        if (!isValidFileName(fileName)) {
            System.err.println(""Invalid file name."");
            return;
        }

        File file = new File(""C:\\data\\"" + fileName); // Constructing path safely

        try (FileInputStream fis = new FileInputStream(file)) {
            int content;
            while ((content = fis.read()) != -1) {
                System.out.print((char) content);
            }
        } catch (IOException e) {
            System.err.println(""Error reading file: "" + e.getMessage());","To fix the Path Traversal vulnerability in the provided Java code, we need to ensure that the input file name is properly sanitized and restricted to prevent access to files outside of the intended directory. One way to achieve this is by validating and sanitizing the input file name before constructing the File object. Here's an updated version of the code with proper security measures: ```java import java.io.File; import java.io.FileInputStream; import java.io.IOException; import java.util.Scanner; public class SecurePathTraversal { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter file name: ""); String fileName = scanner.nextLine(); // Validate and sanitize input file name if (!isValidFileName(fileName)) { System.err.println(""Invalid file name.""); return; } File file = new File(""C:\\data\\"" + fileName); // Constructing path safely try (FileInputStream fis = new FileInputStream(file)) { int content; while ((content = fis.read()) != -1) { System.out.print((char) content); } } catch (IOException e) { System.err.println(""Error reading file: "" + e.getMessage());",java,0
Path Traversal,"import java.io.File;
import java.io.FileInputStream;
import java.io.IOException;
import java.util.Scanner;

public class PathTraversalVulnerabilityExample {

    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        System.out.print(""Enter file name: "");
        String fileName = scanner.nextLine();

        try {
            File file = new File(""C:\\files\\"" + fileName); // Vulnerable code
            FileInputStream fis = new FileInputStream(file);

            int content;
            while ((content = fis.read()) != -1) {
                System.out.print((char) content);
            }

            fis.close();
        } catch (IOException e) {
            System.out.println(""Error reading file: "" + e.getMessage());
        }
    }
}","import java.io.File; import java.io.FileInputStream; import java.io.IOException; import java.util.Scanner; public class PathTraversalVulnerabilityExample { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter file name: ""); String fileName = scanner.nextLine(); try { File file = new File(""C:\\files\\"" + fileName); // Vulnerable code FileInputStream fis = new FileInputStream(file); int content; while ((content = fis.read()) != -1) { System.out.print((char) content); } fis.close(); } catch (IOException e) { System.out.println(""Error reading file: "" + e.getMessage()); } } }",java,1
Cross-Site Scripting (XSS),"import java.io.IOException;
import javax.servlet.ServletException;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

public class VulnerableServlet extends HttpServlet {
    
    @Override
    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        String userInput = request.getParameter(""input"");
        String output = ""<p>User input: "" + userInput + ""</p>"";
        
        response.getWriter().write(output);
    }
}","import java.io.IOException; import javax.servlet.ServletException; import javax.servlet.http.HttpServlet; import javax.servlet.http.HttpServletRequest; import javax.servlet.http.HttpServletResponse; public class VulnerableServlet extends HttpServlet { @Override protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { String userInput = request.getParameter(""input""); String output = ""<p>User input: "" + userInput + ""</p>""; response.getWriter().write(output); } }",java,1
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Insecure Deserialization,"import pickle
def load_user_data(filename):
    with open(filename, 'rb') as f:
        data = pickle.load(f)
    return data","import pickle
def load_user_data(filename):
    with open(filename, 'rb') as f:
        data = pickle.load(f)
    return data",python,1
Clear,"<?php
$username = $_POST['username'];
$stmt = $pdo->prepare(""SELECT * FROM users WHERE username = ?"");
$stmt->execute([$username]); // Parameterized query
?>","<?php
$username = $_POST['username'];
$stmt = $pdo->prepare(""SELECT * FROM users WHERE username = ?"");
$stmt->execute([$username]); // Parameterized query
?>",php,0
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
SQL Injection,"import mysql.connector
def search_products(category):
    db = mysql.connector.connect(host=""localhost"", user=""user"", password=""pass"", database=""shop"")
    cursor = db.cursor()
    cursor.execute(""SELECT * FROM products WHERE category = '%s'"" % category)
    return cursor.fetchall()","import mysql.connector
def search_products(category):
    db = mysql.connector.connect(host=""localhost"", user=""user"", password=""pass"", database=""shop"")
    cursor = db.cursor()
    cursor.execute(""SELECT * FROM products WHERE category = '%s'"" % category)
    return cursor.fetchall()",python,1
Cross-Site Scripting (XSS),"import java.io.*;
import javax.servlet.*;
import javax.servlet.http.*;

public class XSSVulnerableServlet extends HttpServlet {

    protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        String userInput = request.getParameter(""input"");
        String responseMessage = ""Hello, "" + userInput + ""!"";

        // Improperly handling user input without proper sanitization
        PrintWriter out = response.getWriter();
        out.println(""<html><body>"");
        out.println(""<h1>"" + responseMessage + ""</h1>"");
        out.println(""</body></html>"");
    }
}","import java.io.*; import javax.servlet.*; import javax.servlet.http.*; public class XSSVulnerableServlet extends HttpServlet { protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { String userInput = request.getParameter(""input""); String responseMessage = ""Hello, "" + userInput + ""!""; // Improperly handling user input without proper sanitization PrintWriter out = response.getWriter(); out.println(""<html><body>""); out.println(""<h1>"" + responseMessage + ""</h1>""); out.println(""</body></html>""); } }",java,1
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Clear,"const userData = JSON.parse(userInput); // Safe JSON parsing
if (userData && typeof userData === 'object') {
    processUserData(userData);
}
","const userData = JSON.parse(userInput); // Safe JSON parsing
if (userData && typeof userData === 'object') {
    processUserData(userData);
}
",javascript,0
Clear,"import org.owasp.esapi.ESAPI;
import org.owasp.esapi.errors.EncodingException;

import java.io.IOException;
import java.io.PrintWriter;

public class SecureXSSDemo {

    public static void main(String[] args) throws IOException, EncodingException {
        String userInput = ""<script>alert('XSS Attack!')</script>"";

        // Properly handling user input by escaping potentially malicious characters
        String safeUserInput = ESAPI.encoder().encodeForHTML(userInput);

        PrintWriter out = new PrintWriter(""output.html"");
        out.println(""<html>"");
        out.println(""<body>"");
        out.println(""<p>User Input: "" + safeUserInput + ""</p>"");
        out.println(""</body>"");
        out.println(""</html>"");

        out.close();
    }
}","import org.owasp.esapi.ESAPI; import org.owasp.esapi.errors.EncodingException; import java.io.IOException; import java.io.PrintWriter; public class SecureXSSDemo { public static void main(String[] args) throws IOException, EncodingException { String userInput = ""<script>alert('XSS Attack!')</script>""; // Properly handling user input by escaping potentially malicious characters String safeUserInput = ESAPI.encoder().encodeForHTML(userInput); PrintWriter out = new PrintWriter(""output.html""); out.println(""<html>""); out.println(""<body>""); out.println(""<p>User Input: "" + safeUserInput + ""</p>""); out.println(""</body>""); out.println(""</html>""); out.close(); } }",java,0
Clear,"import hashlib
import os

def hash_password(password):
    salt = os.urandom(32)
    key = hashlib.pbkdf2_hmac('sha256', password.encode(), salt, 100000)
    return salt + key","import hashlib
import os

def hash_password(password):
    salt = os.urandom(32)
    key = hashlib.pbkdf2_hmac('sha256', password.encode(), salt, 100000)
    return salt + key",python,0
Clear,"const userData = JSON.parse(userInput); // Safe JSON parsing
if (userData && typeof userData === 'object') {
    processUserData(userData);
}
","const userData = JSON.parse(userInput); // Safe JSON parsing
if (userData && typeof userData === 'object') {
    processUserData(userData);
}
",javascript,0
Clear,"import os
def secure_file_access(username, filepath):
    base_dir = f""/home/{username}/files/""
    full_path = os.path.join(base_dir, filepath)
    full_path = os.path.normpath(full_path)
    if not full_path.startswith(base_dir):
        raise PermissionError(""Access denied"")
    with open(full_path, 'r') as f:
        return f.read()","import os
def secure_file_access(username, filepath):
    base_dir = f""/home/{username}/files/""
    full_path = os.path.join(base_dir, filepath)
    full_path = os.path.normpath(full_path)
    if not full_path.startswith(base_dir):
        raise PermissionError(""Access denied"")
    with open(full_path, 'r') as f:
        return f.read()",python,0
File Inclusion,"<?php
$file = $_GET['file'];
include($file); // File Inclusion
?>","<?php
$file = $_GET['file'];
include($file); // File Inclusion
?>",php,1
Clear,"def safe_comment_display(comment_text):
    import html
    escaped_text = html.escape(comment_text)
    return f""<div class='comment'>{escaped_text}</div>"" ","def safe_comment_display(comment_text):
    import html
    escaped_text = html.escape(comment_text)
    return f""<div class='comment'>{escaped_text}</div>"" ",python,0
Path Traversal,"import java.io.File;
import java.io.FileInputStream;
import java.io.IOException;
import java.util.Scanner;

public class PathTraversalVulnerability {

    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        System.out.println(""Enter file name to read: "");
        String fileName = scanner.nextLine();

        try {
            File file = new File(""C:\\data\\"" + fileName); // Vulnerability: User input directly used for file path
            FileInputStream fis = new FileInputStream(file);
            byte[] data = new byte[(int) file.length()];
            fis.read(data);
            fis.close();

            System.out.println(""File contents: "" + new String(data));

        } catch (IOException e) {
            System.out.println(""Error reading file: "" + e.getMessage());
        }
    }
}","import java.io.File; import java.io.FileInputStream; import java.io.IOException; import java.util.Scanner; public class PathTraversalVulnerability { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.println(""Enter file name to read: ""); String fileName = scanner.nextLine(); try { File file = new File(""C:\\data\\"" + fileName); // Vulnerability: User input directly used for file path FileInputStream fis = new FileInputStream(file); byte[] data = new byte[(int) file.length()]; fis.read(data); fis.close(); System.out.println(""File contents: "" + new String(data)); } catch (IOException e) { System.out.println(""Error reading file: "" + e.getMessage()); } } }",java,1
SSRF,"import urllib.request
def download_file(file_url):
    return urllib.request.urlopen(file_url).read()","import urllib.request
def download_file(file_url):
    return urllib.request.urlopen(file_url).read()",python,1
Clear,"#include <stdio.h>
#include <string.h>

void safe_string_copy(char *dest, const char *src, size_t dest_size) {
    if (dest_size > 0) {
        strncpy(dest, src, dest_size - 1);
        dest[dest_size - 1] = '\0';
    }
}","#include <stdio.h>
#include <string.h>

void safe_string_copy(char *dest, const char *src, size_t dest_size) {
    if (dest_size > 0) {
        strncpy(dest, src, dest_size - 1);
        dest[dest_size - 1] = '\0';
    }
}",c,0
Clear,"<?php
$cmd = escapeshellarg($_GET['cmd']);
system(""ls "" . $cmd); // Escaped command
?>","<?php
$cmd = escapeshellarg($_GET['cmd']);
system(""ls "" . $cmd); // Escaped command
?>",php,0
Clear,"const token = process.env.API_TOKEN; // Environment variable
fetch('/api/data', {
    headers: { 'Authorization': `Bearer ${token}` }
});
","const token = process.env.API_TOKEN; // Environment variable
fetch('/api/data', {
    headers: { 'Authorization': `Bearer ${token}` }
});
",javascript,0
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Clear,"const userData = JSON.parse(userInput); // Safe JSON parsing
if (userData && typeof userData === 'object') {
    processUserData(userData);
}
","const userData = JSON.parse(userInput); // Safe JSON parsing
if (userData && typeof userData === 'object') {
    processUserData(userData);
}
",javascript,0
SQL Injection,"import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Statement;
import java.util.Scanner;

public class SQLInjectionVulnerability {

    public static void main(String[] args) {
        try {
            Scanner scanner = new Scanner(System.in);
            System.out.print(""Enter username: "");
            String username = scanner.nextLine();

            // Vulnerable code: Concatenating user input directly into SQL query
            String query = ""SELECT * FROM users WHERE username = '"" + username + ""'"";

            Connection connection = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");
            Statement statement = connection.createStatement();
            ResultSet resultSet = statement.executeQuery(query);

            while (resultSet.next()) {
                System.out.println(""User ID: "" + resultSet.getInt(""id"") + "", Username: "" + resultSet.getString(""username""));
            }

            resultSet.close();
            statement.close();
            connection.close();
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.Connection; import java.sql.DriverManager; import java.sql.ResultSet; import java.sql.SQLException; import java.sql.Statement; import java.util.Scanner; public class SQLInjectionVulnerability { public static void main(String[] args) { try { Scanner scanner = new Scanner(System.in); System.out.print(""Enter username: ""); String username = scanner.nextLine(); // Vulnerable code: Concatenating user input directly into SQL query String query = ""SELECT * FROM users WHERE username = '"" + username + ""'""; Connection connection = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); Statement statement = connection.createStatement(); ResultSet resultSet = statement.executeQuery(query); while (resultSet.next()) { System.out.println(""User ID: "" + resultSet.getInt(""id"") + "", Username: "" + resultSet.getString(""username"")); } resultSet.close(); statement.close(); connection.close(); } catch (SQLException e) { e.printStackTrace(); } } }",java,1
XSS,"const userInput = document.location.search.split('=')[1];
document.write(userInput); // XSS
","const userInput = document.location.search.split('=')[1];
document.write(userInput); // XSS
",javascript,1
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Clear,"#include <iostream>
#include <vector>
#include <stdexcept>

int safe_vector_access(const std::vector<int>& vec, size_t index) {
    if (index >= vec.size()) {
        throw std::out_of_range(""Index out of range"");
    }
    return vec[index];
}","#include <iostream>
#include <vector>
#include <stdexcept>

int safe_vector_access(const std::vector<int>& vec, size_t index) {
    if (index >= vec.size()) {
        throw std::out_of_range(""Index out of range"");
    }
    return vec[index];
}",cpp,0
SSRF,"import urllib.request
def download_file(file_url):
    return urllib.request.urlopen(file_url).read()","import urllib.request
def download_file(file_url):
    return urllib.request.urlopen(file_url).read()",python,1
Clear,"#include <iostream>
#include <vector>
#include <stdexcept>

int safe_vector_access(const std::vector<int>& vec, size_t index) {
    if (index >= vec.size()) {
        throw std::out_of_range(""Index out of range"");
    }
    return vec[index];
}","#include <iostream>
#include <vector>
#include <stdexcept>

int safe_vector_access(const std::vector<int>& vec, size_t index) {
    if (index >= vec.size()) {
        throw std::out_of_range(""Index out of range"");
    }
    return vec[index];
}",cpp,0
SQL Injection,"import psycopg2
def admin_login(admin_id):
    conn = psycopg2.connect(""dbname=test user=postgres"")
    cur = conn.cursor()
    cur.execute(f""SELECT * FROM admins WHERE id = {admin_id}"")
    return cur.fetchone()","import psycopg2
def admin_login(admin_id):
    conn = psycopg2.connect(""dbname=test user=postgres"")
    cur = conn.cursor()
    cur.execute(f""SELECT * FROM admins WHERE id = {admin_id}"")
    return cur.fetchone()",python,1
Clear,"import sqlite3
def get_user_data_safe(username):
    conn = sqlite3.connect('database.db')
    cursor = conn.cursor()
    query = ""SELECT * FROM users WHERE username = ?""
    cursor.execute(query, (username,))
    return cursor.fetchall()","import sqlite3
def get_user_data_safe(username):
    conn = sqlite3.connect('database.db')
    cursor = conn.cursor()
    query = ""SELECT * FROM users WHERE username = ?""
    cursor.execute(query, (username,))
    return cursor.fetchall()",python,0
Clear,"<?php
$cmd = escapeshellarg($_GET['cmd']);
system(""ls "" . $cmd); // Escaped command
?>","<?php
$cmd = escapeshellarg($_GET['cmd']);
system(""ls "" . $cmd); // Escaped command
?>",php,0
XSS,"const userInput = document.location.search.split('=')[1];
document.write(userInput); // XSS
","const userInput = document.location.search.split('=')[1];
document.write(userInput); // XSS
",javascript,1
XSS,"<?php
echo $_GET['message']; // XSS
?>","<?php
echo $_GET['message']; // XSS
?>",php,1
Clear,"import subprocess
def safe_directory_listing(path):
    result = subprocess.run(['ls', path], capture_output=True, text=True)
    return result.stdout","import subprocess
def safe_directory_listing(path):
    result = subprocess.run(['ls', path], capture_output=True, text=True)
    return result.stdout",python,0
Command Injection,"import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class CommandInjectionExample {

    public static void main(String[] args) {
        try {
            BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));
            
            System.out.print(""Enter a command to run: "");
            String userInput = reader.readLine();
            
            // Vulnerable code - user input is directly passed to the command execution
            Process process = Runtime.getRuntime().exec(""ping "" + userInput);
            
            BufferedReader inputReader = new BufferedReader(new InputStreamReader(process.getInputStream()));
            String line;
            while ((line = inputReader.readLine()) != null) {
                System.out.println(line);
            }
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}","import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class CommandInjectionExample { public static void main(String[] args) { try { BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a command to run: ""); String userInput = reader.readLine(); // Vulnerable code - user input is directly passed to the command execution Process process = Runtime.getRuntime().exec(""ping "" + userInput); BufferedReader inputReader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = inputReader.readLine()) != null) { System.out.println(line); } } catch (IOException e) { e.printStackTrace(); } } }",java,1
Memory Corruption,"#include <iostream>

void unsafe_virtual_call() {
    // Potential vtable corruption vulnerability
    class Base {
    public:
        virtual void func() { std::cout << ""Base"" << std::endl; }
    };
    
    class Derived : public Base {
    public:
        void func() override { std::cout << ""Derived"" << std::endl; }
    };
}","#include <iostream>

void unsafe_virtual_call() {
    // Potential vtable corruption vulnerability
    class Base {
    public:
        virtual void func() { std::cout << ""Base"" << std::endl; }
    };
    
    class Derived : public Base {
    public:
        void func() override { std::cout << ""Derived"" << std::endl; }
    };
}",cpp,1
Command Injection,"<?php
$cmd = $_GET['cmd'];
system($cmd); // Command Injection
?>","<?php
$cmd = $_GET['cmd'];
system($cmd); // Command Injection
?>",php,1
Clear,import org.owasp.encoder.Encode;,import org.owasp.encoder.Encode;,python,0
Clear,"To fix the Path Traversal vulnerability in the provided Java code snippet, you can implement the following security measures:

1. Validate User Input: Ensure that the input file name provided by the user does not contain any directory traversal characters (e.g., ""../"") that could allow an attacker to access files outside the intended directory.

2. Use a Whitelist Approach: Instead of validating input based on disallowed characters, use a whitelist approach to specify the allowed characters or patterns for file names. This can help prevent path traversal attacks.

3. Use Absolute Paths: Avoid constructing file paths based on user input directly. Instead, use absolute paths or predefined root directories to ensure that files are accessed from a known location.

4. Check File Existence: Before attempting to read the file, verify that the file exists in the specified location to prevent errors or unintended behavior.

Here's an updated version of the code with these security measures implemented:

```java
import java.io.File;
import java.io.FileInputStream;
import java.io.IOException;
import java.util.Scanner;

public class SecurePathTraversal {

    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        System.out.println(""Enter the file name:"");
        String fileName = scanner.next();","To fix the Path Traversal vulnerability in the provided Java code snippet, you can implement the following security measures: 1. Validate User Input: Ensure that the input file name provided by the user does not contain any directory traversal characters (e.g., ""../"") that could allow an attacker to access files outside the intended directory. 2. Use a Whitelist Approach: Instead of validating input based on disallowed characters, use a whitelist approach to specify the allowed characters or patterns for file names. This can help prevent path traversal attacks. 3. Use Absolute Paths: Avoid constructing file paths based on user input directly. Instead, use absolute paths or predefined root directories to ensure that files are accessed from a known location. 4. Check File Existence: Before attempting to read the file, verify that the file exists in the specified location to prevent errors or unintended behavior. Here's an updated version of the code with these security measures implemented: ```java import java.io.File; import java.io.FileInputStream; import java.io.IOException; import java.util.Scanner; public class SecurePathTraversal { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.println(""Enter the file name:""); String fileName = scanner.next();",java,0
Clear,"import java.sql.*;

public class UserAuthentication {
    public boolean authenticateUser(String username, String password) {
        String query = ""SELECT * FROM users WHERE username=? AND password=?"";
        
        try (Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");
             PreparedStatement stmt = conn.prepareStatement(query)) {
            stmt.setString(1, username);
            stmt.setString(2, password);
            
            try (ResultSet rs = stmt.executeQuery()) {
                if (rs.next()) {
                    return true; // Authentication successful
                }
            }
        } catch (SQLException e) {
            e.printStackTrace();
        }
        
        return false; // Authentication failed
    }
}","import java.sql.*; public class UserAuthentication { public boolean authenticateUser(String username, String password) { String query = ""SELECT * FROM users WHERE username=? AND password=?""; try (Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); PreparedStatement stmt = conn.prepareStatement(query)) { stmt.setString(1, username); stmt.setString(2, password); try (ResultSet rs = stmt.executeQuery()) { if (rs.next()) { return true; // Authentication successful } } } catch (SQLException e) { e.printStackTrace(); } return false; // Authentication failed } }",java,0
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Clear,"<?php
$username = $_POST['username'];
$stmt = $pdo->prepare(""SELECT * FROM users WHERE username = ?"");
$stmt->execute([$username]); // Parameterized query
?>","<?php
$username = $_POST['username'];
$stmt = $pdo->prepare(""SELECT * FROM users WHERE username = ?"");
$stmt->execute([$username]); // Parameterized query
?>",php,0
Clear,"const userInput = new URLSearchParams(window.location.search).get('input');
const safeOutput = document.createElement('div');
safeOutput.textContent = userInput; // Safe DOM manipulation
document.body.appendChild(safeOutput);
","const userInput = new URLSearchParams(window.location.search).get('input');
const safeOutput = document.createElement('div');
safeOutput.textContent = userInput; // Safe DOM manipulation
document.body.appendChild(safeOutput);
",javascript,0
Clear,"#include <stdio.h>
#include <string.h>

int safe_buffer_operation(char *input) {
    char buffer[100];
    if (strlen(input) < sizeof(buffer)) {
        strcpy(buffer, input);
        return 0;
    }
    return -1; // buffer too small
}","#include <stdio.h>
#include <string.h>

int safe_buffer_operation(char *input) {
    char buffer[100];
    if (strlen(input) < sizeof(buffer)) {
        strcpy(buffer, input);
        return 0;
    }
    return -1; // buffer too small
}",c,0
SQL Injection,"import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Statement;

public class SQLInjectionExample {

    public static void main(String[] args) {
        String userInput = ""1'; DROP TABLE users; --"";

        try {
            Connection connection = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");
            Statement statement = connection.createStatement();
            
            String query = ""SELECT * FROM users WHERE id = '"" + userInput + ""'"";
            ResultSet resultSet = statement.executeQuery(query);
            
            while (resultSet.next()) {
                System.out.println(""User: "" + resultSet.getString(""username""));
            }

            resultSet.close();
            statement.close();
            connection.close();

        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.Connection; import java.sql.DriverManager; import java.sql.ResultSet; import java.sql.SQLException; import java.sql.Statement; public class SQLInjectionExample { public static void main(String[] args) { String userInput = ""1'; DROP TABLE users; --""; try { Connection connection = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); Statement statement = connection.createStatement(); String query = ""SELECT * FROM users WHERE id = '"" + userInput + ""'""; ResultSet resultSet = statement.executeQuery(query); while (resultSet.next()) { System.out.println(""User: "" + resultSet.getString(""username"")); } resultSet.close(); statement.close(); connection.close(); } catch (SQLException e) { e.printStackTrace(); } } }",java,1
Clear,"from flask import Flask, request
import html
app = Flask(__name__)

@app.route('/search_safe')
def search_safe():
    query = request.args.get('q', '')
    safe_query = html.escape(query)
    return f'<h1>Search results for: {safe_query}</h1>'","from flask import Flask, request
import html
app = Flask(__name__)

@app.route('/search_safe')
def search_safe():
    query = request.args.get('q', '')
    safe_query = html.escape(query)
    return f'<h1>Search results for: {safe_query}</h1>'",python,0
Code Injection,"const userData = eval('(' + userInput + ')'); // eval injection
","const userData = eval('(' + userInput + ')'); // eval injection
",javascript,1
Clear,"#include <iostream>
#include <fstream>
#include <string>

void safe_file_reading(const std::string& filename) {
    std::ifstream file(filename);
    if (file.is_open()) {
        std::string line;
        while (std::getline(file, line)) {
            std::cout << line << std::endl;
        }
    }
}","#include <iostream>
#include <fstream>
#include <string>

void safe_file_reading(const std::string& filename) {
    std::ifstream file(filename);
    if (file.is_open()) {
        std::string line;
        while (std::getline(file, line)) {
            std::cout << line << std::endl;
        }
    }
}",cpp,0
Clear,"<?php
$file = basename($_GET['file']);
$allowed = ['page1.php', 'page2.php'];
if (in_array($file, $allowed)) {
    include($file);
}
?>","<?php
$file = basename($_GET['file']);
$allowed = ['page1.php', 'page2.php'];
if (in_array($file, $allowed)) {
    include($file);
}
?>",php,0
Clear,"import java.io.*;
import javax.servlet.*;
import javax.servlet.http.*;
import org.owasp.encoder.Encode;

public class SecureServlet extends HttpServlet {
    protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        String userInput = request.getParameter(""input"");
        
        // Sanitize and escape user input before outputting it
        String safeUserInput = Encode.forHtml(userInput);

        PrintWriter out = response.getWriter();
        out.println(""<html>"");
        out.println(""<body>"");
        out.println(""<h1>User Input: "" + safeUserInput + ""</h1>"");
        out.println(""</body>"");
        out.println(""</html>"");
    }
}","import java.io.*; import javax.servlet.*; import javax.servlet.http.*; import org.owasp.encoder.Encode; public class SecureServlet extends HttpServlet { protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { String userInput = request.getParameter(""input""); // Sanitize and escape user input before outputting it String safeUserInput = Encode.forHtml(userInput); PrintWriter out = response.getWriter(); out.println(""<html>""); out.println(""<body>""); out.println(""<h1>User Input: "" + safeUserInput + ""</h1>""); out.println(""</body>""); out.println(""</html>""); } }",java,0
Command Injection,"const shell = require('child_process');
shell.exec('ping ' + userInput); // Command Injection
","const shell = require('child_process');
shell.exec('ping ' + userInput); // Command Injection
",javascript,1
Cross-Site Scripting (XSS),"import java.io.*;

public class XSSVulnerableCode {
    public static void main(String[] args) {
        BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));
        
        try {
            System.out.print(""Enter your name: "");
            String name = reader.readLine();
            
            // Improper handling of user input without proper sanitization
            System.out.println(""Hello, "" + name + ""! Welcome to our website."");
        } catch (IOException e) {
            System.err.println(""Error reading input!"");
        }
    }
}","import java.io.*; public class XSSVulnerableCode { public static void main(String[] args) { BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); try { System.out.print(""Enter your name: ""); String name = reader.readLine(); // Improper handling of user input without proper sanitization System.out.println(""Hello, "" + name + ""! Welcome to our website.""); } catch (IOException e) { System.err.println(""Error reading input!""); } } }",java,1
Clear,"#include <stdio.h>
#include <string.h>

void safe_string_copy(char *dest, const char *src, size_t dest_size) {
    if (dest_size > 0) {
        strncpy(dest, src, dest_size - 1);
        dest[dest_size - 1] = '\0';
    }
}","#include <stdio.h>
#include <string.h>

void safe_string_copy(char *dest, const char *src, size_t dest_size) {
    if (dest_size > 0) {
        strncpy(dest, src, dest_size - 1);
        dest[dest_size - 1] = '\0';
    }
}",c,0
SSRF,"import urllib.request
def download_file(file_url):
    return urllib.request.urlopen(file_url).read()","import urllib.request
def download_file(file_url):
    return urllib.request.urlopen(file_url).read()",python,1
Command Injection,"<?php
$cmd = $_GET['cmd'];
system($cmd); // Command Injection
?>","<?php
$cmd = $_GET['cmd'];
system($cmd); // Command Injection
?>",php,1
SQL Injection,"import java.sql.*;

public class SQLInjectionExample {

    public static void main(String[] args) {
        String userInput = args[0]; // Assume user input is passed as a command line argument
        
        try {
            Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");
            Statement stmt = conn.createStatement();
            
            // Vulnerable query construction
            String query = ""SELECT * FROM users WHERE username='"" + userInput + ""'"";
            
            ResultSet rs = stmt.executeQuery(query);
            
            while(rs.next()) {
                System.out.println(""User found: "" + rs.getString(""username""));
            }
            
            conn.close();
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.*; public class SQLInjectionExample { public static void main(String[] args) { String userInput = args[0]; // Assume user input is passed as a command line argument try { Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); Statement stmt = conn.createStatement(); // Vulnerable query construction String query = ""SELECT * FROM users WHERE username='"" + userInput + ""'""; ResultSet rs = stmt.executeQuery(query); while(rs.next()) { System.out.println(""User found: "" + rs.getString(""username"")); } conn.close(); } catch (SQLException e) { e.printStackTrace(); } } }",java,1
Command Injection,"import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class CommandInjectionExample {

    public static void main(String[] args) {
        try {
            BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));
            System.out.print(""Enter a command to execute: "");
            String command = reader.readLine();

            // Vulnerable code: directly executing user input as a command
            Process process = Runtime.getRuntime().exec(command);

            BufferedReader outputReader = new BufferedReader(new InputStreamReader(process.getInputStream()));
            String line;
            while ((line = outputReader.readLine()) != null) {
                System.out.println(line);
            }

        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}","import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class CommandInjectionExample { public static void main(String[] args) { try { BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a command to execute: ""); String command = reader.readLine(); // Vulnerable code: directly executing user input as a command Process process = Runtime.getRuntime().exec(command); BufferedReader outputReader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = outputReader.readLine()) != null) { System.out.println(line); } } catch (IOException e) { e.printStackTrace(); } } }",java,1
Command Injection,"import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class CommandInjectionVulnerable {
    public static void main(String[] args) {
        try {
            // Taking user input for the command to execute
            BufferedReader br = new BufferedReader(new InputStreamReader(System.in));
            System.out.print(""Enter a command to execute: "");
            String userInput = br.readLine();

            // Executing the user input as a command
            Runtime rt = Runtime.getRuntime();
            Process proc = rt.exec(userInput);

            // Reading and printing the output of the command
            BufferedReader stdInput = new BufferedReader(new InputStreamReader(proc.getInputStream()));
            String s;
            while ((s = stdInput.readLine()) != null) {
                System.out.println(s);
            }

        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}","import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class CommandInjectionVulnerable { public static void main(String[] args) { try { // Taking user input for the command to execute BufferedReader br = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a command to execute: ""); String userInput = br.readLine(); // Executing the user input as a command Runtime rt = Runtime.getRuntime(); Process proc = rt.exec(userInput); // Reading and printing the output of the command BufferedReader stdInput = new BufferedReader(new InputStreamReader(proc.getInputStream())); String s; while ((s = stdInput.readLine()) != null) { System.out.println(s); } } catch (IOException e) { e.printStackTrace(); } } }",java,1
Clear,"def safe_division(a, b):
    if b == 0:
        raise ValueError(""Division by zero"")
    return a / b","def safe_division(a, b):
    if b == 0:
        raise ValueError(""Division by zero"")
    return a / b",python,0
Path Traversal,"import java.io.File;
import java.io.IOException;
import java.nio.file.Files;
import java.util.Scanner;

public class PathTraversalVulnerabilityExample {

    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        System.out.print(""Enter file name: "");
        String fileName = scanner.nextLine();

        String directory = ""/path/to/some/directory/"";
        File file = new File(directory + fileName);

        try {
            byte[] fileContent = Files.readAllBytes(file.toPath());
            System.out.println(""File content: "" + new String(fileContent));
        } catch (IOException e) {
            System.out.println(""Error reading file: "" + e.getMessage());
        }

        scanner.close();
    }
}","import java.io.File; import java.io.IOException; import java.nio.file.Files; import java.util.Scanner; public class PathTraversalVulnerabilityExample { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter file name: ""); String fileName = scanner.nextLine(); String directory = ""/path/to/some/directory/""; File file = new File(directory + fileName); try { byte[] fileContent = Files.readAllBytes(file.toPath()); System.out.println(""File content: "" + new String(fileContent)); } catch (IOException e) { System.out.println(""Error reading file: "" + e.getMessage()); } scanner.close(); } }",java,1
Clear,"const shell = require('child_process');
const safeInput = userInput.replace(/[^a-zA-Z0-9.]/g, '');
shell.execFile('ping', [safeInput]); // Safe command execution
","const shell = require('child_process');
const safeInput = userInput.replace(/[^a-zA-Z0-9.]/g, '');
shell.execFile('ping', [safeInput]); // Safe command execution
",javascript,0
Clear,"from flask import Flask, request
import html
app = Flask(__name__)

@app.route('/search_safe')
def search_safe():
    query = request.args.get('q', '')
    safe_query = html.escape(query)
    return f'<h1>Search results for: {safe_query}</h1>'","from flask import Flask, request
import html
app = Flask(__name__)

@app.route('/search_safe')
def search_safe():
    query = request.args.get('q', '')
    safe_query = html.escape(query)
    return f'<h1>Search results for: {safe_query}</h1>'",python,0
Clear,"#include <iostream>
#include <vector>
#include <stdexcept>

int safe_vector_access(const std::vector<int>& vec, size_t index) {
    if (index >= vec.size()) {
        throw std::out_of_range(""Index out of range"");
    }
    return vec[index];
}","#include <iostream>
#include <vector>
#include <stdexcept>

int safe_vector_access(const std::vector<int>& vec, size_t index) {
    if (index >= vec.size()) {
        throw std::out_of_range(""Index out of range"");
    }
    return vec[index];
}",cpp,0
Memory Corruption,"#include <iostream>

void unsafe_virtual_call() {
    // Potential vtable corruption vulnerability
    class Base {
    public:
        virtual void func() { std::cout << ""Base"" << std::endl; }
    };
    
    class Derived : public Base {
    public:
        void func() override { std::cout << ""Derived"" << std::endl; }
    };
}","#include <iostream>

void unsafe_virtual_call() {
    // Potential vtable corruption vulnerability
    class Base {
    public:
        virtual void func() { std::cout << ""Base"" << std::endl; }
    };
    
    class Derived : public Base {
    public:
        void func() override { std::cout << ""Derived"" << std::endl; }
    };
}",cpp,1
Clear,"To secure the code against Path Traversal attacks, you should not allow users to directly manipulate the file path. Instead, you can validate the input and ensure that the file being accessed is within a specific directory. Here's an updated version of the code with proper security measures:

```java
import java.io.File;
import java.io.FileInputStream;
import java.io.IOException;

public class FileDownloader {

    private static final String BASE_DIRECTORY = ""/path/to/files/"";

    public void downloadFile(String fileName) {
        String sanitizedFileName = sanitizeFileName(fileName);
        String filePath = BASE_DIRECTORY + sanitizedFileName;

        try {
            if (isFileWithinBaseDirectory(filePath)) {
                File file = new File(filePath);
                FileInputStream fis = new FileInputStream(file);

                // Code to read and download the file

            } else {
                System.out.println(""Access denied. The requested file is outside the allowed directory."");
            }

        } catch (IOException e) {
            System.out.println(""Error downloading the file: "" + e.getMessage());
        }
    }

    private String sanitizeFileName(String fileName) {
        // Implement your sanitization logic here, e.g., removing special characters
        return fileName.replaceAll(""[^a-zA-Z0-9.-]"", """");","To secure the code against Path Traversal attacks, you should not allow users to directly manipulate the file path. Instead, you can validate the input and ensure that the file being accessed is within a specific directory. Here's an updated version of the code with proper security measures: ```java import java.io.File; import java.io.FileInputStream; import java.io.IOException; public class FileDownloader { private static final String BASE_DIRECTORY = ""/path/to/files/""; public void downloadFile(String fileName) { String sanitizedFileName = sanitizeFileName(fileName); String filePath = BASE_DIRECTORY + sanitizedFileName; try { if (isFileWithinBaseDirectory(filePath)) { File file = new File(filePath); FileInputStream fis = new FileInputStream(file); // Code to read and download the file } else { System.out.println(""Access denied. The requested file is outside the allowed directory.""); } } catch (IOException e) { System.out.println(""Error downloading the file: "" + e.getMessage()); } } private String sanitizeFileName(String fileName) { // Implement your sanitization logic here, e.g., removing special characters return fileName.replaceAll(""[^a-zA-Z0-9.-]"", """");",java,0
Clear,"To fix the Command Injection vulnerability in the provided Java code, you should avoid directly executing user input as a command. Instead, you can use ProcessBuilder to safely execute commands. Here is an updated version of the code with secure command execution:

```java
import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class CommandInjectionExample {

    public static void main(String[] args) throws IOException {
        BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));
        
        System.out.print(""Enter a command to execute: "");
        String userInput = reader.readLine();
        
        // Secure code - using ProcessBuilder to execute the command
        ProcessBuilder processBuilder = new ProcessBuilder(userInput.split(""\\s+""));
        try {
            Process process = processBuilder.start();
            
            BufferedReader processOutputReader = new BufferedReader(new InputStreamReader(process.getInputStream()));
            String line;
            while ((line = processOutputReader.readLine()) != null) {
                System.out.println(line);
            }
            
            int exitCode = process.waitFor();
            System.out.println(""Command executed with exit code: "" + exitCode);
            
        } catch (IOException | InterruptedException e) {
            System.err.println(""Error executing the command: "" + e.getMessage());
        }","To fix the Command Injection vulnerability in the provided Java code, you should avoid directly executing user input as a command. Instead, you can use ProcessBuilder to safely execute commands. Here is an updated version of the code with secure command execution: ```java import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class CommandInjectionExample { public static void main(String[] args) throws IOException { BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a command to execute: ""); String userInput = reader.readLine(); // Secure code - using ProcessBuilder to execute the command ProcessBuilder processBuilder = new ProcessBuilder(userInput.split(""\\s+"")); try { Process process = processBuilder.start(); BufferedReader processOutputReader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = processOutputReader.readLine()) != null) { System.out.println(line); } int exitCode = process.waitFor(); System.out.println(""Command executed with exit code: "" + exitCode); } catch (IOException | InterruptedException e) { System.err.println(""Error executing the command: "" + e.getMessage()); }",java,0
Clear,"To prevent Command Injection vulnerabilities in the code, you should sanitize and validate the user input before passing it to the `exec` method. One way to do this is by using `ProcessBuilder` instead of directly invoking `Runtime.exec`.

Here's an updated version of the code with proper security measures implemented:

```java
import java.io.*;

public class SecureCommandExecutionExample {

    public static void main(String[] args) {
        try {
            BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));
            System.out.print(""Enter a command to execute: "");
            String command = reader.readLine();

            // Sanitize and validate user input
            if (!isValidCommand(command)) {
                System.out.println(""Invalid command"");
                return;
            }

            ProcessBuilder processBuilder = new ProcessBuilder(""ping"", command);
            Process process = processBuilder.start();

            BufferedReader inputReader = new BufferedReader(new InputStreamReader(process.getInputStream()));
            String line;
            while ((line = inputReader.readLine()) != null) {
                System.out.println(line);
            }

        } catch (IOException e) {
            e.printStackTrace();
        }
    }

    private static boolean isValidCommand(String command) {
        // Add validation logic here, e.g., allow only certain commands or characters","To prevent Command Injection vulnerabilities in the code, you should sanitize and validate the user input before passing it to the `exec` method. One way to do this is by using `ProcessBuilder` instead of directly invoking `Runtime.exec`. Here's an updated version of the code with proper security measures implemented: ```java import java.io.*; public class SecureCommandExecutionExample { public static void main(String[] args) { try { BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a command to execute: ""); String command = reader.readLine(); // Sanitize and validate user input if (!isValidCommand(command)) { System.out.println(""Invalid command""); return; } ProcessBuilder processBuilder = new ProcessBuilder(""ping"", command); Process process = processBuilder.start(); BufferedReader inputReader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = inputReader.readLine()) != null) { System.out.println(line); } } catch (IOException e) { e.printStackTrace(); } } private static boolean isValidCommand(String command) { // Add validation logic here, e.g., allow only certain commands or characters",java,0
Buffer Overflow,"import java.util.Scanner;

public class BufferOverflowVulnerability {

    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        
        System.out.print(""Enter your name: "");
        String name = scanner.next();
        
        // Creating a fixed size buffer
        char[] buffer = new char[10];
        
        // Copying user input into the buffer without proper bounds checking
        for (int i = 0; i < name.length(); i++) {
            buffer[i] = name.charAt(i);
        }
        
        System.out.println(""Hello, "" + String.valueOf(buffer));
    }
}","import java.util.Scanner; public class BufferOverflowVulnerability { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter your name: ""); String name = scanner.next(); // Creating a fixed size buffer char[] buffer = new char[10]; // Copying user input into the buffer without proper bounds checking for (int i = 0; i < name.length(); i++) { buffer[i] = name.charAt(i); } System.out.println(""Hello, "" + String.valueOf(buffer)); } }",java,1
Hardcoded Secrets,"import requests
def call_api():
    api_key = ""sk_live_1234567890abcdef""
    headers = {'Authorization': f'Bearer {api_key}'}
    return requests.get('https://api.example.com/data', headers=headers)","import requests
def call_api():
    api_key = ""sk_live_1234567890abcdef""
    headers = {'Authorization': f'Bearer {api_key}'}
    return requests.get('https://api.example.com/data', headers=headers)",python,1
Hardcoded Secrets,"DATABASE_PASSWORD = ""my_super_secret_password_123""
def db_connect():
    import psycopg2
    return psycopg2.connect(f""dbname=test user=admin password={DATABASE_PASSWORD}"")","DATABASE_PASSWORD = ""my_super_secret_password_123""
def db_connect():
    import psycopg2
    return psycopg2.connect(f""dbname=test user=admin password={DATABASE_PASSWORD}"")",python,1
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Clear,"#include <iostream>
#include <sstream>

int safe_string_to_int(const std::string& str) {
    std::stringstream ss(str);
    int value;
    if (ss >> value) {
        return value;
    }
    throw std::invalid_argument(""Invalid integer"");
}","#include <iostream>
#include <sstream>

int safe_string_to_int(const std::string& str) {
    std::stringstream ss(str);
    int value;
    if (ss >> value) {
        return value;
    }
    throw std::invalid_argument(""Invalid integer"");
}",cpp,0
Memory Corruption,"#include <iostream>

void unsafe_pointer_arithmetic(int* array, int size) {
    for (int i = 0; i <= size; i++) {
        std::cout << *(array + i) << std::endl; // potential out-of-bounds
    }
}","#include <iostream>

void unsafe_pointer_arithmetic(int* array, int size) {
    for (int i = 0; i <= size; i++) {
        std::cout << *(array + i) << std::endl; // potential out-of-bounds
    }
}",cpp,1
XSS,"const userInput = document.location.search.split('=')[1];
document.write(userInput); // XSS
","const userInput = document.location.search.split('=')[1];
document.write(userInput); // XSS
",javascript,1
Clear,"To fix this code and prevent buffer overflow vulnerabilities, you can follow these secure coding practices in Java:

1. Limit the input size:
Ensure that the input does not exceed the size of the buffer array to prevent buffer overflow. You can use the length of the user input as a limit for iteration.

2. Validate input length:
Check the length of the user input before copying it into the buffer to ensure it does not exceed the buffer size.

3. Use safe methods for copying:
Instead of directly copying characters from the user input into a character array, consider using methods like `String.toCharArray()` which handle bounds checking automatically.

Here's an updated version of your code with these security measures implemented:

```java
import java.util.Scanner;

public class BufferOverflowSecure {
    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        
        System.out.print(""Enter your name: "");
        String name = scanner.nextLine();
        
        int maxLength = Math.min(name.length(), 10); // Limit to buffer size
        char[] buffer = new char[10];
        name.getChars(0, maxLength, buffer, 0);
        
        for (int i = 0; i < maxLength; i++) {","To fix this code and prevent buffer overflow vulnerabilities, you can follow these secure coding practices in Java: 1. Limit the input size: Ensure that the input does not exceed the size of the buffer array to prevent buffer overflow. You can use the length of the user input as a limit for iteration. 2. Validate input length: Check the length of the user input before copying it into the buffer to ensure it does not exceed the buffer size. 3. Use safe methods for copying: Instead of directly copying characters from the user input into a character array, consider using methods like `String.toCharArray()` which handle bounds checking automatically. Here's an updated version of your code with these security measures implemented: ```java import java.util.Scanner; public class BufferOverflowSecure { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter your name: ""); String name = scanner.nextLine(); int maxLength = Math.min(name.length(), 10); // Limit to buffer size char[] buffer = new char[10]; name.getChars(0, maxLength, buffer, 0); for (int i = 0; i < maxLength; i++) {",java,0
Command Injection,"import java.io.*;

public class CommandInjectionExample {
    public static void main(String[] args) {
        try {
            BufferedReader br = new BufferedReader(new InputStreamReader(System.in));
            
            System.out.print(""Enter a command to execute: "");
            String userInput = br.readLine();
            
            String command = ""ls "" + userInput; // Vulnerable point
            
            Process process = Runtime.getRuntime().exec(command);
            
            BufferedReader reader = new BufferedReader(new InputStreamReader(process.getInputStream()));
            
            String line;
            while ((line = reader.readLine()) != null) {
                System.out.println(line);
            }
            
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}","import java.io.*; public class CommandInjectionExample { public static void main(String[] args) { try { BufferedReader br = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a command to execute: ""); String userInput = br.readLine(); String command = ""ls "" + userInput; // Vulnerable point Process process = Runtime.getRuntime().exec(command); BufferedReader reader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = reader.readLine()) != null) { System.out.println(line); } } catch (IOException e) { e.printStackTrace(); } } }",java,1
SSRF,"import urllib.request
def download_file(file_url):
    return urllib.request.urlopen(file_url).read()","import urllib.request
def download_file(file_url):
    return urllib.request.urlopen(file_url).read()",python,1
Clear,"#include <iostream>
#include <sstream>

int safe_string_to_int(const std::string& str) {
    std::stringstream ss(str);
    int value;
    if (ss >> value) {
        return value;
    }
    throw std::invalid_argument(""Invalid integer"");
}","#include <iostream>
#include <sstream>

int safe_string_to_int(const std::string& str) {
    std::stringstream ss(str);
    int value;
    if (ss >> value) {
        return value;
    }
    throw std::invalid_argument(""Invalid integer"");
}",cpp,0
Clear,"To fix the insecure deserialization vulnerability in the provided code snippet, you can implement proper security measures to ensure safe deserialization. Here are some recommendations to improve the code:

1. **Use a Safe Deserialization Mechanism:** Avoid using `ObjectInputStream` directly for deserialization, as it can deserialize arbitrary objects and lead to security vulnerabilities like remote code execution. Instead, consider using safer alternatives like JSON deserialization libraries (e.g., Jackson) or protobuf.

2. **Implement Input Validation:** Validate the input data before deserialization to prevent malicious payloads from being processed. Check if the input data conforms to an expected format or schema before attempting deserialization.

3. **Implement Whitelisting:** Maintain a whitelist of allowed classes that can be deserialized and validate incoming objects against this whitelist. Only deserialize classes that are explicitly allowed to mitigate the risk of executing untrusted code.

4. **Use Secure Serialization Formats:** If possible, prefer using secure serialization formats such as JSON or XML with validation against predefined schemas rather than Java serialization.

5. **Implement Security Controls:** Apply additional security controls such as input/output validation, authentication, and authorization checks during deserialization to prevent unauthorized access or execution of malicious code.

Here's an example demonstrating how you can implement","To fix the insecure deserialization vulnerability in the provided code snippet, you can implement proper security measures to ensure safe deserialization. Here are some recommendations to improve the code: 1. **Use a Safe Deserialization Mechanism:** Avoid using `ObjectInputStream` directly for deserialization, as it can deserialize arbitrary objects and lead to security vulnerabilities like remote code execution. Instead, consider using safer alternatives like JSON deserialization libraries (e.g., Jackson) or protobuf. 2. **Implement Input Validation:** Validate the input data before deserialization to prevent malicious payloads from being processed. Check if the input data conforms to an expected format or schema before attempting deserialization. 3. **Implement Whitelisting:** Maintain a whitelist of allowed classes that can be deserialized and validate incoming objects against this whitelist. Only deserialize classes that are explicitly allowed to mitigate the risk of executing untrusted code. 4. **Use Secure Serialization Formats:** If possible, prefer using secure serialization formats such as JSON or XML with validation against predefined schemas rather than Java serialization. 5. **Implement Security Controls:** Apply additional security controls such as input/output validation, authentication, and authorization checks during deserialization to prevent unauthorized access or execution of malicious code. Here's an example demonstrating how you can implement",php,0
Clear,"#include <stdio.h>
#include <string.h>

int validate_input(const char *input) {
    if (input == NULL) return 0;
    for (int i = 0; input[i] != '\0'; i++) {
        if (input[i] < 32 || input[i] > 126) {
            return 0; // invalid character
        }
    }
    return 1;
}","#include <stdio.h>
#include <string.h>

int validate_input(const char *input) {
    if (input == NULL) return 0;
    for (int i = 0; input[i] != '\0'; i++) {
        if (input[i] < 32 || input[i] > 126) {
            return 0; // invalid character
        }
    }
    return 1;
}",c,0
SQL Injection,"app.get('/user/:id', (req, res) => {
    const query = `SELECT * FROM users WHERE id = ${req.params.id}`; // SQL Injection
    db.query(query, (err, result) => {
        res.json(result);
    });
});
","app.get('/user/:id', (req, res) => {
    const query = `SELECT * FROM users WHERE id = ${req.params.id}`; // SQL Injection
    db.query(query, (err, result) => {
        res.json(result);
    });
});
",javascript,1
Clear,"const shell = require('child_process');
const safeInput = userInput.replace(/[^a-zA-Z0-9.]/g, '');
shell.execFile('ping', [safeInput]); // Safe command execution
","const shell = require('child_process');
const safeInput = userInput.replace(/[^a-zA-Z0-9.]/g, '');
shell.execFile('ping', [safeInput]); // Safe command execution
",javascript,0
Memory Corruption,"#include <iostream>

void unsafe_pointer_arithmetic(int* array, int size) {
    for (int i = 0; i <= size; i++) {
        std::cout << *(array + i) << std::endl; // potential out-of-bounds
    }
}","#include <iostream>

void unsafe_pointer_arithmetic(int* array, int size) {
    for (int i = 0; i <= size; i++) {
        std::cout << *(array + i) << std::endl; // potential out-of-bounds
    }
}",cpp,1
Clear,"To fix the Path Traversal vulnerability in the provided Java code snippet, you need to ensure that the input file path is properly validated and restricted to prevent access to files outside the intended directory. Here is an improved version of the code with proper security measures:

```java
import java.io.File;
import java.io.FileInputStream;
import java.io.IOException;
import java.util.Scanner;

public class SecurePathTraversal {

    private static final String BASE_DIRECTORY = ""C:\\files\\"";

    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);

        System.out.print(""Enter the file name: "");
        String fileName = scanner.next();

        if (isValidFileName(fileName)) {
            try {
                File file = new File(BASE_DIRECTORY + fileName);
                if (file.exists() && file.isFile()) {
                    FileInputStream fis = new FileInputStream(file);

                    int content;
                    while ((content = fis.read()) != -1) {
                        System.out.print((char) content);
                    }

                    fis.close();
                } else {
                    System.out.println(""File does not exist or is not a regular file."");
                }
            } catch (IOException e) {
                System.out.println(""Error reading file: "" + e.getMessage());
            }","To fix the Path Traversal vulnerability in the provided Java code snippet, you need to ensure that the input file path is properly validated and restricted to prevent access to files outside the intended directory. Here is an improved version of the code with proper security measures: ```java import java.io.File; import java.io.FileInputStream; import java.io.IOException; import java.util.Scanner; public class SecurePathTraversal { private static final String BASE_DIRECTORY = ""C:\\files\\""; public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter the file name: ""); String fileName = scanner.next(); if (isValidFileName(fileName)) { try { File file = new File(BASE_DIRECTORY + fileName); if (file.exists() && file.isFile()) { FileInputStream fis = new FileInputStream(file); int content; while ((content = fis.read()) != -1) { System.out.print((char) content); } fis.close(); } else { System.out.println(""File does not exist or is not a regular file.""); } } catch (IOException e) { System.out.println(""Error reading file: "" + e.getMessage()); }",java,0
Insecure Deserialization,"<?php
$data = $_POST['data'];
unserialize($data); // Insecure Deserialization
?>","<?php
$data = $_POST['data'];
unserialize($data); // Insecure Deserialization
?>",php,1
XSS,"const userInput = document.location.search.split('=')[1];
document.write(userInput); // XSS
","const userInput = document.location.search.split('=')[1];
document.write(userInput); // XSS
",javascript,1
Cross-Site Scripting (XSS),"import java.io.*;
import javax.servlet.*;
import javax.servlet.http.*;

public class XssVulnerableServlet extends HttpServlet {
    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        String userInput = request.getParameter(""input"");
        
        String htmlResponse = ""<html><body>User input: "" + userInput + ""</body></html>"";
        
        response.setContentType(""text/html"");
        PrintWriter out = response.getWriter();
        out.println(htmlResponse);
    }
}","import java.io.*; import javax.servlet.*; import javax.servlet.http.*; public class XssVulnerableServlet extends HttpServlet { protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { String userInput = request.getParameter(""input""); String htmlResponse = ""<html><body>User input: "" + userInput + ""</body></html>""; response.setContentType(""text/html""); PrintWriter out = response.getWriter(); out.println(htmlResponse); } }",java,1
SQL Injection,"app.get('/user/:id', (req, res) => {
    const query = `SELECT * FROM users WHERE id = ${req.params.id}`; // SQL Injection
    db.query(query, (err, result) => {
        res.json(result);
    });
});
","app.get('/user/:id', (req, res) => {
    const query = `SELECT * FROM users WHERE id = ${req.params.id}`; // SQL Injection
    db.query(query, (err, result) => {
        res.json(result);
    });
});
",javascript,1
Clear,"import java.sql.*;

public class SQLInjectionSecure {

    public static void main(String[] args) {
        String userInput = args[0]; // User input from command line arguments
        
        try {
            Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");
            
            String query = ""SELECT * FROM users WHERE username=?"";
            PreparedStatement pstmt = conn.prepareStatement(query);
            pstmt.setString(1, userInput); // Set user input as parameter
            
            ResultSet rs = pstmt.executeQuery();
            
            while (rs.next()) {
                System.out.println(""Username: "" + rs.getString(""username"") + "", Password: "" + rs.getString(""password""));
            }
            
            conn.close();
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.*; public class SQLInjectionSecure { public static void main(String[] args) { String userInput = args[0]; // User input from command line arguments try { Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); String query = ""SELECT * FROM users WHERE username=?""; PreparedStatement pstmt = conn.prepareStatement(query); pstmt.setString(1, userInput); // Set user input as parameter ResultSet rs = pstmt.executeQuery(); while (rs.next()) { System.out.println(""Username: "" + rs.getString(""username"") + "", Password: "" + rs.getString(""password"")); } conn.close(); } catch (SQLException e) { e.printStackTrace(); } } }",java,0
Clear,"import java.util.Scanner;

public class SecureBuffer {

    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);

        System.out.print(""Enter a string: "");
        String userInput = scanner.nextLine();

        char[] buffer = new char[10];

        // Copy user input into buffer with bounds checking
        for (int i = 0; i < userInput.length() && i < buffer.length; i++) {
            buffer[i] = userInput.charAt(i);
        }

        System.out.println(""Buffer contents: "" + new String(buffer));
    }
}","import java.util.Scanner; public class SecureBuffer { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter a string: ""); String userInput = scanner.nextLine(); char[] buffer = new char[10]; // Copy user input into buffer with bounds checking for (int i = 0; i < userInput.length() && i < buffer.length; i++) { buffer[i] = userInput.charAt(i); } System.out.println(""Buffer contents: "" + new String(buffer)); } }",java,0
Clear,"#include <stdio.h>
#include <string.h>

void safe_string_copy(char *dest, const char *src, size_t dest_size) {
    if (dest_size > 0) {
        strncpy(dest, src, dest_size - 1);
        dest[dest_size - 1] = '\0';
    }
}","#include <stdio.h>
#include <string.h>

void safe_string_copy(char *dest, const char *src, size_t dest_size) {
    if (dest_size > 0) {
        strncpy(dest, src, dest_size - 1);
        dest[dest_size - 1] = '\0';
    }
}",c,0
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
SSRF,"import urllib.request
def download_file(file_url):
    return urllib.request.urlopen(file_url).read()","import urllib.request
def download_file(file_url):
    return urllib.request.urlopen(file_url).read()",python,1
Clear,"import os
def safe_read_file(filename):
    base_path = '/var/www/uploads/'
    full_path = os.path.join(base_path, filename)
    full_path = os.path.normpath(full_path)
    if not full_path.startswith(base_path):
        raise ValueError(""Path traversal detected"")
    with open(full_path, 'r') as f:
        return f.read()","import os
def safe_read_file(filename):
    base_path = '/var/www/uploads/'
    full_path = os.path.join(base_path, filename)
    full_path = os.path.normpath(full_path)
    if not full_path.startswith(base_path):
        raise ValueError(""Path traversal detected"")
    with open(full_path, 'r') as f:
        return f.read()",python,0
Clear,"import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class CommandInjectionExample {

    public static void main(String[] args) {
        try {
            BufferedReader br = new BufferedReader(new InputStreamReader(System.in));
            System.out.print(""Enter a command to execute: "");
            String command = br.readLine();

            // Safely execute the command using ProcessBuilder
            ProcessBuilder processBuilder = new ProcessBuilder(command.split("" ""));
            Process process = processBuilder.start();

            BufferedReader reader = new BufferedReader(new InputStreamReader(process.getInputStream()));
            String line;
            while ((line = reader.readLine()) != null) {
                System.out.println(line);
            }

        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}","import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class CommandInjectionExample { public static void main(String[] args) { try { BufferedReader br = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a command to execute: ""); String command = br.readLine(); // Safely execute the command using ProcessBuilder ProcessBuilder processBuilder = new ProcessBuilder(command.split("" "")); Process process = processBuilder.start(); BufferedReader reader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = reader.readLine()) != null) { System.out.println(line); } } catch (IOException e) { e.printStackTrace(); } } }",java,0
Clear,"To fix the Path Traversal vulnerability in the provided Java code snippet, you can implement proper security measures to prevent users from accessing files outside the intended directory. One way to achieve this is by validating and sanitizing user input before constructing the file path. Here is an improved version of the code with security measures:

```java
import java.io.File;
import java.io.FileInputStream;
import java.io.IOException;
import java.util.Scanner;

public class SecurePathTraversalExample {

    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        System.out.print(""Enter file name: "");
        String fileName = scanner.next();

        // Validate and sanitize user input to prevent path traversal
        if (!fileName.matches(""[a-zA-Z0-9_-]+\\.txt"")) {
            System.out.println(""Invalid file name format."");
            return;
        }

        // Construct the full path using a fixed base directory
        String baseDirectory = ""C:/data/"";
        File file = new File(baseDirectory + fileName);

        // Check if the file exists and is within the allowed directory
        if (!file.exists() || !file.getAbsolutePath().startsWith(baseDirectory)) {
            System.out.println(""File not found or access denied."");
            return","To fix the Path Traversal vulnerability in the provided Java code snippet, you can implement proper security measures to prevent users from accessing files outside the intended directory. One way to achieve this is by validating and sanitizing user input before constructing the file path. Here is an improved version of the code with security measures: ```java import java.io.File; import java.io.FileInputStream; import java.io.IOException; import java.util.Scanner; public class SecurePathTraversalExample { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter file name: ""); String fileName = scanner.next(); // Validate and sanitize user input to prevent path traversal if (!fileName.matches(""[a-zA-Z0-9_-]+\\.txt"")) { System.out.println(""Invalid file name format.""); return; } // Construct the full path using a fixed base directory String baseDirectory = ""C:/data/""; File file = new File(baseDirectory + fileName); // Check if the file exists and is within the allowed directory if (!file.exists() || !file.getAbsolutePath().startsWith(baseDirectory)) { System.out.println(""File not found or access denied.""); return",java,0
Clear,"import json
def parse_safe_json(json_str):
    try:
        return json.loads(json_str)
    except json.JSONDecodeError:
        raise ValueError(""Invalid JSON"")","import json
def parse_safe_json(json_str):
    try:
        return json.loads(json_str)
    except json.JSONDecodeError:
        raise ValueError(""Invalid JSON"")",python,0
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Clear,"To fix the Path Traversal vulnerability in the provided Java code, we need to ensure that the input file name is properly sanitized and validated before constructing the file path. Here's an improved version of the code with proper security measures:

```java
import java.io.File;
import java.io.FileInputStream;
import java.io.IOException;
import java.util.Scanner;

public class SecurePathTraversal {

    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        System.out.print(""Enter file name: "");
        String fileName = scanner.nextLine();

        // Validate input to prevent directory traversal
        if (!isValidFileName(fileName)) {
            System.out.println(""Invalid file name."");
            return;
        }

        try {
            File file = new File(""C:\\data\\"" + fileName);
            if (file.exists() && file.isFile()) { // Check if the file exists and is a regular file
                FileInputStream fis = new FileInputStream(file);
                int content;
                while ((content = fis.read()) != -1) {
                    System.out.print((char) content);
                }
                fis.close();
            } else {
                System.out.println(""File not found."");
            }
        } catch (IOException e) {
            System.out.println(""","To fix the Path Traversal vulnerability in the provided Java code, we need to ensure that the input file name is properly sanitized and validated before constructing the file path. Here's an improved version of the code with proper security measures: ```java import java.io.File; import java.io.FileInputStream; import java.io.IOException; import java.util.Scanner; public class SecurePathTraversal { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter file name: ""); String fileName = scanner.nextLine(); // Validate input to prevent directory traversal if (!isValidFileName(fileName)) { System.out.println(""Invalid file name.""); return; } try { File file = new File(""C:\\data\\"" + fileName); if (file.exists() && file.isFile()) { // Check if the file exists and is a regular file FileInputStream fis = new FileInputStream(file); int content; while ((content = fis.read()) != -1) { System.out.print((char) content); } fis.close(); } else { System.out.println(""File not found.""); } } catch (IOException e) { System.out.println(""",java,0
SSRF,"import urllib.request
def download_file(file_url):
    return urllib.request.urlopen(file_url).read()","import urllib.request
def download_file(file_url):
    return urllib.request.urlopen(file_url).read()",python,1
Clear,"To fix the Path Traversal vulnerability in the given Java code snippet, you should validate the user input to ensure that the file path is within the intended directory. Here's an improved version of the code with proper security measures:

```java
import java.io.File;
import java.io.IOException;
import java.nio.file.Files;
import java.util.Scanner;

public class SecurePathTraversal {

    private static final String DIRECTORY_PATH = ""/path/to/directory/"";

    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        System.out.print(""Enter file name: "");
        String fileName = scanner.nextLine();

        // Validate the input file name to prevent directory traversal
        if (!isValidFileName(fileName)) {
            System.out.println(""Invalid file name"");
            return;
        }

        File file = new File(DIRECTORY_PATH + fileName);

        try {
            byte[] fileContent = Files.readAllBytes(file.toPath());
            System.out.println(""File content: "" + new String(fileContent));
        } catch (IOException e) {
            System.out.println(""Error reading file: "" + e.getMessage());
        }
    }

    private static boolean isValidFileName(String fileName) {
        // Check if the file name contains any path","To fix the Path Traversal vulnerability in the given Java code snippet, you should validate the user input to ensure that the file path is within the intended directory. Here's an improved version of the code with proper security measures: ```java import java.io.File; import java.io.IOException; import java.nio.file.Files; import java.util.Scanner; public class SecurePathTraversal { private static final String DIRECTORY_PATH = ""/path/to/directory/""; public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter file name: ""); String fileName = scanner.nextLine(); // Validate the input file name to prevent directory traversal if (!isValidFileName(fileName)) { System.out.println(""Invalid file name""); return; } File file = new File(DIRECTORY_PATH + fileName); try { byte[] fileContent = Files.readAllBytes(file.toPath()); System.out.println(""File content: "" + new String(fileContent)); } catch (IOException e) { System.out.println(""Error reading file: "" + e.getMessage()); } } private static boolean isValidFileName(String fileName) { // Check if the file name contains any path",java,0
Buffer Overflow,"import java.util.Scanner;

public class BufferOverflowExample {
    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        
        System.out.print(""Enter your name: "");
        String name = scanner.nextLine();
        
        // Vulnerability: Improper handling of user input can lead to buffer overflow
        char[] buffer = new char[10];
        name.getChars(0, name.length(), buffer, 0);
        
        System.out.println(""Hello, "" + new String(buffer));
    }
}","import java.util.Scanner; public class BufferOverflowExample { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter your name: ""); String name = scanner.nextLine(); // Vulnerability: Improper handling of user input can lead to buffer overflow char[] buffer = new char[10]; name.getChars(0, name.length(), buffer, 0); System.out.println(""Hello, "" + new String(buffer)); } }",java,1
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Clear,"import os
def get_api_key():
    return os.environ.get('API_KEY')","import os
def get_api_key():
    return os.environ.get('API_KEY')",python,0
Buffer Overflow,"import java.util.Scanner;

public class BufferOverflowVulnerability {

    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);

        System.out.println(""Enter a string:"");
        String userInput = scanner.nextLine();

        char[] buffer = new char[10];
        userInput.getChars(0, userInput.length(), buffer, 0);

        System.out.println(""Buffer contents: "" + new String(buffer));
    }
}","import java.util.Scanner; public class BufferOverflowVulnerability { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.println(""Enter a string:""); String userInput = scanner.nextLine(); char[] buffer = new char[10]; userInput.getChars(0, userInput.length(), buffer, 0); System.out.println(""Buffer contents: "" + new String(buffer)); } }",java,1
Buffer Overflow,"#include <iostream>
#include <cstring>

void unsafe_c_string(char* input) {
    char buffer[100];
    strcpy(buffer, input); // potential buffer overflow
    std::cout << buffer << std::endl;
}","#include <iostream>
#include <cstring>

void unsafe_c_string(char* input) {
    char buffer[100];
    strcpy(buffer, input); // potential buffer overflow
    std::cout << buffer << std::endl;
}",cpp,1
Path Traversal,"import java.io.File;
import java.io.FileInputStream;
import java.io.IOException;

public class PathTraversalVulnerability {

    public static void main(String[] args) {
        String userInput = ""../etc/passwd"";
        String baseDirectory = ""/var/data/"";
        String filePath = baseDirectory + userInput;

        File file = new File(filePath);
        
        if (file.exists()) {
            try (FileInputStream fis = new FileInputStream(file)) {
                int content;
                while ((content = fis.read()) != -1) {
                    System.out.print((char) content);
                }
            } catch (IOException e) {
                e.printStackTrace();
            }
        } else {
            System.out.println(""File not found."");
        }
    }
}","import java.io.File; import java.io.FileInputStream; import java.io.IOException; public class PathTraversalVulnerability { public static void main(String[] args) { String userInput = ""../etc/passwd""; String baseDirectory = ""/var/data/""; String filePath = baseDirectory + userInput; File file = new File(filePath); if (file.exists()) { try (FileInputStream fis = new FileInputStream(file)) { int content; while ((content = fis.read()) != -1) { System.out.print((char) content); } } catch (IOException e) { e.printStackTrace(); } } else { System.out.println(""File not found.""); } } }",java,1
Clear,"import java.sql.*;

public class SQLInjectionFixed {
    public static void main(String[] args) {
        String userInput = ""'; DROP TABLE users; --"";

        try {
            Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");
            String query = ""SELECT * FROM users WHERE username = ?"";
            PreparedStatement pstmt = conn.prepareStatement(query);
            pstmt.setString(1, userInput);

            ResultSet rs = pstmt.executeQuery();

            while (rs.next()) {
                System.out.println(rs.getString(""username""));
            }

            conn.close();
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.*; public class SQLInjectionFixed { public static void main(String[] args) { String userInput = ""'; DROP TABLE users; --""; try { Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); String query = ""SELECT * FROM users WHERE username = ?""; PreparedStatement pstmt = conn.prepareStatement(query); pstmt.setString(1, userInput); ResultSet rs = pstmt.executeQuery(); while (rs.next()) { System.out.println(rs.getString(""username"")); } conn.close(); } catch (SQLException e) { e.printStackTrace(); } } }",java,0
SQL Injection,"import java.sql.*;

public class VulnerableCode {

    public static void main(String[] args) {
        String userInput = ""'; DROP TABLE users; --"";

        try {
            Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");
            Statement stmt = conn.createStatement();

            // Vulnerable code - directly concatenating user input into the SQL query
            String query = ""SELECT * FROM users WHERE username='"" + userInput + ""'"";
            ResultSet rs = stmt.executeQuery(query);

            while (rs.next()) {
                System.out.println(""User found: "" + rs.getString(""username""));
            }

            conn.close();
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.*; public class VulnerableCode { public static void main(String[] args) { String userInput = ""'; DROP TABLE users; --""; try { Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); Statement stmt = conn.createStatement(); // Vulnerable code - directly concatenating user input into the SQL query String query = ""SELECT * FROM users WHERE username='"" + userInput + ""'""; ResultSet rs = stmt.executeQuery(query); while (rs.next()) { System.out.println(""User found: "" + rs.getString(""username"")); } conn.close(); } catch (SQLException e) { e.printStackTrace(); } } }",java,1
Clear,"<?php
$cmd = escapeshellarg($_GET['cmd']);
system(""ls "" . $cmd); // Escaped command
?>","<?php
$cmd = escapeshellarg($_GET['cmd']);
system(""ls "" . $cmd); // Escaped command
?>",php,0
Clear,"Scanner scanner = new Scanner(System.in);
System.out.print(""Enter a string (max 10 characters): "");
String userInput = scanner.nextLine();

// Limit user input to a maximum of 10 characters
if(userInput.length() > 10) {
    userInput = userInput.substring(0, 10);
}","Scanner scanner = new Scanner(System.in); System.out.print(""Enter a string (max 10 characters): ""); String userInput = scanner.nextLine(); // Limit user input to a maximum of 10 characters if(userInput.length() > 10) { userInput = userInput.substring(0, 10); }",python,0
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Clear,"#include <stdio.h>
#include <stdlib.h>

int safe_string_to_int(const char *str) {
    char *endptr;
    long value = strtol(str, &endptr, 10);
    if (*endptr != '\0' || str == endptr) {
        return -1; // error
    }
    return (int)value;
}","#include <stdio.h>
#include <stdlib.h>

int safe_string_to_int(const char *str) {
    char *endptr;
    long value = strtol(str, &endptr, 10);
    if (*endptr != '\0' || str == endptr) {
        return -1; // error
    }
    return (int)value;
}",c,0
SQL Injection,"app.get('/user/:id', (req, res) => {
    const query = `SELECT * FROM users WHERE id = ${req.params.id}`; // SQL Injection
    db.query(query, (err, result) => {
        res.json(result);
    });
});
","app.get('/user/:id', (req, res) => {
    const query = `SELECT * FROM users WHERE id = ${req.params.id}`; // SQL Injection
    db.query(query, (err, result) => {
        res.json(result);
    });
});
",javascript,1
Code Injection,"const userData = eval('(' + userInput + ')'); // eval injection
","const userData = eval('(' + userInput + ')'); // eval injection
",javascript,1
Insecure Deserialization,"<?php
$data = $_POST['data'];
unserialize($data); // Insecure Deserialization
?>","<?php
$data = $_POST['data'];
unserialize($data); // Insecure Deserialization
?>",php,1
XSS,"const userInput = document.location.search.split('=')[1];
document.write(userInput); // XSS
","const userInput = document.location.search.split('=')[1];
document.write(userInput); // XSS
",javascript,1
Clear,"import sqlite3
def get_user_data_safe(username):
    conn = sqlite3.connect('database.db')
    cursor = conn.cursor()
    query = ""SELECT * FROM users WHERE username = ?""
    cursor.execute(query, (username,))
    return cursor.fetchall()","import sqlite3
def get_user_data_safe(username):
    conn = sqlite3.connect('database.db')
    cursor = conn.cursor()
    query = ""SELECT * FROM users WHERE username = ?""
    cursor.execute(query, (username,))
    return cursor.fetchall()",python,0
Clear,"app.get('/user/:id', (req, res) => {
    const userId = parseInt(req.params.id);
    db.query('SELECT * FROM users WHERE id = ?', [userId], (err, result) => {
        res.json(result);
    });
});
","app.get('/user/:id', (req, res) => {
    const userId = parseInt(req.params.id);
    db.query('SELECT * FROM users WHERE id = ?', [userId], (err, result) => {
        res.json(result);
    });
});
",javascript,0
Clear,"#include <stdio.h>
#include <string.h>

void safe_string_copy(char *dest, const char *src, size_t dest_size) {
    if (dest_size > 0) {
        strncpy(dest, src, dest_size - 1);
        dest[dest_size - 1] = '\0';
    }
}","#include <stdio.h>
#include <string.h>

void safe_string_copy(char *dest, const char *src, size_t dest_size) {
    if (dest_size > 0) {
        strncpy(dest, src, dest_size - 1);
        dest[dest_size - 1] = '\0';
    }
}",c,0
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Cross-Site Scripting (XSS),"import java.util.Scanner;

public class XSSVulnerableCode {
    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        
        System.out.print(""Enter your name: "");
        String userInput = scanner.nextLine();
        
        // Improperly handling user input by directly outputting it to the webpage
        System.out.println(""<h1>Welcome, "" + userInput + ""!</h1>"");
        
        scanner.close();
    }
}","import java.util.Scanner; public class XSSVulnerableCode { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter your name: ""); String userInput = scanner.nextLine(); // Improperly handling user input by directly outputting it to the webpage System.out.println(""<h1>Welcome, "" + userInput + ""!</h1>""); scanner.close(); } }",java,1
Clear,"String username = request.getParameter(""username"");
String password = request.getParameter(""password"");

// Use PreparedStatement to prevent SQL injection
String query = ""SELECT * FROM users WHERE username=? AND password=?"";
PreparedStatement preparedStatement = connection.prepareStatement(query);
preparedStatement.setString(1, username);
preparedStatement.setString(2, password);

ResultSet resultSet = preparedStatement.executeQuery();","String username = request.getParameter(""username""); String password = request.getParameter(""password""); // Use PreparedStatement to prevent SQL injection String query = ""SELECT * FROM users WHERE username=? AND password=?""; PreparedStatement preparedStatement = connection.prepareStatement(query); preparedStatement.setString(1, username); preparedStatement.setString(2, password); ResultSet resultSet = preparedStatement.executeQuery();",php,0
Cross-Site Scripting (XSS),"from flask import Flask, request
app = Flask(__name__)

@app.route('/search')
def search():
    query = request.args.get('q', '')
    return f'<h1>Search results for: {query}</h1>'","from flask import Flask, request
app = Flask(__name__)

@app.route('/search')
def search():
    query = request.args.get('q', '')
    return f'<h1>Search results for: {query}</h1>'",python,1
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
SQL Injection,"<?php
$username = $_POST['username'];
$query = ""SELECT * FROM users WHERE username = '$username'"";
$result = mysql_query($query); // SQL Injection
?>","<?php
$username = $_POST['username'];
$query = ""SELECT * FROM users WHERE username = '$username'"";
$result = mysql_query($query); // SQL Injection
?>",php,1
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Clear,"import java.io.*;
import javax.servlet.*;
import javax.servlet.http.*;
import org.owasp.esapi.ESAPI;
import org.owasp.esapi.Encoder;

public class XSSProtectedServlet extends HttpServlet {
    protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        String userInput = request.getParameter(""input"");
        
        // Sanitize user input to prevent XSS attacks
        Encoder encoder = ESAPI.encoder();
        String sanitizedInput = encoder.encodeForHTML(userInput);
        
        String output = ""<p>User input: "" + sanitizedInput + ""</p>"";
        
        PrintWriter out = response.getWriter();
        out.println(output);
    }
}","import java.io.*; import javax.servlet.*; import javax.servlet.http.*; import org.owasp.esapi.ESAPI; import org.owasp.esapi.Encoder; public class XSSProtectedServlet extends HttpServlet { protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { String userInput = request.getParameter(""input""); // Sanitize user input to prevent XSS attacks Encoder encoder = ESAPI.encoder(); String sanitizedInput = encoder.encodeForHTML(userInput); String output = ""<p>User input: "" + sanitizedInput + ""</p>""; PrintWriter out = response.getWriter(); out.println(output); } }",java,0
Clear,"import java.util.Scanner;

public class SecureBufferExample {
    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        
        System.out.print(""Enter your name: "");
        String input = scanner.nextLine();
        
        // Create a buffer with fixed size
        char[] buffer = new char[10];
        
        // Copy input to buffer with length checking
        if (input.length() <= buffer.length) {
            input.getChars(0, input.length(), buffer, 0);
            System.out.println(""Hello, "" + new String(buffer));
        } else {
            System.out.println(""Input exceeds buffer size. Please enter a shorter name."");
        }
    }
}","import java.util.Scanner; public class SecureBufferExample { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter your name: ""); String input = scanner.nextLine(); // Create a buffer with fixed size char[] buffer = new char[10]; // Copy input to buffer with length checking if (input.length() <= buffer.length) { input.getChars(0, input.length(), buffer, 0); System.out.println(""Hello, "" + new String(buffer)); } else { System.out.println(""Input exceeds buffer size. Please enter a shorter name.""); } } }",java,0
Clear,"To fix the insecure deserialization vulnerability in this code snippet, you should implement proper security measures to prevent malicious code execution during deserialization. Here are some steps you can take to make the code more secure:

1. Use a Safe Deserialization Library: Avoid using Java Object Serialization for deserializing untrusted data. Instead, consider using a safer deserialization library like Google's Protocol Buffers, JSON, or XML serialization libraries.

2. Implement Input Validation: Validate the serialized data before deserialization to ensure it comes from a trusted and expected source. You can use digital signatures or checksums to verify the integrity of the data.

3. Implement a Secure Deserialization Proxy: Create a proxy class that acts as an intermediary between the serialized data and the actual object instantiation process. The proxy class should validate and sanitize the input before passing it to the ObjectInputStream.

4. Use a Security Manager: Configure and enable a Security Manager with appropriate permissions to restrict classes that can be loaded during deserialization. This can help prevent classes with malicious payloads from being instantiated.

5. Enable Class Whitelisting: Limit the classes that can be deserialized by maintaining a whitelist of allowed classes. Only deserialize objects of classes present in this whitelist to prevent instantiation of unauthorized classes","To fix the insecure deserialization vulnerability in this code snippet, you should implement proper security measures to prevent malicious code execution during deserialization. Here are some steps you can take to make the code more secure: 1. Use a Safe Deserialization Library: Avoid using Java Object Serialization for deserializing untrusted data. Instead, consider using a safer deserialization library like Google's Protocol Buffers, JSON, or XML serialization libraries. 2. Implement Input Validation: Validate the serialized data before deserialization to ensure it comes from a trusted and expected source. You can use digital signatures or checksums to verify the integrity of the data. 3. Implement a Secure Deserialization Proxy: Create a proxy class that acts as an intermediary between the serialized data and the actual object instantiation process. The proxy class should validate and sanitize the input before passing it to the ObjectInputStream. 4. Use a Security Manager: Configure and enable a Security Manager with appropriate permissions to restrict classes that can be loaded during deserialization. This can help prevent classes with malicious payloads from being instantiated. 5. Enable Class Whitelisting: Limit the classes that can be deserialized by maintaining a whitelist of allowed classes. Only deserialize objects of classes present in this whitelist to prevent instantiation of unauthorized classes",php,0
Hardcoded Secrets,"import requests
def call_api():
    api_key = ""sk_live_1234567890abcdef""
    headers = {'Authorization': f'Bearer {api_key}'}
    return requests.get('https://api.example.com/data', headers=headers)","import requests
def call_api():
    api_key = ""sk_live_1234567890abcdef""
    headers = {'Authorization': f'Bearer {api_key}'}
    return requests.get('https://api.example.com/data', headers=headers)",python,1
Clear,"const shell = require('child_process');
const safeInput = userInput.replace(/[^a-zA-Z0-9.]/g, '');
shell.execFile('ping', [safeInput]); // Safe command execution
","const shell = require('child_process');
const safeInput = userInput.replace(/[^a-zA-Z0-9.]/g, '');
shell.execFile('ping', [safeInput]); // Safe command execution
",javascript,0
SQL Injection,"import java.sql.*;

public class VulnerableCode {

    public static void main(String[] args) {
        String userInput = ""'; DROP TABLE users; --"";

        try {
            Connection connection = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");
            Statement statement = connection.createStatement();
            
            String query = ""SELECT * FROM users WHERE username = '"" + userInput + ""'"";
            ResultSet resultSet = statement.executeQuery(query);

            while (resultSet.next()) {
                System.out.println(""Username: "" + resultSet.getString(""username""));
            }

        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.*; public class VulnerableCode { public static void main(String[] args) { String userInput = ""'; DROP TABLE users; --""; try { Connection connection = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); Statement statement = connection.createStatement(); String query = ""SELECT * FROM users WHERE username = '"" + userInput + ""'""; ResultSet resultSet = statement.executeQuery(query); while (resultSet.next()) { System.out.println(""Username: "" + resultSet.getString(""username"")); } } catch (SQLException e) { e.printStackTrace(); } } }",java,1
Buffer Overflow,"import java.util.Scanner;

public class BufferOverflowVulnerability {

    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        
        System.out.print(""Enter a string: "");
        String userInput = scanner.nextLine();
        
        char[] buffer = new char[10]; // Fixed size buffer
        
        // Copy user input into buffer without proper bounds checking
        for (int i = 0; i < userInput.length(); i++) {
            buffer[i] = userInput.charAt(i);
        }
        
        System.out.println(""Buffer contents: "" + new String(buffer));
    }
}","import java.util.Scanner; public class BufferOverflowVulnerability { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter a string: ""); String userInput = scanner.nextLine(); char[] buffer = new char[10]; // Fixed size buffer // Copy user input into buffer without proper bounds checking for (int i = 0; i < userInput.length(); i++) { buffer[i] = userInput.charAt(i); } System.out.println(""Buffer contents: "" + new String(buffer)); } }",java,1
Command Injection,"const shell = require('child_process');
shell.exec('ping ' + userInput); // Command Injection
","const shell = require('child_process');
shell.exec('ping ' + userInput); // Command Injection
",javascript,1
Clear,"To fix the XSS vulnerability in the provided Java code, you should properly escape user input before including it in the output HTML. Here's an updated version of the code that uses OWASP's ESAPI library for input validation and output encoding to prevent XSS attacks:

```java
import org.owasp.esapi.ESAPI;
import org.owasp.esapi.errors.EncodingException;

import java.io.IOException;
import java.io.PrintWriter;

public class XSSSecureCode {

    public static void main(String[] args) {
        String userInput = ""<script>alert('XSS Vulnerability!')</script>"";

        // Properly handle user input with ESAPI encoding to prevent XSS
        String sanitizedInput = """";
        try {
            sanitizedInput = ESAPI.encoder().encodeForHTML(userInput);
        } catch (EncodingException e) {
            System.out.println(""Error sanitizing user input: "" + e.getMessage());
            return;
        }

        String output = ""<p>Welcome, "" + sanitizedInput + ""</p>"";

        try {
            PrintWriter writer = new PrintWriter(""output.html"", ""UTF-8"");
            writer.println(output);
            writer.close();
        } catch (IOException e) {
            System.out.println(""Error writing output file: "" + e","To fix the XSS vulnerability in the provided Java code, you should properly escape user input before including it in the output HTML. Here's an updated version of the code that uses OWASP's ESAPI library for input validation and output encoding to prevent XSS attacks: ```java import org.owasp.esapi.ESAPI; import org.owasp.esapi.errors.EncodingException; import java.io.IOException; import java.io.PrintWriter; public class XSSSecureCode { public static void main(String[] args) { String userInput = ""<script>alert('XSS Vulnerability!')</script>""; // Properly handle user input with ESAPI encoding to prevent XSS String sanitizedInput = """"; try { sanitizedInput = ESAPI.encoder().encodeForHTML(userInput); } catch (EncodingException e) { System.out.println(""Error sanitizing user input: "" + e.getMessage()); return; } String output = ""<p>Welcome, "" + sanitizedInput + ""</p>""; try { PrintWriter writer = new PrintWriter(""output.html"", ""UTF-8""); writer.println(output); writer.close(); } catch (IOException e) { System.out.println(""Error writing output file: "" + e",java,0
Clear,"To fix the Path Traversal vulnerability in the given Java code snippet, you should not directly use user input for constructing the file path. Instead, you should validate and sanitize the user input to prevent any malicious attempts to access files outside of the intended directory.

Here is an updated version of the code that includes proper security measures:

```java
import java.io.File;
import java.io.FileInputStream;
import java.io.IOException;

public class SecureFileRead {

    public static void main(String[] args) {
        if (args.length < 1) {
            System.out.println(""Please provide a file name as an argument."");
            return;
        }

        String fileName = args[0];
        // Define a base directory to restrict file access
        String baseDirectory = ""/path/to/secure/directory/"";

        try {
            File file = new File(baseDirectory + fileName);
            // Check if the file path is within the base directory
            if (!file.getCanonicalPath().startsWith(new File(baseDirectory).getCanonicalPath())) {
                System.out.println(""Accessing files outside of the permitted directory is not allowed."");
                return;
            }

            FileInputStream fis = new FileInputStream(file);

            int content;
            while ((content = fis.read()) != -","To fix the Path Traversal vulnerability in the given Java code snippet, you should not directly use user input for constructing the file path. Instead, you should validate and sanitize the user input to prevent any malicious attempts to access files outside of the intended directory. Here is an updated version of the code that includes proper security measures: ```java import java.io.File; import java.io.FileInputStream; import java.io.IOException; public class SecureFileRead { public static void main(String[] args) { if (args.length < 1) { System.out.println(""Please provide a file name as an argument.""); return; } String fileName = args[0]; // Define a base directory to restrict file access String baseDirectory = ""/path/to/secure/directory/""; try { File file = new File(baseDirectory + fileName); // Check if the file path is within the base directory if (!file.getCanonicalPath().startsWith(new File(baseDirectory).getCanonicalPath())) { System.out.println(""Accessing files outside of the permitted directory is not allowed.""); return; } FileInputStream fis = new FileInputStream(file); int content; while ((content = fis.read()) != -",java,0
Command Injection,"import os
def backup_database(db_name):
    os.system(f""pg_dump {db_name} > backup.sql"")","import os
def backup_database(db_name):
    os.system(f""pg_dump {db_name} > backup.sql"")",python,1
SQL Injection,"import java.sql.*;

public class SQLInjectionExample {

    public static void main(String[] args) {
        String userInput = ""'; DROP TABLE users; --"";
        
        try {
            Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");
            Statement stmt = conn.createStatement();
            
            String query = ""SELECT * FROM users WHERE username = '"" + userInput + ""'"";
            ResultSet rs = stmt.executeQuery(query);
            
            while (rs.next()) {
                System.out.println(""Username: "" + rs.getString(""username""));
                System.out.println(""Password: "" + rs.getString(""password""));
            }
            
            conn.close();
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.*; public class SQLInjectionExample { public static void main(String[] args) { String userInput = ""'; DROP TABLE users; --""; try { Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); Statement stmt = conn.createStatement(); String query = ""SELECT * FROM users WHERE username = '"" + userInput + ""'""; ResultSet rs = stmt.executeQuery(query); while (rs.next()) { System.out.println(""Username: "" + rs.getString(""username"")); System.out.println(""Password: "" + rs.getString(""password"")); } conn.close(); } catch (SQLException e) { e.printStackTrace(); } } }",java,1
Clear,"#include <stdio.h>
#include <stdlib.h>

int safe_string_to_int(const char *str) {
    char *endptr;
    long value = strtol(str, &endptr, 10);
    if (*endptr != '\0' || str == endptr) {
        return -1; // error
    }
    return (int)value;
}","#include <stdio.h>
#include <stdlib.h>

int safe_string_to_int(const char *str) {
    char *endptr;
    long value = strtol(str, &endptr, 10);
    if (*endptr != '\0' || str == endptr) {
        return -1; // error
    }
    return (int)value;
}",c,0
Clear,"import java.util.Scanner;

public class SecureBuffer {
    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        
        System.out.print(""Enter a string: "");
        String input = scanner.nextLine();
        
        // Buffer size is fixed to 10
        char[] buffer = new char[10]; 
        
        // Copy a safe portion of user input into the buffer
        int copyLength = Math.min(input.length(), buffer.length);
        input.getChars(0, copyLength, buffer, 0);
        
        System.out.println(""Buffer content: "" + new String(buffer));
    }
}","import java.util.Scanner; public class SecureBuffer { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter a string: ""); String input = scanner.nextLine(); // Buffer size is fixed to 10 char[] buffer = new char[10]; // Copy a safe portion of user input into the buffer int copyLength = Math.min(input.length(), buffer.length); input.getChars(0, copyLength, buffer, 0); System.out.println(""Buffer content: "" + new String(buffer)); } }",java,0
Clear,"app.get('/user/:id', (req, res) => {
    const userId = parseInt(req.params.id);
    db.query('SELECT * FROM users WHERE id = ?', [userId], (err, result) => {
        res.json(result);
    });
});
","app.get('/user/:id', (req, res) => {
    const userId = parseInt(req.params.id);
    db.query('SELECT * FROM users WHERE id = ?', [userId], (err, result) => {
        res.json(result);
    });
});
",javascript,0
Clear,"To fix the Command Injection vulnerability in the provided Java code snippet, you should properly sanitize and validate the user input before using it to construct the command to be executed. Here is an improved version of the code that uses a ProcessBuilder with a list of arguments instead of directly concatenating user input into the command string:

```java
import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;
import java.util.ArrayList;
import java.util.List;

public class SafeCommandExecutionExample {

    public static void main(String[] args) {
        try {
            BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));
            System.out.print(""Enter a command to execute: "");
            String userInput = reader.readLine();

            // Split user input into command and arguments
            String[] commandParts = userInput.split(""\\s+"");
            
            // Construct the list of command and arguments
            List<String> commandList = new ArrayList<>();
            commandList.add(""ping"");
            for (String part : commandParts) {
                commandList.add(part);
            }

            // Execute the safe command using ProcessBuilder
            ProcessBuilder processBuilder = new ProcessBuilder(commandList);
            Process process = processBuilder.start();

            BufferedReader processOutputReader = new BufferedReader(new InputStreamReader(process.getInputStream","To fix the Command Injection vulnerability in the provided Java code snippet, you should properly sanitize and validate the user input before using it to construct the command to be executed. Here is an improved version of the code that uses a ProcessBuilder with a list of arguments instead of directly concatenating user input into the command string: ```java import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; import java.util.ArrayList; import java.util.List; public class SafeCommandExecutionExample { public static void main(String[] args) { try { BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a command to execute: ""); String userInput = reader.readLine(); // Split user input into command and arguments String[] commandParts = userInput.split(""\\s+""); // Construct the list of command and arguments List<String> commandList = new ArrayList<>(); commandList.add(""ping""); for (String part : commandParts) { commandList.add(part); } // Execute the safe command using ProcessBuilder ProcessBuilder processBuilder = new ProcessBuilder(commandList); Process process = processBuilder.start(); BufferedReader processOutputReader = new BufferedReader(new InputStreamReader(process.getInputStream",java,0
Clear,"app.get('/user/:id', (req, res) => {
    const userId = parseInt(req.params.id);
    db.query('SELECT * FROM users WHERE id = ?', [userId], (err, result) => {
        res.json(result);
    });
});
","app.get('/user/:id', (req, res) => {
    const userId = parseInt(req.params.id);
    db.query('SELECT * FROM users WHERE id = ?', [userId], (err, result) => {
        res.json(result);
    });
});
",javascript,0
Clear,"<?php
$message = htmlspecialchars($_GET['message'], ENT_QUOTES, 'UTF-8');
echo $message; // Sanitized output
?>","<?php
$message = htmlspecialchars($_GET['message'], ENT_QUOTES, 'UTF-8');
echo $message; // Sanitized output
?>",php,0
Clear,"#include <stdio.h>
#include <string.h>

int validate_input(const char *input) {
    if (input == NULL) return 0;
    for (int i = 0; input[i] != '\0'; i++) {
        if (input[i] < 32 || input[i] > 126) {
            return 0; // invalid character
        }
    }
    return 1;
}","#include <stdio.h>
#include <string.h>

int validate_input(const char *input) {
    if (input == NULL) return 0;
    for (int i = 0; input[i] != '\0'; i++) {
        if (input[i] < 32 || input[i] > 126) {
            return 0; // invalid character
        }
    }
    return 1;
}",c,0
Command Injection,"import subprocess
def list_directory(path):
    result = subprocess.run(f""ls {path}"", shell=True, capture_output=True, text=True)
    return result.stdout","import subprocess
def list_directory(path):
    result = subprocess.run(f""ls {path}"", shell=True, capture_output=True, text=True)
    return result.stdout",python,1
Hardcoded Secrets,"DATABASE_PASSWORD = ""my_super_secret_password_123""
def db_connect():
    import psycopg2
    return psycopg2.connect(f""dbname=test user=admin password={DATABASE_PASSWORD}"")","DATABASE_PASSWORD = ""my_super_secret_password_123""
def db_connect():
    import psycopg2
    return psycopg2.connect(f""dbname=test user=admin password={DATABASE_PASSWORD}"")",python,1
Clear,"app.get('/user/:id', (req, res) => {
    const userId = parseInt(req.params.id);
    db.query('SELECT * FROM users WHERE id = ?', [userId], (err, result) => {
        res.json(result);
    });
});
","app.get('/user/:id', (req, res) => {
    const userId = parseInt(req.params.id);
    db.query('SELECT * FROM users WHERE id = ?', [userId], (err, result) => {
        res.json(result);
    });
});
",javascript,0
Clear,"#include <stdio.h>
#include <string.h>

int validate_input(const char *input) {
    if (input == NULL) return 0;
    for (int i = 0; input[i] != '\0'; i++) {
        if (input[i] < 32 || input[i] > 126) {
            return 0; // invalid character
        }
    }
    return 1;
}","#include <stdio.h>
#include <string.h>

int validate_input(const char *input) {
    if (input == NULL) return 0;
    for (int i = 0; input[i] != '\0'; i++) {
        if (input[i] < 32 || input[i] > 126) {
            return 0; // invalid character
        }
    }
    return 1;
}",c,0
Clear,"const token = process.env.API_TOKEN; // Environment variable
fetch('/api/data', {
    headers: { 'Authorization': `Bearer ${token}` }
});
","const token = process.env.API_TOKEN; // Environment variable
fetch('/api/data', {
    headers: { 'Authorization': `Bearer ${token}` }
});
",javascript,0
Clear,"import java.sql.*;

public class SecureCode {

    public static void main(String[] args) {
        String userInput = ""'; DROP TABLE users; --""; // User input with malicious SQL injection payload

        try {
            Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");

            String query = ""SELECT * FROM users WHERE username = ?"";
            PreparedStatement stmt = conn.prepareStatement(query);
            stmt.setString(1, userInput);

            ResultSet rs = stmt.executeQuery();

            while (rs.next()) {
                System.out.println(""Username: "" + rs.getString(""username""));
                System.out.println(""Password: "" + rs.getString(""password""));
            }

            conn.close();
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.*; public class SecureCode { public static void main(String[] args) { String userInput = ""'; DROP TABLE users; --""; // User input with malicious SQL injection payload try { Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); String query = ""SELECT * FROM users WHERE username = ?""; PreparedStatement stmt = conn.prepareStatement(query); stmt.setString(1, userInput); ResultSet rs = stmt.executeQuery(); while (rs.next()) { System.out.println(""Username: "" + rs.getString(""username"")); System.out.println(""Password: "" + rs.getString(""password"")); } conn.close(); } catch (SQLException e) { e.printStackTrace(); } } }",java,0
Clear,"import java.io.*;

public class XSSFixedCode {
    public static void main(String[] args) {
        BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));
        
        System.out.println(""Enter your name: "");
        
        try {
            String userInput = reader.readLine();
            String sanitizedInput = sanitizeInput(userInput);
            System.out.println(""Hello, "" + sanitizedInput + ""!"");
        } catch (IOException e) {
            e.printStackTrace();
        }
    }

    private static String sanitizeInput(String input) {
        // Replace potentially harmful characters with safe characters
        return input.replaceAll(""<"", ""&lt;"")
                    .replaceAll("">"", ""&gt;"")
                    .replaceAll(""&"", ""&amp;"");
    }
}","import java.io.*; public class XSSFixedCode { public static void main(String[] args) { BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); System.out.println(""Enter your name: ""); try { String userInput = reader.readLine(); String sanitizedInput = sanitizeInput(userInput); System.out.println(""Hello, "" + sanitizedInput + ""!""); } catch (IOException e) { e.printStackTrace(); } } private static String sanitizeInput(String input) { // Replace potentially harmful characters with safe characters return input.replaceAll(""<"", ""&lt;"") .replaceAll("">"", ""&gt;"") .replaceAll(""&"", ""&amp;""); } }",java,0
Command Injection,"import os
def ping_host(host):
    os.system(""ping -c 4 "" + host)","import os
def ping_host(host):
    os.system(""ping -c 4 "" + host)",python,1
Clear,"import os
def safe_read_file(filename):
    base_path = '/var/www/uploads/'
    full_path = os.path.join(base_path, filename)
    full_path = os.path.normpath(full_path)
    if not full_path.startswith(base_path):
        raise ValueError(""Path traversal detected"")
    with open(full_path, 'r') as f:
        return f.read()","import os
def safe_read_file(filename):
    base_path = '/var/www/uploads/'
    full_path = os.path.join(base_path, filename)
    full_path = os.path.normpath(full_path)
    if not full_path.startswith(base_path):
        raise ValueError(""Path traversal detected"")
    with open(full_path, 'r') as f:
        return f.read()",python,0
Clear,"To fix the Path Traversal vulnerability in the provided Java code snippet, you should validate and sanitize the user input to prevent malicious file path manipulation. Here's an improved version of the code that includes proper security measures:

```java
import java.io.File;
import java.io.IOException;
import java.nio.file.Files;
import java.util.Scanner;

public class SecurePathTraversal {

    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        
        System.out.print(""Enter file name: "");
        String fileName = scanner.nextLine();

        if (!isValidFileName(fileName)) {
            System.err.println(""Invalid file name."");
            return;
        }

        File file = new File(""C:/data/"" + fileName); // Safely concatenate user input into the file path

        try {
            byte[] fileContent = Files.readAllBytes(file.toPath());
            System.out.println(""File content: "" + new String(fileContent));
        } catch (IOException e) {
            System.err.println(""Error reading file: "" + e.getMessage());
        }
    }

    private static boolean isValidFileName(String fileName) {
        // Implement proper validation logic based on your application requirements
        // Example: restrict certain characters or patterns, limit length,","To fix the Path Traversal vulnerability in the provided Java code snippet, you should validate and sanitize the user input to prevent malicious file path manipulation. Here's an improved version of the code that includes proper security measures: ```java import java.io.File; import java.io.IOException; import java.nio.file.Files; import java.util.Scanner; public class SecurePathTraversal { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter file name: ""); String fileName = scanner.nextLine(); if (!isValidFileName(fileName)) { System.err.println(""Invalid file name.""); return; } File file = new File(""C:/data/"" + fileName); // Safely concatenate user input into the file path try { byte[] fileContent = Files.readAllBytes(file.toPath()); System.out.println(""File content: "" + new String(fileContent)); } catch (IOException e) { System.err.println(""Error reading file: "" + e.getMessage()); } } private static boolean isValidFileName(String fileName) { // Implement proper validation logic based on your application requirements // Example: restrict certain characters or patterns, limit length,",java,0
Clear,"import jwt
import os
from datetime import datetime, timedelta

def create_safe_token(user_id):
    payload = {
        'user_id': user_id,
        'exp': datetime.utcnow() + timedelta(hours=1)
    }
    secret = os.environ.get('JWT_SECRET')
    return jwt.encode(payload, secret, algorithm='HS256')","import jwt
import os
from datetime import datetime, timedelta

def create_safe_token(user_id):
    payload = {
        'user_id': user_id,
        'exp': datetime.utcnow() + timedelta(hours=1)
    }
    secret = os.environ.get('JWT_SECRET')
    return jwt.encode(payload, secret, algorithm='HS256')",python,0
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Buffer Overflow,"import java.util.Scanner;

public class BufferOverflowVulnerability {
    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        System.out.print(""Enter a string: "");
        String userInput = scanner.nextLine();

        // This vulnerable code does not perform any input validation or size checking
        char[] buffer = new char[10];
        userInput.getChars(0, userInput.length(), buffer, 0);

        System.out.println(""Buffer content: "" + new String(buffer));
    }
}","import java.util.Scanner; public class BufferOverflowVulnerability { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter a string: ""); String userInput = scanner.nextLine(); // This vulnerable code does not perform any input validation or size checking char[] buffer = new char[10]; userInput.getChars(0, userInput.length(), buffer, 0); System.out.println(""Buffer content: "" + new String(buffer)); } }",java,1
Command Injection,"import java.io.*;

public class CommandInjectionVulnerable {
    public static void main(String[] args) {
        try {
            BufferedReader br = new BufferedReader(new InputStreamReader(System.in));
            System.out.print(""Enter a command to execute: "");
            String command = br.readLine();

            // Vulnerable code where user input is directly passed to the command execution
            Process process = Runtime.getRuntime().exec(command);

            BufferedReader reader = new BufferedReader(new InputStreamReader(process.getInputStream()));
            String line;
            while ((line = reader.readLine()) != null) {
                System.out.println(line);
            }
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}","import java.io.*; public class CommandInjectionVulnerable { public static void main(String[] args) { try { BufferedReader br = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a command to execute: ""); String command = br.readLine(); // Vulnerable code where user input is directly passed to the command execution Process process = Runtime.getRuntime().exec(command); BufferedReader reader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = reader.readLine()) != null) { System.out.println(line); } } catch (IOException e) { e.printStackTrace(); } } }",java,1
Cross-Site Scripting (XSS),"import java.io.IOException;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

public class XSSVulnerableServlet extends HttpServlet {
    
    protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        String userInput = request.getParameter(""input"");
        
        // Vulnerable code: directly outputting user input without proper validation or encoding
        response.getWriter().println(""User input: "" + userInput);
    }
}","import java.io.IOException; import javax.servlet.http.HttpServletRequest; import javax.servlet.http.HttpServletResponse; public class XSSVulnerableServlet extends HttpServlet { protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { String userInput = request.getParameter(""input""); // Vulnerable code: directly outputting user input without proper validation or encoding response.getWriter().println(""User input: "" + userInput); } }",java,1
Clear,"import java.util.Scanner;

public class SecureBuffer {
    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        
        System.out.print(""Enter a string: "");
        String userInput = scanner.nextLine();
        
        // Using dynamic-sized buffer to prevent buffer overflow
        char[] buffer = new char[userInput.length()];
        userInput.getChars(0, userInput.length(), buffer, 0);
        
        System.out.println(""Buffer contents: "" + new String(buffer));
    }
}","import java.util.Scanner; public class SecureBuffer { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter a string: ""); String userInput = scanner.nextLine(); // Using dynamic-sized buffer to prevent buffer overflow char[] buffer = new char[userInput.length()]; userInput.getChars(0, userInput.length(), buffer, 0); System.out.println(""Buffer contents: "" + new String(buffer)); } }",java,0
Clear,"#include <stdio.h>
#include <stdlib.h>

int safe_string_to_int(const char *str) {
    char *endptr;
    long value = strtol(str, &endptr, 10);
    if (*endptr != '\0' || str == endptr) {
        return -1; // error
    }
    return (int)value;
}","#include <stdio.h>
#include <stdlib.h>

int safe_string_to_int(const char *str) {
    char *endptr;
    long value = strtol(str, &endptr, 10);
    if (*endptr != '\0' || str == endptr) {
        return -1; // error
    }
    return (int)value;
}",c,0
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Memory Corruption,"#include <iostream>

void unsafe_pointer_arithmetic(int* array, int size) {
    for (int i = 0; i <= size; i++) {
        std::cout << *(array + i) << std::endl; // potential out-of-bounds
    }
}","#include <iostream>

void unsafe_pointer_arithmetic(int* array, int size) {
    for (int i = 0; i <= size; i++) {
        std::cout << *(array + i) << std::endl; // potential out-of-bounds
    }
}",cpp,1
Clear,"import org.owasp.encoder.Encode;

public class XSSFixedCode {
    public static void main(String[] args) {
        // Simulating user input
        String userInput = ""<script>alert('XSS Vulnerability')</script>"";

        // Sanitizing and escaping user input using OWASP Java Encoder library
        String sanitizedInput = Encode.forHtml(userInput);

        // Outputting the sanitized input to prevent XSS attacks
        System.out.println(""Welcome, "" + sanitizedInput);
    }
}","import org.owasp.encoder.Encode; public class XSSFixedCode { public static void main(String[] args) { // Simulating user input String userInput = ""<script>alert('XSS Vulnerability')</script>""; // Sanitizing and escaping user input using OWASP Java Encoder library String sanitizedInput = Encode.forHtml(userInput); // Outputting the sanitized input to prevent XSS attacks System.out.println(""Welcome, "" + sanitizedInput); } }",java,0
Command Injection,"import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class CommandInjectionVulnerable {

    public static void main(String[] args) throws IOException {
        BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));
        
        System.out.print(""Enter the IP address to ping: "");
        String ipAddress = reader.readLine();
        
        // Vulnerable code - directly executing user input as a command
        Process p = Runtime.getRuntime().exec(""ping "" + ipAddress);
        
        BufferedReader inputReader = new BufferedReader(new InputStreamReader(p.getInputStream()));
        String line;
        
        while ((line = inputReader.readLine()) != null) {
            System.out.println(line);
        }
    }
}","import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class CommandInjectionVulnerable { public static void main(String[] args) throws IOException { BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter the IP address to ping: ""); String ipAddress = reader.readLine(); // Vulnerable code - directly executing user input as a command Process p = Runtime.getRuntime().exec(""ping "" + ipAddress); BufferedReader inputReader = new BufferedReader(new InputStreamReader(p.getInputStream())); String line; while ((line = inputReader.readLine()) != null) { System.out.println(line); } } }",java,1
Clear,"To fix the Path Traversal vulnerability in the provided Java code snippet, you should not directly use user input to construct file paths. Instead, you should validate and sanitize the user input to prevent malicious actors from accessing unintended files on the system.

Here is an improved version of the code with proper security measures:

```java
import java.io.File;
import java.io.FileInputStream;
import java.io.IOException;
import java.util.Scanner;

public class SecurePathTraversal {
    private static final String BASE_PATH = ""C:\\files\\""; // Define a base path to restrict file access

    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        System.out.print(""Enter file name: "");
        String fileName = scanner.nextLine();

        // Validate and sanitize user input
        if (!isValidFileName(fileName)) {
            System.out.println(""Invalid file name."");
            return;
        }

        try {
            File file = new File(BASE_PATH + fileName);
            if (!file.getCanonicalPath().startsWith(BASE_PATH)) {
                System.out.println(""Access denied."");
                return;
            }

            FileInputStream fis = new FileInputStream(file);

            int content;
            while ((content = fis.read()) != -1) {
                System.out.print((","To fix the Path Traversal vulnerability in the provided Java code snippet, you should not directly use user input to construct file paths. Instead, you should validate and sanitize the user input to prevent malicious actors from accessing unintended files on the system. Here is an improved version of the code with proper security measures: ```java import java.io.File; import java.io.FileInputStream; import java.io.IOException; import java.util.Scanner; public class SecurePathTraversal { private static final String BASE_PATH = ""C:\\files\\""; // Define a base path to restrict file access public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter file name: ""); String fileName = scanner.nextLine(); // Validate and sanitize user input if (!isValidFileName(fileName)) { System.out.println(""Invalid file name.""); return; } try { File file = new File(BASE_PATH + fileName); if (!file.getCanonicalPath().startsWith(BASE_PATH)) { System.out.println(""Access denied.""); return; } FileInputStream fis = new FileInputStream(file); int content; while ((content = fis.read()) != -1) { System.out.print((",java,0
Clear,"#include <iostream>
#include <sstream>

int safe_string_to_int(const std::string& str) {
    std::stringstream ss(str);
    int value;
    if (ss >> value) {
        return value;
    }
    throw std::invalid_argument(""Invalid integer"");
}","#include <iostream>
#include <sstream>

int safe_string_to_int(const std::string& str) {
    std::stringstream ss(str);
    int value;
    if (ss >> value) {
        return value;
    }
    throw std::invalid_argument(""Invalid integer"");
}",cpp,0
Command Injection,"const shell = require('child_process');
shell.exec('ping ' + userInput); // Command Injection
","const shell = require('child_process');
shell.exec('ping ' + userInput); // Command Injection
",javascript,1
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Clear,"<?php
$input = json_decode($_POST['data'], true); // Safe JSON parsing
if (json_last_error() === JSON_ERROR_NONE) {
    process_data($input);
}
?>","<?php
$input = json_decode($_POST['data'], true); // Safe JSON parsing
if (json_last_error() === JSON_ERROR_NONE) {
    process_data($input);
}
?>",php,0
Cross-Site Scripting (XSS),"import java.io.*;
import javax.servlet.*;
import javax.servlet.http.*;

public class VulnerableServlet extends HttpServlet {
    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        String userInput = request.getParameter(""input"");
        String output = ""<p>User input: "" + userInput + ""</p>"";

        response.setContentType(""text/html"");
        PrintWriter out = response.getWriter();
        out.println(output);
    }
}","import java.io.*; import javax.servlet.*; import javax.servlet.http.*; public class VulnerableServlet extends HttpServlet { protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { String userInput = request.getParameter(""input""); String output = ""<p>User input: "" + userInput + ""</p>""; response.setContentType(""text/html""); PrintWriter out = response.getWriter(); out.println(output); } }",java,1
Buffer Overflow,"import java.util.Scanner;

public class BufferOverflowExample {
    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        System.out.print(""Enter your name: "");
        String name = scanner.nextLine();
        
        char[] buffer = new char[10];
        name.getChars(0, name.length(), buffer, 0);
        
        System.out.println(""Hello, "" + new String(buffer));
    }
}","import java.util.Scanner; public class BufferOverflowExample { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter your name: ""); String name = scanner.nextLine(); char[] buffer = new char[10]; name.getChars(0, name.length(), buffer, 0); System.out.println(""Hello, "" + new String(buffer)); } }",java,1
Clear,"import hashlib
import os

def hash_password(password):
    salt = os.urandom(32)
    key = hashlib.pbkdf2_hmac('sha256', password.encode(), salt, 100000)
    return salt + key","import hashlib
import os

def hash_password(password):
    salt = os.urandom(32)
    key = hashlib.pbkdf2_hmac('sha256', password.encode(), salt, 100000)
    return salt + key",python,0
Clear,"#include <iostream>
#include <string>
#include <vector>

void safe_string_handling(const std::string& input) {
    std::string safe_copy = input;
    std::cout << safe_copy << std::endl;
}","#include <iostream>
#include <string>
#include <vector>

void safe_string_handling(const std::string& input) {
    std::string safe_copy = input;
    std::cout << safe_copy << std::endl;
}",cpp,0
Clear,"def safe_comment_display(comment_text):
    import html
    escaped_text = html.escape(comment_text)
    return f""<div class='comment'>{escaped_text}</div>"" ","def safe_comment_display(comment_text):
    import html
    escaped_text = html.escape(comment_text)
    return f""<div class='comment'>{escaped_text}</div>"" ",python,0
SQL Injection,"import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Statement;

public class SQLInjectionVulnerable {
    public static void main(String[] args) {
        String userInput = ""'; DROP TABLE users; --""; // Malicious input simulating SQL Injection

        try {
            Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");
            Statement stmt = conn.createStatement();

            String query = ""SELECT * FROM users WHERE username = '"" + userInput + ""'"";
            ResultSet rs = stmt.executeQuery(query);

            while (rs.next()) {
                System.out.println(""User: "" + rs.getString(""username"") + "", Email: "" + rs.getString(""email""));
            }

            rs.close();
            stmt.close();
            conn.close();
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.Connection; import java.sql.DriverManager; import java.sql.ResultSet; import java.sql.SQLException; import java.sql.Statement; public class SQLInjectionVulnerable { public static void main(String[] args) { String userInput = ""'; DROP TABLE users; --""; // Malicious input simulating SQL Injection try { Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); Statement stmt = conn.createStatement(); String query = ""SELECT * FROM users WHERE username = '"" + userInput + ""'""; ResultSet rs = stmt.executeQuery(query); while (rs.next()) { System.out.println(""User: "" + rs.getString(""username"") + "", Email: "" + rs.getString(""email"")); } rs.close(); stmt.close(); conn.close(); } catch (SQLException e) { e.printStackTrace(); } } }",java,1
Clear,"To fix the Path Traversal vulnerability in the provided Java code snippet, you can implement the following secure code generation practices:

1. **Use Paths and Path Resolution**:
Instead of directly concatenating user input with a base directory path, use `Paths.get()` to safely construct the file path. This helps to prevent path traversal attacks.

2. **Validate User Input**:
Validate user input to ensure that it contains only allowed characters and does not contain any directory traversal sequences like ""../"".

3. **Restrict Access**:
Ensure that the application only allows access to files within a specified directory or directories by using proper access controls.

Here is an updated version of the code snippet with these security measures implemented:

```java
import java.nio.file.Path;
import java.nio.file.Paths;
import java.nio.file.Files;
import java.io.IOException;
import java.util.Scanner;

public class SecurePathTraversal {

    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        System.out.print(""Enter file name: "");
        String fileName = scanner.next();

        try {
            // Validate user input and construct a safe file path
            Path filePath = Paths.get(""/path/to/directory/"", fileName).normalize().toAbsolutePath();","To fix the Path Traversal vulnerability in the provided Java code snippet, you can implement the following secure code generation practices: 1. **Use Paths and Path Resolution**: Instead of directly concatenating user input with a base directory path, use `Paths.get()` to safely construct the file path. This helps to prevent path traversal attacks. 2. **Validate User Input**: Validate user input to ensure that it contains only allowed characters and does not contain any directory traversal sequences like ""../"". 3. **Restrict Access**: Ensure that the application only allows access to files within a specified directory or directories by using proper access controls. Here is an updated version of the code snippet with these security measures implemented: ```java import java.nio.file.Path; import java.nio.file.Paths; import java.nio.file.Files; import java.io.IOException; import java.util.Scanner; public class SecurePathTraversal { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter file name: ""); String fileName = scanner.next(); try { // Validate user input and construct a safe file path Path filePath = Paths.get(""/path/to/directory/"", fileName).normalize().toAbsolutePath();",java,0
Clear,"#include <iostream>
#include <memory>

void safe_memory_management() {
    auto ptr = std::make_unique<int>(42);
    std::cout << *ptr << std::endl;
}","#include <iostream>
#include <memory>

void safe_memory_management() {
    auto ptr = std::make_unique<int>(42);
    std::cout << *ptr << std::endl;
}",cpp,0
Cross-Site Scripting (XSS),"import java.io.*;

public class XSSVulnerability {
    public static void main(String[] args) {
        try {
            BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));
            System.out.print(""Enter your name: "");
            String name = reader.readLine();

            // Improperly handling user input without proper sanitization
            System.out.println(""<p>Welcome, "" + name + ""!</p>"");
        } catch (IOException e) {
            System.err.println(""Error reading input."");
        }
    }
}","import java.io.*; public class XSSVulnerability { public static void main(String[] args) { try { BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter your name: ""); String name = reader.readLine(); // Improperly handling user input without proper sanitization System.out.println(""<p>Welcome, "" + name + ""!</p>""); } catch (IOException e) { System.err.println(""Error reading input.""); } } }",java,1
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Memory Corruption,"#include <iostream>

void unsafe_virtual_call() {
    // Potential vtable corruption vulnerability
    class Base {
    public:
        virtual void func() { std::cout << ""Base"" << std::endl; }
    };
    
    class Derived : public Base {
    public:
        void func() override { std::cout << ""Derived"" << std::endl; }
    };
}","#include <iostream>

void unsafe_virtual_call() {
    // Potential vtable corruption vulnerability
    class Base {
    public:
        virtual void func() { std::cout << ""Base"" << std::endl; }
    };
    
    class Derived : public Base {
    public:
        void func() override { std::cout << ""Derived"" << std::endl; }
    };
}",cpp,1
Clear,"#include <stdio.h>
#include <string.h>

void safe_string_copy(char *dest, const char *src, size_t dest_size) {
    if (dest_size > 0) {
        strncpy(dest, src, dest_size - 1);
        dest[dest_size - 1] = '\0';
    }
}","#include <stdio.h>
#include <string.h>

void safe_string_copy(char *dest, const char *src, size_t dest_size) {
    if (dest_size > 0) {
        strncpy(dest, src, dest_size - 1);
        dest[dest_size - 1] = '\0';
    }
}",c,0
File Inclusion,"<?php
$file = $_GET['file'];
include($file); // File Inclusion
?>","<?php
$file = $_GET['file'];
include($file); // File Inclusion
?>",php,1
Clear,"#include <stdio.h>
#include <string.h>

int validate_input(const char *input) {
    if (input == NULL) return 0;
    for (int i = 0; input[i] != '\0'; i++) {
        if (input[i] < 32 || input[i] > 126) {
            return 0; // invalid character
        }
    }
    return 1;
}","#include <stdio.h>
#include <string.h>

int validate_input(const char *input) {
    if (input == NULL) return 0;
    for (int i = 0; input[i] != '\0'; i++) {
        if (input[i] < 32 || input[i] > 126) {
            return 0; // invalid character
        }
    }
    return 1;
}",c,0
Clear,"import logging
def safe_log_user_action(user_id, action):
    logging.info(f""User {user_id} performed action: {action}"")","import logging
def safe_log_user_action(user_id, action):
    logging.info(f""User {user_id} performed action: {action}"")",python,0
SQL Injection,"import sqlite3
def get_user_data(username):
    conn = sqlite3.connect('database.db')
    cursor = conn.cursor()
    query = ""SELECT * FROM users WHERE username = '"" + username + ""'""
    cursor.execute(query)
    return cursor.fetchall()","import sqlite3
def get_user_data(username):
    conn = sqlite3.connect('database.db')
    cursor = conn.cursor()
    query = ""SELECT * FROM users WHERE username = '"" + username + ""'""
    cursor.execute(query)
    return cursor.fetchall()",python,1
Clear,"import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class SecureCommandExecution {

    public static void main(String[] args) {
        try {
            BufferedReader br = new BufferedReader(new InputStreamReader(System.in));
            System.out.print(""Enter a command to execute: "");
            String userInput = br.readLine();

            // Secure command execution using ProcessBuilder
            ProcessBuilder processBuilder = new ProcessBuilder();
            processBuilder.command(""sh"", ""-c"", userInput);
            
            Process process = processBuilder.start();

            BufferedReader reader = new BufferedReader(new InputStreamReader(process.getInputStream()));
            String line;
            while ((line = reader.readLine()) != null) {
                System.out.println(line);
            }
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}","import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class SecureCommandExecution { public static void main(String[] args) { try { BufferedReader br = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a command to execute: ""); String userInput = br.readLine(); // Secure command execution using ProcessBuilder ProcessBuilder processBuilder = new ProcessBuilder(); processBuilder.command(""sh"", ""-c"", userInput); Process process = processBuilder.start(); BufferedReader reader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = reader.readLine()) != null) { System.out.println(line); } } catch (IOException e) { e.printStackTrace(); } } }",java,0
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Clear,"#include <iostream>
#include <sstream>

int safe_string_to_int(const std::string& str) {
    std::stringstream ss(str);
    int value;
    if (ss >> value) {
        return value;
    }
    throw std::invalid_argument(""Invalid integer"");
}","#include <iostream>
#include <sstream>

int safe_string_to_int(const std::string& str) {
    std::stringstream ss(str);
    int value;
    if (ss >> value) {
        return value;
    }
    throw std::invalid_argument(""Invalid integer"");
}",cpp,0
Command Injection,"const shell = require('child_process');
shell.exec('ping ' + userInput); // Command Injection
","const shell = require('child_process');
shell.exec('ping ' + userInput); // Command Injection
",javascript,1
Memory Corruption,"#include <iostream>

void unsafe_pointer_arithmetic(int* array, int size) {
    for (int i = 0; i <= size; i++) {
        std::cout << *(array + i) << std::endl; // potential out-of-bounds
    }
}","#include <iostream>

void unsafe_pointer_arithmetic(int* array, int size) {
    for (int i = 0; i <= size; i++) {
        std::cout << *(array + i) << std::endl; // potential out-of-bounds
    }
}",cpp,1
Clear,"import java.io.*;

public class CommandInjectionDemo {

    public static void main(String[] args) {
        try {
            BufferedReader br = new BufferedReader(new InputStreamReader(System.in));
            System.out.print(""Enter a file name to display its contents: "");
            String fileName = br.readLine();

            // Secure code - validate user input to prevent command injection
            if (!fileName.matches(""[a-zA-Z0-9.-]+"")) {
                System.err.println(""Invalid file name"");
                return;
            }

            String[] command = {""/bin/cat"", fileName};
            Process process = new ProcessBuilder(command).start();

            BufferedReader reader = new BufferedReader(new InputStreamReader(process.getInputStream()));
            String line;
            while ((line = reader.readLine()) != null) {
                System.out.println(line);
            }
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}","import java.io.*; public class CommandInjectionDemo { public static void main(String[] args) { try { BufferedReader br = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a file name to display its contents: ""); String fileName = br.readLine(); // Secure code - validate user input to prevent command injection if (!fileName.matches(""[a-zA-Z0-9.-]+"")) { System.err.println(""Invalid file name""); return; } String[] command = {""/bin/cat"", fileName}; Process process = new ProcessBuilder(command).start(); BufferedReader reader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = reader.readLine()) != null) { System.out.println(line); } } catch (IOException e) { e.printStackTrace(); } } }",java,0
Command Injection,"import os
def backup_database(db_name):
    os.system(f""pg_dump {db_name} > backup.sql"")","import os
def backup_database(db_name):
    os.system(f""pg_dump {db_name} > backup.sql"")",python,1
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
SQL Injection,"app.get('/user/:id', (req, res) => {
    const query = `SELECT * FROM users WHERE id = ${req.params.id}`; // SQL Injection
    db.query(query, (err, result) => {
        res.json(result);
    });
});
","app.get('/user/:id', (req, res) => {
    const query = `SELECT * FROM users WHERE id = ${req.params.id}`; // SQL Injection
    db.query(query, (err, result) => {
        res.json(result);
    });
});
",javascript,1
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Clear,"#include <stdio.h>
#include <string.h>

int safe_buffer_operation(char *input) {
    char buffer[100];
    if (strlen(input) < sizeof(buffer)) {
        strcpy(buffer, input);
        return 0;
    }
    return -1; // buffer too small
}","#include <stdio.h>
#include <string.h>

int safe_buffer_operation(char *input) {
    char buffer[100];
    if (strlen(input) < sizeof(buffer)) {
        strcpy(buffer, input);
        return 0;
    }
    return -1; // buffer too small
}",c,0
Hardcoded Secrets,"localStorage.setItem('token', 'hardcoded-secret-token-123'); // Hardcoded secret
","localStorage.setItem('token', 'hardcoded-secret-token-123'); // Hardcoded secret
",javascript,1
Command Injection,"import subprocess
def list_directory(path):
    result = subprocess.run(f""ls {path}"", shell=True, capture_output=True, text=True)
    return result.stdout","import subprocess
def list_directory(path):
    result = subprocess.run(f""ls {path}"", shell=True, capture_output=True, text=True)
    return result.stdout",python,1
Command Injection,"<?php
$cmd = $_GET['cmd'];
system($cmd); // Command Injection
?>","<?php
$cmd = $_GET['cmd'];
system($cmd); // Command Injection
?>",php,1
Buffer Overflow,"#include <iostream>
#include <cstdio>

void unsafe_c_input() {
    char buffer[50];
    scanf(""%s"", buffer); // no length limit
    std::cout << buffer << std::endl;
}","#include <iostream>
#include <cstdio>

void unsafe_c_input() {
    char buffer[50];
    scanf(""%s"", buffer); // no length limit
    std::cout << buffer << std::endl;
}",cpp,1
Clear,"#include <iostream>
#include <memory>

void safe_memory_management() {
    auto ptr = std::make_unique<int>(42);
    std::cout << *ptr << std::endl;
}","#include <iostream>
#include <memory>

void safe_memory_management() {
    auto ptr = std::make_unique<int>(42);
    std::cout << *ptr << std::endl;
}",cpp,0
Clear,"#include <iostream>
#include <fstream>
#include <string>

void safe_file_reading(const std::string& filename) {
    std::ifstream file(filename);
    if (file.is_open()) {
        std::string line;
        while (std::getline(file, line)) {
            std::cout << line << std::endl;
        }
    }
}","#include <iostream>
#include <fstream>
#include <string>

void safe_file_reading(const std::string& filename) {
    std::ifstream file(filename);
    if (file.is_open()) {
        std::string line;
        while (std::getline(file, line)) {
            std::cout << line << std::endl;
        }
    }
}",cpp,0
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Clear,"#include <stdio.h>
#include <stdlib.h>

int safe_string_to_int(const char *str) {
    char *endptr;
    long value = strtol(str, &endptr, 10);
    if (*endptr != '\0' || str == endptr) {
        return -1; // error
    }
    return (int)value;
}","#include <stdio.h>
#include <stdlib.h>

int safe_string_to_int(const char *str) {
    char *endptr;
    long value = strtol(str, &endptr, 10);
    if (*endptr != '\0' || str == endptr) {
        return -1; // error
    }
    return (int)value;
}",c,0
SSRF,"import urllib.request
def download_file(file_url):
    return urllib.request.urlopen(file_url).read()","import urllib.request
def download_file(file_url):
    return urllib.request.urlopen(file_url).read()",python,1
Clear,"import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class CommandInjectionFixed {

    public static void main(String[] args) throws IOException {
        BufferedReader br = new BufferedReader(new InputStreamReader(System.in));

        System.out.print(""Enter a hostname to ping: "");
        String hostname = br.readLine();

        // Validate input to ensure it contains only allowed characters (in this case, alphanumeric characters and dots)
        if (!hostname.matches(""[a-zA-Z0-9.-]+"")) {
            System.out.println(""Invalid hostname provided. Only alphanumeric characters and dots are allowed."");
            return;
        }

        // Execute the ping command using ProcessBuilder with proper argument passing
        ProcessBuilder processBuilder = new ProcessBuilder(""ping"", ""-c"", ""3"", hostname);
        Process p = processBuilder.start();

        BufferedReader reader = new BufferedReader(new InputStreamReader(p.getInputStream()));
        String line;

        while ((line = reader.readLine()) != null) {
            System.out.println(line);
        }
    }
}","import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class CommandInjectionFixed { public static void main(String[] args) throws IOException { BufferedReader br = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a hostname to ping: ""); String hostname = br.readLine(); // Validate input to ensure it contains only allowed characters (in this case, alphanumeric characters and dots) if (!hostname.matches(""[a-zA-Z0-9.-]+"")) { System.out.println(""Invalid hostname provided. Only alphanumeric characters and dots are allowed.""); return; } // Execute the ping command using ProcessBuilder with proper argument passing ProcessBuilder processBuilder = new ProcessBuilder(""ping"", ""-c"", ""3"", hostname); Process p = processBuilder.start(); BufferedReader reader = new BufferedReader(new InputStreamReader(p.getInputStream())); String line; while ((line = reader.readLine()) != null) { System.out.println(line); } } }",java,0
Clear,"To fix the Command Injection vulnerability in the given Java code snippet, you need to ensure that user input is properly sanitized and validated before being used in executing system commands. One way to do this is by using ProcessBuilder class instead of directly calling Runtime.getRuntime().exec().

Here is an improved version of the code with proper security measures:

```java
import java.io.*;

public class CommandInjectionSecure {
    public static void main(String[] args) {
        try {
            BufferedReader br = new BufferedReader(new InputStreamReader(System.in));
            System.out.print(""Enter a file name to display: "");
            String fileName = br.readLine();

            // Validate user input
            if (!isValidFileName(fileName)) {
                System.out.println(""Invalid file name"");
                return;
            }

            // Secure code: Use ProcessBuilder to execute system command
            ProcessBuilder processBuilder = new ProcessBuilder(""cat"", fileName);
            processBuilder.redirectErrorStream(true);
            Process process = processBuilder.start();

            BufferedReader reader = new BufferedReader(new InputStreamReader(process.getInputStream()));
            String line;
            while ((line = reader.readLine()) != null) {
                System.out.println(line);
            }
        } catch (IOException e) {
            e.printStackTrace();
        }
    }

    // Validate file","To fix the Command Injection vulnerability in the given Java code snippet, you need to ensure that user input is properly sanitized and validated before being used in executing system commands. One way to do this is by using ProcessBuilder class instead of directly calling Runtime.getRuntime().exec(). Here is an improved version of the code with proper security measures: ```java import java.io.*; public class CommandInjectionSecure { public static void main(String[] args) { try { BufferedReader br = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a file name to display: ""); String fileName = br.readLine(); // Validate user input if (!isValidFileName(fileName)) { System.out.println(""Invalid file name""); return; } // Secure code: Use ProcessBuilder to execute system command ProcessBuilder processBuilder = new ProcessBuilder(""cat"", fileName); processBuilder.redirectErrorStream(true); Process process = processBuilder.start(); BufferedReader reader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = reader.readLine()) != null) { System.out.println(line); } } catch (IOException e) { e.printStackTrace(); } } // Validate file",java,0
Clear,"import java.io.IOException;
import java.io.PrintWriter;

import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

import org.owasp.esapi.ESAPI;
import org.owasp.esapi.errors.EncodingException;

public class XssSecureServlet extends HttpServlet {

    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws IOException {
        String userInput = request.getParameter(""input"");
        
        // Sanitize user input using ESAPI encoder
        String safeInput = """";
        try {
            safeInput = ESAPI.encoder().encodeForHTML(userInput);
        } catch (EncodingException e) {
            // Handle encoding exception
            e.printStackTrace();
        }

        String output = ""<h1>Welcome "" + safeInput + ""</h1>"";

        PrintWriter out = response.getWriter();
        out.println(output);
    }
}","import java.io.IOException; import java.io.PrintWriter; import javax.servlet.http.HttpServlet; import javax.servlet.http.HttpServletRequest; import javax.servlet.http.HttpServletResponse; import org.owasp.esapi.ESAPI; import org.owasp.esapi.errors.EncodingException; public class XssSecureServlet extends HttpServlet { protected void doGet(HttpServletRequest request, HttpServletResponse response) throws IOException { String userInput = request.getParameter(""input""); // Sanitize user input using ESAPI encoder String safeInput = """"; try { safeInput = ESAPI.encoder().encodeForHTML(userInput); } catch (EncodingException e) { // Handle encoding exception e.printStackTrace(); } String output = ""<h1>Welcome "" + safeInput + ""</h1>""; PrintWriter out = response.getWriter(); out.println(output); } }",java,0
Clear,"To fix the insecure deserialization vulnerability in the provided code snippet, you can implement the following security measures:

1. **Validate Input Data**: 
   - Before deserializing the data, validate it to ensure that it comes from a trusted source.
   - You can use cryptographic signatures or other integrity checks to verify the authenticity of the serialized data.

2. **Use Safe Deserialization Mechanisms**:
   - Avoid using `ObjectInputStream` directly for deserialization as it may lead to code execution vulnerabilities.
   - Use safer alternatives like JSON or XML deserialization libraries which have built-in protections against exploitation.

3. **Implement Whitelisting**:
   - Maintain a whitelist of allowed classes for deserialization and only deserialize objects of those classes.
   - This prevents attackers from injecting malicious classes during deserialization.

4. **Enable Security Manager**:
   - Configure a Security Manager with appropriate permissions to restrict actions performed by the deserialized objects.
   - Define a security policy that limits access to sensitive resources and operations.

5. **Sanitize Input Data**:
   - If you must deserialize untrusted data, sanitize it before deserialization to remove any potentially harmful content.
   
6. **Disable Java Object Serialization**:
    - Consider disabling","To fix the insecure deserialization vulnerability in the provided code snippet, you can implement the following security measures: 1. **Validate Input Data**: - Before deserializing the data, validate it to ensure that it comes from a trusted source. - You can use cryptographic signatures or other integrity checks to verify the authenticity of the serialized data. 2. **Use Safe Deserialization Mechanisms**: - Avoid using `ObjectInputStream` directly for deserialization as it may lead to code execution vulnerabilities. - Use safer alternatives like JSON or XML deserialization libraries which have built-in protections against exploitation. 3. **Implement Whitelisting**: - Maintain a whitelist of allowed classes for deserialization and only deserialize objects of those classes. - This prevents attackers from injecting malicious classes during deserialization. 4. **Enable Security Manager**: - Configure a Security Manager with appropriate permissions to restrict actions performed by the deserialized objects. - Define a security policy that limits access to sensitive resources and operations. 5. **Sanitize Input Data**: - If you must deserialize untrusted data, sanitize it before deserialization to remove any potentially harmful content. 6. **Disable Java Object Serialization**: - Consider disabling",php,0
Clear,"const userInput = new URLSearchParams(window.location.search).get('input');
const safeOutput = document.createElement('div');
safeOutput.textContent = userInput; // Safe DOM manipulation
document.body.appendChild(safeOutput);
","const userInput = new URLSearchParams(window.location.search).get('input');
const safeOutput = document.createElement('div');
safeOutput.textContent = userInput; // Safe DOM manipulation
document.body.appendChild(safeOutput);
",javascript,0
Clear,"String username = request.getParameter(""username"");
String password = request.getParameter(""password"");

// Use a prepared statement with parameterized query
String query = ""SELECT * FROM users WHERE username=? AND password=?"";
PreparedStatement preparedStatement = connection.prepareStatement(query);
preparedStatement.setString(1, username);
preparedStatement.setString(2, password);

ResultSet resultSet = preparedStatement.executeQuery();

while (resultSet.next()) {
    // Process the results
}","String username = request.getParameter(""username""); String password = request.getParameter(""password""); // Use a prepared statement with parameterized query String query = ""SELECT * FROM users WHERE username=? AND password=?""; PreparedStatement preparedStatement = connection.prepareStatement(query); preparedStatement.setString(1, username); preparedStatement.setString(2, password); ResultSet resultSet = preparedStatement.executeQuery(); while (resultSet.next()) { // Process the results }",php,0
Clear,"To fix the insecure deserialization issue in the given code snippet, you should implement proper security measures to prevent potential attacks like deserialization of malicious objects. Here are some steps you can take to secure the code:

1. **Validate input**: Instead of directly deserializing user input, you should validate and sanitize the input before deserialization. Ensure that the input comes from a trusted source and is not tampered with.

2. **Use a safe deserialization library**: Use a secure deserialization library like `Jackson` or `Gson` that provide mechanisms to prevent common deserialization vulnerabilities.

3. **Implement whitelisting**: Maintain a whitelist of allowed classes that can be deserialized. Restrict the deserialization process to only allow classes that are explicitly permitted.

4. **Enable security manager**: Implement a security manager and set appropriate permissions to restrict the operations that can be performed during deserialization.

5. **Handle exceptions securely**: Avoid catching generic exceptions like `IOException` and `ClassNotFoundException`. Handle specific exceptions separately and log them appropriately without revealing sensitive information.

6. **Avoid using default serialization**: If possible, use custom serialization mechanisms instead of relying on default Java serialization to have more control over the process.

Here is an updated version of the","To fix the insecure deserialization issue in the given code snippet, you should implement proper security measures to prevent potential attacks like deserialization of malicious objects. Here are some steps you can take to secure the code: 1. **Validate input**: Instead of directly deserializing user input, you should validate and sanitize the input before deserialization. Ensure that the input comes from a trusted source and is not tampered with. 2. **Use a safe deserialization library**: Use a secure deserialization library like `Jackson` or `Gson` that provide mechanisms to prevent common deserialization vulnerabilities. 3. **Implement whitelisting**: Maintain a whitelist of allowed classes that can be deserialized. Restrict the deserialization process to only allow classes that are explicitly permitted. 4. **Enable security manager**: Implement a security manager and set appropriate permissions to restrict the operations that can be performed during deserialization. 5. **Handle exceptions securely**: Avoid catching generic exceptions like `IOException` and `ClassNotFoundException`. Handle specific exceptions separately and log them appropriately without revealing sensitive information. 6. **Avoid using default serialization**: If possible, use custom serialization mechanisms instead of relying on default Java serialization to have more control over the process. Here is an updated version of the",php,0
Clear,"const userInput = new URLSearchParams(window.location.search).get('input');
const safeOutput = document.createElement('div');
safeOutput.textContent = userInput; // Safe DOM manipulation
document.body.appendChild(safeOutput);
","const userInput = new URLSearchParams(window.location.search).get('input');
const safeOutput = document.createElement('div');
safeOutput.textContent = userInput; // Safe DOM manipulation
document.body.appendChild(safeOutput);
",javascript,0
Cross-Site Scripting (XSS),"import java.io.IOException;
import javax.servlet.ServletException;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

public class VulnerableServlet extends HttpServlet {
    protected void doGet(HttpServletRequest request, HttpServletResponse response)
            throws ServletException, IOException {

        String userInput = request.getParameter(""input"");
        String output = ""<p>User input: "" + userInput + ""</p>"";

        response.getWriter().write(output);
    }
}","import java.io.IOException; import javax.servlet.ServletException; import javax.servlet.http.HttpServlet; import javax.servlet.http.HttpServletRequest; import javax.servlet.http.HttpServletResponse; public class VulnerableServlet extends HttpServlet { protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { String userInput = request.getParameter(""input""); String output = ""<p>User input: "" + userInput + ""</p>""; response.getWriter().write(output); } }",java,1
Clear,"def validate_input(input_str):
    if not isinstance(input_str, str):
        raise TypeError(""Input must be string"")
    if len(input_str) > 100:
        raise ValueError(""Input too long"")
    if '<script>' in input_str.lower():
        raise ValueError(""Invalid input"")
    return input_str.strip()","def validate_input(input_str):
    if not isinstance(input_str, str):
        raise TypeError(""Input must be string"")
    if len(input_str) > 100:
        raise ValueError(""Input too long"")
    if '<script>' in input_str.lower():
        raise ValueError(""Invalid input"")
    return input_str.strip()",python,0
Clear,"To secure the code against Path Traversal attacks, you should ensure that the input file name is properly sanitized and validated before constructing the file path. Here's an improved version of the code with proper security measures:

```java
import java.io.File;
import java.io.IOException;
import java.nio.file.Files;
import java.nio.file.Path;
import java.util.Scanner;

public class SecurePathTraversalExample {

    private static final String BASE_DIRECTORY = ""/path/to/directory/"";

    public static void main(String[] args) throws IOException {
        Scanner scanner = new Scanner(System.in);

        System.out.print(""Enter file name: "");
        String fileName = scanner.nextLine();

        if (isValidFileName(fileName)) {
            File file = new File(BASE_DIRECTORY + fileName);

            if (file.exists() && isFileInsideBaseDirectory(file.toPath())) {
                byte[] fileContent = Files.readAllBytes(file.toPath());
                String content = new String(fileContent);
                System.out.println(""File content:\n"" + content);
            } else {
                System.out.println(""File not found."");
            }
        } else {
            System.out.println(""Invalid file name."");
        }

        scanner.close();
    }

    private static boolean isValidFileName(String fileName) {","To secure the code against Path Traversal attacks, you should ensure that the input file name is properly sanitized and validated before constructing the file path. Here's an improved version of the code with proper security measures: ```java import java.io.File; import java.io.IOException; import java.nio.file.Files; import java.nio.file.Path; import java.util.Scanner; public class SecurePathTraversalExample { private static final String BASE_DIRECTORY = ""/path/to/directory/""; public static void main(String[] args) throws IOException { Scanner scanner = new Scanner(System.in); System.out.print(""Enter file name: ""); String fileName = scanner.nextLine(); if (isValidFileName(fileName)) { File file = new File(BASE_DIRECTORY + fileName); if (file.exists() && isFileInsideBaseDirectory(file.toPath())) { byte[] fileContent = Files.readAllBytes(file.toPath()); String content = new String(fileContent); System.out.println(""File content:\n"" + content); } else { System.out.println(""File not found.""); } } else { System.out.println(""Invalid file name.""); } scanner.close(); } private static boolean isValidFileName(String fileName) {",java,0
Clear,"To fix the Command Injection vulnerability in the provided Java code snippet, you should avoid directly passing user input to the shell command. Instead, you should properly sanitize and validate user input before executing any external commands. One way to achieve this is by using ProcessBuilder and providing the command and its arguments separately.

Here's an updated version of the code that addresses the Command Injection vulnerability:

```java
import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;
import java.util.ArrayList;
import java.util.List;

public class CommandInjectionFixed {
    public static void main(String[] args) {
        try {
            BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));
            System.out.print(""Enter a command to execute: "");
            String command = reader.readLine();

            List<String> commands = new ArrayList<>();
            // Split the user input into command and arguments
            commands.add(""ping"");
            commands.add(command);

            ProcessBuilder processBuilder = new ProcessBuilder(commands);
            Process process = processBuilder.start();

            BufferedReader inputReader = new BufferedReader(new InputStreamReader(process.getInputStream()));
            String line;
            while ((line = inputReader.readLine()) != null) {
                System.out.println(line);
            }

        } catch (IOException e) {
            e.printStackTrace","To fix the Command Injection vulnerability in the provided Java code snippet, you should avoid directly passing user input to the shell command. Instead, you should properly sanitize and validate user input before executing any external commands. One way to achieve this is by using ProcessBuilder and providing the command and its arguments separately. Here's an updated version of the code that addresses the Command Injection vulnerability: ```java import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; import java.util.ArrayList; import java.util.List; public class CommandInjectionFixed { public static void main(String[] args) { try { BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a command to execute: ""); String command = reader.readLine(); List<String> commands = new ArrayList<>(); // Split the user input into command and arguments commands.add(""ping""); commands.add(command); ProcessBuilder processBuilder = new ProcessBuilder(commands); Process process = processBuilder.start(); BufferedReader inputReader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = inputReader.readLine()) != null) { System.out.println(line); } } catch (IOException e) { e.printStackTrace",java,0
Buffer Overflow,"import java.util.Scanner;

public class BufferOverflowVulnerability {
    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        System.out.print(""Enter a string: "");
        String userInput = scanner.nextLine();

        // Vulnerable code - not checking the length of user input
        byte[] buffer = new byte[10];
        System.arraycopy(userInput.getBytes(), 0, buffer, 0, userInput.length());

        // This could potentially lead to buffer overflow if the user input is larger than the allocated buffer size
    }
}","import java.util.Scanner; public class BufferOverflowVulnerability { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter a string: ""); String userInput = scanner.nextLine(); // Vulnerable code - not checking the length of user input byte[] buffer = new byte[10]; System.arraycopy(userInput.getBytes(), 0, buffer, 0, userInput.length()); // This could potentially lead to buffer overflow if the user input is larger than the allocated buffer size } }",java,1
Cross-Site Scripting (XSS),"import java.io.*;
import javax.servlet.*;
import javax.servlet.http.*;

public class VulnerableServlet extends HttpServlet {
    protected void doPost(HttpServletRequest request, HttpServletResponse response)
            throws ServletException, IOException {
        
        String userInput = request.getParameter(""input"");
        
        // This line directly outputs user input to the response without proper sanitization
        response.getWriter().println(""<p>User input: "" + userInput + ""</p>"");
    }
}","import java.io.*; import javax.servlet.*; import javax.servlet.http.*; public class VulnerableServlet extends HttpServlet { protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { String userInput = request.getParameter(""input""); // This line directly outputs user input to the response without proper sanitization response.getWriter().println(""<p>User input: "" + userInput + ""</p>""); } }",java,1
Command Injection,"import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class CommandInjectionVulnerable {

    public static void main(String[] args) throws IOException {
        BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));
        System.out.print(""Enter a directory name: "");
        String input = reader.readLine();

        // Vulnerability: User input is directly concatenated into the command string
        String command = ""ls -l "" + input;

        Process process = Runtime.getRuntime().exec(command);
        BufferedReader processOutputReader = new BufferedReader(new InputStreamReader(process.getInputStream()));

        String line;
        while ((line = processOutputReader.readLine()) != null) {
            System.out.println(line);
        }
    }
}","import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class CommandInjectionVulnerable { public static void main(String[] args) throws IOException { BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a directory name: ""); String input = reader.readLine(); // Vulnerability: User input is directly concatenated into the command string String command = ""ls -l "" + input; Process process = Runtime.getRuntime().exec(command); BufferedReader processOutputReader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = processOutputReader.readLine()) != null) { System.out.println(line); } } }",java,1
Clear,"import java.io.*;
import javax.servlet.*;
import javax.servlet.http.*;
import org.owasp.encoder.Encode;

public class XSSFixedServlet extends HttpServlet {
    
    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        String userInput = request.getParameter(""input"");
        
        // Encode the user input before including it in the output HTML
        String encodedInput = Encode.forHtml(userInput);
        
        String output = ""<html><body>User input: "" + encodedInput + ""</body></html>"";
        
        response.setContentType(""text/html"");
        response.getWriter().write(output);
    }
}","import java.io.*; import javax.servlet.*; import javax.servlet.http.*; import org.owasp.encoder.Encode; public class XSSFixedServlet extends HttpServlet { protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { String userInput = request.getParameter(""input""); // Encode the user input before including it in the output HTML String encodedInput = Encode.forHtml(userInput); String output = ""<html><body>User input: "" + encodedInput + ""</body></html>""; response.setContentType(""text/html""); response.getWriter().write(output); } }",java,0
Clear,"app.get('/user/:id', (req, res) => {
    const userId = parseInt(req.params.id);
    db.query('SELECT * FROM users WHERE id = ?', [userId], (err, result) => {
        res.json(result);
    });
});
","app.get('/user/:id', (req, res) => {
    const userId = parseInt(req.params.id);
    db.query('SELECT * FROM users WHERE id = ?', [userId], (err, result) => {
        res.json(result);
    });
});
",javascript,0
Clear,"import os
def get_database_config():
    return {
        'host': os.environ.get('DB_HOST'),
        'user': os.environ.get('DB_USER'),
        'password': os.environ.get('DB_PASSWORD')
    }","import os
def get_database_config():
    return {
        'host': os.environ.get('DB_HOST'),
        'user': os.environ.get('DB_USER'),
        'password': os.environ.get('DB_PASSWORD')
    }",python,0
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Clear,"To fix the Path Traversal vulnerability in the provided Java code snippet, you should not directly concatenate user input with the directory path. Instead, you should validate and sanitize the user input to prevent any malicious attempts to access files outside of the intended directory.

Here's an improved version of the code with security measures implemented:

```java
import java.io.File;
import java.io.FileInputStream;
import java.io.IOException;

public class SecurePathTraversal {

    public static void main(String[] args) {
        if (args.length != 1) {
            System.out.println(""Usage: java SecurePathTraversal <file_name>"");
            return;
        }

        String fileName = args[0];
        
        if (!isValidFileName(fileName)) {
            System.out.println(""Invalid file name"");
            return;
        }

        try {
            File file = new File(""/path/to/directory/"" + fileName);
            
            if (!file.getCanonicalPath().startsWith(""/path/to/directory/"")) {
                System.out.println(""Accessing files outside permitted directory is not allowed."");
                return;
            }
            
            FileInputStream fis = new FileInputStream(file);
            byte[] data = new byte[(int) file.length()];
            fis.read(data);
            fis.close();
            System.out.println(new","To fix the Path Traversal vulnerability in the provided Java code snippet, you should not directly concatenate user input with the directory path. Instead, you should validate and sanitize the user input to prevent any malicious attempts to access files outside of the intended directory. Here's an improved version of the code with security measures implemented: ```java import java.io.File; import java.io.FileInputStream; import java.io.IOException; public class SecurePathTraversal { public static void main(String[] args) { if (args.length != 1) { System.out.println(""Usage: java SecurePathTraversal <file_name>""); return; } String fileName = args[0]; if (!isValidFileName(fileName)) { System.out.println(""Invalid file name""); return; } try { File file = new File(""/path/to/directory/"" + fileName); if (!file.getCanonicalPath().startsWith(""/path/to/directory/"")) { System.out.println(""Accessing files outside permitted directory is not allowed.""); return; } FileInputStream fis = new FileInputStream(file); byte[] data = new byte[(int) file.length()]; fis.read(data); fis.close(); System.out.println(new",java,0
Clear,"To fix the code and prevent Command Injection vulnerabilities, you should avoid directly concatenating user input with the command string passed to `Runtime.exec()`. Instead, you should use ProcessBuilder to safely execute external commands. Here's an updated and more secure version of your code:

```java
import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;
import java.util.ArrayList;
import java.util.List;

public class SecureCommandExecution {
    public static void main(String[] args) {
        try {
            // Accept user input
            BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));
            System.out.print(""Enter a command to execute: "");
            String userInput = reader.readLine();

            // Create a list to hold the command and its arguments
            List<String> command = new ArrayList<>();
            command.add(""ping"");
            command.add(userInput);

            // Execute the command using ProcessBuilder
            ProcessBuilder processBuilder = new ProcessBuilder(command);
            
            // Redirect error stream to output stream
            processBuilder.redirectErrorStream(true);

            // Start the process
            Process process = processBuilder.start();

            // Read and print the output of the command
            BufferedReader outputReader = new BufferedReader(new InputStreamReader(process.getInputStream()));
            
            String line","To fix the code and prevent Command Injection vulnerabilities, you should avoid directly concatenating user input with the command string passed to `Runtime.exec()`. Instead, you should use ProcessBuilder to safely execute external commands. Here's an updated and more secure version of your code: ```java import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; import java.util.ArrayList; import java.util.List; public class SecureCommandExecution { public static void main(String[] args) { try { // Accept user input BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a command to execute: ""); String userInput = reader.readLine(); // Create a list to hold the command and its arguments List<String> command = new ArrayList<>(); command.add(""ping""); command.add(userInput); // Execute the command using ProcessBuilder ProcessBuilder processBuilder = new ProcessBuilder(command); // Redirect error stream to output stream processBuilder.redirectErrorStream(true); // Start the process Process process = processBuilder.start(); // Read and print the output of the command BufferedReader outputReader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line",java,0
Clear,"import java.util.Scanner;

public class SecureBufferExample {
    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        
        System.out.print(""Enter a string: "");
        String input = scanner.nextLine();
        
        // Check if the input length exceeds the buffer size
        if (input.length() > 10) {
            System.out.println(""Input string is too long."");
            return;
        }
        
        char[] buffer = new char[10];
        
        // Copy input to buffer safely
        input.getChars(0, Math.min(input.length(), buffer.length), buffer, 0);
        
        System.out.println(""Buffer content: "" + new String(buffer));
    }
}","import java.util.Scanner; public class SecureBufferExample { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter a string: ""); String input = scanner.nextLine(); // Check if the input length exceeds the buffer size if (input.length() > 10) { System.out.println(""Input string is too long.""); return; } char[] buffer = new char[10]; // Copy input to buffer safely input.getChars(0, Math.min(input.length(), buffer.length), buffer, 0); System.out.println(""Buffer content: "" + new String(buffer)); } }",java,0
Memory Corruption,"#include <iostream>

void unsafe_virtual_call() {
    // Potential vtable corruption vulnerability
    class Base {
    public:
        virtual void func() { std::cout << ""Base"" << std::endl; }
    };
    
    class Derived : public Base {
    public:
        void func() override { std::cout << ""Derived"" << std::endl; }
    };
}","#include <iostream>

void unsafe_virtual_call() {
    // Potential vtable corruption vulnerability
    class Base {
    public:
        virtual void func() { std::cout << ""Base"" << std::endl; }
    };
    
    class Derived : public Base {
    public:
        void func() override { std::cout << ""Derived"" << std::endl; }
    };
}",cpp,1
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
SSRF,"import requests
def fetch_url(url):
    return requests.get(url).text","import requests
def fetch_url(url):
    return requests.get(url).text",python,1
Clear,"const shell = require('child_process');
const safeInput = userInput.replace(/[^a-zA-Z0-9.]/g, '');
shell.execFile('ping', [safeInput]); // Safe command execution
","const shell = require('child_process');
const safeInput = userInput.replace(/[^a-zA-Z0-9.]/g, '');
shell.execFile('ping', [safeInput]); // Safe command execution
",javascript,0
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Clear,"#include <iostream>
#include <string>
#include <vector>

void safe_string_handling(const std::string& input) {
    std::string safe_copy = input;
    std::cout << safe_copy << std::endl;
}","#include <iostream>
#include <string>
#include <vector>

void safe_string_handling(const std::string& input) {
    std::string safe_copy = input;
    std::cout << safe_copy << std::endl;
}",cpp,0
Clear,"#include <stdio.h>
#include <stdlib.h>

void safe_file_operation(const char *filename) {
    FILE *file = fopen(filename, ""r"");
    if (file != NULL) {
        char buffer[256];
        while (fgets(buffer, sizeof(buffer), file)) {
            printf(""%s"", buffer);
        }
        fclose(file);
    }
}","#include <stdio.h>
#include <stdlib.h>

void safe_file_operation(const char *filename) {
    FILE *file = fopen(filename, ""r"");
    if (file != NULL) {
        char buffer[256];
        while (fgets(buffer, sizeof(buffer), file)) {
            printf(""%s"", buffer);
        }
        fclose(file);
    }
}",c,0
Clear,"#include <iostream>
#include <vector>
#include <stdexcept>

int safe_vector_access(const std::vector<int>& vec, size_t index) {
    if (index >= vec.size()) {
        throw std::out_of_range(""Index out of range"");
    }
    return vec[index];
}","#include <iostream>
#include <vector>
#include <stdexcept>

int safe_vector_access(const std::vector<int>& vec, size_t index) {
    if (index >= vec.size()) {
        throw std::out_of_range(""Index out of range"");
    }
    return vec[index];
}",cpp,0
Clear,"To fix the XSS vulnerability in the provided Java code, you should properly validate and encode the user input before outputting it to the response. Here's an improved version of the code that implements these security measures:

```java
import java.io.IOException;
import java.io.PrintWriter;
import javax.servlet.ServletException;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

public class SecureServlet extends HttpServlet {

    @Override
    protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        String userInput = request.getParameter(""input"");
        
        // Validate and sanitize user input to prevent XSS
        String sanitizedInput = sanitizeInput(userInput);
        
        response.setContentType(""text/html"");
        PrintWriter out = response.getWriter();
        out.println(""<html><body>"");
        out.println(""<h1>User Input:</h1>"");
        out.println(sanitizedInput); // Safe output after sanitization
        out.println(""</body></html>"");
    }
    
    private String sanitizeInput(String input) {
        // Implement proper validation and encoding here based on your application's requirements
        // For example, you can use OWASP Java Encoder library to HTML encode the input
        return org.owasp.encoder.Encode.forHtml(input","To fix the XSS vulnerability in the provided Java code, you should properly validate and encode the user input before outputting it to the response. Here's an improved version of the code that implements these security measures: ```java import java.io.IOException; import java.io.PrintWriter; import javax.servlet.ServletException; import javax.servlet.http.HttpServlet; import javax.servlet.http.HttpServletRequest; import javax.servlet.http.HttpServletResponse; public class SecureServlet extends HttpServlet { @Override protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { String userInput = request.getParameter(""input""); // Validate and sanitize user input to prevent XSS String sanitizedInput = sanitizeInput(userInput); response.setContentType(""text/html""); PrintWriter out = response.getWriter(); out.println(""<html><body>""); out.println(""<h1>User Input:</h1>""); out.println(sanitizedInput); // Safe output after sanitization out.println(""</body></html>""); } private String sanitizeInput(String input) { // Implement proper validation and encoding here based on your application's requirements // For example, you can use OWASP Java Encoder library to HTML encode the input return org.owasp.encoder.Encode.forHtml(input",java,0
Clear,"import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;
import java.util.ArrayList;
import java.util.List;

public class SecureCommandExecution {
    public static void main(String[] args) {
        try {
            System.out.print(""Enter a file name to display its contents: "");
            BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));
            String fileName = reader.readLine();

            List<String> command = new ArrayList<>();
            command.add(""cat"");
            command.add(fileName);

            ProcessBuilder processBuilder = new ProcessBuilder(command);
            Process process = processBuilder.start();

            BufferedReader outputReader = new BufferedReader(new InputStreamReader(process.getInputStream()));

            String line;
            while ((line = outputReader.readLine()) != null) {
                System.out.println(line);
            }

        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}","import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; import java.util.ArrayList; import java.util.List; public class SecureCommandExecution { public static void main(String[] args) { try { System.out.print(""Enter a file name to display its contents: ""); BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); String fileName = reader.readLine(); List<String> command = new ArrayList<>(); command.add(""cat""); command.add(fileName); ProcessBuilder processBuilder = new ProcessBuilder(command); Process process = processBuilder.start(); BufferedReader outputReader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = outputReader.readLine()) != null) { System.out.println(line); } } catch (IOException e) { e.printStackTrace(); } } }",java,0
Insecure Deserialization,"import pickle
def load_user_data(filename):
    with open(filename, 'rb') as f:
        data = pickle.load(f)
    return data","import pickle
def load_user_data(filename):
    with open(filename, 'rb') as f:
        data = pickle.load(f)
    return data",python,1
Clear,"#include <stdio.h>
#include <stdlib.h>

int safe_string_to_int(const char *str) {
    char *endptr;
    long value = strtol(str, &endptr, 10);
    if (*endptr != '\0' || str == endptr) {
        return -1; // error
    }
    return (int)value;
}","#include <stdio.h>
#include <stdlib.h>

int safe_string_to_int(const char *str) {
    char *endptr;
    long value = strtol(str, &endptr, 10);
    if (*endptr != '\0' || str == endptr) {
        return -1; // error
    }
    return (int)value;
}",c,0
Memory Corruption,"#include <iostream>

void unsafe_pointer_arithmetic(int* array, int size) {
    for (int i = 0; i <= size; i++) {
        std::cout << *(array + i) << std::endl; // potential out-of-bounds
    }
}","#include <iostream>

void unsafe_pointer_arithmetic(int* array, int size) {
    for (int i = 0; i <= size; i++) {
        std::cout << *(array + i) << std::endl; // potential out-of-bounds
    }
}",cpp,1
Command Injection,"const shell = require('child_process');
shell.exec('ping ' + userInput); // Command Injection
","const shell = require('child_process');
shell.exec('ping ' + userInput); // Command Injection
",javascript,1
Hardcoded Secrets,"import requests
def call_api():
    api_key = ""sk_live_1234567890abcdef""
    headers = {'Authorization': f'Bearer {api_key}'}
    return requests.get('https://api.example.com/data', headers=headers)","import requests
def call_api():
    api_key = ""sk_live_1234567890abcdef""
    headers = {'Authorization': f'Bearer {api_key}'}
    return requests.get('https://api.example.com/data', headers=headers)",python,1
SQL Injection,"import java.sql.*;

public class VulnerableCode {

    public static void main(String[] args) {
        String userInput = ""admin'; DROP TABLE users; --"";
        String query = ""SELECT * FROM users WHERE username = '"" + userInput + ""'"";

        try {
            Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/database"", ""username"", ""password"");
            Statement stmt = conn.createStatement();
            ResultSet rs = stmt.executeQuery(query);

            while (rs.next()) {
                System.out.println(rs.getString(""username""));
            }

            conn.close();
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.*; public class VulnerableCode { public static void main(String[] args) { String userInput = ""admin'; DROP TABLE users; --""; String query = ""SELECT * FROM users WHERE username = '"" + userInput + ""'""; try { Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/database"", ""username"", ""password""); Statement stmt = conn.createStatement(); ResultSet rs = stmt.executeQuery(query); while (rs.next()) { System.out.println(rs.getString(""username"")); } conn.close(); } catch (SQLException e) { e.printStackTrace(); } } }",java,1
Memory Corruption,"#include <iostream>

void unsafe_pointer_arithmetic(int* array, int size) {
    for (int i = 0; i <= size; i++) {
        std::cout << *(array + i) << std::endl; // potential out-of-bounds
    }
}","#include <iostream>

void unsafe_pointer_arithmetic(int* array, int size) {
    for (int i = 0; i <= size; i++) {
        std::cout << *(array + i) << std::endl; // potential out-of-bounds
    }
}",cpp,1
Cross-Site Scripting (XSS),"import java.io.*;
import javax.servlet.*;
import javax.servlet.http.*;

public class VulnerableServlet extends HttpServlet {
    protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        String userInput = request.getParameter(""input"");
        PrintWriter out = response.getWriter();
        
        out.println(""<html>"");
        out.println(""<body>"");
        out.println(""<h1>Hello, "" + userInput + ""</h1>""); // Vulnerability: User input directly inserted into the HTML response
        out.println(""</body>"");
        out.println(""</html>"");
    }
}","import java.io.*; import javax.servlet.*; import javax.servlet.http.*; public class VulnerableServlet extends HttpServlet { protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { String userInput = request.getParameter(""input""); PrintWriter out = response.getWriter(); out.println(""<html>""); out.println(""<body>""); out.println(""<h1>Hello, "" + userInput + ""</h1>""); // Vulnerability: User input directly inserted into the HTML response out.println(""</body>""); out.println(""</html>""); } }",java,1
Clear,"const userData = JSON.parse(userInput); // Safe JSON parsing
if (userData && typeof userData === 'object') {
    processUserData(userData);
}
","const userData = JSON.parse(userInput); // Safe JSON parsing
if (userData && typeof userData === 'object') {
    processUserData(userData);
}
",javascript,0
XSS,"<?php
echo $_GET['message']; // XSS
?>","<?php
echo $_GET['message']; // XSS
?>",php,1
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Out-of-Bounds,"#include <iostream>

class UnsafeClass {
    int data[10];
public:
    int get_data(int index) {
        return data[index]; // no bounds checking
    }
};","#include <iostream>

class UnsafeClass {
    int data[10];
public:
    int get_data(int index) {
        return data[index]; // no bounds checking
    }
};",cpp,1
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Clear,"import pickle
def safe_deserialize(data):
    allowed_classes = {'SafeClass', 'AnotherSafeClass'}
    return pickle.loads(data)","import pickle
def safe_deserialize(data):
    allowed_classes = {'SafeClass', 'AnotherSafeClass'}
    return pickle.loads(data)",python,0
Clear,"import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class CommandInjectionSecure {
    public static void main(String[] args) throws IOException {
        BufferedReader br = new BufferedReader(new InputStreamReader(System.in));

        System.out.print(""Enter a command to execute: "");
        String command = br.readLine();

        // Secure code: using ProcessBuilder to safely execute the command
        ProcessBuilder processBuilder = new ProcessBuilder(command);
        Process process = processBuilder.start();

        BufferedReader reader = new BufferedReader(new InputStreamReader(process.getInputStream()));
        String line;

        while ((line = reader.readLine()) != null) {
            System.out.println(line);
        }
    }
}","import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class CommandInjectionSecure { public static void main(String[] args) throws IOException { BufferedReader br = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a command to execute: ""); String command = br.readLine(); // Secure code: using ProcessBuilder to safely execute the command ProcessBuilder processBuilder = new ProcessBuilder(command); Process process = processBuilder.start(); BufferedReader reader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = reader.readLine()) != null) { System.out.println(line); } } }",java,0
SQL Injection,"app.get('/user/:id', (req, res) => {
    const query = `SELECT * FROM users WHERE id = ${req.params.id}`; // SQL Injection
    db.query(query, (err, result) => {
        res.json(result);
    });
});
","app.get('/user/:id', (req, res) => {
    const query = `SELECT * FROM users WHERE id = ${req.params.id}`; // SQL Injection
    db.query(query, (err, result) => {
        res.json(result);
    });
});
",javascript,1
SQL Injection,"import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Statement;

public class SQLInjectionVulnerability {

    public static void main(String[] args) {
        String userInput = ""'; DROP TABLE users; --"";

        try {
            Connection connection = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");
            Statement statement = connection.createStatement();

            // Vulnerable query concatenating user input directly
            String query = ""SELECT * FROM users WHERE username='"" + userInput + ""'"";
            
            ResultSet resultSet = statement.executeQuery(query);

            while (resultSet.next()) {
                System.out.println(resultSet.getString(""username""));
            }

        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.Connection; import java.sql.DriverManager; import java.sql.ResultSet; import java.sql.SQLException; import java.sql.Statement; public class SQLInjectionVulnerability { public static void main(String[] args) { String userInput = ""'; DROP TABLE users; --""; try { Connection connection = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); Statement statement = connection.createStatement(); // Vulnerable query concatenating user input directly String query = ""SELECT * FROM users WHERE username='"" + userInput + ""'""; ResultSet resultSet = statement.executeQuery(query); while (resultSet.next()) { System.out.println(resultSet.getString(""username"")); } } catch (SQLException e) { e.printStackTrace(); } } }",java,1
Clear,"To fix the Buffer Overflow vulnerability in the provided Java code snippet, you can follow these steps:

1. Limit the input size to prevent buffer overflow:
   - Define a maximum size for the input string to ensure that it does not exceed the buffer size.
   - Validate the length of the user input before copying it into the buffer.

2. Use safe methods to copy input into the buffer:
   - Instead of directly using `getChars()` method, use `Arrays.copyOf` or `System.arraycopy` to safely copy a portion of the user input into the buffer.
   
3. Avoid using fixed-size buffers:
   - Use dynamic data structures like `StringBuilder` or `ArrayList` to store and manipulate user input without worrying about fixed-size buffers.

Here is an updated version of your code with these security measures implemented:

```java
import java.util.Scanner;
import java.util.Arrays;

public class SecureBuffer {
    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);

        System.out.print(""Enter a string: "");
        String userInput = scanner.nextLine();

        // Limiting the input size to prevent buffer overflow
        int bufferSize = Math.min(userInput.length(), 10);
        
        char[] buffer = new","To fix the Buffer Overflow vulnerability in the provided Java code snippet, you can follow these steps: 1. Limit the input size to prevent buffer overflow: - Define a maximum size for the input string to ensure that it does not exceed the buffer size. - Validate the length of the user input before copying it into the buffer. 2. Use safe methods to copy input into the buffer: - Instead of directly using `getChars()` method, use `Arrays.copyOf` or `System.arraycopy` to safely copy a portion of the user input into the buffer. 3. Avoid using fixed-size buffers: - Use dynamic data structures like `StringBuilder` or `ArrayList` to store and manipulate user input without worrying about fixed-size buffers. Here is an updated version of your code with these security measures implemented: ```java import java.util.Scanner; import java.util.Arrays; public class SecureBuffer { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter a string: ""); String userInput = scanner.nextLine(); // Limiting the input size to prevent buffer overflow int bufferSize = Math.min(userInput.length(), 10); char[] buffer = new",java,0
Clear,"import jwt
import os
from datetime import datetime, timedelta

def create_safe_token(user_id):
    payload = {
        'user_id': user_id,
        'exp': datetime.utcnow() + timedelta(hours=1)
    }
    secret = os.environ.get('JWT_SECRET')
    return jwt.encode(payload, secret, algorithm='HS256')","import jwt
import os
from datetime import datetime, timedelta

def create_safe_token(user_id):
    payload = {
        'user_id': user_id,
        'exp': datetime.utcnow() + timedelta(hours=1)
    }
    secret = os.environ.get('JWT_SECRET')
    return jwt.encode(payload, secret, algorithm='HS256')",python,0
Cross-Site Scripting (XSS),"import java.io.*;

public class XSSVulnerableCode {
    public static void main(String[] args) {
        // Simulating user input, which is not properly sanitized
        String userInput = ""<script>alert('XSS attack!')</script>"";
        
        // Improperly handling user input by directly outputting it to a webpage
        System.out.println(""<div>"" + userInput + ""</div>"");
    }
}","import java.io.*; public class XSSVulnerableCode { public static void main(String[] args) { // Simulating user input, which is not properly sanitized String userInput = ""<script>alert('XSS attack!')</script>""; // Improperly handling user input by directly outputting it to a webpage System.out.println(""<div>"" + userInput + ""</div>""); } }",java,1
Path Traversal,"import java.io.File;
import java.io.IOException;
import java.nio.file.Files;
import java.nio.file.Paths;

public class PathTraversalVulnerability {

    public static void main(String[] args) {
        String userInput = ""../etc/passwd"";
        String directory = ""/var/www/html/data/"";

        String fullPath = directory + userInput;

        try {
            File file = new File(fullPath);
            byte[] fileContent = Files.readAllBytes(Paths.get(file.getPath()));
            System.out.println(new String(fileContent));
        } catch (IOException e) {
            System.out.println(""Error reading file: "" + e.getMessage());
        }
    }
}","import java.io.File; import java.io.IOException; import java.nio.file.Files; import java.nio.file.Paths; public class PathTraversalVulnerability { public static void main(String[] args) { String userInput = ""../etc/passwd""; String directory = ""/var/www/html/data/""; String fullPath = directory + userInput; try { File file = new File(fullPath); byte[] fileContent = Files.readAllBytes(Paths.get(file.getPath())); System.out.println(new String(fileContent)); } catch (IOException e) { System.out.println(""Error reading file: "" + e.getMessage()); } } }",java,1
Clear,"import java.io.IOException;
import java.io.PrintWriter;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import org.owasp.encoder.Encode;

public class XSSSecureServlet extends HttpServlet {
    
    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws IOException {
        String userInput = request.getParameter(""input"");
        
        PrintWriter out = response.getWriter();
        out.println(""<html><body>"");
        out.println(""User Input: "" + Encode.forHtml(userInput)); // Properly encode user input using OWASP Java Encoder
        out.println(""</body></html>"");
    }
}","import java.io.IOException; import java.io.PrintWriter; import javax.servlet.http.HttpServlet; import javax.servlet.http.HttpServletRequest; import javax.servlet.http.HttpServletResponse; import org.owasp.encoder.Encode; public class XSSSecureServlet extends HttpServlet { protected void doGet(HttpServletRequest request, HttpServletResponse response) throws IOException { String userInput = request.getParameter(""input""); PrintWriter out = response.getWriter(); out.println(""<html><body>""); out.println(""User Input: "" + Encode.forHtml(userInput)); // Properly encode user input using OWASP Java Encoder out.println(""</body></html>""); } }",java,0
Clear,"import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class CommandInjectionExample {

    public static void main(String[] args) {
        try {
            BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));
            System.out.print(""Enter a command to execute: "");
            String command = reader.readLine();

            // Separate the command and its arguments
            String[] cmdArray = {""ping"", command};

            ProcessBuilder processBuilder = new ProcessBuilder(cmdArray);
            Process process = processBuilder.start();

            BufferedReader inputReader = new BufferedReader(new InputStreamReader(process.getInputStream()));
            String inputLine;
            while ((inputLine = inputReader.readLine()) != null) {
                System.out.println(inputLine);
            }
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}","import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class CommandInjectionExample { public static void main(String[] args) { try { BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a command to execute: ""); String command = reader.readLine(); // Separate the command and its arguments String[] cmdArray = {""ping"", command}; ProcessBuilder processBuilder = new ProcessBuilder(cmdArray); Process process = processBuilder.start(); BufferedReader inputReader = new BufferedReader(new InputStreamReader(process.getInputStream())); String inputLine; while ((inputLine = inputReader.readLine()) != null) { System.out.println(inputLine); } } catch (IOException e) { e.printStackTrace(); } } }",java,0
Cross-Site Scripting (XSS),"def display_comment(comment_text):
    return f""<div class='comment'>{comment_text}</div>"" ","def display_comment(comment_text):
    return f""<div class='comment'>{comment_text}</div>"" ",python,1
Clear,"import java.util.Scanner;

public class SecureBufferExample {

    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);

        System.out.print(""Enter a string: "");
        String input = scanner.nextLine();

        // Creating a fixed-size char array with length 10
        char[] buffer = new char[10];
        
        // Check if input length exceeds buffer size
        if (input.length() > buffer.length) {
            System.out.println(""Input exceeds buffer size. Please enter a shorter string."");
            return;
        }
        
        // Copying the user input into the buffer
        input.getChars(0, input.length(), buffer, 0);

        System.out.println(""Buffer contents: "" + String.valueOf(buffer));
    }
}","import java.util.Scanner; public class SecureBufferExample { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter a string: ""); String input = scanner.nextLine(); // Creating a fixed-size char array with length 10 char[] buffer = new char[10]; // Check if input length exceeds buffer size if (input.length() > buffer.length) { System.out.println(""Input exceeds buffer size. Please enter a shorter string.""); return; } // Copying the user input into the buffer input.getChars(0, input.length(), buffer, 0); System.out.println(""Buffer contents: "" + String.valueOf(buffer)); } }",java,0
Clear,"import java.sql.*;

public class SecureSQLQuery {

    public static void main(String[] args) {
        String userInput = ""'; DROP TABLE users; --""; // Malicious input

        try {
            Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");

            // Use a PreparedStatement with parameterized query
            String query = ""SELECT * FROM users WHERE username = ?"";
            PreparedStatement stmt = conn.prepareStatement(query);
            stmt.setString(1, userInput);

            ResultSet rs = stmt.executeQuery();

            while (rs.next()) {
                System.out.println(""User found: "" + rs.getString(""username""));
            }

            rs.close();
            stmt.close();
            conn.close();

        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.*; public class SecureSQLQuery { public static void main(String[] args) { String userInput = ""'; DROP TABLE users; --""; // Malicious input try { Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); // Use a PreparedStatement with parameterized query String query = ""SELECT * FROM users WHERE username = ?""; PreparedStatement stmt = conn.prepareStatement(query); stmt.setString(1, userInput); ResultSet rs = stmt.executeQuery(); while (rs.next()) { System.out.println(""User found: "" + rs.getString(""username"")); } rs.close(); stmt.close(); conn.close(); } catch (SQLException e) { e.printStackTrace(); } } }",java,0
Clear,"import psycopg2
def safe_admin_query(admin_id):
    conn = psycopg2.connect(""dbname=test user=postgres"")
    cur = conn.cursor()
    cur.execute(""SELECT * FROM admins WHERE id = %s"", (admin_id,))
    return cur.fetchone()","import psycopg2
def safe_admin_query(admin_id):
    conn = psycopg2.connect(""dbname=test user=postgres"")
    cur = conn.cursor()
    cur.execute(""SELECT * FROM admins WHERE id = %s"", (admin_id,))
    return cur.fetchone()",python,0
Hardcoded Secrets,"localStorage.setItem('token', 'hardcoded-secret-token-123'); // Hardcoded secret
","localStorage.setItem('token', 'hardcoded-secret-token-123'); // Hardcoded secret
",javascript,1
Code Injection,"const userData = eval('(' + userInput + ')'); // eval injection
","const userData = eval('(' + userInput + ')'); // eval injection
",javascript,1
SQL Injection,"app.get('/user/:id', (req, res) => {
    const query = `SELECT * FROM users WHERE id = ${req.params.id}`; // SQL Injection
    db.query(query, (err, result) => {
        res.json(result);
    });
});
","app.get('/user/:id', (req, res) => {
    const query = `SELECT * FROM users WHERE id = ${req.params.id}`; // SQL Injection
    db.query(query, (err, result) => {
        res.json(result);
    });
});
",javascript,1
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Buffer Overflow,"import java.util.Scanner;

public class BufferOverflowExample {
    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        
        System.out.print(""Enter a string: "");
        String input = scanner.nextLine();
        
        // Creating a fixed-size buffer
        char[] buffer = new char[10];
        
        // Copying the user input into the buffer
        input.getChars(0, input.length(), buffer, 0);
        
        // Printing out the content of the buffer
        System.out.println(""Buffer content: "" + new String(buffer));
    }
}","import java.util.Scanner; public class BufferOverflowExample { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter a string: ""); String input = scanner.nextLine(); // Creating a fixed-size buffer char[] buffer = new char[10]; // Copying the user input into the buffer input.getChars(0, input.length(), buffer, 0); // Printing out the content of the buffer System.out.println(""Buffer content: "" + new String(buffer)); } }",java,1
Buffer Overflow,"#include <iostream>
#include <cstring>

void unsafe_c_string(char* input) {
    char buffer[100];
    strcpy(buffer, input); // potential buffer overflow
    std::cout << buffer << std::endl;
}","#include <iostream>
#include <cstring>

void unsafe_c_string(char* input) {
    char buffer[100];
    strcpy(buffer, input); // potential buffer overflow
    std::cout << buffer << std::endl;
}",cpp,1
File Inclusion,"<?php
$file = $_GET['file'];
include($file); // File Inclusion
?>","<?php
$file = $_GET['file'];
include($file); // File Inclusion
?>",php,1
Clear,"<?php
$input = json_decode($_POST['data'], true); // Safe JSON parsing
if (json_last_error() === JSON_ERROR_NONE) {
    process_data($input);
}
?>","<?php
$input = json_decode($_POST['data'], true); // Safe JSON parsing
if (json_last_error() === JSON_ERROR_NONE) {
    process_data($input);
}
?>",php,0
Clear,"#include <stdio.h>
#include <stdlib.h>

int safe_string_to_int(const char *str) {
    char *endptr;
    long value = strtol(str, &endptr, 10);
    if (*endptr != '\0' || str == endptr) {
        return -1; // error
    }
    return (int)value;
}","#include <stdio.h>
#include <stdlib.h>

int safe_string_to_int(const char *str) {
    char *endptr;
    long value = strtol(str, &endptr, 10);
    if (*endptr != '\0' || str == endptr) {
        return -1; // error
    }
    return (int)value;
}",c,0
Clear,"import java.util.Scanner;

public class SecureBuffer {

    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        System.out.print(""Enter a string: "");
        String userInput = scanner.nextLine();

        // Define a safe maximum buffer size
        int bufferSize = 10;
        
        // Truncate input if it exceeds buffer size
        if (userInput.length() > bufferSize) {
            userInput = userInput.substring(0, bufferSize);
        }

        char[] buffer = new char[bufferSize];
        userInput.getChars(0, userInput.length(), buffer, 0);

        System.out.println(""Buffer contents: "" + new String(buffer));
    }
}","import java.util.Scanner; public class SecureBuffer { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter a string: ""); String userInput = scanner.nextLine(); // Define a safe maximum buffer size int bufferSize = 10; // Truncate input if it exceeds buffer size if (userInput.length() > bufferSize) { userInput = userInput.substring(0, bufferSize); } char[] buffer = new char[bufferSize]; userInput.getChars(0, userInput.length(), buffer, 0); System.out.println(""Buffer contents: "" + new String(buffer)); } }",java,0
Hardcoded Secrets,"localStorage.setItem('token', 'hardcoded-secret-token-123'); // Hardcoded secret
","localStorage.setItem('token', 'hardcoded-secret-token-123'); // Hardcoded secret
",javascript,1
Path Traversal,"def get_user_file(username, filepath):
    import os
    base_path = f""/home/{username}/files/""
    full_path = base_path + filepath
    with open(full_path, 'r') as f:
        return f.read()","def get_user_file(username, filepath):
    import os
    base_path = f""/home/{username}/files/""
    full_path = base_path + filepath
    with open(full_path, 'r') as f:
        return f.read()",python,1
Command Injection,"import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class CommandInjectionVulnerable {

    public static void main(String[] args) throws IOException {
        BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));

        System.out.print(""Enter a command to execute: "");
        String command = reader.readLine();

        Process process = Runtime.getRuntime().exec(command);

        BufferedReader inputStreamReader = new BufferedReader(new InputStreamReader(process.getInputStream()));
        String line;
        while ((line = inputStreamReader.readLine()) != null) {
            System.out.println(line);
        }

    }
}","import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class CommandInjectionVulnerable { public static void main(String[] args) throws IOException { BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a command to execute: ""); String command = reader.readLine(); Process process = Runtime.getRuntime().exec(command); BufferedReader inputStreamReader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = inputStreamReader.readLine()) != null) { System.out.println(line); } } }",java,1
Clear,"const token = process.env.API_TOKEN; // Environment variable
fetch('/api/data', {
    headers: { 'Authorization': `Bearer ${token}` }
});
","const token = process.env.API_TOKEN; // Environment variable
fetch('/api/data', {
    headers: { 'Authorization': `Bearer ${token}` }
});
",javascript,0
Clear,"#include <iostream>
#include <fstream>
#include <string>

void safe_file_reading(const std::string& filename) {
    std::ifstream file(filename);
    if (file.is_open()) {
        std::string line;
        while (std::getline(file, line)) {
            std::cout << line << std::endl;
        }
    }
}","#include <iostream>
#include <fstream>
#include <string>

void safe_file_reading(const std::string& filename) {
    std::ifstream file(filename);
    if (file.is_open()) {
        std::string line;
        while (std::getline(file, line)) {
            std::cout << line << std::endl;
        }
    }
}",cpp,0
Buffer Overflow,"#include <iostream>
#include <cstdio>

void unsafe_c_input() {
    char buffer[50];
    scanf(""%s"", buffer); // no length limit
    std::cout << buffer << std::endl;
}","#include <iostream>
#include <cstdio>

void unsafe_c_input() {
    char buffer[50];
    scanf(""%s"", buffer); // no length limit
    std::cout << buffer << std::endl;
}",cpp,1
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Clear,"import subprocess
def safe_ping(host):
    import re
    if not re.match(r'^[a-zA-Z0-9.-]+$', host):
        raise ValueError(""Invalid host"")
    result = subprocess.run(['ping', '-c', '4', host], capture_output=True, text=True)
    return result.stdout","import subprocess
def safe_ping(host):
    import re
    if not re.match(r'^[a-zA-Z0-9.-]+$', host):
        raise ValueError(""Invalid host"")
    result = subprocess.run(['ping', '-c', '4', host], capture_output=True, text=True)
    return result.stdout",python,0
Buffer Overflow,"import java.util.Scanner;

public class BufferOverflowVulnerability {
    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);

        System.out.print(""Enter a string: "");
        String userInput = scanner.nextLine();

        char[] buffer = new char[10]; // Buffer of fixed size

        // Copy user input into buffer without proper bounds checking
        userInput.getChars(0, userInput.length(), buffer, 0);

        System.out.println(""Buffer content: "" + new String(buffer));

        scanner.close();
    }
}","import java.util.Scanner; public class BufferOverflowVulnerability { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter a string: ""); String userInput = scanner.nextLine(); char[] buffer = new char[10]; // Buffer of fixed size // Copy user input into buffer without proper bounds checking userInput.getChars(0, userInput.length(), buffer, 0); System.out.println(""Buffer content: "" + new String(buffer)); scanner.close(); } }",java,1
Memory Corruption,"#include <iostream>

void unsafe_virtual_call() {
    // Potential vtable corruption vulnerability
    class Base {
    public:
        virtual void func() { std::cout << ""Base"" << std::endl; }
    };
    
    class Derived : public Base {
    public:
        void func() override { std::cout << ""Derived"" << std::endl; }
    };
}","#include <iostream>

void unsafe_virtual_call() {
    // Potential vtable corruption vulnerability
    class Base {
    public:
        virtual void func() { std::cout << ""Base"" << std::endl; }
    };
    
    class Derived : public Base {
    public:
        void func() override { std::cout << ""Derived"" << std::endl; }
    };
}",cpp,1
Cross-Site Scripting (XSS),"def display_comment(comment_text):
    return f""<div class='comment'>{comment_text}</div>"" ","def display_comment(comment_text):
    return f""<div class='comment'>{comment_text}</div>"" ",python,1
Clear,"const userInput = new URLSearchParams(window.location.search).get('input');
const safeOutput = document.createElement('div');
safeOutput.textContent = userInput; // Safe DOM manipulation
document.body.appendChild(safeOutput);
","const userInput = new URLSearchParams(window.location.search).get('input');
const safeOutput = document.createElement('div');
safeOutput.textContent = userInput; // Safe DOM manipulation
document.body.appendChild(safeOutput);
",javascript,0
Clear,"import jwt
import os
from datetime import datetime, timedelta

def create_safe_token(user_id):
    payload = {
        'user_id': user_id,
        'exp': datetime.utcnow() + timedelta(hours=1)
    }
    secret = os.environ.get('JWT_SECRET')
    return jwt.encode(payload, secret, algorithm='HS256')","import jwt
import os
from datetime import datetime, timedelta

def create_safe_token(user_id):
    payload = {
        'user_id': user_id,
        'exp': datetime.utcnow() + timedelta(hours=1)
    }
    secret = os.environ.get('JWT_SECRET')
    return jwt.encode(payload, secret, algorithm='HS256')",python,0
SQL Injection,"import sqlite3
def get_user_data(username):
    conn = sqlite3.connect('database.db')
    cursor = conn.cursor()
    query = ""SELECT * FROM users WHERE username = '"" + username + ""'""
    cursor.execute(query)
    return cursor.fetchall()","import sqlite3
def get_user_data(username):
    conn = sqlite3.connect('database.db')
    cursor = conn.cursor()
    query = ""SELECT * FROM users WHERE username = '"" + username + ""'""
    cursor.execute(query)
    return cursor.fetchall()",python,1
Clear,"const userData = JSON.parse(userInput); // Safe JSON parsing
if (userData && typeof userData === 'object') {
    processUserData(userData);
}
","const userData = JSON.parse(userInput); // Safe JSON parsing
if (userData && typeof userData === 'object') {
    processUserData(userData);
}
",javascript,0
Clear,"import java.sql.*;

public class SecureSQLInjectionExample {

    public static void main(String[] args) {
        String userInput = ""'; DROP TABLE users; --""; // Malicious input

        try {
            Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");

            // Use PreparedStatement with parameters to avoid SQL injection
            String query = ""SELECT * FROM users WHERE username = ?"";
            PreparedStatement pstmt = conn.prepareStatement(query);
            pstmt.setString(1, userInput);

            ResultSet rs = pstmt.executeQuery();

            while (rs.next()) {
                System.out.println(rs.getString(""username""));
            }

            rs.close();
            pstmt.close();
            conn.close();
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.*; public class SecureSQLInjectionExample { public static void main(String[] args) { String userInput = ""'; DROP TABLE users; --""; // Malicious input try { Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); // Use PreparedStatement with parameters to avoid SQL injection String query = ""SELECT * FROM users WHERE username = ?""; PreparedStatement pstmt = conn.prepareStatement(query); pstmt.setString(1, userInput); ResultSet rs = pstmt.executeQuery(); while (rs.next()) { System.out.println(rs.getString(""username"")); } rs.close(); pstmt.close(); conn.close(); } catch (SQLException e) { e.printStackTrace(); } } }",java,0
Clear,"import jwt
import os
from datetime import datetime, timedelta

def create_safe_token(user_id):
    payload = {
        'user_id': user_id,
        'exp': datetime.utcnow() + timedelta(hours=1)
    }
    secret = os.environ.get('JWT_SECRET')
    return jwt.encode(payload, secret, algorithm='HS256')","import jwt
import os
from datetime import datetime, timedelta

def create_safe_token(user_id):
    payload = {
        'user_id': user_id,
        'exp': datetime.utcnow() + timedelta(hours=1)
    }
    secret = os.environ.get('JWT_SECRET')
    return jwt.encode(payload, secret, algorithm='HS256')",python,0
Cross-Site Scripting (XSS),"import java.io.*;
import java.util.*;

public class XSSVulnerableCode {
    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        
        System.out.print(""Enter your name: "");
        String userInput = scanner.nextLine();
        
        System.out.println(""Hello, "" + userInput + ""!""); // Vulnerability here
        
        scanner.close();
    }
}","import java.io.*; import java.util.*; public class XSSVulnerableCode { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter your name: ""); String userInput = scanner.nextLine(); System.out.println(""Hello, "" + userInput + ""!""); // Vulnerability here scanner.close(); } }",java,1
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Insecure Deserialization,"<?php
$data = $_POST['data'];
unserialize($data); // Insecure Deserialization
?>","<?php
$data = $_POST['data'];
unserialize($data); // Insecure Deserialization
?>",php,1
XSS,"const userInput = document.location.search.split('=')[1];
document.write(userInput); // XSS
","const userInput = document.location.search.split('=')[1];
document.write(userInput); // XSS
",javascript,1
Clear,"#include <iostream>
#include <memory>

void safe_memory_management() {
    auto ptr = std::make_unique<int>(42);
    std::cout << *ptr << std::endl;
}","#include <iostream>
#include <memory>

void safe_memory_management() {
    auto ptr = std::make_unique<int>(42);
    std::cout << *ptr << std::endl;
}",cpp,0
Clear,"To fix the security vulnerability related to Insecure Deserialization in the provided Java code snippet, you can implement the following secure code generation practices:

1. Use a whitelist approach: Instead of deserializing any object provided by the user, maintain a whitelist of allowed classes that can be safely deserialized. This restricts the types of objects that can be deserialized, preventing attackers from injecting malicious code.

2. Implement input validation: Validate the user input before deserializing it to ensure that it meets certain criteria or structure. For example, you can validate the input against a predefined schema or format before proceeding with deserialization.

3. Use a secure serialization format: Consider using safer serialization formats such as JSON or XML instead of Java serialization, which is prone to security vulnerabilities. These formats are more predictable and easier to validate.

4. Implement input sanitization: Sanitize the user input to remove any potentially dangerous content before deserializing it. This can help prevent attacks such as injection of arbitrary code or exploitation of vulnerabilities.

5. Apply encryption and integrity checks: Encrypt the serialized data before transmission and implement integrity checks (e.g., using digital signatures) to ensure that the data has not been tampered with during transit.

Here's an updated version","To fix the security vulnerability related to Insecure Deserialization in the provided Java code snippet, you can implement the following secure code generation practices: 1. Use a whitelist approach: Instead of deserializing any object provided by the user, maintain a whitelist of allowed classes that can be safely deserialized. This restricts the types of objects that can be deserialized, preventing attackers from injecting malicious code. 2. Implement input validation: Validate the user input before deserializing it to ensure that it meets certain criteria or structure. For example, you can validate the input against a predefined schema or format before proceeding with deserialization. 3. Use a secure serialization format: Consider using safer serialization formats such as JSON or XML instead of Java serialization, which is prone to security vulnerabilities. These formats are more predictable and easier to validate. 4. Implement input sanitization: Sanitize the user input to remove any potentially dangerous content before deserializing it. This can help prevent attacks such as injection of arbitrary code or exploitation of vulnerabilities. 5. Apply encryption and integrity checks: Encrypt the serialized data before transmission and implement integrity checks (e.g., using digital signatures) to ensure that the data has not been tampered with during transit. Here's an updated version",php,0
Clear,"#include <iostream>
#include <string>
#include <vector>

void safe_string_handling(const std::string& input) {
    std::string safe_copy = input;
    std::cout << safe_copy << std::endl;
}","#include <iostream>
#include <string>
#include <vector>

void safe_string_handling(const std::string& input) {
    std::string safe_copy = input;
    std::cout << safe_copy << std::endl;
}",cpp,0
Command Injection,"import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class CommandInjectionVulnerability {

    public static void main(String[] args) {
        try {
            BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));
            System.out.print(""Enter a command to execute: "");
            String userInput = reader.readLine();

            // Vulnerability: User input is directly passed to the command execution without proper validation
            Process process = Runtime.getRuntime().exec(""ping "" + userInput);

            BufferedReader outputReader = new BufferedReader(new InputStreamReader(process.getInputStream()));
            String outputLine;
            while ((outputLine = outputReader.readLine()) != null) {
                System.out.println(outputLine);
            }

        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}","import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class CommandInjectionVulnerability { public static void main(String[] args) { try { BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a command to execute: ""); String userInput = reader.readLine(); // Vulnerability: User input is directly passed to the command execution without proper validation Process process = Runtime.getRuntime().exec(""ping "" + userInput); BufferedReader outputReader = new BufferedReader(new InputStreamReader(process.getInputStream())); String outputLine; while ((outputLine = outputReader.readLine()) != null) { System.out.println(outputLine); } } catch (IOException e) { e.printStackTrace(); } } }",java,1
Buffer Overflow,"import java.util.Scanner;

public class BufferOverflowExample {
    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        System.out.println(""Enter a string:"");
        String userInput = scanner.next();
        
        // Create a fixed-size char array with size 10
        char[] buffer = new char[10];
        
        // Copy user input into the fixed-size buffer array
        userInput.getChars(0, userInput.length(), buffer, 0);
        
        // Print the content of the buffer array
        System.out.println(""Buffer content: "" + new String(buffer));
    }
}","import java.util.Scanner; public class BufferOverflowExample { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.println(""Enter a string:""); String userInput = scanner.next(); // Create a fixed-size char array with size 10 char[] buffer = new char[10]; // Copy user input into the fixed-size buffer array userInput.getChars(0, userInput.length(), buffer, 0); // Print the content of the buffer array System.out.println(""Buffer content: "" + new String(buffer)); } }",java,1
Insecure Deserialization,"<?php
$data = $_POST['data'];
unserialize($data); // Insecure Deserialization
?>","<?php
$data = $_POST['data'];
unserialize($data); // Insecure Deserialization
?>",php,1
Clear,"const shell = require('child_process');
const safeInput = userInput.replace(/[^a-zA-Z0-9.]/g, '');
shell.execFile('ping', [safeInput]); // Safe command execution
","const shell = require('child_process');
const safeInput = userInput.replace(/[^a-zA-Z0-9.]/g, '');
shell.execFile('ping', [safeInput]); // Safe command execution
",javascript,0
Insecure Deserialization,"<?php
$data = $_POST['data'];
unserialize($data); // Insecure Deserialization
?>","<?php
$data = $_POST['data'];
unserialize($data); // Insecure Deserialization
?>",php,1
SQL Injection,"app.get('/user/:id', (req, res) => {
    const query = `SELECT * FROM users WHERE id = ${req.params.id}`; // SQL Injection
    db.query(query, (err, result) => {
        res.json(result);
    });
});
","app.get('/user/:id', (req, res) => {
    const query = `SELECT * FROM users WHERE id = ${req.params.id}`; // SQL Injection
    db.query(query, (err, result) => {
        res.json(result);
    });
});
",javascript,1
Clear,"To address the vulnerability related to Insecure Deserialization in the provided Java code snippet, you can implement proper security measures. One common approach is to use a safe serialization mechanism such as JSON or XML instead of Java serialization. Here's an updated version of the code snippet using JSON serialization with the Jackson library:

```java
import com.fasterxml.jackson.databind.ObjectMapper;

import java.io.IOException;

public class SecureDeserializationExample {

    public static void main(String[] args) {
        // Simulating user input
        String userInput = ""{\""name\"":\""John Doe\"",\""age\"":30}"";

        ObjectMapper mapper = new ObjectMapper();

        try {
            // Deserialize JSON input
            User user = mapper.readValue(userInput, User.class);

            System.out.println(""Deserialized User:"");
            System.out.println(""Name: "" + user.getName());
            System.out.println(""Age: "" + user.getAge());

        } catch (IOException e) {
            System.err.println(""Error deserializing user input"");
            e.printStackTrace();
        }
    }

    static class User {
        private String name;
        private int age;

        public String getName() {
            return name;
        }

        public void setName(String name) {
            this.name = name;
        }

        public int","To address the vulnerability related to Insecure Deserialization in the provided Java code snippet, you can implement proper security measures. One common approach is to use a safe serialization mechanism such as JSON or XML instead of Java serialization. Here's an updated version of the code snippet using JSON serialization with the Jackson library: ```java import com.fasterxml.jackson.databind.ObjectMapper; import java.io.IOException; public class SecureDeserializationExample { public static void main(String[] args) { // Simulating user input String userInput = ""{\""name\"":\""John Doe\"",\""age\"":30}""; ObjectMapper mapper = new ObjectMapper(); try { // Deserialize JSON input User user = mapper.readValue(userInput, User.class); System.out.println(""Deserialized User:""); System.out.println(""Name: "" + user.getName()); System.out.println(""Age: "" + user.getAge()); } catch (IOException e) { System.err.println(""Error deserializing user input""); e.printStackTrace(); } } static class User { private String name; private int age; public String getName() { return name; } public void setName(String name) { this.name = name; } public int",java,0
Cross-Site Scripting (XSS),"import java.io.*;
import javax.servlet.*;
import javax.servlet.http.*;

public class VulnerableServlet extends HttpServlet {
    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        String userInput = request.getParameter(""input"");
        
        PrintWriter out = response.getWriter();
        out.println(""<html><body>"");
        out.println(""<h1>Hello, "" + userInput + ""</h1>"");
        out.println(""</body></html>"");
    }
}","import java.io.*; import javax.servlet.*; import javax.servlet.http.*; public class VulnerableServlet extends HttpServlet { protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { String userInput = request.getParameter(""input""); PrintWriter out = response.getWriter(); out.println(""<html><body>""); out.println(""<h1>Hello, "" + userInput + ""</h1>""); out.println(""</body></html>""); } }",java,1
Clear,"To fix the Path Traversal vulnerability in the provided Java code snippet, you can implement proper security measures such as validating user input and ensuring that only allowed files are accessed. Here's an improved version of the code with security measures:

```java
import java.io.BufferedReader;
import java.io.File;
import java.io.FileReader;
import java.io.IOException;

public class SecurePathTraversal {

    private static final String BASE_PATH = ""/path/to/directory/"";

    public static void main(String[] args) {
        String userInput = ""/etc/passwd"";

        // Validate user input to prevent path traversal
        if (!isValidInput(userInput)) {
            System.err.println(""Invalid input: "" + userInput);
            return;
        }

        String filePath = BASE_PATH + userInput;

        try {
            File file = new File(filePath);

            // Check if the file is within the allowed directory
            if (!file.getCanonicalPath().startsWith(BASE_PATH)) {
                System.err.println(""Access to file outside of allowed directory."");
                return;
            }

            BufferedReader br = new BufferedReader(new FileReader(file));

            String line;
            while ((line = br.readLine()) != null) {
                System.out.println(line);
            }

            br.close();
        } catch (IOException","To fix the Path Traversal vulnerability in the provided Java code snippet, you can implement proper security measures such as validating user input and ensuring that only allowed files are accessed. Here's an improved version of the code with security measures: ```java import java.io.BufferedReader; import java.io.File; import java.io.FileReader; import java.io.IOException; public class SecurePathTraversal { private static final String BASE_PATH = ""/path/to/directory/""; public static void main(String[] args) { String userInput = ""/etc/passwd""; // Validate user input to prevent path traversal if (!isValidInput(userInput)) { System.err.println(""Invalid input: "" + userInput); return; } String filePath = BASE_PATH + userInput; try { File file = new File(filePath); // Check if the file is within the allowed directory if (!file.getCanonicalPath().startsWith(BASE_PATH)) { System.err.println(""Access to file outside of allowed directory.""); return; } BufferedReader br = new BufferedReader(new FileReader(file)); String line; while ((line = br.readLine()) != null) { System.out.println(line); } br.close(); } catch (IOException",java,0
Clear,"import org.owasp.encoder.Encode;

import java.util.Scanner;

public class SecureXSSExample {

    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        
        System.out.println(""Enter your name:"");
        String userInput = scanner.nextLine();
        
        // Sanitize user input to prevent XSS
        String sanitizedUserInput = Encode.forHtml(userInput);
        
        String welcomeMessage = ""Hello, "" + sanitizedUserInput + ""! Welcome to our website!"";
        
        System.out.println(welcomeMessage);
    }
}","import org.owasp.encoder.Encode; import java.util.Scanner; public class SecureXSSExample { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.println(""Enter your name:""); String userInput = scanner.nextLine(); // Sanitize user input to prevent XSS String sanitizedUserInput = Encode.forHtml(userInput); String welcomeMessage = ""Hello, "" + sanitizedUserInput + ""! Welcome to our website!""; System.out.println(welcomeMessage); } }",java,0
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Clear,"#include <iostream>
#include <string>
#include <vector>

void safe_string_handling(const std::string& input) {
    std::string safe_copy = input;
    std::cout << safe_copy << std::endl;
}","#include <iostream>
#include <string>
#include <vector>

void safe_string_handling(const std::string& input) {
    std::string safe_copy = input;
    std::cout << safe_copy << std::endl;
}",cpp,0
Clear,"import java.util.Scanner;

public class SecureBufferExample {
    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);

        System.out.print(""Enter a string: "");
        String userInput = scanner.nextLine();

        int bufferSize = Math.min(userInput.length(), 10); // Limit input to buffer size
        char[] buffer = new char[bufferSize];
        
        userInput.getChars(0, bufferSize, buffer, 0); // Safe copy operation using limited size
        
        System.out.println(""Input string: "" + new String(buffer));
    }
}","import java.util.Scanner; public class SecureBufferExample { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter a string: ""); String userInput = scanner.nextLine(); int bufferSize = Math.min(userInput.length(), 10); // Limit input to buffer size char[] buffer = new char[bufferSize]; userInput.getChars(0, bufferSize, buffer, 0); // Safe copy operation using limited size System.out.println(""Input string: "" + new String(buffer)); } }",java,0
Cross-Site Scripting (XSS),"import java.io.*;
import javax.servlet.*;
import javax.servlet.http.*;

public class InputHandlerServlet extends HttpServlet {
    
    protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        String userInput = request.getParameter(""input"");
        response.getWriter().println(""Hello, "" + userInput);
    }
}","import java.io.*; import javax.servlet.*; import javax.servlet.http.*; public class InputHandlerServlet extends HttpServlet { protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { String userInput = request.getParameter(""input""); response.getWriter().println(""Hello, "" + userInput); } }",java,1
Clear,"import org.apache.commons.text.StringEscapeUtils;

public class SecureCodeGeneration {
    public static void main(String[] args) {
        // Simulating user input
        String userInput = ""<script>alert('XSS Attack!')</script>"";

        // Sanitize user input using Apache Commons Text library
        String sanitizedInput = StringEscapeUtils.escapeHtml4(userInput);

        // Properly handle user input by outputting the sanitized input to an HTML page
        String output = ""<div>"" + sanitizedInput + ""</div>"";

        // Output the result
        System.out.println(output);
    }
}","import org.apache.commons.text.StringEscapeUtils; public class SecureCodeGeneration { public static void main(String[] args) { // Simulating user input String userInput = ""<script>alert('XSS Attack!')</script>""; // Sanitize user input using Apache Commons Text library String sanitizedInput = StringEscapeUtils.escapeHtml4(userInput); // Properly handle user input by outputting the sanitized input to an HTML page String output = ""<div>"" + sanitizedInput + ""</div>""; // Output the result System.out.println(output); } }",java,0
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Clear,"import java.io.*;
import javax.servlet.*;
import javax.servlet.http.*;
import org.owasp.encoder.Encode;

public class SafeServlet extends HttpServlet {
    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        String userInput = request.getParameter(""input"");
        PrintWriter out = response.getWriter();
        
        out.println(""<html>"");
        out.println(""<body>"");
        out.println(""User input: "" + Encode.forHtml(userInput)); // Sanitize user input before printing
        out.println(""</body>"");
        out.println(""</html>"");
    }
}","import java.io.*; import javax.servlet.*; import javax.servlet.http.*; import org.owasp.encoder.Encode; public class SafeServlet extends HttpServlet { protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { String userInput = request.getParameter(""input""); PrintWriter out = response.getWriter(); out.println(""<html>""); out.println(""<body>""); out.println(""User input: "" + Encode.forHtml(userInput)); // Sanitize user input before printing out.println(""</body>""); out.println(""</html>""); } }",java,0
Clear,"#include <stdio.h>
#include <string.h>

int validate_input(const char *input) {
    if (input == NULL) return 0;
    for (int i = 0; input[i] != '\0'; i++) {
        if (input[i] < 32 || input[i] > 126) {
            return 0; // invalid character
        }
    }
    return 1;
}","#include <stdio.h>
#include <string.h>

int validate_input(const char *input) {
    if (input == NULL) return 0;
    for (int i = 0; input[i] != '\0'; i++) {
        if (input[i] < 32 || input[i] > 126) {
            return 0; // invalid character
        }
    }
    return 1;
}",c,0
Clear,"<?php
$cmd = escapeshellarg($_GET['cmd']);
system(""ls "" . $cmd); // Escaped command
?>","<?php
$cmd = escapeshellarg($_GET['cmd']);
system(""ls "" . $cmd); // Escaped command
?>",php,0
Clear,"import tempfile
import os

def create_secure_temp(data):
    with tempfile.NamedTemporaryFile(mode='w', delete=True, suffix='.tmp') as temp:
        temp.write(data)
        temp.flush()
        return temp.name","import tempfile
import os

def create_secure_temp(data):
    with tempfile.NamedTemporaryFile(mode='w', delete=True, suffix='.tmp') as temp:
        temp.write(data)
        temp.flush()
        return temp.name",python,0
Buffer Overflow,"import java.util.Scanner;

public class BufferOverflowVulnerability {
    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        System.out.print(""Enter your name: "");
        String name = scanner.nextLine();

        // Vulnerable code where user input is improperly handled
        char[] buffer = new char[10];
        name.getChars(0, name.length(), buffer, 0);

        System.out.println(""Hello, "" + new String(buffer));
    }
}","import java.util.Scanner; public class BufferOverflowVulnerability { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter your name: ""); String name = scanner.nextLine(); // Vulnerable code where user input is improperly handled char[] buffer = new char[10]; name.getChars(0, name.length(), buffer, 0); System.out.println(""Hello, "" + new String(buffer)); } }",java,1
Clear,"#include <stdio.h>
#include <string.h>

int validate_input(const char *input) {
    if (input == NULL) return 0;
    for (int i = 0; input[i] != '\0'; i++) {
        if (input[i] < 32 || input[i] > 126) {
            return 0; // invalid character
        }
    }
    return 1;
}","#include <stdio.h>
#include <string.h>

int validate_input(const char *input) {
    if (input == NULL) return 0;
    for (int i = 0; input[i] != '\0'; i++) {
        if (input[i] < 32 || input[i] > 126) {
            return 0; // invalid character
        }
    }
    return 1;
}",c,0
Buffer Overflow,"import java.util.Scanner;

public class BufferOverflowExample {
    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        
        System.out.print(""Enter a string: "");
        String input = scanner.nextLine();
        
        char[] buffer = new char[10];
        input.getChars(0, input.length(), buffer, 0);
        
        System.out.println(""Buffer contents: "" + new String(buffer));
    }
}","import java.util.Scanner; public class BufferOverflowExample { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter a string: ""); String input = scanner.nextLine(); char[] buffer = new char[10]; input.getChars(0, input.length(), buffer, 0); System.out.println(""Buffer contents: "" + new String(buffer)); } }",java,1
Clear,"#include <stdio.h>
#include <string.h>

int validate_input(const char *input) {
    if (input == NULL) return 0;
    for (int i = 0; input[i] != '\0'; i++) {
        if (input[i] < 32 || input[i] > 126) {
            return 0; // invalid character
        }
    }
    return 1;
}","#include <stdio.h>
#include <string.h>

int validate_input(const char *input) {
    if (input == NULL) return 0;
    for (int i = 0; input[i] != '\0'; i++) {
        if (input[i] < 32 || input[i] > 126) {
            return 0; // invalid character
        }
    }
    return 1;
}",c,0
Insecure Deserialization,"import java.io.*;

public class InsecureDeserializationExample {

    public static void main(String[] args) {
        try {
            String userInput = ""serialized_object_here""; // User input containing a serialized object

            // Deserialize the user input
            ByteArrayInputStream bais = new ByteArrayInputStream(userInput.getBytes());
            ObjectInputStream ois = new ObjectInputStream(bais);
            Object obj = ois.readObject();

            // Perform operations on the deserialized object
            System.out.println(obj.toString());

        } catch (IOException | ClassNotFoundException e) {
            e.printStackTrace();
        }
    }
}","import java.io.*; public class InsecureDeserializationExample { public static void main(String[] args) { try { String userInput = ""serialized_object_here""; // User input containing a serialized object // Deserialize the user input ByteArrayInputStream bais = new ByteArrayInputStream(userInput.getBytes()); ObjectInputStream ois = new ObjectInputStream(bais); Object obj = ois.readObject(); // Perform operations on the deserialized object System.out.println(obj.toString()); } catch (IOException | ClassNotFoundException e) { e.printStackTrace(); } } }",java,1
Clear,"#include <stdio.h>
#include <string.h>

int safe_buffer_operation(char *input) {
    char buffer[100];
    if (strlen(input) < sizeof(buffer)) {
        strcpy(buffer, input);
        return 0;
    }
    return -1; // buffer too small
}","#include <stdio.h>
#include <string.h>

int safe_buffer_operation(char *input) {
    char buffer[100];
    if (strlen(input) < sizeof(buffer)) {
        strcpy(buffer, input);
        return 0;
    }
    return -1; // buffer too small
}",c,0
File Inclusion,"<?php
$file = $_GET['file'];
include($file); // File Inclusion
?>","<?php
$file = $_GET['file'];
include($file); // File Inclusion
?>",php,1
Clear,"app.get('/user/:id', (req, res) => {
    const userId = parseInt(req.params.id);
    db.query('SELECT * FROM users WHERE id = ?', [userId], (err, result) => {
        res.json(result);
    });
});
","app.get('/user/:id', (req, res) => {
    const userId = parseInt(req.params.id);
    db.query('SELECT * FROM users WHERE id = ?', [userId], (err, result) => {
        res.json(result);
    });
});
",javascript,0
SQL Injection,"app.get('/user/:id', (req, res) => {
    const query = `SELECT * FROM users WHERE id = ${req.params.id}`; // SQL Injection
    db.query(query, (err, result) => {
        res.json(result);
    });
});
","app.get('/user/:id', (req, res) => {
    const query = `SELECT * FROM users WHERE id = ${req.params.id}`; // SQL Injection
    db.query(query, (err, result) => {
        res.json(result);
    });
});
",javascript,1
Clear,"import java.io.IOException;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

public class SecureServlet extends HttpServlet {
    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws IOException {
        String userInput = request.getParameter(""input"");
        String safeUserInput = escapeHtml(userInput);
        String responseText = ""<p>User input: "" + safeUserInput + ""</p>"";

        response.getWriter().write(responseText);
    }

    private String escapeHtml(String input) {
        if (input == null) {
            return """";
        }
        return input.replaceAll(""&"", ""&amp;"")
                     .replaceAll(""<"", ""&lt;"")
                     .replaceAll("">"", ""&gt;"")
                     .replaceAll(""\"""", ""&quot;"")
                     .replaceAll(""'"", ""&#39;"");
    }
}","import java.io.IOException; import javax.servlet.http.HttpServletRequest; import javax.servlet.http.HttpServletResponse; public class SecureServlet extends HttpServlet { protected void doGet(HttpServletRequest request, HttpServletResponse response) throws IOException { String userInput = request.getParameter(""input""); String safeUserInput = escapeHtml(userInput); String responseText = ""<p>User input: "" + safeUserInput + ""</p>""; response.getWriter().write(responseText); } private String escapeHtml(String input) { if (input == null) { return """"; } return input.replaceAll(""&"", ""&amp;"") .replaceAll(""<"", ""&lt;"") .replaceAll("">"", ""&gt;"") .replaceAll(""\"""", ""&quot;"") .replaceAll(""'"", ""&#39;""); } }",java,0
Buffer Overflow,"#include <iostream>
#include <cstring>

void unsafe_c_string(char* input) {
    char buffer[100];
    strcpy(buffer, input); // potential buffer overflow
    std::cout << buffer << std::endl;
}","#include <iostream>
#include <cstring>

void unsafe_c_string(char* input) {
    char buffer[100];
    strcpy(buffer, input); // potential buffer overflow
    std::cout << buffer << std::endl;
}",cpp,1
Cross-Site Scripting (XSS),"import java.io.*;
import javax.servlet.*;
import javax.servlet.http.*;

public class XSSVulnerableServlet extends HttpServlet {

    protected void doGet(HttpServletRequest request, HttpServletResponse response)
            throws ServletException, IOException {
        
        String userInput = request.getParameter(""input"");
        
        // Vulnerable code: user input is directly embedded into the HTML response
        String htmlResponse = ""<html><body><h1>Welcome "" + userInput + ""</h1></body></html>"";
        
        response.setContentType(""text/html"");
        PrintWriter out = response.getWriter();
        out.println(htmlResponse);
    }
}","import java.io.*; import javax.servlet.*; import javax.servlet.http.*; public class XSSVulnerableServlet extends HttpServlet { protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { String userInput = request.getParameter(""input""); // Vulnerable code: user input is directly embedded into the HTML response String htmlResponse = ""<html><body><h1>Welcome "" + userInput + ""</h1></body></html>""; response.setContentType(""text/html""); PrintWriter out = response.getWriter(); out.println(htmlResponse); } }",java,1
Clear,"To fix the insecure Java code snippet for Command Injection, you should implement proper security measures to prevent command injection vulnerabilities. Here's an improved version of the code snippet with added security measures:

```java
import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class SecureCommandExecution {

    public static void main(String[] args) {
        try {
            ProcessBuilder processBuilder = new ProcessBuilder();

            // Prompt user for input
            System.out.print(""Enter a command to execute: "");
            BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));
            String command = reader.readLine();

            // Validate the command input to prevent command injection
            if (!isValidCommand(command)) {
                System.out.println(""Invalid command. Please try again."");
                return;
            }

            // Set the validated command to be executed
            processBuilder.command(""bash"", ""-c"", command);

            // Start the process
            Process process = processBuilder.start();

            // Read the output of the process
            BufferedReader inputReader = new BufferedReader(new InputStreamReader(process.getInputStream()));
            String line;
            while ((line = inputReader.readLine()) != null) {
                System.out.println(line);
            }

        } catch (IOException e) {
            e.printStackTrace","To fix the insecure Java code snippet for Command Injection, you should implement proper security measures to prevent command injection vulnerabilities. Here's an improved version of the code snippet with added security measures: ```java import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class SecureCommandExecution { public static void main(String[] args) { try { ProcessBuilder processBuilder = new ProcessBuilder(); // Prompt user for input System.out.print(""Enter a command to execute: ""); BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); String command = reader.readLine(); // Validate the command input to prevent command injection if (!isValidCommand(command)) { System.out.println(""Invalid command. Please try again.""); return; } // Set the validated command to be executed processBuilder.command(""bash"", ""-c"", command); // Start the process Process process = processBuilder.start(); // Read the output of the process BufferedReader inputReader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = inputReader.readLine()) != null) { System.out.println(line); } } catch (IOException e) { e.printStackTrace",java,0
Clear,"from flask import Flask, request
import html
app = Flask(__name__)

@app.route('/search_safe')
def search_safe():
    query = request.args.get('q', '')
    safe_query = html.escape(query)
    return f'<h1>Search results for: {safe_query}</h1>'","from flask import Flask, request
import html
app = Flask(__name__)

@app.route('/search_safe')
def search_safe():
    query = request.args.get('q', '')
    safe_query = html.escape(query)
    return f'<h1>Search results for: {safe_query}</h1>'",python,0
Buffer Overflow,"#include <iostream>
#include <cstdio>

void unsafe_c_input() {
    char buffer[50];
    scanf(""%s"", buffer); // no length limit
    std::cout << buffer << std::endl;
}","#include <iostream>
#include <cstdio>

void unsafe_c_input() {
    char buffer[50];
    scanf(""%s"", buffer); // no length limit
    std::cout << buffer << std::endl;
}",cpp,1
Clear,"import yaml
def safe_yaml_load(config_str):
    return yaml.safe_load(config_str)","import yaml
def safe_yaml_load(config_str):
    return yaml.safe_load(config_str)",python,0
Insecure Deserialization,"import pickle
def load_user_data(filename):
    with open(filename, 'rb') as f:
        data = pickle.load(f)
    return data","import pickle
def load_user_data(filename):
    with open(filename, 'rb') as f:
        data = pickle.load(f)
    return data",python,1
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Path Traversal,"def get_user_file(username, filepath):
    import os
    base_path = f""/home/{username}/files/""
    full_path = base_path + filepath
    with open(full_path, 'r') as f:
        return f.read()","def get_user_file(username, filepath):
    import os
    base_path = f""/home/{username}/files/""
    full_path = base_path + filepath
    with open(full_path, 'r') as f:
        return f.read()",python,1
Insecure Deserialization,"<?php
$data = $_POST['data'];
unserialize($data); // Insecure Deserialization
?>","<?php
$data = $_POST['data'];
unserialize($data); // Insecure Deserialization
?>",php,1
SQL Injection,"import sqlite3
def get_user_data(username):
    conn = sqlite3.connect('database.db')
    cursor = conn.cursor()
    query = ""SELECT * FROM users WHERE username = '"" + username + ""'""
    cursor.execute(query)
    return cursor.fetchall()","import sqlite3
def get_user_data(username):
    conn = sqlite3.connect('database.db')
    cursor = conn.cursor()
    query = ""SELECT * FROM users WHERE username = '"" + username + ""'""
    cursor.execute(query)
    return cursor.fetchall()",python,1
SQL Injection,"<?php
$username = $_POST['username'];
$query = ""SELECT * FROM users WHERE username = '$username'"";
$result = mysql_query($query); // SQL Injection
?>","<?php
$username = $_POST['username'];
$query = ""SELECT * FROM users WHERE username = '$username'"";
$result = mysql_query($query); // SQL Injection
?>",php,1
Memory Corruption,"#include <iostream>

void unsafe_virtual_call() {
    // Potential vtable corruption vulnerability
    class Base {
    public:
        virtual void func() { std::cout << ""Base"" << std::endl; }
    };
    
    class Derived : public Base {
    public:
        void func() override { std::cout << ""Derived"" << std::endl; }
    };
}","#include <iostream>

void unsafe_virtual_call() {
    // Potential vtable corruption vulnerability
    class Base {
    public:
        virtual void func() { std::cout << ""Base"" << std::endl; }
    };
    
    class Derived : public Base {
    public:
        void func() override { std::cout << ""Derived"" << std::endl; }
    };
}",cpp,1
Path Traversal,"def get_user_file(username, filepath):
    import os
    base_path = f""/home/{username}/files/""
    full_path = base_path + filepath
    with open(full_path, 'r') as f:
        return f.read()","def get_user_file(username, filepath):
    import os
    base_path = f""/home/{username}/files/""
    full_path = base_path + filepath
    with open(full_path, 'r') as f:
        return f.read()",python,1
Clear,"import os
def get_api_key():
    return os.environ.get('API_KEY')","import os
def get_api_key():
    return os.environ.get('API_KEY')",python,0
Clear,"import java.io.IOException;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

public class XSSSecureServlet extends HttpServlet {

    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws IOException {
        String userInput = request.getParameter(""input"");
        String safeUserInput = escapeHtml(userInput);
        response.getWriter().write(""<p>User input: "" + safeUserInput + ""</p>"");
    }

    private String escapeHtml(String input) {
        if (input == null) {
            return """";
        }
        return input
                .replace(""&"", ""&amp;"")
                .replace(""<"", ""&lt;"")
                .replace("">"", ""&gt;"")
                .replace(""\"""", ""&quot;"")
                .replace(""'"", ""&#39;"");
    }
}","import java.io.IOException; import javax.servlet.http.HttpServlet; import javax.servlet.http.HttpServletRequest; import javax.servlet.http.HttpServletResponse; public class XSSSecureServlet extends HttpServlet { protected void doGet(HttpServletRequest request, HttpServletResponse response) throws IOException { String userInput = request.getParameter(""input""); String safeUserInput = escapeHtml(userInput); response.getWriter().write(""<p>User input: "" + safeUserInput + ""</p>""); } private String escapeHtml(String input) { if (input == null) { return """"; } return input .replace(""&"", ""&amp;"") .replace(""<"", ""&lt;"") .replace("">"", ""&gt;"") .replace(""\"""", ""&quot;"") .replace(""'"", ""&#39;""); } }",java,0
Clear,"app.get('/user/:id', (req, res) => {
    const userId = parseInt(req.params.id);
    db.query('SELECT * FROM users WHERE id = ?', [userId], (err, result) => {
        res.json(result);
    });
});
","app.get('/user/:id', (req, res) => {
    const userId = parseInt(req.params.id);
    db.query('SELECT * FROM users WHERE id = ?', [userId], (err, result) => {
        res.json(result);
    });
});
",javascript,0
Buffer Overflow,"#include <iostream>
#include <cstring>

void unsafe_c_string(char* input) {
    char buffer[100];
    strcpy(buffer, input); // potential buffer overflow
    std::cout << buffer << std::endl;
}","#include <iostream>
#include <cstring>

void unsafe_c_string(char* input) {
    char buffer[100];
    strcpy(buffer, input); // potential buffer overflow
    std::cout << buffer << std::endl;
}",cpp,1
Path Traversal,"import java.io.File;
import java.io.FileInputStream;
import java.io.IOException;
import java.util.Scanner;

public class PathTraversalVulnerability {

    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        System.out.print(""Enter file name: "");
        String fileName = scanner.nextLine();

        try {
            File file = new File(""C:\\files\\"" + fileName);
            FileInputStream fis = new FileInputStream(file);
            
            int data;
            while ((data = fis.read()) != -1) {
                System.out.print((char) data);
            }
            
            fis.close();
        } catch (IOException e) {
            System.out.println(""Error reading file: "" + e.getMessage());
        }
    }
}","import java.io.File; import java.io.FileInputStream; import java.io.IOException; import java.util.Scanner; public class PathTraversalVulnerability { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter file name: ""); String fileName = scanner.nextLine(); try { File file = new File(""C:\\files\\"" + fileName); FileInputStream fis = new FileInputStream(file); int data; while ((data = fis.read()) != -1) { System.out.print((char) data); } fis.close(); } catch (IOException e) { System.out.println(""Error reading file: "" + e.getMessage()); } } }",java,1
Clear,"#include <iostream>
#include <memory>

void safe_memory_management() {
    auto ptr = std::make_unique<int>(42);
    std::cout << *ptr << std::endl;
}","#include <iostream>
#include <memory>

void safe_memory_management() {
    auto ptr = std::make_unique<int>(42);
    std::cout << *ptr << std::endl;
}",cpp,0
Clear,"const userData = JSON.parse(userInput); // Safe JSON parsing
if (userData && typeof userData === 'object') {
    processUserData(userData);
}
","const userData = JSON.parse(userInput); // Safe JSON parsing
if (userData && typeof userData === 'object') {
    processUserData(userData);
}
",javascript,0
Clear,"#include <iostream>
#include <vector>
#include <stdexcept>

int safe_vector_access(const std::vector<int>& vec, size_t index) {
    if (index >= vec.size()) {
        throw std::out_of_range(""Index out of range"");
    }
    return vec[index];
}","#include <iostream>
#include <vector>
#include <stdexcept>

int safe_vector_access(const std::vector<int>& vec, size_t index) {
    if (index >= vec.size()) {
        throw std::out_of_range(""Index out of range"");
    }
    return vec[index];
}",cpp,0
SQL Injection,"import mysql.connector
def search_products(category):
    db = mysql.connector.connect(host=""localhost"", user=""user"", password=""pass"", database=""shop"")
    cursor = db.cursor()
    cursor.execute(""SELECT * FROM products WHERE category = '%s'"" % category)
    return cursor.fetchall()","import mysql.connector
def search_products(category):
    db = mysql.connector.connect(host=""localhost"", user=""user"", password=""pass"", database=""shop"")
    cursor = db.cursor()
    cursor.execute(""SELECT * FROM products WHERE category = '%s'"" % category)
    return cursor.fetchall()",python,1
Clear,"To fix the Path Traversal vulnerability in the given Java code snippet, you should avoid concatenating user input directly into the file path. Instead, you should validate and sanitize the user input to ensure that it does not contain any path traversal characters.

Here is an improved version of the code that addresses the vulnerability by using a whitelist approach to restrict user input:

```java
import java.io.File;
import java.io.FileInputStream;
import java.io.IOException;
import java.util.Scanner;

public class SecurePathTraversal {

    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        System.out.print(""Enter a file name to read: "");
        String fileName = scanner.nextLine();

        if (isValidFileName(fileName)) {
            try {
                File file = new File(""C:\\data\\"" + fileName);
                FileInputStream fis = new FileInputStream(file);
                int data;
                while ((data = fis.read()) != -1) {
                    System.out.print((char) data);
                }
                fis.close();
            } catch (IOException e) {
                e.printStackTrace();
            }
        } else {
            System.out.println(""Invalid file name. Please try again."");
        }
    }

    private static boolean isValidFileName(String fileName) {","To fix the Path Traversal vulnerability in the given Java code snippet, you should avoid concatenating user input directly into the file path. Instead, you should validate and sanitize the user input to ensure that it does not contain any path traversal characters. Here is an improved version of the code that addresses the vulnerability by using a whitelist approach to restrict user input: ```java import java.io.File; import java.io.FileInputStream; import java.io.IOException; import java.util.Scanner; public class SecurePathTraversal { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter a file name to read: ""); String fileName = scanner.nextLine(); if (isValidFileName(fileName)) { try { File file = new File(""C:\\data\\"" + fileName); FileInputStream fis = new FileInputStream(file); int data; while ((data = fis.read()) != -1) { System.out.print((char) data); } fis.close(); } catch (IOException e) { e.printStackTrace(); } } else { System.out.println(""Invalid file name. Please try again.""); } } private static boolean isValidFileName(String fileName) {",java,0
Clear,"#include <iostream>
#include <fstream>
#include <string>

void safe_file_reading(const std::string& filename) {
    std::ifstream file(filename);
    if (file.is_open()) {
        std::string line;
        while (std::getline(file, line)) {
            std::cout << line << std::endl;
        }
    }
}","#include <iostream>
#include <fstream>
#include <string>

void safe_file_reading(const std::string& filename) {
    std::ifstream file(filename);
    if (file.is_open()) {
        std::string line;
        while (std::getline(file, line)) {
            std::cout << line << std::endl;
        }
    }
}",cpp,0
Cross-Site Scripting (XSS),"from flask import Flask, request
app = Flask(__name__)

@app.route('/search')
def search():
    query = request.args.get('q', '')
    return f'<h1>Search results for: {query}</h1>'","from flask import Flask, request
app = Flask(__name__)

@app.route('/search')
def search():
    query = request.args.get('q', '')
    return f'<h1>Search results for: {query}</h1>'",python,1
Clear,"<?php
$username = $_POST['username'];
$stmt = $pdo->prepare(""SELECT * FROM users WHERE username = ?"");
$stmt->execute([$username]); // Parameterized query
?>","<?php
$username = $_POST['username'];
$stmt = $pdo->prepare(""SELECT * FROM users WHERE username = ?"");
$stmt->execute([$username]); // Parameterized query
?>",php,0
XSS,"<?php
echo $_GET['message']; // XSS
?>","<?php
echo $_GET['message']; // XSS
?>",php,1
SQL Injection,"import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Statement;

public class SQLInjectionVulnerableCode {

    public static void main(String[] args) {
        String userInput = ""'; DROP TABLE users; --"";

        try {
            Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");
            Statement stmt = conn.createStatement();
            
            // Vulnerable code - user input is directly concatenated into the query
            String query = ""SELECT * FROM users WHERE username='"" + userInput + ""'"";
            
            ResultSet rs = stmt.executeQuery(query);
            
            while (rs.next()) {
                System.out.println(""User found: "" + rs.getString(""username""));
            }
            
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.Connection; import java.sql.DriverManager; import java.sql.ResultSet; import java.sql.SQLException; import java.sql.Statement; public class SQLInjectionVulnerableCode { public static void main(String[] args) { String userInput = ""'; DROP TABLE users; --""; try { Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); Statement stmt = conn.createStatement(); // Vulnerable code - user input is directly concatenated into the query String query = ""SELECT * FROM users WHERE username='"" + userInput + ""'""; ResultSet rs = stmt.executeQuery(query); while (rs.next()) { System.out.println(""User found: "" + rs.getString(""username"")); } } catch (SQLException e) { e.printStackTrace(); } } }",java,1
SSRF,"import urllib.request
def download_file(file_url):
    return urllib.request.urlopen(file_url).read()","import urllib.request
def download_file(file_url):
    return urllib.request.urlopen(file_url).read()",python,1
Clear,"import yaml
def safe_yaml_load(config_str):
    return yaml.safe_load(config_str)","import yaml
def safe_yaml_load(config_str):
    return yaml.safe_load(config_str)",python,0
Clear,"#include <stdio.h>
#include <stdlib.h>

int safe_string_to_int(const char *str) {
    char *endptr;
    long value = strtol(str, &endptr, 10);
    if (*endptr != '\0' || str == endptr) {
        return -1; // error
    }
    return (int)value;
}","#include <stdio.h>
#include <stdlib.h>

int safe_string_to_int(const char *str) {
    char *endptr;
    long value = strtol(str, &endptr, 10);
    if (*endptr != '\0' || str == endptr) {
        return -1; // error
    }
    return (int)value;
}",c,0
Clear,"#include <stdio.h>
#include <stdlib.h>

int safe_string_to_int(const char *str) {
    char *endptr;
    long value = strtol(str, &endptr, 10);
    if (*endptr != '\0' || str == endptr) {
        return -1; // error
    }
    return (int)value;
}","#include <stdio.h>
#include <stdlib.h>

int safe_string_to_int(const char *str) {
    char *endptr;
    long value = strtol(str, &endptr, 10);
    if (*endptr != '\0' || str == endptr) {
        return -1; // error
    }
    return (int)value;
}",c,0
Cross-Site Scripting (XSS),"import java.io.IOException;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

public class XSSVulnerableServlet extends HttpServlet {
    
    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws IOException {
        String userInput = request.getParameter(""input"");
        String output = ""Hello, "" + userInput + ""!"";

        response.getWriter().println(""<html><body>"");
        response.getWriter().println(""<h1>"" + output + ""</h1>"");
        response.getWriter().println(""</body></html>"");
    }
}","import java.io.IOException; import javax.servlet.http.HttpServletRequest; import javax.servlet.http.HttpServletResponse; public class XSSVulnerableServlet extends HttpServlet { protected void doGet(HttpServletRequest request, HttpServletResponse response) throws IOException { String userInput = request.getParameter(""input""); String output = ""Hello, "" + userInput + ""!""; response.getWriter().println(""<html><body>""); response.getWriter().println(""<h1>"" + output + ""</h1>""); response.getWriter().println(""</body></html>""); } }",java,1
Path Traversal,"def get_user_file(username, filepath):
    import os
    base_path = f""/home/{username}/files/""
    full_path = base_path + filepath
    with open(full_path, 'r') as f:
        return f.read()","def get_user_file(username, filepath):
    import os
    base_path = f""/home/{username}/files/""
    full_path = base_path + filepath
    with open(full_path, 'r') as f:
        return f.read()",python,1
SQL Injection,"import mysql.connector
def search_products(category):
    db = mysql.connector.connect(host=""localhost"", user=""user"", password=""pass"", database=""shop"")
    cursor = db.cursor()
    cursor.execute(""SELECT * FROM products WHERE category = '%s'"" % category)
    return cursor.fetchall()","import mysql.connector
def search_products(category):
    db = mysql.connector.connect(host=""localhost"", user=""user"", password=""pass"", database=""shop"")
    cursor = db.cursor()
    cursor.execute(""SELECT * FROM products WHERE category = '%s'"" % category)
    return cursor.fetchall()",python,1
Clear,"#include <stdio.h>
#include <string.h>

int validate_input(const char *input) {
    if (input == NULL) return 0;
    for (int i = 0; input[i] != '\0'; i++) {
        if (input[i] < 32 || input[i] > 126) {
            return 0; // invalid character
        }
    }
    return 1;
}","#include <stdio.h>
#include <string.h>

int validate_input(const char *input) {
    if (input == NULL) return 0;
    for (int i = 0; input[i] != '\0'; i++) {
        if (input[i] < 32 || input[i] > 126) {
            return 0; // invalid character
        }
    }
    return 1;
}",c,0
Command Injection,"<?php
$cmd = $_GET['cmd'];
system($cmd); // Command Injection
?>","<?php
$cmd = $_GET['cmd'];
system($cmd); // Command Injection
?>",php,1
Clear,"#include <iostream>
#include <string>
#include <vector>

void safe_string_handling(const std::string& input) {
    std::string safe_copy = input;
    std::cout << safe_copy << std::endl;
}","#include <iostream>
#include <string>
#include <vector>

void safe_string_handling(const std::string& input) {
    std::string safe_copy = input;
    std::cout << safe_copy << std::endl;
}",cpp,0
Clear,"#include <stdio.h>
#include <string.h>

int validate_input(const char *input) {
    if (input == NULL) return 0;
    for (int i = 0; input[i] != '\0'; i++) {
        if (input[i] < 32 || input[i] > 126) {
            return 0; // invalid character
        }
    }
    return 1;
}","#include <stdio.h>
#include <string.h>

int validate_input(const char *input) {
    if (input == NULL) return 0;
    for (int i = 0; input[i] != '\0'; i++) {
        if (input[i] < 32 || input[i] > 126) {
            return 0; // invalid character
        }
    }
    return 1;
}",c,0
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Buffer Overflow,"#include <iostream>
#include <cstdio>

void unsafe_c_input() {
    char buffer[50];
    scanf(""%s"", buffer); // no length limit
    std::cout << buffer << std::endl;
}","#include <iostream>
#include <cstdio>

void unsafe_c_input() {
    char buffer[50];
    scanf(""%s"", buffer); // no length limit
    std::cout << buffer << std::endl;
}",cpp,1
Clear,"To fix the insecure deserialization vulnerability in the provided code snippet, you need to implement proper security measures to prevent malicious code execution during deserialization. Here are some steps you can take to secure the deserialization process:

1. Implement input validation: Before deserializing any object, validate and sanitize the input data to ensure it comes from a trusted source. In this case, ensure that the base64 encoded serialized object is not tampered with or manipulated by an attacker.

2. Use a safe deserialization mechanism: Avoid using standard Java serialization for untrusted data as it can lead to code execution vulnerabilities. Instead, consider using safer alternatives such as JSON or XML serialization libraries that do not execute arbitrary code during deserialization.

3. Whitelist allowed classes: Limit the set of classes that can be deserialized by creating a whitelist of allowed classes. This helps prevent attackers from exploiting vulnerabilities in sensitive classes or executing malicious code.

4. Enable security manager: Configure and enable a security manager with appropriate permissions to restrict access to sensitive resources and operations during deserialization.

5. Implement custom serialization/deserialization logic: If possible, implement custom serialization and deserialization logic using safe practices such as versioning, validation checks, and secure coding patterns.

Here is an","To fix the insecure deserialization vulnerability in the provided code snippet, you need to implement proper security measures to prevent malicious code execution during deserialization. Here are some steps you can take to secure the deserialization process: 1. Implement input validation: Before deserializing any object, validate and sanitize the input data to ensure it comes from a trusted source. In this case, ensure that the base64 encoded serialized object is not tampered with or manipulated by an attacker. 2. Use a safe deserialization mechanism: Avoid using standard Java serialization for untrusted data as it can lead to code execution vulnerabilities. Instead, consider using safer alternatives such as JSON or XML serialization libraries that do not execute arbitrary code during deserialization. 3. Whitelist allowed classes: Limit the set of classes that can be deserialized by creating a whitelist of allowed classes. This helps prevent attackers from exploiting vulnerabilities in sensitive classes or executing malicious code. 4. Enable security manager: Configure and enable a security manager with appropriate permissions to restrict access to sensitive resources and operations during deserialization. 5. Implement custom serialization/deserialization logic: If possible, implement custom serialization and deserialization logic using safe practices such as versioning, validation checks, and secure coding patterns. Here is an",php,0
Clear,"To fix the Insecure Deserialization vulnerability in the provided Java code snippet, you need to implement proper security measures. Here are some steps to enhance the security of the deserialization process:

1. **Use a Secure Deserialization Framework**: Instead of directly using ObjectInputStream for deserialization, consider using a secure deserialization framework like [Jackson](https://github.com/FasterXML/jackson) or [Gson](https://github.com/google/gson). These frameworks provide more control over the deserialization process and offer features to prevent common vulnerabilities.

2. **Validate Input**: Before deserializing any input data, validate it to ensure that it comes from a trusted and expected source. Perform input validation checks such as whitelisting allowed classes, validating data integrity (e.g., checksums), and verifying digital signatures if applicable.

3. **Implement Serialization Filters**: Use serialization filters to restrict which classes can be deserialized. You can create a custom SecurityManager or use libraries that provide similar functionality to define serialization filters based on class names or packages.

4. **Implement Custom Serialization**: Implement custom serialization methods in your classes by overriding readObject and writeObject methods. This allows you to have more control over the serialization/deserialization process and add additional","To fix the Insecure Deserialization vulnerability in the provided Java code snippet, you need to implement proper security measures. Here are some steps to enhance the security of the deserialization process: 1. **Use a Secure Deserialization Framework**: Instead of directly using ObjectInputStream for deserialization, consider using a secure deserialization framework like [Jackson](https://github.com/FasterXML/jackson) or [Gson](https://github.com/google/gson). These frameworks provide more control over the deserialization process and offer features to prevent common vulnerabilities. 2. **Validate Input**: Before deserializing any input data, validate it to ensure that it comes from a trusted and expected source. Perform input validation checks such as whitelisting allowed classes, validating data integrity (e.g., checksums), and verifying digital signatures if applicable. 3. **Implement Serialization Filters**: Use serialization filters to restrict which classes can be deserialized. You can create a custom SecurityManager or use libraries that provide similar functionality to define serialization filters based on class names or packages. 4. **Implement Custom Serialization**: Implement custom serialization methods in your classes by overriding readObject and writeObject methods. This allows you to have more control over the serialization/deserialization process and add additional",javascript,0
SQL Injection,"import java.sql.*;

public class SQLInjectionVulnerable {

    public static void main(String[] args) {
        String userInput = ""'; DROP TABLE users; --"";

        try {
            Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");
            Statement stmt = conn.createStatement();

            // Vulnerable code - user input is directly concatenated into the SQL query
            String query = ""SELECT * FROM users WHERE username='"" + userInput + ""'"";
            
            ResultSet rs = stmt.executeQuery(query);
            
            while (rs.next()) {
                System.out.println(""User found: "" + rs.getString(""username""));
            }

            conn.close();
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.*; public class SQLInjectionVulnerable { public static void main(String[] args) { String userInput = ""'; DROP TABLE users; --""; try { Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); Statement stmt = conn.createStatement(); // Vulnerable code - user input is directly concatenated into the SQL query String query = ""SELECT * FROM users WHERE username='"" + userInput + ""'""; ResultSet rs = stmt.executeQuery(query); while (rs.next()) { System.out.println(""User found: "" + rs.getString(""username"")); } conn.close(); } catch (SQLException e) { e.printStackTrace(); } } }",java,1
Command Injection,"<?php
$cmd = $_GET['cmd'];
system($cmd); // Command Injection
?>","<?php
$cmd = $_GET['cmd'];
system($cmd); // Command Injection
?>",php,1
Clear,"import java.sql.*;

public class SQLInjectionSecure {

    public static void main(String[] args) {
        String userInput = ""'; DROP TABLE users; --""; // User input containing malicious SQL code

        try {
            Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");
            
            String query = ""SELECT * FROM users WHERE username = ?"";
            PreparedStatement pstmt = conn.prepareStatement(query);
            pstmt.setString(1, userInput);
            
            ResultSet rs = pstmt.executeQuery();
            
            while(rs.next()) {
                System.out.println(""Username: "" + rs.getString(""username""));
                System.out.println(""Password: "" + rs.getString(""password""));
            }
            
            conn.close();
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.*; public class SQLInjectionSecure { public static void main(String[] args) { String userInput = ""'; DROP TABLE users; --""; // User input containing malicious SQL code try { Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); String query = ""SELECT * FROM users WHERE username = ?""; PreparedStatement pstmt = conn.prepareStatement(query); pstmt.setString(1, userInput); ResultSet rs = pstmt.executeQuery(); while(rs.next()) { System.out.println(""Username: "" + rs.getString(""username"")); System.out.println(""Password: "" + rs.getString(""password"")); } conn.close(); } catch (SQLException e) { e.printStackTrace(); } } }",java,0
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
XSS,"<?php
echo $_GET['message']; // XSS
?>","<?php
echo $_GET['message']; // XSS
?>",php,1
XSS,"<?php
echo $_GET['message']; // XSS
?>","<?php
echo $_GET['message']; // XSS
?>",php,1
Clear,"const shell = require('child_process');
const safeInput = userInput.replace(/[^a-zA-Z0-9.]/g, '');
shell.execFile('ping', [safeInput]); // Safe command execution
","const shell = require('child_process');
const safeInput = userInput.replace(/[^a-zA-Z0-9.]/g, '');
shell.execFile('ping', [safeInput]); // Safe command execution
",javascript,0
Clear,"import java.io.*;
import javax.servlet.*;
import javax.servlet.http.*;
import org.owasp.esapi.ESAPI;

public class SecureServlet extends HttpServlet {
    public void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        String userInput = request.getParameter(""input"");
        String safeUserInput = ESAPI.encoder().encodeForHTML(userInput); // Encode user input to prevent XSS
        
        PrintWriter out = response.getWriter();
        out.println(""<html>"");
        out.println(""<body>"");
        out.println(""<h1>Hello, "" + safeUserInput + ""!</h1>""); // Safe user input embedded in the HTML response
        out.println(""</body>"");
        out.println(""</html>"");
    }
}","import java.io.*; import javax.servlet.*; import javax.servlet.http.*; import org.owasp.esapi.ESAPI; public class SecureServlet extends HttpServlet { public void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { String userInput = request.getParameter(""input""); String safeUserInput = ESAPI.encoder().encodeForHTML(userInput); // Encode user input to prevent XSS PrintWriter out = response.getWriter(); out.println(""<html>""); out.println(""<body>""); out.println(""<h1>Hello, "" + safeUserInput + ""!</h1>""); // Safe user input embedded in the HTML response out.println(""</body>""); out.println(""</html>""); } }",java,0
Clear,"To fix the insecure deserialization vulnerability in the provided Java code snippet, you need to implement proper security measures to prevent arbitrary code execution during deserialization. Here are some recommendations to make the deserialization process more secure:

1. Use a Safe Deserialization Library:
   Instead of using `ObjectInputStream` directly, consider using a safe deserialization library like `Gson` or `Jackson` with appropriate configurations for whitelisting classes or packages that are allowed to be deserialized.

2. Validate Serialized Data:
   Before deserializing the object, validate the input data to ensure it comes from a trusted and authenticated source. Avoid deserializing untrusted or tampered serialized data.

3. Implement Serialization Filters:
   Implement custom serialization filters to sanitize and validate serialized data before deserialization. You can use custom wrappers or encryption techniques for added security.

4. Use Secure Deserialization Techniques:
   Consider using safer serialization formats like JSON or XML instead of Java serialization, which is prone to security vulnerabilities.

5. Implement Class Blacklisting/Whitelisting:
   Restrict the deserialization process to specific classes by implementing class blacklisting or whitelisting mechanisms based on predefined safe classes.

6. Enable SecurityManager:
   Utilize Java's SecurityManager","To fix the insecure deserialization vulnerability in the provided Java code snippet, you need to implement proper security measures to prevent arbitrary code execution during deserialization. Here are some recommendations to make the deserialization process more secure: 1. Use a Safe Deserialization Library: Instead of using `ObjectInputStream` directly, consider using a safe deserialization library like `Gson` or `Jackson` with appropriate configurations for whitelisting classes or packages that are allowed to be deserialized. 2. Validate Serialized Data: Before deserializing the object, validate the input data to ensure it comes from a trusted and authenticated source. Avoid deserializing untrusted or tampered serialized data. 3. Implement Serialization Filters: Implement custom serialization filters to sanitize and validate serialized data before deserialization. You can use custom wrappers or encryption techniques for added security. 4. Use Secure Deserialization Techniques: Consider using safer serialization formats like JSON or XML instead of Java serialization, which is prone to security vulnerabilities. 5. Implement Class Blacklisting/Whitelisting: Restrict the deserialization process to specific classes by implementing class blacklisting or whitelisting mechanisms based on predefined safe classes. 6. Enable SecurityManager: Utilize Java's SecurityManager",php,0
Command Injection,"import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class CommandInjectionVulnerable {
    public static void main(String[] args) throws IOException {
        BufferedReader br = new BufferedReader(new InputStreamReader(System.in));
        
        System.out.print(""Enter the IP address to ping: "");
        String ip = br.readLine();
        
        // Vulnerable code - User input directly used in command
        Process p = Runtime.getRuntime().exec(""ping "" + ip);
        
        BufferedReader reader = new BufferedReader(new InputStreamReader(p.getInputStream()));
        String line;
        while ((line = reader.readLine()) != null) {
            System.out.println(line);
        }
    }
}","import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class CommandInjectionVulnerable { public static void main(String[] args) throws IOException { BufferedReader br = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter the IP address to ping: ""); String ip = br.readLine(); // Vulnerable code - User input directly used in command Process p = Runtime.getRuntime().exec(""ping "" + ip); BufferedReader reader = new BufferedReader(new InputStreamReader(p.getInputStream())); String line; while ((line = reader.readLine()) != null) { System.out.println(line); } } }",java,1
Clear,"<?php
$message = htmlspecialchars($_GET['message'], ENT_QUOTES, 'UTF-8');
echo $message; // Sanitized output
?>","<?php
$message = htmlspecialchars($_GET['message'], ENT_QUOTES, 'UTF-8');
echo $message; // Sanitized output
?>",php,0
Path Traversal,"import java.io.BufferedReader;
import java.io.File;
import java.io.FileReader;
import java.io.IOException;

public class PathTraversalVulnerability {

    public static void main(String[] args) {
        String userInput = args[0];
        String filePath = ""/path/to/some/directory/"" + userInput;

        try {
            File file = new File(filePath);
            BufferedReader br = new BufferedReader(new FileReader(file));
            String line;
            while ((line = br.readLine()) != null) {
                System.out.println(line);
            }
            br.close();
        } catch (IOException e) {
            System.out.println(""Error reading file: "" + e.getMessage());
        }
    }
}","import java.io.BufferedReader; import java.io.File; import java.io.FileReader; import java.io.IOException; public class PathTraversalVulnerability { public static void main(String[] args) { String userInput = args[0]; String filePath = ""/path/to/some/directory/"" + userInput; try { File file = new File(filePath); BufferedReader br = new BufferedReader(new FileReader(file)); String line; while ((line = br.readLine()) != null) { System.out.println(line); } br.close(); } catch (IOException e) { System.out.println(""Error reading file: "" + e.getMessage()); } } }",java,1
Cross-Site Scripting (XSS),"import java.io.*;

public class XSSVulnerableCode {
    public static void main(String[] args) {
        // Simulating user input received from a form
        String userInput = ""<script>alert('XSS Vulnerability')</script>"";

        // Improperly handling user input by directly outputting it to HTML
        String outputHtml = ""<div>"" + userInput + ""</div>"";
        
        System.out.println(outputHtml);
    }
}","import java.io.*; public class XSSVulnerableCode { public static void main(String[] args) { // Simulating user input received from a form String userInput = ""<script>alert('XSS Vulnerability')</script>""; // Improperly handling user input by directly outputting it to HTML String outputHtml = ""<div>"" + userInput + ""</div>""; System.out.println(outputHtml); } }",java,1
Hardcoded Secrets,"localStorage.setItem('token', 'hardcoded-secret-token-123'); // Hardcoded secret
","localStorage.setItem('token', 'hardcoded-secret-token-123'); // Hardcoded secret
",javascript,1
Clear,"To fix the insecure deserialization vulnerability in the provided Java code snippet, you can implement proper security measures to prevent malicious code execution via deserialization. Here are some recommendations to secure the code:

1. Use a safe deserialization library: Replace `ObjectInputStream` with a safer deserialization library like `Gson`, `Jackson`, or `Protobuf`. These libraries provide better control over the deserialization process and have mechanisms to prevent security issues.

2. Implement input validation: Validate the user input before deserializing it to ensure that it meets certain criteria or follows a specific format. This can help prevent malicious input from being processed.

3. Implement whitelisting: Maintain a whitelist of allowed classes that can be deserialized and only deserialize objects of those whitelisted classes. This restricts the types of objects that can be instantiated during deserialization.

4. Use custom serialization: Implement custom serialization methods for your classes using interfaces like `Serializable` or external libraries like `Externalizable`. This allows you to control the serialization process and avoid potential vulnerabilities.

5. Enable security manager: Consider enabling a Java Security Manager with appropriate permissions to restrict certain actions during deserialization, such as restricting file system access or network connections.

6. Monitor and log des","To fix the insecure deserialization vulnerability in the provided Java code snippet, you can implement proper security measures to prevent malicious code execution via deserialization. Here are some recommendations to secure the code: 1. Use a safe deserialization library: Replace `ObjectInputStream` with a safer deserialization library like `Gson`, `Jackson`, or `Protobuf`. These libraries provide better control over the deserialization process and have mechanisms to prevent security issues. 2. Implement input validation: Validate the user input before deserializing it to ensure that it meets certain criteria or follows a specific format. This can help prevent malicious input from being processed. 3. Implement whitelisting: Maintain a whitelist of allowed classes that can be deserialized and only deserialize objects of those whitelisted classes. This restricts the types of objects that can be instantiated during deserialization. 4. Use custom serialization: Implement custom serialization methods for your classes using interfaces like `Serializable` or external libraries like `Externalizable`. This allows you to control the serialization process and avoid potential vulnerabilities. 5. Enable security manager: Consider enabling a Java Security Manager with appropriate permissions to restrict certain actions during deserialization, such as restricting file system access or network connections. 6. Monitor and log des",php,0
Command Injection,"<?php
$cmd = $_GET['cmd'];
system($cmd); // Command Injection
?>","<?php
$cmd = $_GET['cmd'];
system($cmd); // Command Injection
?>",php,1
XSS,"const userInput = document.location.search.split('=')[1];
document.write(userInput); // XSS
","const userInput = document.location.search.split('=')[1];
document.write(userInput); // XSS
",javascript,1
Clear,"import os
def get_database_config():
    return {
        'host': os.environ.get('DB_HOST'),
        'user': os.environ.get('DB_USER'),
        'password': os.environ.get('DB_PASSWORD')
    }","import os
def get_database_config():
    return {
        'host': os.environ.get('DB_HOST'),
        'user': os.environ.get('DB_USER'),
        'password': os.environ.get('DB_PASSWORD')
    }",python,0
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Clear,"#include <iostream>
#include <fstream>
#include <string>

void safe_file_reading(const std::string& filename) {
    std::ifstream file(filename);
    if (file.is_open()) {
        std::string line;
        while (std::getline(file, line)) {
            std::cout << line << std::endl;
        }
    }
}","#include <iostream>
#include <fstream>
#include <string>

void safe_file_reading(const std::string& filename) {
    std::ifstream file(filename);
    if (file.is_open()) {
        std::string line;
        while (std::getline(file, line)) {
            std::cout << line << std::endl;
        }
    }
}",cpp,0
Clear,"#include <stdio.h>
#include <string.h>

int validate_input(const char *input) {
    if (input == NULL) return 0;
    for (int i = 0; input[i] != '\0'; i++) {
        if (input[i] < 32 || input[i] > 126) {
            return 0; // invalid character
        }
    }
    return 1;
}","#include <stdio.h>
#include <string.h>

int validate_input(const char *input) {
    if (input == NULL) return 0;
    for (int i = 0; input[i] != '\0'; i++) {
        if (input[i] < 32 || input[i] > 126) {
            return 0; // invalid character
        }
    }
    return 1;
}",c,0
Clear,"To secure the code against Command Injection vulnerabilities, you should sanitize and validate user input before passing it to the `Runtime.exec()` method. Here's an improved version of the code that includes proper security measures:

```java
import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class SecureCommandExecution {
    public static void main(String[] args) {
        try {
            BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));
            System.out.print(""Enter a command to execute: "");
            String command = reader.readLine();

            // Validate and sanitize user input before executing the command
            if (isValidCommand(command)) {
                Process process = Runtime.getRuntime().exec(command);

                BufferedReader processOutputReader = new BufferedReader(new InputStreamReader(process.getInputStream()));
                String output;

                System.out.println(""Output of the command:"");
                while ((output = processOutputReader.readLine()) != null) {
                    System.out.println(output);
                }
            } else {
                System.out.println(""Invalid command. Please try again."");
            }
        } catch (IOException e) {
            e.printStackTrace();
        }
    }

    private static boolean isValidCommand(String command) {
        // Add your validation logic here, such as allowing only specific commands or patterns
        //","To secure the code against Command Injection vulnerabilities, you should sanitize and validate user input before passing it to the `Runtime.exec()` method. Here's an improved version of the code that includes proper security measures: ```java import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class SecureCommandExecution { public static void main(String[] args) { try { BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a command to execute: ""); String command = reader.readLine(); // Validate and sanitize user input before executing the command if (isValidCommand(command)) { Process process = Runtime.getRuntime().exec(command); BufferedReader processOutputReader = new BufferedReader(new InputStreamReader(process.getInputStream())); String output; System.out.println(""Output of the command:""); while ((output = processOutputReader.readLine()) != null) { System.out.println(output); } } else { System.out.println(""Invalid command. Please try again.""); } } catch (IOException e) { e.printStackTrace(); } } private static boolean isValidCommand(String command) { // Add your validation logic here, such as allowing only specific commands or patterns //",java,0
SQL Injection,"import java.sql.*;

public class VulnerableCode {

    public static void main(String[] args) {
        String userInput = ""'; DROP TABLE users; --""; // User input containing malicious SQL code

        try {
            String url = ""jdbc:mysql://localhost:3306/mydatabase"";
            String username = ""root"";
            String password = ""password"";

            Connection connection = DriverManager.getConnection(url, username, password);

            Statement statement = connection.createStatement();
            String query = ""SELECT * FROM users WHERE username = '"" + userInput + ""'"";
            ResultSet resultSet = statement.executeQuery(query);

            while (resultSet.next()) {
                System.out.println(resultSet.getString(""username""));
            }

        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.*; public class VulnerableCode { public static void main(String[] args) { String userInput = ""'; DROP TABLE users; --""; // User input containing malicious SQL code try { String url = ""jdbc:mysql://localhost:3306/mydatabase""; String username = ""root""; String password = ""password""; Connection connection = DriverManager.getConnection(url, username, password); Statement statement = connection.createStatement(); String query = ""SELECT * FROM users WHERE username = '"" + userInput + ""'""; ResultSet resultSet = statement.executeQuery(query); while (resultSet.next()) { System.out.println(resultSet.getString(""username"")); } } catch (SQLException e) { e.printStackTrace(); } } }",java,1
Path Traversal,"import java.io.File;
import java.io.IOException;
import java.nio.file.Files;
import java.util.Scanner;

public class PathTraversalVulnerable {

    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        System.out.print(""Enter file name: "");
        String fileName = scanner.nextLine();

        File file = new File(fileName);

        if (file.exists()) {
            try {
                byte[] content = Files.readAllBytes(file.toPath());
                System.out.println(""File content: "" + new String(content));
            } catch (IOException e) {
                System.err.println(""Error reading file: "" + e.getMessage());
            }
        } else {
            System.out.println(""File does not exist."");
        }

        scanner.close();
    }
}","import java.io.File; import java.io.IOException; import java.nio.file.Files; import java.util.Scanner; public class PathTraversalVulnerable { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter file name: ""); String fileName = scanner.nextLine(); File file = new File(fileName); if (file.exists()) { try { byte[] content = Files.readAllBytes(file.toPath()); System.out.println(""File content: "" + new String(content)); } catch (IOException e) { System.err.println(""Error reading file: "" + e.getMessage()); } } else { System.out.println(""File does not exist.""); } scanner.close(); } }",java,1
Clear,"const userInput = new URLSearchParams(window.location.search).get('input');
const safeOutput = document.createElement('div');
safeOutput.textContent = userInput; // Safe DOM manipulation
document.body.appendChild(safeOutput);
","const userInput = new URLSearchParams(window.location.search).get('input');
const safeOutput = document.createElement('div');
safeOutput.textContent = userInput; // Safe DOM manipulation
document.body.appendChild(safeOutput);
",javascript,0
Out-of-Bounds,"#include <iostream>

class UnsafeClass {
    int data[10];
public:
    int get_data(int index) {
        return data[index]; // no bounds checking
    }
};","#include <iostream>

class UnsafeClass {
    int data[10];
public:
    int get_data(int index) {
        return data[index]; // no bounds checking
    }
};",cpp,1
Command Injection,"import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class CommandInjectionExample {

    public static void main(String[] args) throws IOException {
        BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));
        
        System.out.print(""Enter the IP address to ping: "");
        String ip = reader.readLine();
        
        String command = ""ping "" + ip;
        
        // Execute the command
        Process process = Runtime.getRuntime().exec(command);
        
        BufferedReader inputReader = new BufferedReader(new InputStreamReader(process.getInputStream()));
        String inputLine;
        
        while ((inputLine = inputReader.readLine()) != null) {
            System.out.println(inputLine);
        }
    }
}","import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class CommandInjectionExample { public static void main(String[] args) throws IOException { BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter the IP address to ping: ""); String ip = reader.readLine(); String command = ""ping "" + ip; // Execute the command Process process = Runtime.getRuntime().exec(command); BufferedReader inputReader = new BufferedReader(new InputStreamReader(process.getInputStream())); String inputLine; while ((inputLine = inputReader.readLine()) != null) { System.out.println(inputLine); } } }",java,1
Clear,"import java.io.*;
import javax.servlet.*;
import javax.servlet.http.*;
import org.apache.commons.text.StringEscapeUtils;

public class XSSFixedServlet extends HttpServlet {
    protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        String userInput = request.getParameter(""input"");
        
        // Sanitize and escape user input to prevent XSS
        String sanitizedInput = StringEscapeUtils.escapeHtml4(userInput);
        
        String output = ""<html><body>User Input: "" + sanitizedInput + ""</body></html>"";
        
        response.setContentType(""text/html"");
        
        try (PrintWriter out = response.getWriter()) {
            out.println(output);
        }
    }
}","import java.io.*; import javax.servlet.*; import javax.servlet.http.*; import org.apache.commons.text.StringEscapeUtils; public class XSSFixedServlet extends HttpServlet { protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { String userInput = request.getParameter(""input""); // Sanitize and escape user input to prevent XSS String sanitizedInput = StringEscapeUtils.escapeHtml4(userInput); String output = ""<html><body>User Input: "" + sanitizedInput + ""</body></html>""; response.setContentType(""text/html""); try (PrintWriter out = response.getWriter()) { out.println(output); } } }",java,0
Cross-Site Scripting (XSS),"import java.io.*;
import javax.servlet.*;
import javax.servlet.http.*;

public class XSSVulnerableServlet extends HttpServlet {
    protected void doGet(HttpServletRequest request, HttpServletResponse response)
            throws ServletException, IOException {
        response.setContentType(""text/html"");
        PrintWriter out = response.getWriter();

        String userInput = request.getParameter(""input"");
        out.println(""<html>"");
        out.println(""<head><title>XSS Vulnerable Page</title></head>"");
        out.println(""<body>"");
        out.println(""<h1>User Input: "" + userInput + ""</h1>""); // Improperly handling user input here
        out.println(""</body>"");
        out.println(""</html>"");
    }
}","import java.io.*; import javax.servlet.*; import javax.servlet.http.*; public class XSSVulnerableServlet extends HttpServlet { protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { response.setContentType(""text/html""); PrintWriter out = response.getWriter(); String userInput = request.getParameter(""input""); out.println(""<html>""); out.println(""<head><title>XSS Vulnerable Page</title></head>""); out.println(""<body>""); out.println(""<h1>User Input: "" + userInput + ""</h1>""); // Improperly handling user input here out.println(""</body>""); out.println(""</html>""); } }",java,1
XSS,"const userInput = document.location.search.split('=')[1];
document.write(userInput); // XSS
","const userInput = document.location.search.split('=')[1];
document.write(userInput); // XSS
",javascript,1
Memory Corruption,"#include <iostream>

void unsafe_virtual_call() {
    // Potential vtable corruption vulnerability
    class Base {
    public:
        virtual void func() { std::cout << ""Base"" << std::endl; }
    };
    
    class Derived : public Base {
    public:
        void func() override { std::cout << ""Derived"" << std::endl; }
    };
}","#include <iostream>

void unsafe_virtual_call() {
    // Potential vtable corruption vulnerability
    class Base {
    public:
        virtual void func() { std::cout << ""Base"" << std::endl; }
    };
    
    class Derived : public Base {
    public:
        void func() override { std::cout << ""Derived"" << std::endl; }
    };
}",cpp,1
Command Injection,"import os
def ping_host(host):
    os.system(""ping -c 4 "" + host)","import os
def ping_host(host):
    os.system(""ping -c 4 "" + host)",python,1
Buffer Overflow,"#include <iostream>
#include <cstring>

void unsafe_c_string(char* input) {
    char buffer[100];
    strcpy(buffer, input); // potential buffer overflow
    std::cout << buffer << std::endl;
}","#include <iostream>
#include <cstring>

void unsafe_c_string(char* input) {
    char buffer[100];
    strcpy(buffer, input); // potential buffer overflow
    std::cout << buffer << std::endl;
}",cpp,1
Clear,"<?php
$file = basename($_GET['file']);
$allowed = ['page1.php', 'page2.php'];
if (in_array($file, $allowed)) {
    include($file);
}
?>","<?php
$file = basename($_GET['file']);
$allowed = ['page1.php', 'page2.php'];
if (in_array($file, $allowed)) {
    include($file);
}
?>",php,0
Command Injection,"import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class CommandInjectionExample {

    public static void main(String[] args) throws IOException {
        BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));
        
        System.out.print(""Enter a file name to display its content: "");
        String fileName = reader.readLine();
        
        String command = ""cat "" + fileName; // Vulnerable code concatenating user input directly into the command
        
        Process process = Runtime.getRuntime().exec(command);
        
        BufferedReader outputReader = new BufferedReader(new InputStreamReader(process.getInputStream()));
        String line;
        
        while ((line = outputReader.readLine()) != null) {
            System.out.println(line);
        }
        
        process.destroy();
    }
}","import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class CommandInjectionExample { public static void main(String[] args) throws IOException { BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a file name to display its content: ""); String fileName = reader.readLine(); String command = ""cat "" + fileName; // Vulnerable code concatenating user input directly into the command Process process = Runtime.getRuntime().exec(command); BufferedReader outputReader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = outputReader.readLine()) != null) { System.out.println(line); } process.destroy(); } }",java,1
Clear,"import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class SecureCommandExecution {

    public static void main(String[] args) {
        try {
            BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));
            System.out.print(""Enter a command to execute: "");
            String command = reader.readLine();

            // Sanitize user input to prevent command injection
            String[] sanitizedCommand = {""sh"", ""-c"", command};

            ProcessBuilder processBuilder = new ProcessBuilder(sanitizedCommand);
            Process process = processBuilder.start();

            BufferedReader inputReader = new BufferedReader(new InputStreamReader(process.getInputStream()));
            String line;
            while ((line = inputReader.readLine()) != null) {
                System.out.println(line);
            }

        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}","import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class SecureCommandExecution { public static void main(String[] args) { try { BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a command to execute: ""); String command = reader.readLine(); // Sanitize user input to prevent command injection String[] sanitizedCommand = {""sh"", ""-c"", command}; ProcessBuilder processBuilder = new ProcessBuilder(sanitizedCommand); Process process = processBuilder.start(); BufferedReader inputReader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = inputReader.readLine()) != null) { System.out.println(line); } } catch (IOException e) { e.printStackTrace(); } } }",java,0
XSS,"<?php
echo $_GET['message']; // XSS
?>","<?php
echo $_GET['message']; // XSS
?>",php,1
Clear,"import jwt
import os
from datetime import datetime, timedelta

def create_safe_token(user_id):
    payload = {
        'user_id': user_id,
        'exp': datetime.utcnow() + timedelta(hours=1)
    }
    secret = os.environ.get('JWT_SECRET')
    return jwt.encode(payload, secret, algorithm='HS256')","import jwt
import os
from datetime import datetime, timedelta

def create_safe_token(user_id):
    payload = {
        'user_id': user_id,
        'exp': datetime.utcnow() + timedelta(hours=1)
    }
    secret = os.environ.get('JWT_SECRET')
    return jwt.encode(payload, secret, algorithm='HS256')",python,0
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Clear,"#include <stdio.h>
#include <string.h>

int validate_input(const char *input) {
    if (input == NULL) return 0;
    for (int i = 0; input[i] != '\0'; i++) {
        if (input[i] < 32 || input[i] > 126) {
            return 0; // invalid character
        }
    }
    return 1;
}","#include <stdio.h>
#include <string.h>

int validate_input(const char *input) {
    if (input == NULL) return 0;
    for (int i = 0; input[i] != '\0'; i++) {
        if (input[i] < 32 || input[i] > 126) {
            return 0; // invalid character
        }
    }
    return 1;
}",c,0
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Clear,"import tempfile
import os

def create_secure_temp(data):
    with tempfile.NamedTemporaryFile(mode='w', delete=True, suffix='.tmp') as temp:
        temp.write(data)
        temp.flush()
        return temp.name","import tempfile
import os

def create_secure_temp(data):
    with tempfile.NamedTemporaryFile(mode='w', delete=True, suffix='.tmp') as temp:
        temp.write(data)
        temp.flush()
        return temp.name",python,0
Clear,"#include <stdio.h>
#include <stdlib.h>

void safe_file_operation(const char *filename) {
    FILE *file = fopen(filename, ""r"");
    if (file != NULL) {
        char buffer[256];
        while (fgets(buffer, sizeof(buffer), file)) {
            printf(""%s"", buffer);
        }
        fclose(file);
    }
}","#include <stdio.h>
#include <stdlib.h>

void safe_file_operation(const char *filename) {
    FILE *file = fopen(filename, ""r"");
    if (file != NULL) {
        char buffer[256];
        while (fgets(buffer, sizeof(buffer), file)) {
            printf(""%s"", buffer);
        }
        fclose(file);
    }
}",c,0
Hardcoded Secrets,"localStorage.setItem('token', 'hardcoded-secret-token-123'); // Hardcoded secret
","localStorage.setItem('token', 'hardcoded-secret-token-123'); // Hardcoded secret
",javascript,1
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Buffer Overflow,"#include <iostream>
#include <cstring>

void unsafe_c_string(char* input) {
    char buffer[100];
    strcpy(buffer, input); // potential buffer overflow
    std::cout << buffer << std::endl;
}","#include <iostream>
#include <cstring>

void unsafe_c_string(char* input) {
    char buffer[100];
    strcpy(buffer, input); // potential buffer overflow
    std::cout << buffer << std::endl;
}",cpp,1
File Inclusion,"<?php
$file = $_GET['file'];
include($file); // File Inclusion
?>","<?php
$file = $_GET['file'];
include($file); // File Inclusion
?>",php,1
Clear,"import psycopg2
def safe_admin_query(admin_id):
    conn = psycopg2.connect(""dbname=test user=postgres"")
    cur = conn.cursor()
    cur.execute(""SELECT * FROM admins WHERE id = %s"", (admin_id,))
    return cur.fetchone()","import psycopg2
def safe_admin_query(admin_id):
    conn = psycopg2.connect(""dbname=test user=postgres"")
    cur = conn.cursor()
    cur.execute(""SELECT * FROM admins WHERE id = %s"", (admin_id,))
    return cur.fetchone()",python,0
Command Injection,"const shell = require('child_process');
shell.exec('ping ' + userInput); // Command Injection
","const shell = require('child_process');
shell.exec('ping ' + userInput); // Command Injection
",javascript,1
Clear,"import java.io.IOException;
import java.io.PrintWriter;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

import org.owasp.esapi.ESAPI;

public class SecureServlet extends HttpServlet {
    
    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        String userInput = request.getParameter(""input"");
        
        PrintWriter out = response.getWriter();
        out.println(""<html>"");
        out.println(""<body>"");
        out.println(""<h1>User Input: "" + ESAPI.encoder().encodeForHTML(userInput) + ""</h1>""); // Securely encode user input
        out.println(""</body>"");
        out.println(""</html>"");
    }
}","import java.io.IOException; import java.io.PrintWriter; import javax.servlet.http.HttpServletRequest; import javax.servlet.http.HttpServletResponse; import org.owasp.esapi.ESAPI; public class SecureServlet extends HttpServlet { protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { String userInput = request.getParameter(""input""); PrintWriter out = response.getWriter(); out.println(""<html>""); out.println(""<body>""); out.println(""<h1>User Input: "" + ESAPI.encoder().encodeForHTML(userInput) + ""</h1>""); // Securely encode user input out.println(""</body>""); out.println(""</html>""); } }",java,0
Clear,"To fix the Path Traversal vulnerability in the provided Java code snippet, you should ensure that user input for the file name does not allow directory traversal. Here's a secure version of the code using proper security measures:

```java
import java.io.File;
import java.io.IOException;
import java.nio.file.Files;
import java.nio.file.Paths;
import java.util.Scanner;

public class PathTraversalSecure {

    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        System.out.println(""Enter a file name:"");
        String fileName = scanner.nextLine();

        // Validate user input to prevent directory traversal
        if (!isValidFileName(fileName)) {
            System.out.println(""Invalid file name."");
            return;
        }

        File file = new File(""/path/to/directory/"" + fileName);

        try {
            if (file.exists() && file.isFile()) {
                byte[] fileContent = Files.readAllBytes(file.toPath());
                System.out.println(""File content: "" + new String(fileContent));
            } else {
                System.out.println(""File not found."");
            }
        } catch (IOException e) {
            e.printStackTrace();
        }
    }

    // Validate the file name to prevent directory traversal
    private static","To fix the Path Traversal vulnerability in the provided Java code snippet, you should ensure that user input for the file name does not allow directory traversal. Here's a secure version of the code using proper security measures: ```java import java.io.File; import java.io.IOException; import java.nio.file.Files; import java.nio.file.Paths; import java.util.Scanner; public class PathTraversalSecure { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.println(""Enter a file name:""); String fileName = scanner.nextLine(); // Validate user input to prevent directory traversal if (!isValidFileName(fileName)) { System.out.println(""Invalid file name.""); return; } File file = new File(""/path/to/directory/"" + fileName); try { if (file.exists() && file.isFile()) { byte[] fileContent = Files.readAllBytes(file.toPath()); System.out.println(""File content: "" + new String(fileContent)); } else { System.out.println(""File not found.""); } } catch (IOException e) { e.printStackTrace(); } } // Validate the file name to prevent directory traversal private static",java,0
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Path Traversal,"import java.io.File;
import java.io.IOException;
import java.util.Scanner;

public class PathTraversalVulnerability {

    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        System.out.print(""Enter file name: "");
        String fileName = scanner.nextLine();

        File file = new File(""/path/to/directory/"" + fileName);

        try {
            if(file.exists()) {
                System.out.println(""File exists."");
            } else {
                System.out.println(""File does not exist."");
            }
        } catch (Exception e) {
            System.out.println(""Error accessing file."");
        }
    }
}","import java.io.File; import java.io.IOException; import java.util.Scanner; public class PathTraversalVulnerability { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter file name: ""); String fileName = scanner.nextLine(); File file = new File(""/path/to/directory/"" + fileName); try { if(file.exists()) { System.out.println(""File exists.""); } else { System.out.println(""File does not exist.""); } } catch (Exception e) { System.out.println(""Error accessing file.""); } } }",java,1
Clear,"#include <stdio.h>
#include <string.h>

int validate_input(const char *input) {
    if (input == NULL) return 0;
    for (int i = 0; input[i] != '\0'; i++) {
        if (input[i] < 32 || input[i] > 126) {
            return 0; // invalid character
        }
    }
    return 1;
}","#include <stdio.h>
#include <string.h>

int validate_input(const char *input) {
    if (input == NULL) return 0;
    for (int i = 0; input[i] != '\0'; i++) {
        if (input[i] < 32 || input[i] > 126) {
            return 0; // invalid character
        }
    }
    return 1;
}",c,0
Cross-Site Scripting (XSS),"import java.io.IOException;
import java.io.PrintWriter;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

public class XSSVulnerableServlet extends HttpServlet {

    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws IOException {
        String userInput = request.getParameter(""input"");
        
        response.setContentType(""text/html"");
        PrintWriter out = response.getWriter();
        
        out.println(""<html>"");
        out.println(""<body>"");
        out.println(""<h1>Hello, "" + userInput + ""!</h1>""); // Vulnerable line
        out.println(""</body>"");
        out.println(""</html>"");
    }
}","import java.io.IOException; import java.io.PrintWriter; import javax.servlet.http.HttpServlet; import javax.servlet.http.HttpServletRequest; import javax.servlet.http.HttpServletResponse; public class XSSVulnerableServlet extends HttpServlet { protected void doGet(HttpServletRequest request, HttpServletResponse response) throws IOException { String userInput = request.getParameter(""input""); response.setContentType(""text/html""); PrintWriter out = response.getWriter(); out.println(""<html>""); out.println(""<body>""); out.println(""<h1>Hello, "" + userInput + ""!</h1>""); // Vulnerable line out.println(""</body>""); out.println(""</html>""); } }",java,1
Clear,"import os
def get_api_key():
    return os.environ.get('API_KEY')","import os
def get_api_key():
    return os.environ.get('API_KEY')",python,0
Clear,"import java.sql.*;

public class SecureSQLInjectionPrevention {

    public static void main(String[] args) {
        String userInput = ""admin'; DROP TABLE users; --""; // Malicious input simulating SQL Injection

        try {
            Connection connection = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");
            
            String query = ""SELECT * FROM users WHERE username=?"";
            PreparedStatement preparedStatement = connection.prepareStatement(query);
            preparedStatement.setString(1, userInput);

            ResultSet resultSet = preparedStatement.executeQuery();

            while (resultSet.next()) {
                System.out.println(""User ID: "" + resultSet.getInt(""id"") + "", Username: "" + resultSet.getString(""username""));
            }

            connection.close();
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.*; public class SecureSQLInjectionPrevention { public static void main(String[] args) { String userInput = ""admin'; DROP TABLE users; --""; // Malicious input simulating SQL Injection try { Connection connection = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); String query = ""SELECT * FROM users WHERE username=?""; PreparedStatement preparedStatement = connection.prepareStatement(query); preparedStatement.setString(1, userInput); ResultSet resultSet = preparedStatement.executeQuery(); while (resultSet.next()) { System.out.println(""User ID: "" + resultSet.getInt(""id"") + "", Username: "" + resultSet.getString(""username"")); } connection.close(); } catch (SQLException e) { e.printStackTrace(); } } }",java,0
Clear,"const userInput = new URLSearchParams(window.location.search).get('input');
const safeOutput = document.createElement('div');
safeOutput.textContent = userInput; // Safe DOM manipulation
document.body.appendChild(safeOutput);
","const userInput = new URLSearchParams(window.location.search).get('input');
const safeOutput = document.createElement('div');
safeOutput.textContent = userInput; // Safe DOM manipulation
document.body.appendChild(safeOutput);
",javascript,0
Clear,"#include <iostream>
#include <memory>

void safe_memory_management() {
    auto ptr = std::make_unique<int>(42);
    std::cout << *ptr << std::endl;
}","#include <iostream>
#include <memory>

void safe_memory_management() {
    auto ptr = std::make_unique<int>(42);
    std::cout << *ptr << std::endl;
}",cpp,0
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Hardcoded Secrets,"localStorage.setItem('token', 'hardcoded-secret-token-123'); // Hardcoded secret
","localStorage.setItem('token', 'hardcoded-secret-token-123'); // Hardcoded secret
",javascript,1
Clear,"#include <stdio.h>
#include <stdlib.h>

int safe_string_to_int(const char *str) {
    char *endptr;
    long value = strtol(str, &endptr, 10);
    if (*endptr != '\0' || str == endptr) {
        return -1; // error
    }
    return (int)value;
}","#include <stdio.h>
#include <stdlib.h>

int safe_string_to_int(const char *str) {
    char *endptr;
    long value = strtol(str, &endptr, 10);
    if (*endptr != '\0' || str == endptr) {
        return -1; // error
    }
    return (int)value;
}",c,0
Hardcoded Secrets,"localStorage.setItem('token', 'hardcoded-secret-token-123'); // Hardcoded secret
","localStorage.setItem('token', 'hardcoded-secret-token-123'); // Hardcoded secret
",javascript,1
Clear,"#include <iostream>
#include <vector>
#include <stdexcept>

int safe_vector_access(const std::vector<int>& vec, size_t index) {
    if (index >= vec.size()) {
        throw std::out_of_range(""Index out of range"");
    }
    return vec[index];
}","#include <iostream>
#include <vector>
#include <stdexcept>

int safe_vector_access(const std::vector<int>& vec, size_t index) {
    if (index >= vec.size()) {
        throw std::out_of_range(""Index out of range"");
    }
    return vec[index];
}",cpp,0
Command Injection,"const shell = require('child_process');
shell.exec('ping ' + userInput); // Command Injection
","const shell = require('child_process');
shell.exec('ping ' + userInput); // Command Injection
",javascript,1
Clear,"import java.util.Scanner;
import java.util.Arrays;

public class SecureBufferExample {

    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        
        System.out.println(""Enter your name:"");
        String name = scanner.nextLine();
        
        // Validate user input length
        if (name.length() > 10) {
            System.out.println(""Input length exceeds buffer size. Please enter a shorter name."");
            return;
        }
        
        // Create a buffer of appropriate size
        byte[] buffer = new byte[10];
        
        // Copy user input into the buffer with proper length checking
        Arrays.fill(buffer, (byte) 0); // Clear the buffer first to ensure no leftover data
        System.arraycopy(name.getBytes(), 0, buffer, 0, Math.min(name.length(), buffer.length));
        
        System.out.println(""Hello, "" + new String(buffer).trim()); // Trim any additional null characters from the output
    }
}","import java.util.Scanner; import java.util.Arrays; public class SecureBufferExample { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.println(""Enter your name:""); String name = scanner.nextLine(); // Validate user input length if (name.length() > 10) { System.out.println(""Input length exceeds buffer size. Please enter a shorter name.""); return; } // Create a buffer of appropriate size byte[] buffer = new byte[10]; // Copy user input into the buffer with proper length checking Arrays.fill(buffer, (byte) 0); // Clear the buffer first to ensure no leftover data System.arraycopy(name.getBytes(), 0, buffer, 0, Math.min(name.length(), buffer.length)); System.out.println(""Hello, "" + new String(buffer).trim()); // Trim any additional null characters from the output } }",java,0
Clear,"To prevent Cross-Site Scripting (XSS) attacks in the given Java servlet code, you should properly sanitize and escape the user input before outputting it to the response. Here's an updated version of the code with security measures implemented:

```java
import java.io.IOException;
import java.io.PrintWriter;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

public class XSSFixedServlet extends HttpServlet {
    
    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws IOException {
        String userInput = request.getParameter(""input"");
        
        // Sanitize user input to prevent XSS
        userInput = escapeHtml(userInput);
        
        // Properly handle user input by escaping and outputting it
        PrintWriter out = response.getWriter();
        out.println(""<html>"");
        out.println(""<head><title>XSS Fixed Page</title></head>"");
        out.println(""<body>"");
        out.println(""<h1>User Input: "" + userInput + ""</h1>"");
        out.println(""</body>"");
        out.println(""</html>"");
    }

    private String escapeHtml(String input) {
        return input != null ? input.replace(""&"", ""&amp;"")
                                    .replace(""<"", ""&lt;"")
                                    .replace("">"", ""&gt;"")","To prevent Cross-Site Scripting (XSS) attacks in the given Java servlet code, you should properly sanitize and escape the user input before outputting it to the response. Here's an updated version of the code with security measures implemented: ```java import java.io.IOException; import java.io.PrintWriter; import javax.servlet.http.HttpServlet; import javax.servlet.http.HttpServletRequest; import javax.servlet.http.HttpServletResponse; public class XSSFixedServlet extends HttpServlet { protected void doGet(HttpServletRequest request, HttpServletResponse response) throws IOException { String userInput = request.getParameter(""input""); // Sanitize user input to prevent XSS userInput = escapeHtml(userInput); // Properly handle user input by escaping and outputting it PrintWriter out = response.getWriter(); out.println(""<html>""); out.println(""<head><title>XSS Fixed Page</title></head>""); out.println(""<body>""); out.println(""<h1>User Input: "" + userInput + ""</h1>""); out.println(""</body>""); out.println(""</html>""); } private String escapeHtml(String input) { return input != null ? input.replace(""&"", ""&amp;"") .replace(""<"", ""&lt;"") .replace("">"", ""&gt;"")",java,0
Clear,"To fix the insecure deserialization vulnerability in the provided code snippet, you need to implement proper security measures to prevent potential attacks like object injection or remote code execution. Here are some recommendations:

1. **Use a Secure Deserialization Mechanism**: Instead of using standard Java serialization, consider using safer alternatives like JSON or XML serialization libraries that do not execute arbitrary code during deserialization.

2. **Validate Serialized Data**: Before deserializing the data, validate it to ensure that it comes from a trusted and expected source. You can use digital signatures or checksums to verify the integrity of the serialized data.

3. **Implement Whitelisting/Blacklisting**: Maintain a list of allowed classes (whitelist) that can be deserialized and reject any other classes (blacklist). This helps prevent malicious objects from being deserialized.

4. **Disable Object Creation**: Restrict the deserialization process to only instantiate objects of specific classes that you control, avoiding unexpected object creation during deserialization.

5. **Use Serialization Filters**: Implement custom serialization filters to sanitize and validate serialized data before deserialization. This allows you to apply additional security checks on the serialized objects.

Here's an updated version of your code snippet incorporating some of these security measures:

```java","To fix the insecure deserialization vulnerability in the provided code snippet, you need to implement proper security measures to prevent potential attacks like object injection or remote code execution. Here are some recommendations: 1. **Use a Secure Deserialization Mechanism**: Instead of using standard Java serialization, consider using safer alternatives like JSON or XML serialization libraries that do not execute arbitrary code during deserialization. 2. **Validate Serialized Data**: Before deserializing the data, validate it to ensure that it comes from a trusted and expected source. You can use digital signatures or checksums to verify the integrity of the serialized data. 3. **Implement Whitelisting/Blacklisting**: Maintain a list of allowed classes (whitelist) that can be deserialized and reject any other classes (blacklist). This helps prevent malicious objects from being deserialized. 4. **Disable Object Creation**: Restrict the deserialization process to only instantiate objects of specific classes that you control, avoiding unexpected object creation during deserialization. 5. **Use Serialization Filters**: Implement custom serialization filters to sanitize and validate serialized data before deserialization. This allows you to apply additional security checks on the serialized objects. Here's an updated version of your code snippet incorporating some of these security measures: ```java",php,0
Clear,"To fix the Path Traversal vulnerability in the given code snippet, you can follow these secure coding practices:

1. Validate User Input:
   - Ensure that the user input is properly validated to prevent malicious input.
   - Restrict the input to a specific set of characters or patterns, such as alphanumeric characters or a predefined list of file names.

2. Use a Whitelist Approach:
   - Instead of directly concatenating the user input with the base path, use a whitelist approach to only allow specific files to be accessed.
   - Maintain a list of allowed file names and check if the user input matches any of these allowed names before constructing the full path.

3. Use Java NIO Paths for File Operations:
   - Instead of using `File`, prefer using Java NIO `Paths` for file operations as it provides better security features.
   - Use `Paths.get(basePath, fileName)` to construct the file path.

4. Implement File Path Sanitization:
   - Sanitize the user input by removing any relative path components (e.g., '..', './') that could lead to directory traversal attacks.
   - You can use libraries like Apache Commons IO's FilenameUtils or Guava's Files for path normalization and validation.

5. Implement","To fix the Path Traversal vulnerability in the given code snippet, you can follow these secure coding practices: 1. Validate User Input: - Ensure that the user input is properly validated to prevent malicious input. - Restrict the input to a specific set of characters or patterns, such as alphanumeric characters or a predefined list of file names. 2. Use a Whitelist Approach: - Instead of directly concatenating the user input with the base path, use a whitelist approach to only allow specific files to be accessed. - Maintain a list of allowed file names and check if the user input matches any of these allowed names before constructing the full path. 3. Use Java NIO Paths for File Operations: - Instead of using `File`, prefer using Java NIO `Paths` for file operations as it provides better security features. - Use `Paths.get(basePath, fileName)` to construct the file path. 4. Implement File Path Sanitization: - Sanitize the user input by removing any relative path components (e.g., '..', './') that could lead to directory traversal attacks. - You can use libraries like Apache Commons IO's FilenameUtils or Guava's Files for path normalization and validation. 5. Implement",php,0
Path Traversal,"import java.io.File;
import java.io.FileInputStream;
import java.io.IOException;
import java.util.Scanner;

public class PathTraversalVulnerability {
    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        System.out.print(""Enter file name: "");
        String fileName = scanner.nextLine();

        try {
            File file = new File(fileName);
            FileInputStream fis = new FileInputStream(file);

            int content;
            while ((content = fis.read()) != -1) {
                System.out.print((char) content);
            }

            fis.close();
        } catch (IOException e) {
            System.out.println(""Error reading file: "" + e.getMessage());
        }
    }
}","import java.io.File; import java.io.FileInputStream; import java.io.IOException; import java.util.Scanner; public class PathTraversalVulnerability { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter file name: ""); String fileName = scanner.nextLine(); try { File file = new File(fileName); FileInputStream fis = new FileInputStream(file); int content; while ((content = fis.read()) != -1) { System.out.print((char) content); } fis.close(); } catch (IOException e) { System.out.println(""Error reading file: "" + e.getMessage()); } } }",java,1
Insecure Deserialization,"<?php
$data = $_POST['data'];
unserialize($data); // Insecure Deserialization
?>","<?php
$data = $_POST['data'];
unserialize($data); // Insecure Deserialization
?>",php,1
Path Traversal,"import java.io.BufferedReader;
import java.io.FileReader;
import java.io.IOException;

public class PathTraversalVulnerability {

    public static void main(String[] args) {
        String filename = args[0]; // User input containing file path
        try {
            BufferedReader reader = new BufferedReader(new FileReader(filename));
            String line;
            while ((line = reader.readLine()) != null) {
                System.out.println(line);
            }
            reader.close();
        } catch (IOException e) {
            System.err.println(""Error reading file: "" + e.getMessage());
        }
    }
}","import java.io.BufferedReader; import java.io.FileReader; import java.io.IOException; public class PathTraversalVulnerability { public static void main(String[] args) { String filename = args[0]; // User input containing file path try { BufferedReader reader = new BufferedReader(new FileReader(filename)); String line; while ((line = reader.readLine()) != null) { System.out.println(line); } reader.close(); } catch (IOException e) { System.err.println(""Error reading file: "" + e.getMessage()); } } }",java,1
Command Injection,"const shell = require('child_process');
shell.exec('ping ' + userInput); // Command Injection
","const shell = require('child_process');
shell.exec('ping ' + userInput); // Command Injection
",javascript,1
Cross-Site Scripting (XSS),"import java.io.*;
import javax.servlet.*;
import javax.servlet.http.*;

public class XSSDemo extends HttpServlet {
    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        String userInput = request.getParameter(""input"");
        
        PrintWriter out = response.getWriter();
        out.println(""<html>"");
        out.println(""<body>"");
        out.println(""<h1>User Input: "" + userInput + ""</h1>""); // Vulnerable code
        out.println(""</body>"");
        out.println(""</html>"");
    }
}","import java.io.*; import javax.servlet.*; import javax.servlet.http.*; public class XSSDemo extends HttpServlet { protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { String userInput = request.getParameter(""input""); PrintWriter out = response.getWriter(); out.println(""<html>""); out.println(""<body>""); out.println(""<h1>User Input: "" + userInput + ""</h1>""); // Vulnerable code out.println(""</body>""); out.println(""</html>""); } }",java,1
Path Traversal,"import java.io.File;
import java.io.FileReader;
import java.io.IOException;
import java.util.Scanner;

public class PathTraversalVulnerableCode {
    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        
        System.out.print(""Enter the file name: "");
        String fileName = scanner.nextLine();
        
        try {
            File file = new File(fileName);
            FileReader fileReader = new FileReader(file);
            int data;
            while ((data = fileReader.read()) != -1) {
                System.out.print((char) data);
            }
            fileReader.close();
        } catch (IOException e) {
            System.out.println(""Error reading the file."");
        }
    }
}","import java.io.File; import java.io.FileReader; import java.io.IOException; import java.util.Scanner; public class PathTraversalVulnerableCode { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter the file name: ""); String fileName = scanner.nextLine(); try { File file = new File(fileName); FileReader fileReader = new FileReader(file); int data; while ((data = fileReader.read()) != -1) { System.out.print((char) data); } fileReader.close(); } catch (IOException e) { System.out.println(""Error reading the file.""); } } }",java,1
Hardcoded Secrets,"localStorage.setItem('token', 'hardcoded-secret-token-123'); // Hardcoded secret
","localStorage.setItem('token', 'hardcoded-secret-token-123'); // Hardcoded secret
",javascript,1
Path Traversal,"import os
def read_file(filename):
    with open('/var/www/uploads/' + filename, 'r') as f:
        return f.read()","import os
def read_file(filename):
    with open('/var/www/uploads/' + filename, 'r') as f:
        return f.read()",python,1
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Command Injection,"import os
def backup_database(db_name):
    os.system(f""pg_dump {db_name} > backup.sql"")","import os
def backup_database(db_name):
    os.system(f""pg_dump {db_name} > backup.sql"")",python,1
Cross-Site Scripting (XSS),"import java.io.IOException;
import javax.servlet.ServletException;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

public class VulnerableServlet extends HttpServlet {

    protected void doGet(HttpServletRequest request, HttpServletResponse response)
            throws ServletException, IOException {
        String userInput = request.getParameter(""input"");
        String output = ""<p>User input: "" + userInput + ""</p>"";
        
        response.setContentType(""text/html"");
        response.getWriter().write(output);
    }
}","import java.io.IOException; import javax.servlet.ServletException; import javax.servlet.http.HttpServlet; import javax.servlet.http.HttpServletRequest; import javax.servlet.http.HttpServletResponse; public class VulnerableServlet extends HttpServlet { protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { String userInput = request.getParameter(""input""); String output = ""<p>User input: "" + userInput + ""</p>""; response.setContentType(""text/html""); response.getWriter().write(output); } }",java,1
Clear,"import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class SecureCommandExecution {
    public static void main(String[] args) {
        try {
            BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));
            System.out.print(""Enter a command to execute: "");
            String command = reader.readLine();

            // Use ProcessBuilder to safely execute the command
            ProcessBuilder processBuilder = new ProcessBuilder(command);
            Process process = processBuilder.start();

            BufferedReader inputReader = new BufferedReader(new InputStreamReader(process.getInputStream()));
            String line;
            while ((line = inputReader.readLine()) != null) {
                System.out.println(line);
            }

        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}","import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class SecureCommandExecution { public static void main(String[] args) { try { BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a command to execute: ""); String command = reader.readLine(); // Use ProcessBuilder to safely execute the command ProcessBuilder processBuilder = new ProcessBuilder(command); Process process = processBuilder.start(); BufferedReader inputReader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = inputReader.readLine()) != null) { System.out.println(line); } } catch (IOException e) { e.printStackTrace(); } } }",java,0
Command Injection,"import java.io.IOException;

public class CommandInjectionExample {
    public static void main(String[] args) {
        try {
            String command = ""ping "" + args[0]; // User input not properly validated
            Runtime.getRuntime().exec(command);
        } catch (IOException e) {
            System.out.println(""An error occurred."");
        }
    }
}","import java.io.IOException; public class CommandInjectionExample { public static void main(String[] args) { try { String command = ""ping "" + args[0]; // User input not properly validated Runtime.getRuntime().exec(command); } catch (IOException e) { System.out.println(""An error occurred.""); } } }",java,1
Insecure Deserialization,"<?php
$data = $_POST['data'];
unserialize($data); // Insecure Deserialization
?>","<?php
$data = $_POST['data'];
unserialize($data); // Insecure Deserialization
?>",php,1
Clear,"import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;

public class SQLInjectionSecure {

    public static void main(String[] args) {
        String userInput = ""'; DROP TABLE users; --""; // User input potentially vulnerable to SQL injection

        try {
            Connection connection = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");
            
            String query = ""SELECT * FROM users WHERE username = ?"";
            PreparedStatement preparedStatement = connection.prepareStatement(query);
            preparedStatement.setString(1, userInput);

            ResultSet resultSet = preparedStatement.executeQuery();

            while (resultSet.next()) {
                System.out.println(""User ID: "" + resultSet.getInt(""id"") + "", Username: "" + resultSet.getString(""username""));
            }

            resultSet.close();
            preparedStatement.close();
            connection.close();

        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.Connection; import java.sql.DriverManager; import java.sql.PreparedStatement; import java.sql.ResultSet; import java.sql.SQLException; public class SQLInjectionSecure { public static void main(String[] args) { String userInput = ""'; DROP TABLE users; --""; // User input potentially vulnerable to SQL injection try { Connection connection = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); String query = ""SELECT * FROM users WHERE username = ?""; PreparedStatement preparedStatement = connection.prepareStatement(query); preparedStatement.setString(1, userInput); ResultSet resultSet = preparedStatement.executeQuery(); while (resultSet.next()) { System.out.println(""User ID: "" + resultSet.getInt(""id"") + "", Username: "" + resultSet.getString(""username"")); } resultSet.close(); preparedStatement.close(); connection.close(); } catch (SQLException e) { e.printStackTrace(); } } }",java,0
Hardcoded Secrets,"import requests
def call_api():
    api_key = ""sk_live_1234567890abcdef""
    headers = {'Authorization': f'Bearer {api_key}'}
    return requests.get('https://api.example.com/data', headers=headers)","import requests
def call_api():
    api_key = ""sk_live_1234567890abcdef""
    headers = {'Authorization': f'Bearer {api_key}'}
    return requests.get('https://api.example.com/data', headers=headers)",python,1
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Clear,"const userInput = new URLSearchParams(window.location.search).get('input');
const safeOutput = document.createElement('div');
safeOutput.textContent = userInput; // Safe DOM manipulation
document.body.appendChild(safeOutput);
","const userInput = new URLSearchParams(window.location.search).get('input');
const safeOutput = document.createElement('div');
safeOutput.textContent = userInput; // Safe DOM manipulation
document.body.appendChild(safeOutput);
",javascript,0
Clear,"const token = process.env.API_TOKEN; // Environment variable
fetch('/api/data', {
    headers: { 'Authorization': `Bearer ${token}` }
});
","const token = process.env.API_TOKEN; // Environment variable
fetch('/api/data', {
    headers: { 'Authorization': `Bearer ${token}` }
});
",javascript,0
Clear,"String username = request.getParameter(""username"");
String password = request.getParameter(""password"");

// Use a PreparedStatement to prepare the SQL query with placeholders for parameters
String query = ""SELECT * FROM users WHERE username=? AND password=?"";
PreparedStatement preparedStatement = connection.prepareStatement(query);

// Set the values for the parameters in the PreparedStatement
preparedStatement.setString(1, username);
preparedStatement.setString(2, password);

// Execute the query using the PreparedStatement
ResultSet resultSet = preparedStatement.executeQuery();","String username = request.getParameter(""username""); String password = request.getParameter(""password""); // Use a PreparedStatement to prepare the SQL query with placeholders for parameters String query = ""SELECT * FROM users WHERE username=? AND password=?""; PreparedStatement preparedStatement = connection.prepareStatement(query); // Set the values for the parameters in the PreparedStatement preparedStatement.setString(1, username); preparedStatement.setString(2, password); // Execute the query using the PreparedStatement ResultSet resultSet = preparedStatement.executeQuery();",php,0
Clear,"<?php
$username = $_POST['username'];
$stmt = $pdo->prepare(""SELECT * FROM users WHERE username = ?"");
$stmt->execute([$username]); // Parameterized query
?>","<?php
$username = $_POST['username'];
$stmt = $pdo->prepare(""SELECT * FROM users WHERE username = ?"");
$stmt->execute([$username]); // Parameterized query
?>",php,0
Clear,"#include <iostream>
#include <sstream>

int safe_string_to_int(const std::string& str) {
    std::stringstream ss(str);
    int value;
    if (ss >> value) {
        return value;
    }
    throw std::invalid_argument(""Invalid integer"");
}","#include <iostream>
#include <sstream>

int safe_string_to_int(const std::string& str) {
    std::stringstream ss(str);
    int value;
    if (ss >> value) {
        return value;
    }
    throw std::invalid_argument(""Invalid integer"");
}",cpp,0
Path Traversal,"def get_user_file(username, filepath):
    import os
    base_path = f""/home/{username}/files/""
    full_path = base_path + filepath
    with open(full_path, 'r') as f:
        return f.read()","def get_user_file(username, filepath):
    import os
    base_path = f""/home/{username}/files/""
    full_path = base_path + filepath
    with open(full_path, 'r') as f:
        return f.read()",python,1
Clear,"#include <iostream>
#include <memory>

void safe_memory_management() {
    auto ptr = std::make_unique<int>(42);
    std::cout << *ptr << std::endl;
}","#include <iostream>
#include <memory>

void safe_memory_management() {
    auto ptr = std::make_unique<int>(42);
    std::cout << *ptr << std::endl;
}",cpp,0
Command Injection,"const shell = require('child_process');
shell.exec('ping ' + userInput); // Command Injection
","const shell = require('child_process');
shell.exec('ping ' + userInput); // Command Injection
",javascript,1
Clear,"import pickle
def safe_deserialize(data):
    allowed_classes = {'SafeClass', 'AnotherSafeClass'}
    return pickle.loads(data)","import pickle
def safe_deserialize(data):
    allowed_classes = {'SafeClass', 'AnotherSafeClass'}
    return pickle.loads(data)",python,0
Clear,"import java.io.*;
import javax.servlet.*;
import javax.servlet.http.*;
import org.owasp.encoder.Encode;

public class XSSFixedServlet extends HttpServlet {

    protected void doGet(HttpServletRequest request, HttpServletResponse response)
            throws ServletException, IOException {
        
        String userInput = request.getParameter(""input"");
        
        // Sanitize and encode user input before embedding it into the HTML response
        String sanitizedInput = Encode.forHtml(userInput);
        
        String htmlResponse = ""<html><body><h1>Welcome "" + sanitizedInput + ""</h1></body></html>"";
        
        response.setContentType(""text/html"");
        PrintWriter out = response.getWriter();
        out.println(htmlResponse);
    }
}","import java.io.*; import javax.servlet.*; import javax.servlet.http.*; import org.owasp.encoder.Encode; public class XSSFixedServlet extends HttpServlet { protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { String userInput = request.getParameter(""input""); // Sanitize and encode user input before embedding it into the HTML response String sanitizedInput = Encode.forHtml(userInput); String htmlResponse = ""<html><body><h1>Welcome "" + sanitizedInput + ""</h1></body></html>""; response.setContentType(""text/html""); PrintWriter out = response.getWriter(); out.println(htmlResponse); } }",java,0
Cross-Site Scripting (XSS),"import java.io.IOException;
import java.io.PrintWriter;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

public class VulnerableServlet extends HttpServlet {

    protected void doPost(HttpServletRequest request, HttpServletResponse response) throws IOException {
        String userInput = request.getParameter(""input"");
        PrintWriter out = response.getWriter();
        
        out.println(""<html>"");
        out.println(""<body>"");
        out.println(""<h1>Your input: "" + userInput + ""</h1>""); // User input is directly output to the response
        out.println(""</body>"");
        out.println(""</html>"");
    }
}","import java.io.IOException; import java.io.PrintWriter; import javax.servlet.http.HttpServlet; import javax.servlet.http.HttpServletRequest; import javax.servlet.http.HttpServletResponse; public class VulnerableServlet extends HttpServlet { protected void doPost(HttpServletRequest request, HttpServletResponse response) throws IOException { String userInput = request.getParameter(""input""); PrintWriter out = response.getWriter(); out.println(""<html>""); out.println(""<body>""); out.println(""<h1>Your input: "" + userInput + ""</h1>""); // User input is directly output to the response out.println(""</body>""); out.println(""</html>""); } }",java,1
Cross-Site Scripting (XSS),"import java.io.*;

public class XSSVulnerableCode {
    public static void main(String[] args) {
        BufferedReader br = new BufferedReader(new InputStreamReader(System.in));
        
        try {
            System.out.print(""Enter your name: "");
            String name = br.readLine();
            
            System.out.println(""Hello, "" + name + ""!""); // This line is vulnerable to XSS
            
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}","import java.io.*; public class XSSVulnerableCode { public static void main(String[] args) { BufferedReader br = new BufferedReader(new InputStreamReader(System.in)); try { System.out.print(""Enter your name: ""); String name = br.readLine(); System.out.println(""Hello, "" + name + ""!""); // This line is vulnerable to XSS } catch (IOException e) { e.printStackTrace(); } } }",java,1
Insecure Deserialization,"<?php
$data = $_POST['data'];
unserialize($data); // Insecure Deserialization
?>","<?php
$data = $_POST['data'];
unserialize($data); // Insecure Deserialization
?>",php,1
Memory Corruption,"#include <iostream>

void unsafe_pointer_arithmetic(int* array, int size) {
    for (int i = 0; i <= size; i++) {
        std::cout << *(array + i) << std::endl; // potential out-of-bounds
    }
}","#include <iostream>

void unsafe_pointer_arithmetic(int* array, int size) {
    for (int i = 0; i <= size; i++) {
        std::cout << *(array + i) << std::endl; // potential out-of-bounds
    }
}",cpp,1
Cross-Site Scripting (XSS),"import java.io.*;

public class XSSVulnerableCode {

    public static void main(String[] args) {
        BufferedReader br = new BufferedReader(new InputStreamReader(System.in));

        try {
            System.out.println(""Enter your name:"");
            String name = br.readLine();

            System.out.println(""Hello, "" + name + ""!""); // Vulnerability here

        } catch (IOException e) {
            System.out.println(""An error occurred."");
        }
    }
}","import java.io.*; public class XSSVulnerableCode { public static void main(String[] args) { BufferedReader br = new BufferedReader(new InputStreamReader(System.in)); try { System.out.println(""Enter your name:""); String name = br.readLine(); System.out.println(""Hello, "" + name + ""!""); // Vulnerability here } catch (IOException e) { System.out.println(""An error occurred.""); } } }",java,1
Clear,"import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;

public class SecureSQLCode {

    public static void main(String[] args) {
        String userInput = ""'; DROP TABLE users; --"";

        try {
            Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");
            
            String query = ""SELECT * FROM users WHERE username = ?"";
            PreparedStatement stmt = conn.prepareStatement(query);
            stmt.setString(1, userInput);

            ResultSet rs = stmt.executeQuery();

            while (rs.next()) {
                System.out.println(rs.getString(""username""));
            }

            rs.close();
            stmt.close();
            conn.close();
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.Connection; import java.sql.DriverManager; import java.sql.PreparedStatement; import java.sql.ResultSet; import java.sql.SQLException; public class SecureSQLCode { public static void main(String[] args) { String userInput = ""'; DROP TABLE users; --""; try { Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); String query = ""SELECT * FROM users WHERE username = ?""; PreparedStatement stmt = conn.prepareStatement(query); stmt.setString(1, userInput); ResultSet rs = stmt.executeQuery(); while (rs.next()) { System.out.println(rs.getString(""username"")); } rs.close(); stmt.close(); conn.close(); } catch (SQLException e) { e.printStackTrace(); } } }",java,0
Clear,"import requests
def safe_api_call():
    api_key = os.environ.get('API_KEY')
    headers = {'Authorization': f'Bearer {api_key}'}
    return requests.get('https://api.example.com/data', headers=headers)","import requests
def safe_api_call():
    api_key = os.environ.get('API_KEY')
    headers = {'Authorization': f'Bearer {api_key}'}
    return requests.get('https://api.example.com/data', headers=headers)",python,0
Clear,"#include <iostream>
#include <sstream>

int safe_string_to_int(const std::string& str) {
    std::stringstream ss(str);
    int value;
    if (ss >> value) {
        return value;
    }
    throw std::invalid_argument(""Invalid integer"");
}","#include <iostream>
#include <sstream>

int safe_string_to_int(const std::string& str) {
    std::stringstream ss(str);
    int value;
    if (ss >> value) {
        return value;
    }
    throw std::invalid_argument(""Invalid integer"");
}",cpp,0
Clear,"import subprocess
def safe_directory_listing(path):
    result = subprocess.run(['ls', path], capture_output=True, text=True)
    return result.stdout","import subprocess
def safe_directory_listing(path):
    result = subprocess.run(['ls', path], capture_output=True, text=True)
    return result.stdout",python,0
Clear,"#include <stdio.h>
#include <string.h>

int safe_buffer_operation(char *input) {
    char buffer[100];
    if (strlen(input) < sizeof(buffer)) {
        strcpy(buffer, input);
        return 0;
    }
    return -1; // buffer too small
}","#include <stdio.h>
#include <string.h>

int safe_buffer_operation(char *input) {
    char buffer[100];
    if (strlen(input) < sizeof(buffer)) {
        strcpy(buffer, input);
        return 0;
    }
    return -1; // buffer too small
}",c,0
Clear,"#include <stdio.h>
#include <stdlib.h>

void safe_file_operation(const char *filename) {
    FILE *file = fopen(filename, ""r"");
    if (file != NULL) {
        char buffer[256];
        while (fgets(buffer, sizeof(buffer), file)) {
            printf(""%s"", buffer);
        }
        fclose(file);
    }
}","#include <stdio.h>
#include <stdlib.h>

void safe_file_operation(const char *filename) {
    FILE *file = fopen(filename, ""r"");
    if (file != NULL) {
        char buffer[256];
        while (fgets(buffer, sizeof(buffer), file)) {
            printf(""%s"", buffer);
        }
        fclose(file);
    }
}",c,0
Clear,"import subprocess
def safe_database_backup(db_name):
    result = subprocess.run(['pg_dump', db_name], capture_output=True, text=True)
    with open('backup.sql', 'w') as f:
        f.write(result.stdout)","import subprocess
def safe_database_backup(db_name):
    result = subprocess.run(['pg_dump', db_name], capture_output=True, text=True)
    with open('backup.sql', 'w') as f:
        f.write(result.stdout)",python,0
Clear,"import subprocess
def safe_database_backup(db_name):
    result = subprocess.run(['pg_dump', db_name], capture_output=True, text=True)
    with open('backup.sql', 'w') as f:
        f.write(result.stdout)","import subprocess
def safe_database_backup(db_name):
    result = subprocess.run(['pg_dump', db_name], capture_output=True, text=True)
    with open('backup.sql', 'w') as f:
        f.write(result.stdout)",python,0
Clear,"<?php
$cmd = escapeshellarg($_GET['cmd']);
system(""ls "" . $cmd); // Escaped command
?>","<?php
$cmd = escapeshellarg($_GET['cmd']);
system(""ls "" . $cmd); // Escaped command
?>",php,0
Clear,"To secure the code against Insecure Deserialization vulnerabilities, you can implement the following measures:

1. Use a whitelist approach: Instead of deserializing any object that comes from user input, define a whitelist of allowed classes that can be deserialized. Only deserialize objects of these whitelisted classes.

2. Use a custom SerializationFilter: Implement a custom SerializationFilter to validate the incoming serialized data before deserialization. The filter should check for potentially malicious or unexpected content in the serialized data.

3. Validate input data: Validate and sanitize the user input before deserialization to ensure that it conforms to expected formats and does not contain any unexpected or malicious content.

4. Implement input validation and integrity checks: Ensure that the serialized data has not been tampered with during transmission by implementing integrity checks such as using digital signatures or checksums.

5. Use safer alternatives: If possible, consider using safer serialization mechanisms such as JSON or XML serialization instead of Java serialization which is known to be vulnerable.

Here's an example of how you can modify your code to incorporate some of these security measures:

```java
import java.io.*;
import java.util.ArrayList;
import java.util.List;

public class SecureDeserializationExample {
    // Define a whitelist of allowed classes for des","To secure the code against Insecure Deserialization vulnerabilities, you can implement the following measures: 1. Use a whitelist approach: Instead of deserializing any object that comes from user input, define a whitelist of allowed classes that can be deserialized. Only deserialize objects of these whitelisted classes. 2. Use a custom SerializationFilter: Implement a custom SerializationFilter to validate the incoming serialized data before deserialization. The filter should check for potentially malicious or unexpected content in the serialized data. 3. Validate input data: Validate and sanitize the user input before deserialization to ensure that it conforms to expected formats and does not contain any unexpected or malicious content. 4. Implement input validation and integrity checks: Ensure that the serialized data has not been tampered with during transmission by implementing integrity checks such as using digital signatures or checksums. 5. Use safer alternatives: If possible, consider using safer serialization mechanisms such as JSON or XML serialization instead of Java serialization which is known to be vulnerable. Here's an example of how you can modify your code to incorporate some of these security measures: ```java import java.io.*; import java.util.ArrayList; import java.util.List; public class SecureDeserializationExample { // Define a whitelist of allowed classes for des",java,0
Clear,"<?php
$file = basename($_GET['file']);
$allowed = ['page1.php', 'page2.php'];
if (in_array($file, $allowed)) {
    include($file);
}
?>","<?php
$file = basename($_GET['file']);
$allowed = ['page1.php', 'page2.php'];
if (in_array($file, $allowed)) {
    include($file);
}
?>",php,0
Insecure Deserialization,"<?php
$data = $_POST['data'];
unserialize($data); // Insecure Deserialization
?>","<?php
$data = $_POST['data'];
unserialize($data); // Insecure Deserialization
?>",php,1
Clear,"import java.io.*;
import javax.servlet.*;
import javax.servlet.http.*;
import org.owasp.encoder.Encode;

public class SecureServlet extends HttpServlet {
    
    @Override
    protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        
        String userInput = request.getParameter(""input"");
        
        // Sanitize and escape user input to prevent XSS
        String sanitizedInput = Encode.forHtml(userInput);
        
        String output = ""<p>User input: "" + sanitizedInput + ""</p>"";
        
        response.setContentType(""text/html"");
        PrintWriter out = response.getWriter();
        out.println(output);
    }
}","import java.io.*; import javax.servlet.*; import javax.servlet.http.*; import org.owasp.encoder.Encode; public class SecureServlet extends HttpServlet { @Override protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { String userInput = request.getParameter(""input""); // Sanitize and escape user input to prevent XSS String sanitizedInput = Encode.forHtml(userInput); String output = ""<p>User input: "" + sanitizedInput + ""</p>""; response.setContentType(""text/html""); PrintWriter out = response.getWriter(); out.println(output); } }",java,0
Out-of-Bounds,"#include <iostream>

class UnsafeClass {
    int data[10];
public:
    int get_data(int index) {
        return data[index]; // no bounds checking
    }
};","#include <iostream>

class UnsafeClass {
    int data[10];
public:
    int get_data(int index) {
        return data[index]; // no bounds checking
    }
};",cpp,1
SQL Injection,"import sqlite3
def get_user_data(username):
    conn = sqlite3.connect('database.db')
    cursor = conn.cursor()
    query = ""SELECT * FROM users WHERE username = '"" + username + ""'""
    cursor.execute(query)
    return cursor.fetchall()","import sqlite3
def get_user_data(username):
    conn = sqlite3.connect('database.db')
    cursor = conn.cursor()
    query = ""SELECT * FROM users WHERE username = '"" + username + ""'""
    cursor.execute(query)
    return cursor.fetchall()",python,1
Hardcoded Secrets,"DATABASE_PASSWORD = ""my_super_secret_password_123""
def db_connect():
    import psycopg2
    return psycopg2.connect(f""dbname=test user=admin password={DATABASE_PASSWORD}"")","DATABASE_PASSWORD = ""my_super_secret_password_123""
def db_connect():
    import psycopg2
    return psycopg2.connect(f""dbname=test user=admin password={DATABASE_PASSWORD}"")",python,1
Clear,"To fix the insecure deserialization vulnerability in the provided Java code snippet, we need to implement proper security measures. Here is an improved version of the code that includes validation and safe deserialization practices:

```java
import java.io.*;
import java.util.Base64;

public class SecureDeserializationExample {

    public static void main(String[] args) {
        // Simulating user input (in this case, a serialized object encoded as Base64)
        String userInputBase64 = ""/* Base64-encoded serialized object content */"";

        try {
            // Decode the Base64 input
            byte[] decodedInput = Base64.getDecoder().decode(userInputBase64);

            // Validate the decoded input to ensure it is not tampered with
            if (!isValidSerializedObject(decodedInput)) {
                throw new SecurityException(""Invalid or tampered serialized object"");
            }

            // Deserialize the validated input
            ObjectInputStream ois = new ObjectInputStream(new ByteArrayInputStream(decodedInput));
            Object obj = ois.readObject();

            // Perform operations with the deserialized object
            System.out.println(""Deserialized object: "" + obj);

        } catch (IOException | ClassNotFoundException | SecurityException e) {
            e.printStackTrace();
        }
    }

    private static boolean","To fix the insecure deserialization vulnerability in the provided Java code snippet, we need to implement proper security measures. Here is an improved version of the code that includes validation and safe deserialization practices: ```java import java.io.*; import java.util.Base64; public class SecureDeserializationExample { public static void main(String[] args) { // Simulating user input (in this case, a serialized object encoded as Base64) String userInputBase64 = ""/* Base64-encoded serialized object content */""; try { // Decode the Base64 input byte[] decodedInput = Base64.getDecoder().decode(userInputBase64); // Validate the decoded input to ensure it is not tampered with if (!isValidSerializedObject(decodedInput)) { throw new SecurityException(""Invalid or tampered serialized object""); } // Deserialize the validated input ObjectInputStream ois = new ObjectInputStream(new ByteArrayInputStream(decodedInput)); Object obj = ois.readObject(); // Perform operations with the deserialized object System.out.println(""Deserialized object: "" + obj); } catch (IOException | ClassNotFoundException | SecurityException e) { e.printStackTrace(); } } private static boolean",java,0
Clear,"#include <stdio.h>
#include <stdlib.h>

int safe_string_to_int(const char *str) {
    char *endptr;
    long value = strtol(str, &endptr, 10);
    if (*endptr != '\0' || str == endptr) {
        return -1; // error
    }
    return (int)value;
}","#include <stdio.h>
#include <stdlib.h>

int safe_string_to_int(const char *str) {
    char *endptr;
    long value = strtol(str, &endptr, 10);
    if (*endptr != '\0' || str == endptr) {
        return -1; // error
    }
    return (int)value;
}",c,0
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Memory Corruption,"#include <iostream>

void unsafe_virtual_call() {
    // Potential vtable corruption vulnerability
    class Base {
    public:
        virtual void func() { std::cout << ""Base"" << std::endl; }
    };
    
    class Derived : public Base {
    public:
        void func() override { std::cout << ""Derived"" << std::endl; }
    };
}","#include <iostream>

void unsafe_virtual_call() {
    // Potential vtable corruption vulnerability
    class Base {
    public:
        virtual void func() { std::cout << ""Base"" << std::endl; }
    };
    
    class Derived : public Base {
    public:
        void func() override { std::cout << ""Derived"" << std::endl; }
    };
}",cpp,1
Clear,"import requests
def safe_fetch_url(url):
    allowed_domains = ['example.com', 'api.trusted.com']
    from urllib.parse import urlparse
    domain = urlparse(url).netloc
    if domain not in allowed_domains:
        raise ValueError(""Domain not allowed"")
    return requests.get(url).text","import requests
def safe_fetch_url(url):
    allowed_domains = ['example.com', 'api.trusted.com']
    from urllib.parse import urlparse
    domain = urlparse(url).netloc
    if domain not in allowed_domains:
        raise ValueError(""Domain not allowed"")
    return requests.get(url).text",python,0
SQL Injection,"import sqlite3
def get_user_data(username):
    conn = sqlite3.connect('database.db')
    cursor = conn.cursor()
    query = ""SELECT * FROM users WHERE username = '"" + username + ""'""
    cursor.execute(query)
    return cursor.fetchall()","import sqlite3
def get_user_data(username):
    conn = sqlite3.connect('database.db')
    cursor = conn.cursor()
    query = ""SELECT * FROM users WHERE username = '"" + username + ""'""
    cursor.execute(query)
    return cursor.fetchall()",python,1
Code Injection,"const userData = eval('(' + userInput + ')'); // eval injection
","const userData = eval('(' + userInput + ')'); // eval injection
",javascript,1
XSS,"<?php
echo $_GET['message']; // XSS
?>","<?php
echo $_GET['message']; // XSS
?>",php,1
Hardcoded Secrets,"localStorage.setItem('token', 'hardcoded-secret-token-123'); // Hardcoded secret
","localStorage.setItem('token', 'hardcoded-secret-token-123'); // Hardcoded secret
",javascript,1
SQL Injection,"<?php
$username = $_POST['username'];
$query = ""SELECT * FROM users WHERE username = '$username'"";
$result = mysql_query($query); // SQL Injection
?>","<?php
$username = $_POST['username'];
$query = ""SELECT * FROM users WHERE username = '$username'"";
$result = mysql_query($query); // SQL Injection
?>",php,1
Clear,"import json
def parse_safe_json(json_str):
    try:
        return json.loads(json_str)
    except json.JSONDecodeError:
        raise ValueError(""Invalid JSON"")","import json
def parse_safe_json(json_str):
    try:
        return json.loads(json_str)
    except json.JSONDecodeError:
        raise ValueError(""Invalid JSON"")",python,0
Clear,"import subprocess
def safe_ping(host):
    import re
    if not re.match(r'^[a-zA-Z0-9.-]+$', host):
        raise ValueError(""Invalid host"")
    result = subprocess.run(['ping', '-c', '4', host], capture_output=True, text=True)
    return result.stdout","import subprocess
def safe_ping(host):
    import re
    if not re.match(r'^[a-zA-Z0-9.-]+$', host):
        raise ValueError(""Invalid host"")
    result = subprocess.run(['ping', '-c', '4', host], capture_output=True, text=True)
    return result.stdout",python,0
Insecure Deserialization,"<?php
$data = $_POST['data'];
unserialize($data); // Insecure Deserialization
?>","<?php
$data = $_POST['data'];
unserialize($data); // Insecure Deserialization
?>",php,1
Clear,"const token = process.env.API_TOKEN; // Environment variable
fetch('/api/data', {
    headers: { 'Authorization': `Bearer ${token}` }
});
","const token = process.env.API_TOKEN; // Environment variable
fetch('/api/data', {
    headers: { 'Authorization': `Bearer ${token}` }
});
",javascript,0
SSRF,"import requests
def fetch_url(url):
    return requests.get(url).text","import requests
def fetch_url(url):
    return requests.get(url).text",python,1
SQL Injection,"import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Statement;

public class SQLInjectionExample {

    public static void main(String[] args) {
        String userInput = ""'; DROP TABLE users; --""; // Malicious input

        try {
            Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");
            Statement stmt = conn.createStatement();

            String query = ""SELECT * FROM users WHERE username = '"" + userInput + ""'"";
            ResultSet rs = stmt.executeQuery(query);

            while (rs.next()) {
                System.out.println(""Username: "" + rs.getString(""username""));
                System.out.println(""Password: "" + rs.getString(""password""));
            }

            conn.close();
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.Connection; import java.sql.DriverManager; import java.sql.ResultSet; import java.sql.SQLException; import java.sql.Statement; public class SQLInjectionExample { public static void main(String[] args) { String userInput = ""'; DROP TABLE users; --""; // Malicious input try { Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); Statement stmt = conn.createStatement(); String query = ""SELECT * FROM users WHERE username = '"" + userInput + ""'""; ResultSet rs = stmt.executeQuery(query); while (rs.next()) { System.out.println(""Username: "" + rs.getString(""username"")); System.out.println(""Password: "" + rs.getString(""password"")); } conn.close(); } catch (SQLException e) { e.printStackTrace(); } } }",java,1
Clear,"#include <iostream>
#include <sstream>

int safe_string_to_int(const std::string& str) {
    std::stringstream ss(str);
    int value;
    if (ss >> value) {
        return value;
    }
    throw std::invalid_argument(""Invalid integer"");
}","#include <iostream>
#include <sstream>

int safe_string_to_int(const std::string& str) {
    std::stringstream ss(str);
    int value;
    if (ss >> value) {
        return value;
    }
    throw std::invalid_argument(""Invalid integer"");
}",cpp,0
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Clear,"#include <stdio.h>
#include <stdlib.h>

void safe_file_operation(const char *filename) {
    FILE *file = fopen(filename, ""r"");
    if (file != NULL) {
        char buffer[256];
        while (fgets(buffer, sizeof(buffer), file)) {
            printf(""%s"", buffer);
        }
        fclose(file);
    }
}","#include <stdio.h>
#include <stdlib.h>

void safe_file_operation(const char *filename) {
    FILE *file = fopen(filename, ""r"");
    if (file != NULL) {
        char buffer[256];
        while (fgets(buffer, sizeof(buffer), file)) {
            printf(""%s"", buffer);
        }
        fclose(file);
    }
}",c,0
Cross-Site Scripting (XSS),"import java.io.*;
import javax.servlet.*;
import javax.servlet.http.*;

public class XSSVulnerableServlet extends HttpServlet {
    protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        String userInput = request.getParameter(""userInput"");
        
        PrintWriter out = response.getWriter();
        out.println(""<html>"");
        out.println(""<head><title>XSS Vulnerable Page</title></head>"");
        out.println(""<body>"");
        out.println(""<h1>User Input:</h1>"");
        out.println(userInput); // User input is directly printed without any sanitization
        out.println(""</body>"");
        out.println(""</html>"");
    }
}","import java.io.*; import javax.servlet.*; import javax.servlet.http.*; public class XSSVulnerableServlet extends HttpServlet { protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { String userInput = request.getParameter(""userInput""); PrintWriter out = response.getWriter(); out.println(""<html>""); out.println(""<head><title>XSS Vulnerable Page</title></head>""); out.println(""<body>""); out.println(""<h1>User Input:</h1>""); out.println(userInput); // User input is directly printed without any sanitization out.println(""</body>""); out.println(""</html>""); } }",java,1
Memory Corruption,"#include <iostream>

void unsafe_pointer_arithmetic(int* array, int size) {
    for (int i = 0; i <= size; i++) {
        std::cout << *(array + i) << std::endl; // potential out-of-bounds
    }
}","#include <iostream>

void unsafe_pointer_arithmetic(int* array, int size) {
    for (int i = 0; i <= size; i++) {
        std::cout << *(array + i) << std::endl; // potential out-of-bounds
    }
}",cpp,1
Clear,"To fix the SQL Injection vulnerability in the provided Java code snippet, you should use parameterized queries instead of directly concatenating user input into the SQL query. Parameterized queries help prevent SQL Injection attacks by separating SQL code from user input.

Here's the fixed version of the code using a parameterized query:

```java
import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.util.Scanner;

public class SecureSQLCode {

    public static void main(String[] args) {
        try {
            Scanner scanner = new Scanner(System.in);
            System.out.print(""Enter a username to search for: "");
            String userInput = scanner.nextLine();

            String url = ""jdbc:mysql://localhost:3306/mydatabase"";
            String user = ""root"";
            String password = ""password"";
            Connection connection = DriverManager.getConnection(url, user, password);

            // Use a PreparedStatement with parameterized query
            String query = ""SELECT * FROM users WHERE username=?"";
            PreparedStatement preparedStatement = connection.prepareStatement(query);
            
            // Set the parameter value safely
            preparedStatement.setString(1, userInput);

            ResultSet resultSet = preparedStatement.executeQuery();

            while (resultSet.next()) {
                System.out.println(""User found with ID: ""","To fix the SQL Injection vulnerability in the provided Java code snippet, you should use parameterized queries instead of directly concatenating user input into the SQL query. Parameterized queries help prevent SQL Injection attacks by separating SQL code from user input. Here's the fixed version of the code using a parameterized query: ```java import java.sql.Connection; import java.sql.DriverManager; import java.sql.PreparedStatement; import java.sql.ResultSet; import java.util.Scanner; public class SecureSQLCode { public static void main(String[] args) { try { Scanner scanner = new Scanner(System.in); System.out.print(""Enter a username to search for: ""); String userInput = scanner.nextLine(); String url = ""jdbc:mysql://localhost:3306/mydatabase""; String user = ""root""; String password = ""password""; Connection connection = DriverManager.getConnection(url, user, password); // Use a PreparedStatement with parameterized query String query = ""SELECT * FROM users WHERE username=?""; PreparedStatement preparedStatement = connection.prepareStatement(query); // Set the parameter value safely preparedStatement.setString(1, userInput); ResultSet resultSet = preparedStatement.executeQuery(); while (resultSet.next()) { System.out.println(""User found with ID: """,java,0
Clear,"<?php
$username = $_POST['username'];
$stmt = $pdo->prepare(""SELECT * FROM users WHERE username = ?"");
$stmt->execute([$username]); // Parameterized query
?>","<?php
$username = $_POST['username'];
$stmt = $pdo->prepare(""SELECT * FROM users WHERE username = ?"");
$stmt->execute([$username]); // Parameterized query
?>",php,0
Clear,"#include <iostream>
#include <vector>
#include <stdexcept>

int safe_vector_access(const std::vector<int>& vec, size_t index) {
    if (index >= vec.size()) {
        throw std::out_of_range(""Index out of range"");
    }
    return vec[index];
}","#include <iostream>
#include <vector>
#include <stdexcept>

int safe_vector_access(const std::vector<int>& vec, size_t index) {
    if (index >= vec.size()) {
        throw std::out_of_range(""Index out of range"");
    }
    return vec[index];
}",cpp,0
Clear,"import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class SafeCommandExecution {
    public static void main(String[] args) {
        try {
            BufferedReader br = new BufferedReader(new InputStreamReader(System.in));
            System.out.print(""Enter a command to execute: "");
            String command = br.readLine();

            // Sanitize the input command
            String[] safeCommand = {""sh"", ""-c"", command}; // Use shell with -c option for better safety

            Process process = new ProcessBuilder(safeCommand).start();
            BufferedReader reader = new BufferedReader(new InputStreamReader(process.getInputStream()));
            String line;

            while ((line = reader.readLine()) != null) {
                System.out.println(line);
            }

        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}","import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class SafeCommandExecution { public static void main(String[] args) { try { BufferedReader br = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a command to execute: ""); String command = br.readLine(); // Sanitize the input command String[] safeCommand = {""sh"", ""-c"", command}; // Use shell with -c option for better safety Process process = new ProcessBuilder(safeCommand).start(); BufferedReader reader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = reader.readLine()) != null) { System.out.println(line); } } catch (IOException e) { e.printStackTrace(); } } }",java,0
Insecure Deserialization,"import yaml
def load_config(config_str):
    return yaml.load(config_str, Loader=yaml.Loader)","import yaml
def load_config(config_str):
    return yaml.load(config_str, Loader=yaml.Loader)",python,1
Command Injection,"const shell = require('child_process');
shell.exec('ping ' + userInput); // Command Injection
","const shell = require('child_process');
shell.exec('ping ' + userInput); // Command Injection
",javascript,1
XSS,"<?php
echo $_GET['message']; // XSS
?>","<?php
echo $_GET['message']; // XSS
?>",php,1
Clear,"const token = process.env.API_TOKEN; // Environment variable
fetch('/api/data', {
    headers: { 'Authorization': `Bearer ${token}` }
});
","const token = process.env.API_TOKEN; // Environment variable
fetch('/api/data', {
    headers: { 'Authorization': `Bearer ${token}` }
});
",javascript,0
SQL Injection,"<?php
$username = $_POST['username'];
$query = ""SELECT * FROM users WHERE username = '$username'"";
$result = mysql_query($query); // SQL Injection
?>","<?php
$username = $_POST['username'];
$query = ""SELECT * FROM users WHERE username = '$username'"";
$result = mysql_query($query); // SQL Injection
?>",php,1
Command Injection,"const shell = require('child_process');
shell.exec('ping ' + userInput); // Command Injection
","const shell = require('child_process');
shell.exec('ping ' + userInput); // Command Injection
",javascript,1
Clear,"To fix the XSS vulnerability in the given Java code snippet, you need to properly sanitize and escape the user input before outputting it to the web page. Here's an updated version of the code that uses OWASP's ESAPI library to encode the user input:

```java
import java.io.File;
import java.io.FileWriter;
import java.io.IOException;
import org.owasp.esapi.ESAPI;
import org.owasp.esapi.codecs.HTMLEntityCodec;

public class XSSSecureCode {

    public static void main(String[] args) throws IOException {
        // Simulating user input from a form submission
        String userInput = ""<script>alert('XSS Vulnerability')</script>"";

        // Properly handling user input by encoding it using ESAPI HTML entity encoding
        HTMLEntityCodec codec = new HTMLEntityCodec();
        String encodedUserInput = codec.encodeForHTML(userInput);

        // Writing encoded user input to a web page file
        File file = new File(""index.html"");
        FileWriter writer = new FileWriter(file);
        
        writer.write(""<html>"");
        writer.write(""<body>"");
        writer.write(""<h1>Welcome, "" + encodedUserInput + ""</h1>"");
        writer.write(""</body","To fix the XSS vulnerability in the given Java code snippet, you need to properly sanitize and escape the user input before outputting it to the web page. Here's an updated version of the code that uses OWASP's ESAPI library to encode the user input: ```java import java.io.File; import java.io.FileWriter; import java.io.IOException; import org.owasp.esapi.ESAPI; import org.owasp.esapi.codecs.HTMLEntityCodec; public class XSSSecureCode { public static void main(String[] args) throws IOException { // Simulating user input from a form submission String userInput = ""<script>alert('XSS Vulnerability')</script>""; // Properly handling user input by encoding it using ESAPI HTML entity encoding HTMLEntityCodec codec = new HTMLEntityCodec(); String encodedUserInput = codec.encodeForHTML(userInput); // Writing encoded user input to a web page file File file = new File(""index.html""); FileWriter writer = new FileWriter(file); writer.write(""<html>""); writer.write(""<body>""); writer.write(""<h1>Welcome, "" + encodedUserInput + ""</h1>""); writer.write(""</body",java,0
Clear,"import java.sql.*;

public class SecureSQLInjectionExample {

    public static void main(String[] args) {
        String userInput = ""'; DROP TABLE users; --"";

        try {
            Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");
            
            // Use PreparedStatement to create a parameterized query
            String query = ""SELECT * FROM users WHERE username=?"";
            PreparedStatement pstmt = conn.prepareStatement(query);
            pstmt.setString(1, userInput);
            
            ResultSet rs = pstmt.executeQuery();
            
            while (rs.next()) {
                System.out.println(""Username: "" + rs.getString(""username""));
            }
            
            conn.close();
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.*; public class SecureSQLInjectionExample { public static void main(String[] args) { String userInput = ""'; DROP TABLE users; --""; try { Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); // Use PreparedStatement to create a parameterized query String query = ""SELECT * FROM users WHERE username=?""; PreparedStatement pstmt = conn.prepareStatement(query); pstmt.setString(1, userInput); ResultSet rs = pstmt.executeQuery(); while (rs.next()) { System.out.println(""Username: "" + rs.getString(""username"")); } conn.close(); } catch (SQLException e) { e.printStackTrace(); } } }",java,0
Insecure Deserialization,"import yaml
def load_config(config_str):
    return yaml.load(config_str, Loader=yaml.Loader)","import yaml
def load_config(config_str):
    return yaml.load(config_str, Loader=yaml.Loader)",python,1
Clear,"To fix the Path Traversal vulnerability in the given Java code snippet, you can implement the following secure code generation practices:

1. Validate User Input:
   - Before constructing the file path, validate and sanitize the user input to ensure it does not contain any malicious characters or sequences that could lead to path traversal attacks.
   - You can restrict the input to alphanumeric characters or specific patterns as per your requirements.

2. Use Absolute File Paths:
   - Instead of using a relative path like ""/path/to/files/"" + fileName, use an absolute path to ensure that the file is accessed from a specific directory.
   - Define a constant for the base directory and concatenate it with the user-provided file name.

3. Check File Existence and Location:
   - Verify that the constructed file path points to a valid location within the allowed directory structure before attempting to access it.
   - You can use methods like `File.exists()` or `File.getCanonicalPath()` to validate the file's existence and location.

4. Limit Access Rights:
   - Ensure that the application has appropriate permissions to access files in the specified directory.
   - Set strict file permissions to prevent unauthorized access.

5. Use Path APIs for Construction:
   - Instead of manually concatenating","To fix the Path Traversal vulnerability in the given Java code snippet, you can implement the following secure code generation practices: 1. Validate User Input: - Before constructing the file path, validate and sanitize the user input to ensure it does not contain any malicious characters or sequences that could lead to path traversal attacks. - You can restrict the input to alphanumeric characters or specific patterns as per your requirements. 2. Use Absolute File Paths: - Instead of using a relative path like ""/path/to/files/"" + fileName, use an absolute path to ensure that the file is accessed from a specific directory. - Define a constant for the base directory and concatenate it with the user-provided file name. 3. Check File Existence and Location: - Verify that the constructed file path points to a valid location within the allowed directory structure before attempting to access it. - You can use methods like `File.exists()` or `File.getCanonicalPath()` to validate the file's existence and location. 4. Limit Access Rights: - Ensure that the application has appropriate permissions to access files in the specified directory. - Set strict file permissions to prevent unauthorized access. 5. Use Path APIs for Construction: - Instead of manually concatenating",php,0
Path Traversal,"import java.io.File;
import java.io.FileInputStream;
import java.io.IOException;

public class PathTraversalVulnerability {

    public static void main(String[] args) {
        String userInput = ""../secret_files/top_secret.txt"";
        String basePath = ""/var/data/"";

        String filePath = basePath + userInput;

        try {
            File file = new File(filePath);
            FileInputStream fis = new FileInputStream(file);

            int content;
            while ((content = fis.read()) != -1) {
                System.out.print((char) content);
            }

            fis.close();
        } catch (IOException e) {
            System.out.println(""Error reading file: "" + e.getMessage());
        }
    }
}","import java.io.File; import java.io.FileInputStream; import java.io.IOException; public class PathTraversalVulnerability { public static void main(String[] args) { String userInput = ""../secret_files/top_secret.txt""; String basePath = ""/var/data/""; String filePath = basePath + userInput; try { File file = new File(filePath); FileInputStream fis = new FileInputStream(file); int content; while ((content = fis.read()) != -1) { System.out.print((char) content); } fis.close(); } catch (IOException e) { System.out.println(""Error reading file: "" + e.getMessage()); } } }",java,1
SQL Injection,"<?php
$username = $_POST['username'];
$query = ""SELECT * FROM users WHERE username = '$username'"";
$result = mysql_query($query); // SQL Injection
?>","<?php
$username = $_POST['username'];
$query = ""SELECT * FROM users WHERE username = '$username'"";
$result = mysql_query($query); // SQL Injection
?>",php,1
SQL Injection,"import java.sql.*;

public class SQLInjectionVulnerable {
    public static void main(String[] args) {
        String userInput = args[0]; // User input from command line argument

        try {
            Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");
            Statement stmt = conn.createStatement();

            String query = ""SELECT * FROM users WHERE username='"" + userInput + ""'"";
            ResultSet rs = stmt.executeQuery(query);

            while (rs.next()) {
                System.out.println(""User ID: "" + rs.getInt(""id"") + "", Username: "" + rs.getString(""username""));
            }

            conn.close();
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.*; public class SQLInjectionVulnerable { public static void main(String[] args) { String userInput = args[0]; // User input from command line argument try { Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); Statement stmt = conn.createStatement(); String query = ""SELECT * FROM users WHERE username='"" + userInput + ""'""; ResultSet rs = stmt.executeQuery(query); while (rs.next()) { System.out.println(""User ID: "" + rs.getInt(""id"") + "", Username: "" + rs.getString(""username"")); } conn.close(); } catch (SQLException e) { e.printStackTrace(); } } }",java,1
Path Traversal,"import java.io.File;
import java.io.FileInputStream;
import java.io.IOException;
import java.util.Scanner;

public class PathTraversalExample {
    
    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        
        System.out.print(""Enter file name to read: "");
        String fileName = scanner.nextLine();
        
        try {
            File file = new File(""C:/data/"" + fileName); // Vulnerable code, user input is directly concatenated with the base directory
            FileInputStream fis = new FileInputStream(file);
            int content;
            
            while ((content = fis.read()) != -1) {
                System.out.print((char) content);
            }
            
            fis.close();
        } catch (IOException e) {
            System.out.println(""Error reading file: "" + e.getMessage());
        }
        
        scanner.close();
    }
}","import java.io.File; import java.io.FileInputStream; import java.io.IOException; import java.util.Scanner; public class PathTraversalExample { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter file name to read: ""); String fileName = scanner.nextLine(); try { File file = new File(""C:/data/"" + fileName); // Vulnerable code, user input is directly concatenated with the base directory FileInputStream fis = new FileInputStream(file); int content; while ((content = fis.read()) != -1) { System.out.print((char) content); } fis.close(); } catch (IOException e) { System.out.println(""Error reading file: "" + e.getMessage()); } scanner.close(); } }",java,1
Path Traversal,"import java.io.File;
import java.io.IOException;
import java.nio.file.Files;
import java.nio.file.Paths;

public class PathTraversalVulnerability {

    public static void main(String[] args) {
        String userInput = ""../../../../../etc/passwd"";
        String basePath = ""/var/data/"";

        String filePath = basePath + userInput;

        try {
            File file = new File(filePath);
            if (file.exists()) {
                byte[] fileData = Files.readAllBytes(Paths.get(filePath));
                String fileContent = new String(fileData);
                System.out.println(""File content: "" + fileContent);
            } else {
                System.out.println(""File not found."");
            }
        } catch (IOException e) {
            System.out.println(""Error reading file: "" + e.getMessage());
        }
    }
}","import java.io.File; import java.io.IOException; import java.nio.file.Files; import java.nio.file.Paths; public class PathTraversalVulnerability { public static void main(String[] args) { String userInput = ""../../../../../etc/passwd""; String basePath = ""/var/data/""; String filePath = basePath + userInput; try { File file = new File(filePath); if (file.exists()) { byte[] fileData = Files.readAllBytes(Paths.get(filePath)); String fileContent = new String(fileData); System.out.println(""File content: "" + fileContent); } else { System.out.println(""File not found.""); } } catch (IOException e) { System.out.println(""Error reading file: "" + e.getMessage()); } } }",java,1
Clear,"def validate_input(input_str):
    if not isinstance(input_str, str):
        raise TypeError(""Input must be string"")
    if len(input_str) > 100:
        raise ValueError(""Input too long"")
    if '<script>' in input_str.lower():
        raise ValueError(""Invalid input"")
    return input_str.strip()","def validate_input(input_str):
    if not isinstance(input_str, str):
        raise TypeError(""Input must be string"")
    if len(input_str) > 100:
        raise ValueError(""Input too long"")
    if '<script>' in input_str.lower():
        raise ValueError(""Invalid input"")
    return input_str.strip()",python,0
SQL Injection,"import java.sql.*;

public class VulnerableCode {

    public static void main(String[] args) {
        String userInput = ""'; DROP TABLE users; --""; // Malicious input

        try {
            Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");
            Statement stmt = conn.createStatement();

            String query = ""SELECT * FROM users WHERE username = '"" + userInput + ""'"";
            ResultSet rs = stmt.executeQuery(query);

            while (rs.next()) {
                System.out.println(""Username: "" + rs.getString(""username""));
                System.out.println(""Email: "" + rs.getString(""email""));
            }

        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.*; public class VulnerableCode { public static void main(String[] args) { String userInput = ""'; DROP TABLE users; --""; // Malicious input try { Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); Statement stmt = conn.createStatement(); String query = ""SELECT * FROM users WHERE username = '"" + userInput + ""'""; ResultSet rs = stmt.executeQuery(query); while (rs.next()) { System.out.println(""Username: "" + rs.getString(""username"")); System.out.println(""Email: "" + rs.getString(""email"")); } } catch (SQLException e) { e.printStackTrace(); } } }",java,1
Clear,"To fix the Path Traversal vulnerability in the provided Java code snippet, you can implement proper security measures by validating and sanitizing user input before constructing the file path. Here is an improved version of the code that addresses this issue:

```java
import java.io.File;
import java.io.IOException;
import java.nio.file.Files;
import java.nio.file.Path;
import java.nio.file.Paths;

public class SecurePathTraversal {

    public static void main(String[] args) {
        String userInput = ""../secretFile.txt"";
        String directory = ""data/"";

        // Validate and sanitize user input to prevent path traversal
        if (!userInput.contains("".."") && !userInput.contains(""/"") && !userInput.contains(""\\"")) {
            // Construct the file path using validated user input
            Path filePath = Paths.get(directory, userInput).normalize().toAbsolutePath();

            if (filePath.startsWith(Paths.get(directory).toAbsolutePath())) {
                try {
                    // Check if the file exists and read its content
                    byte[] fileContent = Files.readAllBytes(filePath);
                    System.out.println(""File content: "" + new String(fileContent));
                } catch (IOException e) {
                    System.err.println(""Error reading file: "" + e.getMessage());
                }","To fix the Path Traversal vulnerability in the provided Java code snippet, you can implement proper security measures by validating and sanitizing user input before constructing the file path. Here is an improved version of the code that addresses this issue: ```java import java.io.File; import java.io.IOException; import java.nio.file.Files; import java.nio.file.Path; import java.nio.file.Paths; public class SecurePathTraversal { public static void main(String[] args) { String userInput = ""../secretFile.txt""; String directory = ""data/""; // Validate and sanitize user input to prevent path traversal if (!userInput.contains("".."") && !userInput.contains(""/"") && !userInput.contains(""\\"")) { // Construct the file path using validated user input Path filePath = Paths.get(directory, userInput).normalize().toAbsolutePath(); if (filePath.startsWith(Paths.get(directory).toAbsolutePath())) { try { // Check if the file exists and read its content byte[] fileContent = Files.readAllBytes(filePath); System.out.println(""File content: "" + new String(fileContent)); } catch (IOException e) { System.err.println(""Error reading file: "" + e.getMessage()); }",java,0
Path Traversal,"def get_user_file(username, filepath):
    import os
    base_path = f""/home/{username}/files/""
    full_path = base_path + filepath
    with open(full_path, 'r') as f:
        return f.read()","def get_user_file(username, filepath):
    import os
    base_path = f""/home/{username}/files/""
    full_path = base_path + filepath
    with open(full_path, 'r') as f:
        return f.read()",python,1
Clear,"const userInput = new URLSearchParams(window.location.search).get('input');
const safeOutput = document.createElement('div');
safeOutput.textContent = userInput; // Safe DOM manipulation
document.body.appendChild(safeOutput);
","const userInput = new URLSearchParams(window.location.search).get('input');
const safeOutput = document.createElement('div');
safeOutput.textContent = userInput; // Safe DOM manipulation
document.body.appendChild(safeOutput);
",javascript,0
Clear,"To fix the vulnerability of Command Injection in the provided Java code snippet, you need to sanitize and validate user input before passing it to the system shell. One common approach to prevent Command Injection is to avoid using user input directly in shell commands. Instead, you can use ProcessBuilder with a predefined list of commands or allow only specific safe commands.

Here is an updated version of the code with proper security measures:

```java
import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class SecureCommandExecutionExample {

    public static void main(String[] args) {
        try {
            BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));
            System.out.print(""Enter a command to execute: "");
            String command = reader.readLine();

            // Sanitize and validate user input
            String[] allowedCommands = {""ls"", ""dir"", ""echo""}; // Define a whitelist of allowed commands
            if (!isValidCommand(command, allowedCommands)) {
                System.out.println(""Invalid command. Only 'ls', 'dir', and 'echo' are allowed."");
                return;
            }

            ProcessBuilder processBuilder = new ProcessBuilder(command.split("" ""));
            Process process = processBuilder.start();

            BufferedReader processOutputReader = new BufferedReader(new","To fix the vulnerability of Command Injection in the provided Java code snippet, you need to sanitize and validate user input before passing it to the system shell. One common approach to prevent Command Injection is to avoid using user input directly in shell commands. Instead, you can use ProcessBuilder with a predefined list of commands or allow only specific safe commands. Here is an updated version of the code with proper security measures: ```java import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class SecureCommandExecutionExample { public static void main(String[] args) { try { BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a command to execute: ""); String command = reader.readLine(); // Sanitize and validate user input String[] allowedCommands = {""ls"", ""dir"", ""echo""}; // Define a whitelist of allowed commands if (!isValidCommand(command, allowedCommands)) { System.out.println(""Invalid command. Only 'ls', 'dir', and 'echo' are allowed.""); return; } ProcessBuilder processBuilder = new ProcessBuilder(command.split("" "")); Process process = processBuilder.start(); BufferedReader processOutputReader = new BufferedReader(new",java,0
Clear,"const userInput = new URLSearchParams(window.location.search).get('input');
const safeOutput = document.createElement('div');
safeOutput.textContent = userInput; // Safe DOM manipulation
document.body.appendChild(safeOutput);
","const userInput = new URLSearchParams(window.location.search).get('input');
const safeOutput = document.createElement('div');
safeOutput.textContent = userInput; // Safe DOM manipulation
document.body.appendChild(safeOutput);
",javascript,0
Buffer Overflow,"#include <iostream>
#include <cstdio>

void unsafe_c_input() {
    char buffer[50];
    scanf(""%s"", buffer); // no length limit
    std::cout << buffer << std::endl;
}","#include <iostream>
#include <cstdio>

void unsafe_c_input() {
    char buffer[50];
    scanf(""%s"", buffer); // no length limit
    std::cout << buffer << std::endl;
}",cpp,1
Out-of-Bounds,"#include <iostream>

class UnsafeClass {
    int data[10];
public:
    int get_data(int index) {
        return data[index]; // no bounds checking
    }
};","#include <iostream>

class UnsafeClass {
    int data[10];
public:
    int get_data(int index) {
        return data[index]; // no bounds checking
    }
};",cpp,1
Clear,"#include <stdio.h>
#include <string.h>

void safe_string_copy(char *dest, const char *src, size_t dest_size) {
    if (dest_size > 0) {
        strncpy(dest, src, dest_size - 1);
        dest[dest_size - 1] = '\0';
    }
}","#include <stdio.h>
#include <string.h>

void safe_string_copy(char *dest, const char *src, size_t dest_size) {
    if (dest_size > 0) {
        strncpy(dest, src, dest_size - 1);
        dest[dest_size - 1] = '\0';
    }
}",c,0
Clear,"import psycopg2
def safe_admin_query(admin_id):
    conn = psycopg2.connect(""dbname=test user=postgres"")
    cur = conn.cursor()
    cur.execute(""SELECT * FROM admins WHERE id = %s"", (admin_id,))
    return cur.fetchone()","import psycopg2
def safe_admin_query(admin_id):
    conn = psycopg2.connect(""dbname=test user=postgres"")
    cur = conn.cursor()
    cur.execute(""SELECT * FROM admins WHERE id = %s"", (admin_id,))
    return cur.fetchone()",python,0
Clear,"def safe_division(a, b):
    if b == 0:
        raise ValueError(""Division by zero"")
    return a / b","def safe_division(a, b):
    if b == 0:
        raise ValueError(""Division by zero"")
    return a / b",python,0
Clear,"app.get('/user/:id', (req, res) => {
    const userId = parseInt(req.params.id);
    db.query('SELECT * FROM users WHERE id = ?', [userId], (err, result) => {
        res.json(result);
    });
});
","app.get('/user/:id', (req, res) => {
    const userId = parseInt(req.params.id);
    db.query('SELECT * FROM users WHERE id = ?', [userId], (err, result) => {
        res.json(result);
    });
});
",javascript,0
Command Injection,"const shell = require('child_process');
shell.exec('ping ' + userInput); // Command Injection
","const shell = require('child_process');
shell.exec('ping ' + userInput); // Command Injection
",javascript,1
Cross-Site Scripting (XSS),"import java.io.IOException;
import java.io.PrintWriter;
import javax.servlet.ServletException;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

@WebServlet(""/xss"")
public class XssVulnerableServlet extends HttpServlet {
    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        String userInput = request.getParameter(""input"");
        response.setContentType(""text/html"");

        PrintWriter out = response.getWriter();
        out.println(""<html><body>"");
        out.println(""<h1>User Input: "" + userInput + ""</h1>"");
        out.println(""</body></html>"");
    }
}","import java.io.IOException; import java.io.PrintWriter; import javax.servlet.ServletException; import javax.servlet.annotation.WebServlet; import javax.servlet.http.HttpServlet; import javax.servlet.http.HttpServletRequest; import javax.servlet.http.HttpServletResponse; @WebServlet(""/xss"") public class XssVulnerableServlet extends HttpServlet { protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { String userInput = request.getParameter(""input""); response.setContentType(""text/html""); PrintWriter out = response.getWriter(); out.println(""<html><body>""); out.println(""<h1>User Input: "" + userInput + ""</h1>""); out.println(""</body></html>""); } }",java,1
Command Injection,"import java.io.*;

public class CommandInjectionVulnerable {
    public static void main(String[] args) {
        try {
            BufferedReader br = new BufferedReader(new InputStreamReader(System.in));
            System.out.print(""Enter a command to execute: "");
            String command = br.readLine();

            Process process = Runtime.getRuntime().exec(""ping "" + command);
            
            BufferedReader reader = new BufferedReader(new InputStreamReader(process.getInputStream()));
            String line;
            while ((line = reader.readLine()) != null) {
                System.out.println(line);
            }
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}","import java.io.*; public class CommandInjectionVulnerable { public static void main(String[] args) { try { BufferedReader br = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a command to execute: ""); String command = br.readLine(); Process process = Runtime.getRuntime().exec(""ping "" + command); BufferedReader reader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = reader.readLine()) != null) { System.out.println(line); } } catch (IOException e) { e.printStackTrace(); } } }",java,1
Clear,"#include <iostream>
#include <fstream>
#include <string>

void safe_file_reading(const std::string& filename) {
    std::ifstream file(filename);
    if (file.is_open()) {
        std::string line;
        while (std::getline(file, line)) {
            std::cout << line << std::endl;
        }
    }
}","#include <iostream>
#include <fstream>
#include <string>

void safe_file_reading(const std::string& filename) {
    std::ifstream file(filename);
    if (file.is_open()) {
        std::string line;
        while (std::getline(file, line)) {
            std::cout << line << std::endl;
        }
    }
}",cpp,0
Insecure Deserialization,"<?php
$data = $_POST['data'];
unserialize($data); // Insecure Deserialization
?>","<?php
$data = $_POST['data'];
unserialize($data); // Insecure Deserialization
?>",php,1
Clear,"const userData = JSON.parse(userInput); // Safe JSON parsing
if (userData && typeof userData === 'object') {
    processUserData(userData);
}
","const userData = JSON.parse(userInput); // Safe JSON parsing
if (userData && typeof userData === 'object') {
    processUserData(userData);
}
",javascript,0
Clear,"<?php
$file = basename($_GET['file']);
$allowed = ['page1.php', 'page2.php'];
if (in_array($file, $allowed)) {
    include($file);
}
?>","<?php
$file = basename($_GET['file']);
$allowed = ['page1.php', 'page2.php'];
if (in_array($file, $allowed)) {
    include($file);
}
?>",php,0
Clear,"import tempfile
import os

def create_secure_temp(data):
    with tempfile.NamedTemporaryFile(mode='w', delete=True, suffix='.tmp') as temp:
        temp.write(data)
        temp.flush()
        return temp.name","import tempfile
import os

def create_secure_temp(data):
    with tempfile.NamedTemporaryFile(mode='w', delete=True, suffix='.tmp') as temp:
        temp.write(data)
        temp.flush()
        return temp.name",python,0
SQL Injection,"import sqlite3
def get_user_data(username):
    conn = sqlite3.connect('database.db')
    cursor = conn.cursor()
    query = ""SELECT * FROM users WHERE username = '"" + username + ""'""
    cursor.execute(query)
    return cursor.fetchall()","import sqlite3
def get_user_data(username):
    conn = sqlite3.connect('database.db')
    cursor = conn.cursor()
    query = ""SELECT * FROM users WHERE username = '"" + username + ""'""
    cursor.execute(query)
    return cursor.fetchall()",python,1
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
SSRF,"import requests
def fetch_url(url):
    return requests.get(url).text","import requests
def fetch_url(url):
    return requests.get(url).text",python,1
Clear,"#include <stdio.h>
#include <string.h>

int validate_input(const char *input) {
    if (input == NULL) return 0;
    for (int i = 0; input[i] != '\0'; i++) {
        if (input[i] < 32 || input[i] > 126) {
            return 0; // invalid character
        }
    }
    return 1;
}","#include <stdio.h>
#include <string.h>

int validate_input(const char *input) {
    if (input == NULL) return 0;
    for (int i = 0; input[i] != '\0'; i++) {
        if (input[i] < 32 || input[i] > 126) {
            return 0; // invalid character
        }
    }
    return 1;
}",c,0
Cross-Site Scripting (XSS),"import java.io.*;

public class XSSVulnerableCode {
    public static void main(String[] args) {
        String userInput = ""<script>alert('XSS Vulnerability')</script>"";
        
        String output = ""<div>"" + userInput + ""</div>"";
        
        System.out.println(output);
    }
}","import java.io.*; public class XSSVulnerableCode { public static void main(String[] args) { String userInput = ""<script>alert('XSS Vulnerability')</script>""; String output = ""<div>"" + userInput + ""</div>""; System.out.println(output); } }",java,1
Clear,"String userInput = ""admin'; DROP TABLE users; --"";

// Use a prepared statement with a parameterized query
String query = ""SELECT * FROM users WHERE username = ?"";
PreparedStatement preparedStatement = connection.prepareStatement(query);
preparedStatement.setString(1, userInput);

// Execute the SQL query using JDBC
ResultSet resultSet = preparedStatement.executeQuery();","String userInput = ""admin'; DROP TABLE users; --""; // Use a prepared statement with a parameterized query String query = ""SELECT * FROM users WHERE username = ?""; PreparedStatement preparedStatement = connection.prepareStatement(query); preparedStatement.setString(1, userInput); // Execute the SQL query using JDBC ResultSet resultSet = preparedStatement.executeQuery();",php,0
Clear,"To fix the insecure deserialization vulnerability in the provided Java code snippet, you need to implement proper security measures to prevent malicious code execution. Here are some steps you can take to secure the deserialization process:

1. Validate the Input Data:
   Before deserializing any data, validate it to ensure that it comes from a trusted and expected source. This can involve verifying a digital signature or using other forms of input validation.

2. Use a Safe Deserialization Mechanism:
   Instead of using the default Java serialization mechanism, consider using safer alternatives such as JSON or XML serialization libraries that do not execute arbitrary code during deserialization.

3. Implement Whitelisting:
   Maintain a whitelist of allowed classes that can be deserialized and reject any attempts to deserialize classes not on the whitelist. This can help prevent deserialization of malicious classes.

4. Enable Security Manager:
   Consider using Java Security Manager to restrict the permissions granted to the deserialized objects, limiting their capabilities and reducing potential damage in case of exploitation.

5. Apply Input Sanitization:
   Sanitize the input data before deserialization to remove any potentially harmful content or unexpected data structures that could lead to code execution vulnerabilities.

Here is an example of how you can enhance the code snippet with","To fix the insecure deserialization vulnerability in the provided Java code snippet, you need to implement proper security measures to prevent malicious code execution. Here are some steps you can take to secure the deserialization process: 1. Validate the Input Data: Before deserializing any data, validate it to ensure that it comes from a trusted and expected source. This can involve verifying a digital signature or using other forms of input validation. 2. Use a Safe Deserialization Mechanism: Instead of using the default Java serialization mechanism, consider using safer alternatives such as JSON or XML serialization libraries that do not execute arbitrary code during deserialization. 3. Implement Whitelisting: Maintain a whitelist of allowed classes that can be deserialized and reject any attempts to deserialize classes not on the whitelist. This can help prevent deserialization of malicious classes. 4. Enable Security Manager: Consider using Java Security Manager to restrict the permissions granted to the deserialized objects, limiting their capabilities and reducing potential damage in case of exploitation. 5. Apply Input Sanitization: Sanitize the input data before deserialization to remove any potentially harmful content or unexpected data structures that could lead to code execution vulnerabilities. Here is an example of how you can enhance the code snippet with",php,0
Clear,"#include <iostream>
#include <string>
#include <vector>

void safe_string_handling(const std::string& input) {
    std::string safe_copy = input;
    std::cout << safe_copy << std::endl;
}","#include <iostream>
#include <string>
#include <vector>

void safe_string_handling(const std::string& input) {
    std::string safe_copy = input;
    std::cout << safe_copy << std::endl;
}",cpp,0
Clear,"<?php
$username = $_POST['username'];
$stmt = $pdo->prepare(""SELECT * FROM users WHERE username = ?"");
$stmt->execute([$username]); // Parameterized query
?>","<?php
$username = $_POST['username'];
$stmt = $pdo->prepare(""SELECT * FROM users WHERE username = ?"");
$stmt->execute([$username]); // Parameterized query
?>",php,0
Cross-Site Scripting (XSS),"import java.io.IOException;
import javax.servlet.http.*;

public class XSSVulnerableServlet extends HttpServlet {
    
    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws IOException {
        String userInput = request.getParameter(""input"");
        String output = ""Welcome, "" + userInput + ""!"";

        response.getWriter().write(""<html><body>"");
        response.getWriter().write(""<h1>"" + output + ""</h1>"");
        response.getWriter().write(""</body></html>"");
    }
}","import java.io.IOException; import javax.servlet.http.*; public class XSSVulnerableServlet extends HttpServlet { protected void doGet(HttpServletRequest request, HttpServletResponse response) throws IOException { String userInput = request.getParameter(""input""); String output = ""Welcome, "" + userInput + ""!""; response.getWriter().write(""<html><body>""); response.getWriter().write(""<h1>"" + output + ""</h1>""); response.getWriter().write(""</body></html>""); } }",java,1
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Clear,"app.get('/user/:id', (req, res) => {
    const userId = parseInt(req.params.id);
    db.query('SELECT * FROM users WHERE id = ?', [userId], (err, result) => {
        res.json(result);
    });
});
","app.get('/user/:id', (req, res) => {
    const userId = parseInt(req.params.id);
    db.query('SELECT * FROM users WHERE id = ?', [userId], (err, result) => {
        res.json(result);
    });
});
",javascript,0
Clear,"#include <iostream>
#include <fstream>
#include <string>

void safe_file_reading(const std::string& filename) {
    std::ifstream file(filename);
    if (file.is_open()) {
        std::string line;
        while (std::getline(file, line)) {
            std::cout << line << std::endl;
        }
    }
}","#include <iostream>
#include <fstream>
#include <string>

void safe_file_reading(const std::string& filename) {
    std::ifstream file(filename);
    if (file.is_open()) {
        std::string line;
        while (std::getline(file, line)) {
            std::cout << line << std::endl;
        }
    }
}",cpp,0
Clear,"import java.io.*;
import javax.servlet.*;
import javax.servlet.http.*;

import org.apache.commons.text.StringEscapeUtils;

public class SecureServlet extends HttpServlet {
    protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        String userInput = request.getParameter(""input"");
        
        // Sanitize and encode user input
        String sanitizedInput = StringEscapeUtils.escapeHtml4(userInput);
        
        String output = ""<p>User input: "" + sanitizedInput + ""</p>"";
        
        response.setContentType(""text/html"");
        PrintWriter out = response.getWriter();
        out.println(output);
    }
}","import java.io.*; import javax.servlet.*; import javax.servlet.http.*; import org.apache.commons.text.StringEscapeUtils; public class SecureServlet extends HttpServlet { protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { String userInput = request.getParameter(""input""); // Sanitize and encode user input String sanitizedInput = StringEscapeUtils.escapeHtml4(userInput); String output = ""<p>User input: "" + sanitizedInput + ""</p>""; response.setContentType(""text/html""); PrintWriter out = response.getWriter(); out.println(output); } }",java,0
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
SQL Injection,"<?php
$username = $_POST['username'];
$query = ""SELECT * FROM users WHERE username = '$username'"";
$result = mysql_query($query); // SQL Injection
?>","<?php
$username = $_POST['username'];
$query = ""SELECT * FROM users WHERE username = '$username'"";
$result = mysql_query($query); // SQL Injection
?>",php,1
SQL Injection,"<?php
$username = $_POST['username'];
$query = ""SELECT * FROM users WHERE username = '$username'"";
$result = mysql_query($query); // SQL Injection
?>","<?php
$username = $_POST['username'];
$query = ""SELECT * FROM users WHERE username = '$username'"";
$result = mysql_query($query); // SQL Injection
?>",php,1
Clear,"String userInput = ""'; DROP TABLE users; --"";

// Use a parameterized query to prevent SQL Injection
String query = ""SELECT * FROM users WHERE username = ?"";
PreparedStatement preparedStatement = connection.prepareStatement(query);
preparedStatement.setString(1, userInput);

// Execute the prepared statement
ResultSet resultSet = preparedStatement.executeQuery();","String userInput = ""'; DROP TABLE users; --""; // Use a parameterized query to prevent SQL Injection String query = ""SELECT * FROM users WHERE username = ?""; PreparedStatement preparedStatement = connection.prepareStatement(query); preparedStatement.setString(1, userInput); // Execute the prepared statement ResultSet resultSet = preparedStatement.executeQuery();",php,0
Clear,"import java.sql.*;

public class SQLInjectionSecure {

    public static void main(String[] args) {
        String userInput = ""'; DROP TABLE users; --""; // Malicious input that could lead to SQL Injection
        
        try {
            Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");
            
            // Use a PreparedStatement with parameterized query to prevent SQL Injection
            String query = ""SELECT * FROM users WHERE username = ?"";
            PreparedStatement pstmt = conn.prepareStatement(query);
            pstmt.setString(1, userInput);
            
            ResultSet rs = pstmt.executeQuery();
            
            while (rs.next()) {
                System.out.println(""User found: "" + rs.getString(""username""));
            }
            
            conn.close();
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.*; public class SQLInjectionSecure { public static void main(String[] args) { String userInput = ""'; DROP TABLE users; --""; // Malicious input that could lead to SQL Injection try { Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); // Use a PreparedStatement with parameterized query to prevent SQL Injection String query = ""SELECT * FROM users WHERE username = ?""; PreparedStatement pstmt = conn.prepareStatement(query); pstmt.setString(1, userInput); ResultSet rs = pstmt.executeQuery(); while (rs.next()) { System.out.println(""User found: "" + rs.getString(""username"")); } conn.close(); } catch (SQLException e) { e.printStackTrace(); } } }",java,0
Code Injection,"const userData = eval('(' + userInput + ')'); // eval injection
","const userData = eval('(' + userInput + ')'); // eval injection
",javascript,1
Command Injection,"import os
def backup_database(db_name):
    os.system(f""pg_dump {db_name} > backup.sql"")","import os
def backup_database(db_name):
    os.system(f""pg_dump {db_name} > backup.sql"")",python,1
SSRF,"import requests
def fetch_url(url):
    return requests.get(url).text","import requests
def fetch_url(url):
    return requests.get(url).text",python,1
Clear,"import java.io.*;
import javax.servlet.*;
import javax.servlet.http.*;

import org.apache.commons.lang3.StringEscapeUtils;

public class XSSFixedServlet extends HttpServlet {
    protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        String userInput = request.getParameter(""input"");
        String sanitizedInput = StringEscapeUtils.escapeHtml4(userInput);
        String output = ""<html><body>User input: "" + sanitizedInput + ""</body></html>"";

        response.setContentType(""text/html"");
        PrintWriter out = response.getWriter();
        out.println(output);
    }
}","import java.io.*; import javax.servlet.*; import javax.servlet.http.*; import org.apache.commons.lang3.StringEscapeUtils; public class XSSFixedServlet extends HttpServlet { protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { String userInput = request.getParameter(""input""); String sanitizedInput = StringEscapeUtils.escapeHtml4(userInput); String output = ""<html><body>User input: "" + sanitizedInput + ""</body></html>""; response.setContentType(""text/html""); PrintWriter out = response.getWriter(); out.println(output); } }",java,0
Clear,"To fix the Path Traversal vulnerability in the provided Java code snippet, you should ensure that the user-supplied input for the file name does not allow directory traversal attacks. One way to prevent this is by validating and sanitizing the input to restrict it to a specific directory.

Here is an updated version of the code with proper security measures:

```java
import java.io.File;
import java.io.IOException;
import java.nio.file.Files;
import java.util.Scanner;

public class SecurePathTraversal {

    private static final String BASE_DIRECTORY = ""C:/data/"";

    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);

        System.out.print(""Enter file name: "");
        String fileName = scanner.nextLine();

        // Check if the file name contains any path separators
        if (fileName.contains(File.separator)) {
            System.out.println(""Invalid file name"");
            return;
        }

        File file = new File(BASE_DIRECTORY + fileName);

        // Check if the requested file is within the allowed directory
        if (!file.getAbsolutePath().startsWith(BASE_DIRECTORY)) {
            System.out.println(""Access denied"");
            return;
        }

        try {
            byte[] fileContents = Files.readAllBytes(file.toPath());
            System.out","To fix the Path Traversal vulnerability in the provided Java code snippet, you should ensure that the user-supplied input for the file name does not allow directory traversal attacks. One way to prevent this is by validating and sanitizing the input to restrict it to a specific directory. Here is an updated version of the code with proper security measures: ```java import java.io.File; import java.io.IOException; import java.nio.file.Files; import java.util.Scanner; public class SecurePathTraversal { private static final String BASE_DIRECTORY = ""C:/data/""; public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter file name: ""); String fileName = scanner.nextLine(); // Check if the file name contains any path separators if (fileName.contains(File.separator)) { System.out.println(""Invalid file name""); return; } File file = new File(BASE_DIRECTORY + fileName); // Check if the requested file is within the allowed directory if (!file.getAbsolutePath().startsWith(BASE_DIRECTORY)) { System.out.println(""Access denied""); return; } try { byte[] fileContents = Files.readAllBytes(file.toPath()); System.out",java,0
Clear,"#include <stdio.h>
#include <string.h>

int safe_buffer_operation(char *input) {
    char buffer[100];
    if (strlen(input) < sizeof(buffer)) {
        strcpy(buffer, input);
        return 0;
    }
    return -1; // buffer too small
}","#include <stdio.h>
#include <string.h>

int safe_buffer_operation(char *input) {
    char buffer[100];
    if (strlen(input) < sizeof(buffer)) {
        strcpy(buffer, input);
        return 0;
    }
    return -1; // buffer too small
}",c,0
Path Traversal,"import java.io.File;
import java.io.FileInputStream;
import java.io.IOException;
import java.util.Scanner;

public class PathTraversalVulnerable {

    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        System.out.print(""Enter file name: "");
        String fileName = scanner.nextLine();

        try {
            File file = new File(""/path/to/directory/"" + fileName);
            FileInputStream fis = new FileInputStream(file);

            int content;
            while ((content = fis.read()) != -1) {
                System.out.print((char) content);
            }

            fis.close();
        } catch (IOException e) {
            System.out.println(""File not found or could not be opened."");
        }
    }
}","import java.io.File; import java.io.FileInputStream; import java.io.IOException; import java.util.Scanner; public class PathTraversalVulnerable { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter file name: ""); String fileName = scanner.nextLine(); try { File file = new File(""/path/to/directory/"" + fileName); FileInputStream fis = new FileInputStream(file); int content; while ((content = fis.read()) != -1) { System.out.print((char) content); } fis.close(); } catch (IOException e) { System.out.println(""File not found or could not be opened.""); } } }",java,1
XSS,"const userInput = document.location.search.split('=')[1];
document.write(userInput); // XSS
","const userInput = document.location.search.split('=')[1];
document.write(userInput); // XSS
",javascript,1
Clear,"const userInput = new URLSearchParams(window.location.search).get('input');
const safeOutput = document.createElement('div');
safeOutput.textContent = userInput; // Safe DOM manipulation
document.body.appendChild(safeOutput);
","const userInput = new URLSearchParams(window.location.search).get('input');
const safeOutput = document.createElement('div');
safeOutput.textContent = userInput; // Safe DOM manipulation
document.body.appendChild(safeOutput);
",javascript,0
Clear,"<?php
$cmd = escapeshellarg($_GET['cmd']);
system(""ls "" . $cmd); // Escaped command
?>","<?php
$cmd = escapeshellarg($_GET['cmd']);
system(""ls "" . $cmd); // Escaped command
?>",php,0
Cross-Site Scripting (XSS),"import java.io.*;

public class XSSVulnerableCode {

    public static void main(String[] args) {
        BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));
        
        try {
            System.out.print(""Enter your name: "");
            String name = reader.readLine();
            
            // Improperly handling user input by directly outputting it to the webpage
            System.out.println(""<p>Welcome, "" + name + ""!</p>"");
        } catch (IOException e) {
            System.err.println(""Error reading input."");
        }
    }
}","import java.io.*; public class XSSVulnerableCode { public static void main(String[] args) { BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); try { System.out.print(""Enter your name: ""); String name = reader.readLine(); // Improperly handling user input by directly outputting it to the webpage System.out.println(""<p>Welcome, "" + name + ""!</p>""); } catch (IOException e) { System.err.println(""Error reading input.""); } } }",java,1
Clear,"String username = request.getParameter(""username"");
String password = request.getParameter(""password"");

// Use a prepared statement with parameterized query
String query = ""SELECT * FROM users WHERE username=? AND password=?"";
PreparedStatement preparedStatement = connection.prepareStatement(query);
preparedStatement.setString(1, username);
preparedStatement.setString(2, password);

ResultSet resultSet = preparedStatement.executeQuery();

// Process the result set....","String username = request.getParameter(""username""); String password = request.getParameter(""password""); // Use a prepared statement with parameterized query String query = ""SELECT * FROM users WHERE username=? AND password=?""; PreparedStatement preparedStatement = connection.prepareStatement(query); preparedStatement.setString(1, username); preparedStatement.setString(2, password); ResultSet resultSet = preparedStatement.executeQuery(); // Process the result set....",php,0
Clear,"#include <stdio.h>
#include <stdlib.h>

void safe_file_operation(const char *filename) {
    FILE *file = fopen(filename, ""r"");
    if (file != NULL) {
        char buffer[256];
        while (fgets(buffer, sizeof(buffer), file)) {
            printf(""%s"", buffer);
        }
        fclose(file);
    }
}","#include <stdio.h>
#include <stdlib.h>

void safe_file_operation(const char *filename) {
    FILE *file = fopen(filename, ""r"");
    if (file != NULL) {
        char buffer[256];
        while (fgets(buffer, sizeof(buffer), file)) {
            printf(""%s"", buffer);
        }
        fclose(file);
    }
}",c,0
SQL Injection,"<?php
$username = $_POST['username'];
$query = ""SELECT * FROM users WHERE username = '$username'"";
$result = mysql_query($query); // SQL Injection
?>","<?php
$username = $_POST['username'];
$query = ""SELECT * FROM users WHERE username = '$username'"";
$result = mysql_query($query); // SQL Injection
?>",php,1
SQL Injection,"app.get('/user/:id', (req, res) => {
    const query = `SELECT * FROM users WHERE id = ${req.params.id}`; // SQL Injection
    db.query(query, (err, result) => {
        res.json(result);
    });
});
","app.get('/user/:id', (req, res) => {
    const query = `SELECT * FROM users WHERE id = ${req.params.id}`; // SQL Injection
    db.query(query, (err, result) => {
        res.json(result);
    });
});
",javascript,1
Code Injection,"const userData = eval('(' + userInput + ')'); // eval injection
","const userData = eval('(' + userInput + ')'); // eval injection
",javascript,1
Clear,"const token = process.env.API_TOKEN; // Environment variable
fetch('/api/data', {
    headers: { 'Authorization': `Bearer ${token}` }
});
","const token = process.env.API_TOKEN; // Environment variable
fetch('/api/data', {
    headers: { 'Authorization': `Bearer ${token}` }
});
",javascript,0
Clear,import org.owasp.encoder.Encode;,import org.owasp.encoder.Encode;,python,0
Clear,"app.get('/user/:id', (req, res) => {
    const userId = parseInt(req.params.id);
    db.query('SELECT * FROM users WHERE id = ?', [userId], (err, result) => {
        res.json(result);
    });
});
","app.get('/user/:id', (req, res) => {
    const userId = parseInt(req.params.id);
    db.query('SELECT * FROM users WHERE id = ?', [userId], (err, result) => {
        res.json(result);
    });
});
",javascript,0
Clear,"#include <stdio.h>
#include <string.h>

void safe_string_copy(char *dest, const char *src, size_t dest_size) {
    if (dest_size > 0) {
        strncpy(dest, src, dest_size - 1);
        dest[dest_size - 1] = '\0';
    }
}","#include <stdio.h>
#include <string.h>

void safe_string_copy(char *dest, const char *src, size_t dest_size) {
    if (dest_size > 0) {
        strncpy(dest, src, dest_size - 1);
        dest[dest_size - 1] = '\0';
    }
}",c,0
Cross-Site Scripting (XSS),"from flask import Flask, request
app = Flask(__name__)

@app.route('/search')
def search():
    query = request.args.get('q', '')
    return f'<h1>Search results for: {query}</h1>'","from flask import Flask, request
app = Flask(__name__)

@app.route('/search')
def search():
    query = request.args.get('q', '')
    return f'<h1>Search results for: {query}</h1>'",python,1
SQL Injection,"import java.sql.*;

public class SQLInjectionExample {

    public static void main(String[] args) {
        try {
            // Assume user input is directly concatenated into the SQL query
            String userInput = ""admin'; DROP TABLE users; --"";
            String sqlQuery = ""SELECT * FROM users WHERE username = '"" + userInput + ""'"";

            Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");
            Statement statement = conn.createStatement();
            ResultSet resultSet = statement.executeQuery(sqlQuery);

            while (resultSet.next()) {
                System.out.println(resultSet.getString(""username""));
            }

        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.*; public class SQLInjectionExample { public static void main(String[] args) { try { // Assume user input is directly concatenated into the SQL query String userInput = ""admin'; DROP TABLE users; --""; String sqlQuery = ""SELECT * FROM users WHERE username = '"" + userInput + ""'""; Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); Statement statement = conn.createStatement(); ResultSet resultSet = statement.executeQuery(sqlQuery); while (resultSet.next()) { System.out.println(resultSet.getString(""username"")); } } catch (SQLException e) { e.printStackTrace(); } } }",java,1
Clear,"To fix the insecure code snippet for Path Traversal vulnerability, you need to ensure that the file being accessed is within a specific directory and not allowing access to files outside of that directory. One way to achieve this is by using a whitelist approach where you specify the allowed directories or files that can be accessed.

Here's an improved version of the code with proper security measures:

```java
import java.io.File;
import java.io.FileInputStream;
import java.io.IOException;
import java.util.Scanner;

public class PathTraversalSecure {

    private static final String BASE_DIRECTORY = ""path/to/secure/directory/"";

    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        System.out.print(""Enter file name: "");
        String fileName = scanner.next();

        if (isFileInSecureDirectory(fileName)) {
            File file = new File(BASE_DIRECTORY + fileName);

            try (FileInputStream fis = new FileInputStream(file)) {
                int content;
                while ((content = fis.read()) != -1) {
                    System.out.print((char) content);
                }
            } catch (IOException e) {
                System.out.println(""Error reading file: "" + e.getMessage());
            }
        } else {
            System.out.println(""","To fix the insecure code snippet for Path Traversal vulnerability, you need to ensure that the file being accessed is within a specific directory and not allowing access to files outside of that directory. One way to achieve this is by using a whitelist approach where you specify the allowed directories or files that can be accessed. Here's an improved version of the code with proper security measures: ```java import java.io.File; import java.io.FileInputStream; import java.io.IOException; import java.util.Scanner; public class PathTraversalSecure { private static final String BASE_DIRECTORY = ""path/to/secure/directory/""; public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter file name: ""); String fileName = scanner.next(); if (isFileInSecureDirectory(fileName)) { File file = new File(BASE_DIRECTORY + fileName); try (FileInputStream fis = new FileInputStream(file)) { int content; while ((content = fis.read()) != -1) { System.out.print((char) content); } } catch (IOException e) { System.out.println(""Error reading file: "" + e.getMessage()); } } else { System.out.println(""",java,0
Buffer Overflow,"#include <iostream>
#include <cstring>

void unsafe_c_string(char* input) {
    char buffer[100];
    strcpy(buffer, input); // potential buffer overflow
    std::cout << buffer << std::endl;
}","#include <iostream>
#include <cstring>

void unsafe_c_string(char* input) {
    char buffer[100];
    strcpy(buffer, input); // potential buffer overflow
    std::cout << buffer << std::endl;
}",cpp,1
Cross-Site Scripting (XSS),"import java.io.IOException;
import javax.servlet.ServletException;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

public class VulnerableServlet extends HttpServlet {

    protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        String userInput = request.getParameter(""input"");
        response.getWriter().println(""Hello, "" + userInput);
    }
}","import java.io.IOException; import javax.servlet.ServletException; import javax.servlet.http.HttpServlet; import javax.servlet.http.HttpServletRequest; import javax.servlet.http.HttpServletResponse; public class VulnerableServlet extends HttpServlet { protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { String userInput = request.getParameter(""input""); response.getWriter().println(""Hello, "" + userInput); } }",java,1
Clear,"import java.io.*;
import javax.servlet.*;
import javax.servlet.http.*;
import org.owasp.esapi.ESAPI;

public class SecureServlet extends HttpServlet {
    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        String userInput = request.getParameter(""input"");
        
        // Sanitize user input to prevent XSS
        String sanitizedInput = ESAPI.encoder().encodeForHTML(userInput);
        
        String output = ""<p>User input: "" + sanitizedInput + ""</p>"";
        
        response.setContentType(""text/html"");
        PrintWriter out = response.getWriter();
        out.println(""<html><body>"");
        out.println(output);
        out.println(""</body></html>"");
    }
}","import java.io.*; import javax.servlet.*; import javax.servlet.http.*; import org.owasp.esapi.ESAPI; public class SecureServlet extends HttpServlet { protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { String userInput = request.getParameter(""input""); // Sanitize user input to prevent XSS String sanitizedInput = ESAPI.encoder().encodeForHTML(userInput); String output = ""<p>User input: "" + sanitizedInput + ""</p>""; response.setContentType(""text/html""); PrintWriter out = response.getWriter(); out.println(""<html><body>""); out.println(output); out.println(""</body></html>""); } }",java,0
Clear,"To fix the Command Injection vulnerability in the provided Java code snippet, you should not directly concatenate user input to form a command string. Instead, you should validate and sanitize the user input before executing any external command. Below is an example of how you can improve the code to mitigate Command Injection vulnerabilities:

```java
import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class SecureCommandExecution {

    public static void main(String[] args) throws IOException {
        BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));
        
        System.out.print(""Enter the IP address to ping: "");
        String ipAddress = reader.readLine();
        
        // Validate the input to ensure it is a valid IP address
        if (!isValidIpAddress(ipAddress)) {
            System.out.println(""Invalid IP address entered. Aborting."");
            return;
        }
        
        // Constructing the command with proper validation
        String[] command = {""ping"", ipAddress};
        
        ProcessBuilder processBuilder = new ProcessBuilder(command);
        
        Process process = processBuilder.start();
        
        BufferedReader inputStream = new BufferedReader(new InputStreamReader(process.getInputStream()));
        String output = null;
        
        while ((output = inputStream.readLine()) != null) {
            System.out.println(output);
        }","To fix the Command Injection vulnerability in the provided Java code snippet, you should not directly concatenate user input to form a command string. Instead, you should validate and sanitize the user input before executing any external command. Below is an example of how you can improve the code to mitigate Command Injection vulnerabilities: ```java import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class SecureCommandExecution { public static void main(String[] args) throws IOException { BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter the IP address to ping: ""); String ipAddress = reader.readLine(); // Validate the input to ensure it is a valid IP address if (!isValidIpAddress(ipAddress)) { System.out.println(""Invalid IP address entered. Aborting.""); return; } // Constructing the command with proper validation String[] command = {""ping"", ipAddress}; ProcessBuilder processBuilder = new ProcessBuilder(command); Process process = processBuilder.start(); BufferedReader inputStream = new BufferedReader(new InputStreamReader(process.getInputStream())); String output = null; while ((output = inputStream.readLine()) != null) { System.out.println(output); }",java,0
XSS,"const userInput = document.location.search.split('=')[1];
document.write(userInput); // XSS
","const userInput = document.location.search.split('=')[1];
document.write(userInput); // XSS
",javascript,1
Clear,"import subprocess
def safe_directory_listing(path):
    result = subprocess.run(['ls', path], capture_output=True, text=True)
    return result.stdout","import subprocess
def safe_directory_listing(path):
    result = subprocess.run(['ls', path], capture_output=True, text=True)
    return result.stdout",python,0
Clear,"import subprocess
def safe_database_backup(db_name):
    result = subprocess.run(['pg_dump', db_name], capture_output=True, text=True)
    with open('backup.sql', 'w') as f:
        f.write(result.stdout)","import subprocess
def safe_database_backup(db_name):
    result = subprocess.run(['pg_dump', db_name], capture_output=True, text=True)
    with open('backup.sql', 'w') as f:
        f.write(result.stdout)",python,0
Path Traversal,"import java.io.File;
import java.io.FileInputStream;
import java.io.IOException;

public class PathTraversalVulnerability {
    
    public static void main(String[] args) {
        String fileName = args[0]; // User input containing file name

        try {
            File file = new File(""/path/to/directory/"" + fileName); // Vulnerable concatenation of user input
            FileInputStream fis = new FileInputStream(file);
            
            int data;
            while ((data = fis.read()) != -1) {
                System.out.print((char) data);
            }
            
            fis.close();
        } catch (IOException e) {
            System.out.println(""File not found or error reading file."");
        }
    }
}","import java.io.File; import java.io.FileInputStream; import java.io.IOException; public class PathTraversalVulnerability { public static void main(String[] args) { String fileName = args[0]; // User input containing file name try { File file = new File(""/path/to/directory/"" + fileName); // Vulnerable concatenation of user input FileInputStream fis = new FileInputStream(file); int data; while ((data = fis.read()) != -1) { System.out.print((char) data); } fis.close(); } catch (IOException e) { System.out.println(""File not found or error reading file.""); } } }",java,1
Clear,"import hashlib
import os

def hash_password(password):
    salt = os.urandom(32)
    key = hashlib.pbkdf2_hmac('sha256', password.encode(), salt, 100000)
    return salt + key","import hashlib
import os

def hash_password(password):
    salt = os.urandom(32)
    key = hashlib.pbkdf2_hmac('sha256', password.encode(), salt, 100000)
    return salt + key",python,0
Cross-Site Scripting (XSS),"import java.io.IOException;
import javax.servlet.http.*;

public class XSSVulnerableServlet extends HttpServlet {
    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws IOException {
        String userInput = request.getParameter(""input"");
        String htmlResponse = ""<html><body><h1>Welcome "" + userInput + ""</h1></body></html>"";
        
        response.setContentType(""text/html"");
        response.getWriter().write(htmlResponse);
    }
}","import java.io.IOException; import javax.servlet.http.*; public class XSSVulnerableServlet extends HttpServlet { protected void doGet(HttpServletRequest request, HttpServletResponse response) throws IOException { String userInput = request.getParameter(""input""); String htmlResponse = ""<html><body><h1>Welcome "" + userInput + ""</h1></body></html>""; response.setContentType(""text/html""); response.getWriter().write(htmlResponse); } }",java,1
Clear,"#include <stdio.h>
#include <stdlib.h>

void safe_file_operation(const char *filename) {
    FILE *file = fopen(filename, ""r"");
    if (file != NULL) {
        char buffer[256];
        while (fgets(buffer, sizeof(buffer), file)) {
            printf(""%s"", buffer);
        }
        fclose(file);
    }
}","#include <stdio.h>
#include <stdlib.h>

void safe_file_operation(const char *filename) {
    FILE *file = fopen(filename, ""r"");
    if (file != NULL) {
        char buffer[256];
        while (fgets(buffer, sizeof(buffer), file)) {
            printf(""%s"", buffer);
        }
        fclose(file);
    }
}",c,0
Clear,"#include <iostream>
#include <vector>
#include <stdexcept>

int safe_vector_access(const std::vector<int>& vec, size_t index) {
    if (index >= vec.size()) {
        throw std::out_of_range(""Index out of range"");
    }
    return vec[index];
}","#include <iostream>
#include <vector>
#include <stdexcept>

int safe_vector_access(const std::vector<int>& vec, size_t index) {
    if (index >= vec.size()) {
        throw std::out_of_range(""Index out of range"");
    }
    return vec[index];
}",cpp,0
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Clear,"#include <stdio.h>
#include <string.h>

int safe_buffer_operation(char *input) {
    char buffer[100];
    if (strlen(input) < sizeof(buffer)) {
        strcpy(buffer, input);
        return 0;
    }
    return -1; // buffer too small
}","#include <stdio.h>
#include <string.h>

int safe_buffer_operation(char *input) {
    char buffer[100];
    if (strlen(input) < sizeof(buffer)) {
        strcpy(buffer, input);
        return 0;
    }
    return -1; // buffer too small
}",c,0
Clear,"import mysql.connector
def safe_product_search(category):
    db = mysql.connector.connect(host=""localhost"", user=""user"", password=""pass"", database=""shop"")
    cursor = db.cursor()
    cursor.execute(""SELECT * FROM products WHERE category = %s"", (category,))
    return cursor.fetchall()","import mysql.connector
def safe_product_search(category):
    db = mysql.connector.connect(host=""localhost"", user=""user"", password=""pass"", database=""shop"")
    cursor = db.cursor()
    cursor.execute(""SELECT * FROM products WHERE category = %s"", (category,))
    return cursor.fetchall()",python,0
Insecure Deserialization,"import pickle
def load_user_data(filename):
    with open(filename, 'rb') as f:
        data = pickle.load(f)
    return data","import pickle
def load_user_data(filename):
    with open(filename, 'rb') as f:
        data = pickle.load(f)
    return data",python,1
Hardcoded Secrets,"import requests
def call_api():
    api_key = ""sk_live_1234567890abcdef""
    headers = {'Authorization': f'Bearer {api_key}'}
    return requests.get('https://api.example.com/data', headers=headers)","import requests
def call_api():
    api_key = ""sk_live_1234567890abcdef""
    headers = {'Authorization': f'Bearer {api_key}'}
    return requests.get('https://api.example.com/data', headers=headers)",python,1
Clear,"#include <iostream>
#include <memory>

void safe_memory_management() {
    auto ptr = std::make_unique<int>(42);
    std::cout << *ptr << std::endl;
}","#include <iostream>
#include <memory>

void safe_memory_management() {
    auto ptr = std::make_unique<int>(42);
    std::cout << *ptr << std::endl;
}",cpp,0
Clear,"#include <stdio.h>
#include <string.h>

int safe_buffer_operation(char *input) {
    char buffer[100];
    if (strlen(input) < sizeof(buffer)) {
        strcpy(buffer, input);
        return 0;
    }
    return -1; // buffer too small
}","#include <stdio.h>
#include <string.h>

int safe_buffer_operation(char *input) {
    char buffer[100];
    if (strlen(input) < sizeof(buffer)) {
        strcpy(buffer, input);
        return 0;
    }
    return -1; // buffer too small
}",c,0
Clear,"const userData = JSON.parse(userInput); // Safe JSON parsing
if (userData && typeof userData === 'object') {
    processUserData(userData);
}
","const userData = JSON.parse(userInput); // Safe JSON parsing
if (userData && typeof userData === 'object') {
    processUserData(userData);
}
",javascript,0
Buffer Overflow,"import java.util.Scanner;

public class BufferOverflowVulnerabilityExample {

    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        System.out.print(""Enter your name: "");
        String name = scanner.nextLine();
        
        // Vulnerable code - Buffer Overflow can occur if the user enters a very long input
        char[] buffer = new char[10];
        name.getChars(0, name.length(), buffer, 0);
        
        System.out.println(""Hello, "" + new String(buffer));
    }
}","import java.util.Scanner; public class BufferOverflowVulnerabilityExample { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter your name: ""); String name = scanner.nextLine(); // Vulnerable code - Buffer Overflow can occur if the user enters a very long input char[] buffer = new char[10]; name.getChars(0, name.length(), buffer, 0); System.out.println(""Hello, "" + new String(buffer)); } }",java,1
Clear,"#include <iostream>
#include <sstream>

int safe_string_to_int(const std::string& str) {
    std::stringstream ss(str);
    int value;
    if (ss >> value) {
        return value;
    }
    throw std::invalid_argument(""Invalid integer"");
}","#include <iostream>
#include <sstream>

int safe_string_to_int(const std::string& str) {
    std::stringstream ss(str);
    int value;
    if (ss >> value) {
        return value;
    }
    throw std::invalid_argument(""Invalid integer"");
}",cpp,0
Clear,"#include <iostream>
#include <memory>

void safe_memory_management() {
    auto ptr = std::make_unique<int>(42);
    std::cout << *ptr << std::endl;
}","#include <iostream>
#include <memory>

void safe_memory_management() {
    auto ptr = std::make_unique<int>(42);
    std::cout << *ptr << std::endl;
}",cpp,0
Cross-Site Scripting (XSS),"def display_comment(comment_text):
    return f""<div class='comment'>{comment_text}</div>"" ","def display_comment(comment_text):
    return f""<div class='comment'>{comment_text}</div>"" ",python,1
Clear,"import hashlib
import os

def hash_password(password):
    salt = os.urandom(32)
    key = hashlib.pbkdf2_hmac('sha256', password.encode(), salt, 100000)
    return salt + key","import hashlib
import os

def hash_password(password):
    salt = os.urandom(32)
    key = hashlib.pbkdf2_hmac('sha256', password.encode(), salt, 100000)
    return salt + key",python,0
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Memory Corruption,"#include <iostream>

void unsafe_pointer_arithmetic(int* array, int size) {
    for (int i = 0; i <= size; i++) {
        std::cout << *(array + i) << std::endl; // potential out-of-bounds
    }
}","#include <iostream>

void unsafe_pointer_arithmetic(int* array, int size) {
    for (int i = 0; i <= size; i++) {
        std::cout << *(array + i) << std::endl; // potential out-of-bounds
    }
}",cpp,1
Clear,"<?php
$cmd = escapeshellarg($_GET['cmd']);
system(""ls "" . $cmd); // Escaped command
?>","<?php
$cmd = escapeshellarg($_GET['cmd']);
system(""ls "" . $cmd); // Escaped command
?>",php,0
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Clear,"To fix the command injection vulnerability in the given Java code snippet, you should avoid directly executing user input as a command. Instead, you can use ProcessBuilder to securely execute the desired command with proper escaping and handling of arguments. Here's how you can refactor the code to address this security issue:

```java
import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class CommandInjectionFixed {
    public static void main(String[] args) throws IOException {
        BufferedReader br = new BufferedReader(new InputStreamReader(System.in));
        
        System.out.print(""Enter the name of the file: "");
        String fileName = br.readLine();
        
        // Secure code using ProcessBuilder to execute the command safely
        ProcessBuilder processBuilder = new ProcessBuilder();
        processBuilder.command(""ls"", ""-l"", fileName);
        
        try {
            Process process = processBuilder.start();
            
            BufferedReader reader = new BufferedReader(new InputStreamReader(process.getInputStream()));
            String line;
            while ((line = reader.readLine()) != null) {
                System.out.println(line);
            }
            
            int exitCode = process.waitFor();
            System.out.println(""Command executed with exit code: "" + exitCode);
        } catch (IOException | InterruptedException e) {
            e.printStackTrace();","To fix the command injection vulnerability in the given Java code snippet, you should avoid directly executing user input as a command. Instead, you can use ProcessBuilder to securely execute the desired command with proper escaping and handling of arguments. Here's how you can refactor the code to address this security issue: ```java import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class CommandInjectionFixed { public static void main(String[] args) throws IOException { BufferedReader br = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter the name of the file: ""); String fileName = br.readLine(); // Secure code using ProcessBuilder to execute the command safely ProcessBuilder processBuilder = new ProcessBuilder(); processBuilder.command(""ls"", ""-l"", fileName); try { Process process = processBuilder.start(); BufferedReader reader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = reader.readLine()) != null) { System.out.println(line); } int exitCode = process.waitFor(); System.out.println(""Command executed with exit code: "" + exitCode); } catch (IOException | InterruptedException e) { e.printStackTrace();",java,0
Clear,"#include <stdio.h>
#include <string.h>

int validate_input(const char *input) {
    if (input == NULL) return 0;
    for (int i = 0; input[i] != '\0'; i++) {
        if (input[i] < 32 || input[i] > 126) {
            return 0; // invalid character
        }
    }
    return 1;
}","#include <stdio.h>
#include <string.h>

int validate_input(const char *input) {
    if (input == NULL) return 0;
    for (int i = 0; input[i] != '\0'; i++) {
        if (input[i] < 32 || input[i] > 126) {
            return 0; // invalid character
        }
    }
    return 1;
}",c,0
SQL Injection,"import java.sql.*;

public class VulnerableCodeSnippet {
    public static void main(String[] args) {
        String userInput = ""'; DROP TABLE users; --"";
        
        try {
            Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");
            Statement stmt = conn.createStatement();
            
            String query = ""SELECT * FROM users WHERE username = '"" + userInput + ""'"";
            ResultSet rs = stmt.executeQuery(query);
            
            while (rs.next()) {
                System.out.println(rs.getString(""username""));
            }
            
            conn.close();
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.*; public class VulnerableCodeSnippet { public static void main(String[] args) { String userInput = ""'; DROP TABLE users; --""; try { Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); Statement stmt = conn.createStatement(); String query = ""SELECT * FROM users WHERE username = '"" + userInput + ""'""; ResultSet rs = stmt.executeQuery(query); while (rs.next()) { System.out.println(rs.getString(""username"")); } conn.close(); } catch (SQLException e) { e.printStackTrace(); } } }",java,1
Buffer Overflow,"#include <iostream>
#include <cstring>

void unsafe_c_string(char* input) {
    char buffer[100];
    strcpy(buffer, input); // potential buffer overflow
    std::cout << buffer << std::endl;
}","#include <iostream>
#include <cstring>

void unsafe_c_string(char* input) {
    char buffer[100];
    strcpy(buffer, input); // potential buffer overflow
    std::cout << buffer << std::endl;
}",cpp,1
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
SQL Injection,"app.get('/user/:id', (req, res) => {
    const query = `SELECT * FROM users WHERE id = ${req.params.id}`; // SQL Injection
    db.query(query, (err, result) => {
        res.json(result);
    });
});
","app.get('/user/:id', (req, res) => {
    const query = `SELECT * FROM users WHERE id = ${req.params.id}`; // SQL Injection
    db.query(query, (err, result) => {
        res.json(result);
    });
});
",javascript,1
Clear,"<?php
$input = json_decode($_POST['data'], true); // Safe JSON parsing
if (json_last_error() === JSON_ERROR_NONE) {
    process_data($input);
}
?>","<?php
$input = json_decode($_POST['data'], true); // Safe JSON parsing
if (json_last_error() === JSON_ERROR_NONE) {
    process_data($input);
}
?>",php,0
Clear,"<?php
$input = json_decode($_POST['data'], true); // Safe JSON parsing
if (json_last_error() === JSON_ERROR_NONE) {
    process_data($input);
}
?>","<?php
$input = json_decode($_POST['data'], true); // Safe JSON parsing
if (json_last_error() === JSON_ERROR_NONE) {
    process_data($input);
}
?>",php,0
Clear,"#include <stdio.h>
#include <string.h>

void safe_string_copy(char *dest, const char *src, size_t dest_size) {
    if (dest_size > 0) {
        strncpy(dest, src, dest_size - 1);
        dest[dest_size - 1] = '\0';
    }
}","#include <stdio.h>
#include <string.h>

void safe_string_copy(char *dest, const char *src, size_t dest_size) {
    if (dest_size > 0) {
        strncpy(dest, src, dest_size - 1);
        dest[dest_size - 1] = '\0';
    }
}",c,0
Clear,"import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;

public class SecureSQLExample {

    public static void main(String[] args) {
        String userInput = ""1 OR 1=1"";
        String query = ""SELECT * FROM users WHERE id = ?"";

        try (Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");
             PreparedStatement stmt = conn.prepareStatement(query)) {

            stmt.setString(1, userInput);
            ResultSet rs = stmt.executeQuery();

            while (rs.next()) {
                System.out.println(""User ID: "" + rs.getInt(""id"") + "", Name: "" + rs.getString(""name""));
            }

        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.Connection; import java.sql.DriverManager; import java.sql.PreparedStatement; import java.sql.ResultSet; import java.sql.SQLException; public class SecureSQLExample { public static void main(String[] args) { String userInput = ""1 OR 1=1""; String query = ""SELECT * FROM users WHERE id = ?""; try (Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); PreparedStatement stmt = conn.prepareStatement(query)) { stmt.setString(1, userInput); ResultSet rs = stmt.executeQuery(); while (rs.next()) { System.out.println(""User ID: "" + rs.getInt(""id"") + "", Name: "" + rs.getString(""name"")); } } catch (SQLException e) { e.printStackTrace(); } } }",java,0
Clear,"def safe_comment_display(comment_text):
    import html
    escaped_text = html.escape(comment_text)
    return f""<div class='comment'>{escaped_text}</div>"" ","def safe_comment_display(comment_text):
    import html
    escaped_text = html.escape(comment_text)
    return f""<div class='comment'>{escaped_text}</div>"" ",python,0
SQL Injection,"import psycopg2
def admin_login(admin_id):
    conn = psycopg2.connect(""dbname=test user=postgres"")
    cur = conn.cursor()
    cur.execute(f""SELECT * FROM admins WHERE id = {admin_id}"")
    return cur.fetchone()","import psycopg2
def admin_login(admin_id):
    conn = psycopg2.connect(""dbname=test user=postgres"")
    cur = conn.cursor()
    cur.execute(f""SELECT * FROM admins WHERE id = {admin_id}"")
    return cur.fetchone()",python,1
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Path Traversal,"import java.io.File;
import java.io.FileInputStream;
import java.io.IOException;

public class FileRead {
    public static void main(String[] args) {
        String filePath = ""/path/to/directory/"";
        
        // Vulnerability: User input is directly concatenated with the base file path without proper validation
        String userInput = ""../../../../../etc/passwd"";
        
        try {
            File file = new File(filePath + userInput);
            FileInputStream fis = new FileInputStream(file);
            int data;
            while ((data = fis.read()) != -1) {
                System.out.print((char) data);
            }
            fis.close();
        } catch (IOException e) {
            System.out.println(""Error reading file: "" + e.getMessage());
        }
    }
}","import java.io.File; import java.io.FileInputStream; import java.io.IOException; public class FileRead { public static void main(String[] args) { String filePath = ""/path/to/directory/""; // Vulnerability: User input is directly concatenated with the base file path without proper validation String userInput = ""../../../../../etc/passwd""; try { File file = new File(filePath + userInput); FileInputStream fis = new FileInputStream(file); int data; while ((data = fis.read()) != -1) { System.out.print((char) data); } fis.close(); } catch (IOException e) { System.out.println(""Error reading file: "" + e.getMessage()); } } }",java,1
Clear,"<?php
$message = htmlspecialchars($_GET['message'], ENT_QUOTES, 'UTF-8');
echo $message; // Sanitized output
?>","<?php
$message = htmlspecialchars($_GET['message'], ENT_QUOTES, 'UTF-8');
echo $message; // Sanitized output
?>",php,0
Path Traversal,"import java.io.File;
import java.io.IOException;
import java.nio.file.Files;
import java.util.Scanner;

public class PathTraversalVulnerability {

    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        
        System.out.print(""Enter file name: "");
        String fileName = scanner.nextLine();
        
        File file = new File(""/path/to/files/"" + fileName);
        
        if (file.exists()) {
            try {
                byte[] fileContent = Files.readAllBytes(file.toPath());
                String content = new String(fileContent);
                System.out.println(""File content: "" + content);
            } catch (IOException e) {
                System.out.println(""Error reading file."");
            }
        } else {
            System.out.println(""File not found."");
        }
        
        scanner.close();
    }
}","import java.io.File; import java.io.IOException; import java.nio.file.Files; import java.util.Scanner; public class PathTraversalVulnerability { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter file name: ""); String fileName = scanner.nextLine(); File file = new File(""/path/to/files/"" + fileName); if (file.exists()) { try { byte[] fileContent = Files.readAllBytes(file.toPath()); String content = new String(fileContent); System.out.println(""File content: "" + content); } catch (IOException e) { System.out.println(""Error reading file.""); } } else { System.out.println(""File not found.""); } scanner.close(); } }",java,1
Clear,"<?php
$message = htmlspecialchars($_GET['message'], ENT_QUOTES, 'UTF-8');
echo $message; // Sanitized output
?>","<?php
$message = htmlspecialchars($_GET['message'], ENT_QUOTES, 'UTF-8');
echo $message; // Sanitized output
?>",php,0
Clear,"#include <iostream>
#include <memory>

void safe_memory_management() {
    auto ptr = std::make_unique<int>(42);
    std::cout << *ptr << std::endl;
}","#include <iostream>
#include <memory>

void safe_memory_management() {
    auto ptr = std::make_unique<int>(42);
    std::cout << *ptr << std::endl;
}",cpp,0
Clear,"#include <iostream>
#include <sstream>

int safe_string_to_int(const std::string& str) {
    std::stringstream ss(str);
    int value;
    if (ss >> value) {
        return value;
    }
    throw std::invalid_argument(""Invalid integer"");
}","#include <iostream>
#include <sstream>

int safe_string_to_int(const std::string& str) {
    std::stringstream ss(str);
    int value;
    if (ss >> value) {
        return value;
    }
    throw std::invalid_argument(""Invalid integer"");
}",cpp,0
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Command Injection,"import subprocess
def list_directory(path):
    result = subprocess.run(f""ls {path}"", shell=True, capture_output=True, text=True)
    return result.stdout","import subprocess
def list_directory(path):
    result = subprocess.run(f""ls {path}"", shell=True, capture_output=True, text=True)
    return result.stdout",python,1
Memory Corruption,"#include <iostream>

void unsafe_virtual_call() {
    // Potential vtable corruption vulnerability
    class Base {
    public:
        virtual void func() { std::cout << ""Base"" << std::endl; }
    };
    
    class Derived : public Base {
    public:
        void func() override { std::cout << ""Derived"" << std::endl; }
    };
}","#include <iostream>

void unsafe_virtual_call() {
    // Potential vtable corruption vulnerability
    class Base {
    public:
        virtual void func() { std::cout << ""Base"" << std::endl; }
    };
    
    class Derived : public Base {
    public:
        void func() override { std::cout << ""Derived"" << std::endl; }
    };
}",cpp,1
Code Injection,"const userData = eval('(' + userInput + ')'); // eval injection
","const userData = eval('(' + userInput + ')'); // eval injection
",javascript,1
Clear,"import java.io.IOException;
import java.io.PrintWriter;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

import org.owasp.encoder.Encode;

public class SecureServlet extends HttpServlet {
    
    protected void doPost(HttpServletRequest request, HttpServletResponse response) throws IOException {
        String userInput = request.getParameter(""input"");
        PrintWriter out = response.getWriter();
        
        out.println(""<html>"");
        out.println(""<body>"");
        out.println(""<h1>Your input: "" + Encode.forHtml(userInput) + ""</h1>"");
        out.println(""</body>"");
        out.println(""</html>"");
    }
}","import java.io.IOException; import java.io.PrintWriter; import javax.servlet.http.HttpServlet; import javax.servlet.http.HttpServletRequest; import javax.servlet.http.HttpServletResponse; import org.owasp.encoder.Encode; public class SecureServlet extends HttpServlet { protected void doPost(HttpServletRequest request, HttpServletResponse response) throws IOException { String userInput = request.getParameter(""input""); PrintWriter out = response.getWriter(); out.println(""<html>""); out.println(""<body>""); out.println(""<h1>Your input: "" + Encode.forHtml(userInput) + ""</h1>""); out.println(""</body>""); out.println(""</html>""); } }",java,0
XSS,"<?php
echo $_GET['message']; // XSS
?>","<?php
echo $_GET['message']; // XSS
?>",php,1
Clear,"#include <iostream>
#include <fstream>
#include <string>

void safe_file_reading(const std::string& filename) {
    std::ifstream file(filename);
    if (file.is_open()) {
        std::string line;
        while (std::getline(file, line)) {
            std::cout << line << std::endl;
        }
    }
}","#include <iostream>
#include <fstream>
#include <string>

void safe_file_reading(const std::string& filename) {
    std::ifstream file(filename);
    if (file.is_open()) {
        std::string line;
        while (std::getline(file, line)) {
            std::cout << line << std::endl;
        }
    }
}",cpp,0
Clear,"const userData = JSON.parse(userInput); // Safe JSON parsing
if (userData && typeof userData === 'object') {
    processUserData(userData);
}
","const userData = JSON.parse(userInput); // Safe JSON parsing
if (userData && typeof userData === 'object') {
    processUserData(userData);
}
",javascript,0
Clear,"const userInput = new URLSearchParams(window.location.search).get('input');
const safeOutput = document.createElement('div');
safeOutput.textContent = userInput; // Safe DOM manipulation
document.body.appendChild(safeOutput);
","const userInput = new URLSearchParams(window.location.search).get('input');
const safeOutput = document.createElement('div');
safeOutput.textContent = userInput; // Safe DOM manipulation
document.body.appendChild(safeOutput);
",javascript,0
Clear,"#include <stdio.h>
#include <stdlib.h>

void safe_file_operation(const char *filename) {
    FILE *file = fopen(filename, ""r"");
    if (file != NULL) {
        char buffer[256];
        while (fgets(buffer, sizeof(buffer), file)) {
            printf(""%s"", buffer);
        }
        fclose(file);
    }
}","#include <stdio.h>
#include <stdlib.h>

void safe_file_operation(const char *filename) {
    FILE *file = fopen(filename, ""r"");
    if (file != NULL) {
        char buffer[256];
        while (fgets(buffer, sizeof(buffer), file)) {
            printf(""%s"", buffer);
        }
        fclose(file);
    }
}",c,0
Clear,import org.owasp.encoder.Encode;,import org.owasp.encoder.Encode;,python,0
Code Injection,"const userData = eval('(' + userInput + ')'); // eval injection
","const userData = eval('(' + userInput + ')'); // eval injection
",javascript,1
Clear,"import sqlite3
def get_user_data_safe(username):
    conn = sqlite3.connect('database.db')
    cursor = conn.cursor()
    query = ""SELECT * FROM users WHERE username = ?""
    cursor.execute(query, (username,))
    return cursor.fetchall()","import sqlite3
def get_user_data_safe(username):
    conn = sqlite3.connect('database.db')
    cursor = conn.cursor()
    query = ""SELECT * FROM users WHERE username = ?""
    cursor.execute(query, (username,))
    return cursor.fetchall()",python,0
Memory Corruption,"#include <iostream>

void unsafe_pointer_arithmetic(int* array, int size) {
    for (int i = 0; i <= size; i++) {
        std::cout << *(array + i) << std::endl; // potential out-of-bounds
    }
}","#include <iostream>

void unsafe_pointer_arithmetic(int* array, int size) {
    for (int i = 0; i <= size; i++) {
        std::cout << *(array + i) << std::endl; // potential out-of-bounds
    }
}",cpp,1
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Clear,"import logging
def safe_log_user_action(user_id, action):
    logging.info(f""User {user_id} performed action: {action}"")","import logging
def safe_log_user_action(user_id, action):
    logging.info(f""User {user_id} performed action: {action}"")",python,0
Hardcoded Secrets,"localStorage.setItem('token', 'hardcoded-secret-token-123'); // Hardcoded secret
","localStorage.setItem('token', 'hardcoded-secret-token-123'); // Hardcoded secret
",javascript,1
Hardcoded Secrets,"DATABASE_PASSWORD = ""my_super_secret_password_123""
def db_connect():
    import psycopg2
    return psycopg2.connect(f""dbname=test user=admin password={DATABASE_PASSWORD}"")","DATABASE_PASSWORD = ""my_super_secret_password_123""
def db_connect():
    import psycopg2
    return psycopg2.connect(f""dbname=test user=admin password={DATABASE_PASSWORD}"")",python,1
Code Injection,"const userData = eval('(' + userInput + ')'); // eval injection
","const userData = eval('(' + userInput + ')'); // eval injection
",javascript,1
Clear,"import java.sql.*;

public class SecureSQLInjectionExample {

    public static void main(String[] args) {
        try {
            String userInput = ""'; DROP TABLE users; --""; // Malicious input

            Connection connection = DriverManager.getConnection(""jdbc:mysql://localhost:3306/database"", ""username"", ""password"");

            String query = ""SELECT * FROM users WHERE username = ?"";
            PreparedStatement statement = connection.prepareStatement(query);
            statement.setString(1, userInput);

            ResultSet resultSet = statement.executeQuery();

            // Process the result set
            while (resultSet.next()) {
                System.out.println(resultSet.getString(""username""));
            }

        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.*; public class SecureSQLInjectionExample { public static void main(String[] args) { try { String userInput = ""'; DROP TABLE users; --""; // Malicious input Connection connection = DriverManager.getConnection(""jdbc:mysql://localhost:3306/database"", ""username"", ""password""); String query = ""SELECT * FROM users WHERE username = ?""; PreparedStatement statement = connection.prepareStatement(query); statement.setString(1, userInput); ResultSet resultSet = statement.executeQuery(); // Process the result set while (resultSet.next()) { System.out.println(resultSet.getString(""username"")); } } catch (SQLException e) { e.printStackTrace(); } } }",java,0
Clear,"const userData = JSON.parse(userInput); // Safe JSON parsing
if (userData && typeof userData === 'object') {
    processUserData(userData);
}
","const userData = JSON.parse(userInput); // Safe JSON parsing
if (userData && typeof userData === 'object') {
    processUserData(userData);
}
",javascript,0
Cross-Site Scripting (XSS),"import java.io.IOException;
import javax.servlet.*;
import javax.servlet.http.*;

public class XSSVulnerableServlet extends HttpServlet {
    protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        String userInput = request.getParameter(""input"");
        String output = ""Hello, "" + userInput + ""!"";

        response.setContentType(""text/html"");
        PrintWriter out = response.getWriter();
        out.println(""<html><body>"");
        out.println(""<h1>"" + output + ""</h1>"");
        out.println(""</body></html>"");
    }
}","import java.io.IOException; import javax.servlet.*; import javax.servlet.http.*; public class XSSVulnerableServlet extends HttpServlet { protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { String userInput = request.getParameter(""input""); String output = ""Hello, "" + userInput + ""!""; response.setContentType(""text/html""); PrintWriter out = response.getWriter(); out.println(""<html><body>""); out.println(""<h1>"" + output + ""</h1>""); out.println(""</body></html>""); } }",java,1
Clear,"#include <iostream>
#include <vector>
#include <stdexcept>

int safe_vector_access(const std::vector<int>& vec, size_t index) {
    if (index >= vec.size()) {
        throw std::out_of_range(""Index out of range"");
    }
    return vec[index];
}","#include <iostream>
#include <vector>
#include <stdexcept>

int safe_vector_access(const std::vector<int>& vec, size_t index) {
    if (index >= vec.size()) {
        throw std::out_of_range(""Index out of range"");
    }
    return vec[index];
}",cpp,0
Clear,"import sqlite3
def get_user_data_safe(username):
    conn = sqlite3.connect('database.db')
    cursor = conn.cursor()
    query = ""SELECT * FROM users WHERE username = ?""
    cursor.execute(query, (username,))
    return cursor.fetchall()","import sqlite3
def get_user_data_safe(username):
    conn = sqlite3.connect('database.db')
    cursor = conn.cursor()
    query = ""SELECT * FROM users WHERE username = ?""
    cursor.execute(query, (username,))
    return cursor.fetchall()",python,0
Buffer Overflow,"#include <iostream>
#include <cstring>

void unsafe_c_string(char* input) {
    char buffer[100];
    strcpy(buffer, input); // potential buffer overflow
    std::cout << buffer << std::endl;
}","#include <iostream>
#include <cstring>

void unsafe_c_string(char* input) {
    char buffer[100];
    strcpy(buffer, input); // potential buffer overflow
    std::cout << buffer << std::endl;
}",cpp,1
Clear,"def validate_input(input_str):
    if not isinstance(input_str, str):
        raise TypeError(""Input must be string"")
    if len(input_str) > 100:
        raise ValueError(""Input too long"")
    if '<script>' in input_str.lower():
        raise ValueError(""Invalid input"")
    return input_str.strip()","def validate_input(input_str):
    if not isinstance(input_str, str):
        raise TypeError(""Input must be string"")
    if len(input_str) > 100:
        raise ValueError(""Input too long"")
    if '<script>' in input_str.lower():
        raise ValueError(""Invalid input"")
    return input_str.strip()",python,0
Clear,"def validate_input(input_str):
    if not isinstance(input_str, str):
        raise TypeError(""Input must be string"")
    if len(input_str) > 100:
        raise ValueError(""Input too long"")
    if '<script>' in input_str.lower():
        raise ValueError(""Invalid input"")
    return input_str.strip()","def validate_input(input_str):
    if not isinstance(input_str, str):
        raise TypeError(""Input must be string"")
    if len(input_str) > 100:
        raise ValueError(""Input too long"")
    if '<script>' in input_str.lower():
        raise ValueError(""Invalid input"")
    return input_str.strip()",python,0
Command Injection,"import os
def backup_database(db_name):
    os.system(f""pg_dump {db_name} > backup.sql"")","import os
def backup_database(db_name):
    os.system(f""pg_dump {db_name} > backup.sql"")",python,1
Path Traversal,"import java.io.File;
import java.io.IOException;
import java.nio.file.Files;

public class PathTraversalVulnerability {

    public static void main(String[] args) {
        String userProvidedFileName = ""../secretFile.txt"";
        String baseDirectory = ""/home/user/files/"";

        try {
            File file = new File(baseDirectory + userProvidedFileName);
            byte[] fileData = Files.readAllBytes(file.toPath());
            String fileContent = new String(fileData);
            System.out.println(""File content: "" + fileContent);
        } catch (IOException e) {
            System.out.println(""Error reading file: "" + e.getMessage());
        }
    }
}","import java.io.File; import java.io.IOException; import java.nio.file.Files; public class PathTraversalVulnerability { public static void main(String[] args) { String userProvidedFileName = ""../secretFile.txt""; String baseDirectory = ""/home/user/files/""; try { File file = new File(baseDirectory + userProvidedFileName); byte[] fileData = Files.readAllBytes(file.toPath()); String fileContent = new String(fileData); System.out.println(""File content: "" + fileContent); } catch (IOException e) { System.out.println(""Error reading file: "" + e.getMessage()); } } }",java,1
XSS,"const userInput = document.location.search.split('=')[1];
document.write(userInput); // XSS
","const userInput = document.location.search.split('=')[1];
document.write(userInput); // XSS
",javascript,1
Command Injection,"import java.io.*;

public class CommandInjectionExample {
    public static void main(String[] args) throws IOException {
        BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));
        
        System.out.print(""Enter a file name to display its content: "");
        String fileName = reader.readLine();
        
        // Vulnerable code: executing system command with user input
        Process process = Runtime.getRuntime().exec(""cat "" + fileName);
        
        BufferedReader inputReader = new BufferedReader(new InputStreamReader(process.getInputStream()));
        String line;
        while ((line = inputReader.readLine()) != null) {
            System.out.println(line);
        }
    }
}","import java.io.*; public class CommandInjectionExample { public static void main(String[] args) throws IOException { BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a file name to display its content: ""); String fileName = reader.readLine(); // Vulnerable code: executing system command with user input Process process = Runtime.getRuntime().exec(""cat "" + fileName); BufferedReader inputReader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = inputReader.readLine()) != null) { System.out.println(line); } } }",java,1
Clear,"const userInput = new URLSearchParams(window.location.search).get('input');
const safeOutput = document.createElement('div');
safeOutput.textContent = userInput; // Safe DOM manipulation
document.body.appendChild(safeOutput);
","const userInput = new URLSearchParams(window.location.search).get('input');
const safeOutput = document.createElement('div');
safeOutput.textContent = userInput; // Safe DOM manipulation
document.body.appendChild(safeOutput);
",javascript,0
Command Injection,"const shell = require('child_process');
shell.exec('ping ' + userInput); // Command Injection
","const shell = require('child_process');
shell.exec('ping ' + userInput); // Command Injection
",javascript,1
SQL Injection,"import mysql.connector
def search_products(category):
    db = mysql.connector.connect(host=""localhost"", user=""user"", password=""pass"", database=""shop"")
    cursor = db.cursor()
    cursor.execute(""SELECT * FROM products WHERE category = '%s'"" % category)
    return cursor.fetchall()","import mysql.connector
def search_products(category):
    db = mysql.connector.connect(host=""localhost"", user=""user"", password=""pass"", database=""shop"")
    cursor = db.cursor()
    cursor.execute(""SELECT * FROM products WHERE category = '%s'"" % category)
    return cursor.fetchall()",python,1
Clear,"import tempfile
import os

def create_secure_temp(data):
    with tempfile.NamedTemporaryFile(mode='w', delete=True, suffix='.tmp') as temp:
        temp.write(data)
        temp.flush()
        return temp.name","import tempfile
import os

def create_secure_temp(data):
    with tempfile.NamedTemporaryFile(mode='w', delete=True, suffix='.tmp') as temp:
        temp.write(data)
        temp.flush()
        return temp.name",python,0
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Clear,"import java.io.*;
import javax.servlet.*;
import javax.servlet.http.*;

public class SecureServlet extends HttpServlet {
    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        String userInput = request.getParameter(""input"");
        
        // Sanitize user input to prevent XSS
        String sanitizedInput = sanitizeInput(userInput);
        
        String output = ""<p>User input: "" + sanitizedInput + ""</p>"";
        
        response.setContentType(""text/html"");
        PrintWriter out = response.getWriter();
        out.println(""<html><body>"");
        out.println(output);
        out.println(""</body></html>"");
    }
    
    private String sanitizeInput(String input) {
        // Implement proper sanitization logic here
        // For example, you can use libraries like OWASP Java Encoder or HTML escaping functions
        
        // As a basic example, you can escape HTML special characters
        return input != null ? input.replaceAll(""&"", ""&amp;"").replaceAll(""<"", ""&lt;"").replaceAll("">"", ""&gt;"") : """";
    }
}","import java.io.*; import javax.servlet.*; import javax.servlet.http.*; public class SecureServlet extends HttpServlet { protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { String userInput = request.getParameter(""input""); // Sanitize user input to prevent XSS String sanitizedInput = sanitizeInput(userInput); String output = ""<p>User input: "" + sanitizedInput + ""</p>""; response.setContentType(""text/html""); PrintWriter out = response.getWriter(); out.println(""<html><body>""); out.println(output); out.println(""</body></html>""); } private String sanitizeInput(String input) { // Implement proper sanitization logic here // For example, you can use libraries like OWASP Java Encoder or HTML escaping functions // As a basic example, you can escape HTML special characters return input != null ? input.replaceAll(""&"", ""&amp;"").replaceAll(""<"", ""&lt;"").replaceAll("">"", ""&gt;"") : """"; } }",java,0
Out-of-Bounds,"#include <iostream>

class UnsafeClass {
    int data[10];
public:
    int get_data(int index) {
        return data[index]; // no bounds checking
    }
};","#include <iostream>

class UnsafeClass {
    int data[10];
public:
    int get_data(int index) {
        return data[index]; // no bounds checking
    }
};",cpp,1
Path Traversal,"import java.io.File;
import java.io.FileInputStream;
import java.io.IOException;

public class PathTraversalExample {

    public static void main(String[] args) {
        String fileName = args[0]; // User-supplied file name

        // Vulnerable code allowing path traversal
        File file = new File(""/path/to/files/"" + fileName);
        
        try {
            FileInputStream fis = new FileInputStream(file);
            int data;
            while ((data = fis.read()) != -1) {
                System.out.print((char) data);
            }
            fis.close();
        } catch (IOException e) {
            System.err.println(""Error reading file: "" + e.getMessage());
        }
    }
}","import java.io.File; import java.io.FileInputStream; import java.io.IOException; public class PathTraversalExample { public static void main(String[] args) { String fileName = args[0]; // User-supplied file name // Vulnerable code allowing path traversal File file = new File(""/path/to/files/"" + fileName); try { FileInputStream fis = new FileInputStream(file); int data; while ((data = fis.read()) != -1) { System.out.print((char) data); } fis.close(); } catch (IOException e) { System.err.println(""Error reading file: "" + e.getMessage()); } } }",java,1
SQL Injection,"<?php
$username = $_POST['username'];
$query = ""SELECT * FROM users WHERE username = '$username'"";
$result = mysql_query($query); // SQL Injection
?>","<?php
$username = $_POST['username'];
$query = ""SELECT * FROM users WHERE username = '$username'"";
$result = mysql_query($query); // SQL Injection
?>",php,1
Clear,"import requests
def safe_fetch_url(url):
    allowed_domains = ['example.com', 'api.trusted.com']
    from urllib.parse import urlparse
    domain = urlparse(url).netloc
    if domain not in allowed_domains:
        raise ValueError(""Domain not allowed"")
    return requests.get(url).text","import requests
def safe_fetch_url(url):
    allowed_domains = ['example.com', 'api.trusted.com']
    from urllib.parse import urlparse
    domain = urlparse(url).netloc
    if domain not in allowed_domains:
        raise ValueError(""Domain not allowed"")
    return requests.get(url).text",python,0
Buffer Overflow,"#include <iostream>
#include <cstdio>

void unsafe_c_input() {
    char buffer[50];
    scanf(""%s"", buffer); // no length limit
    std::cout << buffer << std::endl;
}","#include <iostream>
#include <cstdio>

void unsafe_c_input() {
    char buffer[50];
    scanf(""%s"", buffer); // no length limit
    std::cout << buffer << std::endl;
}",cpp,1
Hardcoded Secrets,"localStorage.setItem('token', 'hardcoded-secret-token-123'); // Hardcoded secret
","localStorage.setItem('token', 'hardcoded-secret-token-123'); // Hardcoded secret
",javascript,1
Hardcoded Secrets,"localStorage.setItem('token', 'hardcoded-secret-token-123'); // Hardcoded secret
","localStorage.setItem('token', 'hardcoded-secret-token-123'); // Hardcoded secret
",javascript,1
XSS,"<?php
echo $_GET['message']; // XSS
?>","<?php
echo $_GET['message']; // XSS
?>",php,1
Clear,"To fix the insecure deserialization vulnerability in the given Java code snippet, you need to implement proper security measures. Here's an example of how you can improve the code by adding input validation and using a secure deserialization mechanism:

```java
import java.io.ByteArrayInputStream;
import java.io.ObjectInputStream;

public class InsecureDeserializationExample {

    public static void main(String[] args) {
        String userInput = ""rO0ABXNyADJjb20uZXhhbXBsZS5Vc2VySW5mb1NjcmlwdEludGVybmF0aW9uRXhjZXB0aW9ucy5Vc2VySW5mb1NjcmlwdEludGVybmF0aW9uO6UJPyusGgIAAHhyAEBjb20uZXhhbXBsZS5Vc2VySW5mb1NjcmlwdEludGVybmF0aW9uRXhjZXB0aW9ucy5Vc2VySW5mb1NjcmlwdEludGVybmF0aW9uhjxQoAmrTAA","To fix the insecure deserialization vulnerability in the given Java code snippet, you need to implement proper security measures. Here's an example of how you can improve the code by adding input validation and using a secure deserialization mechanism: ```java import java.io.ByteArrayInputStream; import java.io.ObjectInputStream; public class InsecureDeserializationExample { public static void main(String[] args) { String userInput = ""rO0ABXNyADJjb20uZXhhbXBsZS5Vc2VySW5mb1NjcmlwdEludGVybmF0aW9uRXhjZXB0aW9ucy5Vc2VySW5mb1NjcmlwdEludGVybmF0aW9uO6UJPyusGgIAAHhyAEBjb20uZXhhbXBsZS5Vc2VySW5mb1NjcmlwdEludGVybmF0aW9uRXhjZXB0aW9ucy5Vc2VySW5mb1NjcmlwdEludGVybmF0aW9uhjxQoAmrTAA",java,0
Clear,"import java.util.Scanner;

public class SecureBufferUsage {
    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        System.out.print(""Enter a string: "");
        String userInput = scanner.nextLine();

        char[] buffer = new char[10]; // Fixed size buffer

        // Safe code: copying user input into buffer with bounds checking
        userInput = userInput.substring(0, Math.min(userInput.length(), buffer.length));
        userInput.getChars(0, userInput.length(), buffer, 0);

        System.out.println(""Buffer content: "" + new String(buffer));
    }
}","import java.util.Scanner; public class SecureBufferUsage { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter a string: ""); String userInput = scanner.nextLine(); char[] buffer = new char[10]; // Fixed size buffer // Safe code: copying user input into buffer with bounds checking userInput = userInput.substring(0, Math.min(userInput.length(), buffer.length)); userInput.getChars(0, userInput.length(), buffer, 0); System.out.println(""Buffer content: "" + new String(buffer)); } }",java,0
Code Injection,"const userData = eval('(' + userInput + ')'); // eval injection
","const userData = eval('(' + userInput + ')'); // eval injection
",javascript,1
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Clear,"import java.util.Scanner;

public class SecureBufferHandling {

    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);

        System.out.print(""Enter a string: "");
        String userInput = scanner.nextLine();

        // Ensure that the input does not exceed the buffer size
        int bufferSize = 10;
        if (userInput.length() > bufferSize) {
            System.out.println(""Input exceeds buffer size. Please enter a shorter string."");
            return;
        }

        char[] buffer = new char[bufferSize];
        userInput.getChars(0, Math.min(userInput.length(), bufferSize), buffer, 0);

        System.out.println(""Buffer content: "" + new String(buffer));
    }
}","import java.util.Scanner; public class SecureBufferHandling { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter a string: ""); String userInput = scanner.nextLine(); // Ensure that the input does not exceed the buffer size int bufferSize = 10; if (userInput.length() > bufferSize) { System.out.println(""Input exceeds buffer size. Please enter a shorter string.""); return; } char[] buffer = new char[bufferSize]; userInput.getChars(0, Math.min(userInput.length(), bufferSize), buffer, 0); System.out.println(""Buffer content: "" + new String(buffer)); } }",java,0
Memory Corruption,"#include <iostream>

void unsafe_pointer_arithmetic(int* array, int size) {
    for (int i = 0; i <= size; i++) {
        std::cout << *(array + i) << std::endl; // potential out-of-bounds
    }
}","#include <iostream>

void unsafe_pointer_arithmetic(int* array, int size) {
    for (int i = 0; i <= size; i++) {
        std::cout << *(array + i) << std::endl; // potential out-of-bounds
    }
}",cpp,1
Clear,"#include <iostream>
#include <sstream>

int safe_string_to_int(const std::string& str) {
    std::stringstream ss(str);
    int value;
    if (ss >> value) {
        return value;
    }
    throw std::invalid_argument(""Invalid integer"");
}","#include <iostream>
#include <sstream>

int safe_string_to_int(const std::string& str) {
    std::stringstream ss(str);
    int value;
    if (ss >> value) {
        return value;
    }
    throw std::invalid_argument(""Invalid integer"");
}",cpp,0
Clear,"#include <stdio.h>
#include <stdlib.h>

void safe_file_operation(const char *filename) {
    FILE *file = fopen(filename, ""r"");
    if (file != NULL) {
        char buffer[256];
        while (fgets(buffer, sizeof(buffer), file)) {
            printf(""%s"", buffer);
        }
        fclose(file);
    }
}","#include <stdio.h>
#include <stdlib.h>

void safe_file_operation(const char *filename) {
    FILE *file = fopen(filename, ""r"");
    if (file != NULL) {
        char buffer[256];
        while (fgets(buffer, sizeof(buffer), file)) {
            printf(""%s"", buffer);
        }
        fclose(file);
    }
}",c,0
Hardcoded Secrets,"import requests
def call_api():
    api_key = ""sk_live_1234567890abcdef""
    headers = {'Authorization': f'Bearer {api_key}'}
    return requests.get('https://api.example.com/data', headers=headers)","import requests
def call_api():
    api_key = ""sk_live_1234567890abcdef""
    headers = {'Authorization': f'Bearer {api_key}'}
    return requests.get('https://api.example.com/data', headers=headers)",python,1
XSS,"<?php
echo $_GET['message']; // XSS
?>","<?php
echo $_GET['message']; // XSS
?>",php,1
Clear,"import pickle
def safe_deserialize(data):
    allowed_classes = {'SafeClass', 'AnotherSafeClass'}
    return pickle.loads(data)","import pickle
def safe_deserialize(data):
    allowed_classes = {'SafeClass', 'AnotherSafeClass'}
    return pickle.loads(data)",python,0
Clear,"To fix this code and implement proper security measures to prevent Insecure Deserialization vulnerabilities, you should perform input validation, use whitelisting for allowed classes, and consider using a secure serialization mechanism like JSON or XML instead of Java serialization.

Here is an improved version of the code with security measures implemented:

```java
import java.io.*;
import java.util.Base64;

public class SecureDeserializationExample {
    public static void main(String[] args) {
        String userInput = ""abcdef""; // Simulating user input (should be obtained from an untrusted source)

        try {
            // Perform input validation to ensure the data is safe to deserialize
            if (!isValidInput(userInput)) {
                throw new SecurityException(""Invalid input data"");
            }

            // Decode the Base64 encoded user input
            byte[] decodedData = Base64.getDecoder().decode(userInput);

            // Deserialize the decoded byte array with proper validation
            ByteArrayInputStream bis = new ByteArrayInputStream(decodedData);
            ObjectInput in = new ObjectInputStream(bis);

            // Perform whitelisting of allowed classes for deserialization
            Object obj = in.readObject();
            
            if (obj instanceof AllowedClass) {
                System.out.println(""Deserialized object: "" + obj);","To fix this code and implement proper security measures to prevent Insecure Deserialization vulnerabilities, you should perform input validation, use whitelisting for allowed classes, and consider using a secure serialization mechanism like JSON or XML instead of Java serialization. Here is an improved version of the code with security measures implemented: ```java import java.io.*; import java.util.Base64; public class SecureDeserializationExample { public static void main(String[] args) { String userInput = ""abcdef""; // Simulating user input (should be obtained from an untrusted source) try { // Perform input validation to ensure the data is safe to deserialize if (!isValidInput(userInput)) { throw new SecurityException(""Invalid input data""); } // Decode the Base64 encoded user input byte[] decodedData = Base64.getDecoder().decode(userInput); // Deserialize the decoded byte array with proper validation ByteArrayInputStream bis = new ByteArrayInputStream(decodedData); ObjectInput in = new ObjectInputStream(bis); // Perform whitelisting of allowed classes for deserialization Object obj = in.readObject(); if (obj instanceof AllowedClass) { System.out.println(""Deserialized object: "" + obj);",java,0
Cross-Site Scripting (XSS),"from flask import Flask, request
app = Flask(__name__)

@app.route('/search')
def search():
    query = request.args.get('q', '')
    return f'<h1>Search results for: {query}</h1>'","from flask import Flask, request
app = Flask(__name__)

@app.route('/search')
def search():
    query = request.args.get('q', '')
    return f'<h1>Search results for: {query}</h1>'",python,1
SQL Injection,"app.get('/user/:id', (req, res) => {
    const query = `SELECT * FROM users WHERE id = ${req.params.id}`; // SQL Injection
    db.query(query, (err, result) => {
        res.json(result);
    });
});
","app.get('/user/:id', (req, res) => {
    const query = `SELECT * FROM users WHERE id = ${req.params.id}`; // SQL Injection
    db.query(query, (err, result) => {
        res.json(result);
    });
});
",javascript,1
Memory Corruption,"#include <iostream>

void unsafe_pointer_arithmetic(int* array, int size) {
    for (int i = 0; i <= size; i++) {
        std::cout << *(array + i) << std::endl; // potential out-of-bounds
    }
}","#include <iostream>

void unsafe_pointer_arithmetic(int* array, int size) {
    for (int i = 0; i <= size; i++) {
        std::cout << *(array + i) << std::endl; // potential out-of-bounds
    }
}",cpp,1
SQL Injection,"import sqlite3
def get_user_data(username):
    conn = sqlite3.connect('database.db')
    cursor = conn.cursor()
    query = ""SELECT * FROM users WHERE username = '"" + username + ""'""
    cursor.execute(query)
    return cursor.fetchall()","import sqlite3
def get_user_data(username):
    conn = sqlite3.connect('database.db')
    cursor = conn.cursor()
    query = ""SELECT * FROM users WHERE username = '"" + username + ""'""
    cursor.execute(query)
    return cursor.fetchall()",python,1
Clear,"To fix the SQL Injection vulnerability in the provided Java code snippet, you should use parameterized queries instead of directly concatenating user input into the SQL query. Here is an updated version of the code with proper security measures:

```java
import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.util.Scanner;

public class SQLInjectionSecureCode {

    public static void main(String[] args) {
        try {
            Scanner scanner = new Scanner(System.in);
            System.out.print(""Enter username: "");
            String username = scanner.nextLine();

            // Use parameterized query to prevent SQL Injection
            String sql = ""SELECT * FROM users WHERE username = ?"";
            
            Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");
            PreparedStatement statement = conn.prepareStatement(sql);
            
            // Set the parameter safely
            statement.setString(1, username);

            ResultSet resultSet = statement.executeQuery();

            while (resultSet.next()) {
                System.out.println(""User ID: "" + resultSet.getInt(""id"") + "", Username: "" + resultSet.getString(""username""));
            }

        } catch (SQLException e) {
            e.printStackTrace();
        }","To fix the SQL Injection vulnerability in the provided Java code snippet, you should use parameterized queries instead of directly concatenating user input into the SQL query. Here is an updated version of the code with proper security measures: ```java import java.sql.Connection; import java.sql.DriverManager; import java.sql.PreparedStatement; import java.sql.ResultSet; import java.sql.SQLException; import java.util.Scanner; public class SQLInjectionSecureCode { public static void main(String[] args) { try { Scanner scanner = new Scanner(System.in); System.out.print(""Enter username: ""); String username = scanner.nextLine(); // Use parameterized query to prevent SQL Injection String sql = ""SELECT * FROM users WHERE username = ?""; Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); PreparedStatement statement = conn.prepareStatement(sql); // Set the parameter safely statement.setString(1, username); ResultSet resultSet = statement.executeQuery(); while (resultSet.next()) { System.out.println(""User ID: "" + resultSet.getInt(""id"") + "", Username: "" + resultSet.getString(""username"")); } } catch (SQLException e) { e.printStackTrace(); }",java,0
SQL Injection,"<?php
$username = $_POST['username'];
$query = ""SELECT * FROM users WHERE username = '$username'"";
$result = mysql_query($query); // SQL Injection
?>","<?php
$username = $_POST['username'];
$query = ""SELECT * FROM users WHERE username = '$username'"";
$result = mysql_query($query); // SQL Injection
?>",php,1
Command Injection,"const shell = require('child_process');
shell.exec('ping ' + userInput); // Command Injection
","const shell = require('child_process');
shell.exec('ping ' + userInput); // Command Injection
",javascript,1
Clear,"<?php
$username = $_POST['username'];
$stmt = $pdo->prepare(""SELECT * FROM users WHERE username = ?"");
$stmt->execute([$username]); // Parameterized query
?>","<?php
$username = $_POST['username'];
$stmt = $pdo->prepare(""SELECT * FROM users WHERE username = ?"");
$stmt->execute([$username]); // Parameterized query
?>",php,0
Cross-Site Scripting (XSS),"def display_comment(comment_text):
    return f""<div class='comment'>{comment_text}</div>"" ","def display_comment(comment_text):
    return f""<div class='comment'>{comment_text}</div>"" ",python,1
Clear,"const token = process.env.API_TOKEN; // Environment variable
fetch('/api/data', {
    headers: { 'Authorization': `Bearer ${token}` }
});
","const token = process.env.API_TOKEN; // Environment variable
fetch('/api/data', {
    headers: { 'Authorization': `Bearer ${token}` }
});
",javascript,0
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Out-of-Bounds,"#include <iostream>

class UnsafeClass {
    int data[10];
public:
    int get_data(int index) {
        return data[index]; // no bounds checking
    }
};","#include <iostream>

class UnsafeClass {
    int data[10];
public:
    int get_data(int index) {
        return data[index]; // no bounds checking
    }
};",cpp,1
Clear,"#include <iostream>
#include <memory>

void safe_memory_management() {
    auto ptr = std::make_unique<int>(42);
    std::cout << *ptr << std::endl;
}","#include <iostream>
#include <memory>

void safe_memory_management() {
    auto ptr = std::make_unique<int>(42);
    std::cout << *ptr << std::endl;
}",cpp,0
Clear,"const userData = JSON.parse(userInput); // Safe JSON parsing
if (userData && typeof userData === 'object') {
    processUserData(userData);
}
","const userData = JSON.parse(userInput); // Safe JSON parsing
if (userData && typeof userData === 'object') {
    processUserData(userData);
}
",javascript,0
Clear,"import os
def get_api_key():
    return os.environ.get('API_KEY')","import os
def get_api_key():
    return os.environ.get('API_KEY')",python,0
Clear,"const token = process.env.API_TOKEN; // Environment variable
fetch('/api/data', {
    headers: { 'Authorization': `Bearer ${token}` }
});
","const token = process.env.API_TOKEN; // Environment variable
fetch('/api/data', {
    headers: { 'Authorization': `Bearer ${token}` }
});
",javascript,0
Clear,"#include <iostream>
#include <memory>

void safe_memory_management() {
    auto ptr = std::make_unique<int>(42);
    std::cout << *ptr << std::endl;
}","#include <iostream>
#include <memory>

void safe_memory_management() {
    auto ptr = std::make_unique<int>(42);
    std::cout << *ptr << std::endl;
}",cpp,0
Command Injection,"<?php
$cmd = $_GET['cmd'];
system($cmd); // Command Injection
?>","<?php
$cmd = $_GET['cmd'];
system($cmd); // Command Injection
?>",php,1
Clear,"app.get('/user/:id', (req, res) => {
    const userId = parseInt(req.params.id);
    db.query('SELECT * FROM users WHERE id = ?', [userId], (err, result) => {
        res.json(result);
    });
});
","app.get('/user/:id', (req, res) => {
    const userId = parseInt(req.params.id);
    db.query('SELECT * FROM users WHERE id = ?', [userId], (err, result) => {
        res.json(result);
    });
});
",javascript,0
SQL Injection,"import mysql.connector
def search_products(category):
    db = mysql.connector.connect(host=""localhost"", user=""user"", password=""pass"", database=""shop"")
    cursor = db.cursor()
    cursor.execute(""SELECT * FROM products WHERE category = '%s'"" % category)
    return cursor.fetchall()","import mysql.connector
def search_products(category):
    db = mysql.connector.connect(host=""localhost"", user=""user"", password=""pass"", database=""shop"")
    cursor = db.cursor()
    cursor.execute(""SELECT * FROM products WHERE category = '%s'"" % category)
    return cursor.fetchall()",python,1
Insecure Deserialization,"import pickle
def load_user_data(filename):
    with open(filename, 'rb') as f:
        data = pickle.load(f)
    return data","import pickle
def load_user_data(filename):
    with open(filename, 'rb') as f:
        data = pickle.load(f)
    return data",python,1
Clear,"import java.io.IOException;
import java.io.PrintWriter;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

public class SecureServlet extends HttpServlet {

    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws IOException {
        String userInput = request.getParameter(""input"");

        PrintWriter out = response.getWriter();
        out.println(""<html>"");
        out.println(""<body>"");
        out.println(""<h1>User Input: "" + encodeHtml(userInput) + ""</h1>"");
        out.println(""</body>"");
        out.println(""</html>"");
    }

    private String encodeHtml(String input) {
        return input == null ? """" : input
                .replace(""&"", ""&amp;"")
                .replace(""<"", ""&lt;"")
                .replace("">"", ""&gt;"")
                .replace(""\"""", ""&quot;"")
                .replace(""'"", ""&#39;"");
    }
}","import java.io.IOException; import java.io.PrintWriter; import javax.servlet.http.HttpServlet; import javax.servlet.http.HttpServletRequest; import javax.servlet.http.HttpServletResponse; public class SecureServlet extends HttpServlet { protected void doGet(HttpServletRequest request, HttpServletResponse response) throws IOException { String userInput = request.getParameter(""input""); PrintWriter out = response.getWriter(); out.println(""<html>""); out.println(""<body>""); out.println(""<h1>User Input: "" + encodeHtml(userInput) + ""</h1>""); out.println(""</body>""); out.println(""</html>""); } private String encodeHtml(String input) { return input == null ? """" : input .replace(""&"", ""&amp;"") .replace(""<"", ""&lt;"") .replace("">"", ""&gt;"") .replace(""\"""", ""&quot;"") .replace(""'"", ""&#39;""); } }",java,0
Clear,"To fix this code and make it secure, you need to implement proper security measures to prevent arbitrary code execution through insecure deserialization. Here are the steps you can take to enhance the security of the code:

1. **Validate User Input**: Instead of directly using the user input as a serialized object, you should validate and sanitize the input before deserializing it. You can use input validation techniques to ensure that only trusted inputs are processed.

2. **Use a Whitelist Approach**: Define a whitelist of allowed classes that can be deserialized. Restrict deserialization to only these known classes to prevent attackers from injecting malicious objects into the application.

3. **Implement Object Type Checking**: Before deserializing the object, check its type against the allowed types in your whitelist. Ensure that the class being deserialized is expected and safe for your application.

4. **Use a Secure Deserialization Library**: Consider using a secure deserialization library like Google's Gson or Jackson with proper configuration settings for safer object deserialization.

5. **Enable Security Manager**: Java Security Manager can be used to restrict access to resources and actions by untrusted code during deserialization.

Here is an example of how you could modify the code to incorporate these security measures:

```java","To fix this code and make it secure, you need to implement proper security measures to prevent arbitrary code execution through insecure deserialization. Here are the steps you can take to enhance the security of the code: 1. **Validate User Input**: Instead of directly using the user input as a serialized object, you should validate and sanitize the input before deserializing it. You can use input validation techniques to ensure that only trusted inputs are processed. 2. **Use a Whitelist Approach**: Define a whitelist of allowed classes that can be deserialized. Restrict deserialization to only these known classes to prevent attackers from injecting malicious objects into the application. 3. **Implement Object Type Checking**: Before deserializing the object, check its type against the allowed types in your whitelist. Ensure that the class being deserialized is expected and safe for your application. 4. **Use a Secure Deserialization Library**: Consider using a secure deserialization library like Google's Gson or Jackson with proper configuration settings for safer object deserialization. 5. **Enable Security Manager**: Java Security Manager can be used to restrict access to resources and actions by untrusted code during deserialization. Here is an example of how you could modify the code to incorporate these security measures: ```java",php,0
Code Injection,"const userData = eval('(' + userInput + ')'); // eval injection
","const userData = eval('(' + userInput + ')'); // eval injection
",javascript,1
Clear,"const token = process.env.API_TOKEN; // Environment variable
fetch('/api/data', {
    headers: { 'Authorization': `Bearer ${token}` }
});
","const token = process.env.API_TOKEN; // Environment variable
fetch('/api/data', {
    headers: { 'Authorization': `Bearer ${token}` }
});
",javascript,0
Buffer Overflow,"#include <iostream>
#include <cstdio>

void unsafe_c_input() {
    char buffer[50];
    scanf(""%s"", buffer); // no length limit
    std::cout << buffer << std::endl;
}","#include <iostream>
#include <cstdio>

void unsafe_c_input() {
    char buffer[50];
    scanf(""%s"", buffer); // no length limit
    std::cout << buffer << std::endl;
}",cpp,1
Clear,"#include <iostream>
#include <string>
#include <vector>

void safe_string_handling(const std::string& input) {
    std::string safe_copy = input;
    std::cout << safe_copy << std::endl;
}","#include <iostream>
#include <string>
#include <vector>

void safe_string_handling(const std::string& input) {
    std::string safe_copy = input;
    std::cout << safe_copy << std::endl;
}",cpp,0
Clear,"<?php
$cmd = escapeshellarg($_GET['cmd']);
system(""ls "" . $cmd); // Escaped command
?>","<?php
$cmd = escapeshellarg($_GET['cmd']);
system(""ls "" . $cmd); // Escaped command
?>",php,0
Clear,"import java.util.Scanner;

public class SecureBufferExample {
    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        System.out.print(""Enter your name: "");
        String name = scanner.nextLine();

        // Assuming the input buffer size is limited to 10 characters
        char[] buffer = new char[10];

        // Truncate user input if it exceeds buffer size
        if (name.length() > buffer.length) {
            name.getChars(0, buffer.length, buffer, 0);
        } else {
            name.getChars(0, name.length(), buffer, 0);
        }

        System.out.println(""Hello, "" + new String(buffer));
    }
}","import java.util.Scanner; public class SecureBufferExample { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter your name: ""); String name = scanner.nextLine(); // Assuming the input buffer size is limited to 10 characters char[] buffer = new char[10]; // Truncate user input if it exceeds buffer size if (name.length() > buffer.length) { name.getChars(0, buffer.length, buffer, 0); } else { name.getChars(0, name.length(), buffer, 0); } System.out.println(""Hello, "" + new String(buffer)); } }",java,0
Clear,"#include <iostream>
#include <fstream>
#include <string>

void safe_file_reading(const std::string& filename) {
    std::ifstream file(filename);
    if (file.is_open()) {
        std::string line;
        while (std::getline(file, line)) {
            std::cout << line << std::endl;
        }
    }
}","#include <iostream>
#include <fstream>
#include <string>

void safe_file_reading(const std::string& filename) {
    std::ifstream file(filename);
    if (file.is_open()) {
        std::string line;
        while (std::getline(file, line)) {
            std::cout << line << std::endl;
        }
    }
}",cpp,0
Clear,"import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;
import java.util.ArrayList;
import java.util.List;

public class SecureCommandExecution {

    public static void main(String[] args) throws IOException {
        BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));

        System.out.print(""Enter a command to execute: "");
        String userInput = reader.readLine();

        List<String> command = new ArrayList<>();
        command.add(""echo"");
        command.add(userInput);

        ProcessBuilder processBuilder = new ProcessBuilder(command);
        
        Process process = processBuilder.start();

        BufferedReader inputReader = new BufferedReader(new InputStreamReader(process.getInputStream()));

        String output;
        while ((output = inputReader.readLine()) != null) {
            System.out.println(output);
        }
    }
}","import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; import java.util.ArrayList; import java.util.List; public class SecureCommandExecution { public static void main(String[] args) throws IOException { BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a command to execute: ""); String userInput = reader.readLine(); List<String> command = new ArrayList<>(); command.add(""echo""); command.add(userInput); ProcessBuilder processBuilder = new ProcessBuilder(command); Process process = processBuilder.start(); BufferedReader inputReader = new BufferedReader(new InputStreamReader(process.getInputStream())); String output; while ((output = inputReader.readLine()) != null) { System.out.println(output); } } }",java,0
Clear,"const userInput = new URLSearchParams(window.location.search).get('input');
const safeOutput = document.createElement('div');
safeOutput.textContent = userInput; // Safe DOM manipulation
document.body.appendChild(safeOutput);
","const userInput = new URLSearchParams(window.location.search).get('input');
const safeOutput = document.createElement('div');
safeOutput.textContent = userInput; // Safe DOM manipulation
document.body.appendChild(safeOutput);
",javascript,0
Clear,"#include <stdio.h>
#include <string.h>

void safe_string_copy(char *dest, const char *src, size_t dest_size) {
    if (dest_size > 0) {
        strncpy(dest, src, dest_size - 1);
        dest[dest_size - 1] = '\0';
    }
}","#include <stdio.h>
#include <string.h>

void safe_string_copy(char *dest, const char *src, size_t dest_size) {
    if (dest_size > 0) {
        strncpy(dest, src, dest_size - 1);
        dest[dest_size - 1] = '\0';
    }
}",c,0
Clear,"#include <iostream>
#include <sstream>

int safe_string_to_int(const std::string& str) {
    std::stringstream ss(str);
    int value;
    if (ss >> value) {
        return value;
    }
    throw std::invalid_argument(""Invalid integer"");
}","#include <iostream>
#include <sstream>

int safe_string_to_int(const std::string& str) {
    std::stringstream ss(str);
    int value;
    if (ss >> value) {
        return value;
    }
    throw std::invalid_argument(""Invalid integer"");
}",cpp,0
Hardcoded Secrets,"import requests
def call_api():
    api_key = ""sk_live_1234567890abcdef""
    headers = {'Authorization': f'Bearer {api_key}'}
    return requests.get('https://api.example.com/data', headers=headers)","import requests
def call_api():
    api_key = ""sk_live_1234567890abcdef""
    headers = {'Authorization': f'Bearer {api_key}'}
    return requests.get('https://api.example.com/data', headers=headers)",python,1
Clear,"To make this code snippet more secure, you need to implement proper security measures to prevent Insecure Deserialization vulnerabilities. Here are some steps you can take:

1. **Validate Input**: Before deserializing the object, validate the input to ensure it is safe. You can use whitelisting or other validation techniques to only allow certain classes to be deserialized.

2. **Use a Secure Deserialization Framework**: Instead of using the default Java `ObjectInputStream`, consider using a secure deserialization framework like Google's `Gson` or Apache `Jackson` with appropriate configuration settings for safe deserialization.

3. **Implement Serialization Filters**: Implement serialization filters to restrict which classes can be deserialized. You can use frameworks like `OWASP Java Serial Killer` or `JEP 290: Filter Incoming Serialization Data`.

4. **Avoid using ObjectInputStream**: If possible, avoid deserializing objects altogether. Consider using safer data interchange formats like JSON or XML instead of Java serialization.

5. **Sanitize Input Data**: If deserialization is necessary, sanitize the input data before deserialization to remove any potentially harmful content.

6. **Handle Exceptions Carefully**: Handle exceptions securely by providing minimal information in error messages and log output to avoid leaking sensitive","To make this code snippet more secure, you need to implement proper security measures to prevent Insecure Deserialization vulnerabilities. Here are some steps you can take: 1. **Validate Input**: Before deserializing the object, validate the input to ensure it is safe. You can use whitelisting or other validation techniques to only allow certain classes to be deserialized. 2. **Use a Secure Deserialization Framework**: Instead of using the default Java `ObjectInputStream`, consider using a secure deserialization framework like Google's `Gson` or Apache `Jackson` with appropriate configuration settings for safe deserialization. 3. **Implement Serialization Filters**: Implement serialization filters to restrict which classes can be deserialized. You can use frameworks like `OWASP Java Serial Killer` or `JEP 290: Filter Incoming Serialization Data`. 4. **Avoid using ObjectInputStream**: If possible, avoid deserializing objects altogether. Consider using safer data interchange formats like JSON or XML instead of Java serialization. 5. **Sanitize Input Data**: If deserialization is necessary, sanitize the input data before deserialization to remove any potentially harmful content. 6. **Handle Exceptions Carefully**: Handle exceptions securely by providing minimal information in error messages and log output to avoid leaking sensitive",php,0
SQL Injection,"import psycopg2
def admin_login(admin_id):
    conn = psycopg2.connect(""dbname=test user=postgres"")
    cur = conn.cursor()
    cur.execute(f""SELECT * FROM admins WHERE id = {admin_id}"")
    return cur.fetchone()","import psycopg2
def admin_login(admin_id):
    conn = psycopg2.connect(""dbname=test user=postgres"")
    cur = conn.cursor()
    cur.execute(f""SELECT * FROM admins WHERE id = {admin_id}"")
    return cur.fetchone()",python,1
Clear,"from django.http import HttpResponse
from django.utils.html import escape

def safe_user_profile(request, username):
    safe_username = escape(username)
    return HttpResponse(f""Welcome, {safe_username}!"")","from django.http import HttpResponse
from django.utils.html import escape

def safe_user_profile(request, username):
    safe_username = escape(username)
    return HttpResponse(f""Welcome, {safe_username}!"")",python,0
Clear,"To fix the Command Injection vulnerability in the provided Java code snippet, you should validate and sanitize user input before passing it to the `exec` method of `Runtime` class. Here is an improved version of the code that mitigates the Command Injection vulnerability:

```java
import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class SecureCommandExecution {

    public static void main(String[] args) {
        try {
            BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));
            System.out.print(""Enter a command to execute: "");
            String command = reader.readLine();
            
            // Sanitize user input by only allowing certain commands
            if (isValidCommand(command)) {
                Process process = Runtime.getRuntime().exec(command);
                
                BufferedReader processOutputReader = new BufferedReader(new InputStreamReader(process.getInputStream()));
                String line;
                while ((line = processOutputReader.readLine()) != null) {
                    System.out.println(line);
                }
            } else {
                System.out.println(""Invalid command. Only specific commands are allowed."");
            }
        } catch (IOException e) {
            e.printStackTrace();
        }
    }

    private static boolean isValidCommand(String command) {
        // Implement validation logic here, e.g., allow only specific commands","To fix the Command Injection vulnerability in the provided Java code snippet, you should validate and sanitize user input before passing it to the `exec` method of `Runtime` class. Here is an improved version of the code that mitigates the Command Injection vulnerability: ```java import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class SecureCommandExecution { public static void main(String[] args) { try { BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a command to execute: ""); String command = reader.readLine(); // Sanitize user input by only allowing certain commands if (isValidCommand(command)) { Process process = Runtime.getRuntime().exec(command); BufferedReader processOutputReader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = processOutputReader.readLine()) != null) { System.out.println(line); } } else { System.out.println(""Invalid command. Only specific commands are allowed.""); } } catch (IOException e) { e.printStackTrace(); } } private static boolean isValidCommand(String command) { // Implement validation logic here, e.g., allow only specific commands",java,0
Memory Corruption,"#include <iostream>

void unsafe_virtual_call() {
    // Potential vtable corruption vulnerability
    class Base {
    public:
        virtual void func() { std::cout << ""Base"" << std::endl; }
    };
    
    class Derived : public Base {
    public:
        void func() override { std::cout << ""Derived"" << std::endl; }
    };
}","#include <iostream>

void unsafe_virtual_call() {
    // Potential vtable corruption vulnerability
    class Base {
    public:
        virtual void func() { std::cout << ""Base"" << std::endl; }
    };
    
    class Derived : public Base {
    public:
        void func() override { std::cout << ""Derived"" << std::endl; }
    };
}",cpp,1
Clear,"#include <iostream>
#include <vector>
#include <stdexcept>

int safe_vector_access(const std::vector<int>& vec, size_t index) {
    if (index >= vec.size()) {
        throw std::out_of_range(""Index out of range"");
    }
    return vec[index];
}","#include <iostream>
#include <vector>
#include <stdexcept>

int safe_vector_access(const std::vector<int>& vec, size_t index) {
    if (index >= vec.size()) {
        throw std::out_of_range(""Index out of range"");
    }
    return vec[index];
}",cpp,0
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Clear,"import java.sql.*;

public class SecureSQLQuery {
    public static void main(String[] args) {
        String userInput = ""'; DROP TABLE users; --""; // Malicious input simulating SQL Injection

        try {
            Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");

            // Use a PreparedStatement with parameterized query
            String query = ""SELECT * FROM users WHERE username = ?"";
            PreparedStatement pstmt = conn.prepareStatement(query);
            pstmt.setString(1, userInput);

            ResultSet rs = pstmt.executeQuery();

            while (rs.next()) {
                System.out.println(""User found: "" + rs.getString(""username""));
            }

            rs.close();
            pstmt.close();
            conn.close();
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.*; public class SecureSQLQuery { public static void main(String[] args) { String userInput = ""'; DROP TABLE users; --""; // Malicious input simulating SQL Injection try { Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); // Use a PreparedStatement with parameterized query String query = ""SELECT * FROM users WHERE username = ?""; PreparedStatement pstmt = conn.prepareStatement(query); pstmt.setString(1, userInput); ResultSet rs = pstmt.executeQuery(); while (rs.next()) { System.out.println(""User found: "" + rs.getString(""username"")); } rs.close(); pstmt.close(); conn.close(); } catch (SQLException e) { e.printStackTrace(); } } }",java,0
Clear,"#include <iostream>
#include <sstream>

int safe_string_to_int(const std::string& str) {
    std::stringstream ss(str);
    int value;
    if (ss >> value) {
        return value;
    }
    throw std::invalid_argument(""Invalid integer"");
}","#include <iostream>
#include <sstream>

int safe_string_to_int(const std::string& str) {
    std::stringstream ss(str);
    int value;
    if (ss >> value) {
        return value;
    }
    throw std::invalid_argument(""Invalid integer"");
}",cpp,0
Cross-Site Scripting (XSS),"from flask import Flask, request
app = Flask(__name__)

@app.route('/search')
def search():
    query = request.args.get('q', '')
    return f'<h1>Search results for: {query}</h1>'","from flask import Flask, request
app = Flask(__name__)

@app.route('/search')
def search():
    query = request.args.get('q', '')
    return f'<h1>Search results for: {query}</h1>'",python,1
Clear,import org.owasp.encoder.Encode;,import org.owasp.encoder.Encode;,python,0
SQL Injection,"app.get('/user/:id', (req, res) => {
    const query = `SELECT * FROM users WHERE id = ${req.params.id}`; // SQL Injection
    db.query(query, (err, result) => {
        res.json(result);
    });
});
","app.get('/user/:id', (req, res) => {
    const query = `SELECT * FROM users WHERE id = ${req.params.id}`; // SQL Injection
    db.query(query, (err, result) => {
        res.json(result);
    });
});
",javascript,1
Clear,"#include <stdio.h>
#include <string.h>

int safe_buffer_operation(char *input) {
    char buffer[100];
    if (strlen(input) < sizeof(buffer)) {
        strcpy(buffer, input);
        return 0;
    }
    return -1; // buffer too small
}","#include <stdio.h>
#include <string.h>

int safe_buffer_operation(char *input) {
    char buffer[100];
    if (strlen(input) < sizeof(buffer)) {
        strcpy(buffer, input);
        return 0;
    }
    return -1; // buffer too small
}",c,0
Clear,"<?php
$cmd = escapeshellarg($_GET['cmd']);
system(""ls "" . $cmd); // Escaped command
?>","<?php
$cmd = escapeshellarg($_GET['cmd']);
system(""ls "" . $cmd); // Escaped command
?>",php,0
SQL Injection,"import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Statement;

public class SQLInjectionVulnerableCode {

    public static void main(String[] args) {
        String userInput = ""'; DROP TABLE users; --""; // Malicious user input

        try {
            Connection connection = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");
            Statement statement = connection.createStatement();

            String query = ""SELECT * FROM users WHERE username = '"" + userInput + ""'"";
            ResultSet resultSet = statement.executeQuery(query);

            while (resultSet.next()) {
                System.out.println(""Username: "" + resultSet.getString(""username""));
                System.out.println(""Password: "" + resultSet.getString(""password""));
            }

            connection.close();
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.Connection; import java.sql.DriverManager; import java.sql.ResultSet; import java.sql.SQLException; import java.sql.Statement; public class SQLInjectionVulnerableCode { public static void main(String[] args) { String userInput = ""'; DROP TABLE users; --""; // Malicious user input try { Connection connection = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); Statement statement = connection.createStatement(); String query = ""SELECT * FROM users WHERE username = '"" + userInput + ""'""; ResultSet resultSet = statement.executeQuery(query); while (resultSet.next()) { System.out.println(""Username: "" + resultSet.getString(""username"")); System.out.println(""Password: "" + resultSet.getString(""password"")); } connection.close(); } catch (SQLException e) { e.printStackTrace(); } } }",java,1
Command Injection,"const shell = require('child_process');
shell.exec('ping ' + userInput); // Command Injection
","const shell = require('child_process');
shell.exec('ping ' + userInput); // Command Injection
",javascript,1
Clear,"<?php
$input = json_decode($_POST['data'], true); // Safe JSON parsing
if (json_last_error() === JSON_ERROR_NONE) {
    process_data($input);
}
?>","<?php
$input = json_decode($_POST['data'], true); // Safe JSON parsing
if (json_last_error() === JSON_ERROR_NONE) {
    process_data($input);
}
?>",php,0
Clear,"const userData = JSON.parse(userInput); // Safe JSON parsing
if (userData && typeof userData === 'object') {
    processUserData(userData);
}
","const userData = JSON.parse(userInput); // Safe JSON parsing
if (userData && typeof userData === 'object') {
    processUserData(userData);
}
",javascript,0
Memory Corruption,"#include <iostream>

void unsafe_virtual_call() {
    // Potential vtable corruption vulnerability
    class Base {
    public:
        virtual void func() { std::cout << ""Base"" << std::endl; }
    };
    
    class Derived : public Base {
    public:
        void func() override { std::cout << ""Derived"" << std::endl; }
    };
}","#include <iostream>

void unsafe_virtual_call() {
    // Potential vtable corruption vulnerability
    class Base {
    public:
        virtual void func() { std::cout << ""Base"" << std::endl; }
    };
    
    class Derived : public Base {
    public:
        void func() override { std::cout << ""Derived"" << std::endl; }
    };
}",cpp,1
Clear,"import sqlite3
def get_user_data_safe(username):
    conn = sqlite3.connect('database.db')
    cursor = conn.cursor()
    query = ""SELECT * FROM users WHERE username = ?""
    cursor.execute(query, (username,))
    return cursor.fetchall()","import sqlite3
def get_user_data_safe(username):
    conn = sqlite3.connect('database.db')
    cursor = conn.cursor()
    query = ""SELECT * FROM users WHERE username = ?""
    cursor.execute(query, (username,))
    return cursor.fetchall()",python,0
Clear,"#include <iostream>
#include <memory>

void safe_memory_management() {
    auto ptr = std::make_unique<int>(42);
    std::cout << *ptr << std::endl;
}","#include <iostream>
#include <memory>

void safe_memory_management() {
    auto ptr = std::make_unique<int>(42);
    std::cout << *ptr << std::endl;
}",cpp,0
Clear,"<?php
$input = json_decode($_POST['data'], true); // Safe JSON parsing
if (json_last_error() === JSON_ERROR_NONE) {
    process_data($input);
}
?>","<?php
$input = json_decode($_POST['data'], true); // Safe JSON parsing
if (json_last_error() === JSON_ERROR_NONE) {
    process_data($input);
}
?>",php,0
Clear,"#include <stdio.h>
#include <string.h>

int safe_buffer_operation(char *input) {
    char buffer[100];
    if (strlen(input) < sizeof(buffer)) {
        strcpy(buffer, input);
        return 0;
    }
    return -1; // buffer too small
}","#include <stdio.h>
#include <string.h>

int safe_buffer_operation(char *input) {
    char buffer[100];
    if (strlen(input) < sizeof(buffer)) {
        strcpy(buffer, input);
        return 0;
    }
    return -1; // buffer too small
}",c,0
Path Traversal,"import java.io.File;
import java.io.FileInputStream;
import java.io.IOException;

public class PathTraversalVulnerability {

    public static void main(String[] args) {
        String fileName = args[0]; // User input - should be sanitized

        try {
            File file = new File(""/path/to/files/"" + fileName);
            FileInputStream fis = new FileInputStream(file);

            int content;
            while ((content = fis.read()) != -1) {
                System.out.print((char) content);
            }

            fis.close();
        } catch (IOException e) {
            System.out.println(""Error reading file: "" + e.getMessage());
        }
    }
}","import java.io.File; import java.io.FileInputStream; import java.io.IOException; public class PathTraversalVulnerability { public static void main(String[] args) { String fileName = args[0]; // User input - should be sanitized try { File file = new File(""/path/to/files/"" + fileName); FileInputStream fis = new FileInputStream(file); int content; while ((content = fis.read()) != -1) { System.out.print((char) content); } fis.close(); } catch (IOException e) { System.out.println(""Error reading file: "" + e.getMessage()); } } }",java,1
Clear,"const userInput = new URLSearchParams(window.location.search).get('input');
const safeOutput = document.createElement('div');
safeOutput.textContent = userInput; // Safe DOM manipulation
document.body.appendChild(safeOutput);
","const userInput = new URLSearchParams(window.location.search).get('input');
const safeOutput = document.createElement('div');
safeOutput.textContent = userInput; // Safe DOM manipulation
document.body.appendChild(safeOutput);
",javascript,0
Clear,"import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class CommandInjectionSecure {
    public static void main(String[] args) {
        try {
            // Simulating user input being passed to a command execution
            System.out.print(""Enter the IP address to ping: "");
            BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));
            String ipAddress = reader.readLine();

            // Secure code using ProcessBuilder to execute the command with arguments
            ProcessBuilder processBuilder = new ProcessBuilder(""ping"", ""-c"", ""4"", ipAddress);
            Process process = processBuilder.start();

            BufferedReader resultReader = new BufferedReader(new InputStreamReader(process.getInputStream()));
            String line;
            while ((line = resultReader.readLine()) != null) {
                System.out.println(line);
            }
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}","import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class CommandInjectionSecure { public static void main(String[] args) { try { // Simulating user input being passed to a command execution System.out.print(""Enter the IP address to ping: ""); BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); String ipAddress = reader.readLine(); // Secure code using ProcessBuilder to execute the command with arguments ProcessBuilder processBuilder = new ProcessBuilder(""ping"", ""-c"", ""4"", ipAddress); Process process = processBuilder.start(); BufferedReader resultReader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = resultReader.readLine()) != null) { System.out.println(line); } } catch (IOException e) { e.printStackTrace(); } } }",java,0
Memory Corruption,"#include <iostream>

void unsafe_virtual_call() {
    // Potential vtable corruption vulnerability
    class Base {
    public:
        virtual void func() { std::cout << ""Base"" << std::endl; }
    };
    
    class Derived : public Base {
    public:
        void func() override { std::cout << ""Derived"" << std::endl; }
    };
}","#include <iostream>

void unsafe_virtual_call() {
    // Potential vtable corruption vulnerability
    class Base {
    public:
        virtual void func() { std::cout << ""Base"" << std::endl; }
    };
    
    class Derived : public Base {
    public:
        void func() override { std::cout << ""Derived"" << std::endl; }
    };
}",cpp,1
XSS,"const userInput = document.location.search.split('=')[1];
document.write(userInput); // XSS
","const userInput = document.location.search.split('=')[1];
document.write(userInput); // XSS
",javascript,1
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Memory Corruption,"#include <iostream>

void unsafe_pointer_arithmetic(int* array, int size) {
    for (int i = 0; i <= size; i++) {
        std::cout << *(array + i) << std::endl; // potential out-of-bounds
    }
}","#include <iostream>

void unsafe_pointer_arithmetic(int* array, int size) {
    for (int i = 0; i <= size; i++) {
        std::cout << *(array + i) << std::endl; // potential out-of-bounds
    }
}",cpp,1
Memory Corruption,"#include <iostream>

void unsafe_pointer_arithmetic(int* array, int size) {
    for (int i = 0; i <= size; i++) {
        std::cout << *(array + i) << std::endl; // potential out-of-bounds
    }
}","#include <iostream>

void unsafe_pointer_arithmetic(int* array, int size) {
    for (int i = 0; i <= size; i++) {
        std::cout << *(array + i) << std::endl; // potential out-of-bounds
    }
}",cpp,1
Path Traversal,"import java.io.File;
import java.io.FileInputStream;
import java.io.IOException;

public class FileReadExample {
    public static void main(String[] args) {
        String fileName = args[0]; // User input for file name
        File file = new File(fileName);

        try (FileInputStream fis = new FileInputStream(file)) {
            int content;
            while ((content = fis.read()) != -1) {
                System.out.print((char) content);
            }
        } catch (IOException e) {
            System.out.println(""Error reading file: "" + e.getMessage());
        }
    }
}","import java.io.File; import java.io.FileInputStream; import java.io.IOException; public class FileReadExample { public static void main(String[] args) { String fileName = args[0]; // User input for file name File file = new File(fileName); try (FileInputStream fis = new FileInputStream(file)) { int content; while ((content = fis.read()) != -1) { System.out.print((char) content); } } catch (IOException e) { System.out.println(""Error reading file: "" + e.getMessage()); } } }",java,1
Clear,"To fix the Path Traversal vulnerability in the given Java code snippet, you need to ensure that the user input is sanitized and restricted to prevent accessing files outside the intended directory. Here's an improved version of the code with proper security measures:

```java
import java.io.File;
import java.io.IOException;
import java.nio.file.Files;
import java.nio.file.Path;
import java.nio.file.Paths;

public class SecurePathTraversalExample {

    private static final String BASE_DIRECTORY = ""/var/www/uploads/"";

    public static void main(String[] args) {
        String userInput = ""../../../../../etc/passwd"";
        
        // Sanitize user input to prevent path traversal
        String sanitizedInput = userInput.replaceAll(""\\.\\."", """");

        String filePath = Paths.get(BASE_DIRECTORY, sanitizedInput).normalize().toString();

        if (!filePath.startsWith(BASE_DIRECTORY)) {
            System.out.println(""Invalid file path."");
            return;
        }

        try {
            File file = new File(filePath);
            if (file.exists()) {
                byte[] fileData = Files.readAllBytes(Path.of(filePath));
                System.out.println(new String(fileData));
            } else {
                System.out.println(""File not found."");
            }
        } catch (IOException e) {
            e.printStackTrace();","To fix the Path Traversal vulnerability in the given Java code snippet, you need to ensure that the user input is sanitized and restricted to prevent accessing files outside the intended directory. Here's an improved version of the code with proper security measures: ```java import java.io.File; import java.io.IOException; import java.nio.file.Files; import java.nio.file.Path; import java.nio.file.Paths; public class SecurePathTraversalExample { private static final String BASE_DIRECTORY = ""/var/www/uploads/""; public static void main(String[] args) { String userInput = ""../../../../../etc/passwd""; // Sanitize user input to prevent path traversal String sanitizedInput = userInput.replaceAll(""\\.\\."", """"); String filePath = Paths.get(BASE_DIRECTORY, sanitizedInput).normalize().toString(); if (!filePath.startsWith(BASE_DIRECTORY)) { System.out.println(""Invalid file path.""); return; } try { File file = new File(filePath); if (file.exists()) { byte[] fileData = Files.readAllBytes(Path.of(filePath)); System.out.println(new String(fileData)); } else { System.out.println(""File not found.""); } } catch (IOException e) { e.printStackTrace();",java,0
Clear,"#include <stdio.h>
#include <string.h>

void safe_string_copy(char *dest, const char *src, size_t dest_size) {
    if (dest_size > 0) {
        strncpy(dest, src, dest_size - 1);
        dest[dest_size - 1] = '\0';
    }
}","#include <stdio.h>
#include <string.h>

void safe_string_copy(char *dest, const char *src, size_t dest_size) {
    if (dest_size > 0) {
        strncpy(dest, src, dest_size - 1);
        dest[dest_size - 1] = '\0';
    }
}",c,0
Clear,"To fix the command injection vulnerability in the provided Java code, you should sanitize and validate the user input before constructing and executing the command. One way to achieve this is by using `ProcessBuilder` instead of directly invoking `Runtime.exec()`. 

Here's an updated version of the code with proper security measures:

```java
import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;
import java.util.regex.Pattern;

public class SecureCommandExecution {

    public static void main(String[] args) {
        try {
            BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));
            System.out.print(""Enter the IP address to ping: "");
            String ip = reader.readLine();

            // Validate input to prevent command injection
            if (!isValidIpAddress(ip)) {
                System.out.println(""Invalid IP address. Please try again."");
                return;
            }

            // Construct and execute secure command using ProcessBuilder
            ProcessBuilder pb = new ProcessBuilder(""ping"", ip);
            Process process = pb.start();

            BufferedReader inputReader = new BufferedReader(new InputStreamReader(process.getInputStream()));
            String line;
            while ((line = inputReader.readLine()) != null) {
                System.out.println(line);
            }
        } catch (IOException e) {
            e.printStackTrace","To fix the command injection vulnerability in the provided Java code, you should sanitize and validate the user input before constructing and executing the command. One way to achieve this is by using `ProcessBuilder` instead of directly invoking `Runtime.exec()`. Here's an updated version of the code with proper security measures: ```java import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; import java.util.regex.Pattern; public class SecureCommandExecution { public static void main(String[] args) { try { BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter the IP address to ping: ""); String ip = reader.readLine(); // Validate input to prevent command injection if (!isValidIpAddress(ip)) { System.out.println(""Invalid IP address. Please try again.""); return; } // Construct and execute secure command using ProcessBuilder ProcessBuilder pb = new ProcessBuilder(""ping"", ip); Process process = pb.start(); BufferedReader inputReader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = inputReader.readLine()) != null) { System.out.println(line); } } catch (IOException e) { e.printStackTrace",java,0
Clear,"#include <iostream>
#include <fstream>
#include <string>

void safe_file_reading(const std::string& filename) {
    std::ifstream file(filename);
    if (file.is_open()) {
        std::string line;
        while (std::getline(file, line)) {
            std::cout << line << std::endl;
        }
    }
}","#include <iostream>
#include <fstream>
#include <string>

void safe_file_reading(const std::string& filename) {
    std::ifstream file(filename);
    if (file.is_open()) {
        std::string line;
        while (std::getline(file, line)) {
            std::cout << line << std::endl;
        }
    }
}",cpp,0
Command Injection,"import os
def ping_host(host):
    os.system(""ping -c 4 "" + host)","import os
def ping_host(host):
    os.system(""ping -c 4 "" + host)",python,1
XSS,"const userInput = document.location.search.split('=')[1];
document.write(userInput); // XSS
","const userInput = document.location.search.split('=')[1];
document.write(userInput); // XSS
",javascript,1
Cross-Site Scripting (XSS),"import java.io.IOException;
import java.io.PrintWriter;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

public class XSSVulnerableServlet extends HttpServlet {

    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws IOException {
        String userInput = request.getParameter(""input"");
        
        // Improperly handling user input by directly outputting it to the response
        PrintWriter out = response.getWriter();
        out.println(""<html>"");
        out.println(""<body>"");
        out.println(""<h1>User Input: "" + userInput + ""</h1>"");
        out.println(""</body>"");
        out.println(""</html>"");
    }
}","import java.io.IOException; import java.io.PrintWriter; import javax.servlet.http.HttpServlet; import javax.servlet.http.HttpServletRequest; import javax.servlet.http.HttpServletResponse; public class XSSVulnerableServlet extends HttpServlet { protected void doGet(HttpServletRequest request, HttpServletResponse response) throws IOException { String userInput = request.getParameter(""input""); // Improperly handling user input by directly outputting it to the response PrintWriter out = response.getWriter(); out.println(""<html>""); out.println(""<body>""); out.println(""<h1>User Input: "" + userInput + ""</h1>""); out.println(""</body>""); out.println(""</html>""); } }",java,1
Clear,"import subprocess
def safe_database_backup(db_name):
    result = subprocess.run(['pg_dump', db_name], capture_output=True, text=True)
    with open('backup.sql', 'w') as f:
        f.write(result.stdout)","import subprocess
def safe_database_backup(db_name):
    result = subprocess.run(['pg_dump', db_name], capture_output=True, text=True)
    with open('backup.sql', 'w') as f:
        f.write(result.stdout)",python,0
Clear,"const shell = require('child_process');
const safeInput = userInput.replace(/[^a-zA-Z0-9.]/g, '');
shell.execFile('ping', [safeInput]); // Safe command execution
","const shell = require('child_process');
const safeInput = userInput.replace(/[^a-zA-Z0-9.]/g, '');
shell.execFile('ping', [safeInput]); // Safe command execution
",javascript,0
SSRF,"import requests
def fetch_url(url):
    return requests.get(url).text","import requests
def fetch_url(url):
    return requests.get(url).text",python,1
SQL Injection,"app.get('/user/:id', (req, res) => {
    const query = `SELECT * FROM users WHERE id = ${req.params.id}`; // SQL Injection
    db.query(query, (err, result) => {
        res.json(result);
    });
});
","app.get('/user/:id', (req, res) => {
    const query = `SELECT * FROM users WHERE id = ${req.params.id}`; // SQL Injection
    db.query(query, (err, result) => {
        res.json(result);
    });
});
",javascript,1
Clear,"#include <iostream>
#include <vector>
#include <stdexcept>

int safe_vector_access(const std::vector<int>& vec, size_t index) {
    if (index >= vec.size()) {
        throw std::out_of_range(""Index out of range"");
    }
    return vec[index];
}","#include <iostream>
#include <vector>
#include <stdexcept>

int safe_vector_access(const std::vector<int>& vec, size_t index) {
    if (index >= vec.size()) {
        throw std::out_of_range(""Index out of range"");
    }
    return vec[index];
}",cpp,0
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Clear,"#include <stdio.h>
#include <stdlib.h>

int safe_string_to_int(const char *str) {
    char *endptr;
    long value = strtol(str, &endptr, 10);
    if (*endptr != '\0' || str == endptr) {
        return -1; // error
    }
    return (int)value;
}","#include <stdio.h>
#include <stdlib.h>

int safe_string_to_int(const char *str) {
    char *endptr;
    long value = strtol(str, &endptr, 10);
    if (*endptr != '\0' || str == endptr) {
        return -1; // error
    }
    return (int)value;
}",c,0
Insecure Deserialization,"<?php
$data = $_POST['data'];
unserialize($data); // Insecure Deserialization
?>","<?php
$data = $_POST['data'];
unserialize($data); // Insecure Deserialization
?>",php,1
SQL Injection,"import java.sql.*;

public class SQLInjectionExample {

    public static void main(String[] args) {
        String userInput = ""'; DROP TABLE users; --""; // Malicious input

        try {
            Connection connection = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");
            Statement statement = connection.createStatement();

            String query = ""SELECT * FROM users WHERE username = '"" + userInput + ""'"";
            ResultSet resultSet = statement.executeQuery(query);

            while (resultSet.next()) {
                System.out.println(resultSet.getString(""username""));
            }

            connection.close();
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.*; public class SQLInjectionExample { public static void main(String[] args) { String userInput = ""'; DROP TABLE users; --""; // Malicious input try { Connection connection = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); Statement statement = connection.createStatement(); String query = ""SELECT * FROM users WHERE username = '"" + userInput + ""'""; ResultSet resultSet = statement.executeQuery(query); while (resultSet.next()) { System.out.println(resultSet.getString(""username"")); } connection.close(); } catch (SQLException e) { e.printStackTrace(); } } }",java,1
Clear,"#include <iostream>
#include <vector>
#include <stdexcept>

int safe_vector_access(const std::vector<int>& vec, size_t index) {
    if (index >= vec.size()) {
        throw std::out_of_range(""Index out of range"");
    }
    return vec[index];
}","#include <iostream>
#include <vector>
#include <stdexcept>

int safe_vector_access(const std::vector<int>& vec, size_t index) {
    if (index >= vec.size()) {
        throw std::out_of_range(""Index out of range"");
    }
    return vec[index];
}",cpp,0
Out-of-Bounds,"#include <iostream>

class UnsafeClass {
    int data[10];
public:
    int get_data(int index) {
        return data[index]; // no bounds checking
    }
};","#include <iostream>

class UnsafeClass {
    int data[10];
public:
    int get_data(int index) {
        return data[index]; // no bounds checking
    }
};",cpp,1
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Clear,"#include <stdio.h>
#include <string.h>

void safe_string_copy(char *dest, const char *src, size_t dest_size) {
    if (dest_size > 0) {
        strncpy(dest, src, dest_size - 1);
        dest[dest_size - 1] = '\0';
    }
}","#include <stdio.h>
#include <string.h>

void safe_string_copy(char *dest, const char *src, size_t dest_size) {
    if (dest_size > 0) {
        strncpy(dest, src, dest_size - 1);
        dest[dest_size - 1] = '\0';
    }
}",c,0
SQL Injection,"<?php
$username = $_POST['username'];
$query = ""SELECT * FROM users WHERE username = '$username'"";
$result = mysql_query($query); // SQL Injection
?>","<?php
$username = $_POST['username'];
$query = ""SELECT * FROM users WHERE username = '$username'"";
$result = mysql_query($query); // SQL Injection
?>",php,1
SQL Injection,"<?php
$username = $_POST['username'];
$query = ""SELECT * FROM users WHERE username = '$username'"";
$result = mysql_query($query); // SQL Injection
?>","<?php
$username = $_POST['username'];
$query = ""SELECT * FROM users WHERE username = '$username'"";
$result = mysql_query($query); // SQL Injection
?>",php,1
Clear,"app.get('/user/:id', (req, res) => {
    const userId = parseInt(req.params.id);
    db.query('SELECT * FROM users WHERE id = ?', [userId], (err, result) => {
        res.json(result);
    });
});
","app.get('/user/:id', (req, res) => {
    const userId = parseInt(req.params.id);
    db.query('SELECT * FROM users WHERE id = ?', [userId], (err, result) => {
        res.json(result);
    });
});
",javascript,0
Clear,"import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.ResultSet;

public class SQLInjectionSecureExample {

    public static void main(String[] args) {
        String userInput = ""'; DROP TABLE users; --""; // This is the user input that will NOT cause SQL Injection
        
        try {
            Connection connection = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""root"", ""password"");
            
            String query = ""SELECT * FROM users WHERE username = ?"";
            PreparedStatement statement = connection.prepareStatement(query);
            statement.setString(1, userInput);
            
            ResultSet resultSet = statement.executeQuery();
            
            while(resultSet.next()) {
                System.out.println(""Username: "" + resultSet.getString(""username""));
            }
            
            connection.close();
        } catch (Exception e) {
            e.printStackTrace();
        }
    }
}","import java.sql.Connection; import java.sql.DriverManager; import java.sql.PreparedStatement; import java.sql.ResultSet; public class SQLInjectionSecureExample { public static void main(String[] args) { String userInput = ""'; DROP TABLE users; --""; // This is the user input that will NOT cause SQL Injection try { Connection connection = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""root"", ""password""); String query = ""SELECT * FROM users WHERE username = ?""; PreparedStatement statement = connection.prepareStatement(query); statement.setString(1, userInput); ResultSet resultSet = statement.executeQuery(); while(resultSet.next()) { System.out.println(""Username: "" + resultSet.getString(""username"")); } connection.close(); } catch (Exception e) { e.printStackTrace(); } } }",java,0
Clear,"To fix the Path Traversal vulnerability in the provided Java code snippet, you can implement security measures to prevent malicious input that can lead to directory traversal attacks. Here is an improved version of the code with added security checks:

```java
import java.io.File;
import java.io.IOException;
import java.nio.file.Files;
import java.util.Scanner;

public class SafePathTraversalExample {

    private static final String BASE_PATH = ""/path/to/directory/"";

    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        System.out.print(""Enter the file name: "");
        String fileName = scanner.next();

        if (!isValidFileName(fileName)) {
            System.out.println(""Invalid file name"");
            return;
        }

        File file = new File(BASE_PATH + fileName);

        if (file.exists() && file.isFile() && file.canRead() && file.getAbsolutePath().startsWith(BASE_PATH)) {
            try {
                byte[] fileContents = Files.readAllBytes(file.toPath());
                System.out.println(new String(fileContents));
            } catch (IOException e) {
                System.out.println(""Error reading file"");
            }
        } else {
            System.out.println(""File not found or access denied"");
        }

        scanner.close();","To fix the Path Traversal vulnerability in the provided Java code snippet, you can implement security measures to prevent malicious input that can lead to directory traversal attacks. Here is an improved version of the code with added security checks: ```java import java.io.File; import java.io.IOException; import java.nio.file.Files; import java.util.Scanner; public class SafePathTraversalExample { private static final String BASE_PATH = ""/path/to/directory/""; public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter the file name: ""); String fileName = scanner.next(); if (!isValidFileName(fileName)) { System.out.println(""Invalid file name""); return; } File file = new File(BASE_PATH + fileName); if (file.exists() && file.isFile() && file.canRead() && file.getAbsolutePath().startsWith(BASE_PATH)) { try { byte[] fileContents = Files.readAllBytes(file.toPath()); System.out.println(new String(fileContents)); } catch (IOException e) { System.out.println(""Error reading file""); } } else { System.out.println(""File not found or access denied""); } scanner.close();",java,0
Clear,"import subprocess
def safe_directory_listing(path):
    result = subprocess.run(['ls', path], capture_output=True, text=True)
    return result.stdout","import subprocess
def safe_directory_listing(path):
    result = subprocess.run(['ls', path], capture_output=True, text=True)
    return result.stdout",python,0
Memory Corruption,"#include <iostream>

void unsafe_pointer_arithmetic(int* array, int size) {
    for (int i = 0; i <= size; i++) {
        std::cout << *(array + i) << std::endl; // potential out-of-bounds
    }
}","#include <iostream>

void unsafe_pointer_arithmetic(int* array, int size) {
    for (int i = 0; i <= size; i++) {
        std::cout << *(array + i) << std::endl; // potential out-of-bounds
    }
}",cpp,1
Clear,"import org.owasp.esapi.ESAPI;
import org.owasp.esapi.errors.EncodingException;

import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class XSSSecureCode {
    public static void main(String[] args) {
        BufferedReader br = new BufferedReader(new InputStreamReader(System.in));

        try {
            System.out.print(""Enter your name: "");
            String userInput = br.readLine();

            // Properly handle user input by encoding special characters
            String sanitizedInput = ESAPI.encoder().encodeForHTML(userInput);
            
            System.out.println(""Hello, "" + sanitizedInput + ""! Welcome to our website."");
        } catch (IOException e) {
            e.printStackTrace();
        } catch (EncodingException e) {
            e.printStackTrace();
        }
    }
}","import org.owasp.esapi.ESAPI; import org.owasp.esapi.errors.EncodingException; import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class XSSSecureCode { public static void main(String[] args) { BufferedReader br = new BufferedReader(new InputStreamReader(System.in)); try { System.out.print(""Enter your name: ""); String userInput = br.readLine(); // Properly handle user input by encoding special characters String sanitizedInput = ESAPI.encoder().encodeForHTML(userInput); System.out.println(""Hello, "" + sanitizedInput + ""! Welcome to our website.""); } catch (IOException e) { e.printStackTrace(); } catch (EncodingException e) { e.printStackTrace(); } } }",java,0
Buffer Overflow,"#include <iostream>
#include <cstring>

void unsafe_c_string(char* input) {
    char buffer[100];
    strcpy(buffer, input); // potential buffer overflow
    std::cout << buffer << std::endl;
}","#include <iostream>
#include <cstring>

void unsafe_c_string(char* input) {
    char buffer[100];
    strcpy(buffer, input); // potential buffer overflow
    std::cout << buffer << std::endl;
}",cpp,1
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Clear,"const token = process.env.API_TOKEN; // Environment variable
fetch('/api/data', {
    headers: { 'Authorization': `Bearer ${token}` }
});
","const token = process.env.API_TOKEN; // Environment variable
fetch('/api/data', {
    headers: { 'Authorization': `Bearer ${token}` }
});
",javascript,0
Clear,"To fix the Path Traversal vulnerability in the given Java code snippet, you can implement proper security measures. Here's an improved version of the code with security enhancements:

```java
import java.io.File;
import java.io.IOException;
import java.nio.file.Files;
import java.nio.file.Path;
import java.nio.file.Paths;

public class FileHandler {

    private static final String DATA_DIRECTORY = ""data/"";

    public void readFromFile(String fileName) {
        try {
            Path filePath = Paths.get(DATA_DIRECTORY, fileName).normalize();
            if (!filePath.startsWith(Paths.get(DATA_DIRECTORY))) {
                System.out.println(""Invalid file path"");
                return;
            }

            byte[] data = Files.readAllBytes(filePath);
            String content = new String(data);
            System.out.println(content);
        } catch (IOException e) {
            System.out.println(""Error reading file: "" + e.getMessage());
        }
    }

    public static void main(String[] args) {
        if (args.length == 0) {
            System.out.println(""Please provide a file name as input."");
            return;
        }
        
        String userInput = args[0];
        
        FileHandler fileHandler = new FileHandler();
        fileHandler.readFromFile(userInput);
    }","To fix the Path Traversal vulnerability in the given Java code snippet, you can implement proper security measures. Here's an improved version of the code with security enhancements: ```java import java.io.File; import java.io.IOException; import java.nio.file.Files; import java.nio.file.Path; import java.nio.file.Paths; public class FileHandler { private static final String DATA_DIRECTORY = ""data/""; public void readFromFile(String fileName) { try { Path filePath = Paths.get(DATA_DIRECTORY, fileName).normalize(); if (!filePath.startsWith(Paths.get(DATA_DIRECTORY))) { System.out.println(""Invalid file path""); return; } byte[] data = Files.readAllBytes(filePath); String content = new String(data); System.out.println(content); } catch (IOException e) { System.out.println(""Error reading file: "" + e.getMessage()); } } public static void main(String[] args) { if (args.length == 0) { System.out.println(""Please provide a file name as input.""); return; } String userInput = args[0]; FileHandler fileHandler = new FileHandler(); fileHandler.readFromFile(userInput); }",java,0
Clear,"<?php
$message = htmlspecialchars($_GET['message'], ENT_QUOTES, 'UTF-8');
echo $message; // Sanitized output
?>","<?php
$message = htmlspecialchars($_GET['message'], ENT_QUOTES, 'UTF-8');
echo $message; // Sanitized output
?>",php,0
Memory Corruption,"#include <iostream>

void unsafe_pointer_arithmetic(int* array, int size) {
    for (int i = 0; i <= size; i++) {
        std::cout << *(array + i) << std::endl; // potential out-of-bounds
    }
}","#include <iostream>

void unsafe_pointer_arithmetic(int* array, int size) {
    for (int i = 0; i <= size; i++) {
        std::cout << *(array + i) << std::endl; // potential out-of-bounds
    }
}",cpp,1
File Inclusion,"<?php
$file = $_GET['file'];
include($file); // File Inclusion
?>","<?php
$file = $_GET['file'];
include($file); // File Inclusion
?>",php,1
Cross-Site Scripting (XSS),"def display_comment(comment_text):
    return f""<div class='comment'>{comment_text}</div>"" ","def display_comment(comment_text):
    return f""<div class='comment'>{comment_text}</div>"" ",python,1
Clear,"def safe_comment_display(comment_text):
    import html
    escaped_text = html.escape(comment_text)
    return f""<div class='comment'>{escaped_text}</div>"" ","def safe_comment_display(comment_text):
    import html
    escaped_text = html.escape(comment_text)
    return f""<div class='comment'>{escaped_text}</div>"" ",python,0
Clear,"import jwt
import os
from datetime import datetime, timedelta

def create_safe_token(user_id):
    payload = {
        'user_id': user_id,
        'exp': datetime.utcnow() + timedelta(hours=1)
    }
    secret = os.environ.get('JWT_SECRET')
    return jwt.encode(payload, secret, algorithm='HS256')","import jwt
import os
from datetime import datetime, timedelta

def create_safe_token(user_id):
    payload = {
        'user_id': user_id,
        'exp': datetime.utcnow() + timedelta(hours=1)
    }
    secret = os.environ.get('JWT_SECRET')
    return jwt.encode(payload, secret, algorithm='HS256')",python,0
Buffer Overflow,"#include <iostream>
#include <cstdio>

void unsafe_c_input() {
    char buffer[50];
    scanf(""%s"", buffer); // no length limit
    std::cout << buffer << std::endl;
}","#include <iostream>
#include <cstdio>

void unsafe_c_input() {
    char buffer[50];
    scanf(""%s"", buffer); // no length limit
    std::cout << buffer << std::endl;
}",cpp,1
Clear,"#include <iostream>
#include <string>
#include <vector>

void safe_string_handling(const std::string& input) {
    std::string safe_copy = input;
    std::cout << safe_copy << std::endl;
}","#include <iostream>
#include <string>
#include <vector>

void safe_string_handling(const std::string& input) {
    std::string safe_copy = input;
    std::cout << safe_copy << std::endl;
}",cpp,0
Clear,"To fix the Path Traversal vulnerability in the given Java code snippet, you need to ensure that the user input for the file path is properly sanitized and validated before using it to create a File object. Here's an example of how you can implement proper security measures to prevent Path Traversal attacks:

```java
import java.io.File;
import java.io.FileInputStream;
import java.io.IOException;
import java.nio.file.Paths;

public class SecurePathTraversal {

    public static void main(String[] args) {
        if (args.length < 1) {
            System.out.println(""Please provide a file path as an argument."");
            return;
        }

        String userFile = args[0]; // User input containing file path

        // Validate and sanitize the user input
        if (!isValidFilePath(userFile)) {
            System.out.println(""Invalid file path provided."");
            return;
        }

        try {
            File file = new File(""/path/to/files/"" + userFile); // Fixed code with secure file path concatenation
            FileInputStream fis = new FileInputStream(file);

            int data;
            while ((data = fis.read()) != -1) {
                System.out.print((char) data);
            }

            fis.close();
        } catch (IOException","To fix the Path Traversal vulnerability in the given Java code snippet, you need to ensure that the user input for the file path is properly sanitized and validated before using it to create a File object. Here's an example of how you can implement proper security measures to prevent Path Traversal attacks: ```java import java.io.File; import java.io.FileInputStream; import java.io.IOException; import java.nio.file.Paths; public class SecurePathTraversal { public static void main(String[] args) { if (args.length < 1) { System.out.println(""Please provide a file path as an argument.""); return; } String userFile = args[0]; // User input containing file path // Validate and sanitize the user input if (!isValidFilePath(userFile)) { System.out.println(""Invalid file path provided.""); return; } try { File file = new File(""/path/to/files/"" + userFile); // Fixed code with secure file path concatenation FileInputStream fis = new FileInputStream(file); int data; while ((data = fis.read()) != -1) { System.out.print((char) data); } fis.close(); } catch (IOException",java,0
Clear,"import requests
def safe_fetch_url(url):
    allowed_domains = ['example.com', 'api.trusted.com']
    from urllib.parse import urlparse
    domain = urlparse(url).netloc
    if domain not in allowed_domains:
        raise ValueError(""Domain not allowed"")
    return requests.get(url).text","import requests
def safe_fetch_url(url):
    allowed_domains = ['example.com', 'api.trusted.com']
    from urllib.parse import urlparse
    domain = urlparse(url).netloc
    if domain not in allowed_domains:
        raise ValueError(""Domain not allowed"")
    return requests.get(url).text",python,0
Clear,"#include <stdio.h>
#include <string.h>

int safe_buffer_operation(char *input) {
    char buffer[100];
    if (strlen(input) < sizeof(buffer)) {
        strcpy(buffer, input);
        return 0;
    }
    return -1; // buffer too small
}","#include <stdio.h>
#include <string.h>

int safe_buffer_operation(char *input) {
    char buffer[100];
    if (strlen(input) < sizeof(buffer)) {
        strcpy(buffer, input);
        return 0;
    }
    return -1; // buffer too small
}",c,0
Path Traversal,"import java.io.File;
import java.io.FileInputStream;
import java.io.IOException;
import java.util.Scanner;

public class PathTraversalVulnerability {

    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        System.out.println(""Enter a file name to read:"");
        String fileName = scanner.nextLine();

        try {
            File file = new File(""C:\\Users\\Public\\"" + fileName);
            FileInputStream fis = new FileInputStream(file);

            int data;
            while ((data = fis.read()) != -1) {
                System.out.print((char) data);
            }

            fis.close();
        } catch (IOException e) {
            System.out.println(""Error reading file: "" + e.getMessage());
        }
    }
}","import java.io.File; import java.io.FileInputStream; import java.io.IOException; import java.util.Scanner; public class PathTraversalVulnerability { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.println(""Enter a file name to read:""); String fileName = scanner.nextLine(); try { File file = new File(""C:\\Users\\Public\\"" + fileName); FileInputStream fis = new FileInputStream(file); int data; while ((data = fis.read()) != -1) { System.out.print((char) data); } fis.close(); } catch (IOException e) { System.out.println(""Error reading file: "" + e.getMessage()); } } }",java,1
Clear,"import logging
def safe_log_user_action(user_id, action):
    logging.info(f""User {user_id} performed action: {action}"")","import logging
def safe_log_user_action(user_id, action):
    logging.info(f""User {user_id} performed action: {action}"")",python,0
Clear,"#include <stdio.h>
#include <string.h>

void safe_string_copy(char *dest, const char *src, size_t dest_size) {
    if (dest_size > 0) {
        strncpy(dest, src, dest_size - 1);
        dest[dest_size - 1] = '\0';
    }
}","#include <stdio.h>
#include <string.h>

void safe_string_copy(char *dest, const char *src, size_t dest_size) {
    if (dest_size > 0) {
        strncpy(dest, src, dest_size - 1);
        dest[dest_size - 1] = '\0';
    }
}",c,0
Command Injection,"const shell = require('child_process');
shell.exec('ping ' + userInput); // Command Injection
","const shell = require('child_process');
shell.exec('ping ' + userInput); // Command Injection
",javascript,1
Buffer Overflow,"#include <iostream>
#include <cstring>

void unsafe_c_string(char* input) {
    char buffer[100];
    strcpy(buffer, input); // potential buffer overflow
    std::cout << buffer << std::endl;
}","#include <iostream>
#include <cstring>

void unsafe_c_string(char* input) {
    char buffer[100];
    strcpy(buffer, input); // potential buffer overflow
    std::cout << buffer << std::endl;
}",cpp,1
Clear,"const userInput = new URLSearchParams(window.location.search).get('input');
const safeOutput = document.createElement('div');
safeOutput.textContent = userInput; // Safe DOM manipulation
document.body.appendChild(safeOutput);
","const userInput = new URLSearchParams(window.location.search).get('input');
const safeOutput = document.createElement('div');
safeOutput.textContent = userInput; // Safe DOM manipulation
document.body.appendChild(safeOutput);
",javascript,0
Cross-Site Scripting (XSS),"import java.io.*;

public class XSSVulnerability {
    public static void main(String[] args) {
        BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));
        
        System.out.print(""Enter your name: "");
        String userInput = """";
        
        try {
            userInput = reader.readLine();
        } catch (IOException e) {
            e.printStackTrace();
        }
        
        // Improperly handling user input by directly outputting it to the webpage
        System.out.println(""<h1>Welcome, "" + userInput + ""!</h1>"");
    }
}","import java.io.*; public class XSSVulnerability { public static void main(String[] args) { BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter your name: ""); String userInput = """"; try { userInput = reader.readLine(); } catch (IOException e) { e.printStackTrace(); } // Improperly handling user input by directly outputting it to the webpage System.out.println(""<h1>Welcome, "" + userInput + ""!</h1>""); } }",java,1
Clear,"import mysql.connector
def safe_product_search(category):
    db = mysql.connector.connect(host=""localhost"", user=""user"", password=""pass"", database=""shop"")
    cursor = db.cursor()
    cursor.execute(""SELECT * FROM products WHERE category = %s"", (category,))
    return cursor.fetchall()","import mysql.connector
def safe_product_search(category):
    db = mysql.connector.connect(host=""localhost"", user=""user"", password=""pass"", database=""shop"")
    cursor = db.cursor()
    cursor.execute(""SELECT * FROM products WHERE category = %s"", (category,))
    return cursor.fetchall()",python,0
Clear,"#include <iostream>
#include <memory>

void safe_memory_management() {
    auto ptr = std::make_unique<int>(42);
    std::cout << *ptr << std::endl;
}","#include <iostream>
#include <memory>

void safe_memory_management() {
    auto ptr = std::make_unique<int>(42);
    std::cout << *ptr << std::endl;
}",cpp,0
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
SQL Injection,"import java.sql.*;

public class VulnerableCode {
    public static void main(String[] args) {
        try {
            String userInput = args[0];
            String query = ""SELECT * FROM users WHERE username = '"" + userInput + ""'"";

            Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");
            Statement stmt = conn.createStatement();
            ResultSet rs = stmt.executeQuery(query);

            while (rs.next()) {
                System.out.println(rs.getString(""username""));
            }

            rs.close();
            stmt.close();
            conn.close();
        } catch (Exception e) {
            e.printStackTrace();
        }
    }
}","import java.sql.*; public class VulnerableCode { public static void main(String[] args) { try { String userInput = args[0]; String query = ""SELECT * FROM users WHERE username = '"" + userInput + ""'""; Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); Statement stmt = conn.createStatement(); ResultSet rs = stmt.executeQuery(query); while (rs.next()) { System.out.println(rs.getString(""username"")); } rs.close(); stmt.close(); conn.close(); } catch (Exception e) { e.printStackTrace(); } } }",java,1
Memory Corruption,"#include <iostream>

void unsafe_pointer_arithmetic(int* array, int size) {
    for (int i = 0; i <= size; i++) {
        std::cout << *(array + i) << std::endl; // potential out-of-bounds
    }
}","#include <iostream>

void unsafe_pointer_arithmetic(int* array, int size) {
    for (int i = 0; i <= size; i++) {
        std::cout << *(array + i) << std::endl; // potential out-of-bounds
    }
}",cpp,1
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Clear,"#include <stdio.h>
#include <string.h>

int safe_buffer_operation(char *input) {
    char buffer[100];
    if (strlen(input) < sizeof(buffer)) {
        strcpy(buffer, input);
        return 0;
    }
    return -1; // buffer too small
}","#include <stdio.h>
#include <string.h>

int safe_buffer_operation(char *input) {
    char buffer[100];
    if (strlen(input) < sizeof(buffer)) {
        strcpy(buffer, input);
        return 0;
    }
    return -1; // buffer too small
}",c,0
SQL Injection,"import java.sql.*;

public class SQLInjectionVulnerableExample {
    public static void main(String[] args) {
        try {
            String userInput = ""admin'; --"";
            
            Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");
            
            Statement stmt = conn.createStatement();
            
            String query = ""SELECT * FROM users WHERE username='"" + userInput + ""'"";
            
            ResultSet rs = stmt.executeQuery(query);
            
            while (rs.next()) {
                System.out.println(""Username: "" + rs.getString(""username"") + "", Password: "" + rs.getString(""password""));
            }
            
            conn.close();
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.*; public class SQLInjectionVulnerableExample { public static void main(String[] args) { try { String userInput = ""admin'; --""; Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); Statement stmt = conn.createStatement(); String query = ""SELECT * FROM users WHERE username='"" + userInput + ""'""; ResultSet rs = stmt.executeQuery(query); while (rs.next()) { System.out.println(""Username: "" + rs.getString(""username"") + "", Password: "" + rs.getString(""password"")); } conn.close(); } catch (SQLException e) { e.printStackTrace(); } } }",java,1
SQL Injection,"import sqlite3
def get_user_data(username):
    conn = sqlite3.connect('database.db')
    cursor = conn.cursor()
    query = ""SELECT * FROM users WHERE username = '"" + username + ""'""
    cursor.execute(query)
    return cursor.fetchall()","import sqlite3
def get_user_data(username):
    conn = sqlite3.connect('database.db')
    cursor = conn.cursor()
    query = ""SELECT * FROM users WHERE username = '"" + username + ""'""
    cursor.execute(query)
    return cursor.fetchall()",python,1
Clear,"To fix the SQL Injection vulnerability in the provided Java code snippet, you need to use parameterized queries instead of directly concatenating user input into the SQL query string. Here is the modified version of the code with proper security measures implemented:

```java
import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.util.Scanner;

public class SQLInjectionFixedExample {

    public static void main(String[] args) {
        try {
            // Establishing a connection to the database
            Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");

            // Taking user input for username
            Scanner scanner = new Scanner(System.in);
            System.out.print(""Enter username: "");
            String username = scanner.nextLine();

            // Using a prepared statement to prevent SQL Injection
            String query = ""SELECT * FROM users WHERE username=?"";
            PreparedStatement pstmt = conn.prepareStatement(query);
            
            // Setting the parameter for the prepared statement
            pstmt.setString(1, username);

            // Executing the prepared statement
            ResultSet rs = pstmt.executeQuery();

            // Processing and printing the results
            while (rs.next()) {
                System.out.println","To fix the SQL Injection vulnerability in the provided Java code snippet, you need to use parameterized queries instead of directly concatenating user input into the SQL query string. Here is the modified version of the code with proper security measures implemented: ```java import java.sql.Connection; import java.sql.DriverManager; import java.sql.PreparedStatement; import java.sql.ResultSet; import java.sql.SQLException; import java.util.Scanner; public class SQLInjectionFixedExample { public static void main(String[] args) { try { // Establishing a connection to the database Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); // Taking user input for username Scanner scanner = new Scanner(System.in); System.out.print(""Enter username: ""); String username = scanner.nextLine(); // Using a prepared statement to prevent SQL Injection String query = ""SELECT * FROM users WHERE username=?""; PreparedStatement pstmt = conn.prepareStatement(query); // Setting the parameter for the prepared statement pstmt.setString(1, username); // Executing the prepared statement ResultSet rs = pstmt.executeQuery(); // Processing and printing the results while (rs.next()) { System.out.println",java,0
SQL Injection,"app.get('/user/:id', (req, res) => {
    const query = `SELECT * FROM users WHERE id = ${req.params.id}`; // SQL Injection
    db.query(query, (err, result) => {
        res.json(result);
    });
});
","app.get('/user/:id', (req, res) => {
    const query = `SELECT * FROM users WHERE id = ${req.params.id}`; // SQL Injection
    db.query(query, (err, result) => {
        res.json(result);
    });
});
",javascript,1
Code Injection,"const userData = eval('(' + userInput + ')'); // eval injection
","const userData = eval('(' + userInput + ')'); // eval injection
",javascript,1
Clear,"import java.sql.*;

public class SecureCode {

    public static void main(String[] args) {
        String userInput = ""'; DROP TABLE users; --""; // Malicious input simulating SQL injection
        String query = ""SELECT * FROM users WHERE username = ?"";

        try {
            Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");
            PreparedStatement pstmt = conn.prepareStatement(query);
            pstmt.setString(1, userInput);
            
            ResultSet rs = pstmt.executeQuery();

            while (rs.next()) {
                System.out.println(""User found: "" + rs.getString(""username""));
            }

            conn.close();
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.*; public class SecureCode { public static void main(String[] args) { String userInput = ""'; DROP TABLE users; --""; // Malicious input simulating SQL injection String query = ""SELECT * FROM users WHERE username = ?""; try { Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); PreparedStatement pstmt = conn.prepareStatement(query); pstmt.setString(1, userInput); ResultSet rs = pstmt.executeQuery(); while (rs.next()) { System.out.println(""User found: "" + rs.getString(""username"")); } conn.close(); } catch (SQLException e) { e.printStackTrace(); } } }",java,0
Clear,"const token = process.env.API_TOKEN; // Environment variable
fetch('/api/data', {
    headers: { 'Authorization': `Bearer ${token}` }
});
","const token = process.env.API_TOKEN; // Environment variable
fetch('/api/data', {
    headers: { 'Authorization': `Bearer ${token}` }
});
",javascript,0
Clear,"import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;

public class SecureSQLInjectionExample {

    public static void main(String[] args) {
        String userInput = ""'; DROP TABLE users; --"";

        try {
            Connection connection = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");

            // Use a prepared statement to avoid SQL injection
            String query = ""SELECT * FROM users WHERE username = ?"";
            PreparedStatement preparedStatement = connection.prepareStatement(query);
            preparedStatement.setString(1, userInput);

            ResultSet resultSet = preparedStatement.executeQuery();

            while(resultSet.next()) {
                System.out.println(""User found: "" + resultSet.getString(""username""));
            }

            connection.close();
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.Connection; import java.sql.DriverManager; import java.sql.PreparedStatement; import java.sql.ResultSet; import java.sql.SQLException; public class SecureSQLInjectionExample { public static void main(String[] args) { String userInput = ""'; DROP TABLE users; --""; try { Connection connection = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); // Use a prepared statement to avoid SQL injection String query = ""SELECT * FROM users WHERE username = ?""; PreparedStatement preparedStatement = connection.prepareStatement(query); preparedStatement.setString(1, userInput); ResultSet resultSet = preparedStatement.executeQuery(); while(resultSet.next()) { System.out.println(""User found: "" + resultSet.getString(""username"")); } connection.close(); } catch (SQLException e) { e.printStackTrace(); } } }",java,0
Clear,"const shell = require('child_process');
const safeInput = userInput.replace(/[^a-zA-Z0-9.]/g, '');
shell.execFile('ping', [safeInput]); // Safe command execution
","const shell = require('child_process');
const safeInput = userInput.replace(/[^a-zA-Z0-9.]/g, '');
shell.execFile('ping', [safeInput]); // Safe command execution
",javascript,0
Buffer Overflow,"#include <iostream>
#include <cstring>

void unsafe_c_string(char* input) {
    char buffer[100];
    strcpy(buffer, input); // potential buffer overflow
    std::cout << buffer << std::endl;
}","#include <iostream>
#include <cstring>

void unsafe_c_string(char* input) {
    char buffer[100];
    strcpy(buffer, input); // potential buffer overflow
    std::cout << buffer << std::endl;
}",cpp,1
Memory Corruption,"#include <iostream>

void unsafe_virtual_call() {
    // Potential vtable corruption vulnerability
    class Base {
    public:
        virtual void func() { std::cout << ""Base"" << std::endl; }
    };
    
    class Derived : public Base {
    public:
        void func() override { std::cout << ""Derived"" << std::endl; }
    };
}","#include <iostream>

void unsafe_virtual_call() {
    // Potential vtable corruption vulnerability
    class Base {
    public:
        virtual void func() { std::cout << ""Base"" << std::endl; }
    };
    
    class Derived : public Base {
    public:
        void func() override { std::cout << ""Derived"" << std::endl; }
    };
}",cpp,1
Clear,"import java.io.IOException;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

public class XSSFixedServlet extends HttpServlet {

    @Override
    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws IOException {
        String userInput = request.getParameter(""input"");
        String sanitizedInput = sanitizeInput(userInput);
        String output = ""Hello, "" + sanitizedInput + ""!"";

        response.getWriter().println(""<html><body>"");
        response.getWriter().println(""<h1>"" + output + ""</h1>"");
        response.getWriter().println(""</body></html>"");
    }

    private String sanitizeInput(String input) {
        // Implement proper input sanitization here (e.g., escaping special characters)
        // You can use OWASP Java Encoder library or other similar libraries for encoding

        // Example using OWASP Java Encoder for HTML encoding:
        return org.owasp.encoder.Encode.forHtml(input);
    }
}","import java.io.IOException; import javax.servlet.http.HttpServlet; import javax.servlet.http.HttpServletRequest; import javax.servlet.http.HttpServletResponse; public class XSSFixedServlet extends HttpServlet { @Override protected void doGet(HttpServletRequest request, HttpServletResponse response) throws IOException { String userInput = request.getParameter(""input""); String sanitizedInput = sanitizeInput(userInput); String output = ""Hello, "" + sanitizedInput + ""!""; response.getWriter().println(""<html><body>""); response.getWriter().println(""<h1>"" + output + ""</h1>""); response.getWriter().println(""</body></html>""); } private String sanitizeInput(String input) { // Implement proper input sanitization here (e.g., escaping special characters) // You can use OWASP Java Encoder library or other similar libraries for encoding // Example using OWASP Java Encoder for HTML encoding: return org.owasp.encoder.Encode.forHtml(input); } }",java,0
SQL Injection,"import java.sql.*;

public class SQLInjectionExample {

    public static void main(String[] args) {
        String userInput = ""admin'; DROP TABLE users;--"";
        
        try {
            Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");
            Statement stmt = conn.createStatement();
            
            // Vulnerable query construction
            String query = ""SELECT * FROM users WHERE username='"" + userInput + ""'"";
            
            ResultSet rs = stmt.executeQuery(query);
            
            while (rs.next()) {
                System.out.println(rs.getString(""username""));
            }
            
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.*; public class SQLInjectionExample { public static void main(String[] args) { String userInput = ""admin'; DROP TABLE users;--""; try { Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); Statement stmt = conn.createStatement(); // Vulnerable query construction String query = ""SELECT * FROM users WHERE username='"" + userInput + ""'""; ResultSet rs = stmt.executeQuery(query); while (rs.next()) { System.out.println(rs.getString(""username"")); } } catch (SQLException e) { e.printStackTrace(); } } }",java,1
Command Injection,"const shell = require('child_process');
shell.exec('ping ' + userInput); // Command Injection
","const shell = require('child_process');
shell.exec('ping ' + userInput); // Command Injection
",javascript,1
Clear,"#include <iostream>
#include <vector>
#include <stdexcept>

int safe_vector_access(const std::vector<int>& vec, size_t index) {
    if (index >= vec.size()) {
        throw std::out_of_range(""Index out of range"");
    }
    return vec[index];
}","#include <iostream>
#include <vector>
#include <stdexcept>

int safe_vector_access(const std::vector<int>& vec, size_t index) {
    if (index >= vec.size()) {
        throw std::out_of_range(""Index out of range"");
    }
    return vec[index];
}",cpp,0
Clear,"To secure the code against Path Traversal vulnerability, you should validate the input file name to ensure that it does not allow directory traversal. Here's an improved version of the code that implements this security measure:

```java
import java.io.File;
import java.io.FileInputStream;
import java.io.IOException;
import java.util.Scanner;

public class SecurePathTraversal {

    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);

        System.out.print(""Enter the file name: "");
        String fileName = scanner.nextLine();

        // Validate the file name to prevent directory traversal
        if (!isValidFileName(fileName)) {
            System.err.println(""Invalid file name"");
            return;
        }

        try {
            File file = new File(""/path/to/files/"" + fileName);
            FileInputStream fis = new FileInputStream(file);

            int content;
            while ((content = fis.read()) != -1) {
                System.out.print((char) content);
            }

            fis.close();
        } catch (IOException e) {
            System.err.println(""Error reading file: "" + e.getMessage());
        }
    }

    private static boolean isValidFileName(String fileName) {
        // Implement your validation logic here
        // For example, only allow alphanumeric characters","To secure the code against Path Traversal vulnerability, you should validate the input file name to ensure that it does not allow directory traversal. Here's an improved version of the code that implements this security measure: ```java import java.io.File; import java.io.FileInputStream; import java.io.IOException; import java.util.Scanner; public class SecurePathTraversal { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter the file name: ""); String fileName = scanner.nextLine(); // Validate the file name to prevent directory traversal if (!isValidFileName(fileName)) { System.err.println(""Invalid file name""); return; } try { File file = new File(""/path/to/files/"" + fileName); FileInputStream fis = new FileInputStream(file); int content; while ((content = fis.read()) != -1) { System.out.print((char) content); } fis.close(); } catch (IOException e) { System.err.println(""Error reading file: "" + e.getMessage()); } } private static boolean isValidFileName(String fileName) { // Implement your validation logic here // For example, only allow alphanumeric characters",java,0
Cross-Site Scripting (XSS),"import java.io.*;

public class XSSVulnerableCode {

    public static void main(String[] args) {
        BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));
        
        System.out.print(""Enter your name: "");
        String userInput = null;
        
        try {
            userInput = reader.readLine();
        } catch (IOException e) {
            e.printStackTrace();
        }
        
        System.out.println(""Hello, "" + userInput + ""! Welcome to our website."");
    }
}","import java.io.*; public class XSSVulnerableCode { public static void main(String[] args) { BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter your name: ""); String userInput = null; try { userInput = reader.readLine(); } catch (IOException e) { e.printStackTrace(); } System.out.println(""Hello, "" + userInput + ""! Welcome to our website.""); } }",java,1
Clear,"#include <stdio.h>
#include <string.h>

void safe_string_copy(char *dest, const char *src, size_t dest_size) {
    if (dest_size > 0) {
        strncpy(dest, src, dest_size - 1);
        dest[dest_size - 1] = '\0';
    }
}","#include <stdio.h>
#include <string.h>

void safe_string_copy(char *dest, const char *src, size_t dest_size) {
    if (dest_size > 0) {
        strncpy(dest, src, dest_size - 1);
        dest[dest_size - 1] = '\0';
    }
}",c,0
Command Injection,"import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class CommandInjectionVulnerable {

    public static void main(String[] args) {
        try {
            BufferedReader br = new BufferedReader(new InputStreamReader(System.in));
            System.out.print(""Enter a command to execute: "");
            String userInput = br.readLine();

            // Vulnerable code - user input is directly passed to the command execution without proper validation
            Process process = Runtime.getRuntime().exec(""ping "" + userInput);

            BufferedReader reader = new BufferedReader(new InputStreamReader(process.getInputStream()));
            String line;
            while ((line = reader.readLine()) != null) {
                System.out.println(line);
            }

        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}","import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class CommandInjectionVulnerable { public static void main(String[] args) { try { BufferedReader br = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a command to execute: ""); String userInput = br.readLine(); // Vulnerable code - user input is directly passed to the command execution without proper validation Process process = Runtime.getRuntime().exec(""ping "" + userInput); BufferedReader reader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = reader.readLine()) != null) { System.out.println(line); } } catch (IOException e) { e.printStackTrace(); } } }",java,1
Cross-Site Scripting (XSS),"import java.io.*;

public class XSSVulnerableCode {

    public static void main(String[] args) throws IOException {
        BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));

        System.out.print(""Enter your name: "");
        String name = reader.readLine();

        System.out.println(""Hello, "" + name + ""!""); // Vulnerability here

    }
}","import java.io.*; public class XSSVulnerableCode { public static void main(String[] args) throws IOException { BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter your name: ""); String name = reader.readLine(); System.out.println(""Hello, "" + name + ""!""); // Vulnerability here } }",java,1
Cross-Site Scripting (XSS),"import java.io.IOException;
import java.io.PrintWriter;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

public class VulnerableServlet extends HttpServlet {
    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws IOException {
        String userInput = request.getParameter(""input"");
        
        // Vulnerable code: directly outputting user input without proper validation or encoding
        PrintWriter out = response.getWriter();
        out.println(""<html>"");
        out.println(""<body>"");
        out.println(""User Input: "" + userInput); // User input is reflected back to the response
        out.println(""</body>"");
        out.println(""</html>"");
    }
}","import java.io.IOException; import java.io.PrintWriter; import javax.servlet.http.HttpServlet; import javax.servlet.http.HttpServletRequest; import javax.servlet.http.HttpServletResponse; public class VulnerableServlet extends HttpServlet { protected void doGet(HttpServletRequest request, HttpServletResponse response) throws IOException { String userInput = request.getParameter(""input""); // Vulnerable code: directly outputting user input without proper validation or encoding PrintWriter out = response.getWriter(); out.println(""<html>""); out.println(""<body>""); out.println(""User Input: "" + userInput); // User input is reflected back to the response out.println(""</body>""); out.println(""</html>""); } }",java,1
Cross-Site Scripting (XSS),"import java.io.*;
import javax.servlet.*;
import javax.servlet.http.*;

public class XSSVulnerableServlet extends HttpServlet {
    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        String userInput = request.getParameter(""input"");
        
        // Vulnerability: User input is directly inserted into the response without proper validation or encoding
        String output = ""<html><body>Hello, "" + userInput + ""!</body></html>"";
        
        PrintWriter out = response.getWriter();
        out.println(output);
    }
}","import java.io.*; import javax.servlet.*; import javax.servlet.http.*; public class XSSVulnerableServlet extends HttpServlet { protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { String userInput = request.getParameter(""input""); // Vulnerability: User input is directly inserted into the response without proper validation or encoding String output = ""<html><body>Hello, "" + userInput + ""!</body></html>""; PrintWriter out = response.getWriter(); out.println(output); } }",java,1
Clear,"#include <stdio.h>
#include <string.h>

int safe_buffer_operation(char *input) {
    char buffer[100];
    if (strlen(input) < sizeof(buffer)) {
        strcpy(buffer, input);
        return 0;
    }
    return -1; // buffer too small
}","#include <stdio.h>
#include <string.h>

int safe_buffer_operation(char *input) {
    char buffer[100];
    if (strlen(input) < sizeof(buffer)) {
        strcpy(buffer, input);
        return 0;
    }
    return -1; // buffer too small
}",c,0
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Command Injection,"import subprocess
def list_directory(path):
    result = subprocess.run(f""ls {path}"", shell=True, capture_output=True, text=True)
    return result.stdout","import subprocess
def list_directory(path):
    result = subprocess.run(f""ls {path}"", shell=True, capture_output=True, text=True)
    return result.stdout",python,1
Clear,"#include <stdio.h>
#include <string.h>

int safe_buffer_operation(char *input) {
    char buffer[100];
    if (strlen(input) < sizeof(buffer)) {
        strcpy(buffer, input);
        return 0;
    }
    return -1; // buffer too small
}","#include <stdio.h>
#include <string.h>

int safe_buffer_operation(char *input) {
    char buffer[100];
    if (strlen(input) < sizeof(buffer)) {
        strcpy(buffer, input);
        return 0;
    }
    return -1; // buffer too small
}",c,0
Clear,"#include <iostream>
#include <memory>

void safe_memory_management() {
    auto ptr = std::make_unique<int>(42);
    std::cout << *ptr << std::endl;
}","#include <iostream>
#include <memory>

void safe_memory_management() {
    auto ptr = std::make_unique<int>(42);
    std::cout << *ptr << std::endl;
}",cpp,0
Clear,"const userData = JSON.parse(userInput); // Safe JSON parsing
if (userData && typeof userData === 'object') {
    processUserData(userData);
}
","const userData = JSON.parse(userInput); // Safe JSON parsing
if (userData && typeof userData === 'object') {
    processUserData(userData);
}
",javascript,0
SQL Injection,"app.get('/user/:id', (req, res) => {
    const query = `SELECT * FROM users WHERE id = ${req.params.id}`; // SQL Injection
    db.query(query, (err, result) => {
        res.json(result);
    });
});
","app.get('/user/:id', (req, res) => {
    const query = `SELECT * FROM users WHERE id = ${req.params.id}`; // SQL Injection
    db.query(query, (err, result) => {
        res.json(result);
    });
});
",javascript,1
Clear,"def safe_division(a, b):
    if b == 0:
        raise ValueError(""Division by zero"")
    return a / b","def safe_division(a, b):
    if b == 0:
        raise ValueError(""Division by zero"")
    return a / b",python,0
Clear,"import java.util.Scanner;

public class SecureBufferUsage {
    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        System.out.print(""Enter your name: "");
        String name = scanner.nextLine();

        // Create a StringBuilder object instead of a fixed-size buffer
        StringBuilder buffer = new StringBuilder();
        
        // Append the user input to the StringBuilder
        buffer.append(name);

        System.out.println(""Buffer overflow vulnerability fixed successfully!"");
    }
}","import java.util.Scanner; public class SecureBufferUsage { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter your name: ""); String name = scanner.nextLine(); // Create a StringBuilder object instead of a fixed-size buffer StringBuilder buffer = new StringBuilder(); // Append the user input to the StringBuilder buffer.append(name); System.out.println(""Buffer overflow vulnerability fixed successfully!""); } }",java,0
Clear,"import org.owasp.encoder.Encode;

public class XSSFixedCode {
    public static void main(String[] args) {
        // Simulating user input from a form submission
        String userInput = ""<script>alert('XSS Vulnerability!')</script>"";

        // Sanitize and escape user input before outputting it to the HTML page
        String sanitizedInput = Encode.forHtml(userInput);
        
        // Output the sanitized input to prevent XSS attacks
        System.out.println(""<div>"" + sanitizedInput + ""</div>"");
    }
}","import org.owasp.encoder.Encode; public class XSSFixedCode { public static void main(String[] args) { // Simulating user input from a form submission String userInput = ""<script>alert('XSS Vulnerability!')</script>""; // Sanitize and escape user input before outputting it to the HTML page String sanitizedInput = Encode.forHtml(userInput); // Output the sanitized input to prevent XSS attacks System.out.println(""<div>"" + sanitizedInput + ""</div>""); } }",java,0
Out-of-Bounds,"#include <iostream>

class UnsafeClass {
    int data[10];
public:
    int get_data(int index) {
        return data[index]; // no bounds checking
    }
};","#include <iostream>

class UnsafeClass {
    int data[10];
public:
    int get_data(int index) {
        return data[index]; // no bounds checking
    }
};",cpp,1
SQL Injection,"import java.sql.*;

public class SQLInjectionVulnerable {
    public static void main(String[] args) {
        String userInput = ""'; DROP TABLE users; --"";
        
        try {
            Connection connection = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");
            Statement statement = connection.createStatement();
            
            String query = ""SELECT * FROM users WHERE username = '"" + userInput + ""'"";
            ResultSet resultSet = statement.executeQuery(query);
            
            while(resultSet.next()) {
                System.out.println(""Username: "" + resultSet.getString(""username""));
                System.out.println(""Password: "" + resultSet.getString(""password""));
            }
            
            connection.close();
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.*; public class SQLInjectionVulnerable { public static void main(String[] args) { String userInput = ""'; DROP TABLE users; --""; try { Connection connection = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); Statement statement = connection.createStatement(); String query = ""SELECT * FROM users WHERE username = '"" + userInput + ""'""; ResultSet resultSet = statement.executeQuery(query); while(resultSet.next()) { System.out.println(""Username: "" + resultSet.getString(""username"")); System.out.println(""Password: "" + resultSet.getString(""password"")); } connection.close(); } catch (SQLException e) { e.printStackTrace(); } } }",java,1
Clear,"#include <stdio.h>
#include <string.h>

void safe_string_copy(char *dest, const char *src, size_t dest_size) {
    if (dest_size > 0) {
        strncpy(dest, src, dest_size - 1);
        dest[dest_size - 1] = '\0';
    }
}","#include <stdio.h>
#include <string.h>

void safe_string_copy(char *dest, const char *src, size_t dest_size) {
    if (dest_size > 0) {
        strncpy(dest, src, dest_size - 1);
        dest[dest_size - 1] = '\0';
    }
}",c,0
Clear,"#include <stdio.h>
#include <string.h>

int validate_input(const char *input) {
    if (input == NULL) return 0;
    for (int i = 0; input[i] != '\0'; i++) {
        if (input[i] < 32 || input[i] > 126) {
            return 0; // invalid character
        }
    }
    return 1;
}","#include <stdio.h>
#include <string.h>

int validate_input(const char *input) {
    if (input == NULL) return 0;
    for (int i = 0; input[i] != '\0'; i++) {
        if (input[i] < 32 || input[i] > 126) {
            return 0; // invalid character
        }
    }
    return 1;
}",c,0
Clear,"#include <stdio.h>
#include <stdlib.h>

int safe_string_to_int(const char *str) {
    char *endptr;
    long value = strtol(str, &endptr, 10);
    if (*endptr != '\0' || str == endptr) {
        return -1; // error
    }
    return (int)value;
}","#include <stdio.h>
#include <stdlib.h>

int safe_string_to_int(const char *str) {
    char *endptr;
    long value = strtol(str, &endptr, 10);
    if (*endptr != '\0' || str == endptr) {
        return -1; // error
    }
    return (int)value;
}",c,0
Clear,"It looks like the code snippet provided is vulnerable to Insecure Deserialization, which can lead to potential security risks such as remote code execution. To fix this vulnerability and implement proper security measures, you should follow secure coding practices for deserialization. Here are some steps you can take to secure the code:

1. **Use a Safe Deserialization Mechanism**: Instead of using `ObjectInputStream`, consider using a safer deserialization mechanism like `JSON` or `XML` parsing libraries that have built-in protections against malicious input.

2. **Validate Input**: Ensure that the serialized data is coming from a trusted and authenticated source. Validate and sanitize the input before deserializing it.

3. **Implement Whitelisting**: Maintain a whitelist of allowed classes that can be deserialized. Only deserialize objects of classes that are on the whitelist.

4. **Use Secure Deserialization Libraries**: If possible, use secure serialization libraries like Google's `Gson` or Apache's `Jackson` that provide additional security features.

5. **Enable Security Manager**: Consider running your application with a Security Manager configured to restrict access to sensitive resources and prevent potentially harmful operations.

6. **Encrypt and Sign Serialized Data**: Encrypt the serialized data before transmitting it and verify its integrity using","It looks like the code snippet provided is vulnerable to Insecure Deserialization, which can lead to potential security risks such as remote code execution. To fix this vulnerability and implement proper security measures, you should follow secure coding practices for deserialization. Here are some steps you can take to secure the code: 1. **Use a Safe Deserialization Mechanism**: Instead of using `ObjectInputStream`, consider using a safer deserialization mechanism like `JSON` or `XML` parsing libraries that have built-in protections against malicious input. 2. **Validate Input**: Ensure that the serialized data is coming from a trusted and authenticated source. Validate and sanitize the input before deserializing it. 3. **Implement Whitelisting**: Maintain a whitelist of allowed classes that can be deserialized. Only deserialize objects of classes that are on the whitelist. 4. **Use Secure Deserialization Libraries**: If possible, use secure serialization libraries like Google's `Gson` or Apache's `Jackson` that provide additional security features. 5. **Enable Security Manager**: Consider running your application with a Security Manager configured to restrict access to sensitive resources and prevent potentially harmful operations. 6. **Encrypt and Sign Serialized Data**: Encrypt the serialized data before transmitting it and verify its integrity using",php,0
Command Injection,"<?php
$cmd = $_GET['cmd'];
system($cmd); // Command Injection
?>","<?php
$cmd = $_GET['cmd'];
system($cmd); // Command Injection
?>",php,1
Clear,"const userInput = new URLSearchParams(window.location.search).get('input');
const safeOutput = document.createElement('div');
safeOutput.textContent = userInput; // Safe DOM manipulation
document.body.appendChild(safeOutput);
","const userInput = new URLSearchParams(window.location.search).get('input');
const safeOutput = document.createElement('div');
safeOutput.textContent = userInput; // Safe DOM manipulation
document.body.appendChild(safeOutput);
",javascript,0
Clear,"import subprocess
def safe_ping(host):
    import re
    if not re.match(r'^[a-zA-Z0-9.-]+$', host):
        raise ValueError(""Invalid host"")
    result = subprocess.run(['ping', '-c', '4', host], capture_output=True, text=True)
    return result.stdout","import subprocess
def safe_ping(host):
    import re
    if not re.match(r'^[a-zA-Z0-9.-]+$', host):
        raise ValueError(""Invalid host"")
    result = subprocess.run(['ping', '-c', '4', host], capture_output=True, text=True)
    return result.stdout",python,0
Clear,"def safe_division(a, b):
    if b == 0:
        raise ValueError(""Division by zero"")
    return a / b","def safe_division(a, b):
    if b == 0:
        raise ValueError(""Division by zero"")
    return a / b",python,0
Clear,"import java.io.*;
import javax.servlet.*;
import javax.servlet.http.*;

public class SecureServlet extends HttpServlet {
    protected void doPost(HttpServletRequest request, HttpServletResponse response)
            throws ServletException, IOException {

        String userInput = request.getParameter(""userInput"");
        
        // Sanitize user input to prevent XSS
        String sanitizedInput = sanitizeUserInput(userInput);
        
        // Output sanitized user input to the response
        PrintWriter out = response.getWriter();
        out.println(""<html>"");
        out.println(""<body>"");
        out.println(""User input: "" + sanitizedInput); // Output sanitized user input
        out.println(""</body>"");
        out.println(""</html>"");
    }
    
    private String sanitizeUserInput(String userInput) {
        // Replace special characters that could be used for XSS attacks
        return userInput.replaceAll(""<"", ""&lt;"")
                        .replaceAll("">"", ""&gt;"")
                        .replaceAll(""&"", ""&amp;"");
    }
}","import java.io.*; import javax.servlet.*; import javax.servlet.http.*; public class SecureServlet extends HttpServlet { protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { String userInput = request.getParameter(""userInput""); // Sanitize user input to prevent XSS String sanitizedInput = sanitizeUserInput(userInput); // Output sanitized user input to the response PrintWriter out = response.getWriter(); out.println(""<html>""); out.println(""<body>""); out.println(""User input: "" + sanitizedInput); // Output sanitized user input out.println(""</body>""); out.println(""</html>""); } private String sanitizeUserInput(String userInput) { // Replace special characters that could be used for XSS attacks return userInput.replaceAll(""<"", ""&lt;"") .replaceAll("">"", ""&gt;"") .replaceAll(""&"", ""&amp;""); } }",java,0
XSS,"<?php
echo $_GET['message']; // XSS
?>","<?php
echo $_GET['message']; // XSS
?>",php,1
Clear,"<?php
$username = $_POST['username'];
$stmt = $pdo->prepare(""SELECT * FROM users WHERE username = ?"");
$stmt->execute([$username]); // Parameterized query
?>","<?php
$username = $_POST['username'];
$stmt = $pdo->prepare(""SELECT * FROM users WHERE username = ?"");
$stmt->execute([$username]); // Parameterized query
?>",php,0
Command Injection,"import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class CommandInjectionExample {
    public static void main(String[] args) {
        try {
            BufferedReader br = new BufferedReader(new InputStreamReader(System.in));
            System.out.print(""Enter a command to execute: "");
            String userInput = br.readLine();

            // Vulnerable code - directly executing user input as a command
            Process process = Runtime.getRuntime().exec(""echo "" + userInput);

            BufferedReader reader = new BufferedReader(new InputStreamReader(process.getInputStream()));
            String line;
            
            while ((line = reader.readLine()) != null) {
                System.out.println(line);
            }
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}","import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class CommandInjectionExample { public static void main(String[] args) { try { BufferedReader br = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a command to execute: ""); String userInput = br.readLine(); // Vulnerable code - directly executing user input as a command Process process = Runtime.getRuntime().exec(""echo "" + userInput); BufferedReader reader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = reader.readLine()) != null) { System.out.println(line); } } catch (IOException e) { e.printStackTrace(); } } }",java,1
Clear,"To fix the Path Traversal vulnerability in the provided Java code, you need to ensure that the user input does not allow accessing files outside of the intended directory. Here is an improved version of the code using secure coding practices:

```java
import java.io.File;
import java.io.IOException;
import java.nio.file.Files;
import java.nio.file.Path;
import java.nio.file.Paths;

public class SecurePathTraversal {

    public static void main(String[] args) throws IOException {
        String userInput = ""../secretFile.txt"";
        String baseDir = ""/home/user/documents/"";

        // Ensure userInput does not contain path traversal sequences
        if (!userInput.contains("".."") && !userInput.startsWith(""/"") && !userInput.endsWith(""/"")) {
            String fullPath = baseDir + userInput;
            File file = new File(fullPath);

            if (file.getCanonicalPath().startsWith(baseDir)) {
                if (file.exists()) {
                    Path path = Paths.get(fullPath);
                    byte[] fileContent = Files.readAllBytes(path);
                    System.out.println(""File content: "" + new String(fileContent));
                } else {
                    System.out.println(""File not found"");
                }
            } else {
                System.out.println(""Invalid file path"");
            }","To fix the Path Traversal vulnerability in the provided Java code, you need to ensure that the user input does not allow accessing files outside of the intended directory. Here is an improved version of the code using secure coding practices: ```java import java.io.File; import java.io.IOException; import java.nio.file.Files; import java.nio.file.Path; import java.nio.file.Paths; public class SecurePathTraversal { public static void main(String[] args) throws IOException { String userInput = ""../secretFile.txt""; String baseDir = ""/home/user/documents/""; // Ensure userInput does not contain path traversal sequences if (!userInput.contains("".."") && !userInput.startsWith(""/"") && !userInput.endsWith(""/"")) { String fullPath = baseDir + userInput; File file = new File(fullPath); if (file.getCanonicalPath().startsWith(baseDir)) { if (file.exists()) { Path path = Paths.get(fullPath); byte[] fileContent = Files.readAllBytes(path); System.out.println(""File content: "" + new String(fileContent)); } else { System.out.println(""File not found""); } } else { System.out.println(""Invalid file path""); }",java,0
File Inclusion,"<?php
$file = $_GET['file'];
include($file); // File Inclusion
?>","<?php
$file = $_GET['file'];
include($file); // File Inclusion
?>",php,1
Buffer Overflow,"import java.util.Scanner;

public class BufferOverflowVulnerability {
    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        
        System.out.print(""Enter your name: "");
        String name = scanner.nextLine();
        
        // Vulnerable code: The program does not validate the length of the input
        char[] buffer = new char[10];
        name.getChars(0, name.length(), buffer, 0);
        
        System.out.println(""Welcome, "" + String.valueOf(buffer));
    }
}","import java.util.Scanner; public class BufferOverflowVulnerability { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter your name: ""); String name = scanner.nextLine(); // Vulnerable code: The program does not validate the length of the input char[] buffer = new char[10]; name.getChars(0, name.length(), buffer, 0); System.out.println(""Welcome, "" + String.valueOf(buffer)); } }",java,1
Clear,"#include <iostream>
#include <sstream>

int safe_string_to_int(const std::string& str) {
    std::stringstream ss(str);
    int value;
    if (ss >> value) {
        return value;
    }
    throw std::invalid_argument(""Invalid integer"");
}","#include <iostream>
#include <sstream>

int safe_string_to_int(const std::string& str) {
    std::stringstream ss(str);
    int value;
    if (ss >> value) {
        return value;
    }
    throw std::invalid_argument(""Invalid integer"");
}",cpp,0
Code Injection,"const userData = eval('(' + userInput + ')'); // eval injection
","const userData = eval('(' + userInput + ')'); // eval injection
",javascript,1
SQL Injection,"import psycopg2
def admin_login(admin_id):
    conn = psycopg2.connect(""dbname=test user=postgres"")
    cur = conn.cursor()
    cur.execute(f""SELECT * FROM admins WHERE id = {admin_id}"")
    return cur.fetchone()","import psycopg2
def admin_login(admin_id):
    conn = psycopg2.connect(""dbname=test user=postgres"")
    cur = conn.cursor()
    cur.execute(f""SELECT * FROM admins WHERE id = {admin_id}"")
    return cur.fetchone()",python,1
Clear,"To fix the Path Traversal vulnerability in the provided Java code snippet, you can ensure that the user input for the file name does not allow directory traversal. One way to do this is by validating the input against a whitelist of allowed characters or patterns.

Here is an example of how you can modify the code to mitigate Path Traversal vulnerability:

```java
import java.io.File;
import java.io.FileInputStream;
import java.io.IOException;
import java.util.Scanner;
import java.nio.file.Paths;

public class SecurePathTraversal {

    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        System.out.print(""Enter a file name: "");
        String fileName = scanner.nextLine();

        if (isValidFileName(fileName)) {
            try {
                File file = new File(""/path/to/directory/"" + fileName);
                FileInputStream fis = new FileInputStream(file);
                int content;
                while ((content = fis.read()) != -1) {
                    System.out.print((char) content);
                }
                fis.close();
            } catch (IOException e) {
                System.out.println(""File not found or cannot be accessed."");
            }
        } else {
            System.out.println(""Invalid file name."");
        }
    }

    private static boolean","To fix the Path Traversal vulnerability in the provided Java code snippet, you can ensure that the user input for the file name does not allow directory traversal. One way to do this is by validating the input against a whitelist of allowed characters or patterns. Here is an example of how you can modify the code to mitigate Path Traversal vulnerability: ```java import java.io.File; import java.io.FileInputStream; import java.io.IOException; import java.util.Scanner; import java.nio.file.Paths; public class SecurePathTraversal { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter a file name: ""); String fileName = scanner.nextLine(); if (isValidFileName(fileName)) { try { File file = new File(""/path/to/directory/"" + fileName); FileInputStream fis = new FileInputStream(file); int content; while ((content = fis.read()) != -1) { System.out.print((char) content); } fis.close(); } catch (IOException e) { System.out.println(""File not found or cannot be accessed.""); } } else { System.out.println(""Invalid file name.""); } } private static boolean",java,0
Cross-Site Scripting (XSS),"import java.io.*;
import javax.servlet.*;
import javax.servlet.http.*;

public class VulnerableServlet extends HttpServlet {
    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        response.setContentType(""text/html"");

        String userInput = request.getParameter(""input"");
        
        PrintWriter out = response.getWriter();
        out.println(""<html><body>"");
        out.println(""<h1>User Input:</h1>"");
        out.println(userInput); // Vulnerability: User input is not properly sanitized
        out.println(""</body></html>"");
    }
}","import java.io.*; import javax.servlet.*; import javax.servlet.http.*; public class VulnerableServlet extends HttpServlet { protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { response.setContentType(""text/html""); String userInput = request.getParameter(""input""); PrintWriter out = response.getWriter(); out.println(""<html><body>""); out.println(""<h1>User Input:</h1>""); out.println(userInput); // Vulnerability: User input is not properly sanitized out.println(""</body></html>""); } }",java,1
Clear,"#include <stdio.h>
#include <string.h>

void safe_string_copy(char *dest, const char *src, size_t dest_size) {
    if (dest_size > 0) {
        strncpy(dest, src, dest_size - 1);
        dest[dest_size - 1] = '\0';
    }
}","#include <stdio.h>
#include <string.h>

void safe_string_copy(char *dest, const char *src, size_t dest_size) {
    if (dest_size > 0) {
        strncpy(dest, src, dest_size - 1);
        dest[dest_size - 1] = '\0';
    }
}",c,0
Clear,"import yaml
def safe_yaml_load(config_str):
    return yaml.safe_load(config_str)","import yaml
def safe_yaml_load(config_str):
    return yaml.safe_load(config_str)",python,0
File Inclusion,"<?php
$file = $_GET['file'];
include($file); // File Inclusion
?>","<?php
$file = $_GET['file'];
include($file); // File Inclusion
?>",php,1
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Clear,"<?php
$cmd = escapeshellarg($_GET['cmd']);
system(""ls "" . $cmd); // Escaped command
?>","<?php
$cmd = escapeshellarg($_GET['cmd']);
system(""ls "" . $cmd); // Escaped command
?>",php,0
Clear,"<?php
$username = $_POST['username'];
$stmt = $pdo->prepare(""SELECT * FROM users WHERE username = ?"");
$stmt->execute([$username]); // Parameterized query
?>","<?php
$username = $_POST['username'];
$stmt = $pdo->prepare(""SELECT * FROM users WHERE username = ?"");
$stmt->execute([$username]); // Parameterized query
?>",php,0
Clear,"To fix the Path Traversal vulnerability in the given Java code snippet, you should sanitize the user input and validate that the provided file name is safe to use. Here's an improved version of the code with proper security measures:

```java
import java.io.File;
import java.io.IOException;
import java.nio.file.Files;
import java.nio.file.Path;
import java.util.Scanner;

public class SecurePathTraversalExample {

    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        
        System.out.println(""Enter file name:"");
        String fileName = scanner.nextLine();

        // Validate the file name to prevent path traversal
        if (!isValidFileName(fileName)) {
            System.err.println(""Invalid file name."");
            return;
        }
        
        File file = new File(""/path/to/directory/"" + fileName);
        
        try {
            byte[] fileData = Files.readAllBytes(file.toPath());
            System.out.println(""File contents: "" + new String(fileData));
        } catch (IOException e) {
            System.err.println(""Error reading file: "" + e.getMessage());
        }
    }

    private static boolean isValidFileName(String fileName) {
        // Ensure that the file name does not contain any path traversal characters","To fix the Path Traversal vulnerability in the given Java code snippet, you should sanitize the user input and validate that the provided file name is safe to use. Here's an improved version of the code with proper security measures: ```java import java.io.File; import java.io.IOException; import java.nio.file.Files; import java.nio.file.Path; import java.util.Scanner; public class SecurePathTraversalExample { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.println(""Enter file name:""); String fileName = scanner.nextLine(); // Validate the file name to prevent path traversal if (!isValidFileName(fileName)) { System.err.println(""Invalid file name.""); return; } File file = new File(""/path/to/directory/"" + fileName); try { byte[] fileData = Files.readAllBytes(file.toPath()); System.out.println(""File contents: "" + new String(fileData)); } catch (IOException e) { System.err.println(""Error reading file: "" + e.getMessage()); } } private static boolean isValidFileName(String fileName) { // Ensure that the file name does not contain any path traversal characters",java,0
Clear,"import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;

public class SecureCode {

    public static void main(String[] args) {
        String userInput = ""'; DROP TABLE users; --""; // Malicious input simulating a SQL Injection attack

        try (Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"")) {
            String query = ""SELECT * FROM users WHERE username=?"";
            try (PreparedStatement stmt = conn.prepareStatement(query)) {
                stmt.setString(1, userInput);
                try (ResultSet rs = stmt.executeQuery()) {
                    while (rs.next()) {
                        System.out.println(""User: "" + rs.getString(""username""));
                    }
                }
            }
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.Connection; import java.sql.DriverManager; import java.sql.PreparedStatement; import java.sql.ResultSet; import java.sql.SQLException; public class SecureCode { public static void main(String[] args) { String userInput = ""'; DROP TABLE users; --""; // Malicious input simulating a SQL Injection attack try (Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"")) { String query = ""SELECT * FROM users WHERE username=?""; try (PreparedStatement stmt = conn.prepareStatement(query)) { stmt.setString(1, userInput); try (ResultSet rs = stmt.executeQuery()) { while (rs.next()) { System.out.println(""User: "" + rs.getString(""username"")); } } } } catch (SQLException e) { e.printStackTrace(); } } }",java,0
Clear,"import java.sql.*;

public class SecureSQLInjectionExample {
    public static void main(String[] args) {
        String userInput = ""'; DROP TABLE users; --""; // malicious input

        try {
            Connection connection = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");
            String query = ""SELECT * FROM users WHERE username = ?"";
            PreparedStatement preparedStatement = connection.prepareStatement(query);
            preparedStatement.setString(1, userInput);

            ResultSet resultSet = preparedStatement.executeQuery();

            while(resultSet.next()) {
                System.out.println(""Username: "" + resultSet.getString(""username""));
            }

            connection.close();
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.*; public class SecureSQLInjectionExample { public static void main(String[] args) { String userInput = ""'; DROP TABLE users; --""; // malicious input try { Connection connection = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); String query = ""SELECT * FROM users WHERE username = ?""; PreparedStatement preparedStatement = connection.prepareStatement(query); preparedStatement.setString(1, userInput); ResultSet resultSet = preparedStatement.executeQuery(); while(resultSet.next()) { System.out.println(""Username: "" + resultSet.getString(""username"")); } connection.close(); } catch (SQLException e) { e.printStackTrace(); } } }",java,0
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Clear,"import java.io.*;
import javax.servlet.*;
import javax.servlet.http.*;
import org.owasp.encoder.Encode;

public class WelcomeServlet extends HttpServlet {
    protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        String username = request.getParameter(""username"");
        
        response.setContentType(""text/html"");
        PrintWriter out = response.getWriter();
        
        out.println(""<html>"");
        out.println(""<head><title>Welcome Page</title></head>"");
        out.println(""<body>"");
        out.println(""<h1>Welcome "" + Encode.forHtml(username) + ""</h1>""); // Encode user input
        out.println(""</body>"");
        out.println(""</html>"");
    }
}","import java.io.*; import javax.servlet.*; import javax.servlet.http.*; import org.owasp.encoder.Encode; public class WelcomeServlet extends HttpServlet { protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { String username = request.getParameter(""username""); response.setContentType(""text/html""); PrintWriter out = response.getWriter(); out.println(""<html>""); out.println(""<head><title>Welcome Page</title></head>""); out.println(""<body>""); out.println(""<h1>Welcome "" + Encode.forHtml(username) + ""</h1>""); // Encode user input out.println(""</body>""); out.println(""</html>""); } }",java,0
Clear,"#include <iostream>
#include <memory>

void safe_memory_management() {
    auto ptr = std::make_unique<int>(42);
    std::cout << *ptr << std::endl;
}","#include <iostream>
#include <memory>

void safe_memory_management() {
    auto ptr = std::make_unique<int>(42);
    std::cout << *ptr << std::endl;
}",cpp,0
XSS,"<?php
echo $_GET['message']; // XSS
?>","<?php
echo $_GET['message']; // XSS
?>",php,1
XSS,"const userInput = document.location.search.split('=')[1];
document.write(userInput); // XSS
","const userInput = document.location.search.split('=')[1];
document.write(userInput); // XSS
",javascript,1
Command Injection,"import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class CommandInjectionVulnerable {

    public static void main(String[] args) throws IOException {
        BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));

        System.out.print(""Enter a command to execute: "");
        String command = reader.readLine();

        Runtime runtime = Runtime.getRuntime();
        Process process = runtime.exec(command);

        BufferedReader inputReader = new BufferedReader(new InputStreamReader(process.getInputStream()));
        String line;
        
        while ((line = inputReader.readLine()) != null) {
            System.out.println(line);
        }
        
        process.destroy();
    }
}","import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class CommandInjectionVulnerable { public static void main(String[] args) throws IOException { BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a command to execute: ""); String command = reader.readLine(); Runtime runtime = Runtime.getRuntime(); Process process = runtime.exec(command); BufferedReader inputReader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = inputReader.readLine()) != null) { System.out.println(line); } process.destroy(); } }",java,1
Clear,"To fix the Command Injection vulnerability in the provided Java code snippet, you should sanitize and validate user input before constructing the command. Here's an improved version of the code that addresses this security issue:

```java
import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class CommandInjectionSecure {

    public static void main(String[] args) {
        try {
            BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));
            System.out.print(""Enter the IP address to ping: "");
            String ip = reader.readLine();

            // Validate user input to prevent command injection
            if (!isValidIpAddress(ip)) {
                System.out.println(""Invalid IP address. Please enter a valid IP address."");
                return;
            }

            // Secure command execution
            String[] command = {""ping"", ip};
            Process process = new ProcessBuilder(command).start();

            BufferedReader inputReader = new BufferedReader(new InputStreamReader(process.getInputStream()));
            String line;
            while ((line = inputReader.readLine()) != null) {
                System.out.println(line);
            }

        } catch (IOException e) {
            e.printStackTrace();
        }
    }

    private static boolean isValidIpAddress(String ip) {
        // Implement your validation logic for IP address here
        // This","To fix the Command Injection vulnerability in the provided Java code snippet, you should sanitize and validate user input before constructing the command. Here's an improved version of the code that addresses this security issue: ```java import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class CommandInjectionSecure { public static void main(String[] args) { try { BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter the IP address to ping: ""); String ip = reader.readLine(); // Validate user input to prevent command injection if (!isValidIpAddress(ip)) { System.out.println(""Invalid IP address. Please enter a valid IP address.""); return; } // Secure command execution String[] command = {""ping"", ip}; Process process = new ProcessBuilder(command).start(); BufferedReader inputReader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = inputReader.readLine()) != null) { System.out.println(line); } } catch (IOException e) { e.printStackTrace(); } } private static boolean isValidIpAddress(String ip) { // Implement your validation logic for IP address here // This",java,0
Clear,"const shell = require('child_process');
const safeInput = userInput.replace(/[^a-zA-Z0-9.]/g, '');
shell.execFile('ping', [safeInput]); // Safe command execution
","const shell = require('child_process');
const safeInput = userInput.replace(/[^a-zA-Z0-9.]/g, '');
shell.execFile('ping', [safeInput]); // Safe command execution
",javascript,0
Command Injection,"import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class CommandInjectionVulnerability {

    public static void main(String[] args) throws IOException {
        BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));
        
        System.out.print(""Enter a command to execute: "");
        String command = reader.readLine();
        
        // WARNING: Vulnerable code below
        Process process = Runtime.getRuntime().exec(""ping "" + command);
        
        BufferedReader inputReader = new BufferedReader(new InputStreamReader(process.getInputStream()));
        
        String line;
        while ((line = inputReader.readLine()) != null) {
            System.out.println(line);
        }
    }
}","import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class CommandInjectionVulnerability { public static void main(String[] args) throws IOException { BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a command to execute: ""); String command = reader.readLine(); // WARNING: Vulnerable code below Process process = Runtime.getRuntime().exec(""ping "" + command); BufferedReader inputReader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = inputReader.readLine()) != null) { System.out.println(line); } } }",java,1
Clear,"import os
def safe_read_file(filename):
    base_path = '/var/www/uploads/'
    full_path = os.path.join(base_path, filename)
    full_path = os.path.normpath(full_path)
    if not full_path.startswith(base_path):
        raise ValueError(""Path traversal detected"")
    with open(full_path, 'r') as f:
        return f.read()","import os
def safe_read_file(filename):
    base_path = '/var/www/uploads/'
    full_path = os.path.join(base_path, filename)
    full_path = os.path.normpath(full_path)
    if not full_path.startswith(base_path):
        raise ValueError(""Path traversal detected"")
    with open(full_path, 'r') as f:
        return f.read()",python,0
Hardcoded Secrets,"import requests
def call_api():
    api_key = ""sk_live_1234567890abcdef""
    headers = {'Authorization': f'Bearer {api_key}'}
    return requests.get('https://api.example.com/data', headers=headers)","import requests
def call_api():
    api_key = ""sk_live_1234567890abcdef""
    headers = {'Authorization': f'Bearer {api_key}'}
    return requests.get('https://api.example.com/data', headers=headers)",python,1
Clear,"import java.io.*;
import javax.servlet.*;
import javax.servlet.http.*;

public class XSSFixedServlet extends HttpServlet {
    protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        String userInput = request.getParameter(""input"");
        String sanitizedInput = sanitizeInput(userInput);
        String output = ""Hello, "" + sanitizedInput + ""!"";

        response.setContentType(""text/html"");
        PrintWriter out = response.getWriter();
        out.println(""<html>"");
        out.println(""<body>"");
        out.println(""<h1>"" + output + ""</h1>"");
        out.println(""</body>"");
        out.println(""</html>"");
    }

    private String sanitizeInput(String input) {
        // Implement proper input sanitization here
        // For example, you can use OWASP Java Encoder library for HTML escaping:
        return org.owasp.encoder.Encode.forHtml(input);
    }
}","import java.io.*; import javax.servlet.*; import javax.servlet.http.*; public class XSSFixedServlet extends HttpServlet { protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { String userInput = request.getParameter(""input""); String sanitizedInput = sanitizeInput(userInput); String output = ""Hello, "" + sanitizedInput + ""!""; response.setContentType(""text/html""); PrintWriter out = response.getWriter(); out.println(""<html>""); out.println(""<body>""); out.println(""<h1>"" + output + ""</h1>""); out.println(""</body>""); out.println(""</html>""); } private String sanitizeInput(String input) { // Implement proper input sanitization here // For example, you can use OWASP Java Encoder library for HTML escaping: return org.owasp.encoder.Encode.forHtml(input); } }",java,0
Clear,"const userData = JSON.parse(userInput); // Safe JSON parsing
if (userData && typeof userData === 'object') {
    processUserData(userData);
}
","const userData = JSON.parse(userInput); // Safe JSON parsing
if (userData && typeof userData === 'object') {
    processUserData(userData);
}
",javascript,0
Command Injection,"import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class CommandInjectionVulnerable {

    public static void main(String[] args) {
        try {
            BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));
            System.out.print(""Enter a directory name: "");
            String directoryName = reader.readLine();

            // Vulnerable code - directly executing user input as a command
            Process process = Runtime.getRuntime().exec(""ls "" + directoryName);

            BufferedReader processOutputReader = new BufferedReader(new InputStreamReader(process.getInputStream()));
            String line;
            while ((line = processOutputReader.readLine()) != null) {
                System.out.println(line);
            }
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}","import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class CommandInjectionVulnerable { public static void main(String[] args) { try { BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a directory name: ""); String directoryName = reader.readLine(); // Vulnerable code - directly executing user input as a command Process process = Runtime.getRuntime().exec(""ls "" + directoryName); BufferedReader processOutputReader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = processOutputReader.readLine()) != null) { System.out.println(line); } } catch (IOException e) { e.printStackTrace(); } } }",java,1
Clear,"#include <stdio.h>
#include <string.h>

int safe_buffer_operation(char *input) {
    char buffer[100];
    if (strlen(input) < sizeof(buffer)) {
        strcpy(buffer, input);
        return 0;
    }
    return -1; // buffer too small
}","#include <stdio.h>
#include <string.h>

int safe_buffer_operation(char *input) {
    char buffer[100];
    if (strlen(input) < sizeof(buffer)) {
        strcpy(buffer, input);
        return 0;
    }
    return -1; // buffer too small
}",c,0
Hardcoded Secrets,"localStorage.setItem('token', 'hardcoded-secret-token-123'); // Hardcoded secret
","localStorage.setItem('token', 'hardcoded-secret-token-123'); // Hardcoded secret
",javascript,1
Clear,"<?php
$cmd = escapeshellarg($_GET['cmd']);
system(""ls "" . $cmd); // Escaped command
?>","<?php
$cmd = escapeshellarg($_GET['cmd']);
system(""ls "" . $cmd); // Escaped command
?>",php,0
XSS,"const userInput = document.location.search.split('=')[1];
document.write(userInput); // XSS
","const userInput = document.location.search.split('=')[1];
document.write(userInput); // XSS
",javascript,1
Cross-Site Scripting (XSS),"from flask import Flask, request
app = Flask(__name__)

@app.route('/search')
def search():
    query = request.args.get('q', '')
    return f'<h1>Search results for: {query}</h1>'","from flask import Flask, request
app = Flask(__name__)

@app.route('/search')
def search():
    query = request.args.get('q', '')
    return f'<h1>Search results for: {query}</h1>'",python,1
File Inclusion,"<?php
$file = $_GET['file'];
include($file); // File Inclusion
?>","<?php
$file = $_GET['file'];
include($file); // File Inclusion
?>",php,1
Path Traversal,"def get_user_file(username, filepath):
    import os
    base_path = f""/home/{username}/files/""
    full_path = base_path + filepath
    with open(full_path, 'r') as f:
        return f.read()","def get_user_file(username, filepath):
    import os
    base_path = f""/home/{username}/files/""
    full_path = base_path + filepath
    with open(full_path, 'r') as f:
        return f.read()",python,1
Code Injection,"const userData = eval('(' + userInput + ')'); // eval injection
","const userData = eval('(' + userInput + ')'); // eval injection
",javascript,1
Clear,"import java.io.IOException;
import java.io.PrintWriter;

import org.owasp.esapi.ESAPI;

public class SecureXSS {

    public static void main(String[] args) throws IOException {
        // Simulating user input
        String userInput = ""<script>alert('XSS Vulnerability')</script>"";

        // Properly handling user input by escaping it before outputting to web page
        String safeUserInput = ESAPI.encoder().encodeForHTML(userInput);

        PrintWriter out = new PrintWriter(""index.html"");
        out.println(""<html>"");
        out.println(""<head><title>XSS Example</title></head>"");
        out.println(""<body>"");
        out.println(""<h1>Welcome, "" + safeUserInput + ""</h1>"");
        out.println(""</body>"");
        out.println(""</html>"");

        out.close();
    }
}","import java.io.IOException; import java.io.PrintWriter; import org.owasp.esapi.ESAPI; public class SecureXSS { public static void main(String[] args) throws IOException { // Simulating user input String userInput = ""<script>alert('XSS Vulnerability')</script>""; // Properly handling user input by escaping it before outputting to web page String safeUserInput = ESAPI.encoder().encodeForHTML(userInput); PrintWriter out = new PrintWriter(""index.html""); out.println(""<html>""); out.println(""<head><title>XSS Example</title></head>""); out.println(""<body>""); out.println(""<h1>Welcome, "" + safeUserInput + ""</h1>""); out.println(""</body>""); out.println(""</html>""); out.close(); } }",java,0
Command Injection,"import os
def ping_host(host):
    os.system(""ping -c 4 "" + host)","import os
def ping_host(host):
    os.system(""ping -c 4 "" + host)",python,1
Clear,"app.get('/user/:id', (req, res) => {
    const userId = parseInt(req.params.id);
    db.query('SELECT * FROM users WHERE id = ?', [userId], (err, result) => {
        res.json(result);
    });
});
","app.get('/user/:id', (req, res) => {
    const userId = parseInt(req.params.id);
    db.query('SELECT * FROM users WHERE id = ?', [userId], (err, result) => {
        res.json(result);
    });
});
",javascript,0
Clear,"#include <stdio.h>
#include <string.h>

int validate_input(const char *input) {
    if (input == NULL) return 0;
    for (int i = 0; input[i] != '\0'; i++) {
        if (input[i] < 32 || input[i] > 126) {
            return 0; // invalid character
        }
    }
    return 1;
}","#include <stdio.h>
#include <string.h>

int validate_input(const char *input) {
    if (input == NULL) return 0;
    for (int i = 0; input[i] != '\0'; i++) {
        if (input[i] < 32 || input[i] > 126) {
            return 0; // invalid character
        }
    }
    return 1;
}",c,0
Clear,"app.get('/user/:id', (req, res) => {
    const userId = parseInt(req.params.id);
    db.query('SELECT * FROM users WHERE id = ?', [userId], (err, result) => {
        res.json(result);
    });
});
","app.get('/user/:id', (req, res) => {
    const userId = parseInt(req.params.id);
    db.query('SELECT * FROM users WHERE id = ?', [userId], (err, result) => {
        res.json(result);
    });
});
",javascript,0
Clear,"import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class CommandInjectionSecure {

    public static void main(String[] args) {
        try {
            BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));
            
            System.out.print(""Enter a command to execute: "");
            String command = reader.readLine();
            
            // Secure code: using ProcessBuilder to execute commands securely
            ProcessBuilder processBuilder = new ProcessBuilder(command.split("" ""));
            Process process = processBuilder.start();
            
            BufferedReader inputReader = new BufferedReader(new InputStreamReader(process.getInputStream()));
            String line;
            
            while ((line = inputReader.readLine()) != null) {
                System.out.println(line);
            }
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}","import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class CommandInjectionSecure { public static void main(String[] args) { try { BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a command to execute: ""); String command = reader.readLine(); // Secure code: using ProcessBuilder to execute commands securely ProcessBuilder processBuilder = new ProcessBuilder(command.split("" "")); Process process = processBuilder.start(); BufferedReader inputReader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = inputReader.readLine()) != null) { System.out.println(line); } } catch (IOException e) { e.printStackTrace(); } } }",java,0
Clear,"import os
def get_database_config():
    return {
        'host': os.environ.get('DB_HOST'),
        'user': os.environ.get('DB_USER'),
        'password': os.environ.get('DB_PASSWORD')
    }","import os
def get_database_config():
    return {
        'host': os.environ.get('DB_HOST'),
        'user': os.environ.get('DB_USER'),
        'password': os.environ.get('DB_PASSWORD')
    }",python,0
Clear,"#include <stdio.h>
#include <stdlib.h>

void safe_file_operation(const char *filename) {
    FILE *file = fopen(filename, ""r"");
    if (file != NULL) {
        char buffer[256];
        while (fgets(buffer, sizeof(buffer), file)) {
            printf(""%s"", buffer);
        }
        fclose(file);
    }
}","#include <stdio.h>
#include <stdlib.h>

void safe_file_operation(const char *filename) {
    FILE *file = fopen(filename, ""r"");
    if (file != NULL) {
        char buffer[256];
        while (fgets(buffer, sizeof(buffer), file)) {
            printf(""%s"", buffer);
        }
        fclose(file);
    }
}",c,0
Path Traversal,"import java.io.File;
import java.io.FileInputStream;
import java.io.IOException;
import java.util.Scanner;

public class PathTraversalVulnerabilityExample {

    public static void main(String[] args) throws IOException {
        Scanner scanner = new Scanner(System.in);
        System.out.print(""Enter file name: "");
        String fileName = scanner.nextLine();
        
        File file = new File(""/path/to/directory/"" + fileName); // Vulnerable code
        
        FileInputStream fis = new FileInputStream(file);
        int data;
        while ((data = fis.read()) != -1) {
            System.out.print((char) data);
        }
        
        fis.close();
    }
}","import java.io.File; import java.io.FileInputStream; import java.io.IOException; import java.util.Scanner; public class PathTraversalVulnerabilityExample { public static void main(String[] args) throws IOException { Scanner scanner = new Scanner(System.in); System.out.print(""Enter file name: ""); String fileName = scanner.nextLine(); File file = new File(""/path/to/directory/"" + fileName); // Vulnerable code FileInputStream fis = new FileInputStream(file); int data; while ((data = fis.read()) != -1) { System.out.print((char) data); } fis.close(); } }",java,1
Cross-Site Scripting (XSS),"import java.util.Scanner;

public class XSSVulnerableCode {

    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);

        System.out.print(""Enter your name: "");
        String name = scanner.nextLine();

        System.out.println(""Hello, "" + name + ""!""); // This line is vulnerable to XSS
    }
}","import java.util.Scanner; public class XSSVulnerableCode { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter your name: ""); String name = scanner.nextLine(); System.out.println(""Hello, "" + name + ""!""); // This line is vulnerable to XSS } }",java,1
SQL Injection,"app.get('/user/:id', (req, res) => {
    const query = `SELECT * FROM users WHERE id = ${req.params.id}`; // SQL Injection
    db.query(query, (err, result) => {
        res.json(result);
    });
});
","app.get('/user/:id', (req, res) => {
    const query = `SELECT * FROM users WHERE id = ${req.params.id}`; // SQL Injection
    db.query(query, (err, result) => {
        res.json(result);
    });
});
",javascript,1
XSS,"const userInput = document.location.search.split('=')[1];
document.write(userInput); // XSS
","const userInput = document.location.search.split('=')[1];
document.write(userInput); // XSS
",javascript,1
Clear,"<?php
$message = htmlspecialchars($_GET['message'], ENT_QUOTES, 'UTF-8');
echo $message; // Sanitized output
?>","<?php
$message = htmlspecialchars($_GET['message'], ENT_QUOTES, 'UTF-8');
echo $message; // Sanitized output
?>",php,0
Clear,"import org.apache.commons.text.StringEscapeUtils;

public class XSSFixedCode {

    public static void main(String[] args) {
        // Simulating user input from a form field
        String userInput = ""<script>alert('XSS Vulnerability')</script>"";

        // Properly encoding user input to prevent XSS attacks
        String safeUserInput = StringEscapeUtils.escapeHtml4(userInput);

        // Including the safely encoded user input in the output
        String output = ""<div>"" + safeUserInput + ""</div>"";

        // Printing the safe output
        System.out.println(output);
    }
}","import org.apache.commons.text.StringEscapeUtils; public class XSSFixedCode { public static void main(String[] args) { // Simulating user input from a form field String userInput = ""<script>alert('XSS Vulnerability')</script>""; // Properly encoding user input to prevent XSS attacks String safeUserInput = StringEscapeUtils.escapeHtml4(userInput); // Including the safely encoded user input in the output String output = ""<div>"" + safeUserInput + ""</div>""; // Printing the safe output System.out.println(output); } }",java,0
Buffer Overflow,"#include <iostream>
#include <cstdio>

void unsafe_c_input() {
    char buffer[50];
    scanf(""%s"", buffer); // no length limit
    std::cout << buffer << std::endl;
}","#include <iostream>
#include <cstdio>

void unsafe_c_input() {
    char buffer[50];
    scanf(""%s"", buffer); // no length limit
    std::cout << buffer << std::endl;
}",cpp,1
SSRF,"import requests
def fetch_url(url):
    return requests.get(url).text","import requests
def fetch_url(url):
    return requests.get(url).text",python,1
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Clear,"<?php
$file = basename($_GET['file']);
$allowed = ['page1.php', 'page2.php'];
if (in_array($file, $allowed)) {
    include($file);
}
?>","<?php
$file = basename($_GET['file']);
$allowed = ['page1.php', 'page2.php'];
if (in_array($file, $allowed)) {
    include($file);
}
?>",php,0
Clear,"#include <iostream>
#include <fstream>
#include <string>

void safe_file_reading(const std::string& filename) {
    std::ifstream file(filename);
    if (file.is_open()) {
        std::string line;
        while (std::getline(file, line)) {
            std::cout << line << std::endl;
        }
    }
}","#include <iostream>
#include <fstream>
#include <string>

void safe_file_reading(const std::string& filename) {
    std::ifstream file(filename);
    if (file.is_open()) {
        std::string line;
        while (std::getline(file, line)) {
            std::cout << line << std::endl;
        }
    }
}",cpp,0
Clear,"const userInput = new URLSearchParams(window.location.search).get('input');
const safeOutput = document.createElement('div');
safeOutput.textContent = userInput; // Safe DOM manipulation
document.body.appendChild(safeOutput);
","const userInput = new URLSearchParams(window.location.search).get('input');
const safeOutput = document.createElement('div');
safeOutput.textContent = userInput; // Safe DOM manipulation
document.body.appendChild(safeOutput);
",javascript,0
Clear,"To fix the Command Injection vulnerability in the given Java code snippet, you should not directly concatenate user input with the command to be executed. Instead, you should sanitize and validate user input to prevent malicious commands from being injected. Here is an improved version of the code using ProcessBuilder and input validation:

```java
import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class CommandInjectionFixed {
    public static void main(String[] args) {
        try {
            BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));
            
            System.out.print(""Enter a directory name: "");
            String directoryName = reader.readLine();
            
            // Sanitize and validate user input
            if (!isValidDirectoryName(directoryName)) {
                System.out.println(""Invalid directory name."");
                return;
            }
            
            // Use ProcessBuilder to execute the command safely
            ProcessBuilder processBuilder = new ProcessBuilder(""ls"", directoryName);
            Process process = processBuilder.start();
            
            BufferedReader processOutputReader = new BufferedReader(new InputStreamReader(process.getInputStream()));
            
            String line;
            while ((line = processOutputReader.readLine()) != null) {
                System.out.println(line);
            }
            
        } catch (IOException e) {
            e.printStackTrace();","To fix the Command Injection vulnerability in the given Java code snippet, you should not directly concatenate user input with the command to be executed. Instead, you should sanitize and validate user input to prevent malicious commands from being injected. Here is an improved version of the code using ProcessBuilder and input validation: ```java import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class CommandInjectionFixed { public static void main(String[] args) { try { BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a directory name: ""); String directoryName = reader.readLine(); // Sanitize and validate user input if (!isValidDirectoryName(directoryName)) { System.out.println(""Invalid directory name.""); return; } // Use ProcessBuilder to execute the command safely ProcessBuilder processBuilder = new ProcessBuilder(""ls"", directoryName); Process process = processBuilder.start(); BufferedReader processOutputReader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = processOutputReader.readLine()) != null) { System.out.println(line); } } catch (IOException e) { e.printStackTrace();",java,0
Clear,"import java.sql.*;

public class SQLInjectionExample {

    public static void main(String[] args) {
        String userInput = ""admin'; DROP TABLE users; --"";
        
        try {
            Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");
            
            String query = ""SELECT * FROM users WHERE username=?"";
            PreparedStatement pstmt = conn.prepareStatement(query);
            pstmt.setString(1, userInput);
            
            ResultSet rs = pstmt.executeQuery();
            
            while (rs.next()) {
                System.out.println(""User ID: "" + rs.getInt(""id"") + "", Username: "" + rs.getString(""username""));
            }
            
            conn.close();
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.*; public class SQLInjectionExample { public static void main(String[] args) { String userInput = ""admin'; DROP TABLE users; --""; try { Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); String query = ""SELECT * FROM users WHERE username=?""; PreparedStatement pstmt = conn.prepareStatement(query); pstmt.setString(1, userInput); ResultSet rs = pstmt.executeQuery(); while (rs.next()) { System.out.println(""User ID: "" + rs.getInt(""id"") + "", Username: "" + rs.getString(""username"")); } conn.close(); } catch (SQLException e) { e.printStackTrace(); } } }",java,0
Insecure Deserialization,"import pickle
def load_user_data(filename):
    with open(filename, 'rb') as f:
        data = pickle.load(f)
    return data","import pickle
def load_user_data(filename):
    with open(filename, 'rb') as f:
        data = pickle.load(f)
    return data",python,1
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Insecure Deserialization,"import yaml
def load_config(config_str):
    return yaml.load(config_str, Loader=yaml.Loader)","import yaml
def load_config(config_str):
    return yaml.load(config_str, Loader=yaml.Loader)",python,1
SQL Injection,"import psycopg2
def admin_login(admin_id):
    conn = psycopg2.connect(""dbname=test user=postgres"")
    cur = conn.cursor()
    cur.execute(f""SELECT * FROM admins WHERE id = {admin_id}"")
    return cur.fetchone()","import psycopg2
def admin_login(admin_id):
    conn = psycopg2.connect(""dbname=test user=postgres"")
    cur = conn.cursor()
    cur.execute(f""SELECT * FROM admins WHERE id = {admin_id}"")
    return cur.fetchone()",python,1
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
SQL Injection,"import java.sql.*;

public class SQLInjectionVulnerability {

    public static void main(String[] args) {
        String userInput = ""'; DROP TABLE users; --""; // Malicious input
        
        try {
            Connection connection = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");
            Statement statement = connection.createStatement();
            
            String query = ""SELECT * FROM users WHERE username = '"" + userInput + ""'"";
            ResultSet resultSet = statement.executeQuery(query);
            
            while (resultSet.next()) {
                System.out.println(resultSet.getString(""username""));
            }
            
            connection.close();
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.*; public class SQLInjectionVulnerability { public static void main(String[] args) { String userInput = ""'; DROP TABLE users; --""; // Malicious input try { Connection connection = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); Statement statement = connection.createStatement(); String query = ""SELECT * FROM users WHERE username = '"" + userInput + ""'""; ResultSet resultSet = statement.executeQuery(query); while (resultSet.next()) { System.out.println(resultSet.getString(""username"")); } connection.close(); } catch (SQLException e) { e.printStackTrace(); } } }",java,1
Clear,"To fix the Path Traversal vulnerability in the provided Java code snippet, you should ensure that the user input for the file name is properly validated to prevent malicious attempts to access files outside of the intended directory. Here's an improved version of the code with proper security measures implemented:

```java
import java.io.File;
import java.io.IOException;
import java.nio.file.Files;
import java.util.Scanner;

public class SecurePathTraversal {

    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);

        System.out.print(""Enter file name: "");
        String fileName = scanner.nextLine();

        // Validate input to prevent path traversal
        if (!fileName.matches(""[a-zA-Z0-9_\\-\\.]+"")) {
            System.out.println(""Invalid file name."");
            scanner.close();
            return;
        }

        File file = new File(fileName);

        try {
            if (file.exists() && file.getCanonicalPath().startsWith(""/path/to/allowed/directory/"")) {
                System.out.println(""File content:"");
                byte[] fileContent = Files.readAllBytes(file.toPath());
                System.out.println(new String(fileContent));
            } else {
                System.out.println(""File not found or access denied."");
            }","To fix the Path Traversal vulnerability in the provided Java code snippet, you should ensure that the user input for the file name is properly validated to prevent malicious attempts to access files outside of the intended directory. Here's an improved version of the code with proper security measures implemented: ```java import java.io.File; import java.io.IOException; import java.nio.file.Files; import java.util.Scanner; public class SecurePathTraversal { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter file name: ""); String fileName = scanner.nextLine(); // Validate input to prevent path traversal if (!fileName.matches(""[a-zA-Z0-9_\\-\\.]+"")) { System.out.println(""Invalid file name.""); scanner.close(); return; } File file = new File(fileName); try { if (file.exists() && file.getCanonicalPath().startsWith(""/path/to/allowed/directory/"")) { System.out.println(""File content:""); byte[] fileContent = Files.readAllBytes(file.toPath()); System.out.println(new String(fileContent)); } else { System.out.println(""File not found or access denied.""); }",java,0
Command Injection,"import os
def ping_host(host):
    os.system(""ping -c 4 "" + host)","import os
def ping_host(host):
    os.system(""ping -c 4 "" + host)",python,1
Clear,"const userData = JSON.parse(userInput); // Safe JSON parsing
if (userData && typeof userData === 'object') {
    processUserData(userData);
}
","const userData = JSON.parse(userInput); // Safe JSON parsing
if (userData && typeof userData === 'object') {
    processUserData(userData);
}
",javascript,0
Clear,"def safe_comment_display(comment_text):
    import html
    escaped_text = html.escape(comment_text)
    return f""<div class='comment'>{escaped_text}</div>"" ","def safe_comment_display(comment_text):
    import html
    escaped_text = html.escape(comment_text)
    return f""<div class='comment'>{escaped_text}</div>"" ",python,0
Clear,"<?php
$username = $_POST['username'];
$stmt = $pdo->prepare(""SELECT * FROM users WHERE username = ?"");
$stmt->execute([$username]); // Parameterized query
?>","<?php
$username = $_POST['username'];
$stmt = $pdo->prepare(""SELECT * FROM users WHERE username = ?"");
$stmt->execute([$username]); // Parameterized query
?>",php,0
Clear,"import java.io.*;
import javax.servlet.*;
import javax.servlet.http.*;

public class XSSFixedServlet extends HttpServlet {

    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        response.setContentType(""text/html"");
        PrintWriter out = response.getWriter();

        String userInput = request.getParameter(""input"");

        out.println(""<html>"");
        out.println(""<head><title>XSS Fixed Page</title></head>"");
        out.println(""<body>"");

        // Displaying user input with proper encoding
        out.println(""<h1>User Input: "" + encodeHtml(userInput) + ""</h1>"");

        out.println(""</body>"");
        out.println(""</html>"");
    }

    private String encodeHtml(String input) {
        return input != null ? input.replace(""&"", ""&amp;"")
                                    .replace(""<"", ""&lt;"")
                                    .replace("">"", ""&gt;"")
                                    .replace(""\"""", ""&quot;"")
                                    .replace(""'"", ""&#39;"") : """";
    }
}","import java.io.*; import javax.servlet.*; import javax.servlet.http.*; public class XSSFixedServlet extends HttpServlet { protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { response.setContentType(""text/html""); PrintWriter out = response.getWriter(); String userInput = request.getParameter(""input""); out.println(""<html>""); out.println(""<head><title>XSS Fixed Page</title></head>""); out.println(""<body>""); // Displaying user input with proper encoding out.println(""<h1>User Input: "" + encodeHtml(userInput) + ""</h1>""); out.println(""</body>""); out.println(""</html>""); } private String encodeHtml(String input) { return input != null ? input.replace(""&"", ""&amp;"") .replace(""<"", ""&lt;"") .replace("">"", ""&gt;"") .replace(""\"""", ""&quot;"") .replace(""'"", ""&#39;"") : """"; } }",java,0
Buffer Overflow,"#include <iostream>
#include <cstdio>

void unsafe_c_input() {
    char buffer[50];
    scanf(""%s"", buffer); // no length limit
    std::cout << buffer << std::endl;
}","#include <iostream>
#include <cstdio>

void unsafe_c_input() {
    char buffer[50];
    scanf(""%s"", buffer); // no length limit
    std::cout << buffer << std::endl;
}",cpp,1
Clear,"import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.ResultSet;

public class SecureCode {

    public static void main(String[] args) {
        String userInput = ""'; DROP TABLE users; --"";

        try {
            Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");

            String query = ""SELECT * FROM users WHERE username = ?"";
            PreparedStatement pstmt = conn.prepareStatement(query);
            pstmt.setString(1, userInput);

            ResultSet rs = pstmt.executeQuery();

            while (rs.next()) {
                System.out.println(rs.getString(""username""));
            }

            conn.close();
        } catch (Exception e) {
            e.printStackTrace();
        }
    }
}","import java.sql.Connection; import java.sql.DriverManager; import java.sql.PreparedStatement; import java.sql.ResultSet; public class SecureCode { public static void main(String[] args) { String userInput = ""'; DROP TABLE users; --""; try { Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); String query = ""SELECT * FROM users WHERE username = ?""; PreparedStatement pstmt = conn.prepareStatement(query); pstmt.setString(1, userInput); ResultSet rs = pstmt.executeQuery(); while (rs.next()) { System.out.println(rs.getString(""username"")); } conn.close(); } catch (Exception e) { e.printStackTrace(); } } }",java,0
Clear,"#include <iostream>
#include <sstream>

int safe_string_to_int(const std::string& str) {
    std::stringstream ss(str);
    int value;
    if (ss >> value) {
        return value;
    }
    throw std::invalid_argument(""Invalid integer"");
}","#include <iostream>
#include <sstream>

int safe_string_to_int(const std::string& str) {
    std::stringstream ss(str);
    int value;
    if (ss >> value) {
        return value;
    }
    throw std::invalid_argument(""Invalid integer"");
}",cpp,0
Clear,"Insecure deserialization is a serious security vulnerability that can lead to remote code execution and other attacks. To fix this code and prevent such vulnerabilities, you should implement proper security measures. Here are some suggestions to secure the deserialization process in Java:

1. **Use Whitelisting**: Implement a whitelist of allowed classes that can be deserialized. Restrict the deserialization process to only deserialize objects of specific classes that are known and trusted.

2. **Input Validation**: Validate the input data before deserialization to ensure it comes from a trusted and authenticated source. Do not deserialize untrusted or arbitrary data.

3. **Use Secure Serialization Libraries**: Consider using secure serialization libraries like Google's Protocol Buffers or Apache Avro which provide better security features compared to Java serialization.

4. **Implement Signing/Encryption**: Sign the serialized data using digital signatures or encrypt it before deserialization. Verify the integrity of the data and ensure it has not been tampered with.

5. **Implement Custom Serialization**: Implement custom serialization for classes that need to be serialized/deserialized, which allows you to control the process and enforce security checks.

6. **Sanitize Input**: If deserializing user input, sanitize the input data to prevent injection attacks or unexpected behavior","Insecure deserialization is a serious security vulnerability that can lead to remote code execution and other attacks. To fix this code and prevent such vulnerabilities, you should implement proper security measures. Here are some suggestions to secure the deserialization process in Java: 1. **Use Whitelisting**: Implement a whitelist of allowed classes that can be deserialized. Restrict the deserialization process to only deserialize objects of specific classes that are known and trusted. 2. **Input Validation**: Validate the input data before deserialization to ensure it comes from a trusted and authenticated source. Do not deserialize untrusted or arbitrary data. 3. **Use Secure Serialization Libraries**: Consider using secure serialization libraries like Google's Protocol Buffers or Apache Avro which provide better security features compared to Java serialization. 4. **Implement Signing/Encryption**: Sign the serialized data using digital signatures or encrypt it before deserialization. Verify the integrity of the data and ensure it has not been tampered with. 5. **Implement Custom Serialization**: Implement custom serialization for classes that need to be serialized/deserialized, which allows you to control the process and enforce security checks. 6. **Sanitize Input**: If deserializing user input, sanitize the input data to prevent injection attacks or unexpected behavior",php,0
Memory Corruption,"#include <iostream>

void unsafe_virtual_call() {
    // Potential vtable corruption vulnerability
    class Base {
    public:
        virtual void func() { std::cout << ""Base"" << std::endl; }
    };
    
    class Derived : public Base {
    public:
        void func() override { std::cout << ""Derived"" << std::endl; }
    };
}","#include <iostream>

void unsafe_virtual_call() {
    // Potential vtable corruption vulnerability
    class Base {
    public:
        virtual void func() { std::cout << ""Base"" << std::endl; }
    };
    
    class Derived : public Base {
    public:
        void func() override { std::cout << ""Derived"" << std::endl; }
    };
}",cpp,1
Path Traversal,"import java.io.File;
import java.io.FileInputStream;
import java.io.IOException;
import java.util.Scanner;

public class PathTraversalVulnerable {

    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        System.out.println(""Enter the file name to read: "");
        String fileName = scanner.nextLine();

        try {
            File file = new File(""/path/to/files/"" + fileName);
            FileInputStream fileInputStream = new FileInputStream(file);
            int data;
            while ((data = fileInputStream.read()) != -1) {
                System.out.print((char) data);
            }
            fileInputStream.close();
        } catch (IOException e) {
            System.out.println(""Error reading file: "" + e.getMessage());
        }
    }
}","import java.io.File; import java.io.FileInputStream; import java.io.IOException; import java.util.Scanner; public class PathTraversalVulnerable { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.println(""Enter the file name to read: ""); String fileName = scanner.nextLine(); try { File file = new File(""/path/to/files/"" + fileName); FileInputStream fileInputStream = new FileInputStream(file); int data; while ((data = fileInputStream.read()) != -1) { System.out.print((char) data); } fileInputStream.close(); } catch (IOException e) { System.out.println(""Error reading file: "" + e.getMessage()); } } }",java,1
Clear,"const userData = JSON.parse(userInput); // Safe JSON parsing
if (userData && typeof userData === 'object') {
    processUserData(userData);
}
","const userData = JSON.parse(userInput); // Safe JSON parsing
if (userData && typeof userData === 'object') {
    processUserData(userData);
}
",javascript,0
Command Injection,"import java.io.*;

public class CommandInjectionVulnerability {
    public static void main(String[] args) {
        try {
            BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));
            System.out.print(""Enter a command to execute: "");
            String userInput = reader.readLine();

            // Vulnerable code: directly concatenating user input into the command
            String command = ""ls "" + userInput;
            
            Process process = Runtime.getRuntime().exec(command);
            BufferedReader processOutputReader = new BufferedReader(new InputStreamReader(process.getInputStream()));
            
            String line;
            while ((line = processOutputReader.readLine()) != null) {
                System.out.println(line);
            }
            
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}","import java.io.*; public class CommandInjectionVulnerability { public static void main(String[] args) { try { BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a command to execute: ""); String userInput = reader.readLine(); // Vulnerable code: directly concatenating user input into the command String command = ""ls "" + userInput; Process process = Runtime.getRuntime().exec(command); BufferedReader processOutputReader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = processOutputReader.readLine()) != null) { System.out.println(line); } } catch (IOException e) { e.printStackTrace(); } } }",java,1
Clear,"import os
def get_api_key():
    return os.environ.get('API_KEY')","import os
def get_api_key():
    return os.environ.get('API_KEY')",python,0
Out-of-Bounds,"#include <iostream>

class UnsafeClass {
    int data[10];
public:
    int get_data(int index) {
        return data[index]; // no bounds checking
    }
};","#include <iostream>

class UnsafeClass {
    int data[10];
public:
    int get_data(int index) {
        return data[index]; // no bounds checking
    }
};",cpp,1
SQL Injection,"import java.sql.*;

public class SQLInjectionVulnerable {
    public static void main(String[] args) {
        String username = ""admin'; DROP TABLE users; --"";
        String password = ""password123"";

        try {
            Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""root"", ""password"");
            Statement stmt = conn.createStatement();

            String query = ""SELECT * FROM users WHERE username='"" + username + ""' AND password='"" + password + ""'"";
            ResultSet rs = stmt.executeQuery(query);

            while (rs.next()) {
                System.out.println(rs.getString(""username""));
            }

            conn.close();
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.*; public class SQLInjectionVulnerable { public static void main(String[] args) { String username = ""admin'; DROP TABLE users; --""; String password = ""password123""; try { Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""root"", ""password""); Statement stmt = conn.createStatement(); String query = ""SELECT * FROM users WHERE username='"" + username + ""' AND password='"" + password + ""'""; ResultSet rs = stmt.executeQuery(query); while (rs.next()) { System.out.println(rs.getString(""username"")); } conn.close(); } catch (SQLException e) { e.printStackTrace(); } } }",java,1
Clear,"#include <stdio.h>
#include <stdlib.h>

void safe_file_operation(const char *filename) {
    FILE *file = fopen(filename, ""r"");
    if (file != NULL) {
        char buffer[256];
        while (fgets(buffer, sizeof(buffer), file)) {
            printf(""%s"", buffer);
        }
        fclose(file);
    }
}","#include <stdio.h>
#include <stdlib.h>

void safe_file_operation(const char *filename) {
    FILE *file = fopen(filename, ""r"");
    if (file != NULL) {
        char buffer[256];
        while (fgets(buffer, sizeof(buffer), file)) {
            printf(""%s"", buffer);
        }
        fclose(file);
    }
}",c,0
Command Injection,"import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class CommandInjectionExample {
    public static void main(String[] args) throws IOException {
        BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));
        
        System.out.print(""Enter a command to execute: "");
        String command = reader.readLine();
        
        Process process = Runtime.getRuntime().exec(""ping "" + command);
        
        BufferedReader inputReader = new BufferedReader(new InputStreamReader(process.getInputStream()));
        String line;
        
        while ((line = inputReader.readLine()) != null) {
            System.out.println(line);
        }
    }
}","import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class CommandInjectionExample { public static void main(String[] args) throws IOException { BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a command to execute: ""); String command = reader.readLine(); Process process = Runtime.getRuntime().exec(""ping "" + command); BufferedReader inputReader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = inputReader.readLine()) != null) { System.out.println(line); } } }",java,1
Clear,"import requests
def safe_api_call():
    api_key = os.environ.get('API_KEY')
    headers = {'Authorization': f'Bearer {api_key}'}
    return requests.get('https://api.example.com/data', headers=headers)","import requests
def safe_api_call():
    api_key = os.environ.get('API_KEY')
    headers = {'Authorization': f'Bearer {api_key}'}
    return requests.get('https://api.example.com/data', headers=headers)",python,0
Out-of-Bounds,"#include <iostream>

class UnsafeClass {
    int data[10];
public:
    int get_data(int index) {
        return data[index]; // no bounds checking
    }
};","#include <iostream>

class UnsafeClass {
    int data[10];
public:
    int get_data(int index) {
        return data[index]; // no bounds checking
    }
};",cpp,1
Hardcoded Secrets,"DATABASE_PASSWORD = ""my_super_secret_password_123""
def db_connect():
    import psycopg2
    return psycopg2.connect(f""dbname=test user=admin password={DATABASE_PASSWORD}"")","DATABASE_PASSWORD = ""my_super_secret_password_123""
def db_connect():
    import psycopg2
    return psycopg2.connect(f""dbname=test user=admin password={DATABASE_PASSWORD}"")",python,1
Clear,"app.get('/user/:id', (req, res) => {
    const userId = parseInt(req.params.id);
    db.query('SELECT * FROM users WHERE id = ?', [userId], (err, result) => {
        res.json(result);
    });
});
","app.get('/user/:id', (req, res) => {
    const userId = parseInt(req.params.id);
    db.query('SELECT * FROM users WHERE id = ?', [userId], (err, result) => {
        res.json(result);
    });
});
",javascript,0
Cross-Site Scripting (XSS),"from flask import Flask, request
app = Flask(__name__)

@app.route('/search')
def search():
    query = request.args.get('q', '')
    return f'<h1>Search results for: {query}</h1>'","from flask import Flask, request
app = Flask(__name__)

@app.route('/search')
def search():
    query = request.args.get('q', '')
    return f'<h1>Search results for: {query}</h1>'",python,1
Clear,"def validate_input(input_str):
    if not isinstance(input_str, str):
        raise TypeError(""Input must be string"")
    if len(input_str) > 100:
        raise ValueError(""Input too long"")
    if '<script>' in input_str.lower():
        raise ValueError(""Invalid input"")
    return input_str.strip()","def validate_input(input_str):
    if not isinstance(input_str, str):
        raise TypeError(""Input must be string"")
    if len(input_str) > 100:
        raise ValueError(""Input too long"")
    if '<script>' in input_str.lower():
        raise ValueError(""Invalid input"")
    return input_str.strip()",python,0
Clear,"To fix the Command Injection vulnerability in the given Java code snippet, you should sanitize and validate the input before executing the command. One way to do this is by using a white list approach where you define a set of allowed commands and only allow those commands to be executed. Here's an updated version of the code with proper security measures:

```java
import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;
import java.util.regex.Pattern;

public class SecureCommandExecution {

    private static final Pattern SAFE_COMMAND_PATTERN = Pattern.compile(""^[a-zA-Z0-9./_-]*$"");

    public static void main(String[] args) {
        try {
            BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));
            System.out.print(""Enter a command to execute: "");
            String command = reader.readLine();

            if (!isSafeCommand(command)) {
                System.out.println(""Invalid command. Only alphanumeric characters, '.', '/', '_', and '-' are allowed."");
                return;
            }

            Process process = Runtime.getRuntime().exec(""ls "" + command);

            BufferedReader processOutputReader = new BufferedReader(new InputStreamReader(process.getInputStream()));
            String line;
            while ((line = processOutputReader.readLine()) != null) {
                System.out.println(line);","To fix the Command Injection vulnerability in the given Java code snippet, you should sanitize and validate the input before executing the command. One way to do this is by using a white list approach where you define a set of allowed commands and only allow those commands to be executed. Here's an updated version of the code with proper security measures: ```java import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; import java.util.regex.Pattern; public class SecureCommandExecution { private static final Pattern SAFE_COMMAND_PATTERN = Pattern.compile(""^[a-zA-Z0-9./_-]*$""); public static void main(String[] args) { try { BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a command to execute: ""); String command = reader.readLine(); if (!isSafeCommand(command)) { System.out.println(""Invalid command. Only alphanumeric characters, '.', '/', '_', and '-' are allowed.""); return; } Process process = Runtime.getRuntime().exec(""ls "" + command); BufferedReader processOutputReader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = processOutputReader.readLine()) != null) { System.out.println(line);",java,0
Clear,"def safe_division(a, b):
    if b == 0:
        raise ValueError(""Division by zero"")
    return a / b","def safe_division(a, b):
    if b == 0:
        raise ValueError(""Division by zero"")
    return a / b",python,0
Command Injection,"const shell = require('child_process');
shell.exec('ping ' + userInput); // Command Injection
","const shell = require('child_process');
shell.exec('ping ' + userInput); // Command Injection
",javascript,1
Memory Corruption,"#include <iostream>

void unsafe_pointer_arithmetic(int* array, int size) {
    for (int i = 0; i <= size; i++) {
        std::cout << *(array + i) << std::endl; // potential out-of-bounds
    }
}","#include <iostream>

void unsafe_pointer_arithmetic(int* array, int size) {
    for (int i = 0; i <= size; i++) {
        std::cout << *(array + i) << std::endl; // potential out-of-bounds
    }
}",cpp,1
Clear,"#include <iostream>
#include <string>
#include <vector>

void safe_string_handling(const std::string& input) {
    std::string safe_copy = input;
    std::cout << safe_copy << std::endl;
}","#include <iostream>
#include <string>
#include <vector>

void safe_string_handling(const std::string& input) {
    std::string safe_copy = input;
    std::cout << safe_copy << std::endl;
}",cpp,0
Clear,"import mysql.connector
def safe_product_search(category):
    db = mysql.connector.connect(host=""localhost"", user=""user"", password=""pass"", database=""shop"")
    cursor = db.cursor()
    cursor.execute(""SELECT * FROM products WHERE category = %s"", (category,))
    return cursor.fetchall()","import mysql.connector
def safe_product_search(category):
    db = mysql.connector.connect(host=""localhost"", user=""user"", password=""pass"", database=""shop"")
    cursor = db.cursor()
    cursor.execute(""SELECT * FROM products WHERE category = %s"", (category,))
    return cursor.fetchall()",python,0
Clear,"import java.sql.*;

public class SQLInjectionSecureExample {
    public static void main(String[] args) {
        String userInput = ""'; DROP TABLE users; --""; // Malicious input

        String query = ""SELECT * FROM users WHERE username = ?"";
        
        try (Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");
             PreparedStatement pstmt = conn.prepareStatement(query)) {
             
            pstmt.setString(1, userInput);

            try (ResultSet rs = pstmt.executeQuery()) {
                while (rs.next()) {
                    System.out.println(rs.getString(""username"") + "" - "" + rs.getString(""email""));
                }
            }
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.*; public class SQLInjectionSecureExample { public static void main(String[] args) { String userInput = ""'; DROP TABLE users; --""; // Malicious input String query = ""SELECT * FROM users WHERE username = ?""; try (Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); PreparedStatement pstmt = conn.prepareStatement(query)) { pstmt.setString(1, userInput); try (ResultSet rs = pstmt.executeQuery()) { while (rs.next()) { System.out.println(rs.getString(""username"") + "" - "" + rs.getString(""email"")); } } } catch (SQLException e) { e.printStackTrace(); } } }",java,0
Clear,"#include <stdio.h>
#include <string.h>

void safe_string_copy(char *dest, const char *src, size_t dest_size) {
    if (dest_size > 0) {
        strncpy(dest, src, dest_size - 1);
        dest[dest_size - 1] = '\0';
    }
}","#include <stdio.h>
#include <string.h>

void safe_string_copy(char *dest, const char *src, size_t dest_size) {
    if (dest_size > 0) {
        strncpy(dest, src, dest_size - 1);
        dest[dest_size - 1] = '\0';
    }
}",c,0
Insecure Deserialization,"Certainly! Here's a Java code snippet demonstrating a vulnerability related to Insecure Deserialization:

```java
import java.io.*;

public class InsecureDeserializationExample {

    public static void main(String[] args) {
        try {
            // Simulating user input as a serialized object
            String userInput = ""rO0ABXNyABdqYXZhLnV0aWwuUHJpb3JpdHl0eXBlSW1wbAAAAAAAAAABAgACUwAEaW1wbAlpMAAJdGhyZXNob2xkcQB+AAF4cgATamF2YS5sYW5nLkludGVnZXIS4qCk94GHOAIAAUkABHNyADZqYXZhLmxhbmcuT2JqZWN0JFhNYW5hZ2VMAAAAAAAAAAABAgAGSQAJdHJhbnNmb3JtAANvdXIAAltCrPMX+AYIVOACAAB4cAAAAAEwcQB+AAQ="";
            
            // Deserialize the user input
            ByteArrayInputStream bis = new ByteArrayInputStream(Base64.getDecoder().decode(userInput));","Certainly! Here's a Java code snippet demonstrating a vulnerability related to Insecure Deserialization: ```java import java.io.*; public class InsecureDeserializationExample { public static void main(String[] args) { try { // Simulating user input as a serialized object String userInput = ""rO0ABXNyABdqYXZhLnV0aWwuUHJpb3JpdHl0eXBlSW1wbAAAAAAAAAABAgACUwAEaW1wbAlpMAAJdGhyZXNob2xkcQB+AAF4cgATamF2YS5sYW5nLkludGVnZXIS4qCk94GHOAIAAUkABHNyADZqYXZhLmxhbmcuT2JqZWN0JFhNYW5hZ2VMAAAAAAAAAAABAgAGSQAJdHJhbnNmb3JtAANvdXIAAltCrPMX+AYIVOACAAB4cAAAAAEwcQB+AAQ=""; // Deserialize the user input ByteArrayInputStream bis = new ByteArrayInputStream(Base64.getDecoder().decode(userInput));",java,1
Cross-Site Scripting (XSS),"import java.io.*;
import javax.servlet.*;
import javax.servlet.http.*;

public class VulnerableServlet extends HttpServlet {
    protected void doGet(HttpServletRequest request, HttpServletResponse response)
            throws ServletException, IOException {
        
        String userInput = request.getParameter(""input"");
        
        String output = ""<html><body>User input: "" + userInput + ""</body></html>"";
        
        PrintWriter out = response.getWriter();
        out.println(output);
    }
}","import java.io.*; import javax.servlet.*; import javax.servlet.http.*; public class VulnerableServlet extends HttpServlet { protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { String userInput = request.getParameter(""input""); String output = ""<html><body>User input: "" + userInput + ""</body></html>""; PrintWriter out = response.getWriter(); out.println(output); } }",java,1
Command Injection,"const shell = require('child_process');
shell.exec('ping ' + userInput); // Command Injection
","const shell = require('child_process');
shell.exec('ping ' + userInput); // Command Injection
",javascript,1
Path Traversal,"import java.io.File;
import java.io.FileInputStream;
import java.io.IOException;
import java.util.Scanner;

public class PathTraversalVulnerability {

    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        
        System.out.println(""Enter the file name:"");
        String fileName = scanner.nextLine();
        
        // Vulnerability: User input is directly used to construct the file path without proper validation
        String filePath = ""C:/files/"" + fileName; 
        
        try {
            File file = new File(filePath);
            FileInputStream fis = new FileInputStream(file);
            
            int content;
            while ((content = fis.read()) != -1) {
                System.out.print((char) content);
            }
            
            fis.close();
        } catch (IOException e) {
            System.err.println(""Error reading file: "" + e.getMessage());
        }
    }
}","import java.io.File; import java.io.FileInputStream; import java.io.IOException; import java.util.Scanner; public class PathTraversalVulnerability { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.println(""Enter the file name:""); String fileName = scanner.nextLine(); // Vulnerability: User input is directly used to construct the file path without proper validation String filePath = ""C:/files/"" + fileName; try { File file = new File(filePath); FileInputStream fis = new FileInputStream(file); int content; while ((content = fis.read()) != -1) { System.out.print((char) content); } fis.close(); } catch (IOException e) { System.err.println(""Error reading file: "" + e.getMessage()); } } }",java,1
Clear,"import psycopg2
def safe_admin_query(admin_id):
    conn = psycopg2.connect(""dbname=test user=postgres"")
    cur = conn.cursor()
    cur.execute(""SELECT * FROM admins WHERE id = %s"", (admin_id,))
    return cur.fetchone()","import psycopg2
def safe_admin_query(admin_id):
    conn = psycopg2.connect(""dbname=test user=postgres"")
    cur = conn.cursor()
    cur.execute(""SELECT * FROM admins WHERE id = %s"", (admin_id,))
    return cur.fetchone()",python,0
Clear,"To fix the code and prevent Path Traversal vulnerabilities, you should not allow the user to input arbitrary file paths. Instead, you can validate and restrict the input file name to a specific directory or a predefined list of files. Here's an updated version of the code with security measures implemented:

```java
import java.io.File;
import java.io.FileInputStream;
import java.io.IOException;
import java.util.Scanner;

public class PathTraversalExample {

    private static final String BASE_DIRECTORY = ""C:\\data\\"";

    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        System.out.print(""Enter file name: "");
        String fileName = scanner.nextLine();

        if (!isValidFileName(fileName)) {
            System.err.println(""Invalid file name"");
            return;
        }

        File file = new File(BASE_DIRECTORY + fileName);

        try (FileInputStream fis = new FileInputStream(file)) {
            int content;
            while ((content = fis.read()) != -1) {
                System.out.print((char) content);
            }
        } catch (IOException e) {
            System.err.println(""Error reading file: "" + e.getMessage());
        }
    }

    private static boolean isValidFileName(String fileName) {
        // Implement validation","To fix the code and prevent Path Traversal vulnerabilities, you should not allow the user to input arbitrary file paths. Instead, you can validate and restrict the input file name to a specific directory or a predefined list of files. Here's an updated version of the code with security measures implemented: ```java import java.io.File; import java.io.FileInputStream; import java.io.IOException; import java.util.Scanner; public class PathTraversalExample { private static final String BASE_DIRECTORY = ""C:\\data\\""; public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter file name: ""); String fileName = scanner.nextLine(); if (!isValidFileName(fileName)) { System.err.println(""Invalid file name""); return; } File file = new File(BASE_DIRECTORY + fileName); try (FileInputStream fis = new FileInputStream(file)) { int content; while ((content = fis.read()) != -1) { System.out.print((char) content); } } catch (IOException e) { System.err.println(""Error reading file: "" + e.getMessage()); } } private static boolean isValidFileName(String fileName) { // Implement validation",java,0
Buffer Overflow,"import java.util.Scanner;

public class BufferOverflowVulnerability {

    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);

        System.out.print(""Enter a string: "");
        String userInput = scanner.nextLine();

        char[] buffer = new char[10];
        userInput.getChars(0, userInput.length(), buffer, 0);

        // This loop should only print the first 10 characters of the user input
        for (int i = 0; i < 15; i++) {
            System.out.print(buffer[i]);
        }

        scanner.close();
    }
}","import java.util.Scanner; public class BufferOverflowVulnerability { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter a string: ""); String userInput = scanner.nextLine(); char[] buffer = new char[10]; userInput.getChars(0, userInput.length(), buffer, 0); // This loop should only print the first 10 characters of the user input for (int i = 0; i < 15; i++) { System.out.print(buffer[i]); } scanner.close(); } }",java,1
Memory Corruption,"#include <iostream>

void unsafe_pointer_arithmetic(int* array, int size) {
    for (int i = 0; i <= size; i++) {
        std::cout << *(array + i) << std::endl; // potential out-of-bounds
    }
}","#include <iostream>

void unsafe_pointer_arithmetic(int* array, int size) {
    for (int i = 0; i <= size; i++) {
        std::cout << *(array + i) << std::endl; // potential out-of-bounds
    }
}",cpp,1
Buffer Overflow,"#include <iostream>
#include <cstring>

void unsafe_c_string(char* input) {
    char buffer[100];
    strcpy(buffer, input); // potential buffer overflow
    std::cout << buffer << std::endl;
}","#include <iostream>
#include <cstring>

void unsafe_c_string(char* input) {
    char buffer[100];
    strcpy(buffer, input); // potential buffer overflow
    std::cout << buffer << std::endl;
}",cpp,1
Command Injection,"const shell = require('child_process');
shell.exec('ping ' + userInput); // Command Injection
","const shell = require('child_process');
shell.exec('ping ' + userInput); // Command Injection
",javascript,1
Clear,"To secure the code against Path Traversal vulnerability, you should validate and sanitize the input file name to ensure that it does not contain any relative path elements. Here is an improved version of the code that addresses this issue:

```java
import java.io.File;
import java.io.IOException;
import java.nio.file.Files;
import java.util.Scanner;

public class SecurePathTraversal {

    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        System.out.print(""Enter file name: "");
        String fileName = scanner.nextLine();

        // Validate and sanitize the input file name
        if (!isValidFileName(fileName)) {
            System.out.println(""Invalid file name."");
            return;
        }

        File file = new File(fileName);

        try {
            if (file.exists()) {
                byte[] fileData = Files.readAllBytes(file.toPath());
                String fileContent = new String(fileData);
                System.out.println(""File content: "" + fileContent);
            } else {
                System.out.println(""File does not exist."");
            }
        } catch (IOException e) {
            System.out.println(""An error occurred: "" + e.getMessage());
        }

        scanner.close();
    }

    private static boolean isValidFileName(String","To secure the code against Path Traversal vulnerability, you should validate and sanitize the input file name to ensure that it does not contain any relative path elements. Here is an improved version of the code that addresses this issue: ```java import java.io.File; import java.io.IOException; import java.nio.file.Files; import java.util.Scanner; public class SecurePathTraversal { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter file name: ""); String fileName = scanner.nextLine(); // Validate and sanitize the input file name if (!isValidFileName(fileName)) { System.out.println(""Invalid file name.""); return; } File file = new File(fileName); try { if (file.exists()) { byte[] fileData = Files.readAllBytes(file.toPath()); String fileContent = new String(fileData); System.out.println(""File content: "" + fileContent); } else { System.out.println(""File does not exist.""); } } catch (IOException e) { System.out.println(""An error occurred: "" + e.getMessage()); } scanner.close(); } private static boolean isValidFileName(String",java,0
Clear,"#include <iostream>
#include <string>
#include <vector>

void safe_string_handling(const std::string& input) {
    std::string safe_copy = input;
    std::cout << safe_copy << std::endl;
}","#include <iostream>
#include <string>
#include <vector>

void safe_string_handling(const std::string& input) {
    std::string safe_copy = input;
    std::cout << safe_copy << std::endl;
}",cpp,0
Insecure Deserialization,"<?php
$data = $_POST['data'];
unserialize($data); // Insecure Deserialization
?>","<?php
$data = $_POST['data'];
unserialize($data); // Insecure Deserialization
?>",php,1
Buffer Overflow,"#include <iostream>
#include <cstring>

void unsafe_c_string(char* input) {
    char buffer[100];
    strcpy(buffer, input); // potential buffer overflow
    std::cout << buffer << std::endl;
}","#include <iostream>
#include <cstring>

void unsafe_c_string(char* input) {
    char buffer[100];
    strcpy(buffer, input); // potential buffer overflow
    std::cout << buffer << std::endl;
}",cpp,1
Clear,"#include <iostream>
#include <memory>

void safe_memory_management() {
    auto ptr = std::make_unique<int>(42);
    std::cout << *ptr << std::endl;
}","#include <iostream>
#include <memory>

void safe_memory_management() {
    auto ptr = std::make_unique<int>(42);
    std::cout << *ptr << std::endl;
}",cpp,0
Clear,"import sqlite3
def get_user_data_safe(username):
    conn = sqlite3.connect('database.db')
    cursor = conn.cursor()
    query = ""SELECT * FROM users WHERE username = ?""
    cursor.execute(query, (username,))
    return cursor.fetchall()","import sqlite3
def get_user_data_safe(username):
    conn = sqlite3.connect('database.db')
    cursor = conn.cursor()
    query = ""SELECT * FROM users WHERE username = ?""
    cursor.execute(query, (username,))
    return cursor.fetchall()",python,0
Clear,"#include <stdio.h>
#include <string.h>

int safe_buffer_operation(char *input) {
    char buffer[100];
    if (strlen(input) < sizeof(buffer)) {
        strcpy(buffer, input);
        return 0;
    }
    return -1; // buffer too small
}","#include <stdio.h>
#include <string.h>

int safe_buffer_operation(char *input) {
    char buffer[100];
    if (strlen(input) < sizeof(buffer)) {
        strcpy(buffer, input);
        return 0;
    }
    return -1; // buffer too small
}",c,0
Clear,"def validate_input(input_str):
    if not isinstance(input_str, str):
        raise TypeError(""Input must be string"")
    if len(input_str) > 100:
        raise ValueError(""Input too long"")
    if '<script>' in input_str.lower():
        raise ValueError(""Invalid input"")
    return input_str.strip()","def validate_input(input_str):
    if not isinstance(input_str, str):
        raise TypeError(""Input must be string"")
    if len(input_str) > 100:
        raise ValueError(""Input too long"")
    if '<script>' in input_str.lower():
        raise ValueError(""Invalid input"")
    return input_str.strip()",python,0
Clear,"const userInput = new URLSearchParams(window.location.search).get('input');
const safeOutput = document.createElement('div');
safeOutput.textContent = userInput; // Safe DOM manipulation
document.body.appendChild(safeOutput);
","const userInput = new URLSearchParams(window.location.search).get('input');
const safeOutput = document.createElement('div');
safeOutput.textContent = userInput; // Safe DOM manipulation
document.body.appendChild(safeOutput);
",javascript,0
Clear,"#include <stdio.h>
#include <string.h>

int safe_buffer_operation(char *input) {
    char buffer[100];
    if (strlen(input) < sizeof(buffer)) {
        strcpy(buffer, input);
        return 0;
    }
    return -1; // buffer too small
}","#include <stdio.h>
#include <string.h>

int safe_buffer_operation(char *input) {
    char buffer[100];
    if (strlen(input) < sizeof(buffer)) {
        strcpy(buffer, input);
        return 0;
    }
    return -1; // buffer too small
}",c,0
Clear,"#include <iostream>
#include <vector>
#include <stdexcept>

int safe_vector_access(const std::vector<int>& vec, size_t index) {
    if (index >= vec.size()) {
        throw std::out_of_range(""Index out of range"");
    }
    return vec[index];
}","#include <iostream>
#include <vector>
#include <stdexcept>

int safe_vector_access(const std::vector<int>& vec, size_t index) {
    if (index >= vec.size()) {
        throw std::out_of_range(""Index out of range"");
    }
    return vec[index];
}",cpp,0
Out-of-Bounds,"#include <iostream>

class UnsafeClass {
    int data[10];
public:
    int get_data(int index) {
        return data[index]; // no bounds checking
    }
};","#include <iostream>

class UnsafeClass {
    int data[10];
public:
    int get_data(int index) {
        return data[index]; // no bounds checking
    }
};",cpp,1
Clear,"const shell = require('child_process');
const safeInput = userInput.replace(/[^a-zA-Z0-9.]/g, '');
shell.execFile('ping', [safeInput]); // Safe command execution
","const shell = require('child_process');
const safeInput = userInput.replace(/[^a-zA-Z0-9.]/g, '');
shell.execFile('ping', [safeInput]); // Safe command execution
",javascript,0
Memory Corruption,"#include <iostream>

void unsafe_virtual_call() {
    // Potential vtable corruption vulnerability
    class Base {
    public:
        virtual void func() { std::cout << ""Base"" << std::endl; }
    };
    
    class Derived : public Base {
    public:
        void func() override { std::cout << ""Derived"" << std::endl; }
    };
}","#include <iostream>

void unsafe_virtual_call() {
    // Potential vtable corruption vulnerability
    class Base {
    public:
        virtual void func() { std::cout << ""Base"" << std::endl; }
    };
    
    class Derived : public Base {
    public:
        void func() override { std::cout << ""Derived"" << std::endl; }
    };
}",cpp,1
Command Injection,"<?php
$cmd = $_GET['cmd'];
system($cmd); // Command Injection
?>","<?php
$cmd = $_GET['cmd'];
system($cmd); // Command Injection
?>",php,1
Clear,"const userInput = new URLSearchParams(window.location.search).get('input');
const safeOutput = document.createElement('div');
safeOutput.textContent = userInput; // Safe DOM manipulation
document.body.appendChild(safeOutput);
","const userInput = new URLSearchParams(window.location.search).get('input');
const safeOutput = document.createElement('div');
safeOutput.textContent = userInput; // Safe DOM manipulation
document.body.appendChild(safeOutput);
",javascript,0
Buffer Overflow,"#include <iostream>
#include <cstdio>

void unsafe_c_input() {
    char buffer[50];
    scanf(""%s"", buffer); // no length limit
    std::cout << buffer << std::endl;
}","#include <iostream>
#include <cstdio>

void unsafe_c_input() {
    char buffer[50];
    scanf(""%s"", buffer); // no length limit
    std::cout << buffer << std::endl;
}",cpp,1
Clear,"#include <stdio.h>
#include <string.h>

int validate_input(const char *input) {
    if (input == NULL) return 0;
    for (int i = 0; input[i] != '\0'; i++) {
        if (input[i] < 32 || input[i] > 126) {
            return 0; // invalid character
        }
    }
    return 1;
}","#include <stdio.h>
#include <string.h>

int validate_input(const char *input) {
    if (input == NULL) return 0;
    for (int i = 0; input[i] != '\0'; i++) {
        if (input[i] < 32 || input[i] > 126) {
            return 0; // invalid character
        }
    }
    return 1;
}",c,0
SQL Injection,"import java.sql.*;

public class SQLInjectionExample {

    public static void main(String[] args) {
        try {
            String userInput = ""admin' OR '1'='1"";
            String query = ""SELECT * FROM users WHERE username='"" + userInput + ""'"";

            Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");
            Statement stmt = conn.createStatement();
            ResultSet rs = stmt.executeQuery(query);

            while (rs.next()) {
                System.out.println(""Username: "" + rs.getString(""username""));
                System.out.println(""Password: "" + rs.getString(""password""));
            }

            conn.close();
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.*; public class SQLInjectionExample { public static void main(String[] args) { try { String userInput = ""admin' OR '1'='1""; String query = ""SELECT * FROM users WHERE username='"" + userInput + ""'""; Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); Statement stmt = conn.createStatement(); ResultSet rs = stmt.executeQuery(query); while (rs.next()) { System.out.println(""Username: "" + rs.getString(""username"")); System.out.println(""Password: "" + rs.getString(""password"")); } conn.close(); } catch (SQLException e) { e.printStackTrace(); } } }",java,1
Buffer Overflow,"#include <iostream>
#include <cstring>

void unsafe_c_string(char* input) {
    char buffer[100];
    strcpy(buffer, input); // potential buffer overflow
    std::cout << buffer << std::endl;
}","#include <iostream>
#include <cstring>

void unsafe_c_string(char* input) {
    char buffer[100];
    strcpy(buffer, input); // potential buffer overflow
    std::cout << buffer << std::endl;
}",cpp,1
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Clear,"#include <iostream>
#include <fstream>
#include <string>

void safe_file_reading(const std::string& filename) {
    std::ifstream file(filename);
    if (file.is_open()) {
        std::string line;
        while (std::getline(file, line)) {
            std::cout << line << std::endl;
        }
    }
}","#include <iostream>
#include <fstream>
#include <string>

void safe_file_reading(const std::string& filename) {
    std::ifstream file(filename);
    if (file.is_open()) {
        std::string line;
        while (std::getline(file, line)) {
            std::cout << line << std::endl;
        }
    }
}",cpp,0
Clear,"To fix the insecure deserialization vulnerability in the provided Java code snippet, you need to implement proper security measures to prevent malicious code execution. One way to do this is by using a secure deserialization approach, such as using a whitelist of allowed classes during deserialization.

Here is an updated version of the code snippet with secure deserialization using a custom SecurityManager and class whitelisting:

```java
import java.io.*;
import java.util.ArrayList;
import java.util.List;

public class SecureDeserializationExample {

    private static final List<Class<?>> allowedClasses = new ArrayList<>();

    static {
        // Add the classes that are allowed to be deserialized
        allowedClasses.add(String.class);
    }

    public static void main(String[] args) {
        String userInput = ""evilPayload""; // This should be user-controlled input

        try {
            byte[] serializedData = userInput.getBytes();
            ByteArrayInputStream bais = new ByteArrayInputStream(serializedData);
            ObjectInputStream ois = new SecureObjectInputStream(bais);

            Object obj = ois.readObject();

            // Validate if the deserialized object's class is allowed
            if (isValidClass(obj)) {
                System.out.println(obj.toString());
            } else {
                System.out.println(""Class not allowed for","To fix the insecure deserialization vulnerability in the provided Java code snippet, you need to implement proper security measures to prevent malicious code execution. One way to do this is by using a secure deserialization approach, such as using a whitelist of allowed classes during deserialization. Here is an updated version of the code snippet with secure deserialization using a custom SecurityManager and class whitelisting: ```java import java.io.*; import java.util.ArrayList; import java.util.List; public class SecureDeserializationExample { private static final List<Class<?>> allowedClasses = new ArrayList<>(); static { // Add the classes that are allowed to be deserialized allowedClasses.add(String.class); } public static void main(String[] args) { String userInput = ""evilPayload""; // This should be user-controlled input try { byte[] serializedData = userInput.getBytes(); ByteArrayInputStream bais = new ByteArrayInputStream(serializedData); ObjectInputStream ois = new SecureObjectInputStream(bais); Object obj = ois.readObject(); // Validate if the deserialized object's class is allowed if (isValidClass(obj)) { System.out.println(obj.toString()); } else { System.out.println(""Class not allowed for",java,0
SQL Injection,"<?php
$username = $_POST['username'];
$query = ""SELECT * FROM users WHERE username = '$username'"";
$result = mysql_query($query); // SQL Injection
?>","<?php
$username = $_POST['username'];
$query = ""SELECT * FROM users WHERE username = '$username'"";
$result = mysql_query($query); // SQL Injection
?>",php,1
Path Traversal,"def get_user_file(username, filepath):
    import os
    base_path = f""/home/{username}/files/""
    full_path = base_path + filepath
    with open(full_path, 'r') as f:
        return f.read()","def get_user_file(username, filepath):
    import os
    base_path = f""/home/{username}/files/""
    full_path = base_path + filepath
    with open(full_path, 'r') as f:
        return f.read()",python,1
Cross-Site Scripting (XSS),"import java.io.*;
import javax.servlet.*;
import javax.servlet.http.*;

public class XSSVulnerableServlet extends HttpServlet {
    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        String userInput = request.getParameter(""input"");
        String output = ""Hello, "" + userInput + ""!"";

        PrintWriter out = response.getWriter();
        out.println(""<html><body>"");
        out.println(""<h1>"" + output + ""</h1>"");
        out.println(""</body></html>"");
    }
}","import java.io.*; import javax.servlet.*; import javax.servlet.http.*; public class XSSVulnerableServlet extends HttpServlet { protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { String userInput = request.getParameter(""input""); String output = ""Hello, "" + userInput + ""!""; PrintWriter out = response.getWriter(); out.println(""<html><body>""); out.println(""<h1>"" + output + ""</h1>""); out.println(""</body></html>""); } }",java,1
Code Injection,"const userData = eval('(' + userInput + ')'); // eval injection
","const userData = eval('(' + userInput + ')'); // eval injection
",javascript,1
Clear,"To secure the code against Path Traversal vulnerability, you should validate and sanitize the user input to ensure that it does not contain any malicious characters or sequences that could lead to directory traversal attacks. Additionally, you should use a secure method to construct the file path to prevent unauthorized access.

Here's an improved version of the code with security measures implemented:

```java
import java.io.File;
import java.io.FileInputStream;
import java.io.IOException;

public class SecurePathTraversal {

    public static void main(String[] args) {
        if (args.length < 1) {
            System.out.println(""Please provide a file name."");
            return;
        }

        String fileName = args[0]; // User input for the file name

        // Validate and sanitize user input
        if (!isValidFileName(fileName)) {
            System.out.println(""Invalid file name."");
            return;
        }

        String basePath = ""/path/to/files/""; // Base directory for files
        String filePath = basePath + fileName;

        try {
            File file = new File(filePath);

            if (!file.getCanonicalPath().startsWith(basePath)) {
                System.out.println(""Access to this file is not allowed."");
                return;
            }

            FileInputStream fis = new FileInputStream(file);","To secure the code against Path Traversal vulnerability, you should validate and sanitize the user input to ensure that it does not contain any malicious characters or sequences that could lead to directory traversal attacks. Additionally, you should use a secure method to construct the file path to prevent unauthorized access. Here's an improved version of the code with security measures implemented: ```java import java.io.File; import java.io.FileInputStream; import java.io.IOException; public class SecurePathTraversal { public static void main(String[] args) { if (args.length < 1) { System.out.println(""Please provide a file name.""); return; } String fileName = args[0]; // User input for the file name // Validate and sanitize user input if (!isValidFileName(fileName)) { System.out.println(""Invalid file name.""); return; } String basePath = ""/path/to/files/""; // Base directory for files String filePath = basePath + fileName; try { File file = new File(filePath); if (!file.getCanonicalPath().startsWith(basePath)) { System.out.println(""Access to this file is not allowed.""); return; } FileInputStream fis = new FileInputStream(file);",java,0
Clear,"<?php
$username = $_POST['username'];
$stmt = $pdo->prepare(""SELECT * FROM users WHERE username = ?"");
$stmt->execute([$username]); // Parameterized query
?>","<?php
$username = $_POST['username'];
$stmt = $pdo->prepare(""SELECT * FROM users WHERE username = ?"");
$stmt->execute([$username]); // Parameterized query
?>",php,0
Clear,"To fix the Path Traversal vulnerability in the provided Java code snippet, you need to validate the user input to ensure that it does not contain any malicious attempts to traverse outside of the intended directory. Here is an improved version of the code with security measures implemented:

```java
import java.io.File;
import java.io.IOException;
import java.nio.file.Files;
import java.nio.file.Path;
import java.nio.file.Paths;

public class SecurePathTraversalExample {

    public static void main(String[] args) {
        String userInput = ""../secretfile.txt"";
        String directory = ""/var/www/html/uploads/"";

        // Validate user input to prevent path traversal
        if (!userInput.contains("".."") && !userInput.startsWith(""/"")) {
            String filePath = directory + userInput;

            File file = new File(filePath);

            try {
                // Check if the file path is within the specified directory
                if (isInDirectory(directory, filePath) && file.exists()) {
                    byte[] fileData = Files.readAllBytes(file.toPath());
                    System.out.println(""File content: "" + new String(fileData));
                } else {
                    System.out.println(""File not found."");
                }
            } catch (IOException e) {
                e.printStackTrace();
            }","To fix the Path Traversal vulnerability in the provided Java code snippet, you need to validate the user input to ensure that it does not contain any malicious attempts to traverse outside of the intended directory. Here is an improved version of the code with security measures implemented: ```java import java.io.File; import java.io.IOException; import java.nio.file.Files; import java.nio.file.Path; import java.nio.file.Paths; public class SecurePathTraversalExample { public static void main(String[] args) { String userInput = ""../secretfile.txt""; String directory = ""/var/www/html/uploads/""; // Validate user input to prevent path traversal if (!userInput.contains("".."") && !userInput.startsWith(""/"")) { String filePath = directory + userInput; File file = new File(filePath); try { // Check if the file path is within the specified directory if (isInDirectory(directory, filePath) && file.exists()) { byte[] fileData = Files.readAllBytes(file.toPath()); System.out.println(""File content: "" + new String(fileData)); } else { System.out.println(""File not found.""); } } catch (IOException e) { e.printStackTrace(); }",java,0
Hardcoded Secrets,"DATABASE_PASSWORD = ""my_super_secret_password_123""
def db_connect():
    import psycopg2
    return psycopg2.connect(f""dbname=test user=admin password={DATABASE_PASSWORD}"")","DATABASE_PASSWORD = ""my_super_secret_password_123""
def db_connect():
    import psycopg2
    return psycopg2.connect(f""dbname=test user=admin password={DATABASE_PASSWORD}"")",python,1
Clear,"import requests
def safe_api_call():
    api_key = os.environ.get('API_KEY')
    headers = {'Authorization': f'Bearer {api_key}'}
    return requests.get('https://api.example.com/data', headers=headers)","import requests
def safe_api_call():
    api_key = os.environ.get('API_KEY')
    headers = {'Authorization': f'Bearer {api_key}'}
    return requests.get('https://api.example.com/data', headers=headers)",python,0
Clear,"const token = process.env.API_TOKEN; // Environment variable
fetch('/api/data', {
    headers: { 'Authorization': `Bearer ${token}` }
});
","const token = process.env.API_TOKEN; // Environment variable
fetch('/api/data', {
    headers: { 'Authorization': `Bearer ${token}` }
});
",javascript,0
Clear,"<?php
$message = htmlspecialchars($_GET['message'], ENT_QUOTES, 'UTF-8');
echo $message; // Sanitized output
?>","<?php
$message = htmlspecialchars($_GET['message'], ENT_QUOTES, 'UTF-8');
echo $message; // Sanitized output
?>",php,0
Clear,"const token = process.env.API_TOKEN; // Environment variable
fetch('/api/data', {
    headers: { 'Authorization': `Bearer ${token}` }
});
","const token = process.env.API_TOKEN; // Environment variable
fetch('/api/data', {
    headers: { 'Authorization': `Bearer ${token}` }
});
",javascript,0
Clear,"from django.http import HttpResponse
from django.utils.html import escape

def safe_user_profile(request, username):
    safe_username = escape(username)
    return HttpResponse(f""Welcome, {safe_username}!"")","from django.http import HttpResponse
from django.utils.html import escape

def safe_user_profile(request, username):
    safe_username = escape(username)
    return HttpResponse(f""Welcome, {safe_username}!"")",python,0
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Clear,"import org.owasp.encoder.Encode;

public class XSSFixedCode {

    public static void main(String[] args) {
        // Simulating user input received from a form submission
        String userInput = ""<script>alert('XSS Vulnerability')</script>"";

        // Properly escaping user input before outputting it to the webpage
        System.out.println(""<div>"" + Encode.forHtml(userInput) + ""</div>"");
    }
}","import org.owasp.encoder.Encode; public class XSSFixedCode { public static void main(String[] args) { // Simulating user input received from a form submission String userInput = ""<script>alert('XSS Vulnerability')</script>""; // Properly escaping user input before outputting it to the webpage System.out.println(""<div>"" + Encode.forHtml(userInput) + ""</div>""); } }",java,0
Clear,"const shell = require('child_process');
const safeInput = userInput.replace(/[^a-zA-Z0-9.]/g, '');
shell.execFile('ping', [safeInput]); // Safe command execution
","const shell = require('child_process');
const safeInput = userInput.replace(/[^a-zA-Z0-9.]/g, '');
shell.execFile('ping', [safeInput]); // Safe command execution
",javascript,0
Buffer Overflow,"#include <iostream>
#include <cstdio>

void unsafe_c_input() {
    char buffer[50];
    scanf(""%s"", buffer); // no length limit
    std::cout << buffer << std::endl;
}","#include <iostream>
#include <cstdio>

void unsafe_c_input() {
    char buffer[50];
    scanf(""%s"", buffer); // no length limit
    std::cout << buffer << std::endl;
}",cpp,1
Clear,"#include <iostream>
#include <string>
#include <vector>

void safe_string_handling(const std::string& input) {
    std::string safe_copy = input;
    std::cout << safe_copy << std::endl;
}","#include <iostream>
#include <string>
#include <vector>

void safe_string_handling(const std::string& input) {
    std::string safe_copy = input;
    std::cout << safe_copy << std::endl;
}",cpp,0
Command Injection,"import subprocess
def list_directory(path):
    result = subprocess.run(f""ls {path}"", shell=True, capture_output=True, text=True)
    return result.stdout","import subprocess
def list_directory(path):
    result = subprocess.run(f""ls {path}"", shell=True, capture_output=True, text=True)
    return result.stdout",python,1
Clear,"#include <iostream>
#include <fstream>
#include <string>

void safe_file_reading(const std::string& filename) {
    std::ifstream file(filename);
    if (file.is_open()) {
        std::string line;
        while (std::getline(file, line)) {
            std::cout << line << std::endl;
        }
    }
}","#include <iostream>
#include <fstream>
#include <string>

void safe_file_reading(const std::string& filename) {
    std::ifstream file(filename);
    if (file.is_open()) {
        std::string line;
        while (std::getline(file, line)) {
            std::cout << line << std::endl;
        }
    }
}",cpp,0
Clear,"<?php
$cmd = escapeshellarg($_GET['cmd']);
system(""ls "" . $cmd); // Escaped command
?>","<?php
$cmd = escapeshellarg($_GET['cmd']);
system(""ls "" . $cmd); // Escaped command
?>",php,0
Command Injection,"import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class CommandInjectionExample {
    public static void main(String[] args) {
        try {
            BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));
            System.out.print(""Enter a command to execute: "");
            String command = reader.readLine();

            // Improperly handling user input by directly concatenating it into a command
            Process process = Runtime.getRuntime().exec(""ping "" + command);

            BufferedReader inputReader = new BufferedReader(new InputStreamReader(process.getInputStream()));
            String line;
            while ((line = inputReader.readLine()) != null) {
                System.out.println(line);
            }

        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}","import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class CommandInjectionExample { public static void main(String[] args) { try { BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a command to execute: ""); String command = reader.readLine(); // Improperly handling user input by directly concatenating it into a command Process process = Runtime.getRuntime().exec(""ping "" + command); BufferedReader inputReader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = inputReader.readLine()) != null) { System.out.println(line); } } catch (IOException e) { e.printStackTrace(); } } }",java,1
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Clear,"import java.util.Scanner;

public class SecureBuffer {
    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);

        System.out.print(""Enter a string: "");
        String input = scanner.nextLine(); // Read the entire line

        // Limit the input size to prevent buffer overflow
        if (input.length() > 10) {
            System.out.println(""Input string is too long. Please enter a string with 10 characters or less."");
            return;
        }

        char[] buffer = new char[10];
        input.getChars(0, input.length(), buffer, 0);

        System.out.println(""Buffer contents: "" + new String(buffer));
    }
}","import java.util.Scanner; public class SecureBuffer { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter a string: ""); String input = scanner.nextLine(); // Read the entire line // Limit the input size to prevent buffer overflow if (input.length() > 10) { System.out.println(""Input string is too long. Please enter a string with 10 characters or less.""); return; } char[] buffer = new char[10]; input.getChars(0, input.length(), buffer, 0); System.out.println(""Buffer contents: "" + new String(buffer)); } }",java,0
Code Injection,"const userData = eval('(' + userInput + ')'); // eval injection
","const userData = eval('(' + userInput + ')'); // eval injection
",javascript,1
Buffer Overflow,"import java.util.Scanner;

public class BufferOverflowExample {
    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        
        System.out.print(""Enter your name: "");
        String name = scanner.nextLine();
        
        // Vulnerability: The input size is not validated, which can lead to buffer overflow
        byte[] buffer = new byte[10];
        System.arraycopy(name.getBytes(), 0, buffer, 0, name.length());
        
        System.out.println(""Hello, "" + new String(buffer));
    }
}","import java.util.Scanner; public class BufferOverflowExample { public static void main(String[] args) { Scanner scanner = new Scanner(System.in); System.out.print(""Enter your name: ""); String name = scanner.nextLine(); // Vulnerability: The input size is not validated, which can lead to buffer overflow byte[] buffer = new byte[10]; System.arraycopy(name.getBytes(), 0, buffer, 0, name.length()); System.out.println(""Hello, "" + new String(buffer)); } }",java,1
Clear,"import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class CommandInjectionExample {

    public static void main(String[] args) throws IOException {
        BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));

        System.out.print(""Enter a file name to display its contents: "");
        String fileName = reader.readLine();

        // Use ProcessBuilder to securely execute external commands
        ProcessBuilder processBuilder = new ProcessBuilder(""cat"", fileName);
        processBuilder.redirectErrorStream(true);

        Process process = processBuilder.start();

        BufferedReader inputReader = new BufferedReader(new InputStreamReader(process.getInputStream()));
        String line;

        while ((line = inputReader.readLine()) != null) {
            System.out.println(line);
        }

        inputReader.close();
    }
}","import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class CommandInjectionExample { public static void main(String[] args) throws IOException { BufferedReader reader = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a file name to display its contents: ""); String fileName = reader.readLine(); // Use ProcessBuilder to securely execute external commands ProcessBuilder processBuilder = new ProcessBuilder(""cat"", fileName); processBuilder.redirectErrorStream(true); Process process = processBuilder.start(); BufferedReader inputReader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = inputReader.readLine()) != null) { System.out.println(line); } inputReader.close(); } }",java,0
Cross-Site Scripting (XSS),"import java.io.IOException;
import java.io.PrintWriter;

public class XSSVulnerableCode {
    public static void main(String[] args) throws IOException {
        String userInput = ""<script>alert('XSS Attack!')</script>"";
        
        PrintWriter out = new PrintWriter(""output.html"");
        out.println(""<html>"");
        out.println(""<body>"");
        out.println(""<h1>Welcome, "" + userInput + ""</h1>"");
        out.println(""</body>"");
        out.println(""</html>"");
        
        out.close();
    }
}","import java.io.IOException; import java.io.PrintWriter; public class XSSVulnerableCode { public static void main(String[] args) throws IOException { String userInput = ""<script>alert('XSS Attack!')</script>""; PrintWriter out = new PrintWriter(""output.html""); out.println(""<html>""); out.println(""<body>""); out.println(""<h1>Welcome, "" + userInput + ""</h1>""); out.println(""</body>""); out.println(""</html>""); out.close(); } }",java,1
Clear,"#include <iostream>
#include <fstream>
#include <string>

void safe_file_reading(const std::string& filename) {
    std::ifstream file(filename);
    if (file.is_open()) {
        std::string line;
        while (std::getline(file, line)) {
            std::cout << line << std::endl;
        }
    }
}","#include <iostream>
#include <fstream>
#include <string>

void safe_file_reading(const std::string& filename) {
    std::ifstream file(filename);
    if (file.is_open()) {
        std::string line;
        while (std::getline(file, line)) {
            std::cout << line << std::endl;
        }
    }
}",cpp,0
Command Injection,"import os
def backup_database(db_name):
    os.system(f""pg_dump {db_name} > backup.sql"")","import os
def backup_database(db_name):
    os.system(f""pg_dump {db_name} > backup.sql"")",python,1
Clear,"#include <iostream>
#include <memory>

void safe_memory_management() {
    auto ptr = std::make_unique<int>(42);
    std::cout << *ptr << std::endl;
}","#include <iostream>
#include <memory>

void safe_memory_management() {
    auto ptr = std::make_unique<int>(42);
    std::cout << *ptr << std::endl;
}",cpp,0
XSS,"const userInput = document.location.search.split('=')[1];
document.write(userInput); // XSS
","const userInput = document.location.search.split('=')[1];
document.write(userInput); // XSS
",javascript,1
SQL Injection,"import java.sql.*;

public class VulnerableCode {

    public void searchUser(String username) {
        String query = ""SELECT * FROM Users WHERE username = '"" + username + ""'"";
        
        try {
            Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");
            Statement stmt = conn.createStatement();
            ResultSet rs = stmt.executeQuery(query);
            
            while (rs.next()) {
                System.out.println(""User ID: "" + rs.getInt(""id"") + "", Username: "" + rs.getString(""username""));
            }
            
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }

    public static void main(String[] args) {
        VulnerableCode code = new VulnerableCode();
        code.searchUser(""admin' OR '1'='1"");
    }
}","import java.sql.*; public class VulnerableCode { public void searchUser(String username) { String query = ""SELECT * FROM Users WHERE username = '"" + username + ""'""; try { Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); Statement stmt = conn.createStatement(); ResultSet rs = stmt.executeQuery(query); while (rs.next()) { System.out.println(""User ID: "" + rs.getInt(""id"") + "", Username: "" + rs.getString(""username"")); } } catch (SQLException e) { e.printStackTrace(); } } public static void main(String[] args) { VulnerableCode code = new VulnerableCode(); code.searchUser(""admin' OR '1'='1""); } }",java,1
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Clear,"import java.io.IOException;
import java.io.PrintWriter;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import org.owasp.esapi.ESAPI;

public class SecureServlet extends HttpServlet {
    protected void doPost(HttpServletRequest request, HttpServletResponse response) throws IOException {
        String userInput = request.getParameter(""input"");
        
        // Properly handling user input by encoding it before outputting to the response
        PrintWriter out = response.getWriter();
        out.println(""<html>"");
        out.println(""<body>"");
        out.println(""<h1>User Input: "" + ESAPI.encoder().encodeForHTML(userInput) + ""</h1>"");
        out.println(""</body>"");
        out.println(""</html>"");
    }
}","import java.io.IOException; import java.io.PrintWriter; import javax.servlet.http.HttpServlet; import javax.servlet.http.HttpServletRequest; import javax.servlet.http.HttpServletResponse; import org.owasp.esapi.ESAPI; public class SecureServlet extends HttpServlet { protected void doPost(HttpServletRequest request, HttpServletResponse response) throws IOException { String userInput = request.getParameter(""input""); // Properly handling user input by encoding it before outputting to the response PrintWriter out = response.getWriter(); out.println(""<html>""); out.println(""<body>""); out.println(""<h1>User Input: "" + ESAPI.encoder().encodeForHTML(userInput) + ""</h1>""); out.println(""</body>""); out.println(""</html>""); } }",java,0
Clear,"const userData = JSON.parse(userInput); // Safe JSON parsing
if (userData && typeof userData === 'object') {
    processUserData(userData);
}
","const userData = JSON.parse(userInput); // Safe JSON parsing
if (userData && typeof userData === 'object') {
    processUserData(userData);
}
",javascript,0
Clear,"import os
def secure_file_access(username, filepath):
    base_dir = f""/home/{username}/files/""
    full_path = os.path.join(base_dir, filepath)
    full_path = os.path.normpath(full_path)
    if not full_path.startswith(base_dir):
        raise PermissionError(""Access denied"")
    with open(full_path, 'r') as f:
        return f.read()","import os
def secure_file_access(username, filepath):
    base_dir = f""/home/{username}/files/""
    full_path = os.path.join(base_dir, filepath)
    full_path = os.path.normpath(full_path)
    if not full_path.startswith(base_dir):
        raise PermissionError(""Access denied"")
    with open(full_path, 'r') as f:
        return f.read()",python,0
Hardcoded Secrets,"import requests
def call_api():
    api_key = ""sk_live_1234567890abcdef""
    headers = {'Authorization': f'Bearer {api_key}'}
    return requests.get('https://api.example.com/data', headers=headers)","import requests
def call_api():
    api_key = ""sk_live_1234567890abcdef""
    headers = {'Authorization': f'Bearer {api_key}'}
    return requests.get('https://api.example.com/data', headers=headers)",python,1
Clear,"const shell = require('child_process');
const safeInput = userInput.replace(/[^a-zA-Z0-9.]/g, '');
shell.execFile('ping', [safeInput]); // Safe command execution
","const shell = require('child_process');
const safeInput = userInput.replace(/[^a-zA-Z0-9.]/g, '');
shell.execFile('ping', [safeInput]); // Safe command execution
",javascript,0
Clear,"<?php
$file = basename($_GET['file']);
$allowed = ['page1.php', 'page2.php'];
if (in_array($file, $allowed)) {
    include($file);
}
?>","<?php
$file = basename($_GET['file']);
$allowed = ['page1.php', 'page2.php'];
if (in_array($file, $allowed)) {
    include($file);
}
?>",php,0
Command Injection,"const shell = require('child_process');
shell.exec('ping ' + userInput); // Command Injection
","const shell = require('child_process');
shell.exec('ping ' + userInput); // Command Injection
",javascript,1
Clear,"import json
def parse_safe_json(json_str):
    try:
        return json.loads(json_str)
    except json.JSONDecodeError:
        raise ValueError(""Invalid JSON"")","import json
def parse_safe_json(json_str):
    try:
        return json.loads(json_str)
    except json.JSONDecodeError:
        raise ValueError(""Invalid JSON"")",python,0
SQL Injection,"import java.sql.*;

public class SQLInjectionVulnerableExample {

    public static void main(String[] args) {
        String userInput = ""'; DROP TABLE users; --""; // Malicious input to perform SQL Injection

        try {
            Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");
            Statement stmt = conn.createStatement();

            String query = ""SELECT * FROM users WHERE username = '"" + userInput + ""'"";
            ResultSet rs = stmt.executeQuery(query);

            while (rs.next()) {
                System.out.println(""Username: "" + rs.getString(""username""));
                System.out.println(""Password: "" + rs.getString(""password""));
            }

            conn.close();
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.*; public class SQLInjectionVulnerableExample { public static void main(String[] args) { String userInput = ""'; DROP TABLE users; --""; // Malicious input to perform SQL Injection try { Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); Statement stmt = conn.createStatement(); String query = ""SELECT * FROM users WHERE username = '"" + userInput + ""'""; ResultSet rs = stmt.executeQuery(query); while (rs.next()) { System.out.println(""Username: "" + rs.getString(""username"")); System.out.println(""Password: "" + rs.getString(""password"")); } conn.close(); } catch (SQLException e) { e.printStackTrace(); } } }",java,1
Buffer Overflow,"#include <iostream>
#include <cstdio>

void unsafe_c_input() {
    char buffer[50];
    scanf(""%s"", buffer); // no length limit
    std::cout << buffer << std::endl;
}","#include <iostream>
#include <cstdio>

void unsafe_c_input() {
    char buffer[50];
    scanf(""%s"", buffer); // no length limit
    std::cout << buffer << std::endl;
}",cpp,1
Cross-Site Scripting (XSS),"def display_comment(comment_text):
    return f""<div class='comment'>{comment_text}</div>"" ","def display_comment(comment_text):
    return f""<div class='comment'>{comment_text}</div>"" ",python,1
SQL Injection,"import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Statement;

public class VulnerableCode {
    
    public static void main(String[] args) {
        String userInput = ""'; DROP TABLE users; --""; // User input with malicious SQL Injection query
        
        try {
            Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password"");
            Statement stmt = conn.createStatement();
            
            String query = ""SELECT * FROM users WHERE username='"" + userInput + ""'"";
            ResultSet rs = stmt.executeQuery(query);
            
            while(rs.next()) {
                System.out.println(rs.getString(""username"") + "" - "" + rs.getString(""password""));
            }
            
            conn.close();
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}","import java.sql.Connection; import java.sql.DriverManager; import java.sql.ResultSet; import java.sql.SQLException; import java.sql.Statement; public class VulnerableCode { public static void main(String[] args) { String userInput = ""'; DROP TABLE users; --""; // User input with malicious SQL Injection query try { Connection conn = DriverManager.getConnection(""jdbc:mysql://localhost:3306/mydatabase"", ""username"", ""password""); Statement stmt = conn.createStatement(); String query = ""SELECT * FROM users WHERE username='"" + userInput + ""'""; ResultSet rs = stmt.executeQuery(query); while(rs.next()) { System.out.println(rs.getString(""username"") + "" - "" + rs.getString(""password"")); } conn.close(); } catch (SQLException e) { e.printStackTrace(); } } }",java,1
Clear,"import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class CommandInjectionSecure {

    public static void main(String[] args) {
        try {
            BufferedReader br = new BufferedReader(new InputStreamReader(System.in));
            System.out.print(""Enter a command to execute: "");
            String command = br.readLine();

            // Split user input into separate command and arguments
            String[] commands = {""ping"", command};

            ProcessBuilder processBuilder = new ProcessBuilder(commands);
            Process process = processBuilder.start();

            BufferedReader reader = new BufferedReader(new InputStreamReader(process.getInputStream()));
            String line;
            while ((line = reader.readLine()) != null) {
                System.out.println(line);
            }
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}","import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class CommandInjectionSecure { public static void main(String[] args) { try { BufferedReader br = new BufferedReader(new InputStreamReader(System.in)); System.out.print(""Enter a command to execute: ""); String command = br.readLine(); // Split user input into separate command and arguments String[] commands = {""ping"", command}; ProcessBuilder processBuilder = new ProcessBuilder(commands); Process process = processBuilder.start(); BufferedReader reader = new BufferedReader(new InputStreamReader(process.getInputStream())); String line; while ((line = reader.readLine()) != null) { System.out.println(line); } } catch (IOException e) { e.printStackTrace(); } } }",java,0
Buffer Overflow,"#include <iostream>
#include <cstdio>

void unsafe_c_input() {
    char buffer[50];
    scanf(""%s"", buffer); // no length limit
    std::cout << buffer << std::endl;
}","#include <iostream>
#include <cstdio>

void unsafe_c_input() {
    char buffer[50];
    scanf(""%s"", buffer); // no length limit
    std::cout << buffer << std::endl;
}",cpp,1
Clear,"<?php
$username = $_POST['username'];
$stmt = $pdo->prepare(""SELECT * FROM users WHERE username = ?"");
$stmt->execute([$username]); // Parameterized query
?>","<?php
$username = $_POST['username'];
$stmt = $pdo->prepare(""SELECT * FROM users WHERE username = ?"");
$stmt->execute([$username]); // Parameterized query
?>",php,0
Buffer Overflow,"char buffer[10]; scanf(""%s"", buffer);","char buffer[10]; scanf(""%s"", buffer);",c,1
Clear,"#include <iostream>
#include <sstream>

int safe_string_to_int(const std::string& str) {
    std::stringstream ss(str);
    int value;
    if (ss >> value) {
        return value;
    }
    throw std::invalid_argument(""Invalid integer"");
}","#include <iostream>
#include <sstream>

int safe_string_to_int(const std::string& str) {
    std::stringstream ss(str);
    int value;
    if (ss >> value) {
        return value;
    }
    throw std::invalid_argument(""Invalid integer"");
}",cpp,0
Buffer Overflow,"#include <iostream>
#include <cstdio>

void unsafe_c_input() {
    char buffer[50];
    scanf(""%s"", buffer); // no length limit
    std::cout << buffer << std::endl;
}","#include <iostream>
#include <cstdio>

void unsafe_c_input() {
    char buffer[50];
    scanf(""%s"", buffer); // no length limit
    std::cout << buffer << std::endl;
}",cpp,1
Clear,"#include <iostream>
#include <fstream>
#include <string>

void safe_file_reading(const std::string& filename) {
    std::ifstream file(filename);
    if (file.is_open()) {
        std::string line;
        while (std::getline(file, line)) {
            std::cout << line << std::endl;
        }
    }
}","#include <iostream>
#include <fstream>
#include <string>

void safe_file_reading(const std::string& filename) {
    std::ifstream file(filename);
    if (file.is_open()) {
        std::string line;
        while (std::getline(file, line)) {
            std::cout << line << std::endl;
        }
    }
}",cpp,0
Clear,"const token = process.env.API_TOKEN; // Environment variable
fetch('/api/data', {
    headers: { 'Authorization': `Bearer ${token}` }
});
","const token = process.env.API_TOKEN; // Environment variable
fetch('/api/data', {
    headers: { 'Authorization': `Bearer ${token}` }
});
",javascript,0
